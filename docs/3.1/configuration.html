<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>HAProxy version 3.1.1 - Configuration Manual</title>
		<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" />
		<link href="https://raw.githubusercontent.com/thomaspark/bootswatch/v3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" />
		<link href="../css/page.css?0.4.2-15" rel="stylesheet" />
	</head>
	<body>
		<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#menu">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="../">HAProxy Documentation</a>
			</div>
			<!-- /.navbar-header -->

			<!-- Collect the nav links, forms, and other content for toggling -->
			<div class="collapse navbar-collapse" id="menu">
				<ul class="nav navbar-nav">
						<li class=""><a href="intro.html">Starter Guide</a></li>
						<li class="active"><a href="configuration.html">Configuration Manual</a></li>
						<li class=""><a href="management.html">Management Guide</a></li>
				</ul>
				<ul class="nav navbar-nav">
					<li><a href="http://www.haproxy.org/">HAProxy Home Page</a></li>
				</ul>
			</div>
		</nav>
		<!-- /.navbar-static-side -->

		<div id="wrapper">

			<div id="sidebar">
				<ul class="nav nav-tabs" role="tablist">
					<li role="presentation" class="active"><a href="#tab-summary" aria-controls="tab-summary" role="tab" data-toggle="tab">Summary</a></li>
					<li role="presentation"><a href="#tab-keywords" aria-controls="tab-keywords" role="tab" data-toggle="tab">Keywords</a></li>
				</ul>
				<div class="tab-content">
					<div role="tabpanel" class="tab-pane active" id="tab-summary">
						<table class="summary">
	<tbody>
		
			
				
				<tr>
					<td><b><small>1.</small></b></td>
					<td>
							<a href="#1"><b>Quick reminder about HTTP</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>1.1.</small></td>
					<td>
							<div class="tab">
							<a href="#1.1">The HTTP transaction model</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>1.2.</small></td>
					<td>
							<div class="tab">
							<a href="#1.2">Terminology</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>1.3.</small></td>
					<td>
							<div class="tab">
							<a href="#1.3">HTTP request</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>1.3.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#1.3.1">The request line</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>1.3.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#1.3.2">The request headers</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>1.4.</small></td>
					<td>
							<div class="tab">
							<a href="#1.4">HTTP response</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>1.4.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#1.4.1">The response line</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>1.4.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#1.4.2">The response headers</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>2.</small></b></td>
					<td>
							<a href="#2"><br><b>Configuring HAProxy</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.1.</small></td>
					<td>
							<div class="tab">
							<a href="#2.1">Configuration file format</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.2.</small></td>
					<td>
							<div class="tab">
							<a href="#2.2">Quoting and escaping</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.3.</small></td>
					<td>
							<div class="tab">
							<a href="#2.3">Environment variables</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.4.</small></td>
					<td>
							<div class="tab">
							<a href="#2.4">Conditional blocks</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.5.</small></td>
					<td>
							<div class="tab">
							<a href="#2.5">Time format</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.6.</small></td>
					<td>
							<div class="tab">
							<a href="#2.6">Size format</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.7.</small></td>
					<td>
							<div class="tab">
							<a href="#2.7">Name format for maps and ACLs</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.8.</small></td>
					<td>
							<div class="tab">
							<a href="#2.8">Variables</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.9.</small></td>
					<td>
							<div class="tab">
							<a href="#2.9">Examples</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>3.</small></b></td>
					<td>
							<a href="#3"><br><b>Global parameters</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.1.</small></td>
					<td>
							<div class="tab">
							<a href="#3.1">Process management and security</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.2.</small></td>
					<td>
							<div class="tab">
							<a href="#3.2">Performance tuning</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.3.</small></td>
					<td>
							<div class="tab">
							<a href="#3.3">Debugging</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.3.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#3.3.1">Traces</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.4.</small></td>
					<td>
							<div class="tab">
							<a href="#3.4">Userlists</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.5.</small></td>
					<td>
							<div class="tab">
							<a href="#3.5">Peers</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.6.</small></td>
					<td>
							<div class="tab">
							<a href="#3.6">Mailers</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.7.</small></td>
					<td>
							<div class="tab">
							<a href="#3.7">Programs (deprecated)</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.8.</small></td>
					<td>
							<div class="tab">
							<a href="#3.8">HTTP-errors</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.9.</small></td>
					<td>
							<div class="tab">
							<a href="#3.9">Rings</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.10.</small></td>
					<td>
							<div class="tab">
							<a href="#3.10">Log forwarding</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.11.</small></td>
					<td>
							<div class="tab">
							<a href="#3.11">HTTPClient tuning</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.12.</small></td>
					<td>
							<div class="tab">
							<a href="#3.12">Certificate Storage</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.12.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#3.12.1">Load options</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>4.</small></b></td>
					<td>
							<a href="#4"><br><b>Proxies</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>4.1.</small></td>
					<td>
							<div class="tab">
							<a href="#4.1">Proxy keywords matrix</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>4.2.</small></td>
					<td>
							<div class="tab">
							<a href="#4.2">Alphabetically sorted keywords reference</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>4.3.</small></td>
					<td>
							<div class="tab">
							<a href="#4.3">Actions keywords matrix</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>4.4.</small></td>
					<td>
							<div class="tab">
							<a href="#4.4">Alphabetically sorted actions reference</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>5.</small></b></td>
					<td>
							<a href="#5"><br><b>Bind and server options</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>5.1.</small></td>
					<td>
							<div class="tab">
							<a href="#5.1">Bind options</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>5.2.</small></td>
					<td>
							<div class="tab">
							<a href="#5.2">Server and default-server options</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>5.3.</small></td>
					<td>
							<div class="tab">
							<a href="#5.3">Server DNS resolution</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>5.3.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#5.3.1">Global overview</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>5.3.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#5.3.2">The resolvers section</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>6.</small></b></td>
					<td>
							<a href="#6"><br><b>Cache</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>6.1.</small></td>
					<td>
							<div class="tab">
							<a href="#6.1">Limitation</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>6.2.</small></td>
					<td>
							<div class="tab">
							<a href="#6.2">Setup</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>6.2.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#6.2.1">Cache section</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>6.2.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#6.2.2">Proxy section</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>7.</small></b></td>
					<td>
							<a href="#7"><br><b>Using ACLs and fetching samples</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.1.</small></td>
					<td>
							<div class="tab">
							<a href="#7.1">ACL basics</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.1.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.1.1">Matching booleans</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.1.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.1.2">Matching integers</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.1.3.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.1.3">Matching strings</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.1.4.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.1.4">Matching regular expressions (regexes)</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.1.5.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.1.5">Matching arbitrary data blocks</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.1.6.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.1.6">Matching IPv4 and IPv6 addresses</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.2.</small></td>
					<td>
							<div class="tab">
							<a href="#7.2">Using ACLs to form conditions</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.3.</small></td>
					<td>
							<div class="tab">
							<a href="#7.3">Fetching samples</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.3.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.3.1">Converters</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.3.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.3.2">Fetching samples from internal states</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.3.3.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.3.3">Fetching samples at Layer 4</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.3.4.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.3.4">Fetching samples at Layer 5</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.3.5.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.3.5">Fetching samples from buffer contents (Layer 6)</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.3.6.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.3.6">Fetching HTTP samples (Layer 7)</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.3.7.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.3.7">Fetching samples for developers</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.4.</small></td>
					<td>
							<div class="tab">
							<a href="#7.4">Pre-defined ACLs</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>8.</small></b></td>
					<td>
							<a href="#8"><br><b>Logging</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.1.</small></td>
					<td>
							<div class="tab">
							<a href="#8.1">Log levels</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.2.</small></td>
					<td>
							<div class="tab">
							<a href="#8.2">Log formats</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.2.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.2.1">Default log format</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.2.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.2.2">TCP log format</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.2.3.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.2.3">HTTP log format</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.2.4.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.2.4">HTTPS log format</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.2.5.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.2.5">Error log format</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.2.6.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.2.6">Custom log format</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.3.</small></td>
					<td>
							<div class="tab">
							<a href="#8.3">Advanced logging options</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.3.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.3.1">Disabling logging of external tests</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.3.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.3.2">Logging before waiting for the stream to terminate</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.3.3.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.3.3">Raising log level upon errors</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.3.4.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.3.4">Disabling logging of successful connections</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.3.5.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.3.5">Log profiles</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.4.</small></td>
					<td>
							<div class="tab">
							<a href="#8.4">Timing events</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.5.</small></td>
					<td>
							<div class="tab">
							<a href="#8.5">Stream state at disconnection</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.6.</small></td>
					<td>
							<div class="tab">
							<a href="#8.6">Non-printable characters</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.7.</small></td>
					<td>
							<div class="tab">
							<a href="#8.7">Capturing HTTP cookies</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.8.</small></td>
					<td>
							<div class="tab">
							<a href="#8.8">Capturing HTTP headers</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.9.</small></td>
					<td>
							<div class="tab">
							<a href="#8.9">Examples of logs</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>9.</small></b></td>
					<td>
							<a href="#9"><br><b>Supported filters</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>9.1.</small></td>
					<td>
							<div class="tab">
							<a href="#9.1">Trace</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>9.2.</small></td>
					<td>
							<div class="tab">
							<a href="#9.2">HTTP compression</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>9.3.</small></td>
					<td>
							<div class="tab">
							<a href="#9.3">Stream Processing Offload Engine (SPOE)</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>9.4.</small></td>
					<td>
							<div class="tab">
							<a href="#9.4">Cache</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>9.5.</small></td>
					<td>
							<div class="tab">
							<a href="#9.5">fcgi-app</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>9.6.</small></td>
					<td>
							<div class="tab">
							<a href="#9.6">OpenTracing</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>9.7.</small></td>
					<td>
							<div class="tab">
							<a href="#9.7">Bandwidth limitation</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>10.</small></b></td>
					<td>
							<a href="#10"><br><b>FastCGI applications</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>10.1.</small></td>
					<td>
							<div class="tab">
							<a href="#10.1">Setup</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>10.1.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#10.1.1">Fcgi-app section</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>10.1.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#10.1.2">Proxy section</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>10.1.3.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#10.1.3">Example</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>10.2.</small></td>
					<td>
							<div class="tab">
							<a href="#10.2">Default parameters</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>10.3.</small></td>
					<td>
							<div class="tab">
							<a href="#10.3">Limitations</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>11.</small></b></td>
					<td>
							<a href="#11"><br><b>Address formats</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>11.1.</small></td>
					<td>
							<div class="tab">
							<a href="#11.1">Address family prefixes</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>11.2.</small></td>
					<td>
							<div class="tab">
							<a href="#11.2">Socket type prefixes</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>11.3.</small></td>
					<td>
							<div class="tab">
							<a href="#11.3">Protocol prefixes</a>
							</div>
					<td>
				</tr>
				
	</tbody>
</table>

					</div>
					<div role="tabpanel" class="tab-pane" id="tab-keywords">
						<label for="filter">Filter</label>
						<input class="form-control" type="text" name="filter" id="filter" onkeyup="filterKeywords(this.value)" placeholder="Enter keyword to search...">
						
							
								<div class="letter" id="letter-5"><h4>5</h4>
								
							<a class="list-group-item" href="#51d.all">51d.all</a>
							
							<a class="list-group-item" href="#51d.single">51d.single</a>
							
							<a class="list-group-item" href="#51degrees-allow-unmatched">51degrees-allow-unmatched</a>
							
							<a class="list-group-item" href="#51degrees-cache-size">51degrees-cache-size</a>
							
							<a class="list-group-item" href="#51degrees-data-file">51degrees-data-file</a>
							
							<a class="list-group-item" href="#51degrees-difference">51degrees-difference</a>
							
							<a class="list-group-item" href="#51degrees-drift">51degrees-drift</a>
							
							<a class="list-group-item" href="#51degrees-property-name-list">51degrees-property-name-list</a>
							
							<a class="list-group-item" href="#51degrees-property-separator">51degrees-property-separator</a>
							
							<a class="list-group-item" href="#51degrees-use-performance-graph">51degrees-use-performance-graph</a>
							
							<a class="list-group-item" href="#51degrees-use-predictive-graph">51degrees-use-predictive-graph</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-A"><h4>A</h4>
								
							<a class="list-group-item" href="#accept">accept</a>
							
							<a class="list-group-item" href="#accept-netscaler-cip">accept-netscaler-cip</a>
							
							<a class="list-group-item" href="#accept-proxy">accept-proxy</a>
							
							<a class="list-group-item" href="#accept_date">accept_date</a>
							
							<a class="list-group-item" href="#accepted_payload_size">accepted_payload_size</a>
							
							<a class="list-group-item" href="#acl (Fcgi-app section)">acl (Fcgi-app section)</a>
							
							<a class="list-group-item" href="#acl (Alphabetically sorted keywords reference)">acl (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#acl (Fetching samples from internal states)">acl (Fetching samples from internal states)</a>
							
							<a class="list-group-item" href="#act_conn">act_conn</a>
							
							<a class="list-group-item" href="#add">add</a>
							
							<a class="list-group-item" href="#add-acl">add-acl</a>
							
							<a class="list-group-item" href="#add-header">add-header</a>
							
							<a class="list-group-item" href="#add_item">add_item</a>
							
							<a class="list-group-item" href="#addr">addr</a>
							
							<a class="list-group-item" href="#aes_gcm_dec">aes_gcm_dec</a>
							
							<a class="list-group-item" href="#aes_gcm_enc">aes_gcm_enc</a>
							
							<a class="list-group-item" href="#agent-addr">agent-addr</a>
							
							<a class="list-group-item" href="#agent-check">agent-check</a>
							
							<a class="list-group-item" href="#agent-inter">agent-inter</a>
							
							<a class="list-group-item" href="#agent-port">agent-port</a>
							
							<a class="list-group-item" href="#agent-send">agent-send</a>
							
							<a class="list-group-item" href="#alias">alias</a>
							
							<a class="list-group-item" href="#allow">allow</a>
							
							<a class="list-group-item" href="#allow-0rtt (Bind options)">allow-0rtt (Bind options)</a>
							
							<a class="list-group-item" href="#allow-0rtt (Server and default-server options)">allow-0rtt (Server and default-server options)</a>
							
							<a class="list-group-item" href="#alpn (Bind options)">alpn (Bind options)</a>
							
							<a class="list-group-item" href="#alpn (Server and default-server options)">alpn (Server and default-server options)</a>
							
							<a class="list-group-item" href="#always_false">always_false</a>
							
							<a class="list-group-item" href="#always_true">always_true</a>
							
							<a class="list-group-item" href="#and">and</a>
							
							<a class="list-group-item" href="#anonkey">anonkey</a>
							
							<a class="list-group-item" href="#attach-srv">attach-srv</a>
							
							<a class="list-group-item" href="#auth">auth</a>
							
							<a class="list-group-item" href="#avg_queue">avg_queue</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-B"><h4>B</h4>
								
							<a class="list-group-item" href="#b64dec">b64dec</a>
							
							<a class="list-group-item" href="#backing-file">backing-file</a>
							
							<a class="list-group-item" href="#backlog (Log forwarding)">backlog (Log forwarding)</a>
							
							<a class="list-group-item" href="#backlog (Alphabetically sorted keywords reference)">backlog (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#backlog (Bind options)">backlog (Bind options)</a>
							
							<a class="list-group-item" href="#backup">backup</a>
							
							<a class="list-group-item" href="#balance">balance</a>
							
							<a class="list-group-item" href="#balance url_param">balance url_param</a>
							
							<a class="list-group-item" href="#base">base</a>
							
							<a class="list-group-item" href="#base32">base32</a>
							
							<a class="list-group-item" href="#base32+src">base32+src</a>
							
							<a class="list-group-item" href="#base64">base64</a>
							
							<a class="list-group-item" href="#baseq">baseq</a>
							
							<a class="list-group-item" href="#bc.timer.connect">bc.timer.connect</a>
							
							<a class="list-group-item" href="#bc_be_queue">bc_be_queue</a>
							
							<a class="list-group-item" href="#bc_dst">bc_dst</a>
							
							<a class="list-group-item" href="#bc_dst_port">bc_dst_port</a>
							
							<a class="list-group-item" href="#bc_err">bc_err</a>
							
							<a class="list-group-item" href="#bc_err_name">bc_err_name</a>
							
							<a class="list-group-item" href="#bc_err_str">bc_err_str</a>
							
							<a class="list-group-item" href="#bc_glitches">bc_glitches</a>
							
							<a class="list-group-item" href="#bc_http_major">bc_http_major</a>
							
							<a class="list-group-item" href="#bc_nb_streams">bc_nb_streams</a>
							
							<a class="list-group-item" href="#bc_rtt">bc_rtt</a>
							
							<a class="list-group-item" href="#bc_rttvar">bc_rttvar</a>
							
							<a class="list-group-item" href="#bc_settings_streams_limit">bc_settings_streams_limit</a>
							
							<a class="list-group-item" href="#bc_src">bc_src</a>
							
							<a class="list-group-item" href="#bc_src_port">bc_src_port</a>
							
							<a class="list-group-item" href="#bc_srv_queue">bc_srv_queue</a>
							
							<a class="list-group-item" href="#be2dec">be2dec</a>
							
							<a class="list-group-item" href="#be2hex">be2hex</a>
							
							<a class="list-group-item" href="#be_conn">be_conn</a>
							
							<a class="list-group-item" href="#be_conn_free">be_conn_free</a>
							
							<a class="list-group-item" href="#be_id">be_id</a>
							
							<a class="list-group-item" href="#be_name">be_name</a>
							
							<a class="list-group-item" href="#be_server_timeout">be_server_timeout</a>
							
							<a class="list-group-item" href="#be_sess_rate">be_sess_rate</a>
							
							<a class="list-group-item" href="#be_tunnel_timeout">be_tunnel_timeout</a>
							
							<a class="list-group-item" href="#bin">bin</a>
							
							<a class="list-group-item" href="#bind (Log forwarding)">bind (Log forwarding)</a>
							
							<a class="list-group-item" href="#bind (Peers)">bind (Peers)</a>
							
							<a class="list-group-item" href="#bind (Alphabetically sorted keywords reference)">bind (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#bool (Converters)">bool (Converters)</a>
							
							<a class="list-group-item" href="#bool (Fetching samples from internal states)">bool (Fetching samples from internal states)</a>
							
							<a class="list-group-item" href="#bs.aborted">bs.aborted</a>
							
							<a class="list-group-item" href="#bs.debug_str">bs.debug_str</a>
							
							<a class="list-group-item" href="#bs.id">bs.id</a>
							
							<a class="list-group-item" href="#bs.rst_code">bs.rst_code</a>
							
							<a class="list-group-item" href="#busy-polling">busy-polling</a>
							
							<a class="list-group-item" href="#bytes">bytes</a>
							
							<a class="list-group-item" href="#bytes_in">bytes_in</a>
							
							<a class="list-group-item" href="#bytes_out">bytes_out</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-C"><h4>C</h4>
								
							<a class="list-group-item" href="#ca-base">ca-base</a>
							
							<a class="list-group-item" href="#ca-file (Bind options)">ca-file (Bind options)</a>
							
							<a class="list-group-item" href="#ca-file (Server and default-server options)">ca-file (Server and default-server options)</a>
							
							<a class="list-group-item" href="#ca-ignore-err">ca-ignore-err</a>
							
							<a class="list-group-item" href="#ca-sign-file">ca-sign-file</a>
							
							<a class="list-group-item" href="#ca-sign-pass">ca-sign-pass</a>
							
							<a class="list-group-item" href="#ca-verify-file">ca-verify-file</a>
							
							<a class="list-group-item" href="#cache">cache</a>
							
							<a class="list-group-item" href="#cache-store">cache-store</a>
							
							<a class="list-group-item" href="#cache-use">cache-use</a>
							
							<a class="list-group-item" href="#capture (Alphabetically sorted keywords reference)">capture (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#capture (Alphabetically sorted actions reference)">capture (Alphabetically sorted actions reference)</a>
							
							<a class="list-group-item" href="#capture cookie">capture cookie</a>
							
							<a class="list-group-item" href="#capture request">capture request</a>
							
							<a class="list-group-item" href="#capture request header">capture request header</a>
							
							<a class="list-group-item" href="#capture response">capture response</a>
							
							<a class="list-group-item" href="#capture response header">capture response header</a>
							
							<a class="list-group-item" href="#capture-req">capture-req</a>
							
							<a class="list-group-item" href="#capture-res">capture-res</a>
							
							<a class="list-group-item" href="#capture.req.hdr">capture.req.hdr</a>
							
							<a class="list-group-item" href="#capture.req.method">capture.req.method</a>
							
							<a class="list-group-item" href="#capture.req.uri">capture.req.uri</a>
							
							<a class="list-group-item" href="#capture.req.ver">capture.req.ver</a>
							
							<a class="list-group-item" href="#capture.res.hdr">capture.res.hdr</a>
							
							<a class="list-group-item" href="#capture.res.ver">capture.res.ver</a>
							
							<a class="list-group-item" href="#check">check</a>
							
							<a class="list-group-item" href="#check-alpn">check-alpn</a>
							
							<a class="list-group-item" href="#check-proto">check-proto</a>
							
							<a class="list-group-item" href="#check-send-proxy">check-send-proxy</a>
							
							<a class="list-group-item" href="#check-sni">check-sni</a>
							
							<a class="list-group-item" href="#check-ssl">check-ssl</a>
							
							<a class="list-group-item" href="#check-via-socks4">check-via-socks4</a>
							
							<a class="list-group-item" href="#chroot">chroot</a>
							
							<a class="list-group-item" href="#ciphers (Bind options)">ciphers (Bind options)</a>
							
							<a class="list-group-item" href="#ciphers (Server and default-server options)">ciphers (Server and default-server options)</a>
							
							<a class="list-group-item" href="#ciphersuites (Bind options)">ciphersuites (Bind options)</a>
							
							<a class="list-group-item" href="#ciphersuites (Server and default-server options)">ciphersuites (Server and default-server options)</a>
							
							<a class="list-group-item" href="#client-sigalgs (Bind options)">client-sigalgs (Bind options)</a>
							
							<a class="list-group-item" href="#client-sigalgs (Server and default-server options)">client-sigalgs (Server and default-server options)</a>
							
							<a class="list-group-item" href="#clitcpka-cnt">clitcpka-cnt</a>
							
							<a class="list-group-item" href="#clitcpka-idle">clitcpka-idle</a>
							
							<a class="list-group-item" href="#clitcpka-intvl">clitcpka-intvl</a>
							
							<a class="list-group-item" href="#close">close</a>
							
							<a class="list-group-item" href="#close-spread-time">close-spread-time</a>
							
							<a class="list-group-item" href="#cluster-secret">cluster-secret</a>
							
							<a class="list-group-item" href="#command">command</a>
							
							<a class="list-group-item" href="#compression">compression</a>
							
							<a class="list-group-item" href="#compression algo">compression algo</a>
							
							<a class="list-group-item" href="#compression algo-req">compression algo-req</a>
							
							<a class="list-group-item" href="#compression algo-res">compression algo-res</a>
							
							<a class="list-group-item" href="#compression direction">compression direction</a>
							
							<a class="list-group-item" href="#compression offload">compression offload</a>
							
							<a class="list-group-item" href="#compression type">compression type</a>
							
							<a class="list-group-item" href="#concat">concat</a>
							
							<a class="list-group-item" href="#connslots">connslots</a>
							
							<a class="list-group-item" href="#cook">cook</a>
							
							<a class="list-group-item" href="#cook_cnt">cook_cnt</a>
							
							<a class="list-group-item" href="#cook_val">cook_val</a>
							
							<a class="list-group-item" href="#cookie (Alphabetically sorted keywords reference)">cookie (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#cookie (Server and default-server options)">cookie (Server and default-server options)</a>
							
							<a class="list-group-item" href="#cookie (Fetching HTTP samples (Layer 7))">cookie (Fetching HTTP samples (Layer 7))</a>
							
							<a class="list-group-item" href="#cpl">cpl</a>
							
							<a class="list-group-item" href="#cpu-map">cpu-map</a>
							
							<a class="list-group-item" href="#cpu_calls">cpu_calls</a>
							
							<a class="list-group-item" href="#cpu_ns_avg">cpu_ns_avg</a>
							
							<a class="list-group-item" href="#cpu_ns_tot">cpu_ns_tot</a>
							
							<a class="list-group-item" href="#crc32">crc32</a>
							
							<a class="list-group-item" href="#crc32c">crc32c</a>
							
							<a class="list-group-item" href="#crl-file (Bind options)">crl-file (Bind options)</a>
							
							<a class="list-group-item" href="#crl-file (Server and default-server options)">crl-file (Server and default-server options)</a>
							
							<a class="list-group-item" href="#crt (Load options)">crt (Load options)</a>
							
							<a class="list-group-item" href="#crt (Bind options)">crt (Bind options)</a>
							
							<a class="list-group-item" href="#crt (Server and default-server options)">crt (Server and default-server options)</a>
							
							<a class="list-group-item" href="#crt-base (Process management and security)">crt-base (Process management and security)</a>
							
							<a class="list-group-item" href="#crt-base (Certificate Storage)">crt-base (Certificate Storage)</a>
							
							<a class="list-group-item" href="#crt-ignore-err">crt-ignore-err</a>
							
							<a class="list-group-item" href="#crt-list">crt-list</a>
							
							<a class="list-group-item" href="#cur_client_timeout">cur_client_timeout</a>
							
							<a class="list-group-item" href="#cur_server_timeout">cur_server_timeout</a>
							
							<a class="list-group-item" href="#cur_tunnel_timeout">cur_tunnel_timeout</a>
							
							<a class="list-group-item" href="#curves (Bind options)">curves (Bind options)</a>
							
							<a class="list-group-item" href="#curves (Server and default-server options)">curves (Server and default-server options)</a>
							
							<a class="list-group-item" href="#cut_crlf">cut_crlf</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-D"><h4>D</h4>
								
							<a class="list-group-item" href="#da-csv-conv">da-csv-conv</a>
							
							<a class="list-group-item" href="#daemon">daemon</a>
							
							<a class="list-group-item" href="#date">date</a>
							
							<a class="list-group-item" href="#date_us">date_us</a>
							
							<a class="list-group-item" href="#debug">debug</a>
							
							<a class="list-group-item" href="#declare">declare</a>
							
							<a class="list-group-item" href="#declare capture">declare capture</a>
							
							<a class="list-group-item" href="#default-bind">default-bind</a>
							
							<a class="list-group-item" href="#default-crt">default-crt</a>
							
							<a class="list-group-item" href="#default-path">default-path</a>
							
							<a class="list-group-item" href="#default-server (Peers)">default-server (Peers)</a>
							
							<a class="list-group-item" href="#default-server (Alphabetically sorted keywords reference)">default-server (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#default_backend">default_backend</a>
							
							<a class="list-group-item" href="#defer-accept">defer-accept</a>
							
							<a class="list-group-item" href="#del-acl">del-acl</a>
							
							<a class="list-group-item" href="#del-header">del-header</a>
							
							<a class="list-group-item" href="#del-map">del-map</a>
							
							<a class="list-group-item" href="#deny">deny</a>
							
							<a class="list-group-item" href="#description (Process management and security)">description (Process management and security)</a>
							
							<a class="list-group-item" href="#description (Rings)">description (Rings)</a>
							
							<a class="list-group-item" href="#description (Alphabetically sorted keywords reference)">description (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#deviceatlas-json-file">deviceatlas-json-file</a>
							
							<a class="list-group-item" href="#deviceatlas-log-level">deviceatlas-log-level</a>
							
							<a class="list-group-item" href="#deviceatlas-properties-cookie">deviceatlas-properties-cookie</a>
							
							<a class="list-group-item" href="#deviceatlas-separator">deviceatlas-separator</a>
							
							<a class="list-group-item" href="#dgram-bind">dgram-bind</a>
							
							<a class="list-group-item" href="#dgram-drop">dgram-drop</a>
							
							<a class="list-group-item" href="#digest">digest</a>
							
							<a class="list-group-item" href="#disable-l7-retry">disable-l7-retry</a>
							
							<a class="list-group-item" href="#disabled (Peers)">disabled (Peers)</a>
							
							<a class="list-group-item" href="#disabled (Alphabetically sorted keywords reference)">disabled (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#disabled (Server and default-server options)">disabled (Server and default-server options)</a>
							
							<a class="list-group-item" href="#dispatch">dispatch</a>
							
							<a class="list-group-item" href="#distcc_body">distcc_body</a>
							
							<a class="list-group-item" href="#distcc_param">distcc_param</a>
							
							<a class="list-group-item" href="#div">div</a>
							
							<a class="list-group-item" href="#djb2">djb2</a>
							
							<a class="list-group-item" href="#do-log">do-log</a>
							
							<a class="list-group-item" href="#do-resolve">do-resolve</a>
							
							<a class="list-group-item" href="#docroot">docroot</a>
							
							<a class="list-group-item" href="#downinter">downinter</a>
							
							<a class="list-group-item" href="#dst">dst</a>
							
							<a class="list-group-item" href="#dst_conn">dst_conn</a>
							
							<a class="list-group-item" href="#dst_is_local">dst_is_local</a>
							
							<a class="list-group-item" href="#dst_port">dst_port</a>
							
							<a class="list-group-item" href="#dynamic-cookie-key">dynamic-cookie-key</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-E"><h4>E</h4>
								
							<a class="list-group-item" href="#early-hint">early-hint</a>
							
							<a class="list-group-item" href="#ecdhe">ecdhe</a>
							
							<a class="list-group-item" href="#email-alert">email-alert</a>
							
							<a class="list-group-item" href="#email-alert from">email-alert from</a>
							
							<a class="list-group-item" href="#email-alert level">email-alert level</a>
							
							<a class="list-group-item" href="#email-alert mailers">email-alert mailers</a>
							
							<a class="list-group-item" href="#email-alert myhostname">email-alert myhostname</a>
							
							<a class="list-group-item" href="#email-alert to">email-alert to</a>
							
							<a class="list-group-item" href="#enabled (Peers)">enabled (Peers)</a>
							
							<a class="list-group-item" href="#enabled (Alphabetically sorted keywords reference)">enabled (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#enabled (Server and default-server options)">enabled (Server and default-server options)</a>
							
							<a class="list-group-item" href="#env">env</a>
							
							<a class="list-group-item" href="#error-limit">error-limit</a>
							
							<a class="list-group-item" href="#error-log-format">error-log-format</a>
							
							<a class="list-group-item" href="#errorfile (HTTP-errors)">errorfile (HTTP-errors)</a>
							
							<a class="list-group-item" href="#errorfile (Alphabetically sorted keywords reference)">errorfile (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#errorfiles">errorfiles</a>
							
							<a class="list-group-item" href="#errorloc">errorloc</a>
							
							<a class="list-group-item" href="#errorloc302">errorloc302</a>
							
							<a class="list-group-item" href="#errorloc303">errorloc303</a>
							
							<a class="list-group-item" href="#even">even</a>
							
							<a class="list-group-item" href="#expect-netscaler-cip">expect-netscaler-cip</a>
							
							<a class="list-group-item" href="#expect-netscaler-cip layer4">expect-netscaler-cip layer4</a>
							
							<a class="list-group-item" href="#expect-proxy">expect-proxy</a>
							
							<a class="list-group-item" href="#expect-proxy layer4">expect-proxy layer4</a>
							
							<a class="list-group-item" href="#expose-deprecated-directives">expose-deprecated-directives</a>
							
							<a class="list-group-item" href="#expose-experimental-directives">expose-experimental-directives</a>
							
							<a class="list-group-item" href="#expose-fd">expose-fd</a>
							
							<a class="list-group-item" href="#expose-fd listeners">expose-fd listeners</a>
							
							<a class="list-group-item" href="#external-check">external-check</a>
							
							<a class="list-group-item" href="#external-check command">external-check command</a>
							
							<a class="list-group-item" href="#external-check path">external-check path</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-F"><h4>F</h4>
								
							<a class="list-group-item" href="#fall">fall</a>
							
							<a class="list-group-item" href="#fastinter">fastinter</a>
							
							<a class="list-group-item" href="#fc.timer.handshake">fc.timer.handshake</a>
							
							<a class="list-group-item" href="#fc.timer.total">fc.timer.total</a>
							
							<a class="list-group-item" href="#fc_dst">fc_dst</a>
							
							<a class="list-group-item" href="#fc_dst_is_local">fc_dst_is_local</a>
							
							<a class="list-group-item" href="#fc_dst_port">fc_dst_port</a>
							
							<a class="list-group-item" href="#fc_err">fc_err</a>
							
							<a class="list-group-item" href="#fc_err_name">fc_err_name</a>
							
							<a class="list-group-item" href="#fc_err_str">fc_err_str</a>
							
							<a class="list-group-item" href="#fc_fackets">fc_fackets</a>
							
							<a class="list-group-item" href="#fc_glitches">fc_glitches</a>
							
							<a class="list-group-item" href="#fc_http_major">fc_http_major</a>
							
							<a class="list-group-item" href="#fc_lost">fc_lost</a>
							
							<a class="list-group-item" href="#fc_nb_streams">fc_nb_streams</a>
							
							<a class="list-group-item" href="#fc_pp_authority">fc_pp_authority</a>
							
							<a class="list-group-item" href="#fc_pp_tlv">fc_pp_tlv</a>
							
							<a class="list-group-item" href="#fc_pp_unique_id">fc_pp_unique_id</a>
							
							<a class="list-group-item" href="#fc_rcvd_proxy">fc_rcvd_proxy</a>
							
							<a class="list-group-item" href="#fc_reordering">fc_reordering</a>
							
							<a class="list-group-item" href="#fc_retrans">fc_retrans</a>
							
							<a class="list-group-item" href="#fc_rtt">fc_rtt</a>
							
							<a class="list-group-item" href="#fc_rttvar">fc_rttvar</a>
							
							<a class="list-group-item" href="#fc_sacked">fc_sacked</a>
							
							<a class="list-group-item" href="#fc_settings_streams_limit">fc_settings_streams_limit</a>
							
							<a class="list-group-item" href="#fc_src">fc_src</a>
							
							<a class="list-group-item" href="#fc_src_is_local">fc_src_is_local</a>
							
							<a class="list-group-item" href="#fc_src_port">fc_src_port</a>
							
							<a class="list-group-item" href="#fc_unacked">fc_unacked</a>
							
							<a class="list-group-item" href="#fcgi-app">fcgi-app</a>
							
							<a class="list-group-item" href="#fd-hard-limit">fd-hard-limit</a>
							
							<a class="list-group-item" href="#fe_client_timeout">fe_client_timeout</a>
							
							<a class="list-group-item" href="#fe_conn">fe_conn</a>
							
							<a class="list-group-item" href="#fe_defbe">fe_defbe</a>
							
							<a class="list-group-item" href="#fe_id">fe_id</a>
							
							<a class="list-group-item" href="#fe_name">fe_name</a>
							
							<a class="list-group-item" href="#fe_req_rate">fe_req_rate</a>
							
							<a class="list-group-item" href="#fe_sess_rate">fe_sess_rate</a>
							
							<a class="list-group-item" href="#field">field</a>
							
							<a class="list-group-item" href="#filter (Alphabetically sorted keywords reference)">filter (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#filter (Trace)">filter (Trace)</a>
							
							<a class="list-group-item" href="#filter (HTTP compression)">filter (HTTP compression)</a>
							
							<a class="list-group-item" href="#filter (Stream Processing Offload Engine (SPOE))">filter (Stream Processing Offload Engine (SPOE))</a>
							
							<a class="list-group-item" href="#filter (Cache)">filter (Cache)</a>
							
							<a class="list-group-item" href="#filter (fcgi-app)">filter (fcgi-app)</a>
							
							<a class="list-group-item" href="#filter (OpenTracing)">filter (OpenTracing)</a>
							
							<a class="list-group-item" href="#filter (Bandwidth limitation)">filter (Bandwidth limitation)</a>
							
							<a class="list-group-item" href="#filter bwlim-in">filter bwlim-in</a>
							
							<a class="list-group-item" href="#filter bwlim-out">filter bwlim-out</a>
							
							<a class="list-group-item" href="#filter cache">filter cache</a>
							
							<a class="list-group-item" href="#filter compression">filter compression</a>
							
							<a class="list-group-item" href="#filter fcgi-app">filter fcgi-app</a>
							
							<a class="list-group-item" href="#filter opentracing">filter opentracing</a>
							
							<a class="list-group-item" href="#filter spoe">filter spoe</a>
							
							<a class="list-group-item" href="#filter trace">filter trace</a>
							
							<a class="list-group-item" href="#fix_is_valid">fix_is_valid</a>
							
							<a class="list-group-item" href="#fix_tag_value">fix_tag_value</a>
							
							<a class="list-group-item" href="#force-cfg-parser-pause">force-cfg-parser-pause</a>
							
							<a class="list-group-item" href="#force-persist">force-persist</a>
							
							<a class="list-group-item" href="#force-sslv3">force-sslv3</a>
							
							<a class="list-group-item" href="#force-tlsv10">force-tlsv10</a>
							
							<a class="list-group-item" href="#force-tlsv11">force-tlsv11</a>
							
							<a class="list-group-item" href="#force-tlsv12">force-tlsv12</a>
							
							<a class="list-group-item" href="#force-tlsv13">force-tlsv13</a>
							
							<a class="list-group-item" href="#format">format</a>
							
							<a class="list-group-item" href="#fs.aborted">fs.aborted</a>
							
							<a class="list-group-item" href="#fs.debug_str">fs.debug_str</a>
							
							<a class="list-group-item" href="#fs.id">fs.id</a>
							
							<a class="list-group-item" href="#fs.rst_code">fs.rst_code</a>
							
							<a class="list-group-item" href="#fullconn">fullconn</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-G"><h4>G</h4>
								
							<a class="list-group-item" href="#generate-certificates">generate-certificates</a>
							
							<a class="list-group-item" href="#gid (Process management and security)">gid (Process management and security)</a>
							
							<a class="list-group-item" href="#gid (Bind options)">gid (Bind options)</a>
							
							<a class="list-group-item" href="#grace">grace</a>
							
							<a class="list-group-item" href="#group (Process management and security)">group (Process management and security)</a>
							
							<a class="list-group-item" href="#group (Userlists)">group (Userlists)</a>
							
							<a class="list-group-item" href="#group (Programs (deprecated))">group (Programs (deprecated))</a>
							
							<a class="list-group-item" href="#group (Bind options)">group (Bind options)</a>
							
							<a class="list-group-item" href="#guid (Alphabetically sorted keywords reference)">guid (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#guid (Server and default-server options)">guid (Server and default-server options)</a>
							
							<a class="list-group-item" href="#guid-prefix">guid-prefix</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-H"><h4>H</h4>
								
							<a class="list-group-item" href="#h1-accept-payload-with-any-method">h1-accept-payload-with-any-method</a>
							
							<a class="list-group-item" href="#h1-case-adjust">h1-case-adjust</a>
							
							<a class="list-group-item" href="#h1-case-adjust-file">h1-case-adjust-file</a>
							
							<a class="list-group-item" href="#h1-do-not-close-on-insecure-transfer-encoding">h1-do-not-close-on-insecure-transfer-encoding</a>
							
							<a class="list-group-item" href="#h2-workaround-bogus-websocket-clients">h2-workaround-bogus-websocket-clients</a>
							
							<a class="list-group-item" href="#hard-stop-after">hard-stop-after</a>
							
							<a class="list-group-item" href="#harden.reject-privileged-ports.quic">harden.reject-privileged-ports.quic</a>
							
							<a class="list-group-item" href="#harden.reject-privileged-ports.tcp">harden.reject-privileged-ports.tcp</a>
							
							<a class="list-group-item" href="#hash-balance-factor">hash-balance-factor</a>
							
							<a class="list-group-item" href="#hash-key">hash-key</a>
							
							<a class="list-group-item" href="#hash-type">hash-type</a>
							
							<a class="list-group-item" href="#hdr">hdr</a>
							
							<a class="list-group-item" href="#hdr_cnt">hdr_cnt</a>
							
							<a class="list-group-item" href="#hdr_ip">hdr_ip</a>
							
							<a class="list-group-item" href="#hdr_val">hdr_val</a>
							
							<a class="list-group-item" href="#hex">hex</a>
							
							<a class="list-group-item" href="#hex2i">hex2i</a>
							
							<a class="list-group-item" href="#hmac">hmac</a>
							
							<a class="list-group-item" href="#hold">hold</a>
							
							<a class="list-group-item" href="#host_only">host_only</a>
							
							<a class="list-group-item" href="#hostname">hostname</a>
							
							<a class="list-group-item" href="#htonl">htonl</a>
							
							<a class="list-group-item" href="#http-after-response">http-after-response</a>
							
							<a class="list-group-item" href="#http-check">http-check</a>
							
							<a class="list-group-item" href="#http-check comment">http-check comment</a>
							
							<a class="list-group-item" href="#http-check connect">http-check connect</a>
							
							<a class="list-group-item" href="#http-check disable-on-404">http-check disable-on-404</a>
							
							<a class="list-group-item" href="#http-check expect">http-check expect</a>
							
							<a class="list-group-item" href="#http-check send">http-check send</a>
							
							<a class="list-group-item" href="#http-check send-state">http-check send-state</a>
							
							<a class="list-group-item" href="#http-check set-var">http-check set-var</a>
							
							<a class="list-group-item" href="#http-check set-var-fmt">http-check set-var-fmt</a>
							
							<a class="list-group-item" href="#http-check unset-var">http-check unset-var</a>
							
							<a class="list-group-item" href="#http-err-codes">http-err-codes</a>
							
							<a class="list-group-item" href="#http-error">http-error</a>
							
							<a class="list-group-item" href="#http-error status">http-error status</a>
							
							<a class="list-group-item" href="#http-errors">http-errors</a>
							
							<a class="list-group-item" href="#http-fail-codes">http-fail-codes</a>
							
							<a class="list-group-item" href="#http-request">http-request</a>
							
							<a class="list-group-item" href="#http-response">http-response</a>
							
							<a class="list-group-item" href="#http-reuse">http-reuse</a>
							
							<a class="list-group-item" href="#http-send-name-header">http-send-name-header</a>
							
							<a class="list-group-item" href="#http_auth">http_auth</a>
							
							<a class="list-group-item" href="#http_auth_bearer">http_auth_bearer</a>
							
							<a class="list-group-item" href="#http_auth_group">http_auth_group</a>
							
							<a class="list-group-item" href="#http_auth_pass">http_auth_pass</a>
							
							<a class="list-group-item" href="#http_auth_type">http_auth_type</a>
							
							<a class="list-group-item" href="#http_auth_user">http_auth_user</a>
							
							<a class="list-group-item" href="#http_date">http_date</a>
							
							<a class="list-group-item" href="#http_first_req">http_first_req</a>
							
							<a class="list-group-item" href="#httpclient.resolvers.disabled">httpclient.resolvers.disabled</a>
							
							<a class="list-group-item" href="#httpclient.resolvers.id">httpclient.resolvers.id</a>
							
							<a class="list-group-item" href="#httpclient.resolvers.prefer">httpclient.resolvers.prefer</a>
							
							<a class="list-group-item" href="#httpclient.retries">httpclient.retries</a>
							
							<a class="list-group-item" href="#httpclient.ssl.ca-file">httpclient.ssl.ca-file</a>
							
							<a class="list-group-item" href="#httpclient.ssl.verify">httpclient.ssl.verify</a>
							
							<a class="list-group-item" href="#httpclient.timeout.connect">httpclient.timeout.connect</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-I"><h4>I</h4>
								
							<a class="list-group-item" href="#id (Alphabetically sorted keywords reference)">id (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#id (Bind options)">id (Bind options)</a>
							
							<a class="list-group-item" href="#id (Server and default-server options)">id (Server and default-server options)</a>
							
							<a class="list-group-item" href="#ignore-persist">ignore-persist</a>
							
							<a class="list-group-item" href="#iif">iif</a>
							
							<a class="list-group-item" href="#in_table">in_table</a>
							
							<a class="list-group-item" href="#index">index</a>
							
							<a class="list-group-item" href="#init-addr">init-addr</a>
							
							<a class="list-group-item" href="#init-state">init-state</a>
							
							<a class="list-group-item" href="#insecure-fork-wanted">insecure-fork-wanted</a>
							
							<a class="list-group-item" href="#insecure-setuid-wanted">insecure-setuid-wanted</a>
							
							<a class="list-group-item" href="#int">int</a>
							
							<a class="list-group-item" href="#inter">inter</a>
							
							<a class="list-group-item" href="#interface">interface</a>
							
							<a class="list-group-item" href="#internal.htx.data">internal.htx.data</a>
							
							<a class="list-group-item" href="#internal.htx.free">internal.htx.free</a>
							
							<a class="list-group-item" href="#internal.htx.free_data">internal.htx.free_data</a>
							
							<a class="list-group-item" href="#internal.htx.has_eom">internal.htx.has_eom</a>
							
							<a class="list-group-item" href="#internal.htx.nbblks">internal.htx.nbblks</a>
							
							<a class="list-group-item" href="#internal.htx.size">internal.htx.size</a>
							
							<a class="list-group-item" href="#internal.htx.used">internal.htx.used</a>
							
							<a class="list-group-item" href="#internal.htx_blk.data">internal.htx_blk.data</a>
							
							<a class="list-group-item" href="#internal.htx_blk.hdrname">internal.htx_blk.hdrname</a>
							
							<a class="list-group-item" href="#internal.htx_blk.hdrval">internal.htx_blk.hdrval</a>
							
							<a class="list-group-item" href="#internal.htx_blk.size">internal.htx_blk.size</a>
							
							<a class="list-group-item" href="#internal.htx_blk.start_line">internal.htx_blk.start_line</a>
							
							<a class="list-group-item" href="#internal.htx_blk.type">internal.htx_blk.type</a>
							
							<a class="list-group-item" href="#internal.strm.is_htx">internal.strm.is_htx</a>
							
							<a class="list-group-item" href="#ipmask">ipmask</a>
							
							<a class="list-group-item" href="#ipv4">ipv4</a>
							
							<a class="list-group-item" href="#ipv6">ipv6</a>
							
							<a class="list-group-item" href="#issuer">issuer</a>
							
							<a class="list-group-item" href="#issuers-chain-path">issuers-chain-path</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-J"><h4>J</h4>
								
							<a class="list-group-item" href="#json">json</a>
							
							<a class="list-group-item" href="#json_query">json_query</a>
							
							<a class="list-group-item" href="#jwt_header_query">jwt_header_query</a>
							
							<a class="list-group-item" href="#jwt_payload_query">jwt_payload_query</a>
							
							<a class="list-group-item" href="#jwt_verify">jwt_verify</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-K"><h4>K</h4>
								
							<a class="list-group-item" href="#key">key</a>
							
							<a class="list-group-item" href="#key-base (Process management and security)">key-base (Process management and security)</a>
							
							<a class="list-group-item" href="#key-base (Certificate Storage)">key-base (Certificate Storage)</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-L"><h4>L</h4>
								
							<a class="list-group-item" href="#language">language</a>
							
							<a class="list-group-item" href="#last_entity">last_entity</a>
							
							<a class="list-group-item" href="#last_rule_file">last_rule_file</a>
							
							<a class="list-group-item" href="#last_rule_line">last_rule_line</a>
							
							<a class="list-group-item" href="#lat_ns_avg">lat_ns_avg</a>
							
							<a class="list-group-item" href="#lat_ns_tot">lat_ns_tot</a>
							
							<a class="list-group-item" href="#length">length</a>
							
							<a class="list-group-item" href="#level">level</a>
							
							<a class="list-group-item" href="#limited-quic">limited-quic</a>
							
							<a class="list-group-item" href="#load">load</a>
							
							<a class="list-group-item" href="#load-server-state-from-file">load-server-state-from-file</a>
							
							<a class="list-group-item" href="#localpeer">localpeer</a>
							
							<a class="list-group-item" href="#log (Process management and security)">log (Process management and security)</a>
							
							<a class="list-group-item" href="#log (Log forwarding)">log (Log forwarding)</a>
							
							<a class="list-group-item" href="#log (Peers)">log (Peers)</a>
							
							<a class="list-group-item" href="#log (Alphabetically sorted keywords reference)">log (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#log global (Log forwarding)">log global (Log forwarding)</a>
							
							<a class="list-group-item" href="#log global (Alphabetically sorted keywords reference)">log global (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#log-bufsize">log-bufsize</a>
							
							<a class="list-group-item" href="#log-format">log-format</a>
							
							<a class="list-group-item" href="#log-format-sd">log-format-sd</a>
							
							<a class="list-group-item" href="#log-forward">log-forward</a>
							
							<a class="list-group-item" href="#log-profile">log-profile</a>
							
							<a class="list-group-item" href="#log-proto">log-proto</a>
							
							<a class="list-group-item" href="#log-send-hostname">log-send-hostname</a>
							
							<a class="list-group-item" href="#log-stderr">log-stderr</a>
							
							<a class="list-group-item" href="#log-stderr global">log-stderr global</a>
							
							<a class="list-group-item" href="#log-steps">log-steps</a>
							
							<a class="list-group-item" href="#log-tag (Process management and security)">log-tag (Process management and security)</a>
							
							<a class="list-group-item" href="#log-tag (Alphabetically sorted keywords reference)">log-tag (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#log-tag (Log profiles)">log-tag (Log profiles)</a>
							
							<a class="list-group-item" href="#lower">lower</a>
							
							<a class="list-group-item" href="#ltime">ltime</a>
							
							<a class="list-group-item" href="#ltrim">ltrim</a>
							
							<a class="list-group-item" href="#lua-load">lua-load</a>
							
							<a class="list-group-item" href="#lua-load-per-thread">lua-load-per-thread</a>
							
							<a class="list-group-item" href="#lua-prepend-path">lua-prepend-path</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-M"><h4>M</h4>
								
							<a class="list-group-item" href="#mailer">mailer</a>
							
							<a class="list-group-item" href="#mailers">mailers</a>
							
							<a class="list-group-item" href="#map">map</a>
							
							<a class="list-group-item" href="#master-worker">master-worker</a>
							
							<a class="list-group-item" href="#max-age">max-age</a>
							
							<a class="list-group-item" href="#max-keep-alive-queue">max-keep-alive-queue</a>
							
							<a class="list-group-item" href="#max-object-size">max-object-size</a>
							
							<a class="list-group-item" href="#max-reuse">max-reuse</a>
							
							<a class="list-group-item" href="#max-secondary-entries">max-secondary-entries</a>
							
							<a class="list-group-item" href="#max-session-srv-conns">max-session-srv-conns</a>
							
							<a class="list-group-item" href="#max-spread-checks">max-spread-checks</a>
							
							<a class="list-group-item" href="#maxcompcpuusage">maxcompcpuusage</a>
							
							<a class="list-group-item" href="#maxcomprate">maxcomprate</a>
							
							<a class="list-group-item" href="#maxconn (Log forwarding)">maxconn (Log forwarding)</a>
							
							<a class="list-group-item" href="#maxconn (Performance tuning)">maxconn (Performance tuning)</a>
							
							<a class="list-group-item" href="#maxconn (Alphabetically sorted keywords reference)">maxconn (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#maxconn (Bind options)">maxconn (Bind options)</a>
							
							<a class="list-group-item" href="#maxconn (Server and default-server options)">maxconn (Server and default-server options)</a>
							
							<a class="list-group-item" href="#maxconnrate">maxconnrate</a>
							
							<a class="list-group-item" href="#maxlen">maxlen</a>
							
							<a class="list-group-item" href="#maxpipes">maxpipes</a>
							
							<a class="list-group-item" href="#maxqueue">maxqueue</a>
							
							<a class="list-group-item" href="#maxsessrate">maxsessrate</a>
							
							<a class="list-group-item" href="#maxsslconn">maxsslconn</a>
							
							<a class="list-group-item" href="#maxsslrate">maxsslrate</a>
							
							<a class="list-group-item" href="#maxzlibmem">maxzlibmem</a>
							
							<a class="list-group-item" href="#meth">meth</a>
							
							<a class="list-group-item" href="#method">method</a>
							
							<a class="list-group-item" href="#minconn">minconn</a>
							
							<a class="list-group-item" href="#mod">mod</a>
							
							<a class="list-group-item" href="#mode (Alphabetically sorted keywords reference)">mode (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#mode (Bind options)">mode (Bind options)</a>
							
							<a class="list-group-item" href="#monitor">monitor</a>
							
							<a class="list-group-item" href="#monitor fail">monitor fail</a>
							
							<a class="list-group-item" href="#monitor-uri">monitor-uri</a>
							
							<a class="list-group-item" href="#mqtt_field_value">mqtt_field_value</a>
							
							<a class="list-group-item" href="#mqtt_is_valid">mqtt_is_valid</a>
							
							<a class="list-group-item" href="#ms_ltime">ms_ltime</a>
							
							<a class="list-group-item" href="#ms_utime">ms_utime</a>
							
							<a class="list-group-item" href="#mss">mss</a>
							
							<a class="list-group-item" href="#mul">mul</a>
							
							<a class="list-group-item" href="#mworker-max-reloads">mworker-max-reloads</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-N"><h4>N</h4>
								
							<a class="list-group-item" href="#name">name</a>
							
							<a class="list-group-item" href="#nameserver">nameserver</a>
							
							<a class="list-group-item" href="#namespace (Bind options)">namespace (Bind options)</a>
							
							<a class="list-group-item" href="#namespace (Server and default-server options)">namespace (Server and default-server options)</a>
							
							<a class="list-group-item" href="#nbconn">nbconn</a>
							
							<a class="list-group-item" href="#nbsrv (Converters)">nbsrv (Converters)</a>
							
							<a class="list-group-item" href="#nbsrv (Fetching samples from internal states)">nbsrv (Fetching samples from internal states)</a>
							
							<a class="list-group-item" href="#nbthread">nbthread</a>
							
							<a class="list-group-item" href="#neg">neg</a>
							
							<a class="list-group-item" href="#nice">nice</a>
							
							<a class="list-group-item" href="#no log">no log</a>
							
							<a class="list-group-item" href="#no option">no option</a>
							
							<a class="list-group-item" href="#no option abortonclose">no option abortonclose</a>
							
							<a class="list-group-item" href="#no option accept-invalid-http-request">no option accept-invalid-http-request</a>
							
							<a class="list-group-item" href="#no option accept-invalid-http-response">no option accept-invalid-http-response</a>
							
							<a class="list-group-item" href="#no option accept-unsafe-violations-in-http-request">no option accept-unsafe-violations-in-http-request</a>
							
							<a class="list-group-item" href="#no option accept-unsafe-violations-in-http-response">no option accept-unsafe-violations-in-http-response</a>
							
							<a class="list-group-item" href="#no option allbackups">no option allbackups</a>
							
							<a class="list-group-item" href="#no option checkcache">no option checkcache</a>
							
							<a class="list-group-item" href="#no option clitcpka">no option clitcpka</a>
							
							<a class="list-group-item" href="#no option disable-h2-upgrade">no option disable-h2-upgrade</a>
							
							<a class="list-group-item" href="#no option dontlog-normal">no option dontlog-normal</a>
							
							<a class="list-group-item" href="#no option dontlognull">no option dontlognull</a>
							
							<a class="list-group-item" href="#no option forwarded">no option forwarded</a>
							
							<a class="list-group-item" href="#no option get-values">no option get-values</a>
							
							<a class="list-group-item" href="#no option h1-case-adjust-bogus-client">no option h1-case-adjust-bogus-client</a>
							
							<a class="list-group-item" href="#no option h1-case-adjust-bogus-server">no option h1-case-adjust-bogus-server</a>
							
							<a class="list-group-item" href="#no option http-buffer-request">no option http-buffer-request</a>
							
							<a class="list-group-item" href="#no option http-ignore-probes">no option http-ignore-probes</a>
							
							<a class="list-group-item" href="#no option http-keep-alive">no option http-keep-alive</a>
							
							<a class="list-group-item" href="#no option http-no-delay">no option http-no-delay</a>
							
							<a class="list-group-item" href="#no option http-pretend-keepalive">no option http-pretend-keepalive</a>
							
							<a class="list-group-item" href="#no option http-server-close">no option http-server-close</a>
							
							<a class="list-group-item" href="#no option http-use-proxy-header">no option http-use-proxy-header</a>
							
							<a class="list-group-item" href="#no option httpclose">no option httpclose</a>
							
							<a class="list-group-item" href="#no option idle-close-on-response">no option idle-close-on-response</a>
							
							<a class="list-group-item" href="#no option independent-streams">no option independent-streams</a>
							
							<a class="list-group-item" href="#no option keep-conn">no option keep-conn</a>
							
							<a class="list-group-item" href="#no option log-health-checks">no option log-health-checks</a>
							
							<a class="list-group-item" href="#no option log-separate-errors">no option log-separate-errors</a>
							
							<a class="list-group-item" href="#no option logasap">no option logasap</a>
							
							<a class="list-group-item" href="#no option mpxs-conns">no option mpxs-conns</a>
							
							<a class="list-group-item" href="#no option nolinger">no option nolinger</a>
							
							<a class="list-group-item" href="#no option persist">no option persist</a>
							
							<a class="list-group-item" href="#no option prefer-last-server">no option prefer-last-server</a>
							
							<a class="list-group-item" href="#no option redispatch">no option redispatch</a>
							
							<a class="list-group-item" href="#no option socket-stats">no option socket-stats</a>
							
							<a class="list-group-item" href="#no option splice-auto">no option splice-auto</a>
							
							<a class="list-group-item" href="#no option splice-request">no option splice-request</a>
							
							<a class="list-group-item" href="#no option splice-response">no option splice-response</a>
							
							<a class="list-group-item" href="#no option srvtcpka">no option srvtcpka</a>
							
							<a class="list-group-item" href="#no option start-on-reload">no option start-on-reload</a>
							
							<a class="list-group-item" href="#no option tcp-smart-accept">no option tcp-smart-accept</a>
							
							<a class="list-group-item" href="#no option tcp-smart-connect">no option tcp-smart-connect</a>
							
							<a class="list-group-item" href="#no option transparent">no option transparent</a>
							
							<a class="list-group-item" href="#no-agent-check">no-agent-check</a>
							
							<a class="list-group-item" href="#no-alpn">no-alpn</a>
							
							<a class="list-group-item" href="#no-backup">no-backup</a>
							
							<a class="list-group-item" href="#no-ca-names">no-ca-names</a>
							
							<a class="list-group-item" href="#no-check">no-check</a>
							
							<a class="list-group-item" href="#no-check-ssl">no-check-ssl</a>
							
							<a class="list-group-item" href="#no-memory-trimming">no-memory-trimming</a>
							
							<a class="list-group-item" href="#no-quic">no-quic</a>
							
							<a class="list-group-item" href="#no-send-proxy">no-send-proxy</a>
							
							<a class="list-group-item" href="#no-send-proxy-v2">no-send-proxy-v2</a>
							
							<a class="list-group-item" href="#no-send-proxy-v2-ssl">no-send-proxy-v2-ssl</a>
							
							<a class="list-group-item" href="#no-send-proxy-v2-ssl-cn">no-send-proxy-v2-ssl-cn</a>
							
							<a class="list-group-item" href="#no-ssl">no-ssl</a>
							
							<a class="list-group-item" href="#no-ssl-reuse">no-ssl-reuse</a>
							
							<a class="list-group-item" href="#no-sslv3">no-sslv3</a>
							
							<a class="list-group-item" href="#no-tfo">no-tfo</a>
							
							<a class="list-group-item" href="#no-tls-tickets (Bind options)">no-tls-tickets (Bind options)</a>
							
							<a class="list-group-item" href="#no-tls-tickets (Server and default-server options)">no-tls-tickets (Server and default-server options)</a>
							
							<a class="list-group-item" href="#no-tlsv10">no-tlsv10</a>
							
							<a class="list-group-item" href="#no-tlsv11">no-tlsv11</a>
							
							<a class="list-group-item" href="#no-tlsv12">no-tlsv12</a>
							
							<a class="list-group-item" href="#no-tlsv13">no-tlsv13</a>
							
							<a class="list-group-item" href="#no-verifyhost">no-verifyhost</a>
							
							<a class="list-group-item" href="#node">node</a>
							
							<a class="list-group-item" href="#noepoll">noepoll</a>
							
							<a class="list-group-item" href="#noevports">noevports</a>
							
							<a class="list-group-item" href="#nogetaddrinfo">nogetaddrinfo</a>
							
							<a class="list-group-item" href="#nokqueue">nokqueue</a>
							
							<a class="list-group-item" href="#non-stick">non-stick</a>
							
							<a class="list-group-item" href="#nopoll">nopoll</a>
							
							<a class="list-group-item" href="#noreuseport">noreuseport</a>
							
							<a class="list-group-item" href="#normalize-uri">normalize-uri</a>
							
							<a class="list-group-item" href="#normalize-uri fragment-encode">normalize-uri fragment-encode</a>
							
							<a class="list-group-item" href="#normalize-uri fragment-strip">normalize-uri fragment-strip</a>
							
							<a class="list-group-item" href="#normalize-uri path-merge-slashes">normalize-uri path-merge-slashes</a>
							
							<a class="list-group-item" href="#normalize-uri path-strip-dot">normalize-uri path-strip-dot</a>
							
							<a class="list-group-item" href="#normalize-uri path-strip-dotdot">normalize-uri path-strip-dotdot</a>
							
							<a class="list-group-item" href="#normalize-uri percent-decode-unreserved">normalize-uri percent-decode-unreserved</a>
							
							<a class="list-group-item" href="#normalize-uri percent-to-uppercase">normalize-uri percent-to-uppercase</a>
							
							<a class="list-group-item" href="#normalize-uri query-sort-by-name">normalize-uri query-sort-by-name</a>
							
							<a class="list-group-item" href="#nosplice">nosplice</a>
							
							<a class="list-group-item" href="#not">not</a>
							
							<a class="list-group-item" href="#npn (Bind options)">npn (Bind options)</a>
							
							<a class="list-group-item" href="#npn (Server and default-server options)">npn (Server and default-server options)</a>
							
							<a class="list-group-item" href="#numa-cpu-mapping">numa-cpu-mapping</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-O"><h4>O</h4>
								
							<a class="list-group-item" href="#observe">observe</a>
							
							<a class="list-group-item" href="#ocsp">ocsp</a>
							
							<a class="list-group-item" href="#ocsp-update">ocsp-update</a>
							
							<a class="list-group-item" href="#ocsp-update.disable">ocsp-update.disable</a>
							
							<a class="list-group-item" href="#ocsp-update.httpproxy">ocsp-update.httpproxy</a>
							
							<a class="list-group-item" href="#ocsp-update.maxdelay">ocsp-update.maxdelay</a>
							
							<a class="list-group-item" href="#ocsp-update.mindelay">ocsp-update.mindelay</a>
							
							<a class="list-group-item" href="#ocsp-update.mode">ocsp-update.mode</a>
							
							<a class="list-group-item" href="#odd">odd</a>
							
							<a class="list-group-item" href="#on">on</a>
							
							<a class="list-group-item" href="#on-error">on-error</a>
							
							<a class="list-group-item" href="#on-marked-down">on-marked-down</a>
							
							<a class="list-group-item" href="#on-marked-up">on-marked-up</a>
							
							<a class="list-group-item" href="#option">option</a>
							
							<a class="list-group-item" href="#option abortonclose">option abortonclose</a>
							
							<a class="list-group-item" href="#option accept-invalid-http-request">option accept-invalid-http-request</a>
							
							<a class="list-group-item" href="#option accept-invalid-http-response">option accept-invalid-http-response</a>
							
							<a class="list-group-item" href="#option accept-unsafe-violations-in-http-request">option accept-unsafe-violations-in-http-request</a>
							
							<a class="list-group-item" href="#option accept-unsafe-violations-in-http-response">option accept-unsafe-violations-in-http-response</a>
							
							<a class="list-group-item" href="#option allbackups">option allbackups</a>
							
							<a class="list-group-item" href="#option checkcache">option checkcache</a>
							
							<a class="list-group-item" href="#option clitcpka">option clitcpka</a>
							
							<a class="list-group-item" href="#option contstats">option contstats</a>
							
							<a class="list-group-item" href="#option disable-h2-upgrade">option disable-h2-upgrade</a>
							
							<a class="list-group-item" href="#option dontlog-normal">option dontlog-normal</a>
							
							<a class="list-group-item" href="#option dontlognull">option dontlognull</a>
							
							<a class="list-group-item" href="#option external-check">option external-check</a>
							
							<a class="list-group-item" href="#option forwarded">option forwarded</a>
							
							<a class="list-group-item" href="#option forwardfor">option forwardfor</a>
							
							<a class="list-group-item" href="#option get-values">option get-values</a>
							
							<a class="list-group-item" href="#option h1-case-adjust-bogus-client">option h1-case-adjust-bogus-client</a>
							
							<a class="list-group-item" href="#option h1-case-adjust-bogus-server">option h1-case-adjust-bogus-server</a>
							
							<a class="list-group-item" href="#option http-buffer-request">option http-buffer-request</a>
							
							<a class="list-group-item" href="#option http-ignore-probes">option http-ignore-probes</a>
							
							<a class="list-group-item" href="#option http-keep-alive">option http-keep-alive</a>
							
							<a class="list-group-item" href="#option http-no-delay">option http-no-delay</a>
							
							<a class="list-group-item" href="#option http-pretend-keepalive">option http-pretend-keepalive</a>
							
							<a class="list-group-item" href="#option http-restrict-req-hdr-names">option http-restrict-req-hdr-names</a>
							
							<a class="list-group-item" href="#option http-server-close">option http-server-close</a>
							
							<a class="list-group-item" href="#option http-use-proxy-header">option http-use-proxy-header</a>
							
							<a class="list-group-item" href="#option httpchk">option httpchk</a>
							
							<a class="list-group-item" href="#option httpclose">option httpclose</a>
							
							<a class="list-group-item" href="#option httplog">option httplog</a>
							
							<a class="list-group-item" href="#option httpslog">option httpslog</a>
							
							<a class="list-group-item" href="#option idle-close-on-response">option idle-close-on-response</a>
							
							<a class="list-group-item" href="#option independent-streams">option independent-streams</a>
							
							<a class="list-group-item" href="#option keep-conn">option keep-conn</a>
							
							<a class="list-group-item" href="#option ldap-check">option ldap-check</a>
							
							<a class="list-group-item" href="#option log-health-checks">option log-health-checks</a>
							
							<a class="list-group-item" href="#option log-separate-errors">option log-separate-errors</a>
							
							<a class="list-group-item" href="#option logasap">option logasap</a>
							
							<a class="list-group-item" href="#option max-reqs">option max-reqs</a>
							
							<a class="list-group-item" href="#option mpxs-conns">option mpxs-conns</a>
							
							<a class="list-group-item" href="#option mysql-check">option mysql-check</a>
							
							<a class="list-group-item" href="#option nolinger">option nolinger</a>
							
							<a class="list-group-item" href="#option originalto">option originalto</a>
							
							<a class="list-group-item" href="#option persist">option persist</a>
							
							<a class="list-group-item" href="#option pgsql-check">option pgsql-check</a>
							
							<a class="list-group-item" href="#option pgsql-check user">option pgsql-check user</a>
							
							<a class="list-group-item" href="#option prefer-last-server">option prefer-last-server</a>
							
							<a class="list-group-item" href="#option redis-check">option redis-check</a>
							
							<a class="list-group-item" href="#option redispatch">option redispatch</a>
							
							<a class="list-group-item" href="#option smtpchk">option smtpchk</a>
							
							<a class="list-group-item" href="#option socket-stats">option socket-stats</a>
							
							<a class="list-group-item" href="#option splice-auto">option splice-auto</a>
							
							<a class="list-group-item" href="#option splice-request">option splice-request</a>
							
							<a class="list-group-item" href="#option splice-response">option splice-response</a>
							
							<a class="list-group-item" href="#option spop-check">option spop-check</a>
							
							<a class="list-group-item" href="#option srvtcpka">option srvtcpka</a>
							
							<a class="list-group-item" href="#option ssl-hello-chk">option ssl-hello-chk</a>
							
							<a class="list-group-item" href="#option start-on-reload">option start-on-reload</a>
							
							<a class="list-group-item" href="#option tcp-check">option tcp-check</a>
							
							<a class="list-group-item" href="#option tcp-smart-accept">option tcp-smart-accept</a>
							
							<a class="list-group-item" href="#option tcp-smart-connect">option tcp-smart-connect</a>
							
							<a class="list-group-item" href="#option tcpka">option tcpka</a>
							
							<a class="list-group-item" href="#option tcplog">option tcplog</a>
							
							<a class="list-group-item" href="#option transparent">option transparent</a>
							
							<a class="list-group-item" href="#or">or</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-P"><h4>P</h4>
								
							<a class="list-group-item" href="#param">param</a>
							
							<a class="list-group-item" href="#parse-resolv-conf">parse-resolv-conf</a>
							
							<a class="list-group-item" href="#pass-header">pass-header</a>
							
							<a class="list-group-item" href="#path">path</a>
							
							<a class="list-group-item" href="#path-info">path-info</a>
							
							<a class="list-group-item" href="#pathq">pathq</a>
							
							<a class="list-group-item" href="#payload">payload</a>
							
							<a class="list-group-item" href="#payload_lv">payload_lv</a>
							
							<a class="list-group-item" href="#peer">peer</a>
							
							<a class="list-group-item" href="#peers">peers</a>
							
							<a class="list-group-item" href="#persist">persist</a>
							
							<a class="list-group-item" href="#persist rdp-cookie">persist rdp-cookie</a>
							
							<a class="list-group-item" href="#pid">pid</a>
							
							<a class="list-group-item" href="#pidfile">pidfile</a>
							
							<a class="list-group-item" href="#pool-conn-name">pool-conn-name</a>
							
							<a class="list-group-item" href="#pool-low-conn">pool-low-conn</a>
							
							<a class="list-group-item" href="#pool-max-conn">pool-max-conn</a>
							
							<a class="list-group-item" href="#pool-purge-delay">pool-purge-delay</a>
							
							<a class="list-group-item" href="#port">port</a>
							
							<a class="list-group-item" href="#port_only">port_only</a>
							
							<a class="list-group-item" href="#pp2-never-send-local">pp2-never-send-local</a>
							
							<a class="list-group-item" href="#prealloc-fd">prealloc-fd</a>
							
							<a class="list-group-item" href="#prefer-client-ciphers">prefer-client-ciphers</a>
							
							<a class="list-group-item" href="#presetenv">presetenv</a>
							
							<a class="list-group-item" href="#prio_class">prio_class</a>
							
							<a class="list-group-item" href="#prio_offset">prio_offset</a>
							
							<a class="list-group-item" href="#proc">proc</a>
							
							<a class="list-group-item" href="#process-vary">process-vary</a>
							
							<a class="list-group-item" href="#profiling.memory">profiling.memory</a>
							
							<a class="list-group-item" href="#profiling.tasks">profiling.tasks</a>
							
							<a class="list-group-item" href="#program">program</a>
							
							<a class="list-group-item" href="#proto (Bind options)">proto (Bind options)</a>
							
							<a class="list-group-item" href="#proto (Server and default-server options)">proto (Server and default-server options)</a>
							
							<a class="list-group-item" href="#protobuf">protobuf</a>
							
							<a class="list-group-item" href="#proxy-v2-options">proxy-v2-options</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-Q"><h4>Q</h4>
								
							<a class="list-group-item" href="#query">query</a>
							
							<a class="list-group-item" href="#queue">queue</a>
							
							<a class="list-group-item" href="#quic-cc-algo">quic-cc-algo</a>
							
							<a class="list-group-item" href="#quic-force-retry">quic-force-retry</a>
							
							<a class="list-group-item" href="#quic-initial">quic-initial</a>
							
							<a class="list-group-item" href="#quic-socket">quic-socket</a>
							
							<a class="list-group-item" href="#quic_enabled">quic_enabled</a>
							
							<a class="list-group-item" href="#quick-exit">quick-exit</a>
							
							<a class="list-group-item" href="#quiet">quiet</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-R"><h4>R</h4>
								
							<a class="list-group-item" href="#rand">rand</a>
							
							<a class="list-group-item" href="#rate-limit">rate-limit</a>
							
							<a class="list-group-item" href="#rate-limit sessions">rate-limit sessions</a>
							
							<a class="list-group-item" href="#rdp_cookie">rdp_cookie</a>
							
							<a class="list-group-item" href="#rdp_cookie_cnt">rdp_cookie_cnt</a>
							
							<a class="list-group-item" href="#redir">redir</a>
							
							<a class="list-group-item" href="#redirect (Alphabetically sorted keywords reference)">redirect (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#redirect (Alphabetically sorted actions reference)">redirect (Alphabetically sorted actions reference)</a>
							
							<a class="list-group-item" href="#redirect location">redirect location</a>
							
							<a class="list-group-item" href="#redirect prefix">redirect prefix</a>
							
							<a class="list-group-item" href="#redirect scheme">redirect scheme</a>
							
							<a class="list-group-item" href="#regsub">regsub</a>
							
							<a class="list-group-item" href="#reject">reject</a>
							
							<a class="list-group-item" href="#rep_ssl_hello_type">rep_ssl_hello_type</a>
							
							<a class="list-group-item" href="#replace-header">replace-header</a>
							
							<a class="list-group-item" href="#replace-path">replace-path</a>
							
							<a class="list-group-item" href="#replace-pathq">replace-pathq</a>
							
							<a class="list-group-item" href="#replace-uri">replace-uri</a>
							
							<a class="list-group-item" href="#replace-value">replace-value</a>
							
							<a class="list-group-item" href="#req.body">req.body</a>
							
							<a class="list-group-item" href="#req.body_len">req.body_len</a>
							
							<a class="list-group-item" href="#req.body_param">req.body_param</a>
							
							<a class="list-group-item" href="#req.body_size">req.body_size</a>
							
							<a class="list-group-item" href="#req.cook">req.cook</a>
							
							<a class="list-group-item" href="#req.cook_cnt">req.cook_cnt</a>
							
							<a class="list-group-item" href="#req.cook_names">req.cook_names</a>
							
							<a class="list-group-item" href="#req.cook_val">req.cook_val</a>
							
							<a class="list-group-item" href="#req.fhdr">req.fhdr</a>
							
							<a class="list-group-item" href="#req.fhdr_cnt">req.fhdr_cnt</a>
							
							<a class="list-group-item" href="#req.hdr">req.hdr</a>
							
							<a class="list-group-item" href="#req.hdr_cnt">req.hdr_cnt</a>
							
							<a class="list-group-item" href="#req.hdr_ip">req.hdr_ip</a>
							
							<a class="list-group-item" href="#req.hdr_names">req.hdr_names</a>
							
							<a class="list-group-item" href="#req.hdr_val">req.hdr_val</a>
							
							<a class="list-group-item" href="#req.hdrs">req.hdrs</a>
							
							<a class="list-group-item" href="#req.hdrs_bin">req.hdrs_bin</a>
							
							<a class="list-group-item" href="#req.len">req.len</a>
							
							<a class="list-group-item" href="#req.payload">req.payload</a>
							
							<a class="list-group-item" href="#req.payload_lv">req.payload_lv</a>
							
							<a class="list-group-item" href="#req.proto_http">req.proto_http</a>
							
							<a class="list-group-item" href="#req.rdp_cookie">req.rdp_cookie</a>
							
							<a class="list-group-item" href="#req.rdp_cookie_cnt">req.rdp_cookie_cnt</a>
							
							<a class="list-group-item" href="#req.ssl_alpn">req.ssl_alpn</a>
							
							<a class="list-group-item" href="#req.ssl_ec_ext">req.ssl_ec_ext</a>
							
							<a class="list-group-item" href="#req.ssl_hello_type">req.ssl_hello_type</a>
							
							<a class="list-group-item" href="#req.ssl_sni">req.ssl_sni</a>
							
							<a class="list-group-item" href="#req.ssl_st_ext">req.ssl_st_ext</a>
							
							<a class="list-group-item" href="#req.ssl_ver">req.ssl_ver</a>
							
							<a class="list-group-item" href="#req.timer.hdr">req.timer.hdr</a>
							
							<a class="list-group-item" href="#req.timer.idle">req.timer.idle</a>
							
							<a class="list-group-item" href="#req.timer.queue">req.timer.queue</a>
							
							<a class="list-group-item" href="#req.timer.tq">req.timer.tq</a>
							
							<a class="list-group-item" href="#req.ver">req.ver</a>
							
							<a class="list-group-item" href="#req_len">req_len</a>
							
							<a class="list-group-item" href="#req_proto_http">req_proto_http</a>
							
							<a class="list-group-item" href="#req_ssl_hello_type">req_ssl_hello_type</a>
							
							<a class="list-group-item" href="#req_ssl_sni">req_ssl_sni</a>
							
							<a class="list-group-item" href="#req_ssl_ver">req_ssl_ver</a>
							
							<a class="list-group-item" href="#req_ver">req_ver</a>
							
							<a class="list-group-item" href="#request_date">request_date</a>
							
							<a class="list-group-item" href="#res.body">res.body</a>
							
							<a class="list-group-item" href="#res.body_len">res.body_len</a>
							
							<a class="list-group-item" href="#res.body_size">res.body_size</a>
							
							<a class="list-group-item" href="#res.cache_hit">res.cache_hit</a>
							
							<a class="list-group-item" href="#res.cache_name">res.cache_name</a>
							
							<a class="list-group-item" href="#res.comp">res.comp</a>
							
							<a class="list-group-item" href="#res.comp_algo">res.comp_algo</a>
							
							<a class="list-group-item" href="#res.cook">res.cook</a>
							
							<a class="list-group-item" href="#res.cook_cnt">res.cook_cnt</a>
							
							<a class="list-group-item" href="#res.cook_names">res.cook_names</a>
							
							<a class="list-group-item" href="#res.cook_val">res.cook_val</a>
							
							<a class="list-group-item" href="#res.fhdr">res.fhdr</a>
							
							<a class="list-group-item" href="#res.fhdr_cnt">res.fhdr_cnt</a>
							
							<a class="list-group-item" href="#res.hdr">res.hdr</a>
							
							<a class="list-group-item" href="#res.hdr_cnt">res.hdr_cnt</a>
							
							<a class="list-group-item" href="#res.hdr_ip">res.hdr_ip</a>
							
							<a class="list-group-item" href="#res.hdr_names">res.hdr_names</a>
							
							<a class="list-group-item" href="#res.hdr_val">res.hdr_val</a>
							
							<a class="list-group-item" href="#res.hdrs">res.hdrs</a>
							
							<a class="list-group-item" href="#res.hdrs_bin">res.hdrs_bin</a>
							
							<a class="list-group-item" href="#res.len">res.len</a>
							
							<a class="list-group-item" href="#res.payload">res.payload</a>
							
							<a class="list-group-item" href="#res.payload_lv">res.payload_lv</a>
							
							<a class="list-group-item" href="#res.ssl_hello_type">res.ssl_hello_type</a>
							
							<a class="list-group-item" href="#res.timer.data">res.timer.data</a>
							
							<a class="list-group-item" href="#res.timer.hdr">res.timer.hdr</a>
							
							<a class="list-group-item" href="#res.ver">res.ver</a>
							
							<a class="list-group-item" href="#resetenv">resetenv</a>
							
							<a class="list-group-item" href="#resolve-net">resolve-net</a>
							
							<a class="list-group-item" href="#resolve-opts">resolve-opts</a>
							
							<a class="list-group-item" href="#resolve-prefer">resolve-prefer</a>
							
							<a class="list-group-item" href="#resolve_retries">resolve_retries</a>
							
							<a class="list-group-item" href="#resolvers (Server and default-server options)">resolvers (Server and default-server options)</a>
							
							<a class="list-group-item" href="#resolvers (The resolvers section)">resolvers (The resolvers section)</a>
							
							<a class="list-group-item" href="#resp_ver">resp_ver</a>
							
							<a class="list-group-item" href="#retries">retries</a>
							
							<a class="list-group-item" href="#retry-on">retry-on</a>
							
							<a class="list-group-item" href="#return">return</a>
							
							<a class="list-group-item" href="#rfc7239_field">rfc7239_field</a>
							
							<a class="list-group-item" href="#rfc7239_is_valid">rfc7239_is_valid</a>
							
							<a class="list-group-item" href="#rfc7239_n2nn">rfc7239_n2nn</a>
							
							<a class="list-group-item" href="#rfc7239_n2np">rfc7239_n2np</a>
							
							<a class="list-group-item" href="#rfc7239_nn">rfc7239_nn</a>
							
							<a class="list-group-item" href="#rfc7239_np">rfc7239_np</a>
							
							<a class="list-group-item" href="#ring">ring</a>
							
							<a class="list-group-item" href="#rise">rise</a>
							
							<a class="list-group-item" href="#rtrim">rtrim</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-S"><h4>S</h4>
								
							<a class="list-group-item" href="#sc-add-gpc">sc-add-gpc</a>
							
							<a class="list-group-item" href="#sc-inc-gpc">sc-inc-gpc</a>
							
							<a class="list-group-item" href="#sc-inc-gpc0">sc-inc-gpc0</a>
							
							<a class="list-group-item" href="#sc-inc-gpc1">sc-inc-gpc1</a>
							
							<a class="list-group-item" href="#sc-set-gpt">sc-set-gpt</a>
							
							<a class="list-group-item" href="#sc-set-gpt0">sc-set-gpt0</a>
							
							<a class="list-group-item" href="#sc0_bytes_in_rate">sc0_bytes_in_rate</a>
							
							<a class="list-group-item" href="#sc0_bytes_out_rate">sc0_bytes_out_rate</a>
							
							<a class="list-group-item" href="#sc0_clr_gpc0">sc0_clr_gpc0</a>
							
							<a class="list-group-item" href="#sc0_clr_gpc1">sc0_clr_gpc1</a>
							
							<a class="list-group-item" href="#sc0_conn_cnt">sc0_conn_cnt</a>
							
							<a class="list-group-item" href="#sc0_conn_cur">sc0_conn_cur</a>
							
							<a class="list-group-item" href="#sc0_conn_rate">sc0_conn_rate</a>
							
							<a class="list-group-item" href="#sc0_get_gpc0">sc0_get_gpc0</a>
							
							<a class="list-group-item" href="#sc0_get_gpc1">sc0_get_gpc1</a>
							
							<a class="list-group-item" href="#sc0_get_gpt0">sc0_get_gpt0</a>
							
							<a class="list-group-item" href="#sc0_glitch_cnt">sc0_glitch_cnt</a>
							
							<a class="list-group-item" href="#sc0_glitch_rate">sc0_glitch_rate</a>
							
							<a class="list-group-item" href="#sc0_gpc0_rate">sc0_gpc0_rate</a>
							
							<a class="list-group-item" href="#sc0_gpc1_rate">sc0_gpc1_rate</a>
							
							<a class="list-group-item" href="#sc0_http_err_cnt">sc0_http_err_cnt</a>
							
							<a class="list-group-item" href="#sc0_http_err_rate">sc0_http_err_rate</a>
							
							<a class="list-group-item" href="#sc0_http_fail_cnt">sc0_http_fail_cnt</a>
							
							<a class="list-group-item" href="#sc0_http_fail_rate">sc0_http_fail_rate</a>
							
							<a class="list-group-item" href="#sc0_http_req_cnt">sc0_http_req_cnt</a>
							
							<a class="list-group-item" href="#sc0_http_req_rate">sc0_http_req_rate</a>
							
							<a class="list-group-item" href="#sc0_inc_gpc0">sc0_inc_gpc0</a>
							
							<a class="list-group-item" href="#sc0_inc_gpc1">sc0_inc_gpc1</a>
							
							<a class="list-group-item" href="#sc0_kbytes_in">sc0_kbytes_in</a>
							
							<a class="list-group-item" href="#sc0_kbytes_out">sc0_kbytes_out</a>
							
							<a class="list-group-item" href="#sc0_sess_cnt">sc0_sess_cnt</a>
							
							<a class="list-group-item" href="#sc0_sess_rate">sc0_sess_rate</a>
							
							<a class="list-group-item" href="#sc0_tracked">sc0_tracked</a>
							
							<a class="list-group-item" href="#sc0_trackers">sc0_trackers</a>
							
							<a class="list-group-item" href="#sc1_bytes_in_rate">sc1_bytes_in_rate</a>
							
							<a class="list-group-item" href="#sc1_bytes_out_rate">sc1_bytes_out_rate</a>
							
							<a class="list-group-item" href="#sc1_clr_gpc0">sc1_clr_gpc0</a>
							
							<a class="list-group-item" href="#sc1_clr_gpc1">sc1_clr_gpc1</a>
							
							<a class="list-group-item" href="#sc1_conn_cnt">sc1_conn_cnt</a>
							
							<a class="list-group-item" href="#sc1_conn_cur">sc1_conn_cur</a>
							
							<a class="list-group-item" href="#sc1_conn_rate">sc1_conn_rate</a>
							
							<a class="list-group-item" href="#sc1_get_gpc0">sc1_get_gpc0</a>
							
							<a class="list-group-item" href="#sc1_get_gpc1">sc1_get_gpc1</a>
							
							<a class="list-group-item" href="#sc1_get_gpt0">sc1_get_gpt0</a>
							
							<a class="list-group-item" href="#sc1_glitch_cnt">sc1_glitch_cnt</a>
							
							<a class="list-group-item" href="#sc1_glitch_rate">sc1_glitch_rate</a>
							
							<a class="list-group-item" href="#sc1_gpc0_rate">sc1_gpc0_rate</a>
							
							<a class="list-group-item" href="#sc1_gpc1_rate">sc1_gpc1_rate</a>
							
							<a class="list-group-item" href="#sc1_http_err_cnt">sc1_http_err_cnt</a>
							
							<a class="list-group-item" href="#sc1_http_err_rate">sc1_http_err_rate</a>
							
							<a class="list-group-item" href="#sc1_http_fail_cnt">sc1_http_fail_cnt</a>
							
							<a class="list-group-item" href="#sc1_http_fail_rate">sc1_http_fail_rate</a>
							
							<a class="list-group-item" href="#sc1_http_req_cnt">sc1_http_req_cnt</a>
							
							<a class="list-group-item" href="#sc1_http_req_rate">sc1_http_req_rate</a>
							
							<a class="list-group-item" href="#sc1_inc_gpc0">sc1_inc_gpc0</a>
							
							<a class="list-group-item" href="#sc1_inc_gpc1">sc1_inc_gpc1</a>
							
							<a class="list-group-item" href="#sc1_kbytes_in">sc1_kbytes_in</a>
							
							<a class="list-group-item" href="#sc1_kbytes_out">sc1_kbytes_out</a>
							
							<a class="list-group-item" href="#sc1_sess_cnt">sc1_sess_cnt</a>
							
							<a class="list-group-item" href="#sc1_sess_rate">sc1_sess_rate</a>
							
							<a class="list-group-item" href="#sc1_tracked">sc1_tracked</a>
							
							<a class="list-group-item" href="#sc1_trackers">sc1_trackers</a>
							
							<a class="list-group-item" href="#sc2_bytes_in_rate">sc2_bytes_in_rate</a>
							
							<a class="list-group-item" href="#sc2_bytes_out_rate">sc2_bytes_out_rate</a>
							
							<a class="list-group-item" href="#sc2_clr_gpc0">sc2_clr_gpc0</a>
							
							<a class="list-group-item" href="#sc2_clr_gpc1">sc2_clr_gpc1</a>
							
							<a class="list-group-item" href="#sc2_conn_cnt">sc2_conn_cnt</a>
							
							<a class="list-group-item" href="#sc2_conn_cur">sc2_conn_cur</a>
							
							<a class="list-group-item" href="#sc2_conn_rate">sc2_conn_rate</a>
							
							<a class="list-group-item" href="#sc2_get_gpc0">sc2_get_gpc0</a>
							
							<a class="list-group-item" href="#sc2_get_gpc1">sc2_get_gpc1</a>
							
							<a class="list-group-item" href="#sc2_get_gpt0">sc2_get_gpt0</a>
							
							<a class="list-group-item" href="#sc2_glitch_cnt">sc2_glitch_cnt</a>
							
							<a class="list-group-item" href="#sc2_glitch_rate">sc2_glitch_rate</a>
							
							<a class="list-group-item" href="#sc2_gpc0_rate">sc2_gpc0_rate</a>
							
							<a class="list-group-item" href="#sc2_gpc1_rate">sc2_gpc1_rate</a>
							
							<a class="list-group-item" href="#sc2_http_err_cnt">sc2_http_err_cnt</a>
							
							<a class="list-group-item" href="#sc2_http_err_rate">sc2_http_err_rate</a>
							
							<a class="list-group-item" href="#sc2_http_fail_cnt">sc2_http_fail_cnt</a>
							
							<a class="list-group-item" href="#sc2_http_fail_rate">sc2_http_fail_rate</a>
							
							<a class="list-group-item" href="#sc2_http_req_cnt">sc2_http_req_cnt</a>
							
							<a class="list-group-item" href="#sc2_http_req_rate">sc2_http_req_rate</a>
							
							<a class="list-group-item" href="#sc2_inc_gpc0">sc2_inc_gpc0</a>
							
							<a class="list-group-item" href="#sc2_inc_gpc1">sc2_inc_gpc1</a>
							
							<a class="list-group-item" href="#sc2_kbytes_in">sc2_kbytes_in</a>
							
							<a class="list-group-item" href="#sc2_kbytes_out">sc2_kbytes_out</a>
							
							<a class="list-group-item" href="#sc2_sess_cnt">sc2_sess_cnt</a>
							
							<a class="list-group-item" href="#sc2_sess_rate">sc2_sess_rate</a>
							
							<a class="list-group-item" href="#sc2_tracked">sc2_tracked</a>
							
							<a class="list-group-item" href="#sc2_trackers">sc2_trackers</a>
							
							<a class="list-group-item" href="#sc_bytes_in_rate">sc_bytes_in_rate</a>
							
							<a class="list-group-item" href="#sc_bytes_out_rate">sc_bytes_out_rate</a>
							
							<a class="list-group-item" href="#sc_clr_gpc">sc_clr_gpc</a>
							
							<a class="list-group-item" href="#sc_clr_gpc0">sc_clr_gpc0</a>
							
							<a class="list-group-item" href="#sc_clr_gpc1">sc_clr_gpc1</a>
							
							<a class="list-group-item" href="#sc_conn_cnt">sc_conn_cnt</a>
							
							<a class="list-group-item" href="#sc_conn_cur">sc_conn_cur</a>
							
							<a class="list-group-item" href="#sc_conn_rate">sc_conn_rate</a>
							
							<a class="list-group-item" href="#sc_get_gpc">sc_get_gpc</a>
							
							<a class="list-group-item" href="#sc_get_gpc0">sc_get_gpc0</a>
							
							<a class="list-group-item" href="#sc_get_gpc1">sc_get_gpc1</a>
							
							<a class="list-group-item" href="#sc_get_gpt">sc_get_gpt</a>
							
							<a class="list-group-item" href="#sc_get_gpt0">sc_get_gpt0</a>
							
							<a class="list-group-item" href="#sc_glitch_cnt">sc_glitch_cnt</a>
							
							<a class="list-group-item" href="#sc_glitch_rate">sc_glitch_rate</a>
							
							<a class="list-group-item" href="#sc_gpc0_rate">sc_gpc0_rate</a>
							
							<a class="list-group-item" href="#sc_gpc1_rate">sc_gpc1_rate</a>
							
							<a class="list-group-item" href="#sc_gpc_rate">sc_gpc_rate</a>
							
							<a class="list-group-item" href="#sc_http_err_cnt">sc_http_err_cnt</a>
							
							<a class="list-group-item" href="#sc_http_err_rate">sc_http_err_rate</a>
							
							<a class="list-group-item" href="#sc_http_fail_cnt">sc_http_fail_cnt</a>
							
							<a class="list-group-item" href="#sc_http_fail_rate">sc_http_fail_rate</a>
							
							<a class="list-group-item" href="#sc_http_req_cnt">sc_http_req_cnt</a>
							
							<a class="list-group-item" href="#sc_http_req_rate">sc_http_req_rate</a>
							
							<a class="list-group-item" href="#sc_inc_gpc">sc_inc_gpc</a>
							
							<a class="list-group-item" href="#sc_inc_gpc0">sc_inc_gpc0</a>
							
							<a class="list-group-item" href="#sc_inc_gpc1">sc_inc_gpc1</a>
							
							<a class="list-group-item" href="#sc_kbytes_in">sc_kbytes_in</a>
							
							<a class="list-group-item" href="#sc_kbytes_out">sc_kbytes_out</a>
							
							<a class="list-group-item" href="#sc_sess_cnt">sc_sess_cnt</a>
							
							<a class="list-group-item" href="#sc_sess_rate">sc_sess_rate</a>
							
							<a class="list-group-item" href="#sc_tracked">sc_tracked</a>
							
							<a class="list-group-item" href="#sc_trackers">sc_trackers</a>
							
							<a class="list-group-item" href="#scook">scook</a>
							
							<a class="list-group-item" href="#scook_cnt">scook_cnt</a>
							
							<a class="list-group-item" href="#scook_val">scook_val</a>
							
							<a class="list-group-item" href="#sctl">sctl</a>
							
							<a class="list-group-item" href="#sdbm">sdbm</a>
							
							<a class="list-group-item" href="#secure_memcmp">secure_memcmp</a>
							
							<a class="list-group-item" href="#send-proxy">send-proxy</a>
							
							<a class="list-group-item" href="#send-proxy-v2">send-proxy-v2</a>
							
							<a class="list-group-item" href="#send-proxy-v2-ssl">send-proxy-v2-ssl</a>
							
							<a class="list-group-item" href="#send-proxy-v2-ssl-cn">send-proxy-v2-ssl-cn</a>
							
							<a class="list-group-item" href="#send-retry">send-retry</a>
							
							<a class="list-group-item" href="#send-spoe-group">send-spoe-group</a>
							
							<a class="list-group-item" href="#server (Peers)">server (Peers)</a>
							
							<a class="list-group-item" href="#server (Rings)">server (Rings)</a>
							
							<a class="list-group-item" href="#server (Alphabetically sorted keywords reference)">server (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#server-state-base">server-state-base</a>
							
							<a class="list-group-item" href="#server-state-file">server-state-file</a>
							
							<a class="list-group-item" href="#server-state-file-name">server-state-file-name</a>
							
							<a class="list-group-item" href="#server-template">server-template</a>
							
							<a class="list-group-item" href="#server_status">server_status</a>
							
							<a class="list-group-item" href="#set-bandwidth-limit">set-bandwidth-limit</a>
							
							<a class="list-group-item" href="#set-bc-mark">set-bc-mark</a>
							
							<a class="list-group-item" href="#set-bc-tos">set-bc-tos</a>
							
							<a class="list-group-item" href="#set-cookie">set-cookie</a>
							
							<a class="list-group-item" href="#set-dst">set-dst</a>
							
							<a class="list-group-item" href="#set-dst-port">set-dst-port</a>
							
							<a class="list-group-item" href="#set-dumpable">set-dumpable</a>
							
							<a class="list-group-item" href="#set-fc-mark">set-fc-mark</a>
							
							<a class="list-group-item" href="#set-fc-tos">set-fc-tos</a>
							
							<a class="list-group-item" href="#set-header">set-header</a>
							
							<a class="list-group-item" href="#set-log-level">set-log-level</a>
							
							<a class="list-group-item" href="#set-map">set-map</a>
							
							<a class="list-group-item" href="#set-mark">set-mark</a>
							
							<a class="list-group-item" href="#set-method">set-method</a>
							
							<a class="list-group-item" href="#set-nice">set-nice</a>
							
							<a class="list-group-item" href="#set-param">set-param</a>
							
							<a class="list-group-item" href="#set-path">set-path</a>
							
							<a class="list-group-item" href="#set-pathq">set-pathq</a>
							
							<a class="list-group-item" href="#set-priority-class">set-priority-class</a>
							
							<a class="list-group-item" href="#set-priority-offset">set-priority-offset</a>
							
							<a class="list-group-item" href="#set-proxy-v2-tlv-fmt">set-proxy-v2-tlv-fmt</a>
							
							<a class="list-group-item" href="#set-query">set-query</a>
							
							<a class="list-group-item" href="#set-retries">set-retries</a>
							
							<a class="list-group-item" href="#set-src">set-src</a>
							
							<a class="list-group-item" href="#set-src-port">set-src-port</a>
							
							<a class="list-group-item" href="#set-status">set-status</a>
							
							<a class="list-group-item" href="#set-timeout">set-timeout</a>
							
							<a class="list-group-item" href="#set-tos">set-tos</a>
							
							<a class="list-group-item" href="#set-uri">set-uri</a>
							
							<a class="list-group-item" href="#set-var (Process management and security)">set-var (Process management and security)</a>
							
							<a class="list-group-item" href="#set-var (Alphabetically sorted actions reference)">set-var (Alphabetically sorted actions reference)</a>
							
							<a class="list-group-item" href="#set-var (Converters)">set-var (Converters)</a>
							
							<a class="list-group-item" href="#set-var-fmt (Process management and security)">set-var-fmt (Process management and security)</a>
							
							<a class="list-group-item" href="#set-var-fmt (Alphabetically sorted actions reference)">set-var-fmt (Alphabetically sorted actions reference)</a>
							
							<a class="list-group-item" href="#setcap">setcap</a>
							
							<a class="list-group-item" href="#setenv">setenv</a>
							
							<a class="list-group-item" href="#severity-output">severity-output</a>
							
							<a class="list-group-item" href="#sha1">sha1</a>
							
							<a class="list-group-item" href="#sha2">sha2</a>
							
							<a class="list-group-item" href="#shard">shard</a>
							
							<a class="list-group-item" href="#shards (Peers)">shards (Peers)</a>
							
							<a class="list-group-item" href="#shards (Bind options)">shards (Bind options)</a>
							
							<a class="list-group-item" href="#shdr">shdr</a>
							
							<a class="list-group-item" href="#shdr_cnt">shdr_cnt</a>
							
							<a class="list-group-item" href="#shdr_ip">shdr_ip</a>
							
							<a class="list-group-item" href="#shdr_val">shdr_val</a>
							
							<a class="list-group-item" href="#sigalgs (Bind options)">sigalgs (Bind options)</a>
							
							<a class="list-group-item" href="#sigalgs (Server and default-server options)">sigalgs (Server and default-server options)</a>
							
							<a class="list-group-item" href="#silent-drop">silent-drop</a>
							
							<a class="list-group-item" href="#size">size</a>
							
							<a class="list-group-item" href="#slowstart">slowstart</a>
							
							<a class="list-group-item" href="#sni">sni</a>
							
							<a class="list-group-item" href="#so_id">so_id</a>
							
							<a class="list-group-item" href="#so_name">so_name</a>
							
							<a class="list-group-item" href="#socks4">socks4</a>
							
							<a class="list-group-item" href="#source (Alphabetically sorted keywords reference)">source (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#source (Server and default-server options)">source (Server and default-server options)</a>
							
							<a class="list-group-item" href="#spread-checks">spread-checks</a>
							
							<a class="list-group-item" href="#src">src</a>
							
							<a class="list-group-item" href="#src_bytes_in_rate">src_bytes_in_rate</a>
							
							<a class="list-group-item" href="#src_bytes_out_rate">src_bytes_out_rate</a>
							
							<a class="list-group-item" href="#src_clr_gpc">src_clr_gpc</a>
							
							<a class="list-group-item" href="#src_clr_gpc0">src_clr_gpc0</a>
							
							<a class="list-group-item" href="#src_clr_gpc1">src_clr_gpc1</a>
							
							<a class="list-group-item" href="#src_conn_cnt">src_conn_cnt</a>
							
							<a class="list-group-item" href="#src_conn_cur">src_conn_cur</a>
							
							<a class="list-group-item" href="#src_conn_rate">src_conn_rate</a>
							
							<a class="list-group-item" href="#src_get_gpc">src_get_gpc</a>
							
							<a class="list-group-item" href="#src_get_gpc0">src_get_gpc0</a>
							
							<a class="list-group-item" href="#src_get_gpc1">src_get_gpc1</a>
							
							<a class="list-group-item" href="#src_get_gpt">src_get_gpt</a>
							
							<a class="list-group-item" href="#src_get_gpt0">src_get_gpt0</a>
							
							<a class="list-group-item" href="#src_glitch_cnt">src_glitch_cnt</a>
							
							<a class="list-group-item" href="#src_glitch_rate">src_glitch_rate</a>
							
							<a class="list-group-item" href="#src_gpc0_rate">src_gpc0_rate</a>
							
							<a class="list-group-item" href="#src_gpc1_rate">src_gpc1_rate</a>
							
							<a class="list-group-item" href="#src_gpc_rate">src_gpc_rate</a>
							
							<a class="list-group-item" href="#src_http_err_cnt">src_http_err_cnt</a>
							
							<a class="list-group-item" href="#src_http_err_rate">src_http_err_rate</a>
							
							<a class="list-group-item" href="#src_http_fail_cnt">src_http_fail_cnt</a>
							
							<a class="list-group-item" href="#src_http_fail_rate">src_http_fail_rate</a>
							
							<a class="list-group-item" href="#src_http_req_cnt">src_http_req_cnt</a>
							
							<a class="list-group-item" href="#src_http_req_rate">src_http_req_rate</a>
							
							<a class="list-group-item" href="#src_inc_gpc">src_inc_gpc</a>
							
							<a class="list-group-item" href="#src_inc_gpc0">src_inc_gpc0</a>
							
							<a class="list-group-item" href="#src_inc_gpc1">src_inc_gpc1</a>
							
							<a class="list-group-item" href="#src_is_local">src_is_local</a>
							
							<a class="list-group-item" href="#src_kbytes_in">src_kbytes_in</a>
							
							<a class="list-group-item" href="#src_kbytes_out">src_kbytes_out</a>
							
							<a class="list-group-item" href="#src_port">src_port</a>
							
							<a class="list-group-item" href="#src_sess_cnt">src_sess_cnt</a>
							
							<a class="list-group-item" href="#src_sess_rate">src_sess_rate</a>
							
							<a class="list-group-item" href="#src_updt_conn_cnt">src_updt_conn_cnt</a>
							
							<a class="list-group-item" href="#srv_conn">srv_conn</a>
							
							<a class="list-group-item" href="#srv_conn_free">srv_conn_free</a>
							
							<a class="list-group-item" href="#srv_id">srv_id</a>
							
							<a class="list-group-item" href="#srv_is_up">srv_is_up</a>
							
							<a class="list-group-item" href="#srv_iweight">srv_iweight</a>
							
							<a class="list-group-item" href="#srv_name">srv_name</a>
							
							<a class="list-group-item" href="#srv_queue (Converters)">srv_queue (Converters)</a>
							
							<a class="list-group-item" href="#srv_queue (Fetching samples from internal states)">srv_queue (Fetching samples from internal states)</a>
							
							<a class="list-group-item" href="#srv_sess_rate">srv_sess_rate</a>
							
							<a class="list-group-item" href="#srv_uweight">srv_uweight</a>
							
							<a class="list-group-item" href="#srv_weight">srv_weight</a>
							
							<a class="list-group-item" href="#srvtcpka-cnt">srvtcpka-cnt</a>
							
							<a class="list-group-item" href="#srvtcpka-idle">srvtcpka-idle</a>
							
							<a class="list-group-item" href="#srvtcpka-intvl">srvtcpka-intvl</a>
							
							<a class="list-group-item" href="#ssl (Bind options)">ssl (Bind options)</a>
							
							<a class="list-group-item" href="#ssl (Server and default-server options)">ssl (Server and default-server options)</a>
							
							<a class="list-group-item" href="#ssl-default-bind-ciphers">ssl-default-bind-ciphers</a>
							
							<a class="list-group-item" href="#ssl-default-bind-ciphersuites">ssl-default-bind-ciphersuites</a>
							
							<a class="list-group-item" href="#ssl-default-bind-client-sigalgs">ssl-default-bind-client-sigalgs</a>
							
							<a class="list-group-item" href="#ssl-default-bind-curves">ssl-default-bind-curves</a>
							
							<a class="list-group-item" href="#ssl-default-bind-options">ssl-default-bind-options</a>
							
							<a class="list-group-item" href="#ssl-default-bind-sigalgs">ssl-default-bind-sigalgs</a>
							
							<a class="list-group-item" href="#ssl-default-server-ciphers">ssl-default-server-ciphers</a>
							
							<a class="list-group-item" href="#ssl-default-server-ciphersuites">ssl-default-server-ciphersuites</a>
							
							<a class="list-group-item" href="#ssl-default-server-client-sigalgs">ssl-default-server-client-sigalgs</a>
							
							<a class="list-group-item" href="#ssl-default-server-curves">ssl-default-server-curves</a>
							
							<a class="list-group-item" href="#ssl-default-server-options">ssl-default-server-options</a>
							
							<a class="list-group-item" href="#ssl-default-server-sigalgs">ssl-default-server-sigalgs</a>
							
							<a class="list-group-item" href="#ssl-dh-param-file">ssl-dh-param-file</a>
							
							<a class="list-group-item" href="#ssl-engine">ssl-engine</a>
							
							<a class="list-group-item" href="#ssl-load-extra-del-ext">ssl-load-extra-del-ext</a>
							
							<a class="list-group-item" href="#ssl-load-extra-files">ssl-load-extra-files</a>
							
							<a class="list-group-item" href="#ssl-max-ver (Bind options)">ssl-max-ver (Bind options)</a>
							
							<a class="list-group-item" href="#ssl-max-ver (Server and default-server options)">ssl-max-ver (Server and default-server options)</a>
							
							<a class="list-group-item" href="#ssl-min-ver (Bind options)">ssl-min-ver (Bind options)</a>
							
							<a class="list-group-item" href="#ssl-min-ver (Server and default-server options)">ssl-min-ver (Server and default-server options)</a>
							
							<a class="list-group-item" href="#ssl-mode-async">ssl-mode-async</a>
							
							<a class="list-group-item" href="#ssl-propquery">ssl-propquery</a>
							
							<a class="list-group-item" href="#ssl-provider">ssl-provider</a>
							
							<a class="list-group-item" href="#ssl-provider-path">ssl-provider-path</a>
							
							<a class="list-group-item" href="#ssl-reuse">ssl-reuse</a>
							
							<a class="list-group-item" href="#ssl-security-level">ssl-security-level</a>
							
							<a class="list-group-item" href="#ssl-server-verify">ssl-server-verify</a>
							
							<a class="list-group-item" href="#ssl-skip-self-issued-ca">ssl-skip-self-issued-ca</a>
							
							<a class="list-group-item" href="#ssl_bc">ssl_bc</a>
							
							<a class="list-group-item" href="#ssl_bc_alg_keysize">ssl_bc_alg_keysize</a>
							
							<a class="list-group-item" href="#ssl_bc_alpn">ssl_bc_alpn</a>
							
							<a class="list-group-item" href="#ssl_bc_cipher">ssl_bc_cipher</a>
							
							<a class="list-group-item" href="#ssl_bc_client_early_traffic_secret">ssl_bc_client_early_traffic_secret</a>
							
							<a class="list-group-item" href="#ssl_bc_client_handshake_traffic_secret">ssl_bc_client_handshake_traffic_secret</a>
							
							<a class="list-group-item" href="#ssl_bc_client_random">ssl_bc_client_random</a>
							
							<a class="list-group-item" href="#ssl_bc_client_traffic_secret_0">ssl_bc_client_traffic_secret_0</a>
							
							<a class="list-group-item" href="#ssl_bc_curve">ssl_bc_curve</a>
							
							<a class="list-group-item" href="#ssl_bc_early_exporter_secret">ssl_bc_early_exporter_secret</a>
							
							<a class="list-group-item" href="#ssl_bc_err">ssl_bc_err</a>
							
							<a class="list-group-item" href="#ssl_bc_err_str">ssl_bc_err_str</a>
							
							<a class="list-group-item" href="#ssl_bc_exporter_secret">ssl_bc_exporter_secret</a>
							
							<a class="list-group-item" href="#ssl_bc_is_resumed">ssl_bc_is_resumed</a>
							
							<a class="list-group-item" href="#ssl_bc_npn">ssl_bc_npn</a>
							
							<a class="list-group-item" href="#ssl_bc_protocol">ssl_bc_protocol</a>
							
							<a class="list-group-item" href="#ssl_bc_server_handshake_traffic_secret">ssl_bc_server_handshake_traffic_secret</a>
							
							<a class="list-group-item" href="#ssl_bc_server_random">ssl_bc_server_random</a>
							
							<a class="list-group-item" href="#ssl_bc_server_traffic_secret_0">ssl_bc_server_traffic_secret_0</a>
							
							<a class="list-group-item" href="#ssl_bc_session_id">ssl_bc_session_id</a>
							
							<a class="list-group-item" href="#ssl_bc_session_key">ssl_bc_session_key</a>
							
							<a class="list-group-item" href="#ssl_bc_unique_id">ssl_bc_unique_id</a>
							
							<a class="list-group-item" href="#ssl_bc_use_keysize">ssl_bc_use_keysize</a>
							
							<a class="list-group-item" href="#ssl_c_ca_err">ssl_c_ca_err</a>
							
							<a class="list-group-item" href="#ssl_c_ca_err_depth">ssl_c_ca_err_depth</a>
							
							<a class="list-group-item" href="#ssl_c_chain_der">ssl_c_chain_der</a>
							
							<a class="list-group-item" href="#ssl_c_der">ssl_c_der</a>
							
							<a class="list-group-item" href="#ssl_c_err">ssl_c_err</a>
							
							<a class="list-group-item" href="#ssl_c_i_dn">ssl_c_i_dn</a>
							
							<a class="list-group-item" href="#ssl_c_key_alg">ssl_c_key_alg</a>
							
							<a class="list-group-item" href="#ssl_c_notafter">ssl_c_notafter</a>
							
							<a class="list-group-item" href="#ssl_c_notbefore">ssl_c_notbefore</a>
							
							<a class="list-group-item" href="#ssl_c_r_dn">ssl_c_r_dn</a>
							
							<a class="list-group-item" href="#ssl_c_s_dn">ssl_c_s_dn</a>
							
							<a class="list-group-item" href="#ssl_c_san">ssl_c_san</a>
							
							<a class="list-group-item" href="#ssl_c_serial">ssl_c_serial</a>
							
							<a class="list-group-item" href="#ssl_c_sha1">ssl_c_sha1</a>
							
							<a class="list-group-item" href="#ssl_c_sig_alg">ssl_c_sig_alg</a>
							
							<a class="list-group-item" href="#ssl_c_used">ssl_c_used</a>
							
							<a class="list-group-item" href="#ssl_c_verify">ssl_c_verify</a>
							
							<a class="list-group-item" href="#ssl_c_version">ssl_c_version</a>
							
							<a class="list-group-item" href="#ssl_f_der">ssl_f_der</a>
							
							<a class="list-group-item" href="#ssl_f_i_dn">ssl_f_i_dn</a>
							
							<a class="list-group-item" href="#ssl_f_key_alg">ssl_f_key_alg</a>
							
							<a class="list-group-item" href="#ssl_f_notafter">ssl_f_notafter</a>
							
							<a class="list-group-item" href="#ssl_f_notbefore">ssl_f_notbefore</a>
							
							<a class="list-group-item" href="#ssl_f_s_dn">ssl_f_s_dn</a>
							
							<a class="list-group-item" href="#ssl_f_serial">ssl_f_serial</a>
							
							<a class="list-group-item" href="#ssl_f_sha1">ssl_f_sha1</a>
							
							<a class="list-group-item" href="#ssl_f_sig_alg">ssl_f_sig_alg</a>
							
							<a class="list-group-item" href="#ssl_f_version">ssl_f_version</a>
							
							<a class="list-group-item" href="#ssl_fc">ssl_fc</a>
							
							<a class="list-group-item" href="#ssl_fc_alg_keysize">ssl_fc_alg_keysize</a>
							
							<a class="list-group-item" href="#ssl_fc_alpn">ssl_fc_alpn</a>
							
							<a class="list-group-item" href="#ssl_fc_cipher">ssl_fc_cipher</a>
							
							<a class="list-group-item" href="#ssl_fc_cipherlist_bin">ssl_fc_cipherlist_bin</a>
							
							<a class="list-group-item" href="#ssl_fc_cipherlist_hex">ssl_fc_cipherlist_hex</a>
							
							<a class="list-group-item" href="#ssl_fc_cipherlist_str">ssl_fc_cipherlist_str</a>
							
							<a class="list-group-item" href="#ssl_fc_cipherlist_xxh">ssl_fc_cipherlist_xxh</a>
							
							<a class="list-group-item" href="#ssl_fc_client_early_traffic_secret">ssl_fc_client_early_traffic_secret</a>
							
							<a class="list-group-item" href="#ssl_fc_client_handshake_traffic_secret">ssl_fc_client_handshake_traffic_secret</a>
							
							<a class="list-group-item" href="#ssl_fc_client_random">ssl_fc_client_random</a>
							
							<a class="list-group-item" href="#ssl_fc_client_traffic_secret_0">ssl_fc_client_traffic_secret_0</a>
							
							<a class="list-group-item" href="#ssl_fc_curve">ssl_fc_curve</a>
							
							<a class="list-group-item" href="#ssl_fc_early_exporter_secret">ssl_fc_early_exporter_secret</a>
							
							<a class="list-group-item" href="#ssl_fc_ecformats_bin">ssl_fc_ecformats_bin</a>
							
							<a class="list-group-item" href="#ssl_fc_eclist_bin">ssl_fc_eclist_bin</a>
							
							<a class="list-group-item" href="#ssl_fc_err">ssl_fc_err</a>
							
							<a class="list-group-item" href="#ssl_fc_err_str">ssl_fc_err_str</a>
							
							<a class="list-group-item" href="#ssl_fc_exporter_secret">ssl_fc_exporter_secret</a>
							
							<a class="list-group-item" href="#ssl_fc_extlist_bin">ssl_fc_extlist_bin</a>
							
							<a class="list-group-item" href="#ssl_fc_has_crt">ssl_fc_has_crt</a>
							
							<a class="list-group-item" href="#ssl_fc_has_early">ssl_fc_has_early</a>
							
							<a class="list-group-item" href="#ssl_fc_has_sni">ssl_fc_has_sni</a>
							
							<a class="list-group-item" href="#ssl_fc_is_resumed">ssl_fc_is_resumed</a>
							
							<a class="list-group-item" href="#ssl_fc_npn">ssl_fc_npn</a>
							
							<a class="list-group-item" href="#ssl_fc_protocol">ssl_fc_protocol</a>
							
							<a class="list-group-item" href="#ssl_fc_protocol_hello_id">ssl_fc_protocol_hello_id</a>
							
							<a class="list-group-item" href="#ssl_fc_server_handshake_traffic_secret">ssl_fc_server_handshake_traffic_secret</a>
							
							<a class="list-group-item" href="#ssl_fc_server_random">ssl_fc_server_random</a>
							
							<a class="list-group-item" href="#ssl_fc_server_traffic_secret_0">ssl_fc_server_traffic_secret_0</a>
							
							<a class="list-group-item" href="#ssl_fc_session_id">ssl_fc_session_id</a>
							
							<a class="list-group-item" href="#ssl_fc_session_key">ssl_fc_session_key</a>
							
							<a class="list-group-item" href="#ssl_fc_sigalgs_bin">ssl_fc_sigalgs_bin</a>
							
							<a class="list-group-item" href="#ssl_fc_sni">ssl_fc_sni</a>
							
							<a class="list-group-item" href="#ssl_fc_supported_versions_bin">ssl_fc_supported_versions_bin</a>
							
							<a class="list-group-item" href="#ssl_fc_unique_id">ssl_fc_unique_id</a>
							
							<a class="list-group-item" href="#ssl_fc_use_keysize">ssl_fc_use_keysize</a>
							
							<a class="list-group-item" href="#ssl_s_chain_der">ssl_s_chain_der</a>
							
							<a class="list-group-item" href="#ssl_s_der">ssl_s_der</a>
							
							<a class="list-group-item" href="#ssl_s_i_dn">ssl_s_i_dn</a>
							
							<a class="list-group-item" href="#ssl_s_key_alg">ssl_s_key_alg</a>
							
							<a class="list-group-item" href="#ssl_s_notafter">ssl_s_notafter</a>
							
							<a class="list-group-item" href="#ssl_s_notbefore">ssl_s_notbefore</a>
							
							<a class="list-group-item" href="#ssl_s_s_dn">ssl_s_s_dn</a>
							
							<a class="list-group-item" href="#ssl_s_serial">ssl_s_serial</a>
							
							<a class="list-group-item" href="#ssl_s_sha1">ssl_s_sha1</a>
							
							<a class="list-group-item" href="#ssl_s_sig_alg">ssl_s_sig_alg</a>
							
							<a class="list-group-item" href="#ssl_s_version">ssl_s_version</a>
							
							<a class="list-group-item" href="#stats (Process management and security)">stats (Process management and security)</a>
							
							<a class="list-group-item" href="#stats (Alphabetically sorted keywords reference)">stats (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#stats admin">stats admin</a>
							
							<a class="list-group-item" href="#stats auth">stats auth</a>
							
							<a class="list-group-item" href="#stats enable">stats enable</a>
							
							<a class="list-group-item" href="#stats hide-version">stats hide-version</a>
							
							<a class="list-group-item" href="#stats http-request">stats http-request</a>
							
							<a class="list-group-item" href="#stats maxconn">stats maxconn</a>
							
							<a class="list-group-item" href="#stats realm">stats realm</a>
							
							<a class="list-group-item" href="#stats refresh">stats refresh</a>
							
							<a class="list-group-item" href="#stats scope">stats scope</a>
							
							<a class="list-group-item" href="#stats show-desc">stats show-desc</a>
							
							<a class="list-group-item" href="#stats show-legends">stats show-legends</a>
							
							<a class="list-group-item" href="#stats show-modules">stats show-modules</a>
							
							<a class="list-group-item" href="#stats show-node">stats show-node</a>
							
							<a class="list-group-item" href="#stats socket">stats socket</a>
							
							<a class="list-group-item" href="#stats timeout">stats timeout</a>
							
							<a class="list-group-item" href="#stats uri">stats uri</a>
							
							<a class="list-group-item" href="#stats-file">stats-file</a>
							
							<a class="list-group-item" href="#status">status</a>
							
							<a class="list-group-item" href="#stick (Alphabetically sorted keywords reference)">stick (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#stick (Server and default-server options)">stick (Server and default-server options)</a>
							
							<a class="list-group-item" href="#stick match">stick match</a>
							
							<a class="list-group-item" href="#stick on">stick on</a>
							
							<a class="list-group-item" href="#stick store-request">stick store-request</a>
							
							<a class="list-group-item" href="#stick store-response">stick store-response</a>
							
							<a class="list-group-item" href="#stick-table">stick-table</a>
							
							<a class="list-group-item" href="#stick-table type">stick-table type</a>
							
							<a class="list-group-item" href="#stopping">stopping</a>
							
							<a class="list-group-item" href="#str">str</a>
							
							<a class="list-group-item" href="#strcmp">strcmp</a>
							
							<a class="list-group-item" href="#strict-limits">strict-limits</a>
							
							<a class="list-group-item" href="#strict-mode">strict-mode</a>
							
							<a class="list-group-item" href="#strict-sni">strict-sni</a>
							
							<a class="list-group-item" href="#sub">sub</a>
							
							<a class="list-group-item" href="#switch-mode">switch-mode</a>
							
							<a class="list-group-item" href="#switch-mode http">switch-mode http</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-T"><h4>T</h4>
								
							<a class="list-group-item" href="#table">table</a>
							
							<a class="list-group-item" href="#table_avl">table_avl</a>
							
							<a class="list-group-item" href="#table_bytes_in_rate">table_bytes_in_rate</a>
							
							<a class="list-group-item" href="#table_bytes_out_rate">table_bytes_out_rate</a>
							
							<a class="list-group-item" href="#table_cnt">table_cnt</a>
							
							<a class="list-group-item" href="#table_conn_cnt">table_conn_cnt</a>
							
							<a class="list-group-item" href="#table_conn_cur">table_conn_cur</a>
							
							<a class="list-group-item" href="#table_conn_rate">table_conn_rate</a>
							
							<a class="list-group-item" href="#table_expire">table_expire</a>
							
							<a class="list-group-item" href="#table_glitch_cnt">table_glitch_cnt</a>
							
							<a class="list-group-item" href="#table_glitch_rate">table_glitch_rate</a>
							
							<a class="list-group-item" href="#table_gpc">table_gpc</a>
							
							<a class="list-group-item" href="#table_gpc0">table_gpc0</a>
							
							<a class="list-group-item" href="#table_gpc0_rate">table_gpc0_rate</a>
							
							<a class="list-group-item" href="#table_gpc1">table_gpc1</a>
							
							<a class="list-group-item" href="#table_gpc1_rate">table_gpc1_rate</a>
							
							<a class="list-group-item" href="#table_gpc_rate">table_gpc_rate</a>
							
							<a class="list-group-item" href="#table_gpt">table_gpt</a>
							
							<a class="list-group-item" href="#table_gpt0">table_gpt0</a>
							
							<a class="list-group-item" href="#table_http_err_cnt">table_http_err_cnt</a>
							
							<a class="list-group-item" href="#table_http_err_rate">table_http_err_rate</a>
							
							<a class="list-group-item" href="#table_http_fail_cnt">table_http_fail_cnt</a>
							
							<a class="list-group-item" href="#table_http_fail_rate">table_http_fail_rate</a>
							
							<a class="list-group-item" href="#table_http_req_cnt">table_http_req_cnt</a>
							
							<a class="list-group-item" href="#table_http_req_rate">table_http_req_rate</a>
							
							<a class="list-group-item" href="#table_idle">table_idle</a>
							
							<a class="list-group-item" href="#table_kbytes_in">table_kbytes_in</a>
							
							<a class="list-group-item" href="#table_kbytes_out">table_kbytes_out</a>
							
							<a class="list-group-item" href="#table_server_id">table_server_id</a>
							
							<a class="list-group-item" href="#table_sess_cnt">table_sess_cnt</a>
							
							<a class="list-group-item" href="#table_sess_rate">table_sess_rate</a>
							
							<a class="list-group-item" href="#table_trackers">table_trackers</a>
							
							<a class="list-group-item" href="#tarpit">tarpit</a>
							
							<a class="list-group-item" href="#tcp-check">tcp-check</a>
							
							<a class="list-group-item" href="#tcp-check comment">tcp-check comment</a>
							
							<a class="list-group-item" href="#tcp-check connect">tcp-check connect</a>
							
							<a class="list-group-item" href="#tcp-check expect">tcp-check expect</a>
							
							<a class="list-group-item" href="#tcp-check send">tcp-check send</a>
							
							<a class="list-group-item" href="#tcp-check send-binary">tcp-check send-binary</a>
							
							<a class="list-group-item" href="#tcp-check send-binary-lf">tcp-check send-binary-lf</a>
							
							<a class="list-group-item" href="#tcp-check send-lf">tcp-check send-lf</a>
							
							<a class="list-group-item" href="#tcp-check set-var">tcp-check set-var</a>
							
							<a class="list-group-item" href="#tcp-check set-var-fmt">tcp-check set-var-fmt</a>
							
							<a class="list-group-item" href="#tcp-check unset-var">tcp-check unset-var</a>
							
							<a class="list-group-item" href="#tcp-request">tcp-request</a>
							
							<a class="list-group-item" href="#tcp-request connection">tcp-request connection</a>
							
							<a class="list-group-item" href="#tcp-request content">tcp-request content</a>
							
							<a class="list-group-item" href="#tcp-request inspect-delay">tcp-request inspect-delay</a>
							
							<a class="list-group-item" href="#tcp-request session">tcp-request session</a>
							
							<a class="list-group-item" href="#tcp-response">tcp-response</a>
							
							<a class="list-group-item" href="#tcp-response content">tcp-response content</a>
							
							<a class="list-group-item" href="#tcp-response inspect-delay">tcp-response inspect-delay</a>
							
							<a class="list-group-item" href="#tcp-ut (Bind options)">tcp-ut (Bind options)</a>
							
							<a class="list-group-item" href="#tcp-ut (Server and default-server options)">tcp-ut (Server and default-server options)</a>
							
							<a class="list-group-item" href="#tfo (Bind options)">tfo (Bind options)</a>
							
							<a class="list-group-item" href="#tfo (Server and default-server options)">tfo (Server and default-server options)</a>
							
							<a class="list-group-item" href="#thread (Bind options)">thread (Bind options)</a>
							
							<a class="list-group-item" href="#thread (Fetching samples from internal states)">thread (Fetching samples from internal states)</a>
							
							<a class="list-group-item" href="#thread-group">thread-group</a>
							
							<a class="list-group-item" href="#thread-groups">thread-groups</a>
							
							<a class="list-group-item" href="#thread-hard-limit">thread-hard-limit</a>
							
							<a class="list-group-item" href="#timeout">timeout</a>
							
							<a class="list-group-item" href="#timeout check">timeout check</a>
							
							<a class="list-group-item" href="#timeout client (Log forwarding)">timeout client (Log forwarding)</a>
							
							<a class="list-group-item" href="#timeout client (Alphabetically sorted keywords reference)">timeout client (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#timeout client-fin">timeout client-fin</a>
							
							<a class="list-group-item" href="#timeout client-hs">timeout client-hs</a>
							
							<a class="list-group-item" href="#timeout connect (Rings)">timeout connect (Rings)</a>
							
							<a class="list-group-item" href="#timeout connect (Alphabetically sorted keywords reference)">timeout connect (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#timeout http-keep-alive">timeout http-keep-alive</a>
							
							<a class="list-group-item" href="#timeout http-request">timeout http-request</a>
							
							<a class="list-group-item" href="#timeout mail">timeout mail</a>
							
							<a class="list-group-item" href="#timeout queue">timeout queue</a>
							
							<a class="list-group-item" href="#timeout server (Rings)">timeout server (Rings)</a>
							
							<a class="list-group-item" href="#timeout server (Alphabetically sorted keywords reference)">timeout server (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#timeout server-fin">timeout server-fin</a>
							
							<a class="list-group-item" href="#timeout tarpit">timeout tarpit</a>
							
							<a class="list-group-item" href="#timeout tunnel">timeout tunnel</a>
							
							<a class="list-group-item" href="#tls-ticket-keys">tls-ticket-keys</a>
							
							<a class="list-group-item" href="#tls-tickets">tls-tickets</a>
							
							<a class="list-group-item" href="#total-max-size">total-max-size</a>
							
							<a class="list-group-item" href="#trace">trace</a>
							
							<a class="list-group-item" href="#traces">traces</a>
							
							<a class="list-group-item" href="#track">track</a>
							
							<a class="list-group-item" href="#track-sc0">track-sc0</a>
							
							<a class="list-group-item" href="#track-sc1">track-sc1</a>
							
							<a class="list-group-item" href="#track-sc2">track-sc2</a>
							
							<a class="list-group-item" href="#transparent">transparent</a>
							
							<a class="list-group-item" href="#tune.applet.zero-copy-forwarding">tune.applet.zero-copy-forwarding</a>
							
							<a class="list-group-item" href="#tune.buffers.limit">tune.buffers.limit</a>
							
							<a class="list-group-item" href="#tune.buffers.reserve">tune.buffers.reserve</a>
							
							<a class="list-group-item" href="#tune.bufsize">tune.bufsize</a>
							
							<a class="list-group-item" href="#tune.bufsize.small">tune.bufsize.small</a>
							
							<a class="list-group-item" href="#tune.comp.maxlevel">tune.comp.maxlevel</a>
							
							<a class="list-group-item" href="#tune.disable-fast-forward">tune.disable-fast-forward</a>
							
							<a class="list-group-item" href="#tune.disable-zero-copy-forwarding">tune.disable-zero-copy-forwarding</a>
							
							<a class="list-group-item" href="#tune.events.max-events-at-once">tune.events.max-events-at-once</a>
							
							<a class="list-group-item" href="#tune.fail-alloc">tune.fail-alloc</a>
							
							<a class="list-group-item" href="#tune.fd.edge-triggered">tune.fd.edge-triggered</a>
							
							<a class="list-group-item" href="#tune.h1.zero-copy-fwd-recv">tune.h1.zero-copy-fwd-recv</a>
							
							<a class="list-group-item" href="#tune.h1.zero-copy-fwd-send">tune.h1.zero-copy-fwd-send</a>
							
							<a class="list-group-item" href="#tune.h2.be.glitches-threshold">tune.h2.be.glitches-threshold</a>
							
							<a class="list-group-item" href="#tune.h2.be.initial-window-size">tune.h2.be.initial-window-size</a>
							
							<a class="list-group-item" href="#tune.h2.be.max-concurrent-streams">tune.h2.be.max-concurrent-streams</a>
							
							<a class="list-group-item" href="#tune.h2.be.rxbuf">tune.h2.be.rxbuf</a>
							
							<a class="list-group-item" href="#tune.h2.fe.glitches-threshold">tune.h2.fe.glitches-threshold</a>
							
							<a class="list-group-item" href="#tune.h2.fe.initial-window-size">tune.h2.fe.initial-window-size</a>
							
							<a class="list-group-item" href="#tune.h2.fe.max-concurrent-streams">tune.h2.fe.max-concurrent-streams</a>
							
							<a class="list-group-item" href="#tune.h2.fe.max-total-streams">tune.h2.fe.max-total-streams</a>
							
							<a class="list-group-item" href="#tune.h2.fe.rxbuf">tune.h2.fe.rxbuf</a>
							
							<a class="list-group-item" href="#tune.h2.header-table-size">tune.h2.header-table-size</a>
							
							<a class="list-group-item" href="#tune.h2.initial-window-size">tune.h2.initial-window-size</a>
							
							<a class="list-group-item" href="#tune.h2.max-concurrent-streams">tune.h2.max-concurrent-streams</a>
							
							<a class="list-group-item" href="#tune.h2.max-frame-size">tune.h2.max-frame-size</a>
							
							<a class="list-group-item" href="#tune.h2.zero-copy-fwd-send">tune.h2.zero-copy-fwd-send</a>
							
							<a class="list-group-item" href="#tune.http.cookielen">tune.http.cookielen</a>
							
							<a class="list-group-item" href="#tune.http.logurilen">tune.http.logurilen</a>
							
							<a class="list-group-item" href="#tune.http.maxhdr">tune.http.maxhdr</a>
							
							<a class="list-group-item" href="#tune.idle-pool.shared">tune.idle-pool.shared</a>
							
							<a class="list-group-item" href="#tune.idletimer">tune.idletimer</a>
							
							<a class="list-group-item" href="#tune.listener.default-shards">tune.listener.default-shards</a>
							
							<a class="list-group-item" href="#tune.listener.multi-queue">tune.listener.multi-queue</a>
							
							<a class="list-group-item" href="#tune.lua.burst-timeout">tune.lua.burst-timeout</a>
							
							<a class="list-group-item" href="#tune.lua.forced-yield">tune.lua.forced-yield</a>
							
							<a class="list-group-item" href="#tune.lua.log.loggers">tune.lua.log.loggers</a>
							
							<a class="list-group-item" href="#tune.lua.log.stderr">tune.lua.log.stderr</a>
							
							<a class="list-group-item" href="#tune.lua.maxmem">tune.lua.maxmem</a>
							
							<a class="list-group-item" href="#tune.lua.service-timeout">tune.lua.service-timeout</a>
							
							<a class="list-group-item" href="#tune.lua.session-timeout">tune.lua.session-timeout</a>
							
							<a class="list-group-item" href="#tune.lua.task-timeout">tune.lua.task-timeout</a>
							
							<a class="list-group-item" href="#tune.max-checks-per-thread">tune.max-checks-per-thread</a>
							
							<a class="list-group-item" href="#tune.maxaccept">tune.maxaccept</a>
							
							<a class="list-group-item" href="#tune.maxpollevents">tune.maxpollevents</a>
							
							<a class="list-group-item" href="#tune.maxrewrite">tune.maxrewrite</a>
							
							<a class="list-group-item" href="#tune.memory.hot-size">tune.memory.hot-size</a>
							
							<a class="list-group-item" href="#tune.pattern.cache-size">tune.pattern.cache-size</a>
							
							<a class="list-group-item" href="#tune.peers.max-updates-at-once">tune.peers.max-updates-at-once</a>
							
							<a class="list-group-item" href="#tune.pipesize">tune.pipesize</a>
							
							<a class="list-group-item" href="#tune.pool-high-fd-ratio">tune.pool-high-fd-ratio</a>
							
							<a class="list-group-item" href="#tune.pool-low-fd-ratio">tune.pool-low-fd-ratio</a>
							
							<a class="list-group-item" href="#tune.pt.zero-copy-forwarding">tune.pt.zero-copy-forwarding</a>
							
							<a class="list-group-item" href="#tune.quic.cc-hystart">tune.quic.cc-hystart</a>
							
							<a class="list-group-item" href="#tune.quic.cc.cubic.min-losses">tune.quic.cc.cubic.min-losses</a>
							
							<a class="list-group-item" href="#tune.quic.disable-udp-gso">tune.quic.disable-udp-gso</a>
							
							<a class="list-group-item" href="#tune.quic.frontend.default-max-window-size">tune.quic.frontend.default-max-window-size</a>
							
							<a class="list-group-item" href="#tune.quic.frontend.glitches-threshold">tune.quic.frontend.glitches-threshold</a>
							
							<a class="list-group-item" href="#tune.quic.frontend.max-idle-timeout">tune.quic.frontend.max-idle-timeout</a>
							
							<a class="list-group-item" href="#tune.quic.frontend.max-streams-bidi">tune.quic.frontend.max-streams-bidi</a>
							
							<a class="list-group-item" href="#tune.quic.max-frame-loss">tune.quic.max-frame-loss</a>
							
							<a class="list-group-item" href="#tune.quic.reorder-ratio">tune.quic.reorder-ratio</a>
							
							<a class="list-group-item" href="#tune.quic.retry-threshold">tune.quic.retry-threshold</a>
							
							<a class="list-group-item" href="#tune.quic.socket-owner">tune.quic.socket-owner</a>
							
							<a class="list-group-item" href="#tune.quic.zero-copy-fwd-send">tune.quic.zero-copy-fwd-send</a>
							
							<a class="list-group-item" href="#tune.rcvbuf.backend">tune.rcvbuf.backend</a>
							
							<a class="list-group-item" href="#tune.rcvbuf.client">tune.rcvbuf.client</a>
							
							<a class="list-group-item" href="#tune.rcvbuf.frontend">tune.rcvbuf.frontend</a>
							
							<a class="list-group-item" href="#tune.rcvbuf.server">tune.rcvbuf.server</a>
							
							<a class="list-group-item" href="#tune.recv_enough">tune.recv_enough</a>
							
							<a class="list-group-item" href="#tune.renice.runtime">tune.renice.runtime</a>
							
							<a class="list-group-item" href="#tune.renice.startup">tune.renice.startup</a>
							
							<a class="list-group-item" href="#tune.ring.queues">tune.ring.queues</a>
							
							<a class="list-group-item" href="#tune.runqueue-depth">tune.runqueue-depth</a>
							
							<a class="list-group-item" href="#tune.sched.low-latency">tune.sched.low-latency</a>
							
							<a class="list-group-item" href="#tune.sndbuf.backend">tune.sndbuf.backend</a>
							
							<a class="list-group-item" href="#tune.sndbuf.client">tune.sndbuf.client</a>
							
							<a class="list-group-item" href="#tune.sndbuf.frontend">tune.sndbuf.frontend</a>
							
							<a class="list-group-item" href="#tune.sndbuf.server">tune.sndbuf.server</a>
							
							<a class="list-group-item" href="#tune.ssl.cachesize">tune.ssl.cachesize</a>
							
							<a class="list-group-item" href="#tune.ssl.capture-buffer-size">tune.ssl.capture-buffer-size</a>
							
							<a class="list-group-item" href="#tune.ssl.capture-cipherlist-size">tune.ssl.capture-cipherlist-size</a>
							
							<a class="list-group-item" href="#tune.ssl.default-dh-param">tune.ssl.default-dh-param</a>
							
							<a class="list-group-item" href="#tune.ssl.force-private-cache">tune.ssl.force-private-cache</a>
							
							<a class="list-group-item" href="#tune.ssl.hard-maxrecord">tune.ssl.hard-maxrecord</a>
							
							<a class="list-group-item" href="#tune.ssl.keylog">tune.ssl.keylog</a>
							
							<a class="list-group-item" href="#tune.ssl.lifetime">tune.ssl.lifetime</a>
							
							<a class="list-group-item" href="#tune.ssl.maxrecord">tune.ssl.maxrecord</a>
							
							<a class="list-group-item" href="#tune.ssl.ocsp-update.maxdelay">tune.ssl.ocsp-update.maxdelay</a>
							
							<a class="list-group-item" href="#tune.ssl.ocsp-update.mindelay">tune.ssl.ocsp-update.mindelay</a>
							
							<a class="list-group-item" href="#tune.ssl.ssl-ctx-cache-size">tune.ssl.ssl-ctx-cache-size</a>
							
							<a class="list-group-item" href="#tune.stick-counters">tune.stick-counters</a>
							
							<a class="list-group-item" href="#tune.vars.global-max-size">tune.vars.global-max-size</a>
							
							<a class="list-group-item" href="#tune.vars.proc-max-size">tune.vars.proc-max-size</a>
							
							<a class="list-group-item" href="#tune.vars.reqres-max-size">tune.vars.reqres-max-size</a>
							
							<a class="list-group-item" href="#tune.vars.sess-max-size">tune.vars.sess-max-size</a>
							
							<a class="list-group-item" href="#tune.vars.txn-max-size">tune.vars.txn-max-size</a>
							
							<a class="list-group-item" href="#tune.zlib.memlevel">tune.zlib.memlevel</a>
							
							<a class="list-group-item" href="#tune.zlib.windowsize">tune.zlib.windowsize</a>
							
							<a class="list-group-item" href="#txn.conn_retries">txn.conn_retries</a>
							
							<a class="list-group-item" href="#txn.id32">txn.id32</a>
							
							<a class="list-group-item" href="#txn.redispatched">txn.redispatched</a>
							
							<a class="list-group-item" href="#txn.sess_term_state">txn.sess_term_state</a>
							
							<a class="list-group-item" href="#txn.status">txn.status</a>
							
							<a class="list-group-item" href="#txn.timer.total">txn.timer.total</a>
							
							<a class="list-group-item" href="#txn.timer.user">txn.timer.user</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-U"><h4>U</h4>
								
							<a class="list-group-item" href="#ub64dec">ub64dec</a>
							
							<a class="list-group-item" href="#ub64enc">ub64enc</a>
							
							<a class="list-group-item" href="#uid (Process management and security)">uid (Process management and security)</a>
							
							<a class="list-group-item" href="#uid (Bind options)">uid (Bind options)</a>
							
							<a class="list-group-item" href="#ulimit-n">ulimit-n</a>
							
							<a class="list-group-item" href="#ungrpc">ungrpc</a>
							
							<a class="list-group-item" href="#unique-id">unique-id</a>
							
							<a class="list-group-item" href="#unique-id-format">unique-id-format</a>
							
							<a class="list-group-item" href="#unique-id-header">unique-id-header</a>
							
							<a class="list-group-item" href="#unix-bind">unix-bind</a>
							
							<a class="list-group-item" href="#unset-var">unset-var</a>
							
							<a class="list-group-item" href="#unsetenv">unsetenv</a>
							
							<a class="list-group-item" href="#upper">upper</a>
							
							<a class="list-group-item" href="#uptime">uptime</a>
							
							<a class="list-group-item" href="#url">url</a>
							
							<a class="list-group-item" href="#url32">url32</a>
							
							<a class="list-group-item" href="#url32+src">url32+src</a>
							
							<a class="list-group-item" href="#url_dec">url_dec</a>
							
							<a class="list-group-item" href="#url_enc">url_enc</a>
							
							<a class="list-group-item" href="#url_ip">url_ip</a>
							
							<a class="list-group-item" href="#url_param">url_param</a>
							
							<a class="list-group-item" href="#url_port">url_port</a>
							
							<a class="list-group-item" href="#urlp">urlp</a>
							
							<a class="list-group-item" href="#urlp_val">urlp_val</a>
							
							<a class="list-group-item" href="#us_ltime">us_ltime</a>
							
							<a class="list-group-item" href="#us_utime">us_utime</a>
							
							<a class="list-group-item" href="#use-fcgi-app (Proxy section)">use-fcgi-app (Proxy section)</a>
							
							<a class="list-group-item" href="#use-fcgi-app (Alphabetically sorted keywords reference)">use-fcgi-app (Alphabetically sorted keywords reference)</a>
							
							<a class="list-group-item" href="#use-server">use-server</a>
							
							<a class="list-group-item" href="#use-service">use-service</a>
							
							<a class="list-group-item" href="#use_backend">use_backend</a>
							
							<a class="list-group-item" href="#user (Process management and security)">user (Process management and security)</a>
							
							<a class="list-group-item" href="#user (Userlists)">user (Userlists)</a>
							
							<a class="list-group-item" href="#user (Programs (deprecated))">user (Programs (deprecated))</a>
							
							<a class="list-group-item" href="#user (Bind options)">user (Bind options)</a>
							
							<a class="list-group-item" href="#userlist">userlist</a>
							
							<a class="list-group-item" href="#utime">utime</a>
							
							<a class="list-group-item" href="#uuid">uuid</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-V"><h4>V</h4>
								
							<a class="list-group-item" href="#v4v6">v4v6</a>
							
							<a class="list-group-item" href="#v6only">v6only</a>
							
							<a class="list-group-item" href="#var">var</a>
							
							<a class="list-group-item" href="#verify (Bind options)">verify (Bind options)</a>
							
							<a class="list-group-item" href="#verify (Server and default-server options)">verify (Server and default-server options)</a>
							
							<a class="list-group-item" href="#verifyhost">verifyhost</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-W"><h4>W</h4>
								
							<a class="list-group-item" href="#wait-for-body">wait-for-body</a>
							
							<a class="list-group-item" href="#wait-for-body time">wait-for-body time</a>
							
							<a class="list-group-item" href="#wait-for-handshake">wait-for-handshake</a>
							
							<a class="list-group-item" href="#wait_end">wait_end</a>
							
							<a class="list-group-item" href="#waiting_entity">waiting_entity</a>
							
							<a class="list-group-item" href="#warn-blocked-traffic-after">warn-blocked-traffic-after</a>
							
							<a class="list-group-item" href="#weight">weight</a>
							
							<a class="list-group-item" href="#when">when</a>
							
							<a class="list-group-item" href="#word">word</a>
							
							<a class="list-group-item" href="#ws">ws</a>
							
							<a class="list-group-item" href="#wt6">wt6</a>
							
							<a class="list-group-item" href="#wurfl-cache-size">wurfl-cache-size</a>
							
							<a class="list-group-item" href="#wurfl-data-file">wurfl-data-file</a>
							
							<a class="list-group-item" href="#wurfl-information-list">wurfl-information-list</a>
							
							<a class="list-group-item" href="#wurfl-information-list-separator">wurfl-information-list-separator</a>
							
							<a class="list-group-item" href="#wurfl-patch-file">wurfl-patch-file</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-X"><h4>X</h4>
								
							<a class="list-group-item" href="#x509_v_err_str">x509_v_err_str</a>
							
							<a class="list-group-item" href="#xor">xor</a>
							
							<a class="list-group-item" href="#xxh3">xxh3</a>
							
							<a class="list-group-item" href="#xxh32">xxh32</a>
							
							<a class="list-group-item" href="#xxh64">xxh64</a>
							
                                                                </div> <!-- /letter -->
								<div class="letter" id="letter-Z"><h4>Z</h4>
								
							<a class="list-group-item" href="#zero-warning">zero-warning</a>
						</div><!-- /letter -->
					</div>
				</div>

				<p>
					Keyboard navigation&nbsp;: <span id="keyboardNavStatus"></span>
				</p>
				<p>
					You can use <strong>left</strong> and <strong>right</strong> arrow keys to navigate between chapters.<br>
				</p>
				<p class="text-right">
					<small>Converted with <a href="https://github.com/cbonte/haproxy-dconv">haproxy-dconv</a> v<b>0.4.2-15</b> on <b>2024/12/11</b></small>
				</p>
			</div>
			<!-- /.sidebar -->

			<div id="page-wrapper">
				<div class="row">
					<div class="col-lg-12">
						<div class="text-center">
                            <h1><a href="http://www.haproxy.org/" title="HAProxy"><img src="../img/HAProxyCommunityEdition_60px.png?0.4.2-15" /></a></h1>
							<h2>Configuration Manual</h2>
							<p><strong>version 3.1.1</strong></p>
							<p>
								2024/12/11<br>
								
							</p>
						</div>

						<div><pre class="text">This document covers the configuration language as implemented in the version
specified above. It does not provide any hints, examples, or advice. For such
documentation, please refer to the Reference Manual or the Architecture Manual.
The summary below is meant to help you find sections by name and navigate
through the document.

Note to documentation contributors :
    This document is formatted with 80 columns per line, with even number of
    spaces for indentation and without tabs. Please follow these rules strictly
    so that it remains easily printable everywhere. If a line needs to be
    printed verbatim and does not fit, please end each line with a backslash
    ('\') and continue on next line, indented by two characters. It is also
    sometimes useful to prefix all output lines (logs, console outputs) with 3
    closing angle brackets ('&gt;&gt;&gt;') in order to emphasize the difference between
    inputs and outputs when they may be ambiguous. If you add sections,
    please update the summary below for easier searching.
</pre></div>
<a class="anchor" id="summary" name="summary"></a>
<div class="page-header">
	<h1 id="chapter-summary" data-target="summary">Summary</h1>
</div>
<table class="summary">
	<tbody>
		
			
				
				<tr>
					<td><b><small>1.</small></b></td>
					<td>
							<a href="#1"><b>Quick reminder about HTTP</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>1.1.</small></td>
					<td>
							<div class="tab">
							<a href="#1.1">The HTTP transaction model</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>1.2.</small></td>
					<td>
							<div class="tab">
							<a href="#1.2">Terminology</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>1.3.</small></td>
					<td>
							<div class="tab">
							<a href="#1.3">HTTP request</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>1.3.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#1.3.1">The request line</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>1.3.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#1.3.2">The request headers</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>1.4.</small></td>
					<td>
							<div class="tab">
							<a href="#1.4">HTTP response</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>1.4.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#1.4.1">The response line</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>1.4.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#1.4.2">The response headers</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>2.</small></b></td>
					<td>
							<a href="#2"><br><b>Configuring HAProxy</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.1.</small></td>
					<td>
							<div class="tab">
							<a href="#2.1">Configuration file format</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.2.</small></td>
					<td>
							<div class="tab">
							<a href="#2.2">Quoting and escaping</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.3.</small></td>
					<td>
							<div class="tab">
							<a href="#2.3">Environment variables</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.4.</small></td>
					<td>
							<div class="tab">
							<a href="#2.4">Conditional blocks</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.5.</small></td>
					<td>
							<div class="tab">
							<a href="#2.5">Time format</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.6.</small></td>
					<td>
							<div class="tab">
							<a href="#2.6">Size format</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.7.</small></td>
					<td>
							<div class="tab">
							<a href="#2.7">Name format for maps and ACLs</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.8.</small></td>
					<td>
							<div class="tab">
							<a href="#2.8">Variables</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>2.9.</small></td>
					<td>
							<div class="tab">
							<a href="#2.9">Examples</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>3.</small></b></td>
					<td>
							<a href="#3"><br><b>Global parameters</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.1.</small></td>
					<td>
							<div class="tab">
							<a href="#3.1">Process management and security</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.2.</small></td>
					<td>
							<div class="tab">
							<a href="#3.2">Performance tuning</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.3.</small></td>
					<td>
							<div class="tab">
							<a href="#3.3">Debugging</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.3.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#3.3.1">Traces</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.4.</small></td>
					<td>
							<div class="tab">
							<a href="#3.4">Userlists</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.5.</small></td>
					<td>
							<div class="tab">
							<a href="#3.5">Peers</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.6.</small></td>
					<td>
							<div class="tab">
							<a href="#3.6">Mailers</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.7.</small></td>
					<td>
							<div class="tab">
							<a href="#3.7">Programs (deprecated)</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.8.</small></td>
					<td>
							<div class="tab">
							<a href="#3.8">HTTP-errors</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.9.</small></td>
					<td>
							<div class="tab">
							<a href="#3.9">Rings</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.10.</small></td>
					<td>
							<div class="tab">
							<a href="#3.10">Log forwarding</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.11.</small></td>
					<td>
							<div class="tab">
							<a href="#3.11">HTTPClient tuning</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.12.</small></td>
					<td>
							<div class="tab">
							<a href="#3.12">Certificate Storage</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>3.12.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#3.12.1">Load options</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>4.</small></b></td>
					<td>
							<a href="#4"><br><b>Proxies</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>4.1.</small></td>
					<td>
							<div class="tab">
							<a href="#4.1">Proxy keywords matrix</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>4.2.</small></td>
					<td>
							<div class="tab">
							<a href="#4.2">Alphabetically sorted keywords reference</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>4.3.</small></td>
					<td>
							<div class="tab">
							<a href="#4.3">Actions keywords matrix</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>4.4.</small></td>
					<td>
							<div class="tab">
							<a href="#4.4">Alphabetically sorted actions reference</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>5.</small></b></td>
					<td>
							<a href="#5"><br><b>Bind and server options</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>5.1.</small></td>
					<td>
							<div class="tab">
							<a href="#5.1">Bind options</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>5.2.</small></td>
					<td>
							<div class="tab">
							<a href="#5.2">Server and default-server options</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>5.3.</small></td>
					<td>
							<div class="tab">
							<a href="#5.3">Server DNS resolution</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>5.3.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#5.3.1">Global overview</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>5.3.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#5.3.2">The resolvers section</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>6.</small></b></td>
					<td>
							<a href="#6"><br><b>Cache</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>6.1.</small></td>
					<td>
							<div class="tab">
							<a href="#6.1">Limitation</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>6.2.</small></td>
					<td>
							<div class="tab">
							<a href="#6.2">Setup</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>6.2.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#6.2.1">Cache section</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>6.2.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#6.2.2">Proxy section</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>7.</small></b></td>
					<td>
							<a href="#7"><br><b>Using ACLs and fetching samples</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.1.</small></td>
					<td>
							<div class="tab">
							<a href="#7.1">ACL basics</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.1.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.1.1">Matching booleans</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.1.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.1.2">Matching integers</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.1.3.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.1.3">Matching strings</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.1.4.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.1.4">Matching regular expressions (regexes)</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.1.5.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.1.5">Matching arbitrary data blocks</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.1.6.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.1.6">Matching IPv4 and IPv6 addresses</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.2.</small></td>
					<td>
							<div class="tab">
							<a href="#7.2">Using ACLs to form conditions</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.3.</small></td>
					<td>
							<div class="tab">
							<a href="#7.3">Fetching samples</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.3.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.3.1">Converters</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.3.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.3.2">Fetching samples from internal states</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.3.3.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.3.3">Fetching samples at Layer 4</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.3.4.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.3.4">Fetching samples at Layer 5</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.3.5.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.3.5">Fetching samples from buffer contents (Layer 6)</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.3.6.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.3.6">Fetching HTTP samples (Layer 7)</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.3.7.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#7.3.7">Fetching samples for developers</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>7.4.</small></td>
					<td>
							<div class="tab">
							<a href="#7.4">Pre-defined ACLs</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>8.</small></b></td>
					<td>
							<a href="#8"><br><b>Logging</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.1.</small></td>
					<td>
							<div class="tab">
							<a href="#8.1">Log levels</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.2.</small></td>
					<td>
							<div class="tab">
							<a href="#8.2">Log formats</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.2.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.2.1">Default log format</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.2.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.2.2">TCP log format</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.2.3.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.2.3">HTTP log format</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.2.4.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.2.4">HTTPS log format</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.2.5.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.2.5">Error log format</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.2.6.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.2.6">Custom log format</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.3.</small></td>
					<td>
							<div class="tab">
							<a href="#8.3">Advanced logging options</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.3.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.3.1">Disabling logging of external tests</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.3.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.3.2">Logging before waiting for the stream to terminate</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.3.3.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.3.3">Raising log level upon errors</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.3.4.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.3.4">Disabling logging of successful connections</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.3.5.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#8.3.5">Log profiles</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.4.</small></td>
					<td>
							<div class="tab">
							<a href="#8.4">Timing events</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.5.</small></td>
					<td>
							<div class="tab">
							<a href="#8.5">Stream state at disconnection</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.6.</small></td>
					<td>
							<div class="tab">
							<a href="#8.6">Non-printable characters</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.7.</small></td>
					<td>
							<div class="tab">
							<a href="#8.7">Capturing HTTP cookies</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.8.</small></td>
					<td>
							<div class="tab">
							<a href="#8.8">Capturing HTTP headers</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>8.9.</small></td>
					<td>
							<div class="tab">
							<a href="#8.9">Examples of logs</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>9.</small></b></td>
					<td>
							<a href="#9"><br><b>Supported filters</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>9.1.</small></td>
					<td>
							<div class="tab">
							<a href="#9.1">Trace</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>9.2.</small></td>
					<td>
							<div class="tab">
							<a href="#9.2">HTTP compression</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>9.3.</small></td>
					<td>
							<div class="tab">
							<a href="#9.3">Stream Processing Offload Engine (SPOE)</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>9.4.</small></td>
					<td>
							<div class="tab">
							<a href="#9.4">Cache</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>9.5.</small></td>
					<td>
							<div class="tab">
							<a href="#9.5">fcgi-app</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>9.6.</small></td>
					<td>
							<div class="tab">
							<a href="#9.6">OpenTracing</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>9.7.</small></td>
					<td>
							<div class="tab">
							<a href="#9.7">Bandwidth limitation</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>10.</small></b></td>
					<td>
							<a href="#10"><br><b>FastCGI applications</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>10.1.</small></td>
					<td>
							<div class="tab">
							<a href="#10.1">Setup</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>10.1.1.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#10.1.1">Fcgi-app section</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>10.1.2.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#10.1.2">Proxy section</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>10.1.3.</small></td>
					<td>
							<div class="tab">
							<div class="tab">
							<a href="#10.1.3">Example</a>
							</div>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>10.2.</small></td>
					<td>
							<div class="tab">
							<a href="#10.2">Default parameters</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>10.3.</small></td>
					<td>
							<div class="tab">
							<a href="#10.3">Limitations</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><br><b><small>11.</small></b></td>
					<td>
							<a href="#11"><br><b>Address formats</b></a>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>11.1.</small></td>
					<td>
							<div class="tab">
							<a href="#11.1">Address family prefixes</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>11.2.</small></td>
					<td>
							<div class="tab">
							<a href="#11.2">Socket type prefixes</a>
							</div>
					<td>
				</tr>
				
			
				
				<tr>
					<td><small>11.3.</small></td>
					<td>
							<div class="tab">
							<a href="#11.3">Protocol prefixes</a>
							</div>
					<td>
				</tr>
				
	</tbody>
</table>


<a class="anchor" id="1" name="1"></a>
<div class="page-header"><h1 id="chapter-1" data-target="1"><small><a class="small" href="#1">1.</a></small> Quick reminder about HTTP</h1>
</div><div><pre class="text">When HAProxy is running in HTTP mode, both the request and the response are
fully analyzed and indexed, thus it becomes possible to build matching criteria
on almost anything found in the contents.

However, it is important to understand how HTTP requests and responses are
formed, and how HAProxy decomposes them. It will then become easier to write
correct rules and to debug existing configurations.

First, HTTP is standardized by a series of RFC that HAProxy follows as closely
as possible:
  - RFC 9110: HTTP Semantics (explains the meaning of protocol elements)
  - RFC 9111: HTTP Caching (explains the rules to follow for an HTTP cache)
  - RFC 9112: HTTP/1.1 (representation, interoperability rules, security)
  - RFC 9113: HTTP/2   (representation, interoperability rules, security)
  - RFC 9114: HTTP/3   (representation, interoperability rules, security)

In addition to these, RFC 8999 to 9002 specify the QUIC transport layer used by
the HTTP/3 protocol.
</pre></div>
<a class="anchor" id="1.1" name="1.1"></a>
<h2 id="chapter-1.1" data-target="1.1"><small><a class="small" href="#1.1">1.1.</a></small> The HTTP transaction model</h2>
<div><pre class="text">The HTTP protocol is transaction-driven. This means that each request will lead
to one and only one response. Originally, with version 1.0 of the protocol,
there was a single request per connection: a TCP connection is established from
the client to the server, a request is sent by the client over the connection,
the server responds, and the connection is closed. A new request then involves
a new connection :

  [CON1] [REQ1] ... [RESP1] [CLO1] [CON2] [REQ2] ... [RESP2] [CLO2] ...

In this mode, often called the &quot;HTTP close&quot; mode, there are as many connection
establishments as there are HTTP transactions. Since the connection is closed
by the server after the response, the client does not need to know the content
length, it considers that the response is complete when the connection closes.
This also means that if some responses are truncated due to network errors, the
client could mistakenly think a response was complete, and this used to cause
truncated images to be rendered on screen sometimes.

Due to the transactional nature of the protocol, it was possible to improve it
to avoid closing a connection between two subsequent transactions. In this mode
however, it is mandatory that the server indicates the content length for each
response so that the client does not wait indefinitely. For this, a special
header is used: &quot;Content-length&quot;. This mode is called the &quot;keep-alive&quot; mode,
and arrived with HTTP/1.1 (some HTTP/1.0 agents support it), and connections
that are reused between requests are called &quot;persistent connections&quot;:

  [CON] [REQ1] ... [RESP1] [REQ2] ... [RESP2] [CLO] ...

Its advantages are a reduced latency between transactions, less processing
power required on the server side, and the ability to detect a truncated
response. It is generally faster than the close mode, but not always because
some clients often limit their concurrent connections to a smaller value, and
this compensates less for poor network connectivity. Also, some servers have to
keep the connection alive for a long time waiting for a possible new request
and may experience a high memory usage due to the high number of connections,
and closing too fast may break some requests that arrived at the moment the
connection was closed.

In this mode, the response size needs to be known upfront so that's not always
possible with dynamically generated or compressed contents. For this reason
another mode was implemented, the &quot;chunked mode&quot;, where instead of announcing
the size of the whole size at once, the sender only advertises the size of the
next &quot;chunk&quot; of response it already has in a buffer, and can terminate at any
moment with a zero-sized chunk. In this mode, the Content-Length header is not
used.

Another improvement in the communications is the pipelining mode. It still uses
keep-alive, but the client does not wait for the first response to send the
second request. This is useful for fetching large number of images composing a
page :

  [CON] [REQ1] [REQ2] ... [RESP1] [RESP2] [CLO] ...

This can obviously have a tremendous benefit on performance because the network
latency is eliminated between subsequent requests. Many HTTP agents do not
correctly support pipelining since there is no way to associate a response with
the corresponding request in HTTP. For this reason, it is mandatory for the
server to reply in the exact same order as the requests were received. In
practice, after several attempts by various clients to deploy it, it has been
totally abandoned for its lack of reliability on certain servers. But it is
mandatory for servers to support it.

The next improvement is the multiplexed mode, as implemented in HTTP/2 and
HTTP/3. In this mode, multiple transactions (i.e. request-response pairs) are
transmitted in parallel over a single connection, and they all progress at
their own speed, independent from each other. With multiplexed protocols, a new
notion of &quot;stream&quot; was introduced, to represent these parallel communications
happening over the same connection. Each stream is generally assigned a unique
identifier for a given connection, that is used by both endpoints to know where
to deliver the data. It is fairly common for clients to start many (up to 100,
sometimes more) streams in parallel over a same connection, and let the server
sort them out and respond in any order depending on what response is available.
The main benefit of the multiplexed mode is that it significantly reduces the
number of round trips, and speeds up page loading time over high latency
networks. It is sometimes visible on sites using many images, where all images
appear to load in parallel.

These protocols have also improved their efficiency by adopting some mechanisms
to compress header fields in order to reduce the number of bytes on the wire,
so that without the appropriate tools, they are not realistically manipulable
by hand nor readable to the naked eye like HTTP/1 was. For this reason, various
examples of HTTP messages continue to be represented in literature (including
this document) using the HTTP/1 syntax even for newer versions of the protocol.

HTTP/2 suffers from some design limitations, such as packet losses affecting
all streams at once, and if a client takes too much time to retrieve an object
(e.g. needs to store it on disk), it may slow down its retrieval and make it
impossible during this time to access the data that is pending behind it. This
is called &quot;head of line blocking&quot; or &quot;HoL blocking&quot; or sometimes just &quot;HoL&quot;.

HTTP/3 is implemented over QUIC, itself implemented over UDP. QUIC solves the
head of line blocking at the transport level by means of independently handled
streams. Indeed, when experiencing loss, an impacted stream does not affect the
other streams, and all of them can be accessed in parallel. QUIC also provides
connection migration support but currently haproxy does not support it.

By default HAProxy operates in keep-alive mode with regards to persistent
connections: for each connection it processes each request and response, and
leaves the connection idle on both sides between the end of a response and the
start of a new request. When it receives HTTP/2 connections from a client, it
processes all the requests in parallel and leaves the connection idling,
waiting for new requests, just as if it was a keep-alive HTTP connection.

HAProxy essentially supports 3 connection modes :
  - keep alive    : all requests and responses are processed, and the client
                    facing and server facing connections are kept alive for new
                    requests. This is the default and suits the modern web and
                    modern protocols (HTTP/2 and HTTP/3).

  - server close  : the server-facing connection is closed after the response.

  - close         : the connection is actively closed after end of response on
                    both sides.

In addition to this, by default, the server-facing connection is reusable by
any request from any client, as mandated by the HTTP protocol specification, so
any information pertaining to a specific client has to be passed along with
each request if needed (e.g. client's source address etc). When HTTP/2 is used
with a server, by default HAProxy will dedicate this connection to the same
client to avoid the risk of head of line blocking between clients.
</pre></div>
<a class="anchor" id="1.2" name="1.2"></a>
<h2 id="chapter-1.2" data-target="1.2"><small><a class="small" href="#1.2">1.2.</a></small> Terminology</h2>
<div><pre class="text">Inside HAProxy, the terminology has evolved a bit over the ages to follow the
evolutions of the HTTP protocol and its usages. While originally there was no
significant difference between a connection, a session, a stream or a
transaction, these ones clarified over time to match closely what exists in the
modern versions of the HTTP protocol, though some terms remain visible in the
configuration or the command line interface for the purpose of historical
compatibility.

Here are some definitions that apply to the current version of HAProxy:

  - connection: a connection is a single, bidiractional communication channel
    between a remote agent (client or server) and haproxy, at the lowest level
    possible. Usually it corresponds to a TCP socket established between a pair
    of IP and ports. On the client-facing side, connections are the very first
    entities that are instantiated when a client connects to haproxy, and rules
    applying at the connection level are the earliest ones that apply.

  - session: a session adds some context information associated with a
    connection. This includes and information specific to the transport layer
    (e.g. TLS keys etc), or variables. This term has long been used inside
    HAProxy to denote end-to-end HTTP/1.0 communications between two ends, and
    as such it remains visible in the name of certain CLI commands or
    statistics, despite representing streams nowadays, but the help messages
    and descriptions try to make this unambiguous. It is still valid when it
    comes to network-level terminology (e.g. TCP sessions inside the operating
    systems, or TCP sessions across a firewall), or for non-HTTP user-level
    applications (e.g. a telnet session or an SSH session). It must not be
    confused with &quot;application sessions&quot; that are used to store a full user
    context in a cookie and require to be sent to the same server.

  - stream: a stream exactly corresponds to an end-to-end bidirectional
    communication at the application level, where analysis and transformations
    may be applied. In HTTP, it contains a single request and its associated
    response, and is instantiated by the arrival of the request and is finished
    with the end of delivery of the response. In this context there is a 1:1
    relation between such a stream and the stream of a multiplexed protocol. In
    TCP communications there is a single stream per connection.

  - transaction: a transaction is only a pair of a request and the associated
    response. The term was used in conjunction with sessions before the streams
    but nowadays there is a 1:1 relation between a transaction and a stream. It
    is essentially visible in the variables' scope &quot;txn&quot; which is valid during
    the whole transaction, hence the stream.

  - request: it designates the traffic flowing from the client to the server.
    It is mainly used for HTTP to indicate where operations are performed. This
    term also exists for TCP operations to indicate where data are processed.
    Requests often appear in counters as a unit of traffic or activity. They do
    not always imply a response (e.g. due to errors), but since there is no
    spontaneous responses without requests, requests remain a relevant metric
    of the overall activity. In TCP there are as many requests as connections.

  - response: this designates the traffic flowing from the server to the
    client, or sometimes from HAProxy to the client, when HAProxy produces the
    response itself (e.g. an HTTP redirect).

  - service: this generally indicates some internal processing in HAProxy that
    does not require a server, such as the stats page, the cache, or some Lua
    code to implement a small application. A service usually reads a request,
    performs some operations and produces a response.
</pre></div>
<a class="anchor" id="1.3" name="1.3"></a>
<h2 id="chapter-1.3" data-target="1.3"><small><a class="small" href="#1.3">1.3.</a></small> HTTP request</h2>
<div><pre class="text">First, let's consider this HTTP request :

  Line     Contents
  number
     1     GET /serv/login.php?lang=en&amp;profile=2 HTTP/1.1
     2     Host: www.mydomain.com
     3     User-agent: my small browser
     4     Accept: image/jpeg, image/gif
     5     Accept: image/png
</pre></div>
<a class="anchor" id="1.3.1" name="1.3.1"></a>
<h3 id="chapter-1.3.1" data-target="1.3.1"><small><a class="small" href="#1.3.1">1.3.1.</a></small> The Request line</h3>
<div><pre class="text">Line 1 is the &quot;request line&quot;. It is always composed of 3 fields :

  - a METHOD      : GET
  - a URI         : /serv/login.php?lang=en&amp;profile=2
  - a version tag : HTTP/1.1

All of them are delimited by what the standard calls LWS (linear white spaces),
which are commonly spaces, but can also be tabs or line feeds/carriage returns
followed by spaces/tabs. The method itself cannot contain any colon (':') and
is limited to alphabetic letters. All those various combinations make it
desirable that HAProxy performs the splitting itself rather than leaving it to
the user to write a complex or inaccurate regular expression.

The URI itself can have several forms :

  - A &quot;relative URI&quot; :

      /serv/login.php?lang=en&amp;profile=2

    It is a complete URL without the host part. This is generally what is
    received by servers, reverse proxies and transparent proxies.

  - An &quot;absolute URI&quot;, also called a &quot;URL&quot; :

      http://192.168.0.12:8080/serv/login.php?lang=en&amp;profile=2

    It is composed of a &quot;scheme&quot; (the protocol name followed by '://'), a host
    name or address, optionally a colon (':') followed by a port number, then
    a relative URI beginning at the first slash ('/') after the address part.
    This is generally what proxies receive, but a server supporting HTTP/1.1
    must accept this form too.

  - a star ('*') : this form is only accepted in association with the OPTIONS
    method and is not relayable. It is used to inquiry a next hop's
    capabilities.

  - an address:port combination : 192.168.0.12:80
    This is used with the CONNECT method, which is used to establish TCP
    tunnels through HTTP proxies, generally for HTTPS, but sometimes for
    other protocols too.

In a relative URI, two sub-parts are identified. The part before the question
mark is called the &quot;<a href="#path">path</a>&quot;. It is typically the relative path to static objects
on the server. The part after the question mark is called the &quot;query string&quot;.
It is mostly used with GET requests sent to dynamic scripts and is very
specific to the language, framework or application in use.

HTTP/2 and HTTP/3 do not convey a version information with the request, so the
version is assumed to be the same as the one of the underlying protocol (i.e.
&quot;HTTP/2&quot;). In addition, these protocols do not send a request line as one part,
but split it into individual fields called &quot;pseudo-headers&quot;, whose name start
with a colon, and which are conveniently reassembled by HAProxy into an
equivalent request line. For this reason, request lines found in logs may
slightly differ between HTTP/1.x and HTTP/2 or HTTP/3.
</pre></div>
<a class="anchor" id="1.3.2" name="1.3.2"></a>
<h3 id="chapter-1.3.2" data-target="1.3.2"><small><a class="small" href="#1.3.2">1.3.2.</a></small> The request headers</h3>
<div><pre class="text">The headers start at the second line. They are composed of a name at the
beginning of the line, immediately followed by a colon (':'). Traditionally,
an LWS is added after the colon but that's not required. Then come the values.
Multiple identical headers may be folded into one single line, delimiting the
values with commas, provided that their order is respected. This is commonly
encountered in the &quot;Cookie:&quot; field. A header may span over multiple lines if
the subsequent lines begin with an LWS. In the example in 1.3, lines 4 and 5
define a total of 3 values for the &quot;Accept:&quot; header. Finally, all LWS at the
beginning or at the end of a header are ignored and are not part of the value,
as per the specification.

Contrary to a common misconception, header names are not case-sensitive, and
their values are not either if they refer to other header names (such as the
&quot;Connection:&quot; header). In HTTP/2 and HTTP/3, header names are always sent in
lower case, as can be seen when running in debug mode. Internally, all header
names are normalized to lower case so that HTTP/1.x and HTTP/2 or HTTP/3 use
the exact same representation, and they are sent as-is on the other side. This
explains why an HTTP/1.x request typed with camel case is delivered in lower
case.

The end of the headers is indicated by the first empty line. People often say
that it's a double line feed, which is not exact, even if a double line feed
is one valid form of empty line.

Fortunately, HAProxy takes care of all these complex combinations when indexing
headers, checking values and counting them, so there is no reason to worry
about the way they could be written, but it is important not to accuse an
application of being buggy if it does unusual, valid things.

Important note:
   As suggested by RFC7231, HAProxy normalizes headers by replacing line breaks
   in the middle of headers by LWS in order to join multi-line headers. This
   is necessary for proper analysis and helps less capable HTTP parsers to work
   correctly and not to be fooled by such complex constructs.
</pre></div>
<a class="anchor" id="1.4" name="1.4"></a>
<h2 id="chapter-1.4" data-target="1.4"><small><a class="small" href="#1.4">1.4.</a></small> HTTP response</h2>
<div><pre class="text">An HTTP response looks very much like an HTTP request. Both are called HTTP
messages. Let's consider this HTTP response :

  Line     Contents
  number
     1     HTTP/1.1 200 OK
     2     Content-length: 350
     3     Content-Type: text/html

As a special case, HTTP supports so called &quot;Informational responses&quot; as status
codes 1xx. These messages are special in that they don't convey any part of the
response, they're just used as sort of a signaling message to ask a client to
continue to post its request for instance. In the case of a status 100 response
the requested information will be carried by the next non-100 response message
following the informational one. This implies that multiple responses may be
sent to a single request, and that this only works when keep-alive is enabled
(1xx messages appeared in HTTP/1.1). HAProxy handles these messages and is able
to correctly forward and skip them, and only process the next non-100 response.
As such, these messages are neither logged nor transformed, unless explicitly
state otherwise. Status 101 messages indicate that the protocol is changing
over the same connection and that HAProxy must switch to tunnel mode, just as
if a CONNECT had occurred. Then the Upgrade header would contain additional
information about the type of protocol the connection is switching to.
</pre></div>
<a class="anchor" id="1.4.1" name="1.4.1"></a>
<h3 id="chapter-1.4.1" data-target="1.4.1"><small><a class="small" href="#1.4.1">1.4.1.</a></small> The response line</h3>
<div><pre class="text">Line 1 is the &quot;response line&quot;. It is always composed of 3 fields :

  - a version tag : HTTP/1.1
  - a status code : 200
  - a reason      : OK

The status code is always 3-digit. The first digit indicates a general status :
 - 1xx = informational message to be skipped (e.g. 100, 101)
 - 2xx = OK, content is following   (e.g. 200, 206)
 - 3xx = OK, no content following   (e.g. 302, 304)
 - 4xx = error caused by the client (e.g. 401, 403, 404)
 - 5xx = error caused by the server (e.g. 500, 502, 503)

Status codes greater than 599 must not be emitted in communications, though
certain agents may produce them in logs to report their internal statuses.
Please refer to RFC9110 for the detailed meaning of all such codes. HTTP/2 and
above do not have a version tag and use the &quot;:status&quot; pseudo-header to report
the status code.

The &quot;reason&quot; field is just a hint, but is not parsed by clients. Anything can
be found there, but it's a common practice to respect the well-established
messages. It can be composed of one or multiple words, such as &quot;OK&quot;, &quot;Found&quot;,
or &quot;Authentication Required&quot;. It does not exist in HTTP/2 and above and is
not emitted there. When a response from HTTP/2 or above is transmitted to an
HTTP/1 client, HAProxy will produce such a common reason field that matches
the status code.

HAProxy may emit the following status codes by itself :

  Code  When / reason
   200  access to stats page, and when replying to monitoring requests
   301  when performing a redirection, depending on the configured code
   302  when performing a redirection, depending on the configured code
   303  when performing a redirection, depending on the configured code
   307  when performing a redirection, depending on the configured code
   308  when performing a redirection, depending on the configured code
   400  for an invalid or too large request
   401  when an authentication is required to perform the action (when
        accessing the stats page)
   403  when a request is forbidden by a &quot;http-request deny&quot; rule
   404  when the requested resource could not be found
   408  when the request timeout strikes before the request is complete
   410  when the requested resource is no longer available and will not
        be available again
   500  when HAProxy encounters an unrecoverable internal error, such as a
        memory allocation failure, which should never happen
   501 when HAProxy is unable to satisfy a client request because of an
       unsupported feature
   502  when the server returns an empty, invalid or incomplete response, or
        when an &quot;http-response deny&quot; rule blocks the response.
   503  when no server was available to handle the request, or in response to
        monitoring requests which match the &quot;<a href="#monitor%20fail">monitor fail</a>&quot; condition
   504  when the response timeout strikes before the server responds

The error 4xx and 5xx codes above may be customized (see &quot;<a href="#errorloc">errorloc</a>&quot; in section
4.2). Other status codes can be emitted on purpose by specific actions (see the
&quot;<a href="#deny">deny</a>&quot;, &quot;<a href="#return">return</a>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">redirect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#redirect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#redirect%20%28Alphabetically%20sorted%20actions%20reference%29">Alphabetically sorted actions reference</a></li></ul></span>&quot; actions in <a href="#4.3">section 4.3</a> for example).
</pre></div>
<a class="anchor" id="1.4.2" name="1.4.2"></a>
<h3 id="chapter-1.4.2" data-target="1.4.2"><small><a class="small" href="#1.4.2">1.4.2.</a></small> The response headers</h3>
<div><pre class="text">Response headers work exactly like request headers, and as such, HAProxy uses
the same parsing function for both. Please refer to paragraph 1.3.2 for more
details.
</pre></div>
<a class="anchor" id="2" name="2"></a>
<div class="page-header"><h1 id="chapter-2" data-target="2"><small><a class="small" href="#2">2.</a></small> Configuring HAProxy</h1>
</div><a class="anchor" id="2.1" name="2.1"></a>
<h2 id="chapter-2.1" data-target="2.1"><small><a class="small" href="#2.1">2.1.</a></small> Configuration file format</h2>
<div><pre class="text">HAProxy's configuration process involves 3 major sources of parameters :

  - the arguments from the command-line, which always take precedence
  - the configuration file(s), whose format is described here
  - the running process's environment, in case some environment variables are
    explicitly referenced

The configuration file follows a fairly simple hierarchical format which obey
a few basic rules:

  1. a configuration file is an ordered sequence of statements

  2. a statement is a single non-empty line before any unprotected &quot;#&quot; (hash)

  3. a line is a series of tokens or &quot;words&quot; delimited by unprotected spaces or
     tab characters

  4. the first word or sequence of words of a line is one of the keywords or
     keyword sequences listed in this document

  5. all other words are all arguments of the first one, some being well-known
     keywords listed in this document, others being values, references to other
     parts of the configuration, or expressions

  6. certain keywords delimit a section inside which only a subset of keywords
     are supported

  7. a section ends at the end of a file or on a special keyword starting a new
     section

This is all that is needed to know to write a simple but reliable configuration
generator, but this is not enough to reliably parse any configuration nor to
figure how to deal with certain corner cases.

First, there are a few consequences of the rules above. Rule 6 and 7 imply that
the keywords used to define a new section are valid everywhere and cannot have
a different meaning in a specific section. These keywords are always a single
word (as opposed to a sequence of words), and traditionally the section that
follows them is designated using the same name. For example when speaking about
the &quot;global section&quot;, it designates the section of configuration that follows
the &quot;global&quot; keyword. This usage is used a lot in error messages to help locate
the parts that need to be addressed.

A number of sections create an internal object or configuration space, which
requires to be distinguished from other ones. In this case they will take an
extra word which will set the name of this particular section. For some of them
the section name is mandatory. For example &quot;frontend foo&quot; will create a new
section of type &quot;frontend&quot; named &quot;foo&quot;. Usually a name is specific to its
section and two sections of different types may use the same name, but this is
not recommended as it tends to complexify configuration management.

A direct consequence of rule 7 is that when multiple files are read at once,
each of them must start with a new section, and the end of each file will end
a section. A file cannot contain sub-sections nor end an existing section and
start a new one.

Rule 1 mentioned that ordering matters. Indeed, some keywords create directives
that can be repeated multiple times to create ordered sequences of rules to be
applied in a certain order. For example &quot;<a href="#tcp-request">tcp-request</a>&quot; can be used to alternate
&quot;<a href="#accept">accept</a>&quot; and &quot;<a href="#reject">reject</a>&quot; rules on varying criteria. As such, a configuration file
processor must always preserve a section's ordering when editing a file. The
ordering of sections usually does not matter except for the global section
which must be placed before other sections, but it may be repeated if needed.
In addition, some automatic identifiers may automatically be assigned to some
of the created objects (e.g. proxies), and by reordering sections, their
identifiers will change. These ones appear in the statistics for example. As
such, the configuration below will assign &quot;foo&quot; ID number 1 and &quot;bar&quot; ID number
2, which will be swapped if the two sections are reversed:

     listen foo
         bind :80

     listen bar
         bind :81

Another important point is that according to rules 2 and 3 above, empty lines,
spaces, tabs, and comments following and unprotected &quot;#&quot; character are not part
of the configuration as they are just used as delimiters. This implies that the
following configurations are strictly equivalent:

         global#this is the global section
     daemon#daemonize
         frontend         foo
     mode             http   # or tcp

and:

     global
         daemon

     # this is the public web frontend
     frontend foo
         mode http

The common practice is to align to the left only the keyword that initiates a
new section, and indent (i.e. prepend a tab character or a few spaces) all
other keywords so that it's instantly visible that they belong to the same
section (as done in the second example above). Placing comments before a new
section helps the reader decide if it's the desired one. Leaving a blank line
at the end of a section also visually helps spotting the end when editing it.

Tabs are very convenient for indent but they do not copy-paste well. If spaces
are used instead, it is recommended to avoid placing too many (2 to 4) so that
editing in field doesn't become a burden with limited editors that do not
support automatic indent.

In the early days it used to be common to see arguments split at fixed tab
positions because most keywords would not take more than two arguments. With
modern versions featuring complex expressions this practice does not stand
anymore, and is not recommended.
</pre></div>
<a class="anchor" id="2.2" name="2.2"></a>
<h2 id="chapter-2.2" data-target="2.2"><small><a class="small" href="#2.2">2.2.</a></small> Quoting and escaping</h2>
<div><pre class="text">In modern configurations, some arguments require the use of some characters
that were previously considered as pure delimiters. In order to make this
possible, HAProxy supports character escaping by prepending a backslash ('\')
in front of the character to be escaped, weak quoting within double quotes
('&quot;') and strong quoting within single quotes (&quot;'&quot;).

This is pretty similar to what is done in a number of programming languages and
very close to what is commonly encountered in Bourne shell. The principle is
the following: while the configuration parser cuts the lines into words, it
also takes care of quotes and backslashes to decide whether a character is a
delimiter or is the raw representation of this character within the current
word. The escape character is then removed, the quotes are removed, and the
remaining word is used as-is as a keyword or argument for example.

If a backslash is needed in a word, it must either be escaped using itself
(i.e. double backslash) or be strongly quoted.

Escaping outside quotes is achieved by preceding a special character by a
backslash ('\'):

  \    to mark a space and differentiate it from a delimiter
  \#   to mark a hash and differentiate it from a comment
  \\   to use a backslash
  \'   to use a single quote and differentiate it from strong quoting
  \&quot;   to use a double quote and differentiate it from weak quoting

In addition, a few non-printable characters may be emitted using their usual
C-language representation:

  \n   to insert a line feed (LF, character \x0a or ASCII 10 decimal)
  \r   to insert a carriage return (CR, character \x0d or ASCII 13 decimal)
  \t   to insert a tab (character \x09 or ASCII 9 decimal)
  \xNN to insert character having ASCII code hex NN (e.g \x0a for LF).

Weak quoting is achieved by surrounding double quotes (&quot;&quot;) around the character
or sequence of characters to protect. Weak quoting prevents the interpretation
of:

       space or tab as a word separator
  '    single quote as a strong quoting delimiter
  #    hash as a comment start

Weak quoting permits the interpretation of environment variables (which are not
evaluated outside of quotes) by preceding them with a dollar sign ('$'). If a
dollar character is needed inside double quotes, it must be escaped using a
backslash.

Strong quoting is achieved by surrounding single quotes ('') around the
character or sequence of characters to protect. Inside single quotes, nothing
is interpreted, it's the efficient way to quote regular expressions.

As a result, here is the matrix indicating how special characters can be
entered in different contexts (unprintable characters are replaced with their
name within angle brackets). Note that some characters that may only be
represented escaped have no possible representation inside single quotes,
hence its absence there:
</pre><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>Character</th><th>Unquoted</th><th>Weakly quoted</th><th>Strongly quoted</th></tr></thead>
<tr><td >&lt;TAB&gt;</td><td >\&lt;TAB&gt;, \x09</td><td >&quot;&lt;TAB&gt;&quot;, &quot;\&lt;TAB&gt;&quot;, &quot;\x09&quot;</td><td >'&lt;TAB&gt;'</td></tr>
<tr><td >&lt;LF&gt;</td><td >\n, \x0a</td><td >&quot;\n&quot;, &quot;\x0a&quot;</td><td ></td></tr>
<tr><td >&lt;CR&gt;</td><td >\r, \x0d</td><td >&quot;\r&quot;, &quot;\x0d&quot;</td><td ></td></tr>
<tr><td >&lt;SPC&gt;</td><td >\&lt;SPC&gt;, \x20</td><td >&quot;&lt;SPC&gt;&quot;, &quot;\&lt;SPC&gt;&quot;, &quot;\x20&quot;</td><td >'&lt;SPC&gt;'</td></tr>
<tr><td >&quot;</td><td >\&quot;, \x22</td><td >&quot;\&quot;&quot;, &quot;\x22&quot;</td><td >'&quot;'</td></tr>
<tr><td >#</td><td >\#, \x23</td><td >&quot;#&quot;, &quot;\#&quot;, &quot;\x23&quot;</td><td >'#'</td></tr>
<tr><td >$</td><td >$, \$, \x24</td><td >&quot;\$&quot;, &quot;\x24&quot;</td><td >'$'</td></tr>
<tr><td >'</td><td >\', \x27</td><td >&quot;'&quot;, &quot;\'&quot;, &quot;\x27&quot;</td><td ></td></tr>
<tr><td >\</td><td >\\, \x5c</td><td >&quot;\\&quot;, &quot;\x5c&quot;</td><td >'\'</td></tr>
</table><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># those are all strictly equivalent:</span>
log-format %{+Q}o\ %t\ %s\ %{-Q}r
log-format &quot;%{+Q}o %t %s %{-Q}r&quot;
log-format '%{+Q}o %t %s %{-Q}r'
log-format &quot;%{+Q}o %t&quot;' %s %{-Q}r'
log-format &quot;%{+Q}o %t&quot;' %s'\ %{-Q}r
</code></pre>
</div><pre class="text">There is one particular case where a second level of quoting or escaping may be
necessary. Some keywords take arguments within parenthesis, sometimes delimited
by commas. These arguments are commonly integers or predefined words, but when
they are arbitrary strings, it may be required to perform a separate level of
escaping to disambiguate the characters that belong to the argument from the
characters that are used to delimit the arguments themselves. A pretty common
case is the &quot;<a href="#regsub">regsub</a>&quot; converter. It takes a regular expression in argument, and
if a closing parenthesis is needed inside, this one will require to have its
own quotes.

The keyword argument parser is exactly the same as the top-level one regarding
quotes, except that the \#, \$, and \xNN escapes are not processed. But what is
not always obvious is that the delimiters used inside must first be escaped or
quoted so that they are not resolved at the top level.

Let's take this example making use of the &quot;<a href="#regsub">regsub</a>&quot; converter which takes 3
arguments, one regular expression, one replacement string and one set of flags:

    # replace all occurrences of &quot;foo&quot; with &quot;blah&quot; in the path:
    http-request set-path %[path,regsub(foo,blah,g)]

Here no special quoting was necessary. But if now we want to replace either
&quot;foo&quot; or &quot;bar&quot; with &quot;blah&quot;, we'll need the regular expression &quot;(foo|bar)&quot;. We
cannot write:

    http-request set-path %[path,regsub((foo|bar),blah,g)]

because we would like the string to cut like this:

    http-request set-path %[path,regsub((foo|bar),blah,g)]
                                       |---------|----|-|
                                 arg1 _/         /    /
                                 arg2 __________/    /
                                 arg3 ______________/

but actually what is passed is a string between the opening and closing
parenthesis then garbage:

    http-request set-path %[path,regsub((foo|bar),blah,g)]
                                       |--------|--------|
                        arg1=(foo|bar _/        /
                    trailing garbage  _________/

The obvious solution here seems to be that the closing parenthesis needs to be
quoted, but alone this will not work, because as mentioned above, quotes are
processed by the top-level parser which will resolve them before processing
this word:

    http-request set-path %[path,regsub(&quot;(foo|bar)&quot;,blah,g)]
    ------------ -------- ----------------------------------
       word1       word2    word3=%[path,regsub((foo|bar),blah,g)]

So we didn't change anything for the argument parser at the second level which
still sees a truncated regular expression as the only argument, and garbage at
the end of the string. By escaping the quotes they will be passed unmodified to
the second level:

    http-request set-path %[path,regsub(\&quot;(foo|bar)\&quot;,blah,g)]
    ------------ -------- ------------------------------------
       word1       word2    word3=%[path,regsub(&quot;(foo|bar)&quot;,blah,g)]
                                                |---------||----|-|
                                arg1=(foo|bar) _/          /    /
                                    arg2=blah  ___________/    /
                                        arg3=g _______________/

Another approach consists in using single quotes outside the whole string and
double quotes inside (so that the double quotes are not stripped again):

    http-request set-path '%[path,regsub(&quot;(foo|bar)&quot;,blah,g)]'
    ------------ --------  ----------------------------------
       word1       word2    word3=%[path,regsub(&quot;(foo|bar)&quot;,blah,g)]
                                                |---------||----|-|
                                arg1=(foo|bar) _/          /    /
                                          arg2 ___________/    /
                                          arg3 _______________/

But in this case it's important to note that delimiters embedded into the
higher level string remain pure characters and are not delimiters anymore. It
particularly means that spaces and tabs around commas are part of the string.
The example below is wrong on multiple points:

    http-request set-path '%[path, regsub(&quot;(foo|bar)&quot;, blah, g)]'
    ------------ --------  --------------------------------------
       word1       word2    word3=%[path, regsub(&quot;(foo|bar)&quot;, blah, g)]
                                        |--------|---------||-----|--|
                       converter=&quot; regsub&quot; _/        /         /   /
                                    arg1=(foo|bar) _/         /   /
                                     arg2=&quot; blah&quot; ___________/   /
                                        arg3=&quot; g&quot; ______________/

The single fact of surrounding commas with spaces resulted in the spaces being
part of the field itself, hence the converter &quot; regsub&quot; (starting with a
space), which won't be found and will trigger an error, but more subtly, the
replacement string &quot; blah&quot; will insert a space in the output. A good rule of
thumb is to never insert unneeded spaces inside expressions.

When using regular expressions, it can happen that the dollar ('$') character
appears in the expression or that a backslash ('\') is used in the replacement
string. In this case these ones will also be processed inside the double quotes
thus single quotes are preferred (or double escaping). Example:

    http-request set-path '%[path,regsub(&quot;^/(here)(/|$)&quot;,&quot;my/\1&quot;,g)]'
    ------------ --------  -----------------------------------------
       word1       word2    word3=%[path,regsub(&quot;^/(here)(/|$)&quot;,&quot;my/\1&quot;,g)]
                                                |-------------| |-----||-|
                              arg1=(here)(/|$) _/               /      /
                                    arg2=my/\1 ________________/      /
                                          arg3 ______________________/

Remember that backslashes are not escape characters within single quotes and
that the whole word above is already protected against them using the single
quotes. Conversely, if double quotes had been used around the whole expression,
single the dollar character and the backslashes would have been resolved at top
level, breaking the argument contents at the second level.

Unfortunately, since single quotes can't be escaped inside of strong quoting,
if you need to include single quotes in your argument, you will need to escape
or quote them twice. There are a few ways to do this:

    http-request set-var(txn.foo) str(&quot;\\'foo\\'&quot;)
    http-request set-var(txn.foo) str(\&quot;\'foo\'\&quot;)
    http-request set-var(txn.foo) str(\\\'foo\\\')

When in doubt, simply do not use quotes anywhere, and start to place single or
double quotes around arguments that require a comma or a closing parenthesis,
and think about escaping these quotes using a backslash if the string contains
a dollar or a backslash. Again, this is pretty similar to what is used under
a Bourne shell when double-escaping a command passed to &quot;eval&quot;. For API writers
the best is probably to place escaped quotes around each and every argument,
regardless of their contents. Users will probably find that using single quotes
around the whole expression and double quotes around each argument provides
more readable configurations.
</pre></div>
<a class="anchor" id="2.3" name="2.3"></a>
<h2 id="chapter-2.3" data-target="2.3"><small><a class="small" href="#2.3">2.3.</a></small> Environment variables</h2>
<div><pre class="text">HAProxy's configuration supports environment variables. Those variables are
interpreted only within double quotes. Variables are expanded during the
configuration parsing. Variable names must be preceded by a dollar (&quot;$&quot;) and
optionally enclosed with braces (&quot;{}&quot;) similarly to what is done in Bourne
shell. Variable names can contain alphanumerical characters or the character
underscore (&quot;_&quot;) but should not start with a digit. If the variable contains a
list of several values separated by spaces, it can be expanded as individual
arguments by enclosing the variable with braces and appending the suffix '[*]'
before the closing brace. It is also possible to specify a default value to
use when the variable is not set, by appending that value after a dash '-'
next to the variable name. Note that the default value only replaces non
existing variables, not empty ones.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>bind &quot;fd@${FD_APP1}&quot;

log &quot;${LOCAL_SYSLOG-127.0.0.1}:514&quot; local0 notice  <span class="comment"># send to local server</span>

user &quot;$HAPROXY_USER&quot;
</code></pre>
</div><pre class="text">Some variables are defined by HAProxy, they can be used in the configuration
file, or could be inherited by a program (See 3.7. Programs). These variables
are listed in the matrix below, and they are classified among four categories:

  * usable: the variable is accessible from the configuration, either to be
    resolved as-is, or used within conditional blocks or predicates to enable
    or disable this some configuration fragments, as described in <a href="#2.4">section 2.4</a>
    &quot;Conditional blocks&quot;.

  * modifiable: the variable can be redefined or unset in the configuration via
    &quot;<a href="#setenv">setenv</a>&quot;/&quot;<a href="#unsetenv">unsetenv</a>&quot; keywords.

  * listed: the variable is listed in CLI's &quot;show env&quot; command output,
    described in <a href="#9.3">section 9.3</a> &quot;Unix Sockets commands&quot; of the management guide.

  * exported: variable is exported to launch programs in a modified environment
    (See <a href="#3.7">section 3.7</a> &quot;Programs&quot;). Note that this does not apply to external
    checks which have their own rules regarding exported variables.

There also two subcategories &quot;master&quot; and &quot;worker&quot;, respectively marked 'M' and
'W' in the table below, showing the differences between the two processes when
HAProxy is launched in master-worker mode.

  * master: the variable is set and accessible from the master process. So, it
    will appear in the master CLI's &quot;show env&quot; output and it can be used in
    conditional blocks or directives to enable some special settings for the
    master (see examples in <a href="#2.4">section 2.4</a> &quot;Conditional blocks&quot;).

  * worker: the variable is set and accessible from the worker process. It will
    appear in the worker CLI's &quot;show env&quot; (or the master CLI's &quot;@1 show env&quot;)
    and it may as well condition some worker process parameters (see examples
    from <a href="#2.4">section 2.4</a> &quot;Conditional blocks&quot;).

In standalone mode (without &quot;-W&quot; option nor the &quot;<a href="#master-worker">master-worker</a>&quot; keyword) the
process behaves like a worker, except for variables &quot;HAPROXY_MASTER_CLI&quot; and
&quot;HAPROXY_MWORKER&quot; which are not defined.

Some variables are marked as not usable and not modifiable:

  * HAPROXY_CFGFILES
  * HAPROXY_MWORKER
  * HAPROXY_CLI
  * HAPROXY_MASTER_CLI
  * HAPROXY_LOCALPEER

Their values are undefined during configuration parsing, they are set later
during the initialization. So, it's recommended not to use these variables
within conditional blocks and not to reference them in the global section's
&quot;<a href="#setenv">setenv</a>&quot;/&quot;<a href="#resetenv">resetenv</a>&quot;/&quot;<a href="#unsetenv">unsetenv</a>&quot; keywords.

The table below summaries the status of each variable for the different working
modes:

  +--------------------------+----------+---------+------------+-----------+
  |        variable          | exported | usable  | modifiable |  listed   |
  |                          |          +---------+------------+-----------+
  |                          |          |  M | W  |   M  |  W  |  M  |  W  |
  +--------------------------+----------+----+----+------+-----+-----+-----+
  | HAPROXY_STARTUP_VERSION  |    X     |  X | X  |      |     |  X  |  X  |
  | HAPROXY_BRANCH           |    X     |  X | X  |      |     |  X  |  X  |
  | HAPROXY_CFGFILES         |    X     |    |    |      |     |  X  |  X  |
  | HAPROXY_MWORKER          |    X     |    |    |      |     |  X  |  X  |
  | HAPROXY_CLI              |          |    |    |      |     |     |  X  |
  | HAPROXY_MASTER_CLI       |          |    |    |      |     |  X  |     |
  | HAPROXY_LOCALPEER        |          |    | X  |      |     |     |  X  |
  | HAPROXY_HTTP_LOG_FMT     |          |    | X  |      |  X  |     |     |
  | HAPROXY_HTTP_CLF_LOG_FMT |          |    | X  |      |  X  |     |     |
  | HAPROXY_HTTPS_LOG_FMT    |          |    | X  |      |  X  |     |     |
  | HAPROXY_TCP_LOG_FMT      |          |    | X  |      |  X  |     |     |
  +--------------------------+----------+----+----+------+-----+-----+-----+

The variables in question are the following:

  * HAPROXY_LOCALPEER: defined at the startup of the process which contains the
    name of the local peer. (See &quot;-L&quot; in the management guide.)

  * HAPROXY_CFGFILES: list of the configuration files loaded by HAProxy,
    separated by semicolons. Can be useful in the case you specified a
    directory.

  * HAPROXY_HTTP_LOG_FMT: contains the value of the default HTTP log format as
    defined in <a href="#8.2.3">section 8.2.3</a> &quot;HTTP log format&quot;. It can be used to override the
    default log format without having to copy the whole original definition.

  * HAPROXY_HTTP_CLF_LOG_FMT: contains the value of the default HTTP CLF log
    format as defined in <a href="#8.2.3">section 8.2.3</a> &quot;HTTP log format&quot;. It can be used to
    override the default log format without having to copy the whole original
    definition.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># Add the rule that gave the final verdict to the log</span>
log-format &quot;${HAPROXY_TCP_LOG_FMT} lr=last_rule_file:last_rule_line&quot;
</code></pre>
</div><pre class="text">  * HAPROXY_HTTPS_LOG_FMT: similar to HAPROXY_HTTP_LOG_FMT but for HTTPS log
    format as defined in <a href="#8.2.4">section 8.2.4</a> &quot;HTTPS log format&quot;.

  * HAPROXY_TCP_LOG_FMT: similar to HAPROXY_HTTP_LOG_FMT but for TCP log format
    as defined in <a href="#8.2.2">section 8.2.2</a> &quot;TCP log format&quot;.

  * HAPROXY_TCP_CLF_LOG_FMT: similar to HAPROXY_HTTP_CLF_LOG_FMT but for TCP
    CLF log format as defined in <a href="#8.2.2">section 8.2.2</a> &quot;TCP log format&quot;.

  * HAPROXY_MWORKER: In master-worker mode, this variable is set to 1.

  * HAPROXY_CLI: configured listeners addresses of the stats socket of every
    processe, these addresses are separated by semicolons.

  * HAPROXY_MASTER_CLI: In master-worker mode, listeners addresses of the master
    CLI, separated by semicolons.

  * HAPROXY_STARTUP_VERSION: contains the version used to start, in master-
    worker mode this is the version which was used to start the master, even
    after updating the binary and reloading.

  * HAPROXY_BRANCH: contains the HAProxy branch version (such as &quot;2.8&quot;). It
    does not contain the full version number. It can be useful in case of
    migration if resources (such as maps or certificates) are in a path
    containing the branch number.

In addition, some pseudo-variables are internally resolved and may be used as
regular variables. Pseudo-variables always start with a dot ('.'), and are the
only ones where the dot is permitted. The current list of pseudo-variables is:

  * .FILE: the name of the configuration file currently being parsed.

  * .LINE: the line number of the configuration file currently being parsed,
    starting at one.

  * .SECTION: the name of the section currently being parsed, or its type if
    the section doesn't have a name (e.g. &quot;global&quot;), or an empty string before
    the first section.

These variables are resolved at the location where they are parsed. For example
if a &quot;.LINE&quot; variable is used in a &quot;<a href="#log-format">log-format</a>&quot; directive located in a defaults
section, its line number will be resolved before parsing and compiling the
&quot;<a href="#log-format">log-format</a>&quot; directive, so this same line number will be reused by subsequent
proxies.

This way it is possible to emit information to help locate a rule in variables,
logs, error statuses, health checks, header values, or even to use line numbers
to name some config objects like servers for example.
</pre></div>
<a class="anchor" id="2.4" name="2.4"></a>
<h2 id="chapter-2.4" data-target="2.4"><small><a class="small" href="#2.4">2.4.</a></small> Conditional blocks</h2>
<div><pre class="text">It may sometimes be convenient to be able to conditionally enable or disable
some arbitrary parts of the configuration, for example to enable/disable SSL or
ciphers, enable or disable some pre-production listeners without modifying the
configuration, or adjust the configuration's syntax to support two distinct
versions of HAProxy during a migration.. HAProxy brings a set of nestable
preprocessor-like directives which allow to integrate or ignore some blocks of
text. These directives must be placed on their own line and they act on the
lines that follow them. Two of them support an expression, the other ones only
switch to an alternate block or end a current level. The 4 following directives
are defined to form conditional blocks:

  - .if &lt;condition&gt;
  - .elif &lt;condition&gt;
  - .else
  - .endif

The &quot;.if&quot; directive nests a new level, &quot;.elif&quot; stays at the same level, &quot;.else&quot;
as well, and &quot;.endif&quot; closes a level. Each &quot;.if&quot; must be terminated by a
matching &quot;.endif&quot;. The &quot;.elif&quot; may only be placed after &quot;.if&quot; or &quot;.elif&quot;, and
there is no limit to the number of &quot;.elif&quot; that may be chained. There may be
only one &quot;.else&quot; per &quot;.if&quot; and it must always be after the &quot;.if&quot; or the last
&quot;.elif&quot; of a block.

Comments may be placed on the same line if needed after a '#', they will be
ignored. The directives are tokenized like other configuration directives, and
as such it is possible to use environment variables in conditions.

Conditions can also be evaluated on startup with the -cc parameter.
See &quot;3. Starting HAProxy&quot; in the management doc.

The conditions are either an empty string (which then returns false), or an
expression made of any combination of:

  - the integer zero ('0'), always returns &quot;false&quot;
  - a non-nul integer (e.g. '1'), always returns &quot;true&quot;.
  - a predicate optionally followed by argument(s) in parenthesis.
  - a condition placed between a pair of parenthesis '(' and ')'
  - an exclamation mark ('!') preceding any of the non-empty elements above,
    and which will negate its status.
  - expressions combined with a logical AND ('&amp;&amp;'), which will be evaluated
    from left to right until one returns false
  - expressions combined with a logical OR ('||'), which will be evaluated
    from right to left until one returns true

The same line tokenizer and argument parser are used as for the rest of the
configuration language. Words are split around consecutive series of one or
more unquoted spaces or tabs, and are reassembled together using a single space
to delimit them before evaluation, in order to save the user from having to
quote the entire line. But this also means that spaces surrounding commas or
parenthesis are definitely part of the value, which is not always expected.
For example, the expression below:

   .if defined( HAPROXY_MWORKER )

will test for the existence of variable &quot; HAPROXY_MWORKER &quot; (with spaces),
and this one:

   .if streq(&quot;$ENABLE_SSL&quot;,     1)

will compare the environment variable &quot;ENABLE_SSL&quot; to the value &quot; 1&quot; (with a
single leading space). The reason is the line is first split into words like
this:

   .if streq(&quot;$ENABLE_SSL&quot;,     1)
  |---|--------------------|   |--|
    1           2               3

then the weak quoting is applied and environment variable &quot;$ENABLE_SSL&quot; is
resolved (let's say for example that ENABLE_SSL=0), and finally the words are
reassembled into a single string by placing a single space between the words:

   .if streq(0, 1)
  |---|-------|--|
    1     2     3

and only then it is parsed as a single expression. The space that was inserted
between the comma and &quot;1&quot; is still part of the argument value, making this
argument &quot; 1&quot;:

   .if streq(0, 1)
  |---|-----|-|--|
    \    \    \  \_ argument2: &quot; 1&quot;
     \    \    \___ argument1: &quot;0&quot;
      \    \_______ function: &quot;streq&quot;
       \___________ directive: &quot;.if&quot;

It's visible here that even if ENABLE_SSL had been equal to &quot;1&quot;, it wouldn't
have matched &quot; 1&quot; since the string would differ by one space.

Note: as explained in section &quot;2.2. Quoting and escaping&quot;, a good rule of thumb
      is to never insert unneeded spaces inside expressions.

Note that like in other languages, the AND operator has precedence over the OR
operator, so that &quot;A &amp;&amp; B || C &amp;&amp; D&quot; evalues as &quot;(A &amp;&amp; B) || (C &amp;&amp; D)&quot;.

The list of currently supported predicates is the following:

  - defined(&lt;name&gt;)       : returns true if an environment variable &lt;name&gt;
                            exists, regardless of its contents

  - feature(&lt;name&gt;)       : returns true if feature &lt;name&gt; is listed as present
                            in the features list reported by &quot;haproxy -vv&quot;
                            (which means a &lt;name&gt; appears after a '+')

  - streq(&lt;str1&gt;,&lt;str2&gt;)  : returns true only if the two strings are equal
  - strneq(&lt;str1&gt;,&lt;str2&gt;) : returns true only if the two strings differ
  - strstr(&lt;str1&gt;,&lt;str2&gt;) : returns true only if the second string is found in
                            the first one.

  - version_atleast(&lt;ver&gt;): returns true if the current haproxy version is
                            at least as recent as &lt;ver&gt; otherwise false. The
                            version syntax is the same as shown by &quot;haproxy -v&quot;
                            and missing components are assumed as being zero.

  - version_before(&lt;ver&gt;) : returns true if the current haproxy version is
                            strictly older than &lt;ver&gt; otherwise false. The
                            version syntax is the same as shown by &quot;haproxy -v&quot;
                            and missing components are assumed as being zero.

  - enabled(&lt;opt&gt;)        : returns true if the option &lt;opt&gt; is enabled at
                            run-time. Only a subset of options are supported:
                                POLL, EPOLL, KQUEUE, EVPORTS, SPLICE,
                                GETADDRINFO, REUSEPORT, FAST-FORWARD,
                                SERVER-SSL-VERIFY-NONE
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># 1. HAPROXY_MWORKER variable is set automatically by HAProxy in master and</span>
<span class="comment"># in worker process environments (see HAProxy variables matrix from</span>
<span class="comment"># 2.3. Environment variables). Its presence enables an additional listener.</span>

global
  master-worker

.if defined(HAPROXY_MWORKER)
    listen mwcli_px
       bind :1111
       ...
.endif

<span class="comment"># 2. HAPROXY_BRANCH is set automatically by HAProxy in master and in worker</span>
<span class="comment"># process environments (see HAProxy variables matrix from 2.3. Environment</span>
<span class="comment"># variables). We check HAPROXY_BRANCH value and conditionally enable</span>
<span class="comment"># mworker-max-reloads parameter.</span>

global
  master-worker

.if streq(&quot;$HAPROXY_BRANCH&quot;,3.1)
     mworker-max-reloads 5
.endif

<span class="comment"># 3. Some arbitrary environment variables are set by user in the global</span>
<span class="comment"># section. If HAProxy is started in master-worker mode, they are presented in</span>
<span class="comment"># master and in worker process environments. We check values of these</span>
<span class="comment"># variables and conditionally enable ports 80 and 443. Environment variables</span>
<span class="comment"># checks can be mixed with features and version checks.</span>

global
  setenv WITH_SSL yes
  unsetenv SSL_ONLY

.if strneq(&quot;$SSL_ONLY&quot;,yes)
       bind :80
.endif

.if streq(&quot;$WITH_SSL&quot;,yes)
  .if feature(OPENSSL)
       bind :443 ssl crt ...
  .endif
.endif

.if feature(OPENSSL) &amp;&amp; (streq(&quot;$WITH_SSL&quot;,yes) || streq(&quot;$SSL_ONLY&quot;,yes))
       bind :443 ssl crt ...
.endif

.if version_atleast(2.4-dev19)
    profiling.memory on
.endif

.if !feature(OPENSSL)
    .alert &quot;SSL support is mandatory&quot;
.endif
</code></pre>
</div><pre class="text">Four other directives are provided to report some status:

  - .diag &quot;message&quot;    : emit this message only when in diagnostic mode (-dD)
  - .notice &quot;message&quot;  : emit this message at level NOTICE
  - .warning &quot;message&quot; : emit this message at level WARNING
  - .alert &quot;message&quot;   : emit this message at level ALERT

Messages emitted at level WARNING may cause the process to fail to start if the
&quot;<a href="#strict-mode">strict-mode</a>&quot; is enabled. Messages emitted at level ALERT will always cause a
fatal error. These can be used to detect some inappropriate conditions and
provide advice to the user.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>.if &quot;${A}&quot;
  .if &quot;${B}&quot;
     .notice &quot;A=1, B=1&quot;
  .elif &quot;${C}&quot;
     .notice &quot;A=1, B=0, C=1&quot;
  .elif &quot;${D}&quot;
     .warning &quot;A=1, B=0, C=0, D=1&quot;
  .else
     .alert &quot;A=1, B=0, C=0, D=0&quot;
  .endif
.else
     .notice &quot;A=0&quot;
.endif

.diag &quot;WTA/2021-05-07: replace 'redirect' with 'return' after switch to 2.4&quot;
      http-request redirect location /goaway if ABUSE
</code></pre>
</div></div>
<a class="anchor" id="2.5" name="2.5"></a>
<h2 id="chapter-2.5" data-target="2.5"><small><a class="small" href="#2.5">2.5.</a></small> Time format</h2>
<div><pre class="text">Some parameters involve values representing time, such as timeouts. These
values are generally expressed in milliseconds (unless explicitly stated
otherwise) but may be expressed in any other unit by suffixing the unit to the
numeric value. It is important to consider this because it will not be repeated
for every keyword. Supported units are :

  - us : microseconds. 1 microsecond = 1/1000000 second
  - ms : milliseconds. 1 millisecond = 1/1000 second. This is the default.
  - s  : seconds. 1s = 1000ms
  - m  : minutes. 1m = 60s = 60000ms
  - h  : hours.   1h = 60m = 3600s = 3600000ms
  - d  : days.    1d = 24h = 1440m = 86400s = 86400000ms
</pre></div>
<a class="anchor" id="2.6" name="2.6"></a>
<h2 id="chapter-2.6" data-target="2.6"><small><a class="small" href="#2.6">2.6.</a></small> Size format</h2>
<div><pre class="text">Some parameters involve values representing size, such as bandwidth limits.
These values are generally expressed in bytes (unless explicitly stated
otherwise) but may be expressed in any other unit by suffixing the unit to the
numeric value. It is important to consider this because it will not be repeated
for every keyword. Supported units are case insensitive :

  - k : kilobytes. 1 kilobyte = 1024 bytes
  - m : megabytes. 1 megabyte = 1048576 bytes
  - g : gigabytes. 1 gigabyte = 1073741824 bytes

Both time and size formats require integers, decimal notation is not allowed.
</pre></div>
<a class="anchor" id="2.7" name="2.7"></a>
<h2 id="chapter-2.7" data-target="2.7"><small><a class="small" href="#2.7">2.7.</a></small> Name format for maps and ACLs</h2>
<div><pre class="text">It is possible to use a list of pattern for maps or ACLs. A list of pattern is
identified by its name and may be used at different places in the
configuration. List of pattern are split on three categories depending on
the name format:

  * Lists of pattern based on regular files: It is the default case. The
    filename, absolute or relative, is used as name. The file must exist
    otherwise an error is triggered. But it may be empty. The &quot;file@&quot; prefix
    may also be specified but it is not part of the name identifying the
    list. A filename, with or without the prefix, references the same list of
    pattern.

  * Lists of pattern based on optional files: The filename must be preceded by
    &quot;opt@&quot; prefix. The file existence is optional. If the file exists, its
    content is loaded but no error is reported if not. The prefix is not part
    of the name identifying the list. It means, for a given filename, Optional
    files and regular files reference the same list of pattern.

  * Lists of pattern based on virtual files: The name is just an identified. It
    is not a reference to any file. &quot;virt@&quot; prefix must be used. It is part of
    the name. Thus it cannot be mixed with other kind of lists.

Virtual files are useful when patterns are fully dynamically managed with no
patterns on startup and on reload. Optional files may be used under the same
conditions. But patterns can be dumped in the file, via an external script based
on the &quot;show map&quot; CLI command for instance. This way, it is possible to keep
patterns on reload.

Note: Even if it is unlikely, it means no regular file starting with &quot;file@&quot;,
      &quot;opt@&quot; or &quot;virt@&quot; can be loaded, except by adding &quot;./&quot; explicitly in
      front of the filename (for instance &quot;file@./virt@map&quot;).
</pre></div>
<a class="anchor" id="2.8" name="2.8"></a>
<h2 id="chapter-2.8" data-target="2.8"><small><a class="small" href="#2.8">2.8.</a></small> Variables</h2>
<div><pre class="text">In HAProxy configuration, variables can be used in sample fetch functions,
converters, log-format strings or TCP/HTTP actions. Process-wide variables can
be defined, globally accessible for the whole life of the process. Some others
have a shorter lifespan. Variables are similar to those found in shell
scripts. It is a symbolic name for a chunk of memory. The variables size is not
limited and is dynamically allocated. So they must be used with caution,
especially for an intensive usage. However, it is possible to limit the maximum
amount of memory used by the variables by setting &quot;tune.vars&quot; global parameters.

Variables must be designated using the format &quot;&lt;scope&gt;.&lt;name&gt;&quot;. The &lt;scope&gt; is
a single word indicating the life time of the variable. The &lt;name&gt; part, inside
a scope, may only contain characters 'a-z', 'A-Z', '0-9' and '_'. It is unique
in this scope but the same name in different scopes can be used and refers to
different variables. Supported scopes are:

  * proc  : for variables known during the whole process lifespan and globally
            accessible. &quot;<a href="#proc">proc</a>&quot; variables can be manipulated from the CLI using
            &quot;get var&quot; and &quot;set var&quot; commands. They can also be set from
            &quot;global&quot; sections via &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">set-var<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#set-var%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#set-var%20%28Alphabetically%20sorted%20actions%20reference%29">Alphabetically sorted actions reference</a></li><li><a href="#set-var%20%28Converters%29">Converters</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">set-var-fmt<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#set-var-fmt%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#set-var-fmt%20%28Alphabetically%20sorted%20actions%20reference%29">Alphabetically sorted actions reference</a></li></ul></span>&quot; directives.

  * sess  : for variables known during the whole lifespan of a session. &quot;sess&quot;
            variables are private to a session, not visbile from outside it and
            not shared with other sessions.

  * txn   : for variables known during the whole lifespan of a transaction. &quot;txn&quot;
            variables are private to a stream, not visible from outside it and
            not shared with other streams.

  * req   : for variables known during the request processing for a specific
            stream. &quot;req&quot; variables are visible from the stream creation and
            until the first server connection attempt. They are private to a
            stream, not visible from outside it and not shared with other
            streams. There is no overlap at all between &quot;req&quot; and &quot;res&quot;
            variables.

  * res   : for variables known during the response processing for a specific
            stream. &quot;res&quot; variables are visible from the first server
            connection attempt and until the stream destruction. They are
            private to a stream, not visible from outside it and not shared
            with other streams. There is no overlap at all between &quot;req&quot; and
            &quot;res&quot; variables.

  * check : for variables known during a health-check execution. &quot;<a href="#check">check</a>&quot;
            variables are private to a health-check, not visible from outside
            it and are not shared with other health-checks. They can be set
            using dedicated &quot;<a href="#option%20tcp-check">tcp-check</a>&quot; or &quot;<a href="#http-check">http-check</a>&quot; directives.

Depending on the context, extra scopes referencing the parent of a current
stream can be used:

  * psess : same as &quot;sess&quot; but using the session of the parent stream, if any.

  * ptxn  : same as &quot;txn&quot; but using the transaction of the parent stream, if
            any.

  * preq  : same as &quot;req&quot; but using the parent stream, if any. &quot;preq&quot;
            variables are only accessible during request processing of the
            parent stream.

  * pres  : same as &quot;res&quot; but using the parent stream, if any. &quot;pres&quot;
            variables are only accessible during response processing of the
            parent stream.

Scopes referencing the parent stream are usable from the moment it is defined.
Most of time, there is no parent stream. But, if applicable, this will be
explicitly specified. For now, it is only possible to retrieve the value of
variables defined in a scope of the parent stream. It is not possible to set
nor unset such variables. Usually a child stream performs some processing for
the parent at a precise moment and prevents it from making progress until the
operation it does is completed. This means that the parent may be stopped in
the middle of a request processing or a response processing for example. As
such, certain scopes will not be available from the child stream. For example
if a request is subject to some analysis performed by a child stream, this
child stream will not find any variable in the &quot;pres&quot; scope since the parent is
not processing a response, hence doesn't have any variables in its &quot;res&quot; scope.

The content of a variable is the result of the evaluation of a sample fetch
expression and it inherits of the output type of this expression. It is
important when the variable is used because its type must be compatible with
its usage. For instance a variable containing a string used in &quot;add()&quot;
converter must be convertible to a valid integer to succeed. It is especially
true when variables are compared to static value. The right matching method
must be used.
</pre></div>
<a class="anchor" id="2.9" name="2.9"></a>
<h2 id="chapter-2.9" data-target="2.9"><small><a class="small" href="#2.9">2.9.</a></small> Examples</h2>
<div><pre class="text">    # Simple configuration for an HTTP proxy listening on port 80 on all
    # interfaces and forwarding requests to a single backend &quot;servers&quot; with a
    # single server &quot;server1&quot; listening on 127.0.0.1:8000
    global
        daemon
        maxconn 256

    defaults
        mode http
        timeout connect 5000ms
        timeout client 50000ms
        timeout server 50000ms

    frontend http-in
        bind *:80
        default_backend servers

    backend servers
        server server1 127.0.0.1:8000 maxconn 32


    # The same configuration defined with a single listen block. Shorter but
    # less expressive, especially in HTTP mode.
    global
        daemon
        maxconn 256

    defaults
        mode http
        timeout connect 5000ms
        timeout client 50000ms
        timeout server 50000ms

    listen http-in
        bind *:80
        server server1 127.0.0.1:8000 maxconn 32


Assuming haproxy is in $PATH, test these configurations in a shell with:

    $ sudo haproxy -f configuration.conf -c
</pre></div>
<a class="anchor" id="3" name="3"></a>
<div class="page-header"><h1 id="chapter-3" data-target="3"><small><a class="small" href="#3">3.</a></small> Global parameters</h1>
</div><div><pre class="text">Parameters in the &quot;global&quot; section are process-wide and often OS-specific. They
are generally set once for all and do not need being changed once correct. Some
of them have command-line equivalents.

The following keywords are supported in the &quot;global&quot; section :

 * Process management and security
   - <a href="#51degrees-allow-unmatched">51degrees-allow-unmatched</a>
   - <a href="#51degrees-cache-size">51degrees-cache-size</a>
   - <a href="#51degrees-data-file">51degrees-data-file</a>
   - <a href="#51degrees-difference">51degrees-difference</a>
   - <a href="#51degrees-drift">51degrees-drift</a>
   - <a href="#51degrees-property-name-list">51degrees-property-name-list</a>
   - <a href="#51degrees-property-separator">51degrees-property-separator</a>
   - <a href="#51degrees-use-performance-graph">51degrees-use-performance-graph</a>
   - <a href="#51degrees-use-predictive-graph">51degrees-use-predictive-graph</a>
   - <a href="#ca-base">ca-base</a>
   - <a href="#chroot">chroot</a>
   - <a href="#cluster-secret">cluster-secret</a>
   - <a href="#cpu-map">cpu-map</a>
   - <a href="#crt-base">crt-base</a>
   - <a href="#daemon">daemon</a>
   - <a href="#default-path">default-path</a>
   - <a href="#description">description</a>
   - <a href="#deviceatlas-json-file">deviceatlas-json-file</a>
   - <a href="#deviceatlas-log-level">deviceatlas-log-level</a>
   - <a href="#deviceatlas-properties-cookie">deviceatlas-properties-cookie</a>
   - <a href="#deviceatlas-separator">deviceatlas-separator</a>
   - <a href="#expose-deprecated-directives">expose-deprecated-directives</a>
   - <a href="#expose-experimental-directives">expose-experimental-directives</a>
   - <a href="#external-check">external-check</a>
   - <a href="#fd-hard-limit">fd-hard-limit</a>
   - <a href="#gid">gid</a>
   - <a href="#grace">grace</a>
   - <a href="#group">group</a>
   - <a href="#h1-accept-payload-with-any-method">h1-accept-payload-with-any-method</a>
   - <a href="#h1-case-adjust">h1-case-adjust</a>
   - <a href="#h1-case-adjust-file">h1-case-adjust-file</a>
   - <a href="#h1-do-not-close-on-insecure-transfer-encoding">h1-do-not-close-on-insecure-transfer-encoding</a>
   - <a href="#h2-workaround-bogus-websocket-clients">h2-workaround-bogus-websocket-clients</a>
   - <a href="#hard-stop-after">hard-stop-after</a>
   - <a href="#harden.reject-privileged-ports.tcp">harden.reject-privileged-ports.tcp</a>
   - <a href="#harden.reject-privileged-ports.quic">harden.reject-privileged-ports.quic</a>
   - <a href="#insecure-fork-wanted">insecure-fork-wanted</a>
   - <a href="#insecure-setuid-wanted">insecure-setuid-wanted</a>
   - <a href="#issuers-chain-path">issuers-chain-path</a>
   - <a href="#key-base">key-base</a>
   - <a href="#localpeer">localpeer</a>
   - <a href="#log">log</a>
   - <a href="#log-send-hostname">log-send-hostname</a>
   - <a href="#log-tag">log-tag</a>
   - <a href="#lua-load">lua-load</a>
   - <a href="#lua-load-per-thread">lua-load-per-thread</a>
   - <a href="#lua-prepend-path">lua-prepend-path</a>
   - <a href="#mworker-max-reloads">mworker-max-reloads</a>
   - <a href="#nbthread">nbthread</a>
   - <a href="#node">node</a>
   - <a href="#numa-cpu-mapping">numa-cpu-mapping</a>
   - <a href="#ocsp-update.disable">ocsp-update.disable</a>
   - <a href="#ocsp-update.maxdelay">ocsp-update.maxdelay</a>
   - <a href="#ocsp-update.mindelay">ocsp-update.mindelay</a>
   - <a href="#ocsp-update.httpproxy">ocsp-update.httpproxy</a>
   - <a href="#ocsp-update.mode">ocsp-update.mode</a>
   - <a href="#pidfile">pidfile</a>
   - <a href="#pp2-never-send-local">pp2-never-send-local</a>
   - <a href="#presetenv">presetenv</a>
   - <a href="#prealloc-fd">prealloc-fd</a>
   - <a href="#resetenv">resetenv</a>
   - <a href="#set-dumpable">set-dumpable</a>
   - <a href="#set-var">set-var</a>
   - <a href="#setenv">setenv</a>
   - <a href="#ssl-default-bind-ciphers">ssl-default-bind-ciphers</a>
   - <a href="#ssl-default-bind-ciphersuites">ssl-default-bind-ciphersuites</a>
   - <a href="#ssl-default-bind-client-sigalgs">ssl-default-bind-client-sigalgs</a>
   - <a href="#ssl-default-bind-curves">ssl-default-bind-curves</a>
   - <a href="#ssl-default-bind-options">ssl-default-bind-options</a>
   - <a href="#ssl-default-bind-sigalgs">ssl-default-bind-sigalgs</a>
   - <a href="#ssl-default-server-ciphers">ssl-default-server-ciphers</a>
   - <a href="#ssl-default-server-ciphersuites">ssl-default-server-ciphersuites</a>
   - <a href="#ssl-default-server-client-sigalgs">ssl-default-server-client-sigalgs</a>
   - <a href="#ssl-default-server-curves">ssl-default-server-curves</a>
   - <a href="#ssl-default-server-options">ssl-default-server-options</a>
   - <a href="#ssl-default-server-sigalgs">ssl-default-server-sigalgs</a>
   - <a href="#ssl-dh-param-file">ssl-dh-param-file</a>
   - <a href="#ssl-propquery">ssl-propquery</a>
   - <a href="#ssl-provider">ssl-provider</a>
   - <a href="#ssl-provider-path">ssl-provider-path</a>
   - <a href="#ssl-security-level">ssl-security-level</a>
   - <a href="#ssl-server-verify">ssl-server-verify</a>
   - <a href="#ssl-skip-self-issued-ca">ssl-skip-self-issued-ca</a>
   - <a href="#stats">stats</a>
   - <a href="#stats-file">stats-file</a>
   - <a href="#strict-limits">strict-limits</a>
   - <a href="#uid">uid</a>
   - <a href="#ulimit-n">ulimit-n</a>
   - <a href="#unix-bind">unix-bind</a>
   - <a href="#unsetenv">unsetenv</a>
   - <a href="#user">user</a>
   - <a href="#wurfl-cache-size">wurfl-cache-size</a>
   - <a href="#wurfl-data-file">wurfl-data-file</a>
   - <a href="#wurfl-information-list">wurfl-information-list</a>
   - <a href="#wurfl-information-list-separator">wurfl-information-list-separator</a>

 * Performance tuning
   - <a href="#busy-polling">busy-polling</a>
   - <a href="#max-spread-checks">max-spread-checks</a>
   - <a href="#maxcompcpuusage">maxcompcpuusage</a>
   - <a href="#maxcomprate">maxcomprate</a>
   - <a href="#maxconn">maxconn</a>
   - <a href="#maxconnrate">maxconnrate</a>
   - <a href="#maxpipes">maxpipes</a>
   - <a href="#maxsessrate">maxsessrate</a>
   - <a href="#maxsslconn">maxsslconn</a>
   - <a href="#maxsslrate">maxsslrate</a>
   - <a href="#maxzlibmem">maxzlibmem</a>
   - <a href="#no-memory-trimming">no-memory-trimming</a>
   - <a href="#noepoll">noepoll</a>
   - <a href="#noevports">noevports</a>
   - <a href="#nogetaddrinfo">nogetaddrinfo</a>
   - <a href="#nokqueue">nokqueue</a>
   - <a href="#nopoll">nopoll</a>
   - <a href="#noreuseport">noreuseport</a>
   - <a href="#nosplice">nosplice</a>
   - <a href="#profiling.tasks">profiling.tasks</a>
   - <a href="#server-state-base">server-state-base</a>
   - <a href="#server-state-file">server-state-file</a>
   - <a href="#spread-checks">spread-checks</a>
   - <a href="#ssl-engine">ssl-engine</a>
   - <a href="#ssl-mode-async">ssl-mode-async</a>
   - <a href="#tune.applet.zero-copy-forwarding">tune.applet.zero-copy-forwarding</a>
   - <a href="#tune.buffers.limit">tune.buffers.limit</a>
   - <a href="#tune.buffers.reserve">tune.buffers.reserve</a>
   - <a href="#tune.bufsize">tune.bufsize</a>
   - <a href="#tune.bufsize.small">tune.bufsize.small</a>
   - <a href="#tune.comp.maxlevel">tune.comp.maxlevel</a>
   - <a href="#tune.disable-fast-forward">tune.disable-fast-forward</a>
   - <a href="#tune.disable-zero-copy-forwarding">tune.disable-zero-copy-forwarding</a>
   - <a href="#tune.events.max-events-at-once">tune.events.max-events-at-once</a>
   - <a href="#tune.fail-alloc">tune.fail-alloc</a>
   - <a href="#tune.fd.edge-triggered">tune.fd.edge-triggered</a>
   - <a href="#tune.h1.zero-copy-fwd-recv">tune.h1.zero-copy-fwd-recv</a>
   - <a href="#tune.h1.zero-copy-fwd-send">tune.h1.zero-copy-fwd-send</a>
   - <a href="#tune.h2.be.glitches-threshold">tune.h2.be.glitches-threshold</a>
   - <a href="#tune.h2.be.initial-window-size">tune.h2.be.initial-window-size</a>
   - <a href="#tune.h2.be.max-concurrent-streams">tune.h2.be.max-concurrent-streams</a>
   - <a href="#tune.h2.be.rxbuf">tune.h2.be.rxbuf</a>
   - <a href="#tune.h2.fe.glitches-threshold">tune.h2.fe.glitches-threshold</a>
   - <a href="#tune.h2.fe.initial-window-size">tune.h2.fe.initial-window-size</a>
   - <a href="#tune.h2.fe.max-concurrent-streams">tune.h2.fe.max-concurrent-streams</a>
   - <a href="#tune.h2.fe.max-total-streams">tune.h2.fe.max-total-streams</a>
   - <a href="#tune.h2.fe.rxbuf">tune.h2.fe.rxbuf</a>
   - <a href="#tune.h2.header-table-size">tune.h2.header-table-size</a>
   - <a href="#tune.h2.initial-window-size">tune.h2.initial-window-size</a>
   - <a href="#tune.h2.max-concurrent-streams">tune.h2.max-concurrent-streams</a>
   - <a href="#tune.h2.max-frame-size">tune.h2.max-frame-size</a>
   - <a href="#tune.h2.zero-copy-fwd-send">tune.h2.zero-copy-fwd-send</a>
   - <a href="#tune.http.cookielen">tune.http.cookielen</a>
   - <a href="#tune.http.logurilen">tune.http.logurilen</a>
   - <a href="#tune.http.maxhdr">tune.http.maxhdr</a>
   - <a href="#tune.idle-pool.shared">tune.idle-pool.shared</a>
   - <a href="#tune.idletimer">tune.idletimer</a>
   - <a href="#tune.lua.forced-yield">tune.lua.forced-yield</a>
   - <a href="#tune.lua.maxmem">tune.lua.maxmem</a>
   - <a href="#tune.lua.service-timeout">tune.lua.service-timeout</a>
   - <a href="#tune.lua.session-timeout">tune.lua.session-timeout</a>
   - <a href="#tune.lua.task-timeout">tune.lua.task-timeout</a>
   - <a href="#tune.lua.log.loggers">tune.lua.log.loggers</a>
   - <a href="#tune.lua.log.stderr">tune.lua.log.stderr</a>
   - <a href="#tune.max-checks-per-thread">tune.max-checks-per-thread</a>
   - <a href="#tune.maxaccept">tune.maxaccept</a>
   - <a href="#tune.maxpollevents">tune.maxpollevents</a>
   - <a href="#tune.maxrewrite">tune.maxrewrite</a>
   - <a href="#tune.memory.hot-size">tune.memory.hot-size</a>
   - <a href="#tune.pattern.cache-size">tune.pattern.cache-size</a>
   - <a href="#tune.peers.max-updates-at-once">tune.peers.max-updates-at-once</a>
   - <a href="#tune.pipesize">tune.pipesize</a>
   - <a href="#tune.pool-high-fd-ratio">tune.pool-high-fd-ratio</a>
   - <a href="#tune.pool-low-fd-ratio">tune.pool-low-fd-ratio</a>
   - <a href="#tune.pt.zero-copy-forwarding">tune.pt.zero-copy-forwarding</a>
   - <a href="#tune.quic.cc-hystart">tune.quic.cc-hystart</a>
   - <a href="#tune.quic.disable-udp-gso">tune.quic.disable-udp-gso</a>
   - <a href="#tune.quic.frontend.glitches-threshold">tune.quic.frontend.glitches-threshold</a>
   - <a href="#tune.quic.frontend.max-idle-timeout">tune.quic.frontend.max-idle-timeout</a>
   - <a href="#tune.quic.frontend.max-streams-bidi">tune.quic.frontend.max-streams-bidi</a>
   - <a href="#tune.quic.frontend.default-max-window-size">tune.quic.frontend.default-max-window-size</a>
   - <a href="#tune.quic.max-frame-loss">tune.quic.max-frame-loss</a>
   - <a href="#tune.quic.reorder-ratio">tune.quic.reorder-ratio</a>
   - <a href="#tune.quic.retry-threshold">tune.quic.retry-threshold</a>
   - <a href="#tune.quic.socket-owner">tune.quic.socket-owner</a>
   - <a href="#tune.quic.zero-copy-fwd-send">tune.quic.zero-copy-fwd-send</a>
   - <a href="#tune.renice.runtime">tune.renice.runtime</a>
   - <a href="#tune.renice.startup">tune.renice.startup</a>
   - <a href="#tune.rcvbuf.backend">tune.rcvbuf.backend</a>
   - <a href="#tune.rcvbuf.client">tune.rcvbuf.client</a>
   - <a href="#tune.rcvbuf.frontend">tune.rcvbuf.frontend</a>
   - <a href="#tune.rcvbuf.server">tune.rcvbuf.server</a>
   - <a href="#tune.recv_enough">tune.recv_enough</a>
   - <a href="#tune.ring.queues">tune.ring.queues</a>
   - <a href="#tune.runqueue-depth">tune.runqueue-depth</a>
   - <a href="#tune.sched.low-latency">tune.sched.low-latency</a>
   - <a href="#tune.sndbuf.backend">tune.sndbuf.backend</a>
   - <a href="#tune.sndbuf.client">tune.sndbuf.client</a>
   - <a href="#tune.sndbuf.frontend">tune.sndbuf.frontend</a>
   - <a href="#tune.sndbuf.server">tune.sndbuf.server</a>
   - <a href="#tune.stick-counters">tune.stick-counters</a>
   - <a href="#tune.ssl.cachesize">tune.ssl.cachesize</a>
   - <a href="#tune.ssl.capture-buffer-size">tune.ssl.capture-buffer-size</a>
   - tune.ssl.capture-cipherlist-size (deprecated)
   - <a href="#tune.ssl.default-dh-param">tune.ssl.default-dh-param</a>
   - <a href="#tune.ssl.force-private-cache">tune.ssl.force-private-cache</a>
   - <a href="#tune.ssl.hard-maxrecord">tune.ssl.hard-maxrecord</a>
   - <a href="#tune.ssl.keylog">tune.ssl.keylog</a>
   - <a href="#tune.ssl.lifetime">tune.ssl.lifetime</a>
   - <a href="#tune.ssl.maxrecord">tune.ssl.maxrecord</a>
   - <a href="#tune.ssl.ssl-ctx-cache-size">tune.ssl.ssl-ctx-cache-size</a>
   - tune.ssl.ocsp-update.maxdelay (deprecated)
   - tune.ssl.ocsp-update.mindelay (deprecated)
   - <a href="#tune.vars.global-max-size">tune.vars.global-max-size</a>
   - <a href="#tune.vars.proc-max-size">tune.vars.proc-max-size</a>
   - <a href="#tune.vars.reqres-max-size">tune.vars.reqres-max-size</a>
   - <a href="#tune.vars.sess-max-size">tune.vars.sess-max-size</a>
   - <a href="#tune.vars.txn-max-size">tune.vars.txn-max-size</a>
   - <a href="#tune.zlib.memlevel">tune.zlib.memlevel</a>
   - <a href="#tune.zlib.windowsize">tune.zlib.windowsize</a>

 * Debugging
   - <a href="#anonkey">anonkey</a>
   - <a href="#quiet">quiet</a>
   - <a href="#warn-blocked-traffic-after">warn-blocked-traffic-after</a>
   - <a href="#zero-warning">zero-warning</a>

 * HTTPClient
   - <a href="#httpclient.resolvers.disabled">httpclient.resolvers.disabled</a>
   - <a href="#httpclient.resolvers.id">httpclient.resolvers.id</a>
   - <a href="#httpclient.resolvers.prefer">httpclient.resolvers.prefer</a>
   - <a href="#httpclient.retries">httpclient.retries</a>
   - <a href="#httpclient.ssl.ca-file">httpclient.ssl.ca-file</a>
   - <a href="#httpclient.ssl.verify">httpclient.ssl.verify</a>
   - <a href="#httpclient.timeout.connect">httpclient.timeout.connect</a>
</pre></div>
<a class="anchor" id="3.1" name="3.1"></a>
<h2 id="chapter-3.1" data-target="3.1"><small><a class="small" href="#3.1">3.1.</a></small> Process management and security</h2>
<div><a class="anchor" name="51degrees-data-file"></a><a class="anchor" name="3-51degrees-data-file"></a><a class="anchor" name="3.1-51degrees-data-file"></a><a class="anchor" name="51degrees-data-file (Global parameters)"></a><a class="anchor" name="51degrees-data-file (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="51degrees-data-file"></a><a href="#3.1-51degrees-data-file">51degrees-data-file</a></b> <span style="color: #080">&lt;file path&gt;</span></div><pre class="text">The path of the 51Degrees data file to provide device detection services. The
file should be unzipped and accessible by HAProxy with relevant permissions.

Please note that this option is only available when HAProxy has been
compiled with USE_51DEGREES.
</pre><a class="anchor" name="51degrees-property-name-list"></a><a class="anchor" name="3-51degrees-property-name-list"></a><a class="anchor" name="3.1-51degrees-property-name-list"></a><a class="anchor" name="51degrees-property-name-list (Global parameters)"></a><a class="anchor" name="51degrees-property-name-list (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="51degrees-property-name-list"></a><a href="#3.1-51degrees-property-name-list">51degrees-property-name-list</a></b> <span style="color: #008">[<span style="color: #080">&lt;string&gt;</span> ...]</span></div><pre class="text">A list of 51Degrees property names to be load from the dataset. A full list
of names is available on the 51Degrees website:
https://51degrees.com/resources/property-dictionary

Please note that this option is only available when HAProxy has been
compiled with USE_51DEGREES.
</pre><a class="anchor" name="51degrees-property-separator"></a><a class="anchor" name="3-51degrees-property-separator"></a><a class="anchor" name="3.1-51degrees-property-separator"></a><a class="anchor" name="51degrees-property-separator (Global parameters)"></a><a class="anchor" name="51degrees-property-separator (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="51degrees-property-separator"></a><a href="#3.1-51degrees-property-separator">51degrees-property-separator</a></b> <span style="color: #080">&lt;char&gt;</span></div><pre class="text">A char that will be appended to every property value in a response header
containing 51Degrees results. If not set that will be set as ','.

Please note that this option is only available when HAProxy has been
compiled with USE_51DEGREES.
</pre><a class="anchor" name="51degrees-cache-size"></a><a class="anchor" name="3-51degrees-cache-size"></a><a class="anchor" name="3.1-51degrees-cache-size"></a><a class="anchor" name="51degrees-cache-size (Global parameters)"></a><a class="anchor" name="51degrees-cache-size (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="51degrees-cache-size"></a><a href="#3.1-51degrees-cache-size">51degrees-cache-size</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the size of the 51Degrees converter cache to &lt;number&gt; entries. This
is an LRU cache which reminds previous device detections and their results.
By default, this cache is disabled.

Please note that this option is only available when HAProxy has been
compiled with USE_51DEGREES.
</pre><a class="anchor" name="51degrees-use-performance-graph"></a><a class="anchor" name="3-51degrees-use-performance-graph"></a><a class="anchor" name="3.1-51degrees-use-performance-graph"></a><a class="anchor" name="51degrees-use-performance-graph (Global parameters)"></a><a class="anchor" name="51degrees-use-performance-graph (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="51degrees-use-performance-graph"></a><a href="#3.1-51degrees-use-performance-graph">51degrees-use-performance-graph</a></b> <span style="color: #800">{ on | off }</span></div><pre class="text">Enables ('on') or disables ('off') the use of the performance graph in
the detection process. The default value depends on 51Degrees library.

Please note that this option is only available when HAProxy has been
compiled with USE_51DEGREES and 51DEGREES_VER=4.
</pre><a class="anchor" name="51degrees-use-predictive-graph"></a><a class="anchor" name="3-51degrees-use-predictive-graph"></a><a class="anchor" name="3.1-51degrees-use-predictive-graph"></a><a class="anchor" name="51degrees-use-predictive-graph (Global parameters)"></a><a class="anchor" name="51degrees-use-predictive-graph (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="51degrees-use-predictive-graph"></a><a href="#3.1-51degrees-use-predictive-graph">51degrees-use-predictive-graph</a></b> <span style="color: #800">{ on | off }</span></div><pre class="text">Enables ('on') or disables ('off') the use of the predictive graph in
the detection process. The default value depends on 51Degrees library.

Please note that this option is only available when HAProxy has been
compiled with USE_51DEGREES and 51DEGREES_VER=4.
</pre><a class="anchor" name="51degrees-drift"></a><a class="anchor" name="3-51degrees-drift"></a><a class="anchor" name="3.1-51degrees-drift"></a><a class="anchor" name="51degrees-drift (Global parameters)"></a><a class="anchor" name="51degrees-drift (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="51degrees-drift"></a><a href="#3.1-51degrees-drift">51degrees-drift</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the drift value that a detection can allow.

Please note that this option is only available when HAProxy has been
compiled with USE_51DEGREES and 51DEGREES_VER=4.
</pre><a class="anchor" name="51degrees-difference"></a><a class="anchor" name="3-51degrees-difference"></a><a class="anchor" name="3.1-51degrees-difference"></a><a class="anchor" name="51degrees-difference (Global parameters)"></a><a class="anchor" name="51degrees-difference (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="51degrees-difference"></a><a href="#3.1-51degrees-difference">51degrees-difference</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the difference value that a detection can allow.

Please note that this option is only available when HAProxy has been
compiled with USE_51DEGREES and 51DEGREES_VER=4.
</pre><a class="anchor" name="51degrees-allow-unmatched"></a><a class="anchor" name="3-51degrees-allow-unmatched"></a><a class="anchor" name="3.1-51degrees-allow-unmatched"></a><a class="anchor" name="51degrees-allow-unmatched (Global parameters)"></a><a class="anchor" name="51degrees-allow-unmatched (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="51degrees-allow-unmatched"></a><a href="#3.1-51degrees-allow-unmatched">51degrees-allow-unmatched</a></b> <span style="color: #800">{ on | off }</span></div><pre class="text">Enables ('on') or disables ('off') the use of unmatched nodes in the
detection process. The default value depends on 51Degrees library.

Please note that this option is only available when HAProxy has been
compiled with USE_51DEGREES and 51DEGREES_VER=4.
</pre><a class="anchor" name="ca-base"></a><a class="anchor" name="3-ca-base"></a><a class="anchor" name="3.1-ca-base"></a><a class="anchor" name="ca-base (Global parameters)"></a><a class="anchor" name="ca-base (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ca-base"></a><a href="#3.1-ca-base">ca-base</a></b> <span style="color: #080">&lt;dir&gt;</span></div><pre class="text">Assigns a default directory to fetch SSL CA certificates and CRLs from when a
relative path is used with &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ca-file<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ca-file%20%28Bind%20options%29">Bind options</a></li><li><a href="#ca-file%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;, &quot;<a href="#ca-verify-file">ca-verify-file</a>&quot; or &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crl-file<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crl-file%20%28Bind%20options%29">Bind options</a></li><li><a href="#crl-file%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
directives. Absolute locations specified in &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ca-file<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ca-file%20%28Bind%20options%29">Bind options</a></li><li><a href="#ca-file%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;, &quot;<a href="#ca-verify-file">ca-verify-file</a>&quot; and
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crl-file<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crl-file%20%28Bind%20options%29">Bind options</a></li><li><a href="#crl-file%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; prevail and ignore &quot;<a href="#ca-base">ca-base</a>&quot;.
</pre><a class="anchor" name="chroot"></a><a class="anchor" name="3-chroot"></a><a class="anchor" name="3.1-chroot"></a><a class="anchor" name="chroot (Global parameters)"></a><a class="anchor" name="chroot (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="chroot"></a><a href="#3.1-chroot">chroot</a></b> <span style="color: #080">&lt;jail dir&gt;</span></div><pre class="text">Changes current directory to &lt;jail dir&gt; and performs a chroot() there before
dropping privileges. This increases the security level in case an unknown
vulnerability would be exploited, since it would make it very hard for the
attacker to exploit the system. This only works when the process is started
with superuser privileges. It is important to ensure that &lt;jail_dir&gt; is both
empty and non-writable to anyone.
</pre><a class="anchor" name="close-spread-time"></a><a class="anchor" name="3-close-spread-time"></a><a class="anchor" name="3.1-close-spread-time"></a><a class="anchor" name="close-spread-time (Global parameters)"></a><a class="anchor" name="close-spread-time (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="close-spread-time"></a><a href="#3.1-close-spread-time">close-spread-time</a></b> <span style="color: #080">&lt;time&gt;</span></div><pre class="text">Define a time window during which idle connections and active connections
closing is spread in case of soft-stop. After a SIGUSR1 is received and the
grace period is over (if any), the idle connections will all be closed at
once if this option is not set, and active HTTP or HTTP2 connections will be
ended after the next request is received, either by appending a &quot;Connection:
close&quot; line to the HTTP response, or by sending a GOAWAY frame in case of
HTTP2. When this option is set, connection closing will be spread over this
set &lt;time&gt;.
If the close-spread-time is set to &quot;infinite&quot;, active connection closing
during a soft-stop will be disabled. The &quot;Connection: close&quot; header will not
be added to HTTP responses (or GOAWAY for HTTP2) anymore and idle connections
will only be closed once their timeout is reached (based on the various
timeouts set in the configuration).
</pre><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;time&gt;  is a time window (by default in milliseconds) during which
        connection closing will be spread during a soft-stop operation, or
        &quot;infinite&quot; if active connection closing should be disabled.</pre>
</div>
<pre class="text">It is recommended to set this setting to a value lower than the one used in
the &quot;<a href="#hard-stop-after">hard-stop-after</a>&quot; option if this one is used, so that all connections
have a chance to gracefully close before the process stops.
</pre><div class="page-header"><b>See also:</b> grace, hard-stop-after, idle-close-on-response</div>
<a class="anchor" name="cluster-secret"></a><a class="anchor" name="3-cluster-secret"></a><a class="anchor" name="3.1-cluster-secret"></a><a class="anchor" name="cluster-secret (Global parameters)"></a><a class="anchor" name="cluster-secret (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="cluster-secret"></a><a href="#3.1-cluster-secret">cluster-secret</a></b> <span style="color: #080">&lt;secret&gt;</span></div><pre class="text">Define an ASCII string secret shared between several nodes belonging to the
same cluster. It could be used for different usages. It is at least used to
derive stateless reset tokens for all the QUIC connections instantiated by
this process. This is also the case to derive secrets used to encrypt Retry
tokens.

If this parameter is not set, a random value will be selected on process
startup. This allows to use features which rely on it, albeit with some
limitations.
</pre><a class="anchor" name="cpu-map"></a><a class="anchor" name="3-cpu-map"></a><a class="anchor" name="3.1-cpu-map"></a><a class="anchor" name="cpu-map (Global parameters)"></a><a class="anchor" name="cpu-map (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="cpu-map"></a><a href="#3.1-cpu-map">cpu-map</a></b> <span style="color: #008">[auto:]</span><span style="color: #080">&lt;thread-group&gt;</span><span style="color: #008">[/<span style="color: #080">&lt;thread-set&gt;</span>]</span> <span style="color: #080">&lt;cpu-set&gt;</span><span style="color: #008">[,...]</span> <span style="color: #008">[...]</span></div><pre class="text">On some operating systems, it is possible to bind a thread group or a thread
to a specific CPU set. This means that the designated threads will never run
on other CPUs. The &quot;<a href="#cpu-map">cpu-map</a>&quot; directive specifies CPU sets for individual
threads or thread groups. The first argument is a thread group range,
optionally followed by a thread set. These ranges have the following format:

    all | odd | even | number[-[number]]

&lt;number&gt; must be a number between 1 and 32 or 64, depending on the machine's
word size. Any group IDs above 'thread-groups' and any thread IDs above the
machine's word size are ignored. All thread numbers are relative to the group
they belong to. It is possible to specify a range with two such number
delimited by a dash ('-'). It also is possible to specify all threads at once
using &quot;all&quot;, only odd numbers using &quot;<a href="#odd">odd</a>&quot; or even numbers using &quot;<a href="#even">even</a>&quot;, just
like with the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">thread<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#thread%20%28Bind%20options%29">Bind options</a></li><li><a href="#thread%20%28Fetching%20samples%20from%20internal%20states%29">Fetching samples from internal states</a></li></ul></span>&quot; bind directive. The second and forthcoming arguments
are CPU sets. Each CPU set is either a unique number starting at 0 for the
first CPU or a range with two such numbers delimited by a dash ('-'). These
CPU numbers and ranges may be repeated by delimiting them with commas or by
passing more ranges as new arguments on the same line. Outside of Linux and
BSD operating systems, there may be a limitation on the maximum CPU index to
either 31 or 63. Multiple &quot;<a href="#cpu-map">cpu-map</a>&quot; directives may be specified, but each
&quot;<a href="#cpu-map">cpu-map</a>&quot; directive will replace the previous ones when they overlap.

Ranges can be partially defined. The higher bound can be omitted. In such
case, it is replaced by the corresponding maximum value, 32 or 64 depending
on the machine's word size.

The prefix &quot;auto:&quot; can be added before the thread set to let HAProxy
automatically bind a set of threads to a CPU by incrementing threads and
CPU sets. To be valid, both sets must have the same size. No matter the
declaration order of the CPU sets, it will be bound from the lowest to the
highest bound. Having both a group and a thread range with the &quot;auto:&quot;
prefix is not supported. Only one range is supported, the other one must be
a fixed number.

Note that group ranges are supported for historical reasons. Nowadays, a lone
number designates a thread group and must be 1 if thread-groups are not used,
and specifying a thread range or number requires to prepend &quot;1/&quot; in front of
it if thread groups are not used. Finally, &quot;1&quot; is strictly equivalent to
&quot;1/all&quot; and designates all threads in the group.
</pre><div class="separator">
<span class="label label-success">Examples:</span>
<pre class="prettyprint">
<code>cpu-map 1/all 0-3 <span class="comment"># bind all threads of the first group on the</span>
                  <span class="comment"># first 4 CPUs</span>

cpu-map 1/1- 0-   <span class="comment"># will be replaced by &quot;cpu-map 1/1-64 0-63&quot;</span>
                  <span class="comment"># or &quot;cpu-map 1/1-32 0-31&quot; depending on the machine's</span>
                  <span class="comment"># word size.</span>

<span class="comment"># all these lines bind thread 1 to the cpu 0, the thread 2 to cpu 1</span>
<span class="comment"># and so on.</span>
cpu-map auto:1/1-4   0-3
cpu-map auto:1/1-4   0-1 2-3
cpu-map auto:1/1-4   3 2 1 0
cpu-map auto:1/1-4   3,2,1,0

<span class="comment"># bind each thread to exactly one CPU using all/odd/even keyword</span>
cpu-map auto:1/all   0-63
cpu-map auto:1/even  0-31
cpu-map auto:1/odd   32-63

<span class="comment"># invalid cpu-map because thread and CPU sets have different sizes.</span>
cpu-map auto:1/1-4   0    <span class="comment"># invalid</span>
cpu-map auto:1/1     0-3  <span class="comment"># invalid</span>

<span class="comment"># map 40 threads of those 4 groups to individual CPUs</span>
cpu-map auto:1/1-10   0-9
cpu-map auto:2/1-10   10-19
cpu-map auto:3/1-10   20-29
cpu-map auto:4/1-10   30-39

<span class="comment"># Map 80 threads to one physical socket and 80 others to another socket</span>
<span class="comment"># without forcing assignment. These are split into 4 groups since no</span>
<span class="comment"># group may have more than 64 threads.</span>
cpu-map 1/1-40   0-39,80-119    <span class="comment"># node0, siblings 0 &amp; 1</span>
cpu-map 2/1-40   0-39,80-119
cpu-map 3/1-40   40-79,120-159  <span class="comment"># node1, siblings 0 &amp; 1</span>
cpu-map 4/1-40   40-79,120-159
</code></pre>
</div><a class="anchor" name="crt-base"></a><a class="anchor" name="3-crt-base"></a><a class="anchor" name="3.1-crt-base"></a><a class="anchor" name="crt-base (Global parameters)"></a><a class="anchor" name="crt-base (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="crt-base"></a><a href="#3.1-crt-base">crt-base</a></b> <span style="color: #080">&lt;dir&gt;</span></div><pre class="text">Assigns a default directory to fetch SSL certificates from when a relative
path is used with &quot;crtfile&quot; or &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crt<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crt%20%28Load%20options%29">Load options</a></li><li><a href="#crt%20%28Bind%20options%29">Bind options</a></li><li><a href="#crt%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; directives. Absolute locations specified
prevail and ignore &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crt-base<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crt-base%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#crt-base%20%28Certificate%20Storage%29">Certificate Storage</a></li></ul></span>&quot;.
</pre><a class="anchor" name="daemon"></a><a class="anchor" name="3-daemon"></a><a class="anchor" name="3.1-daemon"></a><a class="anchor" name="daemon (Global parameters)"></a><a class="anchor" name="daemon (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="daemon"></a><a href="#3.1-daemon">daemon</a></b></div><pre class="text">Makes the process fork into background. This is the recommended mode of
operation. It is equivalent to the command line &quot;-D&quot; argument. It can be
disabled by the command line &quot;-db&quot; argument. This option is ignored in
systemd mode.
</pre><a class="anchor" name="default-path"></a><a class="anchor" name="3-default-path"></a><a class="anchor" name="3.1-default-path"></a><a class="anchor" name="default-path (Global parameters)"></a><a class="anchor" name="default-path (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="default-path"></a><a href="#3.1-default-path">default-path</a></b> <span style="color: #800">{ current | config | parent | origin <span style="color: #080">&lt;path&gt;</span> }</span></div><pre class="text">By default HAProxy loads all files designated by a relative path from the
location the process is started in. In some circumstances it might be
desirable to force all relative paths to start from a different location
just as if the process was started from such locations. This is what this
directive is made for. Technically it will perform a temporary chdir() to
the designated location while processing each configuration file, and will
return to the original directory after processing each file. It takes an
argument indicating the policy to use when loading files whose path does
not start with a slash ('/'):
  - &quot;current&quot; indicates that all relative files are to be loaded from the
    directory the process is started in ; this is the default.

  - &quot;config&quot; indicates that all relative files should be loaded from the
    directory containing the configuration file. More specifically, if the
    configuration file contains a slash ('/'), the longest part up to the
    last slash is used as the directory to change to, otherwise the current
    directory is used. This mode is convenient to bundle maps, errorfiles,
    certificates and Lua scripts together as relocatable packages. When
    multiple configuration files are loaded, the directory is updated for
    each of them.

  - &quot;parent&quot; indicates that all relative files should be loaded from the
    parent of the directory containing the configuration file. More
    specifically, if the configuration file contains a slash ('/'), &quot;..&quot;
    is appended to the longest part up to the last slash is used as the
    directory to change to, otherwise the directory is &quot;..&quot;. This mode is
    convenient to bundle maps, errorfiles,  certificates and Lua scripts
    together as relocatable packages, but where each part is located in a
    different subdirectory (e.g. &quot;config/&quot;, &quot;certs/&quot;, &quot;maps/&quot;, ...).

  - &quot;origin&quot; indicates that all relative files should be loaded from the
    designated (mandatory) path. This may be used to ease management of
    different HAProxy instances running in parallel on a system, where each
    instance uses a different prefix but where the rest of the sections are
    made easily relocatable.

Each &quot;<a href="#default-path">default-path</a>&quot; directive instantly replaces any previous one and will
possibly result in switching to a different directory. While this should
always result in the desired behavior, it is really not a good practice to
use multiple default-path directives, and if used, the policy ought to remain
consistent across all configuration files.

Warning: some configuration elements such as maps or certificates are
uniquely identified by their configured path. By using a relocatable layout,
it becomes possible for several of them to end up with the same unique name,
making it difficult to update them at run time, especially when multiple
configuration files are loaded from different directories. It is essential to
observe a strict collision-free file naming scheme before adopting relative
paths. A robust approach could consist in prefixing all files names with
their respective site name, or in doing so at the directory level.
</pre><a class="anchor" name="description"></a><a class="anchor" name="3-description"></a><a class="anchor" name="3.1-description"></a><a class="anchor" name="description (Global parameters)"></a><a class="anchor" name="description (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="description"></a><a href="#3.1-description">description</a></b> <span style="color: #080">&lt;text&gt;</span></div><pre class="text">Add a text that describes the instance.

Please note that it is required to escape certain characters (# for example)
and this text is inserted into a html page so you should avoid using
&quot;&lt;&quot; and &quot;&gt;&quot; characters.
</pre><a class="anchor" name="deviceatlas-json-file"></a><a class="anchor" name="3-deviceatlas-json-file"></a><a class="anchor" name="3.1-deviceatlas-json-file"></a><a class="anchor" name="deviceatlas-json-file (Global parameters)"></a><a class="anchor" name="deviceatlas-json-file (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="deviceatlas-json-file"></a><a href="#3.1-deviceatlas-json-file">deviceatlas-json-file</a></b> <span style="color: #080">&lt;path&gt;</span></div><pre class="text">Sets the path of the DeviceAtlas JSON data file to be loaded by the API.
The path must be a valid JSON data file and accessible by HAProxy process.
</pre><a class="anchor" name="deviceatlas-log-level"></a><a class="anchor" name="3-deviceatlas-log-level"></a><a class="anchor" name="3.1-deviceatlas-log-level"></a><a class="anchor" name="deviceatlas-log-level (Global parameters)"></a><a class="anchor" name="deviceatlas-log-level (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="deviceatlas-log-level"></a><a href="#3.1-deviceatlas-log-level">deviceatlas-log-level</a></b> <span style="color: #080">&lt;value&gt;</span></div><pre class="text">Sets the level of information returned by the API. This directive is
optional and set to 0 by default if not set.
</pre><a class="anchor" name="deviceatlas-properties-cookie"></a><a class="anchor" name="3-deviceatlas-properties-cookie"></a><a class="anchor" name="3.1-deviceatlas-properties-cookie"></a><a class="anchor" name="deviceatlas-properties-cookie (Global parameters)"></a><a class="anchor" name="deviceatlas-properties-cookie (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="deviceatlas-properties-cookie"></a><a href="#3.1-deviceatlas-properties-cookie">deviceatlas-properties-cookie</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">Sets the client cookie's name used for the detection if the DeviceAtlas
Client-side component was used during the request. This directive is optional
and set to DAPROPS by default if not set.
</pre><a class="anchor" name="deviceatlas-separator"></a><a class="anchor" name="3-deviceatlas-separator"></a><a class="anchor" name="3.1-deviceatlas-separator"></a><a class="anchor" name="deviceatlas-separator (Global parameters)"></a><a class="anchor" name="deviceatlas-separator (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="deviceatlas-separator"></a><a href="#3.1-deviceatlas-separator">deviceatlas-separator</a></b> <span style="color: #080">&lt;char&gt;</span></div><pre class="text">Sets the character separator for the API properties results. This directive
is optional and set to | by default if not set.
</pre><a class="anchor" name="expose-deprecated-directives"></a><a class="anchor" name="3-expose-deprecated-directives"></a><a class="anchor" name="3.1-expose-deprecated-directives"></a><a class="anchor" name="expose-deprecated-directives (Global parameters)"></a><a class="anchor" name="expose-deprecated-directives (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="expose-deprecated-directives"></a><a href="#3.1-expose-deprecated-directives">expose-deprecated-directives</a></b></div><pre class="text">This statement must appear before using some directives tagged as deprecated
to silent warnings and make sure the config file will not be rejected. Not
all deprecated directives are concerned, only those without any alternative
solution.
</pre><a class="anchor" name="expose-experimental-directives"></a><a class="anchor" name="3-expose-experimental-directives"></a><a class="anchor" name="3.1-expose-experimental-directives"></a><a class="anchor" name="expose-experimental-directives (Global parameters)"></a><a class="anchor" name="expose-experimental-directives (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="expose-experimental-directives"></a><a href="#3.1-expose-experimental-directives">expose-experimental-directives</a></b></div><pre class="text">This statement must appear before using directives tagged as experimental or
the config file will be rejected.
</pre><a class="anchor" name="external-check"></a><a class="anchor" name="3-external-check"></a><a class="anchor" name="3.1-external-check"></a><a class="anchor" name="external-check (Global parameters)"></a><a class="anchor" name="external-check (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="external-check"></a><a href="#3.1-external-check">external-check</a></b> <span style="color: #008">[preserve-env]</span></div><pre class="text">Allows the use of an external agent to perform health checks. This is
disabled by default as a security precaution, and even when enabled, checks
may still fail unless &quot;<a href="#insecure-fork-wanted">insecure-fork-wanted</a>&quot; is enabled as well. If the
program launched makes use of a setuid executable (it should really not),
you may also need to set &quot;<a href="#insecure-setuid-wanted">insecure-setuid-wanted</a>&quot; in the global section.
By default, the checks start with a clean environment which only contains
variables defined in the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">external-check<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#external-check%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#external-check%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; command in the backend section. It
may sometimes be desirable to preserve the environment though, for example
when complex scripts retrieve their extra paths or information there. This
can be done by appending the &quot;preserve-env&quot; keyword. In this case however it
is strongly advised not to run a setuid nor as a privileged user, as this
exposes the check program to potential attacks. See &quot;<a href="#option%20external-check">option external-check</a>&quot;,
and &quot;<a href="#insecure-fork-wanted">insecure-fork-wanted</a>&quot;, and &quot;<a href="#insecure-setuid-wanted">insecure-setuid-wanted</a>&quot; for extra details.
</pre><a class="anchor" name="fd-hard-limit"></a><a class="anchor" name="3-fd-hard-limit"></a><a class="anchor" name="3.1-fd-hard-limit"></a><a class="anchor" name="fd-hard-limit (Global parameters)"></a><a class="anchor" name="fd-hard-limit (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="fd-hard-limit"></a><a href="#3.1-fd-hard-limit">fd-hard-limit</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets an upper bound to the maximum number of file descriptors that the
process will use, regardless of system limits. While &quot;<a href="#ulimit-n">ulimit-n</a>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
may be used to enforce a value, when they are not set, the process will be
limited to the hard limit of the RLIMIT_NOFILE setting as reported by
&quot;ulimit -n -H&quot;. But some modern operating systems are now allowing extremely
large values here (in the order of 1 billion), which will consume way too
much RAM for regular usage. The fd-hard-limit setting is provided to enforce
a possibly lower bound to this limit. This means that it will always respect
the system-imposed limits when they are below &lt;number&gt; but the specified
value will be used if system-imposed limits are higher. By default
fd-hard-limit is set to 1048576. This default could be changed via
DEFAULT_MAXFD compile-time variable, that could serve as the maximum (kernel)
system limit, if RLIMIT_NOFILE hard limit is extremely large. fd-hard-limit
set in global section allows to temporarily override the value provided via
DEFAULT_MAXFD at the build-time. In the example below, no other setting is
specified and the maxconn value will automatically adapt to the lower of
&quot;<a href="#fd-hard-limit">fd-hard-limit</a>&quot; and the RLIMIT_NOFILE limit:

    global
        # use as many FDs as possible but no more than 50000
        fd-hard-limit 50000
</pre><div class="page-header"><b>See also:</b> ulimit-n, maxconn</div>
<a class="anchor" name="gid"></a><a class="anchor" name="3-gid"></a><a class="anchor" name="3.1-gid"></a><a class="anchor" name="gid (Global parameters)"></a><a class="anchor" name="gid (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="gid"></a><a href="#3.1-gid">gid</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Changes the process's group ID to &lt;number&gt;. It is recommended that the group
ID is dedicated to HAProxy or to a small set of similar daemons. HAProxy must
be started with a user belonging to this group, or with superuser privileges.
Note that if HAProxy is started from a user having supplementary groups, it
will only be able to drop these groups if started with superuser privileges.
See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">group<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#group%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#group%20%28Userlists%29">Userlists</a></li><li><a href="#group%20%28Programs%20%28deprecated%29%29">Programs (deprecated)</a></li><li><a href="#group%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">uid<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#uid%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#uid%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot;.
</pre><a class="anchor" name="grace"></a><a class="anchor" name="3-grace"></a><a class="anchor" name="3.1-grace"></a><a class="anchor" name="grace (Global parameters)"></a><a class="anchor" name="grace (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="grace"></a><a href="#3.1-grace">grace</a></b> <span style="color: #080">&lt;time&gt;</span></div><pre class="text">Defines a delay between SIGUSR1 and real soft-stop.
</pre><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;time&gt;  is an extra delay (by default in milliseconds) after receipt of the
        SIGUSR1 signal that will be waited for before proceeding with the
        soft-stop operation.</pre>
</div>
<pre class="text">This is used for compatibility with legacy environments where the haproxy
process needs to be stopped but some external components need to detect the
status before listeners are unbound. The principle is that the internal
&quot;<a href="#stopping">stopping</a>&quot; variable (which is reported by the &quot;<a href="#stopping">stopping</a>&quot; sample fetch
function) will be turned to true, but listeners will continue to accept
connections undisturbed, until the delay expires, after what the regular
soft-stop will proceed. This must not be used with processes that are
reloaded, or this will prevent the old process from unbinding, and may
prevent the new one from starting, or simply cause trouble.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>global
  grace 10s

<span class="comment"># Returns 200 OK until stopping is set via SIGUSR1</span>
frontend ext-check
  bind :9999
  monitor-uri /ext-check
  monitor fail if { stopping }
</code></pre>
</div><pre class="text">Please note that a more flexible and durable approach would instead consist
for an orchestration system in setting a global variable from the CLI, use
that variable to respond to external checks, then after a delay send the
SIGUSR1 signal.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># Returns 200 OK until proc.stopping is set to non-zero. May be done</span>
<span class="comment"># from HTTP using set-var(proc.stopping) or from the CLI using:</span>
<span class="comment"># &gt; set var proc.stopping int(1)</span>
frontend ext-check
  bind :9999
  monitor-uri /ext-check
  monitor fail if { var(proc.stopping) -m int gt 0 }
</code></pre>
</div><div class="page-header"><b>See also:</b> hard-stop-after, monitor</div>
<a class="anchor" name="group"></a><a class="anchor" name="3-group"></a><a class="anchor" name="3.1-group"></a><a class="anchor" name="group (Global parameters)"></a><a class="anchor" name="group (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="group"></a><a href="#3.1-group">group</a></b> <span style="color: #080">&lt;group name&gt;</span></div><pre class="text">Similar to &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">gid<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#gid%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#gid%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; but uses the GID of group name &lt;group name&gt; from /etc/group.
See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">gid<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#gid%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#gid%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">user<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#user%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#user%20%28Userlists%29">Userlists</a></li><li><a href="#user%20%28Programs%20%28deprecated%29%29">Programs (deprecated)</a></li><li><a href="#user%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot;.
</pre><a class="anchor" name="h1-accept-payload-with-any-method"></a><a class="anchor" name="3-h1-accept-payload-with-any-method"></a><a class="anchor" name="3.1-h1-accept-payload-with-any-method"></a><a class="anchor" name="h1-accept-payload-with-any-method (Global parameters)"></a><a class="anchor" name="h1-accept-payload-with-any-method (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="h1-accept-payload-with-any-method"></a><a href="#3.1-h1-accept-payload-with-any-method">h1-accept-payload-with-any-method</a></b></div><pre class="text">Does not reject HTTP/1.0 GET/HEAD/DELETE requests with a payload.

While It is explicitly allowed in HTTP/1.1, HTTP/1.0 is not clear on this
point and some old servers don't expect any payload and never look for body
length (via Content-Length or Transfer-Encoding headers). It means that some
intermediaries may properly handle the payload for HTTP/1.0 GET/HEAD/DELETE
requests, while some others may totally ignore it. That may lead to security
issues because a request smuggling attack is possible. Thus, by default,
HAProxy rejects HTTP/1.0 GET/HEAD/DELETE requests with a payload.

However, it may be an issue with some old clients. In this case, this global
option may be set.
</pre><a class="anchor" name="h1-do-not-close-on-insecure-transfer-encoding"></a><a class="anchor" name="3-h1-do-not-close-on-insecure-transfer-encoding"></a><a class="anchor" name="3.1-h1-do-not-close-on-insecure-transfer-encoding"></a><a class="anchor" name="h1-do-not-close-on-insecure-transfer-encoding (Global parameters)"></a><a class="anchor" name="h1-do-not-close-on-insecure-transfer-encoding (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="h1-do-not-close-on-insecure-transfer-encoding"></a><a href="#3.1-h1-do-not-close-on-insecure-transfer-encoding">h1-do-not-close-on-insecure-transfer-encoding</a></b></div><pre class="text">As mandated by the HTTP/1.1 specification (RFC9112#6.1), the presence of both
a Transfer-Encoding header field and a Content-Length header field in the
same message represents a serious risk of conveying a content smuggling
attack if there are any HTTP/1.0 agent anywhere in the upstream of downstream
chain, and when facing this, an agent must absolutely close the connection
after the response so as to prevent any exploitation. But this may have a
performance impact on some very old clients, especially if they need to
renegotiate a TLS connection for every request. This option is present to
ask HAProxy not to enforce this rule, and to just sanitize the message but
leave the connection alive after the response. This may only be done when
absolutely certain that no HTTP/1.0 agents are present in the chain and that
all implementations before HAProxy are fully HTTP/1.1 compliant regarding the
rules that apply to these header fields. In any case, HAProxy will continue
to ignore and drop the extraneous Content-Length header so as not to confuse
the next hop.

When enabling this option to work around an old broken client or server, it
is important to understand that regardless of the need or not for this
option, such an agent violating this rule faces a risk to see its messages
truncated by old agents that would consider Content-Length and ignore
Transfer-Encoding, since the cumulated size of the encoded chunk sizes are
not being accounted for. As such, the rule above is not just a matter of
security but also of taking care of getting rid of agents that may face
communication trouble due to incompatibilities with older ones.
</pre><a class="anchor" name="h1-case-adjust"></a><a class="anchor" name="3-h1-case-adjust"></a><a class="anchor" name="3.1-h1-case-adjust"></a><a class="anchor" name="h1-case-adjust (Global parameters)"></a><a class="anchor" name="h1-case-adjust (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="h1-case-adjust"></a><a href="#3.1-h1-case-adjust">h1-case-adjust</a></b> <span style="color: #080">&lt;from&gt;</span> <span style="color: #080">&lt;to&gt;</span></div><pre class="text">Defines the case adjustment to apply, when enabled, to the header name
&lt;from&gt;, to change it to &lt;to&gt; before sending it to HTTP/1 clients or
servers. &lt;from&gt; must be in lower case, and &lt;from&gt; and &lt;to&gt; must not differ
except for their case. It may be repeated if several header names need to be
adjusted. Duplicate entries are not allowed. If a lot of header names have to
be adjusted, it might be more convenient to use &quot;<a href="#h1-case-adjust-file">h1-case-adjust-file</a>&quot;.
Please note that no transformation will be applied unless &quot;option
h1-case-adjust-bogus-client&quot; or &quot;<a href="#option%20h1-case-adjust-bogus-server">option h1-case-adjust-bogus-server</a>&quot; is
specified in a proxy.

There is no standard case for header names because, as stated in RFC7230,
they are case-insensitive. So applications must handle them in a case-
insensitive manner. But some bogus applications violate the standards and
erroneously rely on the cases most commonly used by browsers. This problem
becomes critical with HTTP/2 because all header names must be exchanged in
lower case, and HAProxy follows the same convention. All header names are
sent in lower case to clients and servers, regardless of the HTTP version.

Applications which fail to properly process requests or responses may require
to temporarily use such workarounds to adjust header names sent to them for
the time it takes the application to be fixed. Please note that an
application which requires such workarounds might be vulnerable to content
smuggling attacks and must absolutely be fixed.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>global
  h1-case-adjust content-length Content-Length
</code></pre>
</div><pre class="text">See &quot;<a href="#h1-case-adjust-file">h1-case-adjust-file</a>&quot;, &quot;<a href="#option%20h1-case-adjust-bogus-client">option h1-case-adjust-bogus-client</a>&quot; and
&quot;<a href="#option%20h1-case-adjust-bogus-server">option h1-case-adjust-bogus-server</a>&quot;.
</pre><a class="anchor" name="h1-case-adjust-file"></a><a class="anchor" name="3-h1-case-adjust-file"></a><a class="anchor" name="3.1-h1-case-adjust-file"></a><a class="anchor" name="h1-case-adjust-file (Global parameters)"></a><a class="anchor" name="h1-case-adjust-file (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="h1-case-adjust-file"></a><a href="#3.1-h1-case-adjust-file">h1-case-adjust-file</a></b> <span style="color: #080">&lt;hdrs-file&gt;</span></div><pre class="text">Defines a file containing a list of key/value pairs used to adjust the case
of some header names before sending them to HTTP/1 clients or servers. The
file &lt;hdrs-file&gt; must contain 2 header names per line. The first one must be
in lower case and both must not differ except for their case. Lines which
start with '#' are ignored, just like empty lines. Leading and trailing tabs
and spaces are stripped. Duplicate entries are not allowed. Please note that
no transformation will be applied unless &quot;<a href="#option%20h1-case-adjust-bogus-client">option h1-case-adjust-bogus-client</a>&quot;
or &quot;<a href="#option%20h1-case-adjust-bogus-server">option h1-case-adjust-bogus-server</a>&quot; is specified in a proxy.

If this directive is repeated, only the last one will be processed.  It is an
alternative to the directive &quot;<a href="#h1-case-adjust">h1-case-adjust</a>&quot; if a lot of header names need
to be adjusted. Please read the risks associated with using this.

See &quot;<a href="#h1-case-adjust">h1-case-adjust</a>&quot;, &quot;<a href="#option%20h1-case-adjust-bogus-client">option h1-case-adjust-bogus-client</a>&quot; and
&quot;<a href="#option%20h1-case-adjust-bogus-server">option h1-case-adjust-bogus-server</a>&quot;.
</pre><a class="anchor" name="h2-workaround-bogus-websocket-clients"></a><a class="anchor" name="3-h2-workaround-bogus-websocket-clients"></a><a class="anchor" name="3.1-h2-workaround-bogus-websocket-clients"></a><a class="anchor" name="h2-workaround-bogus-websocket-clients (Global parameters)"></a><a class="anchor" name="h2-workaround-bogus-websocket-clients (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="h2-workaround-bogus-websocket-clients"></a><a href="#3.1-h2-workaround-bogus-websocket-clients">h2-workaround-bogus-websocket-clients</a></b></div><pre class="text">This disables the announcement of the support for h2 websockets to clients.
This can be use to overcome clients which have issues when implementing the
relatively fresh RFC8441, such as Firefox 88. To allow clients to
automatically downgrade to http/1.1 for the websocket tunnel, specify h2
support on the bind line using &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">alpn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#alpn%20%28Bind%20options%29">Bind options</a></li><li><a href="#alpn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; without an explicit &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">proto<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#proto%20%28Bind%20options%29">Bind options</a></li><li><a href="#proto%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword. If
this statement was previously activated, this can be disabled by prefixing
the keyword with &quot;no'.
</pre><a class="anchor" name="hard-stop-after"></a><a class="anchor" name="3-hard-stop-after"></a><a class="anchor" name="3.1-hard-stop-after"></a><a class="anchor" name="hard-stop-after (Global parameters)"></a><a class="anchor" name="hard-stop-after (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="hard-stop-after"></a><a href="#3.1-hard-stop-after">hard-stop-after</a></b> <span style="color: #080">&lt;time&gt;</span></div><pre class="text">Defines the maximum time allowed to perform a clean soft-stop.
</pre><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;time&gt;  is the maximum time (by default in milliseconds) for which the
        instance will remain alive when a soft-stop is received via the
        SIGUSR1 signal.</pre>
</div>
<pre class="text">This may be used to ensure that the instance will quit even if connections
remain opened during a soft-stop (for example with long timeouts for a proxy
in tcp mode). It applies both in TCP and HTTP mode.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>global
  hard-stop-after 30s
</code></pre>
</div><div class="page-header"><b>See also:</b> grace</div>
<a class="anchor" name="harden.reject-privileged-ports.tcp"></a><a class="anchor" name="3-harden.reject-privileged-ports.tcp"></a><a class="anchor" name="3.1-harden.reject-privileged-ports.tcp"></a><a class="anchor" name="harden.reject-privileged-ports.tcp (Global parameters)"></a><a class="anchor" name="harden.reject-privileged-ports.tcp (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="harden.reject-privileged-ports.tcp"></a><a href="#3.1-harden.reject-privileged-ports.tcp">harden.reject-privileged-ports.tcp</a></b> <span style="color: #800">{ on | off }</span></div><a class="anchor" name="harden.reject-privileged-ports.quic"></a><a class="anchor" name="3-harden.reject-privileged-ports.quic"></a><a class="anchor" name="3.1-harden.reject-privileged-ports.quic"></a><a class="anchor" name="harden.reject-privileged-ports.quic (Global parameters)"></a><a class="anchor" name="harden.reject-privileged-ports.quic (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="harden.reject-privileged-ports.quic"></a><a href="#3.1-harden.reject-privileged-ports.quic">harden.reject-privileged-ports.quic</a></b> <span style="color: #800">{ on | off }</span></div><pre class="text">Toggle per protocol protection which forbid communication with clients which
use privileged ports as their source port. This range of ports is defined
according to RFC 6335. By default, protection is active for QUIC protocol as
this behavior is suspicious and may be used as a spoofing or DNS/NTP
amplification attack.
</pre><a class="anchor" name="http-err-codes"></a><a class="anchor" name="3-http-err-codes"></a><a class="anchor" name="3.1-http-err-codes"></a><a class="anchor" name="http-err-codes (Global parameters)"></a><a class="anchor" name="http-err-codes (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="http-err-codes"></a><a href="#3.1-http-err-codes">http-err-codes</a></b> <span style="color: #008">[+-]</span><span style="color: #080">&lt;range&gt;</span><span style="color: #008">[,...]</span> <span style="color: #008">[...]</span></div><pre class="text">Replace, reduce or extend the list of status codes that define an error as
considered by the termination codes and the &quot;http_err_cnt&quot; counter in stick
tables. The default range for errors is 400 to 499, but in certain contexts
some users prefer to exclude specific codes, especially when tracking client
errors (e.g. 404 on systems with dynamically generated contents). See also
&quot;<a href="#http-fail-codes">http-fail-codes</a>&quot; and &quot;http_err_cnt&quot;.

A range specified without '+' nor '-' redefines the existing range to the new
one. A range starting with '+' extends the existing range to also include the
specified one, which may or may not overlap with the existing one. A range
starting with '-' removes the specified range from the existing one. A range
consists in a number from 100 to 599, optionally followed by &quot;-&quot; followed by
another number greater than or equal to the first one to indicate the high
boundary of the range. Multiple ranges may be delimited by commas for a same
add/del/ replace operation.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-err-codes 400,402-444,446-480,490   <span class="comment"># sets exactly these codes</span>
http-err-codes 400-499 -450 +500         <span class="comment"># sets 400 to 500 except 450</span>
http-err-codes -450-459                  <span class="comment"># removes 450 to 459 from range</span>
http-err-codes +501,505                  <span class="comment"># adds 501 and 505 to range</span>
</code></pre>
</div><a class="anchor" name="http-fail-codes"></a><a class="anchor" name="3-http-fail-codes"></a><a class="anchor" name="3.1-http-fail-codes"></a><a class="anchor" name="http-fail-codes (Global parameters)"></a><a class="anchor" name="http-fail-codes (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="http-fail-codes"></a><a href="#3.1-http-fail-codes">http-fail-codes</a></b> <span style="color: #008">[+-]</span><span style="color: #080">&lt;range&gt;</span><span style="color: #008">[,...]</span> <span style="color: #008">[...]</span></div><pre class="text">Replace, reduce or extend the list of status codes that define a failure as
considered by the termination codes and the &quot;http_fail_cnt&quot; counter in stick
tables. The default range for failures is 500 to 599 except 501 and 505 which
can be triggered by clients, and normally indicate a failure from the server
to process the request. Some users prefer to exclude certain codes in certain
contexts where it is known they're not relevant, such as 500 in certain SOAP
environments as it doesn't translate a server fault there. The syntax is
exactly the same as for http-err-codes above. See also &quot;<a href="#http-err-codes">http-err-codes</a>&quot; and
&quot;http_fail_cnt&quot;.
</pre><a class="anchor" name="insecure-fork-wanted"></a><a class="anchor" name="3-insecure-fork-wanted"></a><a class="anchor" name="3.1-insecure-fork-wanted"></a><a class="anchor" name="insecure-fork-wanted (Global parameters)"></a><a class="anchor" name="insecure-fork-wanted (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="insecure-fork-wanted"></a><a href="#3.1-insecure-fork-wanted">insecure-fork-wanted</a></b></div><pre class="text">By default HAProxy tries hard to prevent any thread and process creation
after it starts. Doing so is particularly important when using Lua files of
uncertain origin, and when experimenting with development versions which may
still contain bugs whose exploitability is uncertain. And generally speaking
it's good hygiene to make sure that no unexpected background activity can be
triggered by traffic. But this prevents external checks from working, and may
break some very specific Lua scripts which actively rely on the ability to
fork. This option is there to disable this protection. Note that it is a bad
idea to disable it, as a vulnerability in a library or within HAProxy itself
will be easier to exploit once disabled. In addition, forking from Lua or
anywhere else is not reliable as the forked process may randomly embed a lock
set by another thread and never manage to finish an operation. As such it is
highly recommended that this option is never used and that any workload
requiring such a fork be reconsidered and moved to a safer solution (such as
agents instead of external checks). This option supports the &quot;no&quot; prefix to
disable it. This can also be activated with &quot;-dI&quot; on the haproxy command
line.
</pre><a class="anchor" name="insecure-setuid-wanted"></a><a class="anchor" name="3-insecure-setuid-wanted"></a><a class="anchor" name="3.1-insecure-setuid-wanted"></a><a class="anchor" name="insecure-setuid-wanted (Global parameters)"></a><a class="anchor" name="insecure-setuid-wanted (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="insecure-setuid-wanted"></a><a href="#3.1-insecure-setuid-wanted">insecure-setuid-wanted</a></b></div><pre class="text">HAProxy doesn't need to call executables at run time (except when using
external checks which are strongly recommended against), and is even expected
to isolate itself into an empty chroot. As such, there basically is no valid
reason to allow a setuid executable to be called without the user being fully
aware of the risks. In a situation where HAProxy would need to call external
checks and/or disable chroot, exploiting a vulnerability in a library or in
HAProxy itself could lead to the execution of an external program. On Linux
it is possible to lock the process so that any setuid bit present on such an
executable is ignored. This significantly reduces the risk of privilege
escalation in such a situation. This is what HAProxy does by default. In case
this causes a problem to an external check (for example one which would need
the &quot;ping&quot; command), then it is possible to disable this protection by
explicitly adding this directive in the global section. If enabled, it is
possible to turn it back off by prefixing it with the &quot;no&quot; keyword.
</pre><a class="anchor" name="issuers-chain-path"></a><a class="anchor" name="3-issuers-chain-path"></a><a class="anchor" name="3.1-issuers-chain-path"></a><a class="anchor" name="issuers-chain-path (Global parameters)"></a><a class="anchor" name="issuers-chain-path (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="issuers-chain-path"></a><a href="#3.1-issuers-chain-path">issuers-chain-path</a></b> <span style="color: #080">&lt;dir&gt;</span></div><pre class="text">Assigns a directory to load certificate chain for issuer completion. All
files must be in PEM format. For certificates loaded with &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crt<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crt%20%28Load%20options%29">Load options</a></li><li><a href="#crt%20%28Bind%20options%29">Bind options</a></li><li><a href="#crt%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; or &quot;<a href="#crt-list">crt-list</a>&quot;,
if certificate chain is not included in PEM (also commonly known as
intermediate certificate), HAProxy will complete chain if the issuer of the
certificate corresponds to the first certificate of the chain loaded with
&quot;<a href="#issuers-chain-path">issuers-chain-path</a>&quot;.
A &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crt<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crt%20%28Load%20options%29">Load options</a></li><li><a href="#crt%20%28Bind%20options%29">Bind options</a></li><li><a href="#crt%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; file with PrivateKey+Certificate+IntermediateCA2+IntermediateCA1
could be replaced with PrivateKey+Certificate. HAProxy will complete the
chain if a file with IntermediateCA2+IntermediateCA1 is present in
&quot;<a href="#issuers-chain-path">issuers-chain-path</a>&quot; directory. All other certificates with the same issuer
will share the chain in memory.

The OCSP features are able to use the completed chain when no .issuer was
used, or no chain was provided in the PEM.
</pre><a class="anchor" name="key-base"></a><a class="anchor" name="3-key-base"></a><a class="anchor" name="3.1-key-base"></a><a class="anchor" name="key-base (Global parameters)"></a><a class="anchor" name="key-base (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="key-base"></a><a href="#3.1-key-base">key-base</a></b> <span style="color: #080">&lt;dir&gt;</span></div><pre class="text">Assigns a default directory to fetch SSL private keys from when a relative
path is used with &quot;<a href="#key">key</a>&quot; directives. Absolute locations specified prevail and
ignore &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">key-base<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#key-base%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#key-base%20%28Certificate%20Storage%29">Certificate Storage</a></li></ul></span>&quot;. This option only works with a crt-store load line.
</pre><a class="anchor" name="limited-quic"></a><a class="anchor" name="3-limited-quic"></a><a class="anchor" name="3.1-limited-quic"></a><a class="anchor" name="limited-quic (Global parameters)"></a><a class="anchor" name="limited-quic (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="limited-quic"></a><a href="#3.1-limited-quic">limited-quic</a></b></div><pre class="text">This setting must be used to explicitly enable the QUIC listener bindings when
haproxy is compiled against a TLS/SSL stack without QUIC support, typically
OpenSSL. It has no effect when haproxy is compiled against a TLS/SSL stack
with QUIC support, quictls for instance. Note that QUIC 0-RTT is not supported
when this setting is set.
</pre><a class="anchor" name="localpeer"></a><a class="anchor" name="3-localpeer"></a><a class="anchor" name="3.1-localpeer"></a><a class="anchor" name="localpeer (Global parameters)"></a><a class="anchor" name="localpeer (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="localpeer"></a><a href="#3.1-localpeer">localpeer</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">Sets the local instance's peer name. It will be ignored if the &quot;-L&quot;
command line argument is specified or if used after &quot;<a href="#peers">peers</a>&quot; section
definitions. In such cases, a warning message will be emitted during
the configuration parsing.

This option will also set the HAPROXY_LOCALPEER environment variable.
See also &quot;-L&quot; in the management guide and &quot;<a href="#peers">peers</a>&quot; section below.
</pre><a class="anchor" name="log"></a><a class="anchor" name="3-log"></a><a class="anchor" name="3.1-log"></a><a class="anchor" name="log (Global parameters)"></a><a class="anchor" name="log (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="log"></a><a href="#3.1-log">log</a></b> <span style="color: #080">&lt;target&gt;</span> <span style="color: #008">[len <span style="color: #080">&lt;length&gt;</span>]</span> <span style="color: #008">[format <span style="color: #080">&lt;format&gt;</span>]</span> <span style="color: #008">[sample <span style="color: #080">&lt;ranges&gt;</span>:<span style="color: #080">&lt;sample_size&gt;</span>]</span>
    <span style="color: #008">[profile <span style="color: #080">&lt;prof&gt;</span>]</span> <span style="color: #080">&lt;facility&gt;</span> <span style="color: #008">[max level <span style="color: #008">[min level]</span>]</span></div><pre class="text">Adds a global syslog server. Several global servers can be defined. They
will receive logs for starts and exits, as well as all logs from proxies
configured with &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log global<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20global%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20global%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;. See &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; option for proxies for more details.
</pre><a class="anchor" name="log-send-hostname"></a><a class="anchor" name="3-log-send-hostname"></a><a class="anchor" name="3.1-log-send-hostname"></a><a class="anchor" name="log-send-hostname (Global parameters)"></a><a class="anchor" name="log-send-hostname (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="log-send-hostname"></a><a href="#3.1-log-send-hostname">log-send-hostname</a></b> <span style="color: #008">[<span style="color: #080">&lt;string&gt;</span>]</span></div><pre class="text">Sets the hostname field in the syslog header. If optional &quot;string&quot; parameter
is set the header is set to the string contents, otherwise uses the hostname
of the system. Generally used if one is not relaying logs through an
intermediate syslog server or for simply customizing the hostname printed in
the logs.
</pre><a class="anchor" name="log-tag"></a><a class="anchor" name="3-log-tag"></a><a class="anchor" name="3.1-log-tag"></a><a class="anchor" name="log-tag (Global parameters)"></a><a class="anchor" name="log-tag (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="log-tag"></a><a href="#3.1-log-tag">log-tag</a></b> <span style="color: #080">&lt;string&gt;</span></div><pre class="text">Sets the tag field in the syslog header to this string. It defaults to the
program name as launched from the command line, which usually is &quot;haproxy&quot;.
Sometimes it can be useful to differentiate between multiple processes
running on the same host. See also the per-proxy &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log-tag<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log-tag%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log-tag%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#log-tag%20%28Log%20profiles%29">Log profiles</a></li></ul></span>&quot; directive.
</pre><a class="anchor" name="lua-load"></a><a class="anchor" name="3-lua-load"></a><a class="anchor" name="3.1-lua-load"></a><a class="anchor" name="lua-load (Global parameters)"></a><a class="anchor" name="lua-load (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="lua-load"></a><a href="#3.1-lua-load">lua-load</a></b> <span style="color: #080">&lt;file&gt;</span> <span style="color: #008">[ <span style="color: #080">&lt;arg1&gt;</span> <span style="color: #008">[ <span style="color: #080">&lt;arg2&gt;</span> <span style="color: #008">[ ... ]</span> ]</span> ]</span></div><pre class="text">This global directive loads and executes a Lua file in the shared context
that is visible to all threads. Any variable set in such a context is visible
from any thread. This is the easiest and recommended way to load Lua programs
but it will not scale well if a lot of Lua calls are performed, as only one
thread may be running on the global state at a time. A program loaded this
way will always see 0 in the &quot;core.thread&quot; variable. This directive can be
used multiple times.

args are available in the lua file using the code below in the body of the
file. Do not forget that Lua arrays start at index 1. A &quot;local&quot; variable
declared in a file is available in the entire file and not available on
other files.

   local args = table.pack(...)
</pre><a class="anchor" name="lua-load-per-thread"></a><a class="anchor" name="3-lua-load-per-thread"></a><a class="anchor" name="3.1-lua-load-per-thread"></a><a class="anchor" name="lua-load-per-thread (Global parameters)"></a><a class="anchor" name="lua-load-per-thread (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="lua-load-per-thread"></a><a href="#3.1-lua-load-per-thread">lua-load-per-thread</a></b> <span style="color: #080">&lt;file&gt;</span> <span style="color: #008">[ <span style="color: #080">&lt;arg1&gt;</span> <span style="color: #008">[ <span style="color: #080">&lt;arg2&gt;</span> <span style="color: #008">[ ... ]</span> ]</span> ]</span></div><pre class="text">This global directive loads and executes a Lua file into each started thread.
Any global variable has a thread-local visibility so that each thread could
see a different value. As such it is strongly recommended not to use global
variables in programs loaded this way. An independent copy is loaded and
initialized for each thread, everything is done sequentially and in the
thread's numeric order from 1 to nbthread. If some operations need to be
performed only once, the program should check the &quot;core.thread&quot; variable to
figure what thread is being initialized. Programs loaded this way will run
concurrently on all threads and will be highly scalable. This is the
recommended way to load simple functions that register sample-fetches,
converters, actions or services once it is certain the program doesn't depend
on global variables. For the sake of simplicity, the directive is available
even if only one thread is used and even if threads are disabled (in which
case it will be equivalent to lua-load). This directive can be used multiple
times.

See lua-load for usage of args.
</pre><a class="anchor" name="lua-prepend-path"></a><a class="anchor" name="3-lua-prepend-path"></a><a class="anchor" name="3.1-lua-prepend-path"></a><a class="anchor" name="lua-prepend-path (Global parameters)"></a><a class="anchor" name="lua-prepend-path (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="lua-prepend-path"></a><a href="#3.1-lua-prepend-path">lua-prepend-path</a></b> <span style="color: #080">&lt;string&gt;</span> <span style="color: #008">[<span style="color: #080">&lt;type&gt;</span>]</span></div><pre class="text">Prepends the given string followed by a semicolon to Lua's package.&lt;type&gt;
variable.
&lt;type&gt; must either be &quot;<a href="#path">path</a>&quot; or &quot;cpath&quot;. If &lt;type&gt; is not given it defaults
to &quot;<a href="#path">path</a>&quot;.

Lua's paths are semicolon delimited lists of patterns that specify how the
`require` function attempts to find the source file of a library. Question
marks (?) within a pattern will be replaced by module name. The path is
evaluated left to right. This implies that paths that are prepended later
will be checked earlier.

As an example by specifying the following path:

  lua-prepend-path /usr/share/haproxy-lua/?/init.lua
  lua-prepend-path /usr/share/haproxy-lua/?.lua

When `require &quot;example&quot;` is being called Lua will first attempt to load the
/usr/share/haproxy-lua/example.lua script, if that does not exist the
/usr/share/haproxy-lua/example/init.lua will be attempted and the default
paths if that does not exist either.

See https://www.lua.org/pil/8.1.html for the details within the Lua
documentation.
</pre><a class="anchor" name="master-worker"></a><a class="anchor" name="3-master-worker"></a><a class="anchor" name="3.1-master-worker"></a><a class="anchor" name="master-worker (Global parameters)"></a><a class="anchor" name="master-worker (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="master-worker"></a><a href="#3.1-master-worker">master-worker</a></b> <span style="color: #008">[no-exit-on-failure]</span></div><pre class="text">Master-worker mode. It is equivalent to the command line &quot;-W&quot; argument.

This mode will launch a &quot;master&quot; which will fork a &quot;worker&quot; after reading the
configuration to process the traffic. The master is used as a process manager
which will monitor the &quot;workers&quot;.

Using this mode, you can reload HAProxy directly by sending a SIGUSR2 signal
to the master. Reloading will ask the master to read the configuration again
and fork a new worker. The previous worker will be kept until the end of its
jobs.

The master-worker mode is compatible either with the foreground or daemon
mode.

By default, if a worker exits with a bad return code, in the case of a
segfault for example, all workers will be killed, and the master will leave.
It is convenient to combine this behavior with Restart=on-failure in a
systemd unit file in order to relaunch the whole process. If you don't want
this behavior, you must use the keyword &quot;no-exit-on-failure&quot;.

See also &quot;-W&quot; in the management guide.
</pre><a class="anchor" name="mworker-max-reloads"></a><a class="anchor" name="3-mworker-max-reloads"></a><a class="anchor" name="3.1-mworker-max-reloads"></a><a class="anchor" name="mworker-max-reloads (Global parameters)"></a><a class="anchor" name="mworker-max-reloads (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="mworker-max-reloads"></a><a href="#3.1-mworker-max-reloads">mworker-max-reloads</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">In master-worker mode, this option limits the number of time a worker can
survive to a reload. If the worker did not leave after a reload, once its
number of reloads is greater than this number, the worker will receive a
SIGTERM. This option helps to keep under control the number of workers.
See also &quot;show proc&quot; in the Management Guide.
</pre><a class="anchor" name="nbthread"></a><a class="anchor" name="3-nbthread"></a><a class="anchor" name="3.1-nbthread"></a><a class="anchor" name="nbthread (Global parameters)"></a><a class="anchor" name="nbthread (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="nbthread"></a><a href="#3.1-nbthread">nbthread</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">This setting is only available when support for threads was built in. It
makes HAProxy run on &lt;number&gt; threads. &quot;<a href="#nbthread">nbthread</a>&quot; also works when HAProxy is
started in foreground. On some platforms supporting CPU affinity, the default
&quot;<a href="#nbthread">nbthread</a>&quot; value is automatically set to the number of CPUs the process is
bound to upon startup. This means that the thread count can easily be
adjusted from the calling process using commands like &quot;taskset&quot; or &quot;cpuset&quot;.
Otherwise, this value defaults to 1. The default value is reported in the
output of &quot;haproxy -vv&quot;. Note that values set here or automatically detected
are subject to the limit set by &quot;<a href="#thread-hard-limit">thread-hard-limit</a>&quot; (if set).
</pre><a class="anchor" name="no-quic"></a><a class="anchor" name="3-no-quic"></a><a class="anchor" name="3.1-no-quic"></a><a class="anchor" name="no-quic (Global parameters)"></a><a class="anchor" name="no-quic (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="no-quic"></a><a href="#3.1-no-quic">no-quic</a></b></div><pre class="text">Disable QUIC transport protocol. All the QUIC listeners will still be created.
But they will not bind their addresses. Hence, no QUIC traffic will be
processed by haproxy. See also &quot;<a href="#quic_enabled">quic_enabled</a>&quot; sample fetch.
</pre><a class="anchor" name="numa-cpu-mapping"></a><a class="anchor" name="3-numa-cpu-mapping"></a><a class="anchor" name="3.1-numa-cpu-mapping"></a><a class="anchor" name="numa-cpu-mapping (Global parameters)"></a><a class="anchor" name="numa-cpu-mapping (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="numa-cpu-mapping"></a><a href="#3.1-numa-cpu-mapping">numa-cpu-mapping</a></b></div><pre class="text">If running on a NUMA-aware platform, HAProxy inspects on startup the CPU
topology of the machine. If a multi-socket machine is detected, the affinity
is automatically calculated to run on the CPUs of a single node. This is done
in order to not suffer from the performance penalties caused by the
inter-socket bus latency. However, if the applied binding is non optimal on a
particular architecture, it can be disabled with the statement 'no
numa-cpu-mapping'. This automatic binding is also not applied if a nbthread
statement is present in the configuration, or the affinity of the process is
already specified, for example via the 'cpu-map' directive or the taskset
utility.
</pre><a class="anchor" name="ocsp-update.disable"></a><a class="anchor" name="3-ocsp-update.disable"></a><a class="anchor" name="3.1-ocsp-update.disable"></a><a class="anchor" name="ocsp-update.disable (Global parameters)"></a><a class="anchor" name="ocsp-update.disable (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ocsp-update.disable"></a><a href="#3.1-ocsp-update.disable">ocsp-update.disable</a></b> <span style="color: #008">[ on | off ]</span></div><pre class="text">Disable completely the ocsp-update in HAProxy. Any ocsp-update configuration
will be ignored. Default is &quot;off&quot;.
See option &quot;<a href="#ocsp-update">ocsp-update</a>&quot; for more information about the auto update
mechanism.
</pre><a class="anchor" name="ocsp-update.httpproxy"></a><a class="anchor" name="3-ocsp-update.httpproxy"></a><a class="anchor" name="3.1-ocsp-update.httpproxy"></a><a class="anchor" name="ocsp-update.httpproxy (Global parameters)"></a><a class="anchor" name="ocsp-update.httpproxy (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ocsp-update.httpproxy"></a><a href="#3.1-ocsp-update.httpproxy">ocsp-update.httpproxy</a></b> <span style="color: #080">&lt;address&gt;</span><span style="color: #008">[:port]</span></div><pre class="text">Allow to use an HTTP proxy for the OCSP updates. This only works with HTTP,
HTTPS is not supported. This option will allow the OCSP updater to send
absolute URI in the request to the proxy.
</pre><a class="anchor" name="ocsp-update.maxdelay"></a><a class="anchor" name="3-ocsp-update.maxdelay"></a><a class="anchor" name="3.1-ocsp-update.maxdelay"></a><a class="anchor" name="ocsp-update.maxdelay (Global parameters)"></a><a class="anchor" name="ocsp-update.maxdelay (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ocsp-update.maxdelay"></a><a href="#3.1-ocsp-update.maxdelay">ocsp-update.maxdelay</a></b> <span style="color: #080">&lt;number&gt;</span></div><a class="anchor" name="tune.ssl.ocsp-update.maxdelay"></a><a class="anchor" name="3-tune.ssl.ocsp-update.maxdelay"></a><a class="anchor" name="3.1-tune.ssl.ocsp-update.maxdelay"></a><a class="anchor" name="tune.ssl.ocsp-update.maxdelay (Global parameters)"></a><a class="anchor" name="tune.ssl.ocsp-update.maxdelay (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="tune.ssl.ocsp-update.maxdelay"></a><a href="#3.1-tune.ssl.ocsp-update.maxdelay">tune.ssl.ocsp-update.maxdelay</a></b> <span style="color: #080">&lt;number&gt;</span> <span class="label label-warning">(deprecated)</span></div><pre class="text">Sets the maximum interval between two automatic updates of the same OCSP
response. This time is expressed in seconds and defaults to 3600 (1 hour). It
must be set to a higher value than &quot;<a href="#ocsp-update.mindelay">ocsp-update.mindelay</a>&quot;. See
option &quot;<a href="#ocsp-update">ocsp-update</a>&quot; for more information about the auto update mechanism.
</pre><a class="anchor" name="ocsp-update.mindelay"></a><a class="anchor" name="3-ocsp-update.mindelay"></a><a class="anchor" name="3.1-ocsp-update.mindelay"></a><a class="anchor" name="ocsp-update.mindelay (Global parameters)"></a><a class="anchor" name="ocsp-update.mindelay (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ocsp-update.mindelay"></a><a href="#3.1-ocsp-update.mindelay">ocsp-update.mindelay</a></b> <span style="color: #080">&lt;number&gt;</span></div><a class="anchor" name="tune.ssl.ocsp-update.mindelay"></a><a class="anchor" name="3-tune.ssl.ocsp-update.mindelay"></a><a class="anchor" name="3.1-tune.ssl.ocsp-update.mindelay"></a><a class="anchor" name="tune.ssl.ocsp-update.mindelay (Global parameters)"></a><a class="anchor" name="tune.ssl.ocsp-update.mindelay (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="tune.ssl.ocsp-update.mindelay"></a><a href="#3.1-tune.ssl.ocsp-update.mindelay">tune.ssl.ocsp-update.mindelay</a></b> <span style="color: #080">&lt;number&gt;</span> <span class="label label-warning">(deprecated)</span></div><pre class="text">Sets the minimum interval between two automatic updates of the same OCSP
response. This time is expressed in seconds and defaults to 300 (5 minutes).
It is particularly useful for OCSP response that do not have explicit
expiration times. It must be set to a lower value than
&quot;<a href="#ocsp-update.maxdelay">ocsp-update.maxdelay</a>&quot;. See option &quot;<a href="#ocsp-update">ocsp-update</a>&quot; for more
information about the auto update mechanism.
</pre><a class="anchor" name="ocsp-update.mode"></a><a class="anchor" name="3-ocsp-update.mode"></a><a class="anchor" name="3.1-ocsp-update.mode"></a><a class="anchor" name="ocsp-update.mode (Global parameters)"></a><a class="anchor" name="ocsp-update.mode (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ocsp-update.mode"></a><a href="#3.1-ocsp-update.mode">ocsp-update.mode</a></b> <span style="color: #008">[ on | off ]</span></div><pre class="text">Sets the default ocsp-update mode for all certificates used in the
configuration. This global option can be superseded by the crt-list
&quot;<a href="#ocsp-update">ocsp-update</a>&quot; option. This option is set to &quot;off&quot; by default.
See option &quot;<a href="#ocsp-update">ocsp-update</a>&quot; for more information about the auto update
mechanism.
</pre><a class="anchor" name="pidfile"></a><a class="anchor" name="3-pidfile"></a><a class="anchor" name="3.1-pidfile"></a><a class="anchor" name="pidfile (Global parameters)"></a><a class="anchor" name="pidfile (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="pidfile"></a><a href="#3.1-pidfile">pidfile</a></b> <span style="color: #080">&lt;pidfile&gt;</span></div><pre class="text">Writes PIDs of all daemons into file &lt;pidfile&gt; when daemon mode or writes PID
of master process into file &lt;pidfile&gt; when master-worker mode. This option is
equivalent to the &quot;-p&quot; command line argument. The file must be accessible to
the user starting the process. See also &quot;<a href="#daemon">daemon</a>&quot; and &quot;<a href="#master-worker">master-worker</a>&quot;.
</pre><a class="anchor" name="pp2-never-send-local"></a><a class="anchor" name="3-pp2-never-send-local"></a><a class="anchor" name="3.1-pp2-never-send-local"></a><a class="anchor" name="pp2-never-send-local (Global parameters)"></a><a class="anchor" name="pp2-never-send-local (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="pp2-never-send-local"></a><a href="#3.1-pp2-never-send-local">pp2-never-send-local</a></b></div><pre class="text">A bug in the PROXY protocol v2 implementation was present in HAProxy up to
version 2.1, causing it to emit a PROXY command instead of a LOCAL command
for health checks. This is particularly minor but confuses some servers'
logs. Sadly, the bug was discovered very late and revealed that some servers
which possibly only tested their PROXY protocol implementation against
HAProxy fail to properly handle the LOCAL command, and permanently remain in
the &quot;down&quot; state when HAProxy checks them. When this happens, it is possible
to enable this global option to revert to the older (bogus) behavior for the
time it takes to contact the affected components' vendors and get them fixed.
This option is disabled by default and acts on all servers having the
&quot;<a href="#send-proxy-v2">send-proxy-v2</a>&quot; statement.
</pre><a class="anchor" name="presetenv"></a><a class="anchor" name="3-presetenv"></a><a class="anchor" name="3.1-presetenv"></a><a class="anchor" name="presetenv (Global parameters)"></a><a class="anchor" name="presetenv (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="presetenv"></a><a href="#3.1-presetenv">presetenv</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #080">&lt;value&gt;</span></div><pre class="text">Sets environment variable &lt;name&gt; to value &lt;value&gt;. If the variable exists, it
is NOT overwritten. The changes immediately take effect so that the next line
in the configuration file sees the new value. See also &quot;<a href="#setenv">setenv</a>&quot;, &quot;<a href="#resetenv">resetenv</a>&quot;,
and &quot;<a href="#unsetenv">unsetenv</a>&quot;.
</pre><a class="anchor" name="prealloc-fd"></a><a class="anchor" name="3-prealloc-fd"></a><a class="anchor" name="3.1-prealloc-fd"></a><a class="anchor" name="prealloc-fd (Global parameters)"></a><a class="anchor" name="prealloc-fd (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="prealloc-fd"></a><a href="#3.1-prealloc-fd">prealloc-fd</a></b></div><pre class="text">Performs a one-time open of the maximum file descriptor which results in a
pre-allocation of the kernel's data structures. This prevents short pauses
when nbthread&gt;1 and HAProxy opens a file descriptor which requires the kernel
to expand its data structures.
</pre><a class="anchor" name="resetenv"></a><a class="anchor" name="3-resetenv"></a><a class="anchor" name="3.1-resetenv"></a><a class="anchor" name="resetenv (Global parameters)"></a><a class="anchor" name="resetenv (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="resetenv"></a><a href="#3.1-resetenv">resetenv</a></b> <span style="color: #008">[<span style="color: #080">&lt;name&gt;</span> ...]</span></div><pre class="text">Removes all environment variables except the ones specified in argument. It
allows to use a clean controlled environment before setting new values with
setenv or unsetenv. Please note that some internal functions may make use of
some environment variables, such as time manipulation functions, but also
OpenSSL or even external checks. This must be used with extreme care and only
after complete validation. The changes immediately take effect so that the
next line in the configuration file sees the new environment. See also
&quot;<a href="#setenv">setenv</a>&quot;, &quot;<a href="#presetenv">presetenv</a>&quot;, and &quot;<a href="#unsetenv">unsetenv</a>&quot;.
</pre><a class="anchor" name="server-state-base"></a><a class="anchor" name="3-server-state-base"></a><a class="anchor" name="3.1-server-state-base"></a><a class="anchor" name="server-state-base (Global parameters)"></a><a class="anchor" name="server-state-base (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="server-state-base"></a><a href="#3.1-server-state-base">server-state-base</a></b> <span style="color: #080">&lt;directory&gt;</span></div><pre class="text">Specifies the directory prefix to be prepended in front of all servers state
file names which do not start with a '/'. See also &quot;<a href="#server-state-file">server-state-file</a>&quot;,
&quot;<a href="#load-server-state-from-file">load-server-state-from-file</a>&quot; and &quot;<a href="#server-state-file-name">server-state-file-name</a>&quot;.
</pre><a class="anchor" name="server-state-file"></a><a class="anchor" name="3-server-state-file"></a><a class="anchor" name="3.1-server-state-file"></a><a class="anchor" name="server-state-file (Global parameters)"></a><a class="anchor" name="server-state-file (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="server-state-file"></a><a href="#3.1-server-state-file">server-state-file</a></b> <span style="color: #080">&lt;file&gt;</span></div><pre class="text">Specifies the path to the file containing state of servers. If the path starts
with a slash ('/'), it is considered absolute, otherwise it is considered
relative to the directory specified using &quot;<a href="#server-state-base">server-state-base</a>&quot; (if set) or to
the current directory. Before reloading HAProxy, it is possible to save the
servers' current state using the stats command &quot;show servers state&quot;. The
output of this command must be written in the file pointed by &lt;file&gt;. When
starting up, before handling traffic, HAProxy will read, load and apply state
for each server found in the file and available in its current running
configuration. See also &quot;<a href="#server-state-base">server-state-base</a>&quot; and &quot;show servers state&quot;,
&quot;<a href="#load-server-state-from-file">load-server-state-from-file</a>&quot; and &quot;<a href="#server-state-file-name">server-state-file-name</a>&quot;
</pre><a class="anchor" name="set-dumpable"></a><a class="anchor" name="3-set-dumpable"></a><a class="anchor" name="3.1-set-dumpable"></a><a class="anchor" name="set-dumpable (Global parameters)"></a><a class="anchor" name="set-dumpable (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="set-dumpable"></a><a href="#3.1-set-dumpable">set-dumpable</a></b></div><pre class="text">This option is better left disabled by default and enabled only upon a
developer's request. If it has been enabled, it may still be forcibly
disabled by prefixing it with the &quot;no&quot; keyword. It has no impact on
performance nor stability but will try hard to re-enable core dumps that were
possibly disabled by file size limitations (ulimit -f), core size limitations
(ulimit -c), or &quot;dumpability&quot; of a process after changing its UID/GID (such
as /proc/sys/fs/suid_dumpable on Linux). Core dumps might still be limited by
the current directory's permissions (check what directory the file is started
from), the chroot directory's permission (it may be needed to temporarily
disable the chroot directive or to move it to a dedicated writable location),
or any other system-specific constraint. For example, some Linux flavours are
notorious for replacing the default core file with a path to an executable
not even installed on the system (check /proc/sys/kernel/core_pattern). Often,
simply writing &quot;core&quot;, &quot;core.%p&quot; or &quot;/var/log/core/core.%p&quot; addresses the
issue. When trying to enable this option waiting for a rare issue to
re-appear, it's often a good idea to first try to obtain such a dump by
issuing, for example, &quot;kill -11&quot; to the &quot;haproxy&quot; process and verify that it
leaves a core where expected when dying.
</pre><a class="anchor" name="set-var"></a><a class="anchor" name="3-set-var"></a><a class="anchor" name="3.1-set-var"></a><a class="anchor" name="set-var (Global parameters)"></a><a class="anchor" name="set-var (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="set-var"></a><a href="#3.1-set-var">set-var</a></b> <span style="color: #080">&lt;var-name&gt;</span> <span style="color: #080">&lt;expr&gt;</span></div><pre class="text">Sets the process-wide variable '&lt;var-name&gt;' to the result of the evaluation
of the sample expression &lt;expr&gt;. The variable '&lt;var-name&gt;' may only be a
process-wide variable (using the 'proc.' prefix). It works exactly like the
'set-var' action in TCP or HTTP rules except that the expression is evaluated
at configuration parsing time and that the variable is instantly set. The
sample fetch functions and converters permitted in the expression are only
those using internal data, typically 'int(value)' or 'str(value)'. It is
possible to reference previously allocated variables as well. These variables
will then be readable (and modifiable) from the regular rule sets.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>global
    set-var proc.current_state str(primary)
    set-var proc.prio int(100)
    set-var proc.threshold int(200),sub(proc.prio)
</code></pre>
</div><a class="anchor" name="set-var-fmt"></a><a class="anchor" name="3-set-var-fmt"></a><a class="anchor" name="3.1-set-var-fmt"></a><a class="anchor" name="set-var-fmt (Global parameters)"></a><a class="anchor" name="set-var-fmt (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="set-var-fmt"></a><a href="#3.1-set-var-fmt">set-var-fmt</a></b> <span style="color: #080">&lt;var-name&gt;</span> <span style="color: #080">&lt;fmt&gt;</span></div><pre class="text">Sets the process-wide variable '&lt;var-name&gt;' to the string resulting from the
evaluation of the log-format &lt;fmt&gt;. The variable '&lt;var-name&gt;' may only be a
process-wide variable (using the 'proc.' prefix). It works exactly like the
'set-var-fmt' action in TCP or HTTP rules except that the expression is
evaluated at configuration parsing time and that the variable is instantly
set. The sample fetch functions and converters permitted in the expression
are only those using internal data, typically 'int(value)' or 'str(value)'.
It is possible to reference previously allocated variables as well. These
variables will then be readable (and modifiable) from the regular rule sets.
Please see <a href="#8.2.6">section 8.2.6</a> for details on the Custom log format syntax.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>global
    set-var-fmt proc.current_state &quot;primary&quot;
    set-var-fmt proc.bootid        &quot;%pid|%t&quot;
</code></pre>
</div><a class="anchor" name="setcap"></a><a class="anchor" name="3-setcap"></a><a class="anchor" name="3.1-setcap"></a><a class="anchor" name="setcap (Global parameters)"></a><a class="anchor" name="setcap (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="setcap"></a><a href="#3.1-setcap">setcap</a></b> <span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;name&gt;</span>...]</span></div><pre class="text">Sets a list of capabilities that must be preserved when starting and running
either as a non-root user (uid &gt; 0), or when starting with uid 0 (root)
and switching then to a non-root. By default all permissions are
lost by the uid switch, but some are often needed when trying to connect to
a server from a foreign address during transparent proxying, or when binding
to a port below 1024, e.g. when using &quot;tune.quic.socket-owner connection&quot;,
resulting in setups running entirely under uid 0. Setting capabilities
generally is a safer alternative, as only the required capabilities will be
preserved. The feature is OS-specific and only enabled on Linux when
USE_LINUX_CAP=1 is set at build time. The list of supported capabilities also
depends on the OS and is enumerated by the error message displayed when an
invalid capability name or an empty one is passed. Multiple capabilities may
be passed, delimited by commas. Among those commonly used, &quot;cap_net_raw&quot;
allows to transparently bind to a foreign address, and &quot;cap_net_bind_service&quot;
allows to bind to a privileged port and may be used by QUIC. If the process
is started and run under the same non-root user, needed capabilities should
be set on haproxy binary file with setcap along with this keyword. For more
details about setting capabilities on haproxy binary, please see chapter
13.1 Linux capabilities support in the Management guide.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>global
    setcap cap_net_bind_service,cap_net_admin
</code></pre>
</div><a class="anchor" name="setenv"></a><a class="anchor" name="3-setenv"></a><a class="anchor" name="3.1-setenv"></a><a class="anchor" name="setenv (Global parameters)"></a><a class="anchor" name="setenv (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="setenv"></a><a href="#3.1-setenv">setenv</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #080">&lt;value&gt;</span></div><pre class="text">Sets environment variable &lt;name&gt; to value &lt;value&gt;. If the variable exists, it
is overwritten. The changes immediately take effect so that the next line in
the configuration file sees the new value. See also &quot;<a href="#presetenv">presetenv</a>&quot;, &quot;<a href="#resetenv">resetenv</a>&quot;,
and &quot;<a href="#unsetenv">unsetenv</a>&quot;.
</pre><a class="anchor" name="ssl-default-bind-ciphers"></a><a class="anchor" name="3-ssl-default-bind-ciphers"></a><a class="anchor" name="3.1-ssl-default-bind-ciphers"></a><a class="anchor" name="ssl-default-bind-ciphers (Global parameters)"></a><a class="anchor" name="ssl-default-bind-ciphers (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-default-bind-ciphers"></a><a href="#3.1-ssl-default-bind-ciphers">ssl-default-bind-ciphers</a></b> <span style="color: #080">&lt;ciphers&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It sets
the default string describing the list of cipher algorithms (&quot;cipher suite&quot;)
that are negotiated during the SSL/TLS handshake up to TLSv1.2 for all
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines which do not explicitly define theirs. The format of the string
is defined in &quot;man 1 ciphers&quot; from OpenSSL man pages. For background
information and recommendations see e.g.
(https://wiki.mozilla.org/Security/Server_Side_TLS) and
(https://mozilla.github.io/server-side-tls/ssl-config-generator/). For TLSv1.3
cipher configuration, please check the &quot;<a href="#ssl-default-bind-ciphersuites">ssl-default-bind-ciphersuites</a>&quot; keyword.
Please check the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword for more information.
</pre><a class="anchor" name="ssl-default-bind-ciphersuites"></a><a class="anchor" name="3-ssl-default-bind-ciphersuites"></a><a class="anchor" name="3.1-ssl-default-bind-ciphersuites"></a><a class="anchor" name="ssl-default-bind-ciphersuites (Global parameters)"></a><a class="anchor" name="ssl-default-bind-ciphersuites (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-default-bind-ciphersuites"></a><a href="#3.1-ssl-default-bind-ciphersuites">ssl-default-bind-ciphersuites</a></b> <span style="color: #080">&lt;ciphersuites&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in and
OpenSSL 1.1.1 or later was used to build HAProxy. It sets the default string
describing the list of cipher algorithms (&quot;cipher suite&quot;) that are negotiated
during the TLSv1.3 handshake for all &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines which do not explicitly define
theirs. The format of the string is defined in
&quot;man 1 ciphers&quot; from OpenSSL man pages under the section &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ciphersuites<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ciphersuites%20%28Bind%20options%29">Bind options</a></li><li><a href="#ciphersuites%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;. For
cipher configuration for TLSv1.2 and earlier, please check the
&quot;<a href="#ssl-default-bind-ciphers">ssl-default-bind-ciphers</a>&quot; keyword. This setting might accept TLSv1.2
ciphersuites however this is an undocumented behavior and not recommended as
it could be inconsistent or buggy.
The default TLSv1.3 ciphersuites of OpenSSL are:
&quot;TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256&quot;

TLSv1.3 only supports 5 ciphersuites:

- TLS_AES_128_GCM_SHA256
- TLS_AES_256_GCM_SHA384
- TLS_CHACHA20_POLY1305_SHA256
- TLS_AES_128_CCM_SHA256
- TLS_AES_128_CCM_8_SHA256

Please check the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword for more information.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>global
    ssl-default-bind-ciphers ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-RSA-AES128-GCM-SHA256
    ssl-default-bind-ciphersuites TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256
</code></pre>
</div><a class="anchor" name="ssl-default-bind-client-sigalgs"></a><a class="anchor" name="3-ssl-default-bind-client-sigalgs"></a><a class="anchor" name="3.1-ssl-default-bind-client-sigalgs"></a><a class="anchor" name="ssl-default-bind-client-sigalgs (Global parameters)"></a><a class="anchor" name="ssl-default-bind-client-sigalgs (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-default-bind-client-sigalgs"></a><a href="#3.1-ssl-default-bind-client-sigalgs">ssl-default-bind-client-sigalgs</a></b> <span style="color: #080">&lt;sigalgs&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It sets
the default string describing the list of signature algorithms related to
client authentication for all &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines which do not explicitly define
theirs. The format of the string is a colon-delimited list of signature
algorithms. Each signature algorithm can use one of two forms: TLS1.3 signature
scheme names (&quot;rsa_pss_rsae_sha256&quot;) or the public key algorithm + digest form
(&quot;ECDSA+SHA256&quot;). A list can contain both forms. For more information on the
format, see SSL_CTX_set1_client_sigalgs(3). A list of signature algorithms is
also available in RFC8446 <a href="#4.2.3">section 4.2.3</a> and in OpenSSL in the ssl/t1_lib.c
file.  This setting is not applicable to TLSv1.1 and earlier versions of the
protocol as the signature algorithms aren't separately negotiated in these
versions. It is not recommended to change this setting unless compatibility
with a middlebox is required.
</pre><a class="anchor" name="ssl-default-bind-curves"></a><a class="anchor" name="3-ssl-default-bind-curves"></a><a class="anchor" name="3.1-ssl-default-bind-curves"></a><a class="anchor" name="ssl-default-bind-curves (Global parameters)"></a><a class="anchor" name="ssl-default-bind-curves (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-default-bind-curves"></a><a href="#3.1-ssl-default-bind-curves">ssl-default-bind-curves</a></b> <span style="color: #080">&lt;curves&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It sets
the default string describing the list of elliptic curves algorithms (&quot;curve
suite&quot;) that are negotiated during the SSL/TLS handshake with ECDHE. The format
of the string is a colon-delimited list of curve name.
Please check the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword for more information.
</pre><a class="anchor" name="ssl-default-bind-options"></a><a class="anchor" name="3-ssl-default-bind-options"></a><a class="anchor" name="3.1-ssl-default-bind-options"></a><a class="anchor" name="ssl-default-bind-options (Global parameters)"></a><a class="anchor" name="ssl-default-bind-options (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-default-bind-options"></a><a href="#3.1-ssl-default-bind-options">ssl-default-bind-options</a></b> <span style="color: #008">[<span style="color: #080">&lt;option&gt;</span>]</span>...</div><pre class="text">This setting is only available when support for OpenSSL was built in. It sets
default ssl-options to force on all &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines. Please check the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;
keyword to see available options.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>global
   ssl-default-bind-options ssl-min-ver TLSv1.0 no-tls-tickets
</code></pre>
</div><a class="anchor" name="ssl-default-bind-sigalgs"></a><a class="anchor" name="3-ssl-default-bind-sigalgs"></a><a class="anchor" name="3.1-ssl-default-bind-sigalgs"></a><a class="anchor" name="ssl-default-bind-sigalgs (Global parameters)"></a><a class="anchor" name="ssl-default-bind-sigalgs (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-default-bind-sigalgs"></a><a href="#3.1-ssl-default-bind-sigalgs">ssl-default-bind-sigalgs</a></b> <span style="color: #080">&lt;sigalgs&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It
sets the default string describing the list of signature algorithms that
are negotiated during the TLSv1.2 and TLSv1.3 handshake for all &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines
which do not explicitly define theirs. The format of the string is a
colon-delimited list of signature algorithms. Each signature algorithm can
use one of two forms: TLS1.3 signature scheme names (&quot;rsa_pss_rsae_sha256&quot;)
or the public key algorithm + digest form (&quot;ECDSA+SHA256&quot;). A list
can contain both forms. For more information on the format,
see SSL_CTX_set1_sigalgs(3). A list of signature algorithms is also
available in RFC8446 <a href="#4.2.3">section 4.2.3</a> and in OpenSSL in the ssl/t1_lib.c file.
This setting is not applicable to TLSv1.1 and earlier versions of the
protocol as the signature algorithms aren't separately negotiated in these
versions. It is not recommended to change this setting unless compatibility
with a middlebox is required.
</pre><a class="anchor" name="ssl-default-server-ciphers"></a><a class="anchor" name="3-ssl-default-server-ciphers"></a><a class="anchor" name="3.1-ssl-default-server-ciphers"></a><a class="anchor" name="ssl-default-server-ciphers (Global parameters)"></a><a class="anchor" name="ssl-default-server-ciphers (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-default-server-ciphers"></a><a href="#3.1-ssl-default-server-ciphers">ssl-default-server-ciphers</a></b> <span style="color: #080">&lt;ciphers&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It
sets the default string describing the list of cipher algorithms that are
negotiated during the SSL/TLS handshake up to TLSv1.2 with the server,
for all &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines which do not explicitly define theirs. The format of
the string is defined in &quot;man 1 ciphers&quot; from OpenSSL man pages. For background
information and recommendations see e.g.
(https://wiki.mozilla.org/Security/Server_Side_TLS) and
(https://mozilla.github.io/server-side-tls/ssl-config-generator/).
For TLSv1.3 cipher configuration, please check the
&quot;<a href="#ssl-default-server-ciphersuites">ssl-default-server-ciphersuites</a>&quot; keyword. Please check the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword
for more information.
</pre><a class="anchor" name="ssl-default-server-ciphersuites"></a><a class="anchor" name="3-ssl-default-server-ciphersuites"></a><a class="anchor" name="3.1-ssl-default-server-ciphersuites"></a><a class="anchor" name="ssl-default-server-ciphersuites (Global parameters)"></a><a class="anchor" name="ssl-default-server-ciphersuites (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-default-server-ciphersuites"></a><a href="#3.1-ssl-default-server-ciphersuites">ssl-default-server-ciphersuites</a></b> <span style="color: #080">&lt;ciphersuites&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in and
OpenSSL 1.1.1 or later was used to build HAProxy. It sets the default
string describing the list of cipher algorithms that are negotiated during
the TLSv1.3 handshake with the server, for all &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines which do not
explicitly define theirs. The format of the string is defined in
&quot;man 1 ciphers&quot; from OpenSSL man pages under the section &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ciphersuites<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ciphersuites%20%28Bind%20options%29">Bind options</a></li><li><a href="#ciphersuites%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;. For
cipher configuration for TLSv1.2 and earlier, please check the
&quot;<a href="#ssl-default-server-ciphers">ssl-default-server-ciphers</a>&quot; keyword. Please check the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword for
more information.
</pre><a class="anchor" name="ssl-default-server-client-sigalgs"></a><a class="anchor" name="3-ssl-default-server-client-sigalgs"></a><a class="anchor" name="3.1-ssl-default-server-client-sigalgs"></a><a class="anchor" name="ssl-default-server-client-sigalgs (Global parameters)"></a><a class="anchor" name="ssl-default-server-client-sigalgs (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-default-server-client-sigalgs"></a><a href="#3.1-ssl-default-server-client-sigalgs">ssl-default-server-client-sigalgs</a></b> <span style="color: #080">&lt;sigalgs&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It sets
the default string describing the list of signature algorithms related to
client authentication for all &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines which do not explicitly define
theirs. The format of the string is a colon-delimited list of signature
algorithms. Each signature algorithm can use one of two forms: TLS1.3 signature
scheme names (&quot;rsa_pss_rsae_sha256&quot;) or the public key algorithm + digest form
(&quot;ECDSA+SHA256&quot;). A list can contain both forms. For more information on the
format, see SSL_CTX_set1_client_sigalgs(3). A list of signature algorithms is
also available in RFC8446 <a href="#4.2.3">section 4.2.3</a> and in OpenSSL in the ssl/t1_lib.c
file.  This setting is not applicable to TLSv1.1 and earlier versions of the
protocol as the signature algorithms aren't separately negotiated in these
versions. It is not recommended to change this setting unless compatibility
with a middlebox is required.
</pre><a class="anchor" name="ssl-default-server-curves"></a><a class="anchor" name="3-ssl-default-server-curves"></a><a class="anchor" name="3.1-ssl-default-server-curves"></a><a class="anchor" name="ssl-default-server-curves (Global parameters)"></a><a class="anchor" name="ssl-default-server-curves (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-default-server-curves"></a><a href="#3.1-ssl-default-server-curves">ssl-default-server-curves</a></b> <span style="color: #080">&lt;curves&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It sets
the default string describing the list of elliptic curves algorithms (&quot;curve
suite&quot;) that are negotiated during the SSL/TLS handshake with ECDHE. The format
of the string is a colon-delimited list of curve name.
Please check the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword for more information.
</pre><a class="anchor" name="ssl-default-server-options"></a><a class="anchor" name="3-ssl-default-server-options"></a><a class="anchor" name="3.1-ssl-default-server-options"></a><a class="anchor" name="ssl-default-server-options (Global parameters)"></a><a class="anchor" name="ssl-default-server-options (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-default-server-options"></a><a href="#3.1-ssl-default-server-options">ssl-default-server-options</a></b> <span style="color: #008">[<span style="color: #080">&lt;option&gt;</span>]</span>...</div><pre class="text">This setting is only available when support for OpenSSL was built in. It sets
default ssl-options to force on all &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines. Please check the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;
keyword to see available options.
</pre><a class="anchor" name="ssl-default-server-sigalgs"></a><a class="anchor" name="3-ssl-default-server-sigalgs"></a><a class="anchor" name="3.1-ssl-default-server-sigalgs"></a><a class="anchor" name="ssl-default-server-sigalgs (Global parameters)"></a><a class="anchor" name="ssl-default-server-sigalgs (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-default-server-sigalgs"></a><a href="#3.1-ssl-default-server-sigalgs">ssl-default-server-sigalgs</a></b> <span style="color: #080">&lt;sigalgs&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It
sets the default string describing the list of signature algorithms that
are negotiated during the TLSv1.2 and TLSv1.3 handshake for all &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines
which do not explicitly define theirs. The format of the string is a
colon-delimited list of signature algorithms. Each signature algorithm can
use one of two forms: TLS1.3 signature scheme names (&quot;rsa_pss_rsae_sha256&quot;)
or the public key algorithm + digest form (&quot;ECDSA+SHA256&quot;). A list
can contain both forms. For more information on the format,
see SSL_CTX_set1_sigalgs(3). A list of signature algorithms is also
available in RFC8446 <a href="#4.2.3">section 4.2.3</a> and in OpenSSL in the ssl/t1_lib.c file.
This setting is not applicable to TLSv1.1 and earlier versions of the
protocol as the signature algorithms aren't separately negotiated in these
versions. It is not recommended to change this setting unless compatibility
with a middlebox is required.
</pre><a class="anchor" name="ssl-dh-param-file"></a><a class="anchor" name="3-ssl-dh-param-file"></a><a class="anchor" name="3.1-ssl-dh-param-file"></a><a class="anchor" name="ssl-dh-param-file (Global parameters)"></a><a class="anchor" name="ssl-dh-param-file (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-dh-param-file"></a><a href="#3.1-ssl-dh-param-file">ssl-dh-param-file</a></b> <span style="color: #080">&lt;file&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It sets
the default DH parameters that are used during the SSL/TLS handshake when
ephemeral Diffie-Hellman (DHE) key exchange is used, for all &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines
which do not explicitly define theirs. It will be overridden by custom DH
parameters found in a bind certificate file if any. If custom DH parameters
are not specified either by using ssl-dh-param-file or by setting them
directly in the certificate file, DHE ciphers will not be used, unless
tune.ssl.default-dh-param is set. In this latter case, pre-defined DH
parameters of the specified size will be used. Custom parameters are known to
be more secure and therefore their use is recommended.
Custom DH parameters may be generated by using the OpenSSL command
&quot;openssl dhparam &lt;size&gt;&quot;, where size should be at least 2048, as 1024-bit DH
parameters should not be considered secure anymore.
</pre><a class="anchor" name="ssl-propquery"></a><a class="anchor" name="3-ssl-propquery"></a><a class="anchor" name="3.1-ssl-propquery"></a><a class="anchor" name="ssl-propquery (Global parameters)"></a><a class="anchor" name="ssl-propquery (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-propquery"></a><a href="#3.1-ssl-propquery">ssl-propquery</a></b> <span style="color: #080">&lt;query&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in and when
OpenSSL's version is at least 3.0. It allows to define a default property
string used when fetching algorithms in providers. It behave the same way as
the openssl propquery option and it follows the same syntax (described in
https://www.openssl.org/docs/man3.0/man7/property.html). For instance, if you
have two providers loaded, the foo one and the default one, the propquery
&quot;?provider=foo&quot; allows to pick the algorithm implementations provided by the
foo provider by default, and to fallback on the default provider's one if it
was not found.
</pre><a class="anchor" name="ssl-provider"></a><a class="anchor" name="3-ssl-provider"></a><a class="anchor" name="3.1-ssl-provider"></a><a class="anchor" name="ssl-provider (Global parameters)"></a><a class="anchor" name="ssl-provider (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-provider"></a><a href="#3.1-ssl-provider">ssl-provider</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in and when
OpenSSL's version is at least 3.0. It allows to load a provider during init.
If loading is successful, any capabilities provided by the loaded provider
might be used by HAProxy. Multiple 'ssl-provider' options can be specified in
a configuration file. The providers will be loaded in their order of
appearance.

Please note that loading a provider explicitly prevents OpenSSL from loading
the 'default' provider automatically. OpenSSL also allows to define the
providers that should be loaded directly in its configuration file
(openssl.cnf for instance) so it is not necessary to use this 'ssl-provider'
option to load providers. The &quot;show ssl providers&quot; CLI command can be used to
show all the providers that were successfully loaded.

The default search path of OpenSSL provider can be found in the output of the
&quot;openssl version -a&quot; command. If the provider is in another directory, you
can set the OPENSSL_MODULES environment variable, which takes the directory
where your provider can be found.

See also &quot;<a href="#ssl-propquery">ssl-propquery</a>&quot; and &quot;<a href="#ssl-provider-path">ssl-provider-path</a>&quot;.
</pre><a class="anchor" name="ssl-provider-path"></a><a class="anchor" name="3-ssl-provider-path"></a><a class="anchor" name="3.1-ssl-provider-path"></a><a class="anchor" name="ssl-provider-path (Global parameters)"></a><a class="anchor" name="ssl-provider-path (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-provider-path"></a><a href="#3.1-ssl-provider-path">ssl-provider-path</a></b> <span style="color: #080">&lt;path&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in and when
OpenSSL's version is at least 3.0. It allows to specify the search path that
is to be used by OpenSSL for looking for providers. It behaves the same way
as the OPENSSL_MODULES environment variable. It will be used for any
following 'ssl-provider' option or until a new 'ssl-provider-path' is
defined.
See also &quot;<a href="#ssl-provider">ssl-provider</a>&quot;.
</pre><a class="anchor" name="ssl-load-extra-del-ext"></a><a class="anchor" name="3-ssl-load-extra-del-ext"></a><a class="anchor" name="3.1-ssl-load-extra-del-ext"></a><a class="anchor" name="ssl-load-extra-del-ext (Global parameters)"></a><a class="anchor" name="ssl-load-extra-del-ext (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-load-extra-del-ext"></a><a href="#3.1-ssl-load-extra-del-ext">ssl-load-extra-del-ext</a></b></div><pre class="text">This setting allows to configure the way HAProxy does the lookup for the
extra SSL files. By default HAProxy adds a new extension to the filename.
(ex: with &quot;foobar.crt&quot; load &quot;foobar.crt.key&quot;). With this option enabled,
HAProxy removes the extension before adding the new one (ex: with
&quot;foobar.crt&quot; load &quot;foobar.key&quot;).

Your crt file must have a &quot;.crt&quot; extension for this option to work.

This option is not compatible with bundle extensions (.ecdsa, .rsa. .dsa)
and won't try to remove them.

This option is disabled by default. See also &quot;<a href="#ssl-load-extra-files">ssl-load-extra-files</a>&quot;.
</pre><a class="anchor" name="ssl-load-extra-files"></a><a class="anchor" name="3-ssl-load-extra-files"></a><a class="anchor" name="3.1-ssl-load-extra-files"></a><a class="anchor" name="ssl-load-extra-files (Global parameters)"></a><a class="anchor" name="ssl-load-extra-files (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-load-extra-files"></a><a href="#3.1-ssl-load-extra-files">ssl-load-extra-files</a></b> <span style="color: #080">&lt;none|all|bundle|sctl|ocsp|issuer|key&gt;</span>*</div><pre class="text">This setting alters the way HAProxy will look for unspecified files during
the loading of the SSL certificates. This option applies to certificates
associated to &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines as well as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines but some of the extra
files will not have any functional impact for &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line certificates.

By default, HAProxy discovers automatically a lot of files not specified in
the configuration, and you may want to disable this behavior if you want to
optimize the startup time.

&quot;none&quot;: Only load the files specified in the configuration. Don't try to load
a certificate bundle if the file does not exist. In the case of a directory,
it won't try to bundle the certificates if they have the same basename.

&quot;all&quot;: This is the default behavior, it will try to load everything,
bundles, sctl, ocsp, issuer, key.

&quot;bundle&quot;: When a file specified in the configuration does not exist, HAProxy
will try to load a &quot;cert bundle&quot;. Certificate bundles are only managed on the
frontend side and will not work for backend certificates.

Starting from HAProxy 2.3, the bundles are not loaded in the same OpenSSL
certificate store, instead it will loads each certificate in a separate
store which is equivalent to declaring multiple &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crt<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crt%20%28Load%20options%29">Load options</a></li><li><a href="#crt%20%28Bind%20options%29">Bind options</a></li><li><a href="#crt%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;. OpenSSL 1.1.1 is
required to achieve this. Which means that bundles are now used only for
backward compatibility and are not mandatory anymore to do an hybrid RSA/ECC
bind configuration.

To associate these PEM files into a &quot;cert bundle&quot; that is recognized by
HAProxy, they must be named in the following way: All PEM files that are to
be bundled must have the same base name, with a suffix indicating the key
type. Currently, three suffixes are supported: rsa, dsa and ecdsa. For
example, if www.example.com has two PEM files, an RSA file and an ECDSA
file, they must be named: &quot;example.pem.rsa&quot; and &quot;example.pem.ecdsa&quot;. The
first part of the filename is arbitrary; only the suffix matters. To load
this bundle into HAProxy, specify the base name only:
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>bind :8443 ssl crt example.pem
</code></pre>
</div><pre class="text">Note that the suffix is not given to HAProxy; this tells HAProxy to look for
a cert bundle.

HAProxy will load all PEM files in the bundle as if they were configured
separately in several &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crt<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crt%20%28Load%20options%29">Load options</a></li><li><a href="#crt%20%28Bind%20options%29">Bind options</a></li><li><a href="#crt%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;.

The bundle loading does not have an impact anymore on the directory loading
since files are loading separately.

On the CLI, bundles are seen as separate files, and the bundle extension is
required to commit them.

OCSP files (.ocsp), issuer files (.issuer), Certificate Transparency (.sctl)
as well as private keys (.key) are supported with multi-cert bundling.

&quot;<a href="#sctl">sctl</a>&quot;: Try to load &quot;&lt;basename&gt;.sctl&quot; for each crt keyword. If provided for
a backend certificate, it will be loaded but will not have any functional
impact.

&quot;<a href="#ocsp">ocsp</a>&quot;: Try to load &quot;&lt;basename&gt;.ocsp&quot; for each crt keyword. If provided for
a backend certificate, it will be loaded but will not have any functional
impact.

&quot;<a href="#issuer">issuer</a>&quot;: Try to load &quot;&lt;basename&gt;.issuer&quot; if the issuer of the OCSP file is
not provided in the PEM file. If provided for a backend certificate, it will
be loaded but will not have any functional impact.

&quot;<a href="#key">key</a>&quot;: If the private key was not provided by the PEM file, try to load a
file &quot;&lt;basename&gt;.key&quot; containing a private key.

The default behavior is &quot;all&quot;.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>ssl-load-extra-files bundle sctl
ssl-load-extra-files sctl ocsp issuer
ssl-load-extra-files none
</code></pre>
</div><div class="page-header"><b>See also:</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crt<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crt%20%28Load%20options%29">Load options</a></li><li><a href="#crt%20%28Bind%20options%29">Bind options</a></li><li><a href="#crt%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;, <a href="#5.1">section 5.1</a> about bind options and <a href="#5.2">section 5.2</a> about server options.</div>
<a class="anchor" name="ssl-security-level"></a><a class="anchor" name="3-ssl-security-level"></a><a class="anchor" name="3.1-ssl-security-level"></a><a class="anchor" name="ssl-security-level (Global parameters)"></a><a class="anchor" name="ssl-security-level (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-security-level"></a><a href="#3.1-ssl-security-level">ssl-security-level</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">This directive allows to chose the OpenSSL security level as described in
https://www.openssl.org/docs/man1.1.1/man3/SSL_CTX_set_security_level.html
The security level will be applied to every SSL contextes in HAProxy.
Only a value between 0 and 5 is supported.

The default value depends on your OpenSSL version, distribution and how was
compiled the library.

This directive requires at least OpenSSL 1.1.1.
</pre><a class="anchor" name="ssl-server-verify"></a><a class="anchor" name="3-ssl-server-verify"></a><a class="anchor" name="3.1-ssl-server-verify"></a><a class="anchor" name="ssl-server-verify (Global parameters)"></a><a class="anchor" name="ssl-server-verify (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-server-verify"></a><a href="#3.1-ssl-server-verify">ssl-server-verify</a></b> <span style="color: #008">[none|required]</span></div><pre class="text">The default behavior for SSL verify on servers side. If specified to 'none',
servers certificates are not verified. The default is 'required' except if
forced using cmdline option '-dV'.
</pre><a class="anchor" name="ssl-skip-self-issued-ca"></a><a class="anchor" name="3-ssl-skip-self-issued-ca"></a><a class="anchor" name="3.1-ssl-skip-self-issued-ca"></a><a class="anchor" name="ssl-skip-self-issued-ca (Global parameters)"></a><a class="anchor" name="ssl-skip-self-issued-ca (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ssl-skip-self-issued-ca"></a><a href="#3.1-ssl-skip-self-issued-ca">ssl-skip-self-issued-ca</a></b></div><pre class="text">Self issued CA, aka x509 root CA, is the anchor for chain validation: as a
server is useless to send it, client must have it. Standard configuration
need to not include such CA in PEM file. This option allows you to keep such
CA in PEM file without sending it to the client. Use case is to provide
issuer for ocsp without the need for '.issuer' file and be able to share it
with 'issuers-chain-path'. This concerns all certificates without intermediate
certificates. It's useless for BoringSSL, .issuer is ignored because ocsp
bits does not need it. Requires at least OpenSSL 1.0.2.
</pre><a class="anchor" name="stats"></a><a class="anchor" name="3-stats"></a><a class="anchor" name="3.1-stats"></a><a class="anchor" name="stats (Global parameters)"></a><a class="anchor" name="stats (Process management and security)"></a><a class="anchor" name="stats maxconn"></a><a class="anchor" name="3-stats maxconn"></a><a class="anchor" name="3.1-stats maxconn"></a><a class="anchor" name="stats maxconn (Global parameters)"></a><a class="anchor" name="stats maxconn (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="stats maxconn"></a><a href="#3.1-stats%20maxconn">stats maxconn</a></b> <span style="color: #080">&lt;connections&gt;</span></div><pre class="text">By default, the stats socket is limited to 10 concurrent connections. It is
possible to change this value with &quot;<a href="#stats%20maxconn">stats maxconn</a>&quot;.
</pre><a class="anchor" name="stats"></a><a class="anchor" name="3-stats"></a><a class="anchor" name="3.1-stats"></a><a class="anchor" name="stats (Global parameters)"></a><a class="anchor" name="stats (Process management and security)"></a><a class="anchor" name="stats socket"></a><a class="anchor" name="3-stats socket"></a><a class="anchor" name="3.1-stats socket"></a><a class="anchor" name="stats socket (Global parameters)"></a><a class="anchor" name="stats socket (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="stats socket"></a><a href="#3.1-stats%20socket">stats socket</a></b> <span style="color: #008">[<span style="color: #080">&lt;address:port&gt;</span>|<span style="color: #080">&lt;path&gt;</span>]</span> <span style="color: #008">[param*]</span></div><pre class="text">Binds a UNIX socket to &lt;path&gt; or a TCPv4/v6 address to &lt;address:port&gt;.
Connections to this socket will return various statistics outputs and even
allow some commands to be issued to change some runtime settings. Please
consult <a href="#9.3">section 9.3</a> &quot;Unix Socket commands&quot; of Management Guide for more
details.

All parameters supported by &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines are supported, for instance to
restrict access to some users or their access rights. Please consult
<a href="#5.1">section 5.1</a> for more information.
</pre><a class="anchor" name="stats"></a><a class="anchor" name="3-stats"></a><a class="anchor" name="3.1-stats"></a><a class="anchor" name="stats (Global parameters)"></a><a class="anchor" name="stats (Process management and security)"></a><a class="anchor" name="stats timeout"></a><a class="anchor" name="3-stats timeout"></a><a class="anchor" name="3.1-stats timeout"></a><a class="anchor" name="stats timeout (Global parameters)"></a><a class="anchor" name="stats timeout (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="stats timeout"></a><a href="#3.1-stats%20timeout">stats timeout</a></b> <span style="color: #080">&lt;timeout, in milliseconds&gt;</span></div><pre class="text">The default timeout on the stats socket is set to 10 seconds. It is possible
to change this value with &quot;<a href="#stats%20timeout">stats timeout</a>&quot;. The value must be passed in
milliseconds, or be suffixed by a time unit among { us, ms, s, m, h, d }.
</pre><a class="anchor" name="stats-file"></a><a class="anchor" name="3-stats-file"></a><a class="anchor" name="3.1-stats-file"></a><a class="anchor" name="stats-file (Global parameters)"></a><a class="anchor" name="stats-file (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="stats-file"></a><a href="#3.1-stats-file">stats-file</a></b> <span style="color: #080">&lt;path&gt;</span></div><pre class="text">Path to a generated haproxy stats-file. On startup haproxy will preload the
values to its internal counters. Use the CLI command &quot;dump stats-file&quot; to
produce such stats-file. See the management manual for more details.
</pre><a class="anchor" name="strict-limits"></a><a class="anchor" name="3-strict-limits"></a><a class="anchor" name="3.1-strict-limits"></a><a class="anchor" name="strict-limits (Global parameters)"></a><a class="anchor" name="strict-limits (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="strict-limits"></a><a href="#3.1-strict-limits">strict-limits</a></b></div><pre class="text">Makes process fail at startup when a setrlimit fails. HAProxy tries to set the
best setrlimit according to what has been calculated. If it fails, it will
emit a warning. This option is here to guarantee an explicit failure of
HAProxy when those limits fail. It is enabled by default. It may still be
forcibly disabled by prefixing it with the &quot;no&quot; keyword.
</pre><a class="anchor" name="thread-group"></a><a class="anchor" name="3-thread-group"></a><a class="anchor" name="3.1-thread-group"></a><a class="anchor" name="thread-group (Global parameters)"></a><a class="anchor" name="thread-group (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="thread-group"></a><a href="#3.1-thread-group">thread-group</a></b> <span style="color: #080">&lt;group&gt;</span> <span style="color: #008">[<span style="color: #080">&lt;thread-range&gt;</span>...]</span></div><pre class="text">This setting is only available when support for threads was built in. It
enumerates the list of threads that will compose thread group &lt;group&gt;.
Thread numbers and group numbers start at 1. Thread ranges are defined either
using a single thread number at once, or by specifying the lower and upper
bounds delimited by a dash '-' (e.g. &quot;1-16&quot;). Unassigned threads will be
automatically assigned to unassigned thread groups, and thread groups
defined with this directive will never receive more threads than those
defined. Defining the same group multiple times overrides previous
definitions with the new one. See also &quot;<a href="#nbthread">nbthread</a>&quot; and &quot;<a href="#thread-groups">thread-groups</a>&quot;.
</pre><a class="anchor" name="thread-groups"></a><a class="anchor" name="3-thread-groups"></a><a class="anchor" name="3.1-thread-groups"></a><a class="anchor" name="thread-groups (Global parameters)"></a><a class="anchor" name="thread-groups (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="thread-groups"></a><a href="#3.1-thread-groups">thread-groups</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">This setting is only available when support for threads was built in. It
makes HAProxy split its threads into &lt;number&gt; independent groups. At the
moment, the default value is 1. Thread groups make it possible to reduce
sharing between threads to limit contention, at the expense of some extra
configuration efforts. It is also the only way to use more than 64 threads
since up to 64 threads per group may be configured. The maximum number of
groups is configured at compile time and defaults to 16. See also &quot;<a href="#nbthread">nbthread</a>&quot;.
</pre><a class="anchor" name="thread-hard-limit"></a><a class="anchor" name="3-thread-hard-limit"></a><a class="anchor" name="3.1-thread-hard-limit"></a><a class="anchor" name="thread-hard-limit (Global parameters)"></a><a class="anchor" name="thread-hard-limit (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="thread-hard-limit"></a><a href="#3.1-thread-hard-limit">thread-hard-limit</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">This setting is used to enforce a limit to the number of threads, either
detected, or configured. This is particularly useful on operating systems
where the number of threads is automatically detected, where a number of
threads lower than the number of CPUs is desired in generic and portable
configurations. Indeed, while &quot;<a href="#nbthread">nbthread</a>&quot; enforces a number of threads that
will result in a warning and bad performance if higher than CPUs available,
thread-hard-limit will only cap the maximum value and automatically limit
the number of threads to no higher than this value, but will not raise lower
values. If &quot;<a href="#nbthread">nbthread</a>&quot; is forced to a higher value, thread-hard-limit wins,
and a warning is emitted in so that the configuration anomaly can be
fixed. By default there is no limit. See also &quot;<a href="#nbthread">nbthread</a>&quot;.
</pre><a class="anchor" name="uid"></a><a class="anchor" name="3-uid"></a><a class="anchor" name="3.1-uid"></a><a class="anchor" name="uid (Global parameters)"></a><a class="anchor" name="uid (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="uid"></a><a href="#3.1-uid">uid</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Changes the process's user ID to &lt;number&gt;. It is recommended that the user ID
is dedicated to HAProxy or to a small set of similar daemons. HAProxy must
be started with superuser privileges in order to be able to switch to another
one. See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">gid<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#gid%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#gid%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">user<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#user%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#user%20%28Userlists%29">Userlists</a></li><li><a href="#user%20%28Programs%20%28deprecated%29%29">Programs (deprecated)</a></li><li><a href="#user%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot;.
</pre><a class="anchor" name="ulimit-n"></a><a class="anchor" name="3-ulimit-n"></a><a class="anchor" name="3.1-ulimit-n"></a><a class="anchor" name="ulimit-n (Global parameters)"></a><a class="anchor" name="ulimit-n (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="ulimit-n"></a><a href="#3.1-ulimit-n">ulimit-n</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum number of per-process file-descriptors to &lt;number&gt;. By
default, it is automatically computed, so it is recommended not to use this
option. If the intent is only to limit the number of file descriptors, better
use &quot;<a href="#fd-hard-limit">fd-hard-limit</a>&quot; instead.

Note that the dynamic servers are not taken into account in this automatic
resource calculation. If using a large number of them, it may be needed to
manually specify this value.
</pre><div class="page-header"><b>See also:</b> fd-hard-limit, maxconn</div>
<a class="anchor" name="unix-bind"></a><a class="anchor" name="3-unix-bind"></a><a class="anchor" name="3.1-unix-bind"></a><a class="anchor" name="unix-bind (Global parameters)"></a><a class="anchor" name="unix-bind (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="unix-bind"></a><a href="#3.1-unix-bind">unix-bind</a></b> <span style="color: #008">[ prefix <span style="color: #080">&lt;prefix&gt;</span> ]</span> <span style="color: #008">[ mode <span style="color: #080">&lt;mode&gt;</span> ]</span> <span style="color: #008">[ user <span style="color: #080">&lt;user&gt;</span> ]</span> <span style="color: #008">[ uid <span style="color: #080">&lt;uid&gt;</span> ]</span>
          <span style="color: #008">[ group <span style="color: #080">&lt;group&gt;</span> ]</span> <span style="color: #008">[ gid <span style="color: #080">&lt;gid&gt;</span> ]</span></div><pre class="text">Fixes common settings to UNIX listening sockets declared in &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; statements.
This is mainly used to simplify declaration of those UNIX sockets and reduce
the risk of errors, since those settings are most commonly required but are
also process-specific. The &lt;prefix&gt; setting can be used to force all socket
path to be relative to that directory. This might be needed to access another
component's chroot. Note that those paths are resolved before HAProxy chroots
itself, so they are absolute. The &lt;mode&gt;, &lt;user&gt;, &lt;uid&gt;, &lt;group&gt; and &lt;gid&gt;
all have the same meaning as their homonyms used by the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; statement. If
both are specified, the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; statement has priority, meaning that the
&quot;<a href="#unix-bind">unix-bind</a>&quot; settings may be seen as process-wide default settings.
</pre><a class="anchor" name="unsetenv"></a><a class="anchor" name="3-unsetenv"></a><a class="anchor" name="3.1-unsetenv"></a><a class="anchor" name="unsetenv (Global parameters)"></a><a class="anchor" name="unsetenv (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="unsetenv"></a><a href="#3.1-unsetenv">unsetenv</a></b> <span style="color: #008">[<span style="color: #080">&lt;name&gt;</span> ...]</span></div><pre class="text">Removes environment variables specified in arguments. This can be useful to
hide some sensitive information that are occasionally inherited from the
user's environment during some operations. Variables which did not exist are
silently ignored so that after the operation, it is certain that none of
these variables remain. The changes immediately take effect so that the next
line in the configuration file will not see these variables. See also
&quot;<a href="#setenv">setenv</a>&quot;, &quot;<a href="#presetenv">presetenv</a>&quot;, and &quot;<a href="#resetenv">resetenv</a>&quot;.
</pre><a class="anchor" name="user"></a><a class="anchor" name="3-user"></a><a class="anchor" name="3.1-user"></a><a class="anchor" name="user (Global parameters)"></a><a class="anchor" name="user (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="user"></a><a href="#3.1-user">user</a></b> <span style="color: #080">&lt;user name&gt;</span></div><pre class="text">Similar to &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">uid<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#uid%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#uid%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; but uses the UID of user name &lt;user name&gt; from /etc/passwd.
See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">uid<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#uid%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#uid%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">group<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#group%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#group%20%28Userlists%29">Userlists</a></li><li><a href="#group%20%28Programs%20%28deprecated%29%29">Programs (deprecated)</a></li><li><a href="#group%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot;.
</pre><a class="anchor" name="node"></a><a class="anchor" name="3-node"></a><a class="anchor" name="3.1-node"></a><a class="anchor" name="node (Global parameters)"></a><a class="anchor" name="node (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="node"></a><a href="#3.1-node">node</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">Only letters, digits, hyphen and underscore are allowed, like in DNS names.

This statement is useful in HA configurations where two or more processes or
servers share the same IP address. By setting a different node-name on all
nodes, it becomes easy to immediately spot what server is handling the
traffic.
</pre><a class="anchor" name="wurfl-cache-size"></a><a class="anchor" name="3-wurfl-cache-size"></a><a class="anchor" name="3.1-wurfl-cache-size"></a><a class="anchor" name="wurfl-cache-size (Global parameters)"></a><a class="anchor" name="wurfl-cache-size (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="wurfl-cache-size"></a><a href="#3.1-wurfl-cache-size">wurfl-cache-size</a></b> <span style="color: #080">&lt;size&gt;</span></div><pre class="text">Sets the WURFL Useragent cache size. For faster lookups, already processed user
agents are kept in a LRU cache :
- &quot;0&quot;     : no cache is used.
- &lt;size&gt;  : size of lru cache in elements.

Please note that this option is only available when HAProxy has been compiled
with USE_WURFL=1.
</pre><a class="anchor" name="wurfl-data-file"></a><a class="anchor" name="3-wurfl-data-file"></a><a class="anchor" name="3.1-wurfl-data-file"></a><a class="anchor" name="wurfl-data-file (Global parameters)"></a><a class="anchor" name="wurfl-data-file (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="wurfl-data-file"></a><a href="#3.1-wurfl-data-file">wurfl-data-file</a></b> <span style="color: #080">&lt;file path&gt;</span></div><pre class="text">The path of the WURFL data file to provide device detection services. The
file should be accessible by HAProxy with relevant permissions.

Please note that this option is only available when HAProxy has been compiled
with USE_WURFL=1.
</pre><a class="anchor" name="wurfl-information-list"></a><a class="anchor" name="3-wurfl-information-list"></a><a class="anchor" name="3.1-wurfl-information-list"></a><a class="anchor" name="wurfl-information-list (Global parameters)"></a><a class="anchor" name="wurfl-information-list (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="wurfl-information-list"></a><a href="#3.1-wurfl-information-list">wurfl-information-list</a></b> <span style="color: #008">[<span style="color: #080">&lt;capability&gt;</span>]</span>*</div><pre class="text">A space-delimited list of WURFL capabilities, virtual capabilities, property
names we plan to use in injected headers. A full list of capability and
virtual capability names is available on the Scientiamobile website :

    https://www.scientiamobile.com/wurflCapability

Valid WURFL properties are:
- wurfl_id                    Contains the device ID of the matched device.

- wurfl_root_id               Contains the device root ID of the matched
                              device.

- wurfl_isdevroot             Tells if the matched device is a root device.
                              Possible values are &quot;TRUE&quot; or &quot;FALSE&quot;.

- wurfl_useragent             The original useragent coming with this
                              particular web request.

- wurfl_api_version           Contains a string representing the currently
                              used Libwurfl API version.

- wurfl_info                  A string containing information on the parsed
                              wurfl.xml and its full path.

- wurfl_last_load_time        Contains the UNIX timestamp of the last time
                              WURFL has been loaded successfully.

- wurfl_normalized_useragent  The normalized useragent.

Please note that this option is only available when HAProxy has been compiled
with USE_WURFL=1.
</pre><a class="anchor" name="wurfl-information-list-separator"></a><a class="anchor" name="3-wurfl-information-list-separator"></a><a class="anchor" name="3.1-wurfl-information-list-separator"></a><a class="anchor" name="wurfl-information-list-separator (Global parameters)"></a><a class="anchor" name="wurfl-information-list-separator (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="wurfl-information-list-separator"></a><a href="#3.1-wurfl-information-list-separator">wurfl-information-list-separator</a></b> <span style="color: #080">&lt;char&gt;</span></div><pre class="text">A char that will be used to separate values in a response header containing
WURFL results. If not set that a comma (',') will be used by default.

Please note that this option is only available when HAProxy has been compiled
with USE_WURFL=1.
</pre><a class="anchor" name="wurfl-patch-file"></a><a class="anchor" name="3-wurfl-patch-file"></a><a class="anchor" name="3.1-wurfl-patch-file"></a><a class="anchor" name="wurfl-patch-file (Global parameters)"></a><a class="anchor" name="wurfl-patch-file (Process management and security)"></a><div class="keyword"><b><a class="anchor" name="wurfl-patch-file"></a><a href="#3.1-wurfl-patch-file">wurfl-patch-file</a></b> <span style="color: #008">[<span style="color: #080">&lt;file path&gt;</span>]</span></div><pre class="text">A list of WURFL patch file paths. Note that patches are loaded during startup
thus before the chroot.

Please note that this option is only available when HAProxy has been compiled
with USE_WURFL=1.
</pre></div>
<a class="anchor" id="3.2" name="3.2"></a>
<h2 id="chapter-3.2" data-target="3.2"><small><a class="small" href="#3.2">3.2.</a></small> Performance tuning</h2>
<div><a class="anchor" name="busy-polling"></a><a class="anchor" name="3-busy-polling"></a><a class="anchor" name="3.2-busy-polling"></a><a class="anchor" name="busy-polling (Global parameters)"></a><a class="anchor" name="busy-polling (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="busy-polling"></a><a href="#3.2-busy-polling">busy-polling</a></b></div><pre class="text">In some situations, especially when dealing with low latency on processors
supporting a variable frequency or when running inside virtual machines, each
time the process waits for an I/O using the poller, the processor goes back
to sleep or is offered to another VM for a long time, and it causes
excessively high latencies. This option provides a solution preventing the
processor from sleeping by always using a null timeout on the pollers. This
results in a significant latency reduction (30 to 100 microseconds observed)
at the expense of a risk to overheat the processor. It may even be used with
threads, in which case improperly bound threads may heavily conflict,
resulting in a worse performance and high values for the CPU stolen fields
in &quot;show info&quot; output, indicating which threads are misconfigured. It is
important not to let the process run on the same processor as the network
interrupts when this option is used. It is also better to avoid using it on
multiple CPU threads sharing the same core. This option is disabled by
default. If it has been enabled, it may still be forcibly disabled by
prefixing it with the &quot;no&quot; keyword. It is ignored by the &quot;select&quot; and
&quot;poll&quot; pollers.

This option is automatically disabled on old processes in the context of
seamless reload; it avoids too much cpu conflicts when multiple processes
stay around for some time waiting for the end of their current connections.
</pre><a class="anchor" name="max-spread-checks"></a><a class="anchor" name="3-max-spread-checks"></a><a class="anchor" name="3.2-max-spread-checks"></a><a class="anchor" name="max-spread-checks (Global parameters)"></a><a class="anchor" name="max-spread-checks (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="max-spread-checks"></a><a href="#3.2-max-spread-checks">max-spread-checks</a></b> <span style="color: #080">&lt;delay in milliseconds&gt;</span></div><pre class="text">By default, HAProxy tries to spread the start of health checks across the
smallest health check interval of all the servers in a farm. The principle is
to avoid hammering services running on the same server. But when using large
check intervals (10 seconds or more), the last servers in the farm take some
time before starting to be tested, which can be a problem. This parameter is
used to enforce an upper bound on delay between the first and the last check,
even if the servers' check intervals are larger. When servers run with
shorter intervals, their intervals will be respected though.
</pre><a class="anchor" name="maxcompcpuusage"></a><a class="anchor" name="3-maxcompcpuusage"></a><a class="anchor" name="3.2-maxcompcpuusage"></a><a class="anchor" name="maxcompcpuusage (Global parameters)"></a><a class="anchor" name="maxcompcpuusage (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="maxcompcpuusage"></a><a href="#3.2-maxcompcpuusage">maxcompcpuusage</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum CPU usage HAProxy can reach before stopping the compression
for new requests or decreasing the compression level of current requests.
It works like 'maxcomprate' but measures CPU usage instead of incoming data
bandwidth. The value is expressed in percent of the CPU used by HAProxy. A
value of 100 disable the limit. The default value is 100. Setting a lower
value will prevent the compression work from slowing the whole process down
and from introducing high latencies.
</pre><a class="anchor" name="maxcomprate"></a><a class="anchor" name="3-maxcomprate"></a><a class="anchor" name="3.2-maxcomprate"></a><a class="anchor" name="maxcomprate (Global parameters)"></a><a class="anchor" name="maxcomprate (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="maxcomprate"></a><a href="#3.2-maxcomprate">maxcomprate</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum per-process input compression rate to &lt;number&gt; kilobytes
per second. For each stream, if the maximum is reached, the compression
level will be decreased during the stream. If the maximum is reached at the
beginning of a stream, the stream will not compress at all. If the maximum
is not reached, the compression level will be increased up to
tune.comp.maxlevel. A value of zero means there is no limit, this is the
default value.
</pre><a class="anchor" name="maxconn"></a><a class="anchor" name="3-maxconn"></a><a class="anchor" name="3.2-maxconn"></a><a class="anchor" name="maxconn (Global parameters)"></a><a class="anchor" name="maxconn (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="maxconn"></a><a href="#3.2-maxconn">maxconn</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum per-process number of concurrent connections to &lt;number&gt;. It
is equivalent to the command-line argument &quot;-n&quot;. The value provided in
command-line argument via &quot;-n&quot; takes the precedence over the maxconn value set
in the global section. Haproxy process could be also compiled with
SYSTEM_MAXCONN compile-time variable, which is served in this case as the
system maxconn maximum. Again, the command-line &quot;-n&quot; argument allows at
runtime to bypass SYSTEM_MAXCONN limit, if set. Proxies will stop accepting
connections when maxconn is reached. The process soft file descriptor limit
(could be obtained with &quot;ulimit -n&quot; command) is automatically adjusted
according to provided maxconn. See also &quot;<a href="#ulimit-n">ulimit-n</a>&quot;. Note: the &quot;select&quot; poller
cannot reliably use more than 1024 file descriptors on some platforms. If your
platform only supports select and reports &quot;select FAILED&quot; on startup, you need
to reduce the maxconn until it works (slightly below 500 in general). If
maxconn value is not set, it will be automatically calculated based on the
current file descriptors limits, reported by the &quot;ulimit -nH&quot; command (we take
the maximum between the hard and soft values), then automatic value will be
possibly reduced by &quot;<a href="#fd-hard-limit">fd-hard-limit</a>&quot; and by memory limit, if the latter was
enforced via &quot;-m&quot; command line option. Automatic value is also dependent from
the buffer size, memory allocated to compression, SSL cache size, and the use
or not of SSL and the associated maxsslconn (which can also be automatic).
</pre><div class="page-header"><b>See also:</b> fd-hard-limit, ulimit-n</div>
<a class="anchor" name="maxconnrate"></a><a class="anchor" name="3-maxconnrate"></a><a class="anchor" name="3.2-maxconnrate"></a><a class="anchor" name="maxconnrate (Global parameters)"></a><a class="anchor" name="maxconnrate (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="maxconnrate"></a><a href="#3.2-maxconnrate">maxconnrate</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum per-process number of connections per second to &lt;number&gt;.
Proxies will stop accepting connections when this limit is reached. It can be
used to limit the global capacity regardless of each frontend capacity. It is
important to note that this can only be used as a service protection measure,
as there will not necessarily be a fair share between frontends when the
limit is reached, so it's a good idea to also limit each frontend to some
value close to its expected share. Also, lowering tune.maxaccept can improve
fairness.
</pre><a class="anchor" name="maxpipes"></a><a class="anchor" name="3-maxpipes"></a><a class="anchor" name="3.2-maxpipes"></a><a class="anchor" name="maxpipes (Global parameters)"></a><a class="anchor" name="maxpipes (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="maxpipes"></a><a href="#3.2-maxpipes">maxpipes</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum per-process number of pipes to &lt;number&gt;. Currently, pipes
are only used by kernel-based tcp splicing. Since a pipe contains two file
descriptors, the &quot;<a href="#ulimit-n">ulimit-n</a>&quot; value will be increased accordingly. The default
value is maxconn/4, which seems to be more than enough for most heavy usages.
The splice code dynamically allocates and releases pipes, and can fall back
to standard copy, so setting this value too low may only impact performance.
</pre><a class="anchor" name="maxsessrate"></a><a class="anchor" name="3-maxsessrate"></a><a class="anchor" name="3.2-maxsessrate"></a><a class="anchor" name="maxsessrate (Global parameters)"></a><a class="anchor" name="maxsessrate (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="maxsessrate"></a><a href="#3.2-maxsessrate">maxsessrate</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum per-process number of sessions per second to &lt;number&gt;.
Proxies will stop accepting connections when this limit is reached. It can be
used to limit the global capacity regardless of each frontend capacity. It is
important to note that this can only be used as a service protection measure,
as there will not necessarily be a fair share between frontends when the
limit is reached, so it's a good idea to also limit each frontend to some
value close to its expected share. Also, lowering tune.maxaccept can improve
fairness.
</pre><a class="anchor" name="maxsslconn"></a><a class="anchor" name="3-maxsslconn"></a><a class="anchor" name="3.2-maxsslconn"></a><a class="anchor" name="maxsslconn (Global parameters)"></a><a class="anchor" name="maxsslconn (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="maxsslconn"></a><a href="#3.2-maxsslconn">maxsslconn</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum per-process number of concurrent SSL connections to
&lt;number&gt;. By default there is no SSL-specific limit, which means that the
global maxconn setting will apply to all connections. Setting this limit
avoids having openssl use too much memory and crash when malloc returns NULL
(since it unfortunately does not reliably check for such conditions). Note
that the limit applies both to incoming and outgoing connections, so one
connection which is deciphered then ciphered accounts for 2 SSL connections.
If this value is not set, but a memory limit is enforced, this value will be
automatically computed based on the memory limit, maxconn,  the buffer size,
memory allocated to compression, SSL cache size, and use of SSL in either
frontends, backends or both. If neither maxconn nor maxsslconn are specified
when there is a memory limit, HAProxy will automatically adjust these values
so that 100% of the connections can be made over SSL with no risk, and will
consider the sides where it is enabled (frontend, backend, both).
</pre><a class="anchor" name="maxsslrate"></a><a class="anchor" name="3-maxsslrate"></a><a class="anchor" name="3.2-maxsslrate"></a><a class="anchor" name="maxsslrate (Global parameters)"></a><a class="anchor" name="maxsslrate (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="maxsslrate"></a><a href="#3.2-maxsslrate">maxsslrate</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum per-process number of SSL sessions per second to &lt;number&gt;.
SSL listeners will stop accepting connections when this limit is reached. It
can be used to limit the global SSL CPU usage regardless of each frontend
capacity. It is important to note that this can only be used as a service
protection measure, as there will not necessarily be a fair share between
frontends when the limit is reached, so it's a good idea to also limit each
frontend to some value close to its expected share. It is also important to
note that the sessions are accounted before they enter the SSL stack and not
after, which also protects the stack against bad handshakes. Also, lowering
tune.maxaccept can improve fairness.
</pre><a class="anchor" name="maxzlibmem"></a><a class="anchor" name="3-maxzlibmem"></a><a class="anchor" name="3.2-maxzlibmem"></a><a class="anchor" name="maxzlibmem (Global parameters)"></a><a class="anchor" name="maxzlibmem (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="maxzlibmem"></a><a href="#3.2-maxzlibmem">maxzlibmem</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum amount of RAM in megabytes per process usable by the zlib.
When the maximum amount is reached, future streams will not compress as long
as RAM is unavailable. When sets to 0, there is no limit.
The default value is 0. The value is available in bytes on the UNIX socket
with &quot;show info&quot; on the line &quot;MaxZlibMemUsage&quot;, the memory used by zlib is
&quot;ZlibMemUsage&quot; in bytes.
</pre><a class="anchor" name="no-memory-trimming"></a><a class="anchor" name="3-no-memory-trimming"></a><a class="anchor" name="3.2-no-memory-trimming"></a><a class="anchor" name="no-memory-trimming (Global parameters)"></a><a class="anchor" name="no-memory-trimming (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="no-memory-trimming"></a><a href="#3.2-no-memory-trimming">no-memory-trimming</a></b></div><pre class="text">Disables memory trimming (&quot;malloc_trim&quot;) at a few moments where attempts are
made to reclaim lots of memory (on memory shortage or on reload). Trimming
memory forces the system's allocator to scan all unused areas and to release
them. This is generally seen as nice action to leave more available memory to
a new process while the old one is unlikely to make significant use of it.
But some systems dealing with tens to hundreds of thousands of concurrent
connections may experience a lot of memory fragmentation, that may render
this release operation extremely long. During this time, no more traffic
passes through the process, new connections are not accepted anymore, some
health checks may even fail, and the watchdog may even trigger and kill the
unresponsive process, leaving a huge core dump. If this ever happens, then it
is suggested to use this option to disable trimming and stop trying to be
nice with the new process. Note that advanced memory allocators usually do
not suffer from such a problem.
</pre><a class="anchor" name="noepoll"></a><a class="anchor" name="3-noepoll"></a><a class="anchor" name="3.2-noepoll"></a><a class="anchor" name="noepoll (Global parameters)"></a><a class="anchor" name="noepoll (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="noepoll"></a><a href="#3.2-noepoll">noepoll</a></b></div><pre class="text">Disables the use of the &quot;epoll&quot; event polling system on Linux. It is
equivalent to the command-line argument &quot;-de&quot;. The next polling system
used will generally be &quot;poll&quot;. See also &quot;<a href="#nopoll">nopoll</a>&quot;.
</pre><a class="anchor" name="noevports"></a><a class="anchor" name="3-noevports"></a><a class="anchor" name="3.2-noevports"></a><a class="anchor" name="noevports (Global parameters)"></a><a class="anchor" name="noevports (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="noevports"></a><a href="#3.2-noevports">noevports</a></b></div><pre class="text">Disables the use of the event ports event polling system on SunOS systems
derived from Solaris 10 and later. It is equivalent to the command-line
argument &quot;-dv&quot;. The next polling system used will generally be &quot;poll&quot;. See
also &quot;<a href="#nopoll">nopoll</a>&quot;.
</pre><a class="anchor" name="nogetaddrinfo"></a><a class="anchor" name="3-nogetaddrinfo"></a><a class="anchor" name="3.2-nogetaddrinfo"></a><a class="anchor" name="nogetaddrinfo (Global parameters)"></a><a class="anchor" name="nogetaddrinfo (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="nogetaddrinfo"></a><a href="#3.2-nogetaddrinfo">nogetaddrinfo</a></b></div><pre class="text">Disables the use of getaddrinfo(3) for name resolving. It is equivalent to
the command line argument &quot;-dG&quot;. Deprecated gethostbyname(3) will be used.
</pre><a class="anchor" name="nokqueue"></a><a class="anchor" name="3-nokqueue"></a><a class="anchor" name="3.2-nokqueue"></a><a class="anchor" name="nokqueue (Global parameters)"></a><a class="anchor" name="nokqueue (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="nokqueue"></a><a href="#3.2-nokqueue">nokqueue</a></b></div><pre class="text">Disables the use of the &quot;kqueue&quot; event polling system on BSD. It is
equivalent to the command-line argument &quot;-dk&quot;. The next polling system
used will generally be &quot;poll&quot;. See also &quot;<a href="#nopoll">nopoll</a>&quot;.
</pre><a class="anchor" name="nopoll"></a><a class="anchor" name="3-nopoll"></a><a class="anchor" name="3.2-nopoll"></a><a class="anchor" name="nopoll (Global parameters)"></a><a class="anchor" name="nopoll (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="nopoll"></a><a href="#3.2-nopoll">nopoll</a></b></div><pre class="text">Disables the use of the &quot;poll&quot; event polling system. It is equivalent to the
command-line argument &quot;-dp&quot;. The next polling system used will be &quot;select&quot;.
It should never be needed to disable &quot;poll&quot; since it's available on all
platforms supported by HAProxy. See also &quot;<a href="#nokqueue">nokqueue</a>&quot;, &quot;<a href="#noepoll">noepoll</a>&quot; and
&quot;<a href="#noevports">noevports</a>&quot;.
</pre><a class="anchor" name="noreuseport"></a><a class="anchor" name="3-noreuseport"></a><a class="anchor" name="3.2-noreuseport"></a><a class="anchor" name="noreuseport (Global parameters)"></a><a class="anchor" name="noreuseport (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="noreuseport"></a><a href="#3.2-noreuseport">noreuseport</a></b></div><pre class="text">Disables the use of SO_REUSEPORT - see socket(7). It is equivalent to the
command line argument &quot;-dR&quot;.
</pre><a class="anchor" name="nosplice"></a><a class="anchor" name="3-nosplice"></a><a class="anchor" name="3.2-nosplice"></a><a class="anchor" name="nosplice (Global parameters)"></a><a class="anchor" name="nosplice (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="nosplice"></a><a href="#3.2-nosplice">nosplice</a></b></div><pre class="text">Disables the use of kernel tcp splicing between sockets on Linux. It is
equivalent to the command line argument &quot;-dS&quot;. Data will then be copied
using conventional and more portable recv/send calls. Kernel tcp splicing is
limited to some very recent instances of kernel 2.6. Most versions between
2.6.25 and 2.6.28 are buggy and will forward corrupted data, so they must not
be used. This option makes it easier to globally disable kernel splicing in
case of doubt. See also &quot;<a href="#option%20splice-auto">option splice-auto</a>&quot;, &quot;<a href="#option%20splice-request">option splice-request</a>&quot; and
&quot;<a href="#option%20splice-response">option splice-response</a>&quot;.
</pre><a class="anchor" name="profiling.memory"></a><a class="anchor" name="3-profiling.memory"></a><a class="anchor" name="3.2-profiling.memory"></a><a class="anchor" name="profiling.memory (Global parameters)"></a><a class="anchor" name="profiling.memory (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="profiling.memory"></a><a href="#3.2-profiling.memory">profiling.memory</a></b> <span style="color: #800">{ on | off }</span></div><pre class="text">Enables ('on') or disables ('off') per-function memory profiling. This will
keep usage statistics of malloc/calloc/realloc/free calls anywhere in the
process (including libraries) which will be reported on the CLI using the
&quot;show profiling&quot; command. This is essentially meant to be used when an
abnormal memory usage is observed that cannot be explained by the pools and
other info are required. The performance hit will typically be around 1%,
maybe a bit more on highly threaded machines, so it is normally suitable for
use in production. The same may be achieved at run time on the CLI using the
&quot;set profiling memory&quot; command, please consult the management manual.
</pre><a class="anchor" name="profiling.tasks"></a><a class="anchor" name="3-profiling.tasks"></a><a class="anchor" name="3.2-profiling.tasks"></a><a class="anchor" name="profiling.tasks (Global parameters)"></a><a class="anchor" name="profiling.tasks (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="profiling.tasks"></a><a href="#3.2-profiling.tasks">profiling.tasks</a></b> <span style="color: #800">{ auto | on | off }</span></div><pre class="text">Enables ('on') or disables ('off') per-task CPU profiling. When set to 'auto'
the profiling automatically turns on a thread when it starts to suffer from
an average latency of 1000 microseconds or higher as reported in the
&quot;avg_loop_us&quot; activity field, and automatically turns off when the latency
returns below 990 microseconds (this value is an average over the last 1024
loops so it does not vary quickly and tends to significantly smooth short
spikes). It may also spontaneously trigger from time to time on overloaded
systems, containers, or virtual machines, or when the system swaps (which
must absolutely never happen on a load balancer).

CPU profiling per task can be very convenient to report where the time is
spent and which requests have what effect on which other request. Enabling
it will typically affect the overall's performance by less than 1%, thus it
is recommended to leave it to the default 'auto' value so that it only
operates when a problem is identified. This feature requires a system
supporting the clock_gettime(2) syscall with clock identifiers
CLOCK_MONOTONIC and CLOCK_THREAD_CPUTIME_ID, otherwise the reported time will
be zero. This option may be changed at run time using &quot;set profiling&quot; on the
CLI.
</pre><a class="anchor" name="spread-checks"></a><a class="anchor" name="3-spread-checks"></a><a class="anchor" name="3.2-spread-checks"></a><a class="anchor" name="spread-checks (Global parameters)"></a><a class="anchor" name="spread-checks (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="spread-checks"></a><a href="#3.2-spread-checks">spread-checks</a></b> <span style="color: #080">&lt;0..50, in percent&gt;</span></div><pre class="text">Sometimes it is desirable to avoid sending agent and health checks to
servers at exact intervals, for instance when many logical servers are
located on the same physical server. With the help of this parameter, it
becomes possible to add some randomness in the check interval between 0
and +/- 50%. A value between 2 and 5 seems to show good results. The
default value remains at 0.
</pre><a class="anchor" name="ssl-engine"></a><a class="anchor" name="3-ssl-engine"></a><a class="anchor" name="3.2-ssl-engine"></a><a class="anchor" name="ssl-engine (Global parameters)"></a><a class="anchor" name="ssl-engine (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="ssl-engine"></a><a href="#3.2-ssl-engine">ssl-engine</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #008">[algo <span style="color: #080">&lt;comma-separated list of algorithms&gt;</span>]</span></div><pre class="text">Sets the OpenSSL engine to &lt;name&gt;. List of valid values for &lt;name&gt; may be
obtained using the command &quot;openssl engine&quot;. This statement may be used
multiple times, it will simply enable multiple crypto engines. Referencing an
unsupported engine will prevent HAProxy from starting. Note that many engines
will lead to lower HTTPS performance than pure software with recent
processors. The optional command &quot;algo&quot; sets the default algorithms an ENGINE
will supply using the OPENSSL function ENGINE_set_default_string(). A value
of &quot;ALL&quot; uses the engine for all cryptographic operations. If no list of
algo is specified then the value of &quot;ALL&quot; is used. A comma-separated list
of different algorithms may be specified, including: RSA, DSA, DH, EC, RAND,
CIPHERS, DIGESTS, PKEY, PKEY_CRYPTO, PKEY_ASN1. This is the same format that
openssl configuration file uses:
https://www.openssl.org/docs/man1.0.2/apps/config.html

HAProxy Version 2.6 disabled the support for engines in the default build.
This option is only available when HAProxy has been built with support for
it.  In case the ssl-engine is required HAProxy can be rebuild with the
USE_ENGINE=1 flag.
</pre><a class="anchor" name="ssl-mode-async"></a><a class="anchor" name="3-ssl-mode-async"></a><a class="anchor" name="3.2-ssl-mode-async"></a><a class="anchor" name="ssl-mode-async (Global parameters)"></a><a class="anchor" name="ssl-mode-async (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="ssl-mode-async"></a><a href="#3.2-ssl-mode-async">ssl-mode-async</a></b></div><pre class="text">Adds SSL_MODE_ASYNC mode to the SSL context. This enables asynchronous TLS
I/O operations if asynchronous capable SSL engines are used. The current
implementation supports a maximum of 32 engines. The Openssl ASYNC API
doesn't support moving read/write buffers and is not compliant with
HAProxy's buffer management. So the asynchronous mode is disabled on
read/write  operations (it is only enabled during initial and renegotiation
handshakes).
</pre><a class="anchor" name="tune.applet.zero-copy-forwarding"></a><a class="anchor" name="3-tune.applet.zero-copy-forwarding"></a><a class="anchor" name="3.2-tune.applet.zero-copy-forwarding"></a><a class="anchor" name="tune.applet.zero-copy-forwarding (Global parameters)"></a><a class="anchor" name="tune.applet.zero-copy-forwarding (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.applet.zero-copy-forwarding"></a><a href="#3.2-tune.applet.zero-copy-forwarding">tune.applet.zero-copy-forwarding</a></b> <span style="color: #800">{ on | off }</span></div><pre class="text">Enables ('on') of disabled ('off') the zero-copy forwarding of data for the
applets. It is enabled by default.
</pre><div class="page-header"><b>See also:</b> tune.disable-zero-copy-forwarding.</div>
<a class="anchor" name="tune.buffers.limit"></a><a class="anchor" name="3-tune.buffers.limit"></a><a class="anchor" name="3.2-tune.buffers.limit"></a><a class="anchor" name="tune.buffers.limit (Global parameters)"></a><a class="anchor" name="tune.buffers.limit (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.buffers.limit"></a><a href="#3.2-tune.buffers.limit">tune.buffers.limit</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets a hard limit on the number of buffers which may be allocated per process.
The default value is zero which means unlimited. The limit will automatically
be re-adjusted to satisfy the reserved buffers for emergency situations so
that the user doesn't have to perform complicated calculations. Forcing this
value can be particularly useful to limit the amount of memory a process may
take, while retaining a sane behavior. When this limit is reached, a task
that requests a buffer waits for another one to be released first. Most of
the time the waiting time is very short and not perceptible provided that
limits remain reasonable. However, some historical limitations have weakened
this mechanism over versions and it is known that in certain situations of
sustained shortage, some tasks may freeze until their timeout expires, so it
is safer to avoid using this when not strictly necessary.
</pre><a class="anchor" name="tune.buffers.reserve"></a><a class="anchor" name="3-tune.buffers.reserve"></a><a class="anchor" name="3.2-tune.buffers.reserve"></a><a class="anchor" name="tune.buffers.reserve (Global parameters)"></a><a class="anchor" name="tune.buffers.reserve (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.buffers.reserve"></a><a href="#3.2-tune.buffers.reserve">tune.buffers.reserve</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the number of per-thread buffers which are pre-allocated and reserved
for use only during memory shortage conditions resulting in failed memory
allocations. The minimum value is 0 and the default is 4. There is no reason
a user would want to change this value, unless a core developer suggests to
change it for a very specific reason.
</pre><a class="anchor" name="tune.bufsize"></a><a class="anchor" name="3-tune.bufsize"></a><a class="anchor" name="3.2-tune.bufsize"></a><a class="anchor" name="tune.bufsize (Global parameters)"></a><a class="anchor" name="tune.bufsize (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.bufsize"></a><a href="#3.2-tune.bufsize">tune.bufsize</a></b> <span style="color: #080">&lt;size&gt;</span></div><pre class="text">Sets the buffer size to this size (in bytes). Lower values allow more
streams to coexist in the same amount of RAM, and higher values allow some
applications with very large cookies to work. The default value is 16384 and
can be changed at build time. It is strongly recommended not to change this
from the default value, as very low values will break some services such as
statistics, and values larger than default size will increase memory usage,
possibly causing the system to run out of memory. At least the global maxconn
parameter should be decreased by the same factor as this one is increased. In
addition, use of HTTP/2 mandates that this value must be 16384 or more. If an
HTTP request is larger than (tune.bufsize - tune.maxrewrite), HAProxy will
return HTTP 400 (Bad Request) error. Similarly if an HTTP response is larger
than this size, HAProxy will return HTTP 502 (Bad Gateway). Note that the
value set using this parameter will automatically be rounded up to the next
multiple of 8 on 32-bit machines and 16 on 64-bit machines.
</pre><a class="anchor" name="tune.bufsize.small"></a><a class="anchor" name="3-tune.bufsize.small"></a><a class="anchor" name="3.2-tune.bufsize.small"></a><a class="anchor" name="tune.bufsize.small (Global parameters)"></a><a class="anchor" name="tune.bufsize.small (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.bufsize.small"></a><a href="#3.2-tune.bufsize.small">tune.bufsize.small</a></b> <span style="color: #080">&lt;size&gt;</span></div><pre class="text">Sets the size in bytes for small buffers. The defaults value is 1024.

These buffers are designed to be used in some specific contexts where memory
consumption is restrained but it seems unnecessary to allocate a full buffer.
If however a small buffer is not sufficient, a reallocation is automatically
done to switch to a standard size buffer.

For the moment, it is used only by HTTP/3 protocol to emit the response
headers.
</pre><a class="anchor" name="tune.comp.maxlevel"></a><a class="anchor" name="3-tune.comp.maxlevel"></a><a class="anchor" name="3.2-tune.comp.maxlevel"></a><a class="anchor" name="tune.comp.maxlevel (Global parameters)"></a><a class="anchor" name="tune.comp.maxlevel (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.comp.maxlevel"></a><a href="#3.2-tune.comp.maxlevel">tune.comp.maxlevel</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum compression level. The compression level affects CPU
usage during compression. This value affects CPU usage during compression.
Each stream using compression initializes the compression algorithm with
this value. The default value is 1.
</pre><a class="anchor" name="tune.disable-fast-forward"></a><a class="anchor" name="3-tune.disable-fast-forward"></a><a class="anchor" name="3.2-tune.disable-fast-forward"></a><a class="anchor" name="tune.disable-fast-forward (Global parameters)"></a><a class="anchor" name="tune.disable-fast-forward (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.disable-fast-forward"></a><a href="#3.2-tune.disable-fast-forward">tune.disable-fast-forward</a></b> <span style="color: #008">[ EXPERIMENTAL ]</span></div><pre class="text">Disables the data fast-forwarding. It is a mechanism to optimize the data
forwarding by passing data directly from a side to the other one without
waking the stream up. Thanks to this directive, it is possible to disable
this optimization. Note it also disable any kernel tcp splicing but also the
zero-copy forwarding. This command is not meant for regular use, it will
generally only be suggested by developers along complex debugging
sessions. For this reason it is internally marked as experimental, meaning
that &quot;<a href="#expose-experimental-directives">expose-experimental-directives</a>&quot; must appear on a line before this
directive.
</pre><a class="anchor" name="tune.disable-zero-copy-forwarding"></a><a class="anchor" name="3-tune.disable-zero-copy-forwarding"></a><a class="anchor" name="3.2-tune.disable-zero-copy-forwarding"></a><a class="anchor" name="tune.disable-zero-copy-forwarding (Global parameters)"></a><a class="anchor" name="tune.disable-zero-copy-forwarding (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.disable-zero-copy-forwarding"></a><a href="#3.2-tune.disable-zero-copy-forwarding">tune.disable-zero-copy-forwarding</a></b></div><pre class="text">Globally disables the zero-copy forwarding of data. It is a mechanism to
optimize the data fast-forwarding by avoiding to use the channel's buffer.
Thanks to this directive, it is possible to disable this optimization. Note
it also disable any kernel tcp splicing.
</pre><div class="page-header"><b>See also:</b> tune.pt.zero-copy-forwarding, tune.applet.zero-copy-forwarding, tune.h1.zero-copy-fwd-recv, tune.h1.zero-copy-fwd-send, tune.h2.zero-copy-fwd-send, tune.quic.zero-copy-fwd-send</div>
<a class="anchor" name="tune.events.max-events-at-once"></a><a class="anchor" name="3-tune.events.max-events-at-once"></a><a class="anchor" name="3.2-tune.events.max-events-at-once"></a><a class="anchor" name="tune.events.max-events-at-once (Global parameters)"></a><a class="anchor" name="tune.events.max-events-at-once (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.events.max-events-at-once"></a><a href="#3.2-tune.events.max-events-at-once">tune.events.max-events-at-once</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the number of events that may be processed at once by an asynchronous
task handler (from event_hdl API). &lt;number&gt; should be included between 1
and 10000. Large number could cause thread contention as a result of the
task doing heavy work without interruption, and on the other hand, small
number could result in the task being constantly rescheduled because it
cannot consume enough events per run and is not able to catch up with the
event producer. The default value may be forced at build time, otherwise
defaults to 100.
</pre><a class="anchor" name="tune.fail-alloc"></a><a class="anchor" name="3-tune.fail-alloc"></a><a class="anchor" name="3.2-tune.fail-alloc"></a><a class="anchor" name="tune.fail-alloc (Global parameters)"></a><a class="anchor" name="tune.fail-alloc (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.fail-alloc"></a><a href="#3.2-tune.fail-alloc">tune.fail-alloc</a></b></div><pre class="text">If compiled with DEBUG_FAIL_ALLOC or started with &quot;-dMfail&quot;, gives the
percentage of chances an allocation attempt fails. Must be between 0 (no
failure) and 100 (no success). This is useful to debug and make sure memory
failures are handled gracefully. When not set, the ratio is 0. However the
command-line &quot;-dMfail&quot; option automatically sets it to 1% failure rate so that
it is not necessary to change the configuration for testing.
</pre><a class="anchor" name="tune.fd.edge-triggered"></a><a class="anchor" name="3-tune.fd.edge-triggered"></a><a class="anchor" name="3.2-tune.fd.edge-triggered"></a><a class="anchor" name="tune.fd.edge-triggered (Global parameters)"></a><a class="anchor" name="tune.fd.edge-triggered (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.fd.edge-triggered"></a><a href="#3.2-tune.fd.edge-triggered">tune.fd.edge-triggered</a></b> <span style="color: #800">{ on | off }</span>  <span style="color: #008">[ EXPERIMENTAL ]</span></div><pre class="text">Enables ('on') or disables ('off') the edge-triggered polling mode for FDs
that support it. This is currently only support with epoll. It may noticeably
reduce the number of epoll_ctl() calls and slightly improve performance in
certain scenarios. This is still experimental, it may result in frozen
connections if bugs are still present, and is disabled by default.
</pre><a class="anchor" name="tune.h1.zero-copy-fwd-recv"></a><a class="anchor" name="3-tune.h1.zero-copy-fwd-recv"></a><a class="anchor" name="3.2-tune.h1.zero-copy-fwd-recv"></a><a class="anchor" name="tune.h1.zero-copy-fwd-recv (Global parameters)"></a><a class="anchor" name="tune.h1.zero-copy-fwd-recv (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.h1.zero-copy-fwd-recv"></a><a href="#3.2-tune.h1.zero-copy-fwd-recv">tune.h1.zero-copy-fwd-recv</a></b> <span style="color: #800">{ on | off }</span></div><pre class="text">Enables ('on') of disabled ('off') the zero-copy receives of data for the H1
multiplexer. It is enabled by default.
</pre><div class="page-header"><b>See also:</b> tune.disable-zero-copy-forwarding, tune.h1.zero-copy-fwd-send</div>
<a class="anchor" name="tune.h1.zero-copy-fwd-send"></a><a class="anchor" name="3-tune.h1.zero-copy-fwd-send"></a><a class="anchor" name="3.2-tune.h1.zero-copy-fwd-send"></a><a class="anchor" name="tune.h1.zero-copy-fwd-send (Global parameters)"></a><a class="anchor" name="tune.h1.zero-copy-fwd-send (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.h1.zero-copy-fwd-send"></a><a href="#3.2-tune.h1.zero-copy-fwd-send">tune.h1.zero-copy-fwd-send</a></b> <span style="color: #800">{ on | off }</span></div><pre class="text">Enables ('on') of disabled ('off') the zero-copy sends of data for the H1
multiplexer. It is enabled by default.
</pre><div class="page-header"><b>See also:</b> tune.disable-zero-copy-forwarding, tune.h1.zero-copy-fwd-recv</div>
<a class="anchor" name="tune.h2.be.glitches-threshold"></a><a class="anchor" name="3-tune.h2.be.glitches-threshold"></a><a class="anchor" name="3.2-tune.h2.be.glitches-threshold"></a><a class="anchor" name="tune.h2.be.glitches-threshold (Global parameters)"></a><a class="anchor" name="tune.h2.be.glitches-threshold (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.h2.be.glitches-threshold"></a><a href="#3.2-tune.h2.be.glitches-threshold">tune.h2.be.glitches-threshold</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the threshold for the number of glitches on a backend connection, where
that connection will automatically be killed. This allows to automatically
kill misbehaving connections without having to write explicit rules for them.
The default value is zero, indicating that no threshold is set so that no
event will cause a connection to be closed. Beware that some H2 servers may
occasionally cause a few glitches over long lasting connection, so any non-
zero value here should probably be in the hundreds or thousands to be
effective without affecting slightly bogus servers.
</pre><div class="page-header"><b>See also:</b> tune.h2.fe.glitches-threshold, bc_glitches</div>
<a class="anchor" name="tune.h2.be.initial-window-size"></a><a class="anchor" name="3-tune.h2.be.initial-window-size"></a><a class="anchor" name="3.2-tune.h2.be.initial-window-size"></a><a class="anchor" name="tune.h2.be.initial-window-size (Global parameters)"></a><a class="anchor" name="tune.h2.be.initial-window-size (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.h2.be.initial-window-size"></a><a href="#3.2-tune.h2.be.initial-window-size">tune.h2.be.initial-window-size</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the HTTP/2 initial window size for outgoing connections, which is the
number of bytes the server can respond before waiting for an acknowledgment
from HAProxy. This setting only affects payload contents, not headers. When
not set, the common default value set by tune.h2.initial-window-size applies.
It can make sense to slightly increase this value to allow faster downloads
or to reduce CPU usage on the servers, at the expense of creating unfairness
between clients. It is better to use tune.h2.be.rxbuf instead, which does not
cause any unfairness. It doesn't affect resource usage.
</pre><div class="page-header"><b>See also:</b> tune.h2.initial-window-size.</div>
<a class="anchor" name="tune.h2.be.max-concurrent-streams"></a><a class="anchor" name="3-tune.h2.be.max-concurrent-streams"></a><a class="anchor" name="3.2-tune.h2.be.max-concurrent-streams"></a><a class="anchor" name="tune.h2.be.max-concurrent-streams (Global parameters)"></a><a class="anchor" name="tune.h2.be.max-concurrent-streams (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.h2.be.max-concurrent-streams"></a><a href="#3.2-tune.h2.be.max-concurrent-streams">tune.h2.be.max-concurrent-streams</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the HTTP/2 maximum number of concurrent streams per outgoing connection
(i.e. the number of outstanding requests on a single connection to a server).
When not set, the default set by tune.h2.max-concurrent-streams applies. A
smaller value than the default 100 may improve a site's responsiveness at the
expense of maintaining more established connections to the servers. When the
&quot;<a href="#http-reuse">http-reuse</a>&quot; setting is set to &quot;always&quot;, it is recommended to reduce this
value so as not to mix too many different clients over the same connection,
because if a client is slower than others, a mechanism known as &quot;head of
line blocking&quot; tends to cause cascade effect on download speed for all
clients sharing a connection (keep tune.h2.be.initial-window-size low in this
case). It is highly recommended not to increase this value; some might find
it optimal to run at low values (1..5 typically).
</pre><a class="anchor" name="tune.h2.be.rxbuf"></a><a class="anchor" name="3-tune.h2.be.rxbuf"></a><a class="anchor" name="3.2-tune.h2.be.rxbuf"></a><a class="anchor" name="tune.h2.be.rxbuf (Global parameters)"></a><a class="anchor" name="tune.h2.be.rxbuf (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.h2.be.rxbuf"></a><a href="#3.2-tune.h2.be.rxbuf">tune.h2.be.rxbuf</a></b> <span style="color: #080">&lt;size&gt;</span></div><pre class="text">Sets the HTTP/2 receive buffer size for outgoing connections, in bytes. This
size will be rounded up to the next multiple of tune.bufsize and will be
shared between all streams uploading data (both HEADERS and DATA frames). In
any case, one buffer will always be granted to each stream, and 7/8 of the
unused buffers will be shared between streams downloading payload, allowing
to significantly improve upload performance and avoid head-of-line blocking
(HoL) on backend connections shared between multiple clients when http-reuse
is set to &quot;always&quot;. The advertised per-stream window is automatically
adjusted to reflect the available space so that in practice it should not be
required to touch tune.h2.be.initial-window-size. If less than the size
required to deal with all streams is set, this minimum will be used. The
default value is about 1600k (100 streams with 16kB buffers each).
</pre><div class="page-header"><b>See also:</b> tune.h2.be.initial-window-size, tune.h2.fe.rxbuf, http-reuse.</div>
<a class="anchor" name="tune.h2.fe.glitches-threshold"></a><a class="anchor" name="3-tune.h2.fe.glitches-threshold"></a><a class="anchor" name="3.2-tune.h2.fe.glitches-threshold"></a><a class="anchor" name="tune.h2.fe.glitches-threshold (Global parameters)"></a><a class="anchor" name="tune.h2.fe.glitches-threshold (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.h2.fe.glitches-threshold"></a><a href="#3.2-tune.h2.fe.glitches-threshold">tune.h2.fe.glitches-threshold</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the threshold for the number of glitches on a frontend connection, where
that connection will automatically be killed. This allows to automatically
kill misbehaving connections without having to write explicit rules for them.
The default value is zero, indicating that no threshold is set so that no
event will cause a connection to be closed. Beware that some H2 clientss may
occasionally cause a few glitches over long lasting connection, so any non-
zero value here should probably be in the hundreds or thousands to be
effective without affecting slightly bogus clients.
</pre><div class="page-header"><b>See also:</b> tune.h2.be.glitches-threshold, fc_glitches</div>
<a class="anchor" name="tune.h2.fe.initial-window-size"></a><a class="anchor" name="3-tune.h2.fe.initial-window-size"></a><a class="anchor" name="3.2-tune.h2.fe.initial-window-size"></a><a class="anchor" name="tune.h2.fe.initial-window-size (Global parameters)"></a><a class="anchor" name="tune.h2.fe.initial-window-size (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.h2.fe.initial-window-size"></a><a href="#3.2-tune.h2.fe.initial-window-size">tune.h2.fe.initial-window-size</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the HTTP/2 initial window size for incoming connections, which is the
number of bytes the client can upload before waiting for an acknowledgment
from HAProxy. This setting only affects payload contents (i.e. the body of
POST requests), not headers. When not set, the common default value set by
tune.h2.initial-window-size applies. It can make sense to increase this value
to allow faster uploads. The default value equals tune.bufsize (16384) and
allows at least 1.25 Mbps of bandwidth per stream over a 100 ms ping time,
and 125 Mbps for 1 ms ping time. It doesn't affect resource usage. Using too
large values may cause clients to experience a lack of responsiveness if
pages are accessed in parallel to large uploads. It is better to use
tune.h2.fe.rxbuf instead, which does not cause any unfairness.
</pre><div class="page-header"><b>See also:</b> tune.h2.initial-window-size.</div>
<a class="anchor" name="tune.h2.fe.max-concurrent-streams"></a><a class="anchor" name="3-tune.h2.fe.max-concurrent-streams"></a><a class="anchor" name="3.2-tune.h2.fe.max-concurrent-streams"></a><a class="anchor" name="tune.h2.fe.max-concurrent-streams (Global parameters)"></a><a class="anchor" name="tune.h2.fe.max-concurrent-streams (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.h2.fe.max-concurrent-streams"></a><a href="#3.2-tune.h2.fe.max-concurrent-streams">tune.h2.fe.max-concurrent-streams</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the HTTP/2 maximum number of concurrent streams per incoming connection
(i.e. the number of outstanding requests on a single connection from a
client). When not set, the default set by tune.h2.max-concurrent-streams
applies. A larger value than the default 100 may sometimes slightly improve
the page load time for complex sites with lots of small objects over high
latency networks but can also result in using more memory by allowing a
client to allocate more resources at once. The default value of 100 is
generally good and it is recommended not to change this value.
</pre><a class="anchor" name="tune.h2.fe.max-total-streams"></a><a class="anchor" name="3-tune.h2.fe.max-total-streams"></a><a class="anchor" name="3.2-tune.h2.fe.max-total-streams"></a><a class="anchor" name="tune.h2.fe.max-total-streams (Global parameters)"></a><a class="anchor" name="tune.h2.fe.max-total-streams (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.h2.fe.max-total-streams"></a><a href="#3.2-tune.h2.fe.max-total-streams">tune.h2.fe.max-total-streams</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the HTTP/2 maximum number of total streams processed per incoming
connection. Once this limit is reached, HAProxy will send a graceful GOAWAY
frame informing the client that it will close the connection after all
pending streams have been closed. In practice, clients tend to close as fast
as possible when receiving this, and to establish a new connection for next
requests. Doing this is sometimes useful and desired in situations where
clients stay connected for a very long time and cause some imbalance inside a
farm. For example, in some highly dynamic environments, it is possible that
new load balancers are instantiated on the fly to adapt to a load increase,
and that once the load goes down they should be stopped without breaking
established connections. By setting a limit here, the connections will have
a limited lifetime and will be frequently renewed, with some possibly being
established to other nodes, so that existing resources are quickly released.

It's important to understand that there is an implicit relation between this
limit and &quot;<a href="#tune.h2.fe.max-concurrent-streams">tune.h2.fe.max-concurrent-streams</a>&quot; above. Indeed, HAProxy will
always accept to process any possibly pending streams that might be in flight
between the client and the frontend, so the advertised limit will always
automatically be raised by the value configured in max-concurrent-streams,
and this value will serve as a hard limit above which a violation by a non-
compliant client will result in the connection being closed. Thus when
counting the number of requests per connection from the logs, any number
between max-total-streams and (max-total-streams + max-concurrent-streams)
may be observed depending on how fast streams are created by the client.

The default value is zero, which enforces no limit beyond those implied by
the protocol (2^30 ~= 1.07 billion). Values around 1000 may already cause
frequent connection renewal without causing any perceptible latency to most
clients. Setting it too low may result in an increase of CPU usage due to
frequent TLS reconnections, in addition to increased page load time. Please
note that some load testing tools do not support reconnections and may report
errors with this setting; as such it may be needed to disable it when running
performance benchmarks. See also &quot;<a href="#tune.h2.fe.max-concurrent-streams">tune.h2.fe.max-concurrent-streams</a>&quot;.
</pre><a class="anchor" name="tune.h2.fe.rxbuf"></a><a class="anchor" name="3-tune.h2.fe.rxbuf"></a><a class="anchor" name="3.2-tune.h2.fe.rxbuf"></a><a class="anchor" name="tune.h2.fe.rxbuf (Global parameters)"></a><a class="anchor" name="tune.h2.fe.rxbuf (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.h2.fe.rxbuf"></a><a href="#3.2-tune.h2.fe.rxbuf">tune.h2.fe.rxbuf</a></b> <span style="color: #080">&lt;size&gt;</span></div><pre class="text">Sets the HTTP/2 receive buffer size for incoming connections, in bytes. This
size will be rounded up to the next multiple of tune.bufsize and will be
shared between all streams uploading data (both HEADERS and DATA frames). In
any case, one buffer will always be granted to each stream, and 7/8 of the
unused buffers will be shared between streams uploading payload, allowing to
significantly improve upload performance. The advertised per-stream window is
automatically adjusted to reflect the available space so that in practice it
should not be required to touch tune.h2.fe.initial-window-size. If less than
the size required to deal with all streams is set, this minimum will be used.
The default value of 1600k (100 streams with 16kB buffers each) permits
roughly 130 Mbps of upload speed for a client with a 100ms RTT.
</pre><div class="page-header"><b>See also:</b> tune.h2.fe.initial-window-size and tune.h2.be.rxbuf.</div>
<a class="anchor" name="tune.h2.header-table-size"></a><a class="anchor" name="3-tune.h2.header-table-size"></a><a class="anchor" name="3.2-tune.h2.header-table-size"></a><a class="anchor" name="tune.h2.header-table-size (Global parameters)"></a><a class="anchor" name="tune.h2.header-table-size (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.h2.header-table-size"></a><a href="#3.2-tune.h2.header-table-size">tune.h2.header-table-size</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the HTTP/2 dynamic header table size. It defaults to 4096 bytes and
cannot be larger than 65536 bytes. A larger value may help certain clients
send more compact requests, depending on their capabilities. This amount of
memory is consumed for each HTTP/2 connection. It is recommended not to
change it.
</pre><a class="anchor" name="tune.h2.initial-window-size"></a><a class="anchor" name="3-tune.h2.initial-window-size"></a><a class="anchor" name="3.2-tune.h2.initial-window-size"></a><a class="anchor" name="tune.h2.initial-window-size (Global parameters)"></a><a class="anchor" name="tune.h2.initial-window-size (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.h2.initial-window-size"></a><a href="#3.2-tune.h2.initial-window-size">tune.h2.initial-window-size</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the default value for the HTTP/2 initial window size, on both incoming
and outgoing connections. This value is used for incoming connections when
tune.h2.fe.initial-window-size is not set, and by outgoing connections when
tune.h2.be.initial-window-size is not set. This setting is used both as the
initial value and as a minimum per stream. The default value equals 16384
(tune.bufsize), which for uploads roughly allows at least 1.25 Mbps of
bandwidth per stream over a network showing a 100 ms ping time, or 125 Mbps
over a 1-ms local network. When less receive buffers than the maximum are in
use, within the limits defined by tune.h2.be.rxbuf and tune.h2.fe.rxbuf,
unused buffers will be shared between receiving streams. As such there is
normally no point in changing this default setting. Given that changing this
default value will both increase upload speeds and cause more unfairness
between clients on downloads, it is recommended to instead use the side-
specific settings tune.h2.fe.initial-window-size and
tune.h2.be.initial-window-size.
</pre><a class="anchor" name="tune.h2.max-concurrent-streams"></a><a class="anchor" name="3-tune.h2.max-concurrent-streams"></a><a class="anchor" name="3.2-tune.h2.max-concurrent-streams"></a><a class="anchor" name="tune.h2.max-concurrent-streams (Global parameters)"></a><a class="anchor" name="tune.h2.max-concurrent-streams (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.h2.max-concurrent-streams"></a><a href="#3.2-tune.h2.max-concurrent-streams">tune.h2.max-concurrent-streams</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the default HTTP/2 maximum number of concurrent streams per connection
(i.e. the number of outstanding requests on a single connection). This value
is used for incoming connections when tune.h2.fe.max-concurrent-streams is
not set, and for outgoing connections when tune.h2.be.max-concurrent-streams
is not set. The default value is 100. The impact varies depending on the side
so please see the two settings above for more details. It is recommended not
to use this setting and to switch to the per-side ones instead. A value of
zero disables the limit so a single client may create as many streams as
allocatable by HAProxy. It is highly recommended not to change this value.
</pre><a class="anchor" name="tune.h2.max-frame-size"></a><a class="anchor" name="3-tune.h2.max-frame-size"></a><a class="anchor" name="3.2-tune.h2.max-frame-size"></a><a class="anchor" name="tune.h2.max-frame-size (Global parameters)"></a><a class="anchor" name="tune.h2.max-frame-size (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.h2.max-frame-size"></a><a href="#3.2-tune.h2.max-frame-size">tune.h2.max-frame-size</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the HTTP/2 maximum frame size that HAProxy announces it is willing to
receive to its peers. The default value is the largest between 16384 and the
buffer size (tune.bufsize). In any case, HAProxy will not announce support
for frame sizes larger than buffers. The main purpose of this setting is to
allow to limit the maximum frame size setting when using large buffers. Too
large frame sizes might have performance impact or cause some peers to
misbehave. It is highly recommended not to change this value.
</pre><a class="anchor" name="tune.h2.zero-copy-fwd-send"></a><a class="anchor" name="3-tune.h2.zero-copy-fwd-send"></a><a class="anchor" name="3.2-tune.h2.zero-copy-fwd-send"></a><a class="anchor" name="tune.h2.zero-copy-fwd-send (Global parameters)"></a><a class="anchor" name="tune.h2.zero-copy-fwd-send (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.h2.zero-copy-fwd-send"></a><a href="#3.2-tune.h2.zero-copy-fwd-send">tune.h2.zero-copy-fwd-send</a></b> <span style="color: #800">{ on | off }</span></div><pre class="text">Enables ('on') of disabled ('off') the zero-copy sends of data for the H2
multiplexer. It is enabled by default.
</pre><div class="page-header"><b>See also:</b> tune.disable-zero-copy-forwarding</div>
<a class="anchor" name="tune.http.cookielen"></a><a class="anchor" name="3-tune.http.cookielen"></a><a class="anchor" name="3.2-tune.http.cookielen"></a><a class="anchor" name="tune.http.cookielen (Global parameters)"></a><a class="anchor" name="tune.http.cookielen (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.http.cookielen"></a><a href="#3.2-tune.http.cookielen">tune.http.cookielen</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum length of captured cookies. This is the maximum value that
the &quot;capture cookie xxx len yyy&quot; will be allowed to take, and any upper value
will automatically be truncated to this one. It is important not to set too
high a value because all cookie captures still allocate this size whatever
their configured value (they share a same pool). This value is per request
per response, so the memory allocated is twice this value per connection.
When not specified, the limit is set to 63 characters. It is recommended not
to change this value.
</pre><a class="anchor" name="tune.http.logurilen"></a><a class="anchor" name="3-tune.http.logurilen"></a><a class="anchor" name="3.2-tune.http.logurilen"></a><a class="anchor" name="tune.http.logurilen (Global parameters)"></a><a class="anchor" name="tune.http.logurilen (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.http.logurilen"></a><a href="#3.2-tune.http.logurilen">tune.http.logurilen</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum length of request URI in logs. This prevents truncating long
request URIs with valuable query strings in log lines. This is not related
to syslog limits. If you increase this limit, you may also increase the
'log ... len yyy' parameter. Your syslog daemon may also need specific
configuration directives too.
The default value is 1024.
</pre><a class="anchor" name="tune.http.maxhdr"></a><a class="anchor" name="3-tune.http.maxhdr"></a><a class="anchor" name="3.2-tune.http.maxhdr"></a><a class="anchor" name="tune.http.maxhdr (Global parameters)"></a><a class="anchor" name="tune.http.maxhdr (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.http.maxhdr"></a><a href="#3.2-tune.http.maxhdr">tune.http.maxhdr</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum number of headers allowed in received HTTP messages. When a
message comes with a number of headers greater than this value (including the
first line), it is rejected with a &quot;400 Bad Request&quot; status code for a
request, or &quot;502 Bad Gateway&quot; for a response. The default value is 101, which
is enough for all usages, considering that the widely deployed Apache server
uses the same limit. It can be useful to push this limit further to
temporarily allow a buggy application to work by the time it gets fixed. The
accepted range is 1..32767. Keep in mind that each new header consumes 32bits
of memory for each stream, so don't push this limit too high.

Note that HTTP/1.1 is a text protocol, so there is no special limit when the
message is sent. The limit during the message parsing is sufficient. HTTP/2
and HTTP/3 are binary protocols and require an encoding step. A limit is set
too when headers are encoded to comply to limitation imposed by the
protocols. This limit is large enough but not documented on purpose. The same
limit is applied on the first steps of the decoding for the same reason.
</pre><a class="anchor" name="tune.idle-pool.shared"></a><a class="anchor" name="3-tune.idle-pool.shared"></a><a class="anchor" name="3.2-tune.idle-pool.shared"></a><a class="anchor" name="tune.idle-pool.shared (Global parameters)"></a><a class="anchor" name="tune.idle-pool.shared (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.idle-pool.shared"></a><a href="#3.2-tune.idle-pool.shared">tune.idle-pool.shared</a></b> <span style="color: #800">{ on | off }</span></div><pre class="text">Enables ('on') or disables ('off') sharing of idle connection pools between
threads for a same server. The default is to share them between threads in
order to minimize the number of persistent connections to a server, and to
optimize the connection reuse rate. But to help with debugging or when
suspecting a bug in HAProxy around connection reuse, it can be convenient to
forcefully disable this idle pool sharing between multiple threads, and force
this option to &quot;off&quot;. The default is on. It is strongly recommended against
disabling this option without setting a conservative value on &quot;<a href="#pool-low-conn">pool-low-conn</a>&quot;
for all servers relying on connection reuse to achieve a high performance
level, otherwise connections might be closed very often as the thread count
increases.
</pre><a class="anchor" name="tune.idletimer"></a><a class="anchor" name="3-tune.idletimer"></a><a class="anchor" name="3.2-tune.idletimer"></a><a class="anchor" name="tune.idletimer (Global parameters)"></a><a class="anchor" name="tune.idletimer (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.idletimer"></a><a href="#3.2-tune.idletimer">tune.idletimer</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Sets the duration after which HAProxy will consider that an empty buffer is
probably associated with an idle stream. This is used to optimally adjust
some packet sizes while forwarding large and small data alternatively. The
decision to use splice() or to send large buffers in SSL is modulated by this
parameter. The value is in milliseconds between 0 and 65535. A value of zero
means that HAProxy will not try to detect idle streams. The default is 1000,
which seems to correctly detect end user pauses (e.g. read a page before
clicking). There should be no reason for changing this value. Please check
tune.ssl.maxrecord below.
</pre><a class="anchor" name="tune.listener.default-shards"></a><a class="anchor" name="3-tune.listener.default-shards"></a><a class="anchor" name="3.2-tune.listener.default-shards"></a><a class="anchor" name="tune.listener.default-shards (Global parameters)"></a><a class="anchor" name="tune.listener.default-shards (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.listener.default-shards"></a><a href="#3.2-tune.listener.default-shards">tune.listener.default-shards</a></b> <span style="color: #800">{ by-process | by-thread | by-group }</span></div><pre class="text">Normally, all &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines will create a single shard, that is, a single
socket that all threads of the process will listen to. With many threads,
this is not very efficient, and may even induce some important overhead in
the kernel for updating the polling state or even distributing events to the
various threads. Modern operating systems support balancing of incoming
connections, a mechanism that will consist in permitting multiple sockets to
be bound to the same address and port, and to evenly distribute all incoming
connections to these sockets so that each thread only sees the connections
that are waiting in the socket it is bound to. This significantly reduces
kernel-side overhead and increases performance in the incoming connection
path. This is usually enabled in HAProxy using the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">shards<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#shards%20%28Peers%29">Peers</a></li><li><a href="#shards%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; setting on &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;
lines, which defaults to 1, meaning that each listener will be unique in the
process. On systems with many processors, it may be more convenient to change
the default setting to &quot;by-thread&quot; in order to always create one listening
socket per thread, or &quot;by-group&quot; in order to always create one listening
socket per thread group. Be careful about the file descriptor usage with
&quot;by-thread&quot; as each listener will need as many sockets as there are threads.
Also some operating systems (e.g. FreeBSD) are limited to no more than 256
sockets on a same address. Note that &quot;by-group&quot; will remain equivalent to
&quot;by-process&quot; for default configurations involving a single thread group, and
will fall back to sharing the same socket on systems that do not support this
mechanism. The default is &quot;by-group&quot; with a fallback to &quot;by-process&quot; for
systems or socket families that do not support multiple bindings.
</pre><a class="anchor" name="tune.listener.multi-queue"></a><a class="anchor" name="3-tune.listener.multi-queue"></a><a class="anchor" name="3.2-tune.listener.multi-queue"></a><a class="anchor" name="tune.listener.multi-queue (Global parameters)"></a><a class="anchor" name="tune.listener.multi-queue (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.listener.multi-queue"></a><a href="#3.2-tune.listener.multi-queue">tune.listener.multi-queue</a></b> <span style="color: #800">{ on | fair | off }</span></div><pre class="text">Enables ('on' / 'fair') or disables ('off') the listener's multi-queue accept
which spreads the incoming traffic to all threads a &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line is allowed to
run on instead of taking them for itself. This provides a smoother traffic
distribution and scales much better, especially in environments where threads
may be unevenly loaded due to external activity (network interrupts colliding
with one thread for example). The default mode, &quot;<a href="#on">on</a>&quot;, optimizes the choice of
a thread by picking in a sample the one with the less connections. It is
often the best choice when connections are long-lived as it manages to keep
all threads busy. A second mode, &quot;fair&quot;, instead cycles through all threads
regardless of their instant load level. It can be better suited for short-
lived connections, or on machines with very large numbers of threads where
the probability to find the least loaded thread with the first mode is low.
Finally it is possible to forcefully disable the redistribution mechanism
using &quot;off&quot; for troubleshooting, or for situations where connections are
short-lived and it is estimated that the operating system already provides a
good enough distribution. The default is &quot;<a href="#on">on</a>&quot;.
</pre><a class="anchor" name="tune.lua.forced-yield"></a><a class="anchor" name="3-tune.lua.forced-yield"></a><a class="anchor" name="3.2-tune.lua.forced-yield"></a><a class="anchor" name="tune.lua.forced-yield (Global parameters)"></a><a class="anchor" name="tune.lua.forced-yield (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.lua.forced-yield"></a><a href="#3.2-tune.lua.forced-yield">tune.lua.forced-yield</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">This directive forces the Lua engine to execute a yield each &lt;number&gt; of
instructions executed. This permits interrupting a long script and allows the
HAProxy scheduler to process other tasks like accepting connections or
forwarding traffic. The default value is 10000 instructions for scripts loaded
using &quot;<a href="#lua-load-per-thread">lua-load-per-thread</a>&quot; and MAX(500, 10000 / nbthread) instructions for
scripts loaded using &quot;<a href="#lua-load">lua-load</a>&quot; (it was found to be an optimal value for
performance while taking care of not creating thread contention with multiple
threads competing for the global lua lock).

If HAProxy often executes some Lua code but more responsiveness is required,
this value can be lowered. If the Lua code is quite long and its result is
absolutely required to process the data, the &lt;number&gt; can be increased, but
the value should be set wisely as in multithreading context it could increase
contention.
</pre><a class="anchor" name="tune.lua.maxmem"></a><a class="anchor" name="3-tune.lua.maxmem"></a><a class="anchor" name="3.2-tune.lua.maxmem"></a><a class="anchor" name="tune.lua.maxmem (Global parameters)"></a><a class="anchor" name="tune.lua.maxmem (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.lua.maxmem"></a><a href="#3.2-tune.lua.maxmem">tune.lua.maxmem</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum amount of RAM in megabytes per process usable by Lua. By
default it is zero which means unlimited. It is important to set a limit to
ensure that a bug in a script will not result in the system running out of
memory.
</pre><a class="anchor" name="tune.lua.session-timeout"></a><a class="anchor" name="3-tune.lua.session-timeout"></a><a class="anchor" name="3.2-tune.lua.session-timeout"></a><a class="anchor" name="tune.lua.session-timeout (Global parameters)"></a><a class="anchor" name="tune.lua.session-timeout (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.lua.session-timeout"></a><a href="#3.2-tune.lua.session-timeout">tune.lua.session-timeout</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">This is the execution timeout for the Lua sessions. This is useful for
preventing infinite loops or spending too much time in Lua. This timeout
counts only the pure Lua runtime. If the Lua does a sleep, the sleep is
not taken in account. The default timeout is 4s.
</pre><a class="anchor" name="tune.lua.burst-timeout"></a><a class="anchor" name="3-tune.lua.burst-timeout"></a><a class="anchor" name="3.2-tune.lua.burst-timeout"></a><a class="anchor" name="tune.lua.burst-timeout (Global parameters)"></a><a class="anchor" name="tune.lua.burst-timeout (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.lua.burst-timeout"></a><a href="#3.2-tune.lua.burst-timeout">tune.lua.burst-timeout</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">The &quot;burst&quot; execution timeout applies to any Lua handler. If the handler
fails to finish or yield before timeout is reached, it will be aborted to
prevent thread contention, to prevent traffic from not being served for too
long, and ultimately to prevent the process from crashing because of the
watchdog kicking in. Unlike other lua timeouts which are yield-cumulative,
burst-timeout will ensure that the time spent in a single lua execution
window does not exceed the configured timeout.

Yielding here means that the lua execution is effectively interrupted
either through an explicit call to lua-yielding function such as
core.(m)sleep() or core.yield(), or following an automatic forced-yield
(see tune.lua.forced-yield) and that it will be resumed later when the
related task is set for rescheduling. Not all lua handlers may yield: we have
to make a distinction between yieldable handlers and unyieldable handlers.

For yieldable handlers (tasks, actions..), reaching the timeout means
&quot;<a href="#tune.lua.forced-yield">tune.lua.forced-yield</a>&quot; might be too high for the system, reducing it
could improve the situation, but it could also be a good idea to check if
adding manual yields at some key points within the lua function helps or not.
It may also indicate that the handler is spending too much time in a specific
lua library function that cannot be interrupted.

For unyieldable handlers (lua converters, sample fetches), it could simply
indicate that the handler is doing too much computation, which could result
from an improper design given that such handlers, which often block the
request execution flow, are expected to terminate quickly to allow the
request processing to go through. A common resolution approach here would be
to try to better optimize the lua function for speed since decreasing
&quot;<a href="#tune.lua.forced-yield">tune.lua.forced-yield</a>&quot; won't help.

This timeout only counts the pure Lua runtime. If the Lua does a core.sleep,
the sleeping time is not taken in account. The default timeout is 1000ms.

Note: if a lua GC cycle is initiated from the handler (either explicitly
requested or automatically triggered by lua after some time), the GC cycle
time will also be accounted for.

Indeed, there is no way to deduce the GC cycle time, so this could lead to
some false positives on saturated systems (where GC is having hard time to
catch up and consumes most of the available execution runtime). If it were
to be the case, here are some resolution leads:

  - checking if the script could be optimized to reduce lua memory footprint
  - fine-tuning lua GC parameters and / or requesting manual GC cycles
    (see: https://www.lua.org/manual/5.4/manual.html#pdf-collectgarbage)
  - increasing tune.lua.burst-timeout

Setting value to 0 completely disables this protection.
</pre><a class="anchor" name="tune.lua.service-timeout"></a><a class="anchor" name="3-tune.lua.service-timeout"></a><a class="anchor" name="3.2-tune.lua.service-timeout"></a><a class="anchor" name="tune.lua.service-timeout (Global parameters)"></a><a class="anchor" name="tune.lua.service-timeout (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.lua.service-timeout"></a><a href="#3.2-tune.lua.service-timeout">tune.lua.service-timeout</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">This is the execution timeout for the Lua services. This is useful for
preventing infinite loops or spending too much time in Lua. This timeout
counts only the pure Lua runtime. If the Lua does a sleep, the sleep is
not taken in account. The default timeout is 4s.
</pre><a class="anchor" name="tune.lua.task-timeout"></a><a class="anchor" name="3-tune.lua.task-timeout"></a><a class="anchor" name="3.2-tune.lua.task-timeout"></a><a class="anchor" name="tune.lua.task-timeout (Global parameters)"></a><a class="anchor" name="tune.lua.task-timeout (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.lua.task-timeout"></a><a href="#3.2-tune.lua.task-timeout">tune.lua.task-timeout</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Purpose is the same as &quot;<a href="#tune.lua.session-timeout">tune.lua.session-timeout</a>&quot;, but this timeout is
dedicated to the tasks. By default, this timeout isn't set because a task may
remain alive during of the lifetime of HAProxy. For example, a task used to
check servers.
</pre><a class="anchor" name="tune.lua.log.loggers"></a><a class="anchor" name="3-tune.lua.log.loggers"></a><a class="anchor" name="3.2-tune.lua.log.loggers"></a><a class="anchor" name="tune.lua.log.loggers (Global parameters)"></a><a class="anchor" name="tune.lua.log.loggers (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.lua.log.loggers"></a><a href="#3.2-tune.lua.log.loggers">tune.lua.log.loggers</a></b> <span style="color: #800">{ on | off }</span></div><pre class="text">Enables ('on') or disables ('off') logging the output of LUA scripts via the
loggers applicable to the current proxy, if any.

Defaults to 'on'.
</pre><a class="anchor" name="tune.lua.log.stderr"></a><a class="anchor" name="3-tune.lua.log.stderr"></a><a class="anchor" name="3.2-tune.lua.log.stderr"></a><a class="anchor" name="tune.lua.log.stderr (Global parameters)"></a><a class="anchor" name="tune.lua.log.stderr (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.lua.log.stderr"></a><a href="#3.2-tune.lua.log.stderr">tune.lua.log.stderr</a></b> <span style="color: #800">{ on | auto | off }</span></div><pre class="text">Enables ('on') or disables ('off') logging the output of LUA scripts via
stderr.
When set to 'auto', logging via stderr is conditionally 'on' if any of:

  - tune.lua.log.loggers is set to 'off'
  - the script is executed in a non-proxy context with no global logger
  - the script is executed in a proxy context with no logger attached

Please note that, when enabled, this logging is in addition to the logging
configured via tune.lua.log.loggers.

Defaults to 'auto'.
</pre><a class="anchor" name="tune.max-checks-per-thread"></a><a class="anchor" name="3-tune.max-checks-per-thread"></a><a class="anchor" name="3.2-tune.max-checks-per-thread"></a><a class="anchor" name="tune.max-checks-per-thread (Global parameters)"></a><a class="anchor" name="tune.max-checks-per-thread (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.max-checks-per-thread"></a><a href="#3.2-tune.max-checks-per-thread">tune.max-checks-per-thread</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the number of active checks per thread above which a thread will
actively try to search a less loaded thread to run the health check, or
queue it until the number of active checks running on it diminishes. The
default value is zero, meaning no such limit is set. It may be needed in
certain environments running an extremely large number of expensive checks
with many threads when the load appears unequal and may make health checks
to randomly time out on startup, typically when using OpenSSL 3.0 which is
about 20 times more CPU-intensive on health checks than older ones. This will
have for result to try to level the health check work across all threads. The
vast majority of configurations do not need to touch this parameter. Please
note that too low values may significantly slow down the health checking if
checks are slow to execute.
</pre><a class="anchor" name="tune.maxaccept"></a><a class="anchor" name="3-tune.maxaccept"></a><a class="anchor" name="3.2-tune.maxaccept"></a><a class="anchor" name="tune.maxaccept (Global parameters)"></a><a class="anchor" name="tune.maxaccept (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.maxaccept"></a><a href="#3.2-tune.maxaccept">tune.maxaccept</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum number of consecutive connections a process may accept in a
row before switching to other work. In single process mode, higher numbers
used to give better performance at high connection rates, though this is not
the case anymore with the multi-queue. This value applies individually to
each listener, so that the number of processes a listener is bound to is
taken into account. This value defaults to 4 which showed best results. If a
significantly higher value was inherited from an ancient config, it might be
worth removing it as it will both increase performance and lower response
time. In multi-process mode, it is divided by twice the number of processes
the listener is bound to. Setting this value to -1 completely disables the
limitation. It should normally not be needed to tweak this value.
</pre><a class="anchor" name="tune.maxpollevents"></a><a class="anchor" name="3-tune.maxpollevents"></a><a class="anchor" name="3.2-tune.maxpollevents"></a><a class="anchor" name="tune.maxpollevents (Global parameters)"></a><a class="anchor" name="tune.maxpollevents (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.maxpollevents"></a><a href="#3.2-tune.maxpollevents">tune.maxpollevents</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum amount of events that can be processed at once in a call to
the polling system. The default value is adapted to the operating system. It
has been noticed that reducing it below 200 tends to slightly decrease
latency at the expense of network bandwidth, and increasing it above 200
tends to trade latency for slightly increased bandwidth.
</pre><a class="anchor" name="tune.maxrewrite"></a><a class="anchor" name="3-tune.maxrewrite"></a><a class="anchor" name="3.2-tune.maxrewrite"></a><a class="anchor" name="tune.maxrewrite (Global parameters)"></a><a class="anchor" name="tune.maxrewrite (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.maxrewrite"></a><a href="#3.2-tune.maxrewrite">tune.maxrewrite</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the reserved buffer space to this size in bytes. The reserved space is
used for header rewriting or appending. The first reads on sockets will never
fill more than bufsize-maxrewrite. Historically it has defaulted to half of
bufsize, though that does not make much sense since there are rarely large
numbers of headers to add. Setting it too high prevents processing of large
requests or responses. Setting it too low prevents addition of new headers
to already large requests or to POST requests. It is generally wise to set it
to about 1024. It is automatically readjusted to half of bufsize if it is
larger than that. This means you don't have to worry about it when changing
bufsize.
</pre><a class="anchor" name="tune.memory.hot-size"></a><a class="anchor" name="3-tune.memory.hot-size"></a><a class="anchor" name="3.2-tune.memory.hot-size"></a><a class="anchor" name="tune.memory.hot-size (Global parameters)"></a><a class="anchor" name="tune.memory.hot-size (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.memory.hot-size"></a><a href="#3.2-tune.memory.hot-size">tune.memory.hot-size</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the per-thread amount of memory that will be kept hot in the local cache
and will never be recoverable by other threads. Access to this memory is very
fast (lockless), and having enough is critical to maintain a good performance
level under extreme thread contention. The value is expressed in bytes, and
the default value is configured at build time via CONFIG_HAP_POOL_CACHE_SIZE
which defaults to 524288 (512 kB). A larger value may increase performance in
some usage scenarios, especially when performance profiles show that memory
allocation is stressed a lot. Experience shows that a good value sits between
once to twice the per CPU core L2 cache size. Too large values will have a
negative impact on performance by making inefficient use of the L3 caches in
the CPUs, and will consume larger amounts of memory. It is recommended not to
change this value, or to proceed in small increments. In order to completely
disable the per-thread CPU caches, using a very small value could work, but
it is better to use &quot;-dMno-cache&quot; on the command-line.
</pre><a class="anchor" name="tune.pattern.cache-size"></a><a class="anchor" name="3-tune.pattern.cache-size"></a><a class="anchor" name="3.2-tune.pattern.cache-size"></a><a class="anchor" name="tune.pattern.cache-size (Global parameters)"></a><a class="anchor" name="tune.pattern.cache-size (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.pattern.cache-size"></a><a href="#3.2-tune.pattern.cache-size">tune.pattern.cache-size</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the size of the pattern lookup cache to &lt;number&gt; entries. This is an LRU
cache which reminds previous lookups and their results. It is used by ACLs
and maps on slow pattern lookups, namely the ones using the &quot;<a href="#sub">sub</a>&quot;, &quot;reg&quot;,
&quot;dir&quot;, &quot;dom&quot;, &quot;end&quot;, &quot;<a href="#bin">bin</a>&quot; match methods as well as the case-insensitive
strings. It applies to pattern expressions which means that it will be able
to memorize the result of a lookup among all the patterns specified on a
configuration line (including all those loaded from files). It automatically
invalidates entries which are updated using HTTP actions or on the CLI. The
default cache size is set to 10000 entries, which limits its footprint to
about 5 MB per process/thread on 32-bit systems and 8 MB per process/thread
on 64-bit systems, as caches are thread/process local. There is a very low
risk of collision in this cache, which is in the order of the size of the
cache divided by 2^64. Typically, at 10000 requests per second with the
default cache size of 10000 entries, there's 1% chance that a brute force
attack could cause a single collision after 60 years, or 0.1% after 6 years.
This is considered much lower than the risk of a memory corruption caused by
aging components. If this is not acceptable, the cache can be disabled by
setting this parameter to 0.
</pre><a class="anchor" name="tune.peers.max-updates-at-once"></a><a class="anchor" name="3-tune.peers.max-updates-at-once"></a><a class="anchor" name="3.2-tune.peers.max-updates-at-once"></a><a class="anchor" name="tune.peers.max-updates-at-once (Global parameters)"></a><a class="anchor" name="tune.peers.max-updates-at-once (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.peers.max-updates-at-once"></a><a href="#3.2-tune.peers.max-updates-at-once">tune.peers.max-updates-at-once</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum number of stick-table updates that haproxy will try to
process at once when sending messages. Retrieving the data for these updates
requires some locking operations which can be CPU intensive on highly
threaded machines if unbound, and may also increase the traffic latency
during the initial batched transfer between an older and a newer process.
Conversely low values may also incur higher CPU overhead, and take longer
to complete. The default value is 200 and it is suggested not to change it.
</pre><a class="anchor" name="tune.pipesize"></a><a class="anchor" name="3-tune.pipesize"></a><a class="anchor" name="3.2-tune.pipesize"></a><a class="anchor" name="tune.pipesize (Global parameters)"></a><a class="anchor" name="tune.pipesize (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.pipesize"></a><a href="#3.2-tune.pipesize">tune.pipesize</a></b> <span style="color: #080">&lt;size&gt;</span></div><pre class="text">Sets the kernel pipe buffer size to this size (in bytes). By default, pipes
are the default size for the system. But sometimes when using TCP splicing,
it can improve performance to increase pipe sizes, especially if it is
suspected that pipes are not filled and that many calls to splice() are
performed. This has an impact on the kernel's memory footprint, so this must
not be changed if impacts are not understood.
</pre><a class="anchor" name="tune.pool-high-fd-ratio"></a><a class="anchor" name="3-tune.pool-high-fd-ratio"></a><a class="anchor" name="3.2-tune.pool-high-fd-ratio"></a><a class="anchor" name="tune.pool-high-fd-ratio (Global parameters)"></a><a class="anchor" name="tune.pool-high-fd-ratio (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.pool-high-fd-ratio"></a><a href="#3.2-tune.pool-high-fd-ratio">tune.pool-high-fd-ratio</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">This setting sets the max number of file descriptors (in percentage) used by
HAProxy globally against the maximum number of file descriptors HAProxy can
use before we start killing idle connections when we can't reuse a connection
and we have to create a new one. The default is 25 (one quarter of the file
descriptor will mean that roughly half of the maximum front connections can
keep an idle connection behind, anything beyond this probably doesn't make
much sense in the general case when targeting connection reuse).
</pre><a class="anchor" name="tune.pool-low-fd-ratio"></a><a class="anchor" name="3-tune.pool-low-fd-ratio"></a><a class="anchor" name="3.2-tune.pool-low-fd-ratio"></a><a class="anchor" name="tune.pool-low-fd-ratio (Global parameters)"></a><a class="anchor" name="tune.pool-low-fd-ratio (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.pool-low-fd-ratio"></a><a href="#3.2-tune.pool-low-fd-ratio">tune.pool-low-fd-ratio</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">This setting sets the max number of file descriptors (in percentage) used by
HAProxy globally against the maximum number of file descriptors HAProxy can
use before we stop putting connection into the idle pool for reuse. The
default is 20.
</pre><a class="anchor" name="tune.pt.zero-copy-forwarding"></a><a class="anchor" name="3-tune.pt.zero-copy-forwarding"></a><a class="anchor" name="3.2-tune.pt.zero-copy-forwarding"></a><a class="anchor" name="tune.pt.zero-copy-forwarding (Global parameters)"></a><a class="anchor" name="tune.pt.zero-copy-forwarding (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.pt.zero-copy-forwarding"></a><a href="#3.2-tune.pt.zero-copy-forwarding">tune.pt.zero-copy-forwarding</a></b> <span style="color: #800">{ on | off }</span></div><pre class="text">Enables ('on') of disabled ('off') the zero-copy forwarding of data for the
pass-through multiplexer. To be used, the kernel splicing must also be
configured. It is enabled by default.
</pre><div class="page-header"><b>See also:</b> tune.disable-zero-copy-forwarding, option splice-auto, option splice-request and option splice-response</div>
<a class="anchor" name="tune.quic.cc-hystart"></a><a class="anchor" name="3-tune.quic.cc-hystart"></a><a class="anchor" name="3.2-tune.quic.cc-hystart"></a><a class="anchor" name="tune.quic.cc-hystart (Global parameters)"></a><a class="anchor" name="tune.quic.cc-hystart (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.quic.cc-hystart"></a><a href="#3.2-tune.quic.cc-hystart">tune.quic.cc-hystart</a></b> <span style="color: #800">{ on | off }</span></div><pre class="text">Enables ('on') or disabled ('off') the HyStart++ (RFC 9406) algorithm for
QUIC connections used as a replacement for the slow start phase of congestion
control algorithms which may cause high packet loss. It is disabled by default.
</pre><a class="anchor" name="tune.quic.cc.cubic.min-losses"></a><a class="anchor" name="3-tune.quic.cc.cubic.min-losses"></a><a class="anchor" name="3.2-tune.quic.cc.cubic.min-losses"></a><a class="anchor" name="tune.quic.cc.cubic.min-losses (Global parameters)"></a><a class="anchor" name="tune.quic.cc.cubic.min-losses (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.quic.cc.cubic.min-losses"></a><a href="#3.2-tune.quic.cc.cubic.min-losses">tune.quic.cc.cubic.min-losses</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Defines how many lost packets are needed for the Cubic congestion control
algorithm to really consider a loss event. Normally, any loss event is
considered as the result of a congestion and is sufficient for Cubic to
restart from a smaller window. But experiments show that there can be a
variety of causes for losses that are not at all caused by congestion and
that can simply be qualified of spurious losses, and for which adjusting the
window will have no effect, except slowing communication down. Poor radio
signal, out-of-order delivery, high CPU usage on a client causing random
delays, as well as system timer imprecision can be among the common causes
for this. This setting allows to make Cubic a bit more tolerant to spurious
losses, by changing the minimum number of cumulated losses between two ACKs
to be considered as a loss event, which defaults to 1. Some significant gains
have been observed experimentally, but always accompanied with an aggravation
of the bandwidth wasted on retransmits, and an increased risk of saturation
of congested links. The value 2 may be used for short periods of time to
compare some metrics. Never go beyond 2 without an expert's prior analysis of
the situation. The default and minimum value is 1. Always use 1.
</pre><a class="anchor" name="tune.quic.disable-udp-gso"></a><a class="anchor" name="3-tune.quic.disable-udp-gso"></a><a class="anchor" name="3.2-tune.quic.disable-udp-gso"></a><a class="anchor" name="tune.quic.disable-udp-gso (Global parameters)"></a><a class="anchor" name="tune.quic.disable-udp-gso (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.quic.disable-udp-gso"></a><a href="#3.2-tune.quic.disable-udp-gso">tune.quic.disable-udp-gso</a></b></div><pre class="text">Disable UDP GSO emission. This kernel feature allows to emit multiple
datagrams via a single system call which is more efficient for large
transfer. It may be useful to disable it on developers suggestion when
suspecting an issue on emission.
</pre><a class="anchor" name="tune.quic.frontend.glitches-threshold"></a><a class="anchor" name="3-tune.quic.frontend.glitches-threshold"></a><a class="anchor" name="3.2-tune.quic.frontend.glitches-threshold"></a><a class="anchor" name="tune.quic.frontend.glitches-threshold (Global parameters)"></a><a class="anchor" name="tune.quic.frontend.glitches-threshold (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.quic.frontend.glitches-threshold"></a><a href="#3.2-tune.quic.frontend.glitches-threshold">tune.quic.frontend.glitches-threshold</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the threshold for the number of glitches on a frontend connection, where
that connection will automatically be killed. This allows to automatically
kill misbehaving connections without having to write explicit rules for them.
The default value is zero, indicating that no threshold is set so that no
event will cause a connection to be closed. Beware that some QUIC clients may
occasionally cause a few glitches over long lasting connection, so any non-
zero value here should probably be in the hundreds or thousands to be
effective without affecting slightly bogus clients.
</pre><div class="page-header"><b>See also:</b> fc_glitches</div>
<a class="anchor" name="tune.quic.frontend.max-idle-timeout"></a><a class="anchor" name="3-tune.quic.frontend.max-idle-timeout"></a><a class="anchor" name="3.2-tune.quic.frontend.max-idle-timeout"></a><a class="anchor" name="tune.quic.frontend.max-idle-timeout (Global parameters)"></a><a class="anchor" name="tune.quic.frontend.max-idle-timeout (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.quic.frontend.max-idle-timeout"></a><a href="#3.2-tune.quic.frontend.max-idle-timeout">tune.quic.frontend.max-idle-timeout</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Sets the QUIC max_idle_timeout transport parameters in milliseconds for
frontends which determines the period of time after which a connection silently
closes if it has remained inactive during an effective period of time deduced
from the two max_idle_timeout values announced by the two endpoints:
  - the minimum of the two values if both are not null,
  - the maximum if only one of them is not null,
  - if both values are null, this feature is disabled.

The default value is 30000.
</pre><a class="anchor" name="tune.quic.frontend.max-streams-bidi"></a><a class="anchor" name="3-tune.quic.frontend.max-streams-bidi"></a><a class="anchor" name="3.2-tune.quic.frontend.max-streams-bidi"></a><a class="anchor" name="tune.quic.frontend.max-streams-bidi (Global parameters)"></a><a class="anchor" name="tune.quic.frontend.max-streams-bidi (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.quic.frontend.max-streams-bidi"></a><a href="#3.2-tune.quic.frontend.max-streams-bidi">tune.quic.frontend.max-streams-bidi</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the QUIC initial_max_streams_bidi transport parameter for frontends.
This is the initial maximum number of bidirectional streams the remote peer
will be authorized to open. This determines the number of concurrent client
requests.

The default value is 100.
</pre><a class="anchor" name="tune.quic.frontend.default-max-window-size"></a><a class="anchor" name="3-tune.quic.frontend.default-max-window-size"></a><a class="anchor" name="3.2-tune.quic.frontend.default-max-window-size"></a><a class="anchor" name="tune.quic.frontend.default-max-window-size (Global parameters)"></a><a class="anchor" name="tune.quic.frontend.default-max-window-size (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.quic.frontend.default-max-window-size"></a><a href="#3.2-tune.quic.frontend.default-max-window-size">tune.quic.frontend.default-max-window-size</a></b> <span style="color: #080">&lt;size&gt;</span></div><pre class="text">Sets the default maximum window size for the congestion controller of a
single QUIC connection. The value must be written as an integer with an
optional suffix 'k', 'm' or 'g'. It must be between 10k and 4g.

QUIC multiplexer also uses the current congestion window size to determine if
it can allocate new stream buffers on data emission. As such, the maximum
congestion window size also serves as a limit on this allocator.

The default value is 480k.

See also the &quot;<a href="#quic-cc-algo">quic-cc-algo</a>&quot; bind option.
</pre><a class="anchor" name="tune.quic.max-frame-loss"></a><a class="anchor" name="3-tune.quic.max-frame-loss"></a><a class="anchor" name="3.2-tune.quic.max-frame-loss"></a><a class="anchor" name="tune.quic.max-frame-loss (Global parameters)"></a><a class="anchor" name="tune.quic.max-frame-loss (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.quic.max-frame-loss"></a><a href="#3.2-tune.quic.max-frame-loss">tune.quic.max-frame-loss</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the limit for which a single QUIC frame can be marked as lost. If
exceeded, the connection is considered as failing and is closed immediately.

The default value is 10.
</pre><a class="anchor" name="tune.quic.reorder-ratio"></a><a class="anchor" name="3-tune.quic.reorder-ratio"></a><a class="anchor" name="3.2-tune.quic.reorder-ratio"></a><a class="anchor" name="tune.quic.reorder-ratio (Global parameters)"></a><a class="anchor" name="tune.quic.reorder-ratio (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.quic.reorder-ratio"></a><a href="#3.2-tune.quic.reorder-ratio">tune.quic.reorder-ratio</a></b> <span style="color: #080">&lt;0..100, in percent&gt;</span></div><pre class="text">The ratio applied to the packet reordering threshold calculated. It may
trigger a high packet loss detection when too small.

The default value is 50.
</pre><a class="anchor" name="tune.quic.retry-threshold"></a><a class="anchor" name="3-tune.quic.retry-threshold"></a><a class="anchor" name="3.2-tune.quic.retry-threshold"></a><a class="anchor" name="tune.quic.retry-threshold (Global parameters)"></a><a class="anchor" name="tune.quic.retry-threshold (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.quic.retry-threshold"></a><a href="#3.2-tune.quic.retry-threshold">tune.quic.retry-threshold</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Dynamically enables the Retry feature for all the configured QUIC listeners
as soon as this number of half open connections is reached. A half open
connection is a connection whose handshake has not already successfully
completed or failed. To be functional this setting needs a cluster secret to
be set, if not it will be silently ignored (see &quot;<a href="#cluster-secret">cluster-secret</a>&quot; setting).
This setting will be also silently ignored if the use of QUIC Retry was
forced (see &quot;<a href="#quic-force-retry">quic-force-retry</a>&quot;).

The default value is 100.

See https://www.rfc-editor.org/rfc/rfc9000.html#section-8.1.2 for more
information about QUIC retry.
</pre><a class="anchor" name="tune.quic.socket-owner"></a><a class="anchor" name="3-tune.quic.socket-owner"></a><a class="anchor" name="3.2-tune.quic.socket-owner"></a><a class="anchor" name="tune.quic.socket-owner (Global parameters)"></a><a class="anchor" name="tune.quic.socket-owner (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.quic.socket-owner"></a><a href="#3.2-tune.quic.socket-owner">tune.quic.socket-owner</a></b> <span style="color: #800">{ connection | listener }</span></div><pre class="text">Specifies globally how QUIC connections will use socket for receive/send
operations. Connections can share listener socket or each connection can
allocate its own socket.

When default &quot;connection&quot; value is set, a dedicated socket will be allocated
by every QUIC connections. This option is the preferred one to achieve the
best performance with a large QUIC traffic. This is also the only way to
ensure soft-stop is conducted properly without data loss for QUIC connections
and cases of transient errors during sendto() operation are handled
efficiently. However, this relies on some advanced features from the UDP
network stack. If your platform is deemed not compatible, haproxy will
automatically switch to &quot;listener&quot; mode on startup. Please note that QUIC
listeners running on privileged ports may require to run as uid 0, or some
OS-specific tuning to permit the target uid to bind such ports, such as
system capabilities. See also the &quot;<a href="#setcap">setcap</a>&quot; global directive.

The &quot;listener&quot; value indicates that QUIC transfers will occur on the shared
listener socket. This option can be a good compromise for small traffic as it
allows to reduce FD consumption. However, performance won't be optimal due to
a higher CPU usage if listeners are shared across a lot of threads or a
large number of QUIC connections can be used simultaneously.

This setting is applied in conjunction with each &quot;<a href="#quic-socket">quic-socket</a>&quot; bind options.
If &quot;connection&quot; mode is used on global tuning, it will be activated for each
listener, unless its bind option is set to &quot;listener&quot;. However, if &quot;listener&quot;
is used globally, it will be forced on every listener instance, regardless of
their individual configuration.
</pre><a class="anchor" name="tune.quic.zero-copy-fwd-send"></a><a class="anchor" name="3-tune.quic.zero-copy-fwd-send"></a><a class="anchor" name="3.2-tune.quic.zero-copy-fwd-send"></a><a class="anchor" name="tune.quic.zero-copy-fwd-send (Global parameters)"></a><a class="anchor" name="tune.quic.zero-copy-fwd-send (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.quic.zero-copy-fwd-send"></a><a href="#3.2-tune.quic.zero-copy-fwd-send">tune.quic.zero-copy-fwd-send</a></b> <span style="color: #800">{ on | off }</span></div><pre class="text">Enables ('on') of disabled ('off') the zero-copy sends of data for the QUIC
multiplexer. It is enabled by default.
</pre><div class="page-header"><b>See also:</b> tune.disable-zero-copy-forwarding</div>
<a class="anchor" name="tune.renice.runtime"></a><a class="anchor" name="3-tune.renice.runtime"></a><a class="anchor" name="3.2-tune.renice.runtime"></a><a class="anchor" name="tune.renice.runtime (Global parameters)"></a><a class="anchor" name="tune.renice.runtime (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.renice.runtime"></a><a href="#3.2-tune.renice.runtime">tune.renice.runtime</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">This configuration option takes a value between -20 and 19. It applies a
scheduling priority as documented in man 2 setpriority. This priority is
applied after the configuration parsing, which means only the worker or the
standalone process will apply it. It is usually configured to set a higher
priority than a process doing configuration parsing (tune.renice.startup).
</pre><div class="page-header"><b>See also:</b> tune.renice.startup</div>
<a class="anchor" name="tune.renice.startup"></a><a class="anchor" name="3-tune.renice.startup"></a><a class="anchor" name="3.2-tune.renice.startup"></a><a class="anchor" name="tune.renice.startup (Global parameters)"></a><a class="anchor" name="tune.renice.startup (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.renice.startup"></a><a href="#3.2-tune.renice.startup">tune.renice.startup</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">This configuration option takes a value between -20 and 19. It applies a
scheduling priority as documented in man 2 setpriority. This priority is
applied before applying the rest of the configuration which can be useful if
you want to lower the priority for configuration parsing. This is applied on
the standalone process or the worker before configuration parsing. Once the
configuration is parsed, the previous priority is restored unless
tune.renice.runtime is used.
</pre><div class="page-header"><b>See also:</b> tune.renice.runtime</div>
<a class="anchor" name="tune.rcvbuf.backend"></a><a class="anchor" name="3-tune.rcvbuf.backend"></a><a class="anchor" name="3.2-tune.rcvbuf.backend"></a><a class="anchor" name="tune.rcvbuf.backend (Global parameters)"></a><a class="anchor" name="tune.rcvbuf.backend (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.rcvbuf.backend"></a><a href="#3.2-tune.rcvbuf.backend">tune.rcvbuf.backend</a></b>  <span style="color: #080">&lt;size&gt;</span></div><a class="anchor" name="tune.rcvbuf.frontend"></a><a class="anchor" name="3-tune.rcvbuf.frontend"></a><a class="anchor" name="3.2-tune.rcvbuf.frontend"></a><a class="anchor" name="tune.rcvbuf.frontend (Global parameters)"></a><a class="anchor" name="tune.rcvbuf.frontend (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.rcvbuf.frontend"></a><a href="#3.2-tune.rcvbuf.frontend">tune.rcvbuf.frontend</a></b> <span style="color: #080">&lt;size&gt;</span></div><pre class="text">For the kernel socket receive buffer size on non-connected sockets to this
size. This can be used QUIC in listener mode and log-forward on the frontend.
The default system buffers might sometimes be too small for sockets receiving
lots of aggregated traffic, causing some losses and possibly retransmits (in
case of QUIC), possibly slowing down connection establishment under heavy
traffic. The value is expressed in bytes, applied to each socket. In listener
mode, sockets are shared between all connections, and the total number of
sockets depends on the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">shards<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#shards%20%28Peers%29">Peers</a></li><li><a href="#shards%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; value of the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line. There's no good
value, a good one corresponds to an expected size per connection multiplied
by the expected number of connections. The kernel may trim large values. See
also &quot;<a href="#tune.rcvbuf.client">tune.rcvbuf.client</a>&quot; and &quot;<a href="#tune.rcvbuf.server">tune.rcvbuf.server</a>&quot; for their connected socket
counter parts, as well as &quot;<a href="#tune.sndbuf.backend">tune.sndbuf.backend</a>&quot; and &quot;<a href="#tune.sndbuf.frontend">tune.sndbuf.frontend</a>&quot;
for the send setting.
</pre><a class="anchor" name="tune.rcvbuf.client"></a><a class="anchor" name="3-tune.rcvbuf.client"></a><a class="anchor" name="3.2-tune.rcvbuf.client"></a><a class="anchor" name="tune.rcvbuf.client (Global parameters)"></a><a class="anchor" name="tune.rcvbuf.client (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.rcvbuf.client"></a><a href="#3.2-tune.rcvbuf.client">tune.rcvbuf.client</a></b> <span style="color: #080">&lt;size&gt;</span></div><a class="anchor" name="tune.rcvbuf.server"></a><a class="anchor" name="3-tune.rcvbuf.server"></a><a class="anchor" name="3.2-tune.rcvbuf.server"></a><a class="anchor" name="tune.rcvbuf.server (Global parameters)"></a><a class="anchor" name="tune.rcvbuf.server (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.rcvbuf.server"></a><a href="#3.2-tune.rcvbuf.server">tune.rcvbuf.server</a></b> <span style="color: #080">&lt;size&gt;</span></div><pre class="text">Forces the kernel socket receive buffer size on the client or the server side
to the specified value in bytes. This value applies to all TCP/HTTP frontends
and backends. It should normally never be set, and the default size (0) lets
the kernel auto-tune this value depending on the amount of available memory.
However it can sometimes help to set it to very low values (e.g. 4096) in
order to save kernel memory by preventing it from buffering too large amounts
of received data. Lower values will significantly increase CPU usage though.
</pre><a class="anchor" name="tune.recv_enough"></a><a class="anchor" name="3-tune.recv_enough"></a><a class="anchor" name="3.2-tune.recv_enough"></a><a class="anchor" name="tune.recv_enough (Global parameters)"></a><a class="anchor" name="tune.recv_enough (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.recv_enough"></a><a href="#3.2-tune.recv_enough">tune.recv_enough</a></b> <span style="color: #080">&lt;size&gt;</span></div><pre class="text">HAProxy uses some hints to detect that a short read indicates the end of the
socket buffers. One of them is that a read returns more than &lt;recv_enough&gt;
bytes, which defaults to 10136 (7 segments of 1448 each). This default value
may be changed by this setting to better deal with workloads involving lots
of short messages such as telnet or SSH sessions.
</pre><a class="anchor" name="tune.ring.queues"></a><a class="anchor" name="3-tune.ring.queues"></a><a class="anchor" name="3.2-tune.ring.queues"></a><a class="anchor" name="tune.ring.queues (Global parameters)"></a><a class="anchor" name="tune.ring.queues (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.ring.queues"></a><a href="#3.2-tune.ring.queues">tune.ring.queues</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the number of write queues in front of ring buffers. This can have an
effect on the CPU usage of traces during debugging sessions, and both too
low or too large a value can have an important effect. The good value was
determined experimentally by developers and there should be no reason to
try to change it unless instructed to do so in order to try to address
specific issues. Such a setting should not be left in the configuration
across version upgrades because its optimal value may evolve over time.
</pre><a class="anchor" name="tune.runqueue-depth"></a><a class="anchor" name="3-tune.runqueue-depth"></a><a class="anchor" name="3.2-tune.runqueue-depth"></a><a class="anchor" name="tune.runqueue-depth (Global parameters)"></a><a class="anchor" name="tune.runqueue-depth (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.runqueue-depth"></a><a href="#3.2-tune.runqueue-depth">tune.runqueue-depth</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum amount of task that can be processed at once when running
tasks. The default value depends on the number of threads but sits between 35
and 280, which tend to show the highest request rates and lowest latencies.
Increasing it may incur latency when dealing with I/Os, making it too small
can incur extra overhead. Higher thread counts benefit from lower values.
When experimenting with much larger values, it may be useful to also enable
tune.sched.low-latency and possibly tune.fd.edge-triggered to limit the
maximum latency to the lowest possible.
</pre><a class="anchor" name="tune.sched.low-latency"></a><a class="anchor" name="3-tune.sched.low-latency"></a><a class="anchor" name="3.2-tune.sched.low-latency"></a><a class="anchor" name="tune.sched.low-latency (Global parameters)"></a><a class="anchor" name="tune.sched.low-latency (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.sched.low-latency"></a><a href="#3.2-tune.sched.low-latency">tune.sched.low-latency</a></b> <span style="color: #800">{ on | off }</span></div><pre class="text">Enables ('on') or disables ('off') the low-latency task scheduler. By default
HAProxy processes tasks from several classes one class at a time as this is
the most efficient. But when running with large values of tune.runqueue-depth
this can have a measurable effect on request or connection latency. When this
low-latency setting is enabled, tasks of lower priority classes will always
be executed before other ones if they exist. This will permit to lower the
maximum latency experienced by new requests or connections in the middle of
massive traffic, at the expense of a higher impact on this large traffic.
For regular usage it is better to leave this off. The default value is off.
</pre><a class="anchor" name="tune.sndbuf.backend"></a><a class="anchor" name="3-tune.sndbuf.backend"></a><a class="anchor" name="3.2-tune.sndbuf.backend"></a><a class="anchor" name="tune.sndbuf.backend (Global parameters)"></a><a class="anchor" name="tune.sndbuf.backend (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.sndbuf.backend"></a><a href="#3.2-tune.sndbuf.backend">tune.sndbuf.backend</a></b>  <span style="color: #080">&lt;size&gt;</span></div><a class="anchor" name="tune.sndbuf.frontend"></a><a class="anchor" name="3-tune.sndbuf.frontend"></a><a class="anchor" name="3.2-tune.sndbuf.frontend"></a><a class="anchor" name="tune.sndbuf.frontend (Global parameters)"></a><a class="anchor" name="tune.sndbuf.frontend (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.sndbuf.frontend"></a><a href="#3.2-tune.sndbuf.frontend">tune.sndbuf.frontend</a></b> <span style="color: #080">&lt;size&gt;</span></div><pre class="text">For the kernel socket send buffer size on non-connected sockets to this size.
This can be used for UNIX socket and UDP logging on the backend side, and for
QUIC in listener mode on the frontend. The default system buffers might
sometimes be too small for sockets shared between many connections (or log
senders), causing some losses and possibly retransmits, slowing down new
connection establishment under high traffic. The value is expressed in bytes,
applied to each socket. In listener mode, sockets are shared between all
connections, and the total number of sockets depends on the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">shards<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#shards%20%28Peers%29">Peers</a></li><li><a href="#shards%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; value of
the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line. There's no good value, a good one corresponds to an expected
size per connection multiplied by the expected number of connections. The
kernel may trim large values. See also &quot;<a href="#tune.sndbuf.client">tune.sndbuf.client</a>&quot; and
&quot;<a href="#tune.sndbuf.server">tune.sndbuf.server</a>&quot; for their connected socket counter parts, as well as
&quot;<a href="#tune.rcvbuf.backend">tune.rcvbuf.backend</a>&quot; and &quot;<a href="#tune.rcvbuf.frontend">tune.rcvbuf.frontend</a>&quot; for the receive setting.
</pre><a class="anchor" name="tune.sndbuf.client"></a><a class="anchor" name="3-tune.sndbuf.client"></a><a class="anchor" name="3.2-tune.sndbuf.client"></a><a class="anchor" name="tune.sndbuf.client (Global parameters)"></a><a class="anchor" name="tune.sndbuf.client (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.sndbuf.client"></a><a href="#3.2-tune.sndbuf.client">tune.sndbuf.client</a></b> <span style="color: #080">&lt;size&gt;</span></div><a class="anchor" name="tune.sndbuf.server"></a><a class="anchor" name="3-tune.sndbuf.server"></a><a class="anchor" name="3.2-tune.sndbuf.server"></a><a class="anchor" name="tune.sndbuf.server (Global parameters)"></a><a class="anchor" name="tune.sndbuf.server (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.sndbuf.server"></a><a href="#3.2-tune.sndbuf.server">tune.sndbuf.server</a></b> <span style="color: #080">&lt;size&gt;</span></div><pre class="text">Forces the kernel socket send buffer size on the client or the server side to
the specified value in bytes. This value applies to all TCP/HTTP frontends
and backends. It should normally never be set, and the default size (0) lets
the kernel auto-tune this value depending on the amount of available memory.
However it can sometimes help to set it to very low values (e.g. 4096) in
order to save kernel memory by preventing it from buffering too large amounts
of received data. Lower values will significantly increase CPU usage though.
Another use case is to prevent write timeouts with extremely slow clients due
to the kernel waiting for a large part of the buffer to be read before
notifying HAProxy again.
</pre><a class="anchor" name="tune.ssl.cachesize"></a><a class="anchor" name="3-tune.ssl.cachesize"></a><a class="anchor" name="3.2-tune.ssl.cachesize"></a><a class="anchor" name="tune.ssl.cachesize (Global parameters)"></a><a class="anchor" name="tune.ssl.cachesize (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.ssl.cachesize"></a><a href="#3.2-tune.ssl.cachesize">tune.ssl.cachesize</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the size of the global SSL session cache, in a number of blocks. A block
is large enough to contain an encoded session without peer certificate.  An
encoded session with peer certificate is stored in multiple blocks depending
on the size of the peer certificate. A block uses approximately 200 bytes of
memory (based on `sizeof(struct sh_ssl_sess_hdr) + SHSESS_BLOCK_MIN_SIZE`
calculation used for `shctx_init` function). The default value may be forced
at build time, otherwise defaults to 20000. When the cache is full, the most
idle entries are purged and reassigned. Higher values reduce the occurrence
of such a purge, hence the number of CPU-intensive SSL handshakes by ensuring
that all users keep their session as long as possible. All entries are
pre-allocated upon startup. Setting this value to 0 disables the SSL session
cache.
</pre><a class="anchor" name="tune.ssl.capture-buffer-size"></a><a class="anchor" name="3-tune.ssl.capture-buffer-size"></a><a class="anchor" name="3.2-tune.ssl.capture-buffer-size"></a><a class="anchor" name="tune.ssl.capture-buffer-size (Global parameters)"></a><a class="anchor" name="tune.ssl.capture-buffer-size (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.ssl.capture-buffer-size"></a><a href="#3.2-tune.ssl.capture-buffer-size">tune.ssl.capture-buffer-size</a></b> <span style="color: #080">&lt;number&gt;</span></div><a class="anchor" name="tune.ssl.capture-cipherlist-size"></a><a class="anchor" name="3-tune.ssl.capture-cipherlist-size"></a><a class="anchor" name="3.2-tune.ssl.capture-cipherlist-size"></a><a class="anchor" name="tune.ssl.capture-cipherlist-size (Global parameters)"></a><a class="anchor" name="tune.ssl.capture-cipherlist-size (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.ssl.capture-cipherlist-size"></a><a href="#3.2-tune.ssl.capture-cipherlist-size">tune.ssl.capture-cipherlist-size</a></b> <span style="color: #080">&lt;number&gt;</span> <span class="label label-warning">(deprecated)</span></div><pre class="text">Sets the maximum size of the buffer used for capturing client hello cipher
list, extensions list, elliptic curves list and elliptic curve point
formats. If the value is 0 (default value) the capture is disabled,
otherwise a buffer is allocated for each SSL/TLS connection.
</pre><a class="anchor" name="tune.ssl.default-dh-param"></a><a class="anchor" name="3-tune.ssl.default-dh-param"></a><a class="anchor" name="3.2-tune.ssl.default-dh-param"></a><a class="anchor" name="tune.ssl.default-dh-param (Global parameters)"></a><a class="anchor" name="tune.ssl.default-dh-param (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.ssl.default-dh-param"></a><a href="#3.2-tune.ssl.default-dh-param">tune.ssl.default-dh-param</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum size of the Diffie-Hellman parameters used for generating
the ephemeral/temporary Diffie-Hellman key in case of DHE key exchange. The
final size will try to match the size of the server's RSA (or DSA) key (e.g,
a 2048 bits temporary DH key for a 2048 bits RSA key), but will not exceed
this maximum value. Only 1024 or higher values are allowed. Higher values
will increase the CPU load, and values greater than 1024 bits are not
supported by Java 7 and earlier clients. This value is not used if static
Diffie-Hellman parameters are supplied either directly in the certificate
file or by using the ssl-dh-param-file parameter.
If there is neither a default-dh-param nor a ssl-dh-param-file defined, and
if the server's PEM file of a given frontend does not specify its own DH
parameters, then DHE ciphers will be unavailable for this frontend.
</pre><a class="anchor" name="tune.ssl.force-private-cache"></a><a class="anchor" name="3-tune.ssl.force-private-cache"></a><a class="anchor" name="3.2-tune.ssl.force-private-cache"></a><a class="anchor" name="tune.ssl.force-private-cache (Global parameters)"></a><a class="anchor" name="tune.ssl.force-private-cache (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.ssl.force-private-cache"></a><a href="#3.2-tune.ssl.force-private-cache">tune.ssl.force-private-cache</a></b></div><pre class="text">This option disables SSL session cache sharing between all processes. It
should normally not be used since it will force many renegotiations due to
clients hitting a random process. But it may be required on some operating
systems where none of the SSL cache synchronization method may be used. In
this case, adding a first layer of hash-based load balancing before the SSL
layer might limit the impact of the lack of session sharing.
</pre><a class="anchor" name="tune.ssl.hard-maxrecord"></a><a class="anchor" name="3-tune.ssl.hard-maxrecord"></a><a class="anchor" name="3.2-tune.ssl.hard-maxrecord"></a><a class="anchor" name="tune.ssl.hard-maxrecord (Global parameters)"></a><a class="anchor" name="tune.ssl.hard-maxrecord (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.ssl.hard-maxrecord"></a><a href="#3.2-tune.ssl.hard-maxrecord">tune.ssl.hard-maxrecord</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum amount of bytes passed to SSL_write() at any time. Default
value 0 means there is no limit. In contrast to tune.ssl.maxrecord this
settings will not be adjusted dynamically. Smaller records may decrease
throughput, but may be required when dealing with low-footprint clients.
</pre><a class="anchor" name="tune.ssl.keylog"></a><a class="anchor" name="3-tune.ssl.keylog"></a><a class="anchor" name="3.2-tune.ssl.keylog"></a><a class="anchor" name="tune.ssl.keylog (Global parameters)"></a><a class="anchor" name="tune.ssl.keylog (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.ssl.keylog"></a><a href="#3.2-tune.ssl.keylog">tune.ssl.keylog</a></b> <span style="color: #800">{ on | off }</span></div><pre class="text">This option activates the logging of the TLS keys. It should be used with
care as it will consume more memory per SSL session and could decrease
performances. This is disabled by default.

These sample fetches should be used to generate the SSLKEYLOGFILE that is
required to decipher traffic with wireshark.

https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/Key_Log_Format

The SSLKEYLOG is a series of lines which are formatted this way:

  &lt;Label&gt; &lt;space&gt; &lt;ClientRandom&gt; &lt;space&gt; &lt;Secret&gt;

The ClientRandom is provided by the %[ssl_fc_client_random,hex] sample
fetch, the secret and the Label could be find in the array below. You need
to generate a SSLKEYLOGFILE with all the labels in this array.

The following sample fetches are hexadecimal strings and does not need to be
converted.

SSLKEYLOGFILE Label             |  Sample fetches for the Secrets
--------------------------------|-----------------------------------------
CLIENT_EARLY_TRAFFIC_SECRET     |  %[ssl_xx_client_early_traffic_secret]
CLIENT_HANDSHAKE_TRAFFIC_SECRET |  %[ssl_xx_client_handshake_traffic_secret]
SERVER_HANDSHAKE_TRAFFIC_SECRET |  %[ssl_xx_server_handshake_traffic_secret]
CLIENT_TRAFFIC_SECRET_0         |  %[ssl_xx_client_traffic_secret_0]
SERVER_TRAFFIC_SECRET_0         |  %[ssl_xx_server_traffic_secret_0]
EXPORTER_SECRET                 |  %[ssl_xx_exporter_secret]
EARLY_EXPORTER_SECRET           |  %[ssl_xx_early_exporter_secret]

These fetches exists for frontend (fc) or backend (bc) sides, replace &quot;xx&quot; by
&quot;fc&quot; or &quot;bc&quot; to use the right side.

This is only available with OpenSSL 1.1.1, and useful with TLS1.3 session.

If you want to generate the content of a SSLKEYLOGFILE with TLS &lt; 1.3, you
only need this line:

&quot;CLIENT_RANDOM %[ssl_fc_client_random,hex] %[ssl_fc_session_key,hex]&quot;

A complete keylog could be generate with a log-format these way, even though
this is not ideal for syslog:

  log-format &quot;CLIENT_EARLY_TRAFFIC_SECRET %[ssl_bc_client_random,hex] %[ssl_bc_client_early_traffic_secret]\n
              CLIENT_HANDSHAKE_TRAFFIC_SECRET %[ssl_bc_client_random,hex] %[ssl_bc_client_handshake_traffic_secret]\n
              SERVER_HANDSHAKE_TRAFFIC_SECRET %[ssl_bc_client_random,hex] %[ssl_bc_server_handshake_traffic_secret]\n
              CLIENT_TRAFFIC_SECRET_0 %[ssl_bc_client_random,hex] %[ssl_bc_client_traffic_secret_0]\n
              SERVER_TRAFFIC_SECRET_0 %[ssl_bc_client_random,hex] %[ssl_bc_server_traffic_secret_0]\n
              EXPORTER_SECRET %[ssl_bc_client_random,hex] %[ssl_bc_exporter_secret]\n
              EARLY_EXPORTER_SECRET %[ssl_bc_client_random,hex] %[ssl_bc_early_exporter_secret]&quot;
</pre><a class="anchor" name="tune.ssl.lifetime"></a><a class="anchor" name="3-tune.ssl.lifetime"></a><a class="anchor" name="3.2-tune.ssl.lifetime"></a><a class="anchor" name="tune.ssl.lifetime (Global parameters)"></a><a class="anchor" name="tune.ssl.lifetime (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.ssl.lifetime"></a><a href="#3.2-tune.ssl.lifetime">tune.ssl.lifetime</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Sets how long a cached SSL session may remain valid. This time is expressed
in seconds and defaults to 300 (5 min). It is important to understand that it
does not guarantee that sessions will last that long, because if the cache is
full, the longest idle sessions will be purged despite their configured
lifetime. The real usefulness of this setting is to prevent sessions from
being used for too long.
</pre><a class="anchor" name="tune.ssl.maxrecord"></a><a class="anchor" name="3-tune.ssl.maxrecord"></a><a class="anchor" name="3.2-tune.ssl.maxrecord"></a><a class="anchor" name="tune.ssl.maxrecord (Global parameters)"></a><a class="anchor" name="tune.ssl.maxrecord (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.ssl.maxrecord"></a><a href="#3.2-tune.ssl.maxrecord">tune.ssl.maxrecord</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the maximum amount of bytes passed to SSL_write() at the beginning of
the data transfer. Default value 0 means there is no limit. Over SSL/TLS,
the client can decipher the data only once it has received a full record.
With large records, it means that clients might have to download up to 16kB
of data before starting to process them. Limiting the value can improve page
load times on browsers located over high latency or low bandwidth networks.
It is suggested to find optimal values which fit into 1 or 2 TCP segments
(generally 1448 bytes over Ethernet with TCP timestamps enabled, or 1460 when
timestamps are disabled), keeping in mind that SSL/TLS add some overhead.
Typical values of 1419 and 2859 gave good results during tests. Use
&quot;strace -e trace=write&quot; to find the best value. HAProxy will automatically
switch to this setting after an idle stream has been detected (see
tune.idletimer above). See also tune.ssl.hard-maxrecord.
</pre><a class="anchor" name="tune.ssl.ssl-ctx-cache-size"></a><a class="anchor" name="3-tune.ssl.ssl-ctx-cache-size"></a><a class="anchor" name="3.2-tune.ssl.ssl-ctx-cache-size"></a><a class="anchor" name="tune.ssl.ssl-ctx-cache-size (Global parameters)"></a><a class="anchor" name="tune.ssl.ssl-ctx-cache-size (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.ssl.ssl-ctx-cache-size"></a><a href="#3.2-tune.ssl.ssl-ctx-cache-size">tune.ssl.ssl-ctx-cache-size</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the size of the cache used to store generated certificates to &lt;number&gt;
entries. This is a LRU cache. Because generating a SSL certificate
dynamically is expensive, they are cached. The default cache size is set to
1000 entries.
</pre><a class="anchor" name="tune.stick-counters"></a><a class="anchor" name="3-tune.stick-counters"></a><a class="anchor" name="3.2-tune.stick-counters"></a><a class="anchor" name="tune.stick-counters (Global parameters)"></a><a class="anchor" name="tune.stick-counters (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.stick-counters"></a><a href="#3.2-tune.stick-counters">tune.stick-counters</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the number of stick-counters that may be tracked at the same time by a
connection or a request via &quot;track-sc*&quot; actions in &quot;<a href="#tcp-request">tcp-request</a>&quot; or
&quot;<a href="#http-request">http-request</a>&quot; rules. The default value is set at build time by the macro
MAX_SESS_STK_CTR, and defaults to 3. With this setting it is possible to
change the value and ignore the one passed at build time. Increasing this
value may be needed when porting complex configurations to haproxy, but users
are warned against the costs: each entry takes 16 bytes per connection and
16 bytes per request, all of which need to be allocated and zeroed for all
requests even when not used. As such a value of 10 will inflate the memory
consumption per request by 320 bytes and will cause this memory to be erased
for each request, which does have measurable CPU impacts. Conversely, when
no &quot;track-sc&quot; rules are used, the value may be lowered (0 being valid to
entirely disable stick-counters).
</pre><a class="anchor" name="tune.vars.global-max-size"></a><a class="anchor" name="3-tune.vars.global-max-size"></a><a class="anchor" name="3.2-tune.vars.global-max-size"></a><a class="anchor" name="tune.vars.global-max-size (Global parameters)"></a><a class="anchor" name="tune.vars.global-max-size (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.vars.global-max-size"></a><a href="#3.2-tune.vars.global-max-size">tune.vars.global-max-size</a></b> <span style="color: #080">&lt;size&gt;</span></div><a class="anchor" name="tune.vars.proc-max-size"></a><a class="anchor" name="3-tune.vars.proc-max-size"></a><a class="anchor" name="3.2-tune.vars.proc-max-size"></a><a class="anchor" name="tune.vars.proc-max-size (Global parameters)"></a><a class="anchor" name="tune.vars.proc-max-size (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.vars.proc-max-size"></a><a href="#3.2-tune.vars.proc-max-size">tune.vars.proc-max-size</a></b> <span style="color: #080">&lt;size&gt;</span></div><a class="anchor" name="tune.vars.reqres-max-size"></a><a class="anchor" name="3-tune.vars.reqres-max-size"></a><a class="anchor" name="3.2-tune.vars.reqres-max-size"></a><a class="anchor" name="tune.vars.reqres-max-size (Global parameters)"></a><a class="anchor" name="tune.vars.reqres-max-size (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.vars.reqres-max-size"></a><a href="#3.2-tune.vars.reqres-max-size">tune.vars.reqres-max-size</a></b> <span style="color: #080">&lt;size&gt;</span></div><a class="anchor" name="tune.vars.sess-max-size"></a><a class="anchor" name="3-tune.vars.sess-max-size"></a><a class="anchor" name="3.2-tune.vars.sess-max-size"></a><a class="anchor" name="tune.vars.sess-max-size (Global parameters)"></a><a class="anchor" name="tune.vars.sess-max-size (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.vars.sess-max-size"></a><a href="#3.2-tune.vars.sess-max-size">tune.vars.sess-max-size</a></b> <span style="color: #080">&lt;size&gt;</span></div><a class="anchor" name="tune.vars.txn-max-size"></a><a class="anchor" name="3-tune.vars.txn-max-size"></a><a class="anchor" name="3.2-tune.vars.txn-max-size"></a><a class="anchor" name="tune.vars.txn-max-size (Global parameters)"></a><a class="anchor" name="tune.vars.txn-max-size (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.vars.txn-max-size"></a><a href="#3.2-tune.vars.txn-max-size">tune.vars.txn-max-size</a></b> <span style="color: #080">&lt;size&gt;</span></div><pre class="text">These five tunes help to manage the maximum amount of memory used by the
variables system. &quot;global&quot; limits the overall amount of memory available for
all scopes. &quot;<a href="#proc">proc</a>&quot; limits the memory for the process scope, &quot;sess&quot; limits the
memory for the session scope, &quot;txn&quot; for the transaction scope, and &quot;reqres&quot;
limits the memory for each request or response processing.
Memory accounting is hierarchical, meaning more coarse grained limits include
the finer grained ones: &quot;<a href="#proc">proc</a>&quot; includes &quot;sess&quot;, &quot;sess&quot; includes &quot;txn&quot;, and
&quot;txn&quot; includes &quot;reqres&quot;.

For example, when &quot;<a href="#tune.vars.sess-max-size">tune.vars.sess-max-size</a>&quot; is limited to 100,
&quot;<a href="#tune.vars.txn-max-size">tune.vars.txn-max-size</a>&quot; and &quot;<a href="#tune.vars.reqres-max-size">tune.vars.reqres-max-size</a>&quot; cannot exceed
100 either. If we create a variable &quot;txn.var&quot; that contains 100 bytes,
all available space is consumed.
Notice that exceeding the limits at runtime will not result in an error
message, but values might be cut off or corrupted. So make sure to accurately
plan for the amount of space needed to store all your variables.
</pre><a class="anchor" name="tune.zlib.memlevel"></a><a class="anchor" name="3-tune.zlib.memlevel"></a><a class="anchor" name="3.2-tune.zlib.memlevel"></a><a class="anchor" name="tune.zlib.memlevel (Global parameters)"></a><a class="anchor" name="tune.zlib.memlevel (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.zlib.memlevel"></a><a href="#3.2-tune.zlib.memlevel">tune.zlib.memlevel</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the memLevel parameter in zlib initialization for each stream. It
defines how much memory should be allocated for the internal compression
state. A value of 1 uses minimum memory but is slow and reduces compression
ratio, a value of 9 uses maximum memory for optimal speed. Can be a value
between 1 and 9. The default value is 8.
</pre><a class="anchor" name="tune.zlib.windowsize"></a><a class="anchor" name="3-tune.zlib.windowsize"></a><a class="anchor" name="3.2-tune.zlib.windowsize"></a><a class="anchor" name="tune.zlib.windowsize (Global parameters)"></a><a class="anchor" name="tune.zlib.windowsize (Performance tuning)"></a><div class="keyword"><b><a class="anchor" name="tune.zlib.windowsize"></a><a href="#3.2-tune.zlib.windowsize">tune.zlib.windowsize</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Sets the window size (the size of the history buffer) as a parameter of the
zlib initialization for each stream. Larger values of this parameter result
in better compression at the expense of memory usage. Can be a value between
8 and 15. The default value is 15.
</pre></div>
<a class="anchor" id="3.3" name="3.3"></a>
<h2 id="chapter-3.3" data-target="3.3"><small><a class="small" href="#3.3">3.3.</a></small> Debugging</h2>
<div><a class="anchor" name="anonkey"></a><a class="anchor" name="3-anonkey"></a><a class="anchor" name="3.3-anonkey"></a><a class="anchor" name="anonkey (Global parameters)"></a><a class="anchor" name="anonkey (Debugging)"></a><div class="keyword"><b><a class="anchor" name="anonkey"></a><a href="#3.3-anonkey">anonkey</a></b> <span style="color: #080">&lt;key&gt;</span></div><pre class="text">This sets the global anonymizing key to &lt;key&gt;, which must be a 32-bit number
between 0 and 4294967295. This is the key that will be used by default by CLI
commands when anonymized mode is enabled. This key may also be set at runtime
from the CLI command &quot;set anon global-key&quot;. See also command line argument
&quot;-dC&quot; in the management manual.
</pre><a class="anchor" name="force-cfg-parser-pause"></a><a class="anchor" name="3-force-cfg-parser-pause"></a><a class="anchor" name="3.3-force-cfg-parser-pause"></a><a class="anchor" name="force-cfg-parser-pause (Global parameters)"></a><a class="anchor" name="force-cfg-parser-pause (Debugging)"></a><div class="keyword"><b><a class="anchor" name="force-cfg-parser-pause"></a><a href="#3.3-force-cfg-parser-pause">force-cfg-parser-pause</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">This command is pausing the configuration parser for &lt;timeout&gt; milliseconds.
This is useful for development or for testing timeouts of init scripts,
particularly to simulate a very long reload.
It requires the expose-experimental-directives to be set.

&lt;timeout&gt; is the timeout value specified in milliseconds by default, but
            can be in any other unit if the number is suffixed by the unit,
            as explained at the top of this document.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>global
    expose-experimental-directives
    force-cfg-parser-pause 10s
</code></pre>
</div><a class="anchor" name="quick-exit"></a><a class="anchor" name="3-quick-exit"></a><a class="anchor" name="3.3-quick-exit"></a><a class="anchor" name="quick-exit (Global parameters)"></a><a class="anchor" name="quick-exit (Debugging)"></a><div class="keyword"><b><a class="anchor" name="quick-exit"></a><a href="#3.3-quick-exit">quick-exit</a></b></div><pre class="text">This speeds up the old process exit upon reload by skipping the releasing of
memory objects and listeners, since all of these are reclaimed by the
operating system at the process' death. The gains are only marginal (in the
order of a few hundred milliseconds for huge configurations at most). The
main target usage in fact is when a bug is spotted in the deinit() code, as
this allows to bypass it. It is better not to use this unless instructed to
do so by developers.
</pre><a class="anchor" name="quiet"></a><a class="anchor" name="3-quiet"></a><a class="anchor" name="3.3-quiet"></a><a class="anchor" name="quiet (Global parameters)"></a><a class="anchor" name="quiet (Debugging)"></a><div class="keyword"><b><a class="anchor" name="quiet"></a><a href="#3.3-quiet">quiet</a></b></div><pre class="text">Do not display any message during startup. It is equivalent to the command-
line argument &quot;-q&quot;.
</pre><a class="anchor" name="warn-blocked-traffic-after"></a><a class="anchor" name="3-warn-blocked-traffic-after"></a><a class="anchor" name="3.3-warn-blocked-traffic-after"></a><a class="anchor" name="warn-blocked-traffic-after (Global parameters)"></a><a class="anchor" name="warn-blocked-traffic-after (Debugging)"></a><div class="keyword"><b><a class="anchor" name="warn-blocked-traffic-after"></a><a href="#3.3-warn-blocked-traffic-after">warn-blocked-traffic-after</a></b> <span style="color: #080">&lt;time&gt;</span></div><pre class="text">This allows to adjust the delay after which a stuck task blocking the traffic
will trigger the emission of a warning on the standard error output. The
delay is expressed in milliseconds and defaults to 100 ms. Permitted values
must be comprised between 1 ms and 1000 ms included. Lower values will
trigger warnings frequently and higher ones will rarely. The watchdog will
kill a runaway task that fails to respond twice for one second anyway, so a
1000 ms warning delay will normally not trigger any warning. It is
recommended to stay with values between 10 and 100ms to detect configuration
anomalies that may degrade the user's experience, causing long response times
or jerkiness on interactive sessions. For example, a poorly designed Lua
sample-fetch function doing heavy computations, or a very large map_reg or
map_regm map file with a very high evaluation cost may cause such trouble.
For comparison a TLS handshake can eat between one and two milliseconds, and
compressing a 16kB HTTP response buffer is around one millisecond. The output
contains a thread dump of the offending task with a backtrace and some
context that helps figure where the time is being spent.
</pre><a class="anchor" name="zero-warning"></a><a class="anchor" name="3-zero-warning"></a><a class="anchor" name="3.3-zero-warning"></a><a class="anchor" name="zero-warning (Global parameters)"></a><a class="anchor" name="zero-warning (Debugging)"></a><div class="keyword"><b><a class="anchor" name="zero-warning"></a><a href="#3.3-zero-warning">zero-warning</a></b></div><pre class="text">When this option is set, HAProxy will refuse to start if any warning was
emitted while processing the configuration and applying it. It means that
warnings about bad combinations of parameters, warnings about very high
limits that couldn't be set, and so on, make the process exit with an error
during startup. A few late startup warnings cannot be caught by this option,
such as the failure to drop supplementary groups when changing the group ID
in &quot;<a href="#daemon">daemon</a>&quot; or &quot;<a href="#master-worker">master-worker</a>&quot; modes, or the failure to mark the process
dumpable after the fork(). This option does not catch warnings emitted at
runtime. It is highly recommended to set this option on configurations that
are not changed often, as it helps to detect subtle mistakes and keep the
configuration clean and forward-compatible. Note that &quot;haproxy -c&quot; will also
report errors in such a case. This option is equivalent to command line
argument &quot;-dW&quot;.
</pre></div>
<a class="anchor" id="3.3.1" name="3.3.1"></a>
<h3 id="chapter-3.3.1" data-target="3.3.1"><small><a class="small" href="#3.3.1">3.3.1.</a></small> Traces</h3>
<div><pre class="text">For debugging purpose, it is possible to activate traces on an HAProxy's
subsystem. This will dump debug messages about a specific subsystem. It is a
very powerful tool to diagnose issues. Traces can be dynamically configured via
the CLI. It is also possible to predefined some settings in the configuration
file, in dedicated &quot;<a href="#traces">traces</a>&quot; sections. More details about traces can be found in
the management guide. It remains a developper tools used during complex
debugging sessions.  It is pretty verbose and have a cost, so use it with
caution. And because it is a developper tool, there is no warranty about the
backward compatibility of this section.
</pre><a class="anchor" name="traces"></a><a class="anchor" name="3-traces"></a><a class="anchor" name="3.3.1-traces"></a><a class="anchor" name="traces (Global parameters)"></a><a class="anchor" name="traces (Traces)"></a><div class="keyword"><b><a class="anchor" name="traces"></a><a href="#3.3.1-traces">traces</a></b></div><pre class="text">Starts a new traces section. One or multiple &quot;<a href="#traces">traces</a>&quot; section may be
used. All direcitives are evaluated in the declararion order, the last ones
overriding previous ones.
</pre><a class="anchor" name="trace"></a><a class="anchor" name="3-trace"></a><a class="anchor" name="3.3.1-trace"></a><a class="anchor" name="trace (Global parameters)"></a><a class="anchor" name="trace (Traces)"></a><div class="keyword"><b><a class="anchor" name="trace"></a><a href="#3.3.1-trace">trace</a></b> <span style="color: #080">&lt;source&gt;</span> <span style="color: #080">&lt;args...&gt;</span></div><pre class="text">Configures on &quot;<a href="#trace">trace</a>&quot; subsystem. Each of them can be found in the management
manual, and follow the exact same syntax. Any output that the &quot;<a href="#trace">trace</a>&quot;
command would produce will be emitted during the parsing step of the
section. Most of the time these will be errors and warnings, but certain
incomplete commands might list permissible choices. This command is not meant
for regular use, it will generally only be suggested by developers along
complex debugging sessions. It is important to keep in mind that depending on
the trace level and details, enabling traces can severely degrade the global
performance. Please refer to the management manual for the statements syntax.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>ring buf1
  size 10485760 <span class="comment"># 10MB</span>
  format timed
  backing-file /tmp/h1.traces

ring buf2
  size 10485760 <span class="comment"># 10MB</span>
  format timed
  backing-file /tmp/h2.traces

traces
  trace h1 sink buf1 level developer verbosity complete start now
  trace h2 sink buf1 level developer verbosity complete start now
</code></pre>
</div></div>
<a class="anchor" id="3.4" name="3.4"></a>
<h2 id="chapter-3.4" data-target="3.4"><small><a class="small" href="#3.4">3.4.</a></small> Userlists</h2>
<div><pre class="text">It is possible to control access to frontend/backend/listen sections or to
http stats by allowing only authenticated and authorized users. To do this,
it is required to create at least one userlist and to define users.
</pre><a class="anchor" name="userlist"></a><a class="anchor" name="3-userlist"></a><a class="anchor" name="3.4-userlist"></a><a class="anchor" name="userlist (Global parameters)"></a><a class="anchor" name="userlist (Userlists)"></a><div class="keyword"><b><a class="anchor" name="userlist"></a><a href="#3.4-userlist">userlist</a></b> <span style="color: #080">&lt;listname&gt;</span></div><pre class="text">Creates new userlist with name &lt;listname&gt;. Many independent userlists can be
used to store authentication &amp; authorization data for independent customers.
</pre><a class="anchor" name="group"></a><a class="anchor" name="3-group"></a><a class="anchor" name="3.4-group"></a><a class="anchor" name="group (Global parameters)"></a><a class="anchor" name="group (Userlists)"></a><div class="keyword"><b><a class="anchor" name="group"></a><a href="#3.4-group">group</a></b> <span style="color: #080">&lt;groupname&gt;</span> <span style="color: #008">[users <span style="color: #080">&lt;user&gt;</span>,<span style="color: #080">&lt;user&gt;</span>,(...)]</span></div><pre class="text">Adds group &lt;groupname&gt; to the current userlist. It is also possible to
attach users to this group by using a comma separated list of names
proceeded by &quot;users&quot; keyword.
</pre><a class="anchor" name="user"></a><a class="anchor" name="3-user"></a><a class="anchor" name="3.4-user"></a><a class="anchor" name="user (Global parameters)"></a><a class="anchor" name="user (Userlists)"></a><div class="keyword"><b><a class="anchor" name="user"></a><a href="#3.4-user">user</a></b> <span style="color: #080">&lt;username&gt;</span> <span style="color: #008">[password|insecure-password <span style="color: #080">&lt;password&gt;</span>]</span>
                <span style="color: #008">[groups <span style="color: #080">&lt;group&gt;</span>,<span style="color: #080">&lt;group&gt;</span>,(...)]</span></div><pre class="text">Adds user &lt;username&gt; to the current userlist. Both secure (encrypted) and
insecure (unencrypted) passwords can be used. Encrypted passwords are
evaluated using the crypt(3) function, so depending on the system's
capabilities, different algorithms are supported. For example, modern Glibc
based Linux systems support MD5, SHA-256, SHA-512, and, of course, the
classic DES-based method of encrypting passwords.

Attention: Be aware that using encrypted passwords might cause significantly
increased CPU usage, depending on the number of requests, and the algorithm
used. For any of the hashed variants, the password for each request must
be processed through the chosen algorithm, before it can be compared to the
value specified in the config file. Most current algorithms are deliberately
designed to be expensive to compute to achieve resistance against brute
force attacks. They do not simply salt/hash the clear text password once,
but thousands of times. This can quickly become a major factor in HAProxy's
overall CPU consumption, and can even lead to application crashes!

To address the high CPU usage of hash functions, one approach is to reduce
the number of rounds of the hash function (SHA family algorithms) or decrease
the &quot;cost&quot; of the function, if the algorithm supports it.

As a side note, musl (e.g. Alpine Linux) implementations are known to be
slower than their glibc counterparts when calculating hashes, so you might
want to consider this aspect too.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>userlist L1
  group G1 users tiger,scott
  group G2 users xdb,scott

  user tiger password $6$k6y3o.eP$JlKBx9za9667qe4(...)xHSwRv6J.C0/D7cV91
  user scott insecure-password elgato
  user xdb insecure-password hello

userlist L2
  group G1
  group G2

  user tiger password $6$k6y3o.eP$JlKBx(...)xHSwRv6J.C0/D7cV91 groups G1
  user scott insecure-password elgato groups G1,G2
  user xdb insecure-password hello groups G2
</code></pre>
</div><pre class="text">Please note that both lists are functionally identical.
</pre></div>
<a class="anchor" id="3.5" name="3.5"></a>
<h2 id="chapter-3.5" data-target="3.5"><small><a class="small" href="#3.5">3.5.</a></small> Peers</h2>
<div><pre class="text">It is possible to propagate entries of any data-types in stick-tables between
several HAProxy instances over TCP connections in a multi-master fashion. Each
instance pushes its local updates and insertions to remote peers. The pushed
values overwrite remote ones without aggregation. As an exception, the data
type &quot;conn_cur&quot; is never learned from peers, as it is supposed to reflect local
values. Earlier versions used to synchronize it and to cause negative values in
active-active setups, and always-growing values upon reloads or active-passive
switches because the local value would reflect more connections than locally
present. This information, however, is pushed so that monitoring systems can
watch it.

Interrupted exchanges are automatically detected and recovered from the last
known point. In addition, during a soft restart, the old process connects to
the new one using such a TCP connection to push all its entries before the new
process tries to connect to other peers. That ensures very fast replication
during a reload, it typically takes a fraction of a second even for large
tables.

Note that Server IDs are used to identify servers remotely, so it is important
that configurations look similar or at least that the same IDs are forced on
each server on all participants.
</pre><a class="anchor" name="peers"></a><a class="anchor" name="3-peers"></a><a class="anchor" name="3.5-peers"></a><a class="anchor" name="peers (Global parameters)"></a><a class="anchor" name="peers (Peers)"></a><div class="keyword"><b><a class="anchor" name="peers"></a><a href="#3.5-peers">peers</a></b> <span style="color: #080">&lt;peersect&gt;</span></div><pre class="text">Creates a new peer list with name &lt;peersect&gt;. It is an independent section,
which is referenced by one or more stick-tables.
</pre><a class="anchor" name="bind"></a><a class="anchor" name="3-bind"></a><a class="anchor" name="3.5-bind"></a><a class="anchor" name="bind (Global parameters)"></a><a class="anchor" name="bind (Peers)"></a><div class="keyword"><b><a class="anchor" name="bind"></a><a href="#3.5-bind">bind</a></b> <span style="color: #008">[<span style="color: #080">&lt;address&gt;</span>]</span>:port <span style="color: #008">[param*]</span></div><a class="anchor" name="bind"></a><a class="anchor" name="3-bind"></a><a class="anchor" name="3.5-bind"></a><a class="anchor" name="bind (Global parameters)"></a><a class="anchor" name="bind (Peers)"></a><div class="keyword"><b><a class="anchor" name="bind"></a><a href="#3.5-bind">bind</a></b> /<span style="color: #080">&lt;path&gt;</span> <span style="color: #008">[param*]</span></div><pre class="text">Defines the binding parameters of the local peer of this &quot;<a href="#peers">peers</a>&quot; section.
Such lines are not supported with &quot;<a href="#peer">peer</a>&quot; line in the same &quot;<a href="#peers">peers</a>&quot; section.
</pre><a class="anchor" name="disabled"></a><a class="anchor" name="3-disabled"></a><a class="anchor" name="3.5-disabled"></a><a class="anchor" name="disabled (Global parameters)"></a><a class="anchor" name="disabled (Peers)"></a><div class="keyword"><b><a class="anchor" name="disabled"></a><a href="#3.5-disabled">disabled</a></b></div><pre class="text">Disables a peers section. It disables both listening and any synchronization
related to this section. This is provided to disable synchronization of stick
tables without having to comment out all &quot;<a href="#peers">peers</a>&quot; references.
</pre><a class="anchor" name="default-bind"></a><a class="anchor" name="3-default-bind"></a><a class="anchor" name="3.5-default-bind"></a><a class="anchor" name="default-bind (Global parameters)"></a><a class="anchor" name="default-bind (Peers)"></a><div class="keyword"><b><a class="anchor" name="default-bind"></a><a href="#3.5-default-bind">default-bind</a></b> <span style="color: #008">[param*]</span></div><pre class="text">Defines the binding parameters for the local peer, excepted its address.
</pre><a class="anchor" name="default-server"></a><a class="anchor" name="3-default-server"></a><a class="anchor" name="3.5-default-server"></a><a class="anchor" name="default-server (Global parameters)"></a><a class="anchor" name="default-server (Peers)"></a><div class="keyword"><b><a class="anchor" name="default-server"></a><a href="#3.5-default-server">default-server</a></b> <span style="color: #008">[param*]</span></div><pre class="text">Change default options for a server in a &quot;<a href="#peers">peers</a>&quot; section.
</pre><div class="separator">
<span class="label label-info">Arguments:</span><pre class="prettyprint arguments">&lt;param*&gt;  is a list of parameters for this server. The &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;
          keyword accepts an important number of options and has a complete
          section dedicated to it. In a peers section, the transport
          parameters of a &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line are supported. Please refer
          to <a href="#5">section 5</a> for more details, and the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword below in
          this section for some of the restrictions.</pre>
</div>
<div class="page-header"><b>See also:</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; and <a href="#5">section 5</a> about server options</div>
<a class="anchor" name="enabled"></a><a class="anchor" name="3-enabled"></a><a class="anchor" name="3.5-enabled"></a><a class="anchor" name="enabled (Global parameters)"></a><a class="anchor" name="enabled (Peers)"></a><div class="keyword"><b><a class="anchor" name="enabled"></a><a href="#3.5-enabled">enabled</a></b></div><pre class="text">This re-enables a peers section which was previously disabled via the
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">disabled<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#disabled%20%28Peers%29">Peers</a></li><li><a href="#disabled%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#disabled%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword.
</pre><a class="anchor" name="log"></a><a class="anchor" name="3-log"></a><a class="anchor" name="3.5-log"></a><a class="anchor" name="log (Global parameters)"></a><a class="anchor" name="log (Peers)"></a><div class="keyword"><b><a class="anchor" name="log"></a><a href="#3.5-log">log</a></b> <span style="color: #080">&lt;target&gt;</span> <span style="color: #008">[len <span style="color: #080">&lt;length&gt;</span>]</span> <span style="color: #008">[format <span style="color: #080">&lt;format&gt;</span>]</span> <span style="color: #008">[sample <span style="color: #080">&lt;ranges&gt;</span>:<span style="color: #080">&lt;sample_size&gt;</span>]</span>
    <span style="color: #080">&lt;facility&gt;</span> <span style="color: #008">[<span style="color: #080">&lt;level&gt;</span> <span style="color: #008">[<span style="color: #080">&lt;minlevel&gt;</span>]</span>]</span></div><pre class="text">&quot;<a href="#peers">peers</a>&quot; sections support the same &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword as for the proxies to
log information about the &quot;<a href="#peers">peers</a>&quot; listener. See &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; option for proxies for
more details.
</pre><a class="anchor" name="peer"></a><a class="anchor" name="3-peer"></a><a class="anchor" name="3.5-peer"></a><a class="anchor" name="peer (Global parameters)"></a><a class="anchor" name="peer (Peers)"></a><div class="keyword"><b><a class="anchor" name="peer"></a><a href="#3.5-peer">peer</a></b> <span style="color: #080">&lt;peername&gt;</span> <span style="color: #008">[<span style="color: #080">&lt;address&gt;</span>]</span>:port <span style="color: #008">[param*]</span></div><a class="anchor" name="peer"></a><a class="anchor" name="3-peer"></a><a class="anchor" name="3.5-peer"></a><a class="anchor" name="peer (Global parameters)"></a><a class="anchor" name="peer (Peers)"></a><div class="keyword"><b><a class="anchor" name="peer"></a><a href="#3.5-peer">peer</a></b> <span style="color: #080">&lt;peername&gt;</span> /<span style="color: #080">&lt;path&gt;</span> <span style="color: #008">[param*]</span></div><pre class="text">Defines a peer inside a peers section.
If &lt;peername&gt; is set to the local peer name (by default hostname, or forced
using &quot;-L&quot; command line option or &quot;<a href="#localpeer">localpeer</a>&quot; global configuration setting),
HAProxy will listen for incoming remote peer connection on the provided
address.  Otherwise, the address defines where to connect to in order to join
the remote peer, and &lt;peername&gt; is used at the protocol level to identify and
validate the remote peer on the server side.

During a soft restart, local peer address is used by the old instance to
connect the new one and initiate a complete replication (teaching process).

It is strongly recommended to have the exact same peers declaration on all
peers and to only rely on the &quot;-L&quot; command line argument or the &quot;<a href="#localpeer">localpeer</a>&quot;
global configuration setting to change the local peer name. This makes it
easier to maintain coherent configuration files across all peers.

You may want to reference some environment variables in the address
parameter, see <a href="#2.3">section 2.3</a> about environment variables.

Note: &quot;<a href="#peer">peer</a>&quot; keyword may transparently be replaced by &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword (see
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword explanation below).
</pre><a class="anchor" name="server"></a><a class="anchor" name="3-server"></a><a class="anchor" name="3.5-server"></a><a class="anchor" name="server (Global parameters)"></a><a class="anchor" name="server (Peers)"></a><div class="keyword"><b><a class="anchor" name="server"></a><a href="#3.5-server">server</a></b> <span style="color: #080">&lt;peername&gt;</span> <span style="color: #008">[<span style="color: #080">&lt;address&gt;</span>:<span style="color: #080">&lt;port&gt;</span>]</span> <span style="color: #008">[param*]</span></div><a class="anchor" name="server"></a><a class="anchor" name="3-server"></a><a class="anchor" name="3.5-server"></a><a class="anchor" name="server (Global parameters)"></a><a class="anchor" name="server (Peers)"></a><div class="keyword"><b><a class="anchor" name="server"></a><a href="#3.5-server">server</a></b> <span style="color: #080">&lt;peername&gt;</span> <span style="color: #008">[/<span style="color: #080">&lt;path&gt;</span>]</span> <span style="color: #008">[param*]</span></div><pre class="text">As previously mentioned, &quot;<a href="#peer">peer</a>&quot; keyword may be replaced by &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword
with a support for all &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; parameters found in 5.2 paragraph that are
related to transport settings. If the underlying peer is local, the address
parameter must not be present; it must be provided on a &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line (see
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword of this &quot;<a href="#peers">peers</a>&quot; section).

A number of &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; parameters are irrelevant for &quot;<a href="#peers">peers</a>&quot; sections. Peers by
nature do not support dynamic host name resolution nor health checks, hence
parameters like &quot;init_addr&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">resolvers<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#resolvers%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li><li><a href="#resolvers%20%28The%20resolvers%20section%29">The resolvers section</a></li></ul></span>&quot;, &quot;<a href="#check">check</a>&quot;, &quot;<a href="#agent-check">agent-check</a>&quot;, or &quot;<a href="#track">track</a>&quot;
are not supported. Similarly, there is no load balancing nor stickiness, thus
parameters such as &quot;<a href="#weight">weight</a>&quot; or &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">cookie<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#cookie%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#cookie%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li><li><a href="#cookie%20%28Fetching%20HTTP%20samples%20%28Layer%207%29%29">Fetching HTTP samples (Layer 7)</a></li></ul></span>&quot; have no effect.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code> <span class="comment"># The old way.</span>
 peers mypeers
     peer haproxy1 192.168.0.1:1024
     peer haproxy2 192.168.0.2:1024
     peer haproxy3 10.2.0.1:1024

 backend mybackend
     mode tcp
     balance roundrobin
     stick-table type ip size 20k peers mypeers
     stick on src

     server srv1 192.168.0.30:80
     server srv2 192.168.0.31:80

Example:
  peers mypeers
     bind 192.168.0.1:1024 ssl crt mycerts/pem
     default-server ssl verify none
     server haproxy1 <span class="comment">#local peer</span>
     server haproxy2 192.168.0.2:1024
     server haproxy3 10.2.0.1:1024
</code></pre>
</div><a class="anchor" name="shards"></a><a class="anchor" name="3-shards"></a><a class="anchor" name="3.5-shards"></a><a class="anchor" name="shards (Global parameters)"></a><a class="anchor" name="shards (Peers)"></a><div class="keyword"><b><a class="anchor" name="shards"></a><a href="#3.5-shards">shards</a></b> <span style="color: #080">&lt;shards&gt;</span></div><pre class="text">In some configurations, one would like to distribute the stick-table contents
to some peers in place of sending all the stick-table contents to each peer
declared in the &quot;<a href="#peers">peers</a>&quot; section. In such cases, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">shards<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#shards%20%28Peers%29">Peers</a></li><li><a href="#shards%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; specifies the
number of peer involved in this stick-table contents distribution.
See also &quot;<a href="#shard">shard</a>&quot; server parameter.
</pre><a class="anchor" name="table"></a><a class="anchor" name="3-table"></a><a class="anchor" name="3.5-table"></a><a class="anchor" name="table (Global parameters)"></a><a class="anchor" name="table (Peers)"></a><div class="keyword"><b><a class="anchor" name="table"></a><a href="#3.5-table">table</a></b> <span style="color: #080">&lt;tablename&gt;</span> type <span style="color: #800">{ip | integer | string <span style="color: #008">[len <span style="color: #080">&lt;length&gt;</span>]</span> | binary <span style="color: #008">[len <span style="color: #080">&lt;length&gt;</span>]</span>}</span>
      size <span style="color: #080">&lt;size&gt;</span> <span style="color: #008">[expire <span style="color: #080">&lt;expire&gt;</span>]</span> <span style="color: #008">[write-to <span style="color: #080">&lt;wtable&gt;</span>]</span> <span style="color: #008">[nopurge]</span> <span style="color: #008">[store <span style="color: #080">&lt;data_type&gt;</span>]</span>*</div><pre class="text">Configure a stickiness table for the current section. This line is parsed
exactly the same way as the &quot;<a href="#stick-table">stick-table</a>&quot; keyword in others section, except
for the &quot;<a href="#peers">peers</a>&quot; argument which is not required here and with an additional
mandatory first parameter to designate the stick-table. Contrary to others
sections, there may be several &quot;<a href="#table">table</a>&quot; lines in &quot;<a href="#peers">peers</a>&quot; sections (see also
&quot;<a href="#stick-table">stick-table</a>&quot; keyword).

Also be aware of the fact that &quot;<a href="#peers">peers</a>&quot; sections have their own stick-table
namespaces to avoid collisions between stick-table names identical in
different &quot;<a href="#peers">peers</a>&quot; section. This is internally handled prepending the &quot;<a href="#peers">peers</a>&quot;
sections names to the name of the stick-tables followed by a '/' character.
If somewhere else in the configuration file you have to refer to such
stick-tables declared in &quot;<a href="#peers">peers</a>&quot; sections you must use the prefixed version
of the stick-table name as follows:

    peers mypeers
        peer A ...
        peer B ...
        table t1 ...

    frontend fe1
        tcp-request content track-sc0 src table mypeers/t1

This is also this prefixed version of the stick-table names which must be
used to refer to stick-tables through the CLI.

About &quot;<a href="#peers">peers</a>&quot; protocol, as only &quot;<a href="#peers">peers</a>&quot; belonging to the same section may
communicate with each others, there is no need to do such a distinction.
Several &quot;<a href="#peers">peers</a>&quot; sections may declare stick-tables with the same name.
This is shorter version of the stick-table name  which is sent over the network.
There is only a '/' character as prefix to avoid stick-table name collisions between
stick-tables declared as backends and stick-table declared in &quot;<a href="#peers">peers</a>&quot; sections
as follows in this weird but supported configuration:

    peers mypeers
        peer A ...
        peer B ...
        table t1 type string size 10m store gpc0

    backend t1
        stick-table type string size 10m store gpc0 peers mypeers

Here &quot;t1&quot; table declared in &quot;mypeers&quot; section has &quot;mypeers/t1&quot; as global name.
&quot;t1&quot; table declared as a backend as &quot;t1&quot; as global name. But at peer protocol
level the former table is named &quot;/t1&quot;, the latter is again named &quot;t1&quot;.
</pre></div>
<a class="anchor" id="3.6" name="3.6"></a>
<h2 id="chapter-3.6" data-target="3.6"><small><a class="small" href="#3.6">3.6.</a></small> Mailers</h2>
<div><pre class="text">It is possible to send email alerts when the state of servers changes.
If configured email alerts are sent to each mailer that is configured
in a mailers section. Email is sent to mailers through Lua (see
examples/lua/mailers.lua).
</pre><a class="anchor" name="mailers"></a><a class="anchor" name="3-mailers"></a><a class="anchor" name="3.6-mailers"></a><a class="anchor" name="mailers (Global parameters)"></a><a class="anchor" name="mailers (Mailers)"></a><div class="keyword"><b><a class="anchor" name="mailers"></a><a href="#3.6-mailers">mailers</a></b> <span style="color: #080">&lt;mailersect&gt;</span></div><pre class="text">Creates a new mailer list with the name &lt;mailersect&gt;. It is an
independent section which is referenced by one or more proxies.
</pre><a class="anchor" name="mailer"></a><a class="anchor" name="3-mailer"></a><a class="anchor" name="3.6-mailer"></a><a class="anchor" name="mailer (Global parameters)"></a><a class="anchor" name="mailer (Mailers)"></a><div class="keyword"><b><a class="anchor" name="mailer"></a><a href="#3.6-mailer">mailer</a></b> <span style="color: #080">&lt;mailername&gt;</span> <span style="color: #080">&lt;ip&gt;</span>:<span style="color: #080">&lt;port&gt;</span></div><pre class="text">Defines a mailer inside a mailers section.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>global
    <span class="comment"># mailers.lua file as provided in the git repository</span>
    <span class="comment"># adjust path as needed</span>
    lua-load examples/lua/mailers.lua

mailers mymailers
    mailer smtp1 192.168.0.1:587
    mailer smtp2 192.168.0.2:587

backend mybackend
    mode tcp
    balance roundrobin

    email-alert mailers mymailers
    email-alert from test1@horms.org
    email-alert to test2@horms.org

    server srv1 192.168.0.30:80
    server srv2 192.168.0.31:80
</code></pre>
</div><a class="anchor" name="timeout"></a><a class="anchor" name="3-timeout"></a><a class="anchor" name="3.6-timeout"></a><a class="anchor" name="timeout (Global parameters)"></a><a class="anchor" name="timeout (Mailers)"></a><a class="anchor" name="timeout mail"></a><a class="anchor" name="3-timeout mail"></a><a class="anchor" name="3.6-timeout mail"></a><a class="anchor" name="timeout mail (Global parameters)"></a><a class="anchor" name="timeout mail (Mailers)"></a><div class="keyword"><b><a class="anchor" name="timeout mail"></a><a href="#3.6-timeout%20mail">timeout mail</a></b> <span style="color: #080">&lt;time&gt;</span></div><pre class="text">Defines the time available for a mail/connection to be made and send to
the mail-server. If not defined the default value is 10 seconds. To allow
for at least two SYN-ACK packets to be send during initial TCP handshake it
is advised to keep this value above 4 seconds.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>mailers mymailers
    timeout mail 20s
    mailer smtp1 192.168.0.1:587
</code></pre>
</div></div>
<a class="anchor" id="3.7" name="3.7"></a>
<h2 id="chapter-3.7" data-target="3.7"><small><a class="small" href="#3.7">3.7.</a></small> Programs (deprecated)</h2>
<div><pre class="text">This section is deprecated and should disappear with HAProxy 3.3. The section
could be replaced easily by separated process managers. Systemd unit files or
sysvinit scripts could replace this section as they are more reliable. In docker
environments, some alternatives can also be found such as s6 or supervisord.

In master-worker mode, it is possible to launch external binaries with the
master, these processes are called programs. These programs are launched and
managed the same way as the workers.

Since version 3.1, the program section has a slightly different behavior, the
section is parsed and the program is started from the master, but the rest of
the configuration is loaded in the worker. This mean the program configuration
is completely separated from the worker configuration, and a program could be
reexecuted even if the worker configuration is wrong upon a reload.

During a reload of HAProxy, those processes are dealing with the same
sequence as a worker:

  - the master is re-executed
  - the master sends a SIGUSR1 signal to the program
  - if &quot;<a href="#option%20start-on-reload">option start-on-reload</a>&quot; is not disabled, the master launches a new
    instance of the program

During a stop, or restart, a SIGTERM is sent to the programs.
</pre><a class="anchor" name="program"></a><a class="anchor" name="3-program"></a><a class="anchor" name="3.7-program"></a><a class="anchor" name="program (Global parameters)"></a><a class="anchor" name="program (Programs (deprecated))"></a><div class="keyword"><b><a class="anchor" name="program"></a><a href="#3.7-program">program</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">This is a new program section, this section will create an instance &lt;name&gt;
which is visible in &quot;show proc&quot; on the master CLI. (See &quot;9.4. Master CLI&quot; in
the management guide).
</pre><a class="anchor" name="command"></a><a class="anchor" name="3-command"></a><a class="anchor" name="3.7-command"></a><a class="anchor" name="command (Global parameters)"></a><a class="anchor" name="command (Programs (deprecated))"></a><div class="keyword"><b><a class="anchor" name="command"></a><a href="#3.7-command">command</a></b> <span style="color: #080">&lt;command&gt;</span> <span style="color: #008">[arguments*]</span></div><pre class="text">Define the command to start with optional arguments. The command is looked
up in the current PATH if it does not include an absolute path. This is a
mandatory option of the program section. Arguments containing spaces must
be enclosed in quotes or double quotes or be prefixed by a backslash.
</pre><a class="anchor" name="user"></a><a class="anchor" name="3-user"></a><a class="anchor" name="3.7-user"></a><a class="anchor" name="user (Global parameters)"></a><a class="anchor" name="user (Programs (deprecated))"></a><div class="keyword"><b><a class="anchor" name="user"></a><a href="#3.7-user">user</a></b> <span style="color: #080">&lt;user name&gt;</span></div><pre class="text">Changes the executed command user ID to the &lt;user name&gt; from /etc/passwd.
See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">group<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#group%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#group%20%28Userlists%29">Userlists</a></li><li><a href="#group%20%28Programs%20%28deprecated%29%29">Programs (deprecated)</a></li><li><a href="#group%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot;.
</pre><a class="anchor" name="group"></a><a class="anchor" name="3-group"></a><a class="anchor" name="3.7-group"></a><a class="anchor" name="group (Global parameters)"></a><a class="anchor" name="group (Programs (deprecated))"></a><div class="keyword"><b><a class="anchor" name="group"></a><a href="#3.7-group">group</a></b> <span style="color: #080">&lt;group name&gt;</span></div><pre class="text">Changes the executed command group ID to the &lt;group name&gt; from /etc/group.
See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">user<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#user%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#user%20%28Userlists%29">Userlists</a></li><li><a href="#user%20%28Programs%20%28deprecated%29%29">Programs (deprecated)</a></li><li><a href="#user%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot;.
</pre><a class="anchor" name="option"></a><a class="anchor" name="3-option"></a><a class="anchor" name="3.7-option"></a><a class="anchor" name="option (Global parameters)"></a><a class="anchor" name="option (Programs (deprecated))"></a><a class="anchor" name="option start-on-reload"></a><a class="anchor" name="3-option start-on-reload"></a><a class="anchor" name="3.7-option start-on-reload"></a><a class="anchor" name="option start-on-reload (Global parameters)"></a><a class="anchor" name="option start-on-reload (Programs (deprecated))"></a><div class="keyword"><b><a class="anchor" name="option start-on-reload"></a><a href="#3.7-option%20start-on-reload">option start-on-reload</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="3-no"></a><a class="anchor" name="3.7-no"></a><a class="anchor" name="no (Global parameters)"></a><a class="anchor" name="no (Programs (deprecated))"></a><a class="anchor" name="no option"></a><a class="anchor" name="3-no option"></a><a class="anchor" name="3.7-no option"></a><a class="anchor" name="no option (Global parameters)"></a><a class="anchor" name="no option (Programs (deprecated))"></a><a class="anchor" name="no option start-on-reload"></a><a class="anchor" name="3-no option start-on-reload"></a><a class="anchor" name="3.7-no option start-on-reload"></a><a class="anchor" name="no option start-on-reload (Global parameters)"></a><a class="anchor" name="no option start-on-reload (Programs (deprecated))"></a><div class="keyword"><b><a class="anchor" name="no option start-on-reload"></a><a href="#3.7-no%20option%20start-on-reload">no option start-on-reload</a></b></div><pre class="text">Start (or not) a new instance of the program upon a reload of the master.
The default is to start a new instance. This option may only be used in a
program section.
</pre></div>
<a class="anchor" id="3.8" name="3.8"></a>
<h2 id="chapter-3.8" data-target="3.8"><small><a class="small" href="#3.8">3.8.</a></small> HTTP-errors</h2>
<div><pre class="text">It is possible to globally declare several groups of HTTP errors, to be
imported afterwards in any proxy section. Same group may be referenced at
several places and can be fully or partially imported.
</pre><a class="anchor" name="http-errors"></a><a class="anchor" name="3-http-errors"></a><a class="anchor" name="3.8-http-errors"></a><a class="anchor" name="http-errors (Global parameters)"></a><a class="anchor" name="http-errors (HTTP-errors)"></a><div class="keyword"><b><a class="anchor" name="http-errors"></a><a href="#3.8-http-errors">http-errors</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">Create a new http-errors group with the name &lt;name&gt;. It is an independent
section that may be referenced by one or more proxies using its name.
</pre><a class="anchor" name="errorfile"></a><a class="anchor" name="3-errorfile"></a><a class="anchor" name="3.8-errorfile"></a><a class="anchor" name="errorfile (Global parameters)"></a><a class="anchor" name="errorfile (HTTP-errors)"></a><div class="keyword"><b><a class="anchor" name="errorfile"></a><a href="#3.8-errorfile">errorfile</a></b> <span style="color: #080">&lt;code&gt;</span> <span style="color: #080">&lt;file&gt;</span></div><pre class="text">Associate a file contents to an HTTP error code
</pre><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;code&gt;    is the HTTP status code. Currently, HAProxy is capable of
          generating codes 200, 400, 401, 403, 404, 405, 407, 408, 410,
          425, 429, 500, 501, 502, 503, and 504.

&lt;file&gt;    designates a file containing the full HTTP response. It is
          recommended to follow the common practice of appending &quot;.http&quot; to
          the filename so that people do not confuse the response with HTML
          error pages, and to use absolute paths, since files are read
          before any chroot is performed.</pre>
</div>
<pre class="text">Please referrers to &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">errorfile<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#errorfile%20%28HTTP-errors%29">HTTP-errors</a></li><li><a href="#errorfile%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword in <a href="#4">section 4</a> for details.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-errors website-1
    errorfile 400 /etc/haproxy/errorfiles/site1/400.http
    errorfile 404 /etc/haproxy/errorfiles/site1/404.http
    errorfile 408 /dev/null  <span class="comment"># work around Chrome pre-connect bug</span>

http-errors website-2
    errorfile 400 /etc/haproxy/errorfiles/site2/400.http
    errorfile 404 /etc/haproxy/errorfiles/site2/404.http
    errorfile 408 /dev/null  <span class="comment"># work around Chrome pre-connect bug</span>
</code></pre>
</div></div>
<a class="anchor" id="3.9" name="3.9"></a>
<h2 id="chapter-3.9" data-target="3.9"><small><a class="small" href="#3.9">3.9.</a></small> Rings</h2>
<div><pre class="text">It is possible to globally declare ring-buffers, to be used as target for log
servers or traces.
</pre><a class="anchor" name="ring"></a><a class="anchor" name="3-ring"></a><a class="anchor" name="3.9-ring"></a><a class="anchor" name="ring (Global parameters)"></a><a class="anchor" name="ring (Rings)"></a><div class="keyword"><b><a class="anchor" name="ring"></a><a href="#3.9-ring">ring</a></b> <span style="color: #080">&lt;ringname&gt;</span></div><pre class="text">Creates a new ring-buffer with name &lt;ringname&gt;.
</pre><a class="anchor" name="backing-file"></a><a class="anchor" name="3-backing-file"></a><a class="anchor" name="3.9-backing-file"></a><a class="anchor" name="backing-file (Global parameters)"></a><a class="anchor" name="backing-file (Rings)"></a><div class="keyword"><b><a class="anchor" name="backing-file"></a><a href="#3.9-backing-file">backing-file</a></b> <span style="color: #080">&lt;path&gt;</span></div><pre class="text">This replaces the regular memory allocation by a RAM-mapped file to store the
ring. This can be useful for collecting traces or logs for post-mortem
analysis, without having to attach a slow client to the CLI. Newer contents
will automatically replace older ones so that the latest contents are always
available. The contents written to the ring will be visible in that file once
the process stops (most often they will even be seen very soon after but
there is no such guarantee since writes are not synchronous).

When this option is used, the total storage area is reduced by the size of
the &quot;struct ring&quot; that starts at the beginning of the area, and that is
required to recover the area's contents. The file will be created with the
starting user's ownership, with mode 0600 and will be of the size configured
by the &quot;<a href="#size">size</a>&quot; directive. When the directive is parsed (thus even during
config checks), any existing non-empty file will first be renamed with the
extra suffix &quot;.bak&quot;, and any previously existing file with suffix &quot;.bak&quot; will
be removed. This ensures that instant reload or restart of the process will
not wipe precious debugging information, and will leave time for an admin to
spot this new &quot;.bak&quot; file and to archive it if needed. As such, after a crash
the file designated by &lt;path&gt; will contain the freshest information, and if
the service is restarted, the &quot;&lt;path&gt;.bak&quot; file will have it instead. This
means that the total storage capacity required will be double of the ring
size. Failures to rotate the file are silently ignored, so placing the file
into a directory without write permissions will be sufficient to avoid the
backup file if not desired.

WARNING: there are stability and security implications in using this feature.
First, backing the ring to a slow device (e.g. physical hard drive) may cause
perceptible slowdowns during accesses, and possibly even panics if too many
threads compete for accesses. Second, an external process modifying the area
could cause the haproxy process to crash or to overwrite some of its own
memory with traces. Third, if the file system fills up before the ring,
writes to the ring may cause the process to crash.

The information present in this ring are structured and are NOT directly
readable using a text editor (even though most of it looks barely readable).
The output of this file is only intended for developers.
</pre><a class="anchor" name="description"></a><a class="anchor" name="3-description"></a><a class="anchor" name="3.9-description"></a><a class="anchor" name="description (Global parameters)"></a><a class="anchor" name="description (Rings)"></a><div class="keyword"><b><a class="anchor" name="description"></a><a href="#3.9-description">description</a></b> <span style="color: #080">&lt;text&gt;</span></div><pre class="text">The description is an optional description string of the ring. It will
appear on CLI. By default, &lt;name&gt; is reused to fill this field.
</pre><a class="anchor" name="format"></a><a class="anchor" name="3-format"></a><a class="anchor" name="3.9-format"></a><a class="anchor" name="format (Global parameters)"></a><a class="anchor" name="format (Rings)"></a><div class="keyword"><b><a class="anchor" name="format"></a><a href="#3.9-format">format</a></b> <span style="color: #080">&lt;format&gt;</span></div><pre class="text">Format used to store events into the ring buffer.
</pre><div class="separator">
<span class="label label-info">Arguments:</span><pre class="prettyprint arguments">&lt;format&gt; is the log format used when generating syslog messages. It may be
         one of the following :

  iso     A message containing only the ISO date, followed by the text.
          The PID, process name and system name are omitted. This is
          designed to be used with a local log server.

  local   Analog to rfc3164 syslog message format except that hostname
          field is stripped. This is the default.
          Note: option &quot;<a href="#log-send-hostname">log-send-hostname</a>&quot; switches the default to
          rfc3164.

  raw     A message containing only the text. The level, PID, date, time,
          process name and system name are omitted. This is designed to be
          used in containers or during development, where the severity
          only depends on the file descriptor used (stdout/stderr). This
          is the default.

  rfc3164 The RFC3164 syslog message format.
          (https://tools.ietf.org/html/rfc3164)

  rfc5424 The RFC5424 syslog message format.
          (https://tools.ietf.org/html/rfc5424)

  short   A message containing only a level between angle brackets such as
          '&lt;3&gt;', followed by the text. The PID, date, time, process name
          and system name are omitted. This is designed to be used with a
          local log server. This format is compatible with what the systemd
          logger consumes.

 priority A message containing only a level plus syslog facility between angle
          brackets such as '&lt;63&gt;', followed by the text. The PID, date, time,
          process name and system name are omitted. This is designed to be used
          with a local log server.

  timed   A message containing only a level between angle brackets such as
          '&lt;3&gt;', followed by ISO date and by the text. The PID, process
          name and system name are omitted. This is designed to be
          used with a local log server.</pre>
</div>
<a class="anchor" name="maxlen"></a><a class="anchor" name="3-maxlen"></a><a class="anchor" name="3.9-maxlen"></a><a class="anchor" name="maxlen (Global parameters)"></a><a class="anchor" name="maxlen (Rings)"></a><div class="keyword"><b><a class="anchor" name="maxlen"></a><a href="#3.9-maxlen">maxlen</a></b> <span style="color: #080">&lt;length&gt;</span></div><pre class="text">The maximum length of an event message stored into the ring,
including formatted header. If an event message is longer than
&lt;length&gt;, it will be truncated to this length.
</pre><a class="anchor" name="server"></a><a class="anchor" name="3-server"></a><a class="anchor" name="3.9-server"></a><a class="anchor" name="server (Global parameters)"></a><a class="anchor" name="server (Rings)"></a><div class="keyword"><b><a class="anchor" name="server"></a><a href="#3.9-server">server</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #080">&lt;address&gt;</span> <span style="color: #008">[param*]</span></div><pre class="text">Used to configure a syslog tcp server to forward messages from ring buffer.
This supports for all &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; parameters found in 5.2 paragraph. Some of
these parameters are irrelevant for &quot;<a href="#ring">ring</a>&quot; sections. Important point: there
is little reason to add more than one server to a ring, because all servers
will receive the exact same copy of the ring contents, and as such the ring
will progress at the speed of the slowest server. If one server does not
respond, it will prevent old messages from being purged and may block new
messages from being inserted into the ring. The proper way to send messages
to multiple servers is to use one distinct ring per log server, not to
attach multiple servers to the same ring. Note that specific server directive
&quot;<a href="#log-proto">log-proto</a>&quot; is used to set the protocol used to send messages.
</pre><a class="anchor" name="size"></a><a class="anchor" name="3-size"></a><a class="anchor" name="3.9-size"></a><a class="anchor" name="size (Global parameters)"></a><a class="anchor" name="size (Rings)"></a><div class="keyword"><b><a class="anchor" name="size"></a><a href="#3.9-size">size</a></b> <span style="color: #080">&lt;size&gt;</span></div><pre class="text">This is the optional size in bytes for the ring-buffer. Default value is
set to BUFSIZE.
</pre><a class="anchor" name="timeout"></a><a class="anchor" name="3-timeout"></a><a class="anchor" name="3.9-timeout"></a><a class="anchor" name="timeout (Global parameters)"></a><a class="anchor" name="timeout (Rings)"></a><a class="anchor" name="timeout connect"></a><a class="anchor" name="3-timeout connect"></a><a class="anchor" name="3.9-timeout connect"></a><a class="anchor" name="timeout connect (Global parameters)"></a><a class="anchor" name="timeout connect (Rings)"></a><div class="keyword"><b><a class="anchor" name="timeout connect"></a><a href="#3.9-timeout%20connect">timeout connect</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set the maximum time to wait for a connection attempt to a server to succeed.
</pre><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the timeout value specified in milliseconds by default, but
          can be in any other unit if the number is suffixed by the unit,
          as explained at the top of this document.</pre>
</div>
<a class="anchor" name="timeout"></a><a class="anchor" name="3-timeout"></a><a class="anchor" name="3.9-timeout"></a><a class="anchor" name="timeout (Global parameters)"></a><a class="anchor" name="timeout (Rings)"></a><a class="anchor" name="timeout server"></a><a class="anchor" name="3-timeout server"></a><a class="anchor" name="3.9-timeout server"></a><a class="anchor" name="timeout server (Global parameters)"></a><a class="anchor" name="timeout server (Rings)"></a><div class="keyword"><b><a class="anchor" name="timeout server"></a><a href="#3.9-timeout%20server">timeout server</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set the maximum time for pending data staying into output buffer.
</pre><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the timeout value specified in milliseconds by default, but
          can be in any other unit if the number is suffixed by the unit,
          as explained at the top of this document.</pre>
</div>
<div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>global
    log ring@myring local7

ring myring
    description &quot;My local buffer&quot;
    format rfc3164
    maxlen 1200
    size 32764
    timeout connect 5s
    timeout server 10s
    server mysyslogsrv 127.0.0.1:6514 log-proto octet-count
</code></pre>
</div></div>
<a class="anchor" id="3.10" name="3.10"></a>
<h2 id="chapter-3.10" data-target="3.10"><small><a class="small" href="#3.10">3.10.</a></small> Log forwarding</h2>
<div><pre class="text">It is possible to declare one or multiple log forwarding section,
HAProxy will forward all received log messages to a log servers list.
</pre><a class="anchor" name="log-forward"></a><a class="anchor" name="3-log-forward"></a><a class="anchor" name="3.10-log-forward"></a><a class="anchor" name="log-forward (Global parameters)"></a><a class="anchor" name="log-forward (Log forwarding)"></a><div class="keyword"><b><a class="anchor" name="log-forward"></a><a href="#3.10-log-forward">log-forward</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">Creates a new log forwarder proxy identified as &lt;name&gt;.
</pre><a class="anchor" name="backlog"></a><a class="anchor" name="3-backlog"></a><a class="anchor" name="3.10-backlog"></a><a class="anchor" name="backlog (Global parameters)"></a><a class="anchor" name="backlog (Log forwarding)"></a><div class="keyword"><b><a class="anchor" name="backlog"></a><a href="#3.10-backlog">backlog</a></b> <span style="color: #080">&lt;conns&gt;</span></div><pre class="text">Give hints to the system about the approximate listen backlog desired size
on connections accept.
</pre><a class="anchor" name="bind"></a><a class="anchor" name="3-bind"></a><a class="anchor" name="3.10-bind"></a><a class="anchor" name="bind (Global parameters)"></a><a class="anchor" name="bind (Log forwarding)"></a><div class="keyword"><b><a class="anchor" name="bind"></a><a href="#3.10-bind">bind</a></b> <span style="color: #080">&lt;addr&gt;</span> <span style="color: #008">[param*]</span></div><pre class="text">Used to configure a stream log listener to receive messages to forward.
This supports the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; parameters found in 5.1 paragraph including
those about ssl but some statements such as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">alpn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#alpn%20%28Bind%20options%29">Bind options</a></li><li><a href="#alpn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; may be irrelevant for
syslog protocol over TCP.
Those listeners support both &quot;Octet Counting&quot; and &quot;Non-Transparent-Framing&quot;
modes as defined in rfc-6587.
</pre><a class="anchor" name="dgram-bind"></a><a class="anchor" name="3-dgram-bind"></a><a class="anchor" name="3.10-dgram-bind"></a><a class="anchor" name="dgram-bind (Global parameters)"></a><a class="anchor" name="dgram-bind (Log forwarding)"></a><div class="keyword"><b><a class="anchor" name="dgram-bind"></a><a href="#3.10-dgram-bind">dgram-bind</a></b> <span style="color: #080">&lt;addr&gt;</span> <span style="color: #008">[param*]</span></div><pre class="text">Used to configure a datagram log listener to receive messages to forward.
Addresses must be in IPv4 or IPv6 form,followed by a port. This supports
for some of the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; parameters found in 5.1 paragraph among which
&quot;<a href="#interface">interface</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">namespace<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#namespace%20%28Bind%20options%29">Bind options</a></li><li><a href="#namespace%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; or &quot;<a href="#option%20transparent">transparent</a>&quot;, the other ones being
silently ignored as irrelevant for UDP/syslog case.
</pre><a class="anchor" name="log"></a><a class="anchor" name="3-log"></a><a class="anchor" name="3.10-log"></a><a class="anchor" name="log (Global parameters)"></a><a class="anchor" name="log (Log forwarding)"></a><a class="anchor" name="log global"></a><a class="anchor" name="3-log global"></a><a class="anchor" name="3.10-log global"></a><a class="anchor" name="log global (Global parameters)"></a><a class="anchor" name="log global (Log forwarding)"></a><div class="keyword"><b><a class="anchor" name="log global"></a><a href="#3.10-log%20global">log global</a></b></div><a class="anchor" name="log"></a><a class="anchor" name="3-log"></a><a class="anchor" name="3.10-log"></a><a class="anchor" name="log (Global parameters)"></a><a class="anchor" name="log (Log forwarding)"></a><div class="keyword"><b><a class="anchor" name="log"></a><a href="#3.10-log">log</a></b> <span style="color: #080">&lt;target&gt;</span> <span style="color: #008">[len <span style="color: #080">&lt;length&gt;</span>]</span> <span style="color: #008">[format <span style="color: #080">&lt;format&gt;</span>]</span> <span style="color: #008">[sample <span style="color: #080">&lt;ranges&gt;</span>:<span style="color: #080">&lt;sample_size&gt;</span>]</span>
    <span style="color: #080">&lt;facility&gt;</span> <span style="color: #008">[<span style="color: #080">&lt;level&gt;</span> <span style="color: #008">[<span style="color: #080">&lt;minlevel&gt;</span>]</span>]</span></div><pre class="text">Used to configure target log servers. See more details on proxies
documentation.
If no format specified, HAProxy tries to keep the incoming log format.
Configured facility is ignored, except if incoming message does not
present a facility but one is mandatory on the outgoing format.
If there is no timestamp available in the input format, but the field
exists in output format, HAProxy will use the local date.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>global
   log stderr format iso local7

ring myring
    description &quot;My local buffer&quot;
    format rfc5424
    maxlen 1200
    size 32764
    timeout connect 5s
    timeout server 10s
    <span class="comment"># syslog tcp server</span>
    server mysyslogsrv 127.0.0.1:514 log-proto octet-count

log-forward sylog-loadb
    dgram-bind 127.0.0.1:1514
    bind 127.0.0.1:1514
    <span class="comment"># all messages on stderr</span>
    log global
    <span class="comment"># all messages on local tcp syslog server</span>
    log ring@myring local0
    <span class="comment"># load balance messages on 4 udp syslog servers</span>
    log 127.0.0.1:10001 sample 1:4 local0
    log 127.0.0.1:10002 sample 2:4 local0
    log 127.0.0.1:10003 sample 3:4 local0
    log 127.0.0.1:10004 sample 4:4 local0
</code></pre>
</div><a class="anchor" name="maxconn"></a><a class="anchor" name="3-maxconn"></a><a class="anchor" name="3.10-maxconn"></a><a class="anchor" name="maxconn (Global parameters)"></a><a class="anchor" name="maxconn (Log forwarding)"></a><div class="keyword"><b><a class="anchor" name="maxconn"></a><a href="#3.10-maxconn">maxconn</a></b> <span style="color: #080">&lt;conns&gt;</span></div><pre class="text">Fix the maximum number of concurrent connections on a log forwarder.
10 is the default.
</pre><a class="anchor" name="timeout"></a><a class="anchor" name="3-timeout"></a><a class="anchor" name="3.10-timeout"></a><a class="anchor" name="timeout (Global parameters)"></a><a class="anchor" name="timeout (Log forwarding)"></a><a class="anchor" name="timeout client"></a><a class="anchor" name="3-timeout client"></a><a class="anchor" name="3.10-timeout client"></a><a class="anchor" name="timeout client (Global parameters)"></a><a class="anchor" name="timeout client (Log forwarding)"></a><div class="keyword"><b><a class="anchor" name="timeout client"></a><a href="#3.10-timeout%20client">timeout client</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set the maximum inactivity time on the client side.
</pre></div>
<a class="anchor" id="3.11" name="3.11"></a>
<h2 id="chapter-3.11" data-target="3.11"><small><a class="small" href="#3.11">3.11.</a></small> HTTPClient tuning</h2>
<div><pre class="text">HTTPClient is an internal HTTP library, it can be used by various subsystems,
for example in LUA scripts. HTTPClient is not used in the data path, in other
words it has nothing with HTTP traffic passing through HAProxy.
</pre><a class="anchor" name="httpclient.resolvers.disabled"></a><a class="anchor" name="3-httpclient.resolvers.disabled"></a><a class="anchor" name="3.11-httpclient.resolvers.disabled"></a><a class="anchor" name="httpclient.resolvers.disabled (Global parameters)"></a><a class="anchor" name="httpclient.resolvers.disabled (HTTPClient tuning)"></a><div class="keyword"><b><a class="anchor" name="httpclient.resolvers.disabled"></a><a href="#3.11-httpclient.resolvers.disabled">httpclient.resolvers.disabled</a></b> <span style="color: #080">&lt;on|off&gt;</span></div><pre class="text">Disable the DNS resolution of the httpclient. Prevent the creation of the
&quot;default&quot; resolvers section.

Default value is off.
</pre><a class="anchor" name="httpclient.resolvers.id"></a><a class="anchor" name="3-httpclient.resolvers.id"></a><a class="anchor" name="3.11-httpclient.resolvers.id"></a><a class="anchor" name="httpclient.resolvers.id (Global parameters)"></a><a class="anchor" name="httpclient.resolvers.id (HTTPClient tuning)"></a><div class="keyword"><b><a class="anchor" name="httpclient.resolvers.id"></a><a href="#3.11-httpclient.resolvers.id">httpclient.resolvers.id</a></b> <span style="color: #080">&lt;resolvers id&gt;</span></div><pre class="text">This option defines the resolvers section with which the httpclient will try
to resolve.

Default option is the &quot;default&quot; resolvers ID. By default, if this option is
not used, it will simply disable the resolving if the section is not found.

However, when this option is explicitly enabled it will trigger a
configuration error if it fails to load.
</pre><a class="anchor" name="httpclient.resolvers.prefer"></a><a class="anchor" name="3-httpclient.resolvers.prefer"></a><a class="anchor" name="3.11-httpclient.resolvers.prefer"></a><a class="anchor" name="httpclient.resolvers.prefer (Global parameters)"></a><a class="anchor" name="httpclient.resolvers.prefer (HTTPClient tuning)"></a><div class="keyword"><b><a class="anchor" name="httpclient.resolvers.prefer"></a><a href="#3.11-httpclient.resolvers.prefer">httpclient.resolvers.prefer</a></b> <span style="color: #080">&lt;ipv4|ipv6&gt;</span></div><pre class="text">This option allows to chose which family of IP you want when resolving,
which is convenient when IPv6 is not available on your network. Default
option is &quot;<a href="#ipv6">ipv6</a>&quot;.
</pre><a class="anchor" name="httpclient.retries"></a><a class="anchor" name="3-httpclient.retries"></a><a class="anchor" name="3.11-httpclient.retries"></a><a class="anchor" name="httpclient.retries (Global parameters)"></a><a class="anchor" name="httpclient.retries (HTTPClient tuning)"></a><div class="keyword"><b><a class="anchor" name="httpclient.retries"></a><a href="#3.11-httpclient.retries">httpclient.retries</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">This option allows to configure the number of retries attempt of the
httpclient when a request failed. This does the same as the &quot;<a href="#retries">retries</a>&quot; keyword
in a backend.

Default value is 3.
</pre><a class="anchor" name="httpclient.ssl.ca-file"></a><a class="anchor" name="3-httpclient.ssl.ca-file"></a><a class="anchor" name="3.11-httpclient.ssl.ca-file"></a><a class="anchor" name="httpclient.ssl.ca-file (Global parameters)"></a><a class="anchor" name="httpclient.ssl.ca-file (HTTPClient tuning)"></a><div class="keyword"><b><a class="anchor" name="httpclient.ssl.ca-file"></a><a href="#3.11-httpclient.ssl.ca-file">httpclient.ssl.ca-file</a></b> <span style="color: #080">&lt;cafile&gt;</span></div><pre class="text">This option defines the ca-file which should be used to verify the server
certificate. It takes the same parameters as the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ca-file<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ca-file%20%28Bind%20options%29">Bind options</a></li><li><a href="#ca-file%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; option on the
server line.

By default and when this option is not used, the value is
&quot;@system-ca&quot; which tries to load the CA of the system. If it fails the SSL
will be disabled for the httpclient.

However, when this option is explicitly enabled it will trigger a
configuration error if it fails.
</pre><a class="anchor" name="httpclient.ssl.verify"></a><a class="anchor" name="3-httpclient.ssl.verify"></a><a class="anchor" name="3.11-httpclient.ssl.verify"></a><a class="anchor" name="httpclient.ssl.verify (Global parameters)"></a><a class="anchor" name="httpclient.ssl.verify (HTTPClient tuning)"></a><div class="keyword"><b><a class="anchor" name="httpclient.ssl.verify"></a><a href="#3.11-httpclient.ssl.verify">httpclient.ssl.verify</a></b> <span style="color: #008">[none|required]</span></div><pre class="text">Works the same way as the verify option on server lines. If specified to 'none',
servers certificates are not verified. Default option is &quot;required&quot;.

By default and when this option is not used, the value is
&quot;required&quot;. If it fails the SSL will be disabled for the httpclient.

However, when this option is explicitly enabled it will trigger a
configuration error if it fails.
</pre><a class="anchor" name="httpclient.timeout.connect"></a><a class="anchor" name="3-httpclient.timeout.connect"></a><a class="anchor" name="3.11-httpclient.timeout.connect"></a><a class="anchor" name="httpclient.timeout.connect (Global parameters)"></a><a class="anchor" name="httpclient.timeout.connect (HTTPClient tuning)"></a><div class="keyword"><b><a class="anchor" name="httpclient.timeout.connect"></a><a href="#3.11-httpclient.timeout.connect">httpclient.timeout.connect</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set the maximum time to wait for a connection attempt by default for the
httpclient.
</pre><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the timeout value specified in milliseconds by default, but
          can be in any other unit if the number is suffixed by the unit,
          as explained at the top of this document.</pre>
</div>
<pre class="text">The default value is 5000ms.
</pre></div>
<a class="anchor" id="3.12" name="3.12"></a>
<h2 id="chapter-3.12" data-target="3.12"><small><a class="small" href="#3.12">3.12.</a></small> Certificate Storage</h2>
<div><pre class="text">HAProxy uses an internal storage mechanism to load and store certificates used
in the configuration. This storage can be configured by using a &quot;crt-store&quot;
section. It allows to configure certificate definitions and which files should
be loaded in it. A certificate definition must be written before it is used
elsewhere in the configuration.

The &quot;crt-store&quot; takes an optional name in argument. If a name is specified,
every certificate of this store must be referenced using &quot;@&lt;name&gt;/&lt;crt&gt;&quot; or
&quot;@&lt;name&gt;/&lt;alias&gt;&quot;.

Files in the certificate storage can also be updated dynamically with the CLI.
See &quot;set ssl cert&quot; in the <a href="#9.3">section 9.3</a> of the management guide.


The following keywords are supported in the &quot;crt-store&quot; section :
  - <a href="#crt-base">crt-base</a>
  - <a href="#key-base">key-base</a>
  - <a href="#load">load</a>
</pre><a class="anchor" name="crt-base"></a><a class="anchor" name="3-crt-base"></a><a class="anchor" name="3.12-crt-base"></a><a class="anchor" name="crt-base (Global parameters)"></a><a class="anchor" name="crt-base (Certificate Storage)"></a><div class="keyword"><b><a class="anchor" name="crt-base"></a><a href="#3.12-crt-base">crt-base</a></b> <span style="color: #080">&lt;dir&gt;</span></div><pre class="text">Assigns a default directory to fetch SSL certificates from when a relative
path is used with &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crt<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crt%20%28Load%20options%29">Load options</a></li><li><a href="#crt%20%28Bind%20options%29">Bind options</a></li><li><a href="#crt%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; directives. Absolute locations specified prevail and
ignore &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crt-base<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crt-base%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#crt-base%20%28Certificate%20Storage%29">Certificate Storage</a></li></ul></span>&quot;. When used in a crt-store, the crt-base of the global
section is ignored.
</pre><a class="anchor" name="key-base"></a><a class="anchor" name="3-key-base"></a><a class="anchor" name="3.12-key-base"></a><a class="anchor" name="key-base (Global parameters)"></a><a class="anchor" name="key-base (Certificate Storage)"></a><div class="keyword"><b><a class="anchor" name="key-base"></a><a href="#3.12-key-base">key-base</a></b> <span style="color: #080">&lt;dir&gt;</span></div><pre class="text">Assigns a default directory to fetch SSL private keys from when a relative
path is used with &quot;<a href="#key">key</a>&quot; directives. Absolute locations specified prevail and
ignore &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">key-base<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#key-base%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#key-base%20%28Certificate%20Storage%29">Certificate Storage</a></li></ul></span>&quot;. When used in a crt-store, the key-base of the global
section is ignored.
</pre><a class="anchor" name="load"></a><a class="anchor" name="3-load"></a><a class="anchor" name="3.12-load"></a><a class="anchor" name="load (Global parameters)"></a><a class="anchor" name="load (Certificate Storage)"></a><div class="keyword"><b><a class="anchor" name="load"></a><a href="#3.12-load">load</a></b> <span style="color: #008">[crt <span style="color: #080">&lt;filename&gt;</span>]</span> <span style="color: #008">[param*]</span></div><pre class="text">Load SSL files in the certificate storage. For the parameter list, see section
&quot;3.12.1. Load options&quot;
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>crt-store
    load crt &quot;site1.crt&quot; key &quot;site1.key&quot; ocsp &quot;site1.ocsp&quot; alias &quot;site1&quot;
    load crt &quot;site2.crt&quot; key &quot;site2.key&quot;

frontend in2
    bind *:443 ssl crt &quot;@/site1&quot; crt &quot;site2.crt&quot;

crt-store web
    crt-base /etc/ssl/certs/
    key-base /etc/ssl/private/
    load crt &quot;site3.crt&quot; alias &quot;site3&quot;
    load crt &quot;site4.crt&quot; key &quot;site4.key&quot;

frontend in2
    bind *:443 ssl crt &quot;@web/site1&quot; crt &quot;site2.crt&quot;  crt &quot;@web/site3&quot; crt &quot;@web/site4.crt&quot;
</code></pre>
</div></div>
<a class="anchor" id="3.12.1" name="3.12.1"></a>
<h3 id="chapter-3.12.1" data-target="3.12.1"><small><a class="small" href="#3.12.1">3.12.1.</a></small> Load options</h3>
<div><pre class="text">Load SSL files in the certificate storage. The load keyword can take multiple
parameters which are listed below. These keywords are also usable in a
crt-list.
</pre><a class="anchor" name="crt"></a><a class="anchor" name="3-crt"></a><a class="anchor" name="3.12.1-crt"></a><a class="anchor" name="crt (Global parameters)"></a><a class="anchor" name="crt (Load options)"></a><div class="keyword"><b><a class="anchor" name="crt"></a><a href="#3.12.1-crt">crt</a></b> <span style="color: #080">&lt;filename&gt;</span></div><pre class="text">This argument is mandatory, it loads a PEM which must contain the public
certificate but could also contain the intermediate certificates and the
private key.  If no private key is provided in this file, a key can be provided
with the &quot;<a href="#key">key</a>&quot; keyword.
</pre><a class="anchor" name="alias"></a><a class="anchor" name="3-alias"></a><a class="anchor" name="3.12.1-alias"></a><a class="anchor" name="alias (Global parameters)"></a><a class="anchor" name="alias (Load options)"></a><div class="keyword"><b><a class="anchor" name="alias"></a><a href="#3.12.1-alias">alias</a></b> <span style="color: #080">&lt;string&gt;</span></div><pre class="text">Optional argument. Allow to name the certificate with an alias, so it can be
referenced with it in the configuration. An alias must be prefixed with '@/'
when called elsewhere in the configuration.
</pre><a class="anchor" name="key"></a><a class="anchor" name="3-key"></a><a class="anchor" name="3.12.1-key"></a><a class="anchor" name="key (Global parameters)"></a><a class="anchor" name="key (Load options)"></a><div class="keyword"><b><a class="anchor" name="key"></a><a href="#3.12.1-key">key</a></b> <span style="color: #080">&lt;filename&gt;</span></div><pre class="text">This argument is optional. Load a private key in PEM format. If a private key
was already defined in &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crt<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crt%20%28Load%20options%29">Load options</a></li><li><a href="#crt%20%28Bind%20options%29">Bind options</a></li><li><a href="#crt%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;, it will overwrite it.
</pre><a class="anchor" name="ocsp"></a><a class="anchor" name="3-ocsp"></a><a class="anchor" name="3.12.1-ocsp"></a><a class="anchor" name="ocsp (Global parameters)"></a><a class="anchor" name="ocsp (Load options)"></a><div class="keyword"><b><a class="anchor" name="ocsp"></a><a href="#3.12.1-ocsp">ocsp</a></b> <span style="color: #080">&lt;filename&gt;</span></div><pre class="text">This argument is optional, it loads an OCSP response in DER format. It can
be updated with the CLI.
</pre><a class="anchor" name="issuer"></a><a class="anchor" name="3-issuer"></a><a class="anchor" name="3.12.1-issuer"></a><a class="anchor" name="issuer (Global parameters)"></a><a class="anchor" name="issuer (Load options)"></a><div class="keyword"><b><a class="anchor" name="issuer"></a><a href="#3.12.1-issuer">issuer</a></b> <span style="color: #080">&lt;filename&gt;</span></div><pre class="text">This argument is optional. Load the OCSP issuer in PEM format. In order to
identify which certificate an OCSP Response applies to, the issuer's
certificate is necessary.  If the issuer's certificate is not found in the
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crt<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crt%20%28Load%20options%29">Load options</a></li><li><a href="#crt%20%28Bind%20options%29">Bind options</a></li><li><a href="#crt%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; file, it could be loaded from a file with this argument.
</pre><a class="anchor" name="sctl"></a><a class="anchor" name="3-sctl"></a><a class="anchor" name="3.12.1-sctl"></a><a class="anchor" name="sctl (Global parameters)"></a><a class="anchor" name="sctl (Load options)"></a><div class="keyword"><b><a class="anchor" name="sctl"></a><a href="#3.12.1-sctl">sctl</a></b> <span style="color: #080">&lt;filename&gt;</span></div><pre class="text">This argument is optional. Support for Certificate Transparency (RFC6962) TLS
extension is enabled. The file must contain a valid Signed Certificate
Timestamp List, as described in RFC. File is parsed to check basic syntax,
but no signatures are verified.
</pre><a class="anchor" name="ocsp-update"></a><a class="anchor" name="3-ocsp-update"></a><a class="anchor" name="3.12.1-ocsp-update"></a><a class="anchor" name="ocsp-update (Global parameters)"></a><a class="anchor" name="ocsp-update (Load options)"></a><div class="keyword"><b><a class="anchor" name="ocsp-update"></a><a href="#3.12.1-ocsp-update">ocsp-update</a></b> <span style="color: #008">[ off | on ]</span></div><pre class="text">Enable automatic OCSP response update when set to 'on', disable it otherwise.
Its value defaults to 'off'.
To enable the OCSP auto update on a bind line, you can use this option in a
crt-store or you can use the global option &quot;tune.ocsp-update.mode&quot;.
If a given certificate is used in multiple crt-lists with different values of
the 'ocsp-update' set, an error will be raised. Likewise, if a certificate
inherits from the global option on a bind line and has an incompatible
explicit 'ocsp-update' option set in a crt-list, the same error will be
raised.
</pre><div class="separator">
<span class="label label-success">Examples:</span>
<pre class="prettyprint">
<code>Here is an example configuration enabling it with a crt-list:
</code></pre>
</div><pre class="text">haproxy.cfg:
    frontend fe
        bind :443 ssl crt-list haproxy.list

haproxy.list:
    server_cert.pem [ocsp-update on] foo.bar

Here is an example configuration enabling it with a crt-store:

haproxy.cfg:

    crt-store
      load crt foobar.pem ocsp-update on

    frontend fe
        bind :443 ssl crt foobar.pem

When the option is set to 'on', we will try to get an ocsp response whenever
an ocsp uri is found in the frontend's certificate. The only limitation of
this mode is that the certificate's issuer will have to be known in order for
the OCSP certid to be built.
Each OCSP response will be updated at least once an hour, and even more
frequently if a given OCSP response has an expire date earlier than this one
hour limit. A minimum update interval of 5 minutes will still exist in order
to avoid updating too often responses that have a really short expire time or
even no 'Next Update' at all. Because of this hard limit, please note that
when auto update is set to 'on', any OCSP response loaded during init will
not be updated until at least 5 minutes, even if its expire time ends before
now+5m. This should not be too much of a hassle since an OCSP response must
be valid when it gets loaded during init (its expire time must be in the
future) so it is unlikely that this response expires in such a short time
after init.
On the other hand, if a certificate has an OCSP uri specified and no OCSP
response, setting this option to 'on' for the given certificate will ensure
that the OCSP response gets fetched automatically right after init.
The default minimum and maximum delays (5 minutes and 1 hour respectively)
can be configured by the &quot;<a href="#ocsp-update.maxdelay">ocsp-update.maxdelay</a>&quot; and &quot;<a href="#ocsp-update.mindelay">ocsp-update.mindelay</a>&quot;
global options.

Whenever an OCSP response is updated by the auto update task or following a
call to the &quot;update ssl ocsp-response&quot; CLI command, a dedicated log line is
emitted. It follows a dedicated format that contains the following header
&quot;&lt;OCSP-UPDATE&gt;&quot; and is followed by specific OCSP-related information:
  - the path of the corresponding frontend certificate
  - a numerical update status
  - a textual update status
  - the number of update failures for the given response
  - the number of update successes for the givan response
See &quot;show ssl ocsp-updates&quot; CLI command for a full list of error codes and
error messages. This line is emitted regardless of the success or failure of
the concerned OCSP response update.
The OCSP request/response is sent and received through an http_client
instance that has the dontlog-normal option set and that uses the regular
HTTP log format in case of error (unreachable OCSP responder for instance).
If such an error occurs, another log line that contains HTTP-related
information will then be emitted alongside the &quot;regular&quot; OCSP one (which will
likely have &quot;HTTP error&quot; as text status). But if a purely HTTP error happens
(unreachable OCSP responder for instance), an extra log line that follows the
regular HTTP log-format will be emitted.
Here are two examples of such log lines, with a successful OCSP update log
line first and then an example of an HTTP error with the two different lines
(lines were spit and the URL was shortened for readability):
  &lt;133&gt;Mar  6 11:16:53 haproxy[14872]: &lt;OCSP-UPDATE&gt; /path_to_cert/foo.pem 1 \
          &quot;Update successful&quot; 0 1

  &lt;133&gt;Mar  6 11:18:55 haproxy[14872]: &lt;OCSP-UPDATE&gt; /path_to_cert/bar.pem 2 \
          &quot;HTTP error&quot; 1 0
  &lt;133&gt;Mar  6 11:18:55 haproxy[14872]: -:- [06/Mar/2023:11:18:52.200] \
          &lt;OCSP-UPDATE&gt; -/- 2/0/-1/-1/3009 503 217 - - SC-- 0/0/0/0/3 0/0 {} \
          &quot;GET http://127.0.0.1:12345/MEMwQT HTTP/1.1&quot;

Troubleshooting:
A common error that can happen with let's encrypt certificates is if the DNS
resolution provides an IPv6 address and your system does not have a valid
outgoing IPv6 route. In such a case, you can either create the appropriate
route or set the &quot;httpclient.resolvers.prefer ipv4&quot; option in the global
section.
In case of &quot;OCSP response check failure&quot; error, you might want to check that
the issuer certificate that you provided is valid.
</pre></div>
<a class="anchor" id="4" name="4"></a>
<div class="page-header"><h1 id="chapter-4" data-target="4"><small><a class="small" href="#4">4.</a></small> Proxies</h1>
</div><div><pre class="text">Proxy configuration can be located in a set of sections :
 - defaults [&lt;name&gt;] [ from &lt;defaults_name&gt; ]
 - frontend &lt;name&gt;   [ from &lt;defaults_name&gt; ]
 - backend  &lt;name&gt;   [ from &lt;defaults_name&gt; ]
 - listen   &lt;name&gt;   [ from &lt;defaults_name&gt; ]

A &quot;frontend&quot; section describes a set of listening sockets accepting client
connections.

A &quot;backend&quot; section describes a set of servers to which the proxy will connect
to forward incoming connections.

A &quot;listen&quot; section defines a complete proxy with its frontend and backend
parts combined in one section. It is generally useful for TCP-only traffic.

A &quot;defaults&quot; section resets all settings to the documented ones and presets new
ones for use by subsequent sections. All of &quot;frontend&quot;, &quot;backend&quot; and &quot;listen&quot;
sections always take their initial settings from a defaults section, by default
the latest one that appears before the newly created section. It is possible to
explicitly designate a specific &quot;defaults&quot; section to load the initial settings
from by indicating its name on the section line after the optional keyword
&quot;from&quot;. While &quot;defaults&quot; section do not impose a name, this use is encouraged
for better readability. It is also the only way to designate a specific section
to use instead of the default previous one. Since &quot;defaults&quot; section names are
optional, by default a very permissive check is applied on their name and these
are even permitted to overlap. However if a &quot;defaults&quot; section is referenced by
any other section, its name must comply with the syntax imposed on all proxy
names, and this name must be unique among the defaults sections. Please note
that regardless of what is currently permitted, it is recommended to avoid
duplicate section names in general and to respect the same syntax as for proxy
names. This rule might be enforced in a future version. In addition, a warning
is emitted if a defaults section is explicitly used by a proxy while it is also
implicitly used by another one because it is the last one defined. It is highly
encouraged to not mix both usages by always using explicit references or by
adding a last common defaults section reserved for all implicit uses.

Note that it is even possible for a defaults section to take its initial
settings from another one, and as such, inherit settings across multiple levels
of defaults sections. This can be convenient to establish certain configuration
profiles to carry groups of default settings (e.g. TCP vs HTTP or short vs long
timeouts) but can quickly become confusing to follow.

All proxy names must be formed from upper and lower case letters, digits,
'-' (dash), '_' (underscore) , '.' (dot) and ':' (colon). ACL names are
case-sensitive, which means that &quot;www&quot; and &quot;WWW&quot; are two different proxies.

Historically, all proxy names could overlap, it just caused troubles in the
logs. Since the introduction of content switching, it is mandatory that two
proxies with overlapping capabilities (frontend/backend) have different names.
However, it is still permitted that a frontend and a backend share the same
name, as this configuration seems to be commonly encountered.

Right now, two major proxy modes are supported : &quot;tcp&quot;, also known as layer 4,
and &quot;http&quot;, also known as layer 7. In layer 4 mode, HAProxy simply forwards
bidirectional traffic between two sides. In layer 7 mode, HAProxy analyzes the
protocol, and can interact with it by allowing, blocking, switching, adding,
modifying, or removing arbitrary contents in requests or responses, based on
arbitrary criteria.

In HTTP mode, the processing applied to requests and responses flowing over
a connection depends in the combination of the frontend's HTTP options and
the backend's. HAProxy supports 3 connection modes :

  - KAL : keep alive (&quot;<a href="#option%20http-keep-alive">option http-keep-alive</a>&quot;) which is the default mode : all
    requests and responses are processed, and connections remain open but idle
    between responses and new requests.

  - SCL: server close (&quot;<a href="#option%20http-server-close">option http-server-close</a>&quot;) : the server-facing
    connection is closed after the end of the response is received, but the
    client-facing connection remains open.

  - CLO: close (&quot;<a href="#option%20httpclose">option httpclose</a>&quot;): the connection is closed after the end of
    the response and &quot;Connection: close&quot; appended in both directions.

The effective mode that will be applied to a connection passing through a
frontend and a backend can be determined by both proxy modes according to the
following matrix, but in short, the modes are symmetric, keep-alive is the
weakest option and close is the strongest.

                   Backend mode

                | KAL | SCL | CLO
            ----+-----+-----+----
            KAL | KAL | SCL | CLO
            ----+-----+-----+----
   mode     SCL | SCL | SCL | CLO
            ----+-----+-----+----
            CLO | CLO | CLO | CLO

It is possible to chain a TCP frontend to an HTTP backend. It is pointless if
only HTTP traffic is handled. But it may be used to handle several protocols
within the same frontend. In this case, the client's connection is first handled
as a raw tcp connection before being upgraded to HTTP. Before the upgrade, the
content processings are performend on raw data. Once upgraded, data is parsed
and stored using an internal representation called HTX and it is no longer
possible to rely on raw representation. There is no way to go back.

There are two kind of upgrades, in-place upgrades and destructive upgrades. The
first ones involves a TCP to HTTP/1 upgrade. In HTTP/1, the request
processings are serialized, thus the applicative stream can be preserved. The
second one involves a TCP to HTTP/2 upgrade. Because it is a multiplexed
protocol, the applicative stream cannot be associated to any HTTP/2 stream and
is destroyed. New applicative streams are then created when HAProxy receives
new HTTP/2 streams at the lower level, in the H2 multiplexer. It is important
to understand this difference because that drastically changes the way to
process data. When an HTTP/1 upgrade is performed, the content processings
already performed on raw data are neither lost nor reexecuted while for an
HTTP/2 upgrade, applicative streams are distinct and all frontend rules are
evaluated systematically on each one. And as said, the first stream, the TCP
one, is destroyed, but only after the frontend rules were evaluated.

There is another importnat point to understand when HTTP processings are
performed from a TCP proxy. While HAProxy is able to parse HTTP/1 in-fly from
tcp-request content rules, it is not possible for HTTP/2. Only the HTTP/2
preface can be parsed. This is a huge limitation regarding the HTTP content
analysis in TCP. Concretely it is only possible to know if received data are
HTTP. For instance, it is not possible to choose a backend based on the Host
header value while it is trivial in HTTP/1. Hopefully, there is a solution to
mitigate this drawback.

There are two ways to perform an HTTP upgrade. The first one, the historical
method, is to select an HTTP backend. The upgrade happens when the backend is
set. Thus, for in-place upgrades, only the backend configuration is considered
in the HTTP data processing. For destructive upgrades, the applicative stream
is destroyed, thus its processing is stopped. With this method, possibilities
to choose a backend with an HTTP/2 connection are really limited, as mentioned
above, and a bit useless because the stream is destroyed. The second method is
to upgrade during the tcp-request content rules evaluation, thanks to the
&quot;<a href="#switch-mode%20http">switch-mode http</a>&quot; action. In this case, the upgrade is performed in the
frontend context and it is possible to define HTTP directives in this
frontend. For in-place upgrades, it offers all the power of the HTTP analysis
as soon as possible. It is not that far from an HTTP frontend. For destructive
upgrades, it does not change anything except it is useless to choose a backend
on limited information. It is of course the recommended method. Thus, testing
the request protocol from the tcp-request content rules to perform an HTTP
upgrade is enough. All the remaining HTTP manipulation may be moved to the
frontend http-request ruleset. But keep in mind that tcp-request content rules
remains evaluated on each streams, that can't be changed.
</pre></div>
<a class="anchor" id="4.1" name="4.1"></a>
<h2 id="chapter-4.1" data-target="4.1"><small><a class="small" href="#4.1">4.1.</a></small> Proxy keywords matrix</h2>
<div><pre class="text">The following list of keywords is supported. Most of them may only be used in a
limited set of section types. Some of them are marked as &quot;deprecated&quot; because
they are inherited from an old syntax which may be confusing or functionally
limited, and there are new recommended keywords to replace them. Keywords
marked with &quot;(*)&quot; can be optionally inverted using the &quot;no&quot; prefix, e.g. &quot;no
option contstats&quot;. This makes sense when the option has been enabled by default
and must be disabled for a specific instance. Such options may also be prefixed
with &quot;default&quot; in order to restore default settings regardless of what has been
specified in a previous &quot;defaults&quot; section. Keywords supported in defaults
sections marked with &quot;(!)&quot; are only supported in named defaults sections, not
anonymous ones.

Note: Some dangerous and not recommanded directives are intentionnaly not
      listed in the following matrix. It is on purpose. These directives are
      documentated. But by not listing them below is one more way to discourage
      anyone to use it.
</pre><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>keyword</th><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td ><a href="#4-acl">acl</a></td><td class="pagination-centered"><img src="../css/checkmark.png" alt="X (!)" title="yes (!)" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-backlog">backlog</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-balance">balance</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-bind">bind</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-capture%20cookie">capture cookie</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-capture%20request%20header">capture request header</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-capture%20response%20header">capture response header</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-clitcpka-cnt">clitcpka-cnt</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-clitcpka-idle">clitcpka-idle</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-clitcpka-intvl">clitcpka-intvl</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-compression">compression</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-cookie">cookie</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-declare%20capture">declare capture</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-default-server">default-server</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-default_backend">default_backend</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-description">description</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-disabled">disabled</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-dispatch">dispatch</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-email-alert%20from">email-alert from</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-email-alert%20level">email-alert level</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<thead><tr><th>keyword</th><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td ><a href="#4-email-alert%20mailers">email-alert mailers</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-email-alert%20myhostname">email-alert myhostname</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-email-alert%20to">email-alert to</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-enabled">enabled</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-errorfile">errorfile</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-errorfiles">errorfiles</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-errorloc">errorloc</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-errorloc302">errorloc302</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-errorloc303">errorloc303</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-error-log-format">error-log-format</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-force-persist">force-persist</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-filter">filter</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-fullconn">fullconn</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-guid">guid</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-hash-balance-factor">hash-balance-factor</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-hash-type">hash-type</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-http-after-response">http-after-response</a></td><td class="pagination-centered"><img src="../css/checkmark.png" alt="X (!)" title="yes (!)" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-http-check%20comment">http-check comment</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-http-check%20connect">http-check connect</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-http-check%20disable-on-404">http-check disable-on-404</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<thead><tr><th>keyword</th><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td ><a href="#4-http-check%20expect">http-check expect</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-http-check%20send">http-check send</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-http-check%20send-state">http-check send-state</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-http-check%20set-var">http-check set-var</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-http-check%20unset-var">http-check unset-var</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-http-error">http-error</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-http-request">http-request</a></td><td class="pagination-centered"><img src="../css/checkmark.png" alt="X (!)" title="yes (!)" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-http-response">http-response</a></td><td class="pagination-centered"><img src="../css/checkmark.png" alt="X (!)" title="yes (!)" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-http-reuse">http-reuse</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-http-send-name-header">http-send-name-header</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-id">id</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-ignore-persist">ignore-persist</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-load-server-state-from-file">load-server-state-from-file</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-log"><span class="pull-right"><span>(*)</span></span>log</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-log-format">log-format</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-log-format-sd">log-format-sd</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-log-tag">log-tag</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-log-steps">log-steps</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-max-keep-alive-queue">max-keep-alive-queue</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-max-session-srv-conns">max-session-srv-conns</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<thead><tr><th>keyword</th><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td ><a href="#4-maxconn">maxconn</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-mode">mode</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-monitor%20fail">monitor fail</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-monitor-uri">monitor-uri</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-option%20abortonclose"><span class="pull-right"><span>(*)</span></span>option abortonclose</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20allbackups"><span class="pull-right"><span>(*)</span></span>option allbackups</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20checkcache"><span class="pull-right"><span>(*)</span></span>option checkcache</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20clitcpka"><span class="pull-right"><span>(*)</span></span>option clitcpka</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-option%20contstats"><span class="pull-right"><span>(*)</span></span>option contstats</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-option%20disable-h2-upgrade"><span class="pull-right"><span>(*)</span></span>option disable-h2-upgrade</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-option%20dontlog-normal"><span class="pull-right"><span>(*)</span></span>option dontlog-normal</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-option%20dontlognull"><span class="pull-right"><span>(*)</span></span>option dontlognull</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-option%20forwardfor">option forwardfor</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20forwarded"><span class="pull-right"><span>(*)</span></span>option forwarded</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20h1-case-adjust-bogus-client"><span class="pull-right"><span>(*)</span></span>option h1-case-adjust-bogus-client</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-option%20h1-case-adjust-bogus-server"><span class="pull-right"><span>(*)</span></span>option h1-case-adjust-bogus-server</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20http-buffer-request"><span class="pull-right"><span>(*)</span></span>option http-buffer-request</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20http-ignore-probes"><span class="pull-right"><span>(*)</span></span>option http-ignore-probes</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-option%20http-keep-alive"><span class="pull-right"><span>(*)</span></span>option http-keep-alive</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20http-no-delay"><span class="pull-right"><span>(*)</span></span>option http-no-delay</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<thead><tr><th>keyword</th><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td ><a href="#4-option%20http-pretend-keepalive"><span class="pull-right"><span>(*)</span></span>option http-pretend-keepalive</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20http-restrict-req-hdr-names">option http-restrict-req-hdr-names</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20http-server-close"><span class="pull-right"><span>(*)</span></span>option http-server-close</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20http-use-proxy-header"><span class="pull-right"><span>(*)</span></span>option http-use-proxy-header</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-option%20httpchk">option httpchk</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20httpclose"><span class="pull-right"><span>(*)</span></span>option httpclose</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20httplog">option httplog</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-option%20httpslog">option httpslog</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-option%20independent-streams"><span class="pull-right"><span>(*)</span></span>option independent-streams</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20ldap-check">option ldap-check</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20external-check">option external-check</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20log-health-checks"><span class="pull-right"><span>(*)</span></span>option log-health-checks</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20log-separate-errors"><span class="pull-right"><span>(*)</span></span>option log-separate-errors</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-option%20logasap"><span class="pull-right"><span>(*)</span></span>option logasap</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-option%20mysql-check">option mysql-check</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20nolinger"><span class="pull-right"><span>(*)</span></span>option nolinger</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20originalto">option originalto</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20persist"><span class="pull-right"><span>(*)</span></span>option persist</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20pgsql-check">option pgsql-check</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20prefer-last-server"><span class="pull-right"><span>(*)</span></span>option prefer-last-server</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<thead><tr><th>keyword</th><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td ><a href="#4-option%20redispatch"><span class="pull-right"><span>(*)</span></span>option redispatch</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20redis-check">option redis-check</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20smtpchk">option smtpchk</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20socket-stats"><span class="pull-right"><span>(*)</span></span>option socket-stats</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-option%20splice-auto"><span class="pull-right"><span>(*)</span></span>option splice-auto</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20splice-request"><span class="pull-right"><span>(*)</span></span>option splice-request</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20splice-response"><span class="pull-right"><span>(*)</span></span>option splice-response</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20spop-check">option spop-check</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20srvtcpka"><span class="pull-right"><span>(*)</span></span>option srvtcpka</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20ssl-hello-chk">option ssl-hello-chk</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20tcp-check">option tcp-check</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20tcp-smart-accept"><span class="pull-right"><span>(*)</span></span>option tcp-smart-accept</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-option%20tcp-smart-connect"><span class="pull-right"><span>(*)</span></span>option tcp-smart-connect</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20tcpka">option tcpka</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20tcplog">option tcplog</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-option%20transparent"><span class="pull-right"><span>(*)</span></span>option transparent</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-option%20idle-close-on-response"><span class="pull-right"><span>(*)</span></span>option idle-close-on-response</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-external-check%20command">external-check command</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-external-check%20path">external-check path</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-persist%20rdp-cookie">persist rdp-cookie</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<thead><tr><th>keyword</th><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td ><a href="#4-quic-initial">quic-initial</a></td><td class="pagination-centered"><img src="../css/checkmark.png" alt="X (!)" title="yes (!)" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-rate-limit%20sessions">rate-limit sessions</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-redirect">redirect</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-retries">retries</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-retry-on">retry-on</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-server">server</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-server-state-file-name">server-state-file-name</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-server-template">server-template</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-source">source</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-srvtcpka-cnt">srvtcpka-cnt</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-srvtcpka-idle">srvtcpka-idle</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-srvtcpka-intvl">srvtcpka-intvl</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-stats%20admin">stats admin</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-stats%20auth">stats auth</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-stats%20enable">stats enable</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-stats%20hide-version">stats hide-version</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-stats%20http-request">stats http-request</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-stats%20realm">stats realm</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-stats%20refresh">stats refresh</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-stats%20scope">stats scope</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<thead><tr><th>keyword</th><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td ><a href="#4-stats%20show-desc">stats show-desc</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-stats%20show-legends">stats show-legends</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-stats%20show-node">stats show-node</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-stats%20uri">stats uri</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-stick%20match">stick match</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-stick%20on">stick on</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-stick%20store-request">stick store-request</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-stick%20store-response">stick store-response</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-stick-table">stick-table</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-tcp-check%20comment">tcp-check comment</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-tcp-check%20connect">tcp-check connect</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-tcp-check%20expect">tcp-check expect</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-tcp-check%20send">tcp-check send</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-tcp-check%20send-lf">tcp-check send-lf</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-tcp-check%20send-binary">tcp-check send-binary</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-tcp-check%20send-binary-lf">tcp-check send-binary-lf</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-tcp-check%20set-var">tcp-check set-var</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-tcp-check%20unset-var">tcp-check unset-var</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-tcp-request%20connection">tcp-request connection</a></td><td class="pagination-centered"><img src="../css/checkmark.png" alt="X (!)" title="yes (!)" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-tcp-request%20content">tcp-request content</a></td><td class="pagination-centered"><img src="../css/checkmark.png" alt="X (!)" title="yes (!)" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<thead><tr><th>keyword</th><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td ><a href="#4-tcp-request%20inspect-delay">tcp-request inspect-delay</a></td><td class="pagination-centered"><img src="../css/checkmark.png" alt="X (!)" title="yes (!)" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-tcp-request%20session">tcp-request session</a></td><td class="pagination-centered"><img src="../css/checkmark.png" alt="X (!)" title="yes (!)" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-tcp-response%20content">tcp-response content</a></td><td class="pagination-centered"><img src="../css/checkmark.png" alt="X (!)" title="yes (!)" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-tcp-response%20inspect-delay">tcp-response inspect-delay</a></td><td class="pagination-centered"><img src="../css/checkmark.png" alt="X (!)" title="yes (!)" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-timeout%20check">timeout check</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-timeout%20client">timeout client</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-timeout%20client-fin">timeout client-fin</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-timeout%20client-hs">timeout client-hs</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-timeout%20connect">timeout connect</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-timeout%20http-keep-alive">timeout http-keep-alive</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-timeout%20http-request">timeout http-request</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-timeout%20queue">timeout queue</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-timeout%20server">timeout server</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-timeout%20server-fin">timeout server-fin</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-timeout%20tarpit">timeout tarpit</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-timeout%20tunnel">timeout tunnel</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-transparent"><span class="pull-right"><span class="label label-warning">(deprecated)</span></span>transparent</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-unique-id-format">unique-id-format</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-unique-id-header">unique-id-header</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-use_backend">use_backend</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<thead><tr><th>keyword</th><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td ><a href="#4-use-fcgi-app">use-fcgi-app</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-use-server">use-server</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<a class="anchor" id="4.2" name="4.2"></a>
<h2 id="chapter-4.2" data-target="4.2"><small><a class="small" href="#4.2">4.2.</a></small> Alphabetically sorted keywords reference</h2>
<div><pre class="text">This section provides a description of each keyword and its usage.
</pre><a class="anchor" name="acl"></a><a class="anchor" name="4-acl"></a><a class="anchor" name="4.2-acl"></a><a class="anchor" name="acl (Proxies)"></a><a class="anchor" name="acl (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="acl"></a><a href="#4.2-acl">acl</a></b> <span style="color: #080">&lt;aclname&gt;</span> <span style="color: #080">&lt;criterion&gt;</span> <span style="color: #008">[flags]</span> <span style="color: #008">[operator]</span> <span style="color: #080">&lt;value&gt;</span> ...</div><pre class="text">Declare or complete an access list.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-info pagination-centered">yes(!)<br /><img src="../css/checkmark.png" alt="yes(!)" title="yes(!)" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">This directive is only available from named defaults sections, not anonymous
ones. ACLs defined in a defaults section are not visible from other sections
using it.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>acl invalid_src  src          0.0.0.0/7 224.0.0.0/3
acl invalid_src  src_port     0:1023
acl local_dst    hdr(host) -i localhost
</code></pre>
</div><pre class="text">See <a href="#7">section 7</a> about ACL usage.
</pre><a class="anchor" name="backlog"></a><a class="anchor" name="4-backlog"></a><a class="anchor" name="4.2-backlog"></a><a class="anchor" name="backlog (Proxies)"></a><a class="anchor" name="backlog (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="backlog"></a><a href="#4.2-backlog">backlog</a></b> <span style="color: #080">&lt;conns&gt;</span></div><pre class="text">Give hints to the system about the approximate listen backlog desired size

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;conns&gt;   is the number of pending connections. Depending on the operating
          system, it may represent the number of already acknowledged
          connections, of non-acknowledged ones, or both.</pre>
</div>
<pre class="text">This option is only meaningful for stream listeners, including QUIC ones. Its
behavior however is not identical with QUIC instances.

For all listeners but QUIC, in order to protect against SYN flood attacks,
one solution is to increase the system's SYN backlog size. Depending on the
system, sometimes it is just tunable via a system parameter, sometimes it is
not adjustable at all, and sometimes the system relies on hints given by the
application at the time of the listen() syscall. By default, HAProxy passes
the frontend's maxconn value to the listen() syscall. On systems which can
make use of this value, it can sometimes be useful to be able to specify a
different value, hence this backlog parameter.

On Linux 2.4, the parameter is ignored by the system. On Linux 2.6, it is
used as a hint and the system accepts up to the smallest greater power of
two, and never more than some limits (usually 32768).

For QUIC listeners, backlog sets a shared limits for both the maximum count
of active handshakes and connections waiting to be accepted. The handshake
phase relies primarily of the network latency with the remote peer, whereas
the second phase depends solely on haproxy load. When either one of this
limit is reached, haproxy starts to drop reception of INITIAL packets,
preventing any new connection allocation, until the connection excess starts
to decrease. This situation may cause browsers to silently downgrade the HTTP
versions and switching to TCP.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and the target operating system's tuning guide.</div>
<a class="anchor" name="balance"></a><a class="anchor" name="4-balance"></a><a class="anchor" name="4.2-balance"></a><a class="anchor" name="balance (Proxies)"></a><a class="anchor" name="balance (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="balance"></a><a href="#4.2-balance">balance</a></b> <span style="color: #080">&lt;algorithm&gt;</span> <span style="color: #008">[ <span style="color: #080">&lt;arguments&gt;</span> ]</span></div><a class="anchor" name="balance"></a><a class="anchor" name="4-balance"></a><a class="anchor" name="4.2-balance"></a><a class="anchor" name="balance (Proxies)"></a><a class="anchor" name="balance (Alphabetically sorted keywords reference)"></a><a class="anchor" name="balance url_param"></a><a class="anchor" name="4-balance url_param"></a><a class="anchor" name="4.2-balance url_param"></a><a class="anchor" name="balance url_param (Proxies)"></a><a class="anchor" name="balance url_param (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="balance url_param"></a><a href="#4.2-balance%20url_param">balance url_param</a></b> <span style="color: #080">&lt;param&gt;</span> <span style="color: #008">[check_post]</span></div><pre class="text">Define the load balancing algorithm to be used in a backend.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;algorithm&gt; is the algorithm used to select a server when doing load
            balancing. This only applies when no persistence information
            is available, or when a connection is redispatched to another
            server. &lt;algorithm&gt; may be one of the following :

  roundrobin  Each server is used in turns, according to their weights.
              This is the smoothest and fairest algorithm when the server's
              processing time remains equally distributed. This algorithm
              is dynamic, which means that server weights may be adjusted
              on the fly for slow starts for instance. It is limited by
              design to 4095 active servers per backend. Note that in some
              large farms, when a server becomes up after having been down
              for a very short time, it may sometimes take a few hundreds
              requests for it to be re-integrated into the farm and start
              receiving traffic. This is normal, though very rare. It is
              indicated here in case you would have the chance to observe
              it, so that you don't worry. Note: weights are ignored for
              backends in LOG mode.

  static-rr   Each server is used in turns, according to their weights.
              This algorithm is as similar to roundrobin except that it is
              static, which means that changing a server's weight on the
              fly will have no effect. On the other hand, it has no design
              limitation on the number of servers, and when a server goes
              up, it is always immediately reintroduced into the farm, once
              the full map is recomputed. It also uses slightly less CPU to
              run (around -1%). This algorithm is not usable in LOG mode.

  leastconn   The server with the lowest number of connections receives the
              connection. Round-robin is performed within groups of servers
              of the same load to ensure that all servers will be used. Use
              of this algorithm is recommended where very long sessions are
              expected, such as LDAP, SQL, TSE, etc... but is not very well
              suited for protocols using short sessions such as HTTP. This
              algorithm is dynamic, which means that server weights may be
              adjusted on the fly for slow starts for instance. It will
              also consider the number of queued connections in addition to
              the established ones in order to minimize queuing. This
              algorithm is not usable in LOG mode.

  first       The first server with available connection slots receives the
              connection. The servers are chosen from the lowest numeric
              identifier to the highest (see server parameter &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">id<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#id%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#id%20%28Bind%20options%29">Bind options</a></li><li><a href="#id%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;), which
              defaults to the server's position in the farm. Once a server
              reaches its maxconn value, the next server is used. It does
              not make sense to use this algorithm without setting maxconn.
              The purpose of this algorithm is to always use the smallest
              number of servers so that extra servers can be powered off
              during non-intensive hours. This algorithm ignores the server
              weight, and brings more benefit to long session such as RDP
              or IMAP than HTTP, though it can be useful there too. In
              order to use this algorithm efficiently, it is recommended
              that a cloud controller regularly checks server usage to turn
              them off when unused, and regularly checks backend queue to
              turn new servers on when the queue inflates. Alternatively,
              using &quot;<a href="#http-check%20send-state">http-check send-state</a>&quot; may inform servers on the load.
              This algorithm is not usable in LOG mode.

  hash        Takes a regular sample expression in argument. The expression
              is evaluated for each request and hashed according to the
              configured hash-type. The result of the hash is divided by
              the total weight of the running servers to designate which
              server will receive the request. This can be used in place of
              &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">source<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#source%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#source%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;, &quot;uri&quot;, &quot;hdr()&quot;, &quot;url_param()&quot;, &quot;rdp-cookie&quot; to make
              use of a converter, refine the evaluation, or be used to
              extract data from local variables for example. When the data
              is not available, round robin will apply. This algorithm is
              static by default, which means that changing a server's
              weight on the fly will have no effect, but this can be
              changed using &quot;<a href="#hash-type">hash-type</a>&quot;. This algorithm is not usable for
              backends in LOG mode, please use &quot;log-hash&quot; instead.

  source      The source IP address is hashed and divided by the total
              weight of the running servers to designate which server will
              receive the request. This ensures that the same client IP
              address will always reach the same server as long as no
              server goes down or up. If the hash result changes due to the
              number of running servers changing, many clients will be
              directed to a different server. This algorithm is generally
              used in TCP mode where no cookie may be inserted. It may also
              be used on the Internet to provide a best-effort stickiness
              to clients which refuse session cookies. This algorithm is
              static by default, which means that changing a server's
              weight on the fly will have no effect, but this can be
              changed using &quot;<a href="#hash-type">hash-type</a>&quot;. See also the &quot;hash&quot; option above.
              This algorithm is not usable for backends in LOG mode.

  uri         This algorithm hashes either the left part of the URI (before
              the question mark) or the whole URI (if the &quot;whole&quot; parameter
              is present) and divides the hash value by the total weight of
              the running servers. The result designates which server will
              receive the request. This ensures that the same URI will
              always be directed to the same server as long as no server
              goes up or down. This is used with proxy caches and
              anti-virus proxies in order to maximize the cache hit rate.
              Note that this algorithm may only be used in an HTTP backend.
              This algorithm is static by default, which means that
              changing a server's weight on the fly will have no effect,
              but this can be changed using &quot;<a href="#hash-type">hash-type</a>&quot;.

              This algorithm supports two optional parameters &quot;len&quot; and
              &quot;depth&quot;, both followed by a positive integer number. These
              options may be helpful when it is needed to balance servers
              based on the beginning of the URI only. The &quot;len&quot; parameter
              indicates that the algorithm should only consider that many
              characters at the beginning of the URI to compute the hash.
              Note that having &quot;len&quot; set to 1 rarely makes sense since most
              URIs start with a leading &quot;/&quot;.

              The &quot;depth&quot; parameter indicates the maximum directory depth
              to be used to compute the hash. One level is counted for each
              slash in the request. If both parameters are specified, the
              evaluation stops when either is reached.

              A &quot;path-only&quot; parameter indicates that the hashing key starts
              at the first '/' of the path. This can be used to ignore the
              authority part of absolute URIs, and to make sure that HTTP/1
              and HTTP/2 URIs will provide the same hash. See also the
              &quot;hash&quot; option above.

  url_param   The URL parameter specified in argument will be looked up in
              the query string of each HTTP GET request.

              If the modifier &quot;check_post&quot; is used, then an HTTP POST
              request entity will be searched for the parameter argument,
              when it is not found in a query string after a question mark
              ('?') in the URL. The message body will only start to be
              analyzed once either the advertised amount of data has been
              received or the request buffer is full. In the unlikely event
              that chunked encoding is used, only the first chunk is
              scanned. Parameter values separated by a chunk boundary, may
              be randomly balanced if at all. This keyword used to support
              an optional &lt;max_wait&gt; parameter which is now ignored.

              If the parameter is found followed by an equal sign ('=') and
              a value, then the value is hashed and divided by the total
              weight of the running servers. The result designates which
              server will receive the request.

              This is used to track user identifiers in requests and ensure
              that a same user ID will always be sent to the same server as
              long as no server goes up or down. If no value is found or if
              the parameter is not found, then a round robin algorithm is
              applied. Note that this algorithm may only be used in an HTTP
              backend. This algorithm is static by default, which means
              that changing a server's weight on the fly will have no
              effect, but this can be changed using &quot;<a href="#hash-type">hash-type</a>&quot;. See also
              the &quot;hash&quot; option above.

  hdr(&lt;name&gt;) The HTTP header &lt;name&gt; will be looked up in each HTTP
              request. Just as with the equivalent ACL 'hdr()' function,
              the header name in parenthesis is not case sensitive. If the
              header is absent or if it does not contain any value, the
              roundrobin algorithm is applied instead.

              An optional 'use_domain_only' parameter is available, for
              reducing the hash algorithm to the main domain part with some
              specific headers such as 'Host'. For instance, in the Host
              value &quot;haproxy.1wt.eu&quot;, only &quot;1wt&quot; will be considered.

              This algorithm is static by default, which means that
              changing a server's weight on the fly will have no effect,
              but this can be changed using &quot;<a href="#hash-type">hash-type</a>&quot;. See also the
              &quot;hash&quot; option above.

  random
  random(&lt;draws&gt;)
              A random number will be used as the key for the consistent
              hashing function. This means that the servers' weights are
              respected, dynamic weight changes immediately take effect, as
              well as new server additions. Random load balancing can be
              useful with large farms or when servers are frequently added
              or removed as it may avoid the hammering effect that could
              result from roundrobin or leastconn in this situation. The
              hash-balance-factor directive can be used to further improve
              fairness of the load balancing, especially in situations
              where servers show highly variable response times. When an
              argument &lt;draws&gt; is present, it must be an integer value one
              or greater, indicating the number of draws before selecting
              the least loaded of these servers. It was indeed demonstrated
              that picking the least loaded of two servers is enough to
              significantly improve the fairness of the algorithm, by
              always avoiding to pick the most loaded server within a farm
              and getting rid of any bias that could be induced by the
              unfair distribution of the consistent list. Higher values N
              will take away N-1 of the highest loaded servers at the
              expense of performance. With very high values, the algorithm
              will converge towards the leastconn's result but much slower.
              The default value is 2, which generally shows very good
              distribution and performance. This algorithm is also known as
              the Power of Two Random Choices and is described here :
              http://www.eecs.harvard.edu/~michaelm/postscripts/handbook2001.pdf

              For backends in LOG mode, the number of draws is ignored and
              a single random is picked since there is no notion of server
              load. Random log balancing can be useful with large farms or
              when servers are frequently added or removed from the pool of
              available servers as it may avoid the hammering effect that
              could result from roundrobin in this situation.

  rdp-cookie
  rdp-cookie(&lt;name&gt;)
              The RDP cookie &lt;name&gt; (or &quot;mstshash&quot; if omitted) will be
              looked up and hashed for each incoming TCP request. Just as
              with the equivalent ACL 'req.rdp_cookie()' function, the name
              is not case-sensitive. This mechanism is useful as a degraded
              persistence mode, as it makes it possible to always send the
              same user (or the same session ID) to the same server. If the
              cookie is not found, the normal roundrobin algorithm is
              used instead.

              Note that for this to work, the frontend must ensure that an
              RDP cookie is already present in the request buffer. For this
              you must use 'tcp-request content accept' rule combined with
              a 'req.rdp_cookie_cnt' ACL.

              This algorithm is static by default, which means that
              changing a server's weight on the fly will have no effect,
              but this can be changed using &quot;<a href="#hash-type">hash-type</a>&quot;. See also the
              &quot;hash&quot; option above.

  log-hash    Takes a comma-delimited list of converters in argument. These
              converters are applied in sequence to the input log message,
              and the result will be cast as a string then hashed according
              to the configured hash-type. The resulting hash will be used
              to select the destination server among the ones declared in
              the log backend. The goal of this algorithm is to be able to
              extract a key within the final log message using string
              converters and then be able to stick to the same server thanks
              to the hash. Only &quot;map-based&quot; hashes are supported for now.
              This algorithm is only usable for backends in LOG mode, for
              others, please use &quot;hash&quot; instead.

  sticky      Tries to stick to the same server as much as possible. The
              first server in the list of available servers receives all
              the log messages. When the server goes DOWN, the next server
              in the list takes its place. When a previously DOWN server
              goes back UP it is added at the end of the list so that the
              sticky server doesn't change until it becomes DOWN.

&lt;arguments&gt; is an optional list of arguments which may be needed by some
            algorithms. Right now, only &quot;<a href="#url_param">url_param</a>&quot;, &quot;uri&quot; and &quot;log-hash&quot;
            support an optional argument.</pre>
</div>
<pre class="text">The load balancing algorithm of a backend is set to roundrobin when no other
algorithm, mode nor option have been set. The algorithm may only be set once
for each backend.

With authentication schemes that require the same connection like NTLM, URI
based algorithms must not be used, as they would cause subsequent requests
to be routed to different backend servers, breaking the invalid assumptions
NTLM relies on.

TCP/HTTP Examples :
      balance roundrobin
      balance url_param userid
      balance url_param session_id check_post 64
      balance hdr(User-Agent)
      balance hdr(host)
      balance hdr(Host) use_domain_only
      balance hash req.cookie(clientid)
      balance hash var(req.client_id)
      balance hash req.hdr_ip(x-forwarded-for,-1),ipmask(24)

LOG backend examples:
      global
        log backend@mylog-rrb local0 # send all logs to mylog-rrb backend
        log backend@mylog-hash local0 # send all logs to mylog-hash backend

      backend mylog-rrb
        mode log
        balance roundrobin

        server s1 udp@127.0.0.1:514 # will receive 50% of log messages
        server s2 udp@127.0.0.1:514

      backend mylog-hash
        mode log

        # extract &quot;METHOD URL PROTO&quot; at the end of the log message,
        # and let haproxy hash it so that log messages generated from
        # similar requests get sent to the same syslog server:
        balance log-hash 'field(-2,\&quot;)'

        # server list here
        server s1 127.0.0.1:514
        #...

Note: the following caveats and limitations on using the &quot;check_post&quot;
extension with &quot;<a href="#url_param">url_param</a>&quot; must be considered :

  - all POST requests are eligible for consideration, because there is no way
    to determine if the parameters will be found in the body or entity which
    may contain binary data. Therefore another method may be required to
    restrict consideration of POST requests that have no URL parameters in
    the body. (see acl http_end)

  - using a &lt;max_wait&gt; value larger than the request buffer size does not
    make sense and is useless. The buffer size is set at build time, and
    defaults to 16 kB.

  - Content-Encoding is not supported, the parameter search will probably
    fail; and load balancing will fall back to Round Robin.

  - Expect: 100-continue is not supported, load balancing will fall back to
    Round Robin.

  - Transfer-Encoding (RFC7230 3.3.1) is only supported in the first chunk.
    If the entire parameter value is not present in the first chunk, the
    selection of server is undefined (actually, defined by how little
    actually appeared in the first chunk).

  - This feature does not support generation of a 100, 411 or 501 response.

  - In some cases, requesting &quot;check_post&quot; MAY attempt to scan the entire
    contents of a message body. Scanning normally terminates when linear
    white space or control characters are found, indicating the end of what
    might be a URL parameter list. This is probably not a concern with SGML
    type message bodies.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#dispatch">dispatch</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">cookie<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#cookie%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#cookie%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li><li><a href="#cookie%20%28Fetching%20HTTP%20samples%20%28Layer%207%29%29">Fetching HTTP samples (Layer 7)</a></li></ul></span>&quot;, &quot;<a href="#option%20transparent">transparent</a>&quot;, &quot;<a href="#hash-type">hash-type</a>&quot;.</div>
<a class="anchor" name="bind"></a><a class="anchor" name="4-bind"></a><a class="anchor" name="4.2-bind"></a><a class="anchor" name="bind (Proxies)"></a><a class="anchor" name="bind (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="bind"></a><a href="#4.2-bind">bind</a></b> <span style="color: #008">[<span style="color: #080">&lt;address&gt;</span>]</span>:<span style="color: #080">&lt;port_range&gt;</span> <span style="color: #008">[, ...]</span> <span style="color: #008">[param*]</span></div><a class="anchor" name="bind"></a><a class="anchor" name="4-bind"></a><a class="anchor" name="4.2-bind"></a><a class="anchor" name="bind (Proxies)"></a><a class="anchor" name="bind (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="bind"></a><a href="#4.2-bind">bind</a></b> /<span style="color: #080">&lt;path&gt;</span> <span style="color: #008">[, ...]</span> <span style="color: #008">[param*]</span></div><pre class="text">Define one or several listening addresses and/or ports in a frontend.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;address&gt;     is optional and can be a host name, an IPv4 address, an IPv6
              address, or '*'. It designates the address the frontend will
              listen on. If unset, all IPv4 addresses of the system will be
              listened on. The same will apply for '*' or the system's
              special address &quot;0.0.0.0&quot;. The IPv6 equivalent is '::'. Note
              that for UDP, specific OS features are required when binding
              on multiple addresses to ensure the correct network interface
              and source address will be used on response. In other way,
              for QUIC listeners only bind on multiple addresses if running
              with a modern enough systems.

              Optionally, an address family prefix may be used before the
              address to force the family regardless of the address format,
              which can be useful to specify a path to a unix socket with
              no slash ('/'). Currently supported prefixes are :
                - 'ipv4@'  -&gt; address is always IPv4
                - 'ipv6@'  -&gt; address is always IPv6
                - 'udp@'   -&gt; address is resolved as IPv4 or IPv6 and
                  protocol UDP is used. Currently those listeners are
                  supported only in log-forward sections.
                - 'udp4@'  -&gt; address is always IPv4 and protocol UDP
                  is used. Currently those listeners are supported
                  only in log-forward sections.
                - 'udp6@'  -&gt; address is always IPv6 and protocol UDP
                  is used. Currently those listeners are supported
                  only in log-forward sections.
                - 'unix@'  -&gt; address is a path to a local unix socket
                - 'abns@'  -&gt; address is in abstract namespace (Linux only).
                - 'abnsz@'  -&gt; address is in abstract namespace (Linux only)
                   but it is explicitly zero-terminated. This means no \0
                   padding is used to complete sun_path. It is useful to
                   interconnect with programs that don't implement the
                   default abns naming logic that haproxy uses.
                - 'fd@&lt;n&gt;' -&gt; use file descriptor &lt;n&gt; inherited from the
                  parent. The fd must be bound and may or may not already
                  be listening.
                - 'sockpair@&lt;n&gt;'-&gt; like fd@ but you must use the fd of a
                  connected unix socket or of a socketpair. The bind waits
                  to receive a FD over the unix socket and uses it as if it
                  was the FD of an accept(). Should be used carefully.
                - 'quic4@' -&gt; address is resolved as IPv4 and protocol UDP
                  is used. Note that to achieve the best performance with a
                  large traffic you should keep &quot;<a href="#tune.quic.socket-owner">tune.quic.socket-owner</a>&quot; on
                  connection. Else QUIC connections will be multiplexed
                  over the listener socket. Another alternative would be to
                  duplicate QUIC listener instances over several threads,
                  for example using &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">shards<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#shards%20%28Peers%29">Peers</a></li><li><a href="#shards%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; keyword to at least reduce
                  thread contention.
                - 'quic6@' -&gt; address is resolved as IPv6 and protocol UDP
                  is used. The performance note for QUIC over IPv4 applies
                  as well.
                - 'rhttp@' [ EXPERIMENTAL ] -&gt; used for reverse HTTP.
                  Address must be a server with the format
                  '&lt;backend&gt;/&lt;server&gt;'. The server will be used to
                  instantiate connections to a remote address. The listener
                  will try to maintain &quot;<a href="#nbconn">nbconn</a>&quot; connections. This is an
                  experimental features which requires
                  &quot;<a href="#expose-experimental-directives">expose-experimental-directives</a>&quot; on a line before this
                  bind.

              You may want to reference some environment variables in the
              address parameter, see <a href="#2.3">section 2.3</a> about environment
              variables.

&lt;port_range&gt;  is either a unique TCP port, or a port range for which the
              proxy will accept connections for the IP address specified
              above. The port is mandatory for TCP listeners. Note that in
              the case of an IPv6 address, the port is always the number
              after the last colon (':'). A range can either be :
               - a numerical port (ex: '80')
               - a dash-delimited ports range explicitly stating the lower
                 and upper bounds (ex: '2000-2100') which are included in
                 the range.

              Particular care must be taken against port ranges, because
              every &lt;address:port&gt; couple consumes one socket (= a file
              descriptor), so it's easy to consume lots of descriptors
              with a simple range, and to run out of sockets. Also, each
              &lt;address:port&gt; couple must be used only once among all
              instances running on a same system. Please note that binding
              to ports lower than 1024 generally require particular
              privileges to start the program, which are independent of
              the 'uid' parameter.

&lt;path&gt;        is a UNIX socket path beginning with a slash ('/'). This is
              alternative to the TCP listening port. HAProxy will then
              receive UNIX connections on the socket located at this place.
              The path must begin with a slash and by default is absolute.
              It can be relative to the prefix defined by &quot;<a href="#unix-bind">unix-bind</a>&quot; in
              the global section. Note that the total length of the prefix
              followed by the socket path cannot exceed some system limits
              for UNIX sockets, which commonly are set to 107 characters.

&lt;param*&gt;      is a list of parameters common to all sockets declared on the
              same line. These numerous parameters depend on OS and build
              options and have a complete section dedicated to them. Please
              refer to <a href="#5">section 5</a> to for more details.</pre>
</div>
<pre class="text">It is possible to specify a list of address:port combinations delimited by
commas. The frontend will then listen on all of these addresses. There is no
fixed limit to the number of addresses and ports which can be listened on in
a frontend, as well as there is no limit to the number of &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; statements
in a frontend.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>listen http_proxy
    bind :80,:443
    bind 10.0.0.1:10080,10.0.0.1:10443
    bind /var/run/ssl-frontend.sock user root mode 600 accept-proxy

listen http_https_proxy
    bind :80
    bind :443 ssl crt /etc/haproxy/site.pem

listen http_https_proxy_explicit
    bind ipv6@:80
    bind ipv4@public_ssl:443 ssl crt /etc/haproxy/site.pem
    bind unix@ssl-frontend.sock user root mode 600 accept-proxy

listen external_bind_app1
    bind &quot;fd@${FD_APP1}&quot;

listen h3_quic_proxy
    bind quic4@10.0.0.1:8888 ssl crt /etc/mycrt
</code></pre>
</div><pre class="text">Note: regarding Linux's abstract namespace sockets, &quot;abns&quot; HAProxy sockets
      uses the whole sun_path length is used for the address length. Some
      other programs such as socat use the string length only by default.
      Pass the option &quot;,unix-tightsocklen=0&quot; to any abstract socket
      definition in socat to make it compatible with HAProxy's, or use the
      &quot;abnsz&quot; HAProxy socket family instead.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">source<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#source%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#source%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;, &quot;<a href="#option%20forwardfor">option forwardfor</a>&quot;, &quot;<a href="#unix-bind">unix-bind</a>&quot; and the PROXY protocol documentation, and <a href="#5">section 5</a> about bind options.</div>
<a class="anchor" name="capture"></a><a class="anchor" name="4-capture"></a><a class="anchor" name="4.2-capture"></a><a class="anchor" name="capture (Proxies)"></a><a class="anchor" name="capture (Alphabetically sorted keywords reference)"></a><a class="anchor" name="capture cookie"></a><a class="anchor" name="4-capture cookie"></a><a class="anchor" name="4.2-capture cookie"></a><a class="anchor" name="capture cookie (Proxies)"></a><a class="anchor" name="capture cookie (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="capture cookie"></a><a href="#4.2-capture%20cookie">capture cookie</a></b> <span style="color: #080">&lt;name&gt;</span> len <span style="color: #080">&lt;length&gt;</span></div><pre class="text">Capture and log a cookie in the request and in the response.

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;name&gt;    is the beginning of the name of the cookie to capture. In order
          to match the exact name, simply suffix the name with an equal
          sign ('='). The full name will appear in the logs, which is
          useful with application servers which adjust both the cookie name
          and value (e.g. ASPSESSIONXXX).

&lt;length&gt;  is the maximum number of characters to report in the logs, which
          include the cookie name, the equal sign and the value, all in the
          standard &quot;name=value&quot; form. The string will be truncated on the
          right if it exceeds &lt;length&gt;.</pre>
</div>
<pre class="text">Only the first cookie is captured. Both the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">cookie<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#cookie%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#cookie%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li><li><a href="#cookie%20%28Fetching%20HTTP%20samples%20%28Layer%207%29%29">Fetching HTTP samples (Layer 7)</a></li></ul></span>&quot; request headers and the
&quot;<a href="#set-cookie">set-cookie</a>&quot; response headers are monitored. This is particularly useful to
check for application bugs causing session crossing or stealing between
users, because generally the user's cookies can only change on a login page.

When the cookie was not presented by the client, the associated log column
will report &quot;-&quot;. When a request does not cause a cookie to be assigned by the
server, a &quot;-&quot; is reported in the response column.

The capture is performed in the frontend only because it is necessary that
the log format does not change for a given frontend depending on the
backends. This may change in the future. Note that there can be only one
&quot;<a href="#capture%20cookie">capture cookie</a>&quot; statement in a frontend. The maximum capture length is set
by the global &quot;<a href="#tune.http.cookielen">tune.http.cookielen</a>&quot; setting and defaults to 63 characters. It
is not possible to specify a capture in a &quot;defaults&quot; section.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>capture cookie ASPSESSION len 32
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#capture%20request%20header">capture request header</a>&quot;, &quot;<a href="#capture%20response%20header">capture response header</a>&quot; as well as <a href="#8">section 8</a> about logging.</div>
<a class="anchor" name="capture"></a><a class="anchor" name="4-capture"></a><a class="anchor" name="4.2-capture"></a><a class="anchor" name="capture (Proxies)"></a><a class="anchor" name="capture (Alphabetically sorted keywords reference)"></a><a class="anchor" name="capture request"></a><a class="anchor" name="4-capture request"></a><a class="anchor" name="4.2-capture request"></a><a class="anchor" name="capture request (Proxies)"></a><a class="anchor" name="capture request (Alphabetically sorted keywords reference)"></a><a class="anchor" name="capture request header"></a><a class="anchor" name="4-capture request header"></a><a class="anchor" name="4.2-capture request header"></a><a class="anchor" name="capture request header (Proxies)"></a><a class="anchor" name="capture request header (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="capture request header"></a><a href="#4.2-capture%20request%20header">capture request header</a></b> <span style="color: #080">&lt;name&gt;</span> len <span style="color: #080">&lt;length&gt;</span></div><pre class="text">Capture and log the last occurrence of the specified request header.

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;name&gt;    is the name of the header to capture. The header names are not
          case-sensitive, but it is a common practice to write them as they
          appear in the requests, with the first letter of each word in
          upper case. The header name will not appear in the logs, only the
          value is reported, but the position in the logs is respected.

&lt;length&gt;  is the maximum number of characters to extract from the value and
          report in the logs. The string will be truncated on the right if
          it exceeds &lt;length&gt;.</pre>
</div>
<pre class="text">The complete value of the last occurrence of the header is captured. The
value will be added to the logs between braces ('{}'). If multiple headers
are captured, they will be delimited by a vertical bar ('|') and will appear
in the same order they were declared in the configuration. Non-existent
headers will be logged just as an empty string. Common uses for request
header captures include the &quot;Host&quot; field in virtual hosting environments, the
&quot;Content-length&quot; when uploads are supported, &quot;User-agent&quot; to quickly
differentiate between real users and robots, and &quot;X-Forwarded-For&quot; in proxied
environments to find where the request came from.

Note that when capturing headers such as &quot;User-agent&quot;, some spaces may be
logged, making the log analysis more difficult. Thus be careful about what
you log if you know your log parser is not smart enough to rely on the
braces.

There is no limit to the number of captured request headers nor to their
length, though it is wise to keep them low to limit memory usage per stream.
In order to keep log format consistent for a same frontend, header captures
can only be declared in a frontend. It is not possible to specify a capture
in a &quot;defaults&quot; section.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>capture request header Host len 15
capture request header X-Forwarded-For len 15
capture request header Referer len 15
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#capture%20cookie">capture cookie</a>&quot;, &quot;<a href="#capture%20response%20header">capture response header</a>&quot; as well as <a href="#8">section 8</a> about logging.</div>
<a class="anchor" name="capture"></a><a class="anchor" name="4-capture"></a><a class="anchor" name="4.2-capture"></a><a class="anchor" name="capture (Proxies)"></a><a class="anchor" name="capture (Alphabetically sorted keywords reference)"></a><a class="anchor" name="capture response"></a><a class="anchor" name="4-capture response"></a><a class="anchor" name="4.2-capture response"></a><a class="anchor" name="capture response (Proxies)"></a><a class="anchor" name="capture response (Alphabetically sorted keywords reference)"></a><a class="anchor" name="capture response header"></a><a class="anchor" name="4-capture response header"></a><a class="anchor" name="4.2-capture response header"></a><a class="anchor" name="capture response header (Proxies)"></a><a class="anchor" name="capture response header (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="capture response header"></a><a href="#4.2-capture%20response%20header">capture response header</a></b> <span style="color: #080">&lt;name&gt;</span> len <span style="color: #080">&lt;length&gt;</span></div><pre class="text">Capture and log the last occurrence of the specified response header.

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;name&gt;    is the name of the header to capture. The header names are not
          case-sensitive, but it is a common practice to write them as they
          appear in the response, with the first letter of each word in
          upper case. The header name will not appear in the logs, only the
          value is reported, but the position in the logs is respected.

&lt;length&gt;  is the maximum number of characters to extract from the value and
          report in the logs. The string will be truncated on the right if
          it exceeds &lt;length&gt;.</pre>
</div>
<pre class="text">The complete value of the last occurrence of the header is captured. The
result will be added to the logs between braces ('{}') after the captured
request headers. If multiple headers are captured, they will be delimited by
a vertical bar ('|') and will appear in the same order they were declared in
the configuration. Non-existent headers will be logged just as an empty
string. Common uses for response header captures include the &quot;Content-length&quot;
header which indicates how many bytes are expected to be returned, the
&quot;Location&quot; header to track redirections.

There is no limit to the number of captured response headers nor to their
length, though it is wise to keep them low to limit memory usage per stream.
In order to keep log format consistent for a same frontend, header captures
can only be declared in a frontend. It is not possible to specify a capture
in a &quot;defaults&quot; section.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>capture response header Content-length len 9
capture response header Location len 15
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#capture%20cookie">capture cookie</a>&quot;, &quot;<a href="#capture%20request%20header">capture request header</a>&quot; as well as <a href="#8">section 8</a> about logging.</div>
<a class="anchor" name="clitcpka-cnt"></a><a class="anchor" name="4-clitcpka-cnt"></a><a class="anchor" name="4.2-clitcpka-cnt"></a><a class="anchor" name="clitcpka-cnt (Proxies)"></a><a class="anchor" name="clitcpka-cnt (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="clitcpka-cnt"></a><a href="#4.2-clitcpka-cnt">clitcpka-cnt</a></b> <span style="color: #080">&lt;count&gt;</span></div><pre class="text">Sets the maximum number of keepalive probes TCP should send before dropping
the connection on the client side.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;count&gt;   is the maximum number of keepalive probes.</pre>
</div>
<pre class="text">This keyword corresponds to the socket option TCP_KEEPCNT. If this keyword
is not specified, system-wide TCP parameter (tcp_keepalive_probes) is used.
The availability of this setting depends on the operating system. It is
known to work on Linux.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20clitcpka">option clitcpka</a>&quot;, &quot;<a href="#clitcpka-idle">clitcpka-idle</a>&quot;, &quot;<a href="#clitcpka-intvl">clitcpka-intvl</a>&quot;.</div>
<a class="anchor" name="clitcpka-idle"></a><a class="anchor" name="4-clitcpka-idle"></a><a class="anchor" name="4.2-clitcpka-idle"></a><a class="anchor" name="clitcpka-idle (Proxies)"></a><a class="anchor" name="clitcpka-idle (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="clitcpka-idle"></a><a href="#4.2-clitcpka-idle">clitcpka-idle</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Sets the time the connection needs to remain idle before TCP starts sending
keepalive probes, if enabled the sending of TCP keepalive packets on the
client side.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the time the connection needs to remain idle before TCP starts
          sending keepalive probes. It is specified in seconds by default,
          but can be in any other unit if the number is suffixed by the
          unit, as explained at the top of this document.</pre>
</div>
<pre class="text">This keyword corresponds to the socket option TCP_KEEPIDLE. If this keyword
is not specified, system-wide TCP parameter (tcp_keepalive_time) is used.
The availability of this setting depends on the operating system. It is
known to work on Linux.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20clitcpka">option clitcpka</a>&quot;, &quot;<a href="#clitcpka-cnt">clitcpka-cnt</a>&quot;, &quot;<a href="#clitcpka-intvl">clitcpka-intvl</a>&quot;.</div>
<a class="anchor" name="clitcpka-intvl"></a><a class="anchor" name="4-clitcpka-intvl"></a><a class="anchor" name="4.2-clitcpka-intvl"></a><a class="anchor" name="clitcpka-intvl (Proxies)"></a><a class="anchor" name="clitcpka-intvl (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="clitcpka-intvl"></a><a href="#4.2-clitcpka-intvl">clitcpka-intvl</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Sets the time between individual keepalive probes on the client side.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the time between individual keepalive probes. It is specified
          in seconds by default, but can be in any other unit if the number
          is suffixed by the unit, as explained at the top of this
          document.</pre>
</div>
<pre class="text">This keyword corresponds to the socket option TCP_KEEPINTVL. If this keyword
is not specified, system-wide TCP parameter (tcp_keepalive_intvl) is used.
The availability of this setting depends on the operating system. It is
known to work on Linux.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20clitcpka">option clitcpka</a>&quot;, &quot;<a href="#clitcpka-cnt">clitcpka-cnt</a>&quot;, &quot;<a href="#clitcpka-idle">clitcpka-idle</a>&quot;.</div>
<a class="anchor" name="compression"></a><a class="anchor" name="4-compression"></a><a class="anchor" name="4.2-compression"></a><a class="anchor" name="compression (Proxies)"></a><a class="anchor" name="compression (Alphabetically sorted keywords reference)"></a><a class="anchor" name="compression algo"></a><a class="anchor" name="4-compression algo"></a><a class="anchor" name="4.2-compression algo"></a><a class="anchor" name="compression algo (Proxies)"></a><a class="anchor" name="compression algo (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="compression algo"></a><a href="#4.2-compression%20algo">compression algo</a></b> <span style="color: #080">&lt;algorithm&gt;</span> ...</div><a class="anchor" name="compression"></a><a class="anchor" name="4-compression"></a><a class="anchor" name="4.2-compression"></a><a class="anchor" name="compression (Proxies)"></a><a class="anchor" name="compression (Alphabetically sorted keywords reference)"></a><a class="anchor" name="compression algo-req"></a><a class="anchor" name="4-compression algo-req"></a><a class="anchor" name="4.2-compression algo-req"></a><a class="anchor" name="compression algo-req (Proxies)"></a><a class="anchor" name="compression algo-req (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="compression algo-req"></a><a href="#4.2-compression%20algo-req">compression algo-req</a></b> <span style="color: #080">&lt;algorithm&gt;</span></div><a class="anchor" name="compression"></a><a class="anchor" name="4-compression"></a><a class="anchor" name="4.2-compression"></a><a class="anchor" name="compression (Proxies)"></a><a class="anchor" name="compression (Alphabetically sorted keywords reference)"></a><a class="anchor" name="compression algo-res"></a><a class="anchor" name="4-compression algo-res"></a><a class="anchor" name="4.2-compression algo-res"></a><a class="anchor" name="compression algo-res (Proxies)"></a><a class="anchor" name="compression algo-res (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="compression algo-res"></a><a href="#4.2-compression%20algo-res">compression algo-res</a></b> <span style="color: #080">&lt;algorithm&gt;</span></div><a class="anchor" name="compression"></a><a class="anchor" name="4-compression"></a><a class="anchor" name="4.2-compression"></a><a class="anchor" name="compression (Proxies)"></a><a class="anchor" name="compression (Alphabetically sorted keywords reference)"></a><a class="anchor" name="compression type"></a><a class="anchor" name="4-compression type"></a><a class="anchor" name="4.2-compression type"></a><a class="anchor" name="compression type (Proxies)"></a><a class="anchor" name="compression type (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="compression type"></a><a href="#4.2-compression%20type">compression type</a></b> <span style="color: #080">&lt;mime type&gt;</span> ...</div><pre class="text">Enable HTTP compression.

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">algo     is followed by the list of supported compression algorithms for
         responses (legacy keyword)
algo-req is followed by compression algorithm for request (only one is
         provided).
algo-res is followed by the list of supported compression algorithms for
         responses.
type     is followed by the list of MIME types that will be compressed for
         responses (legacy keyword).
type-req is followed by the list of MIME types that will be compressed for
         requests.
type-res is followed by the list of MIME types that will be compressed for
         responses.</pre>
</div>
<pre class="text">The currently supported algorithms are :
  identity     this is mostly for debugging, and it was useful for developing
               the compression feature. Identity does not apply any change on
               data.

  gzip         applies gzip compression. This setting is only available when
               support for zlib or libslz was built in.

  deflate      same as &quot;gzip&quot;, but with deflate algorithm and zlib format.
               Note that this algorithm has ambiguous support on many
               browsers and no support at all from recent ones. It is
               strongly recommended not to use it for anything else than
               experimentation. This setting is only available when support
               for zlib or libslz was built in.

  raw-deflate  same as &quot;deflate&quot; without the zlib wrapper, and used as an
               alternative when the browser wants &quot;deflate&quot;. All major
               browsers understand it and despite violating the standards,
               it is known to work better than &quot;deflate&quot;, at least on MSIE
               and some versions of Safari. Do not use it in conjunction
               with &quot;deflate&quot;, use either one or the other since both react
               to the same Accept-Encoding token. This setting is only
               available when support for zlib or libslz was built in.

Compression will be activated depending on the Accept-Encoding request
header. With identity, it does not take care of that header.
If backend servers support HTTP compression, these directives
will be no-op: HAProxy will see the compressed response and will not
compress again. If backend servers do not support HTTP compression and
there is Accept-Encoding header in request, HAProxy will compress the
matching response.

Compression is disabled when:
  * the request does not advertise a supported compression algorithm in the
    &quot;Accept-Encoding&quot; header
  * the response message is not HTTP/1.1 or above
  * HTTP status code is not one of 200, 201, 202, or 203
  * response contain neither a &quot;Content-Length&quot; header nor a
    &quot;Transfer-Encoding&quot; whose last value is &quot;chunked&quot;
  * response contains a &quot;Content-Type&quot; header whose first value starts with
    &quot;multipart&quot;
  * the response contains the &quot;no-transform&quot; value in the &quot;Cache-control&quot;
    header
  * User-Agent matches &quot;Mozilla/4&quot; unless it is MSIE 6 with XP SP2, or MSIE 7
    and later
  * The response contains a &quot;Content-Encoding&quot; header, indicating that the
    response is already compressed (see compression offload)
  * The response contains an invalid &quot;ETag&quot; header or multiple ETag headers

Note: The compression does not emit the Warning header.
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code>compression algo gzip
compression type text/html text/plain
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#compression%20offload">compression offload</a>&quot;, &quot;<a href="#compression%20direction">compression direction</a>&quot;</div>
<a class="anchor" name="compression"></a><a class="anchor" name="4-compression"></a><a class="anchor" name="4.2-compression"></a><a class="anchor" name="compression (Proxies)"></a><a class="anchor" name="compression (Alphabetically sorted keywords reference)"></a><a class="anchor" name="compression offload"></a><a class="anchor" name="4-compression offload"></a><a class="anchor" name="4.2-compression offload"></a><a class="anchor" name="compression offload (Proxies)"></a><a class="anchor" name="compression offload (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="compression offload"></a><a href="#4.2-compression%20offload">compression offload</a></b></div><pre class="text">Makes HAProxy work as a compression offloader only.

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">The &quot;offload&quot; setting makes HAProxy remove the Accept-Encoding header to
prevent backend servers from compressing responses. It is strongly
recommended not to do this because this means that all the compression work
will be done on the single point where HAProxy is located. However in some
deployment scenarios, HAProxy may be installed in front of a buggy gateway
with broken HTTP compression implementation which can't be turned off.
In that case HAProxy can be used to prevent that gateway from emitting
invalid payloads. In this case, simply removing the header in the
configuration does not work because it applies before the header is parsed,
so that prevents HAProxy from compressing. The &quot;offload&quot; setting should
then be used for such scenarios.

If this setting is used in a defaults section, a warning is emitted and the
option is ignored.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#compression%20type">compression type</a>&quot;, &quot;<a href="#compression%20algo">compression algo</a>&quot;, &quot;<a href="#compression%20direction">compression direction</a>&quot;</div>
<a class="anchor" name="compression"></a><a class="anchor" name="4-compression"></a><a class="anchor" name="4.2-compression"></a><a class="anchor" name="compression (Proxies)"></a><a class="anchor" name="compression (Alphabetically sorted keywords reference)"></a><a class="anchor" name="compression direction"></a><a class="anchor" name="4-compression direction"></a><a class="anchor" name="4.2-compression direction"></a><a class="anchor" name="compression direction (Proxies)"></a><a class="anchor" name="compression direction (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="compression direction"></a><a href="#4.2-compression%20direction">compression direction</a></b> <span style="color: #080">&lt;direction&gt;</span></div><pre class="text">Makes haproxy able to compress both requests and responses.
Valid values are &quot;request&quot;, to compress only requests, &quot;response&quot;, to
compress only responses, or &quot;both&quot;, when you want to compress both.
The default value is &quot;response&quot;.

May be used in the following contexts: http
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#compression%20type">compression type</a>&quot;, &quot;<a href="#compression%20algo">compression algo</a>&quot;, &quot;<a href="#compression%20offload">compression offload</a>&quot;</div>
<a class="anchor" name="cookie"></a><a class="anchor" name="4-cookie"></a><a class="anchor" name="4.2-cookie"></a><a class="anchor" name="cookie (Proxies)"></a><a class="anchor" name="cookie (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="cookie"></a><a href="#4.2-cookie">cookie</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #008">[ rewrite | insert | prefix ]</span> <span style="color: #008">[ indirect ]</span> <span style="color: #008">[ nocache ]</span>
              <span style="color: #008">[ postonly ]</span> <span style="color: #008">[ preserve ]</span> <span style="color: #008">[ httponly ]</span> <span style="color: #008">[ secure ]</span>
              <span style="color: #008">[ domain <span style="color: #080">&lt;domain&gt;</span> ]</span>* <span style="color: #008">[ maxidle <span style="color: #080">&lt;idle&gt;</span> ]</span> <span style="color: #008">[ maxlife <span style="color: #080">&lt;life&gt;</span> ]</span>
              <span style="color: #008">[ dynamic ]</span> <span style="color: #008">[ attr <span style="color: #080">&lt;value&gt;</span> ]</span>*</div><pre class="text">Enable cookie-based persistence in a backend.

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;name&gt;    is the name of the cookie which will be monitored, modified or
          inserted in order to bring persistence. This cookie is sent to
          the client via a &quot;Set-Cookie&quot; header in the response, and is
          brought back by the client in a &quot;Cookie&quot; header in all requests.
          Special care should be taken to choose a name which does not
          conflict with any likely application cookie. Also, if the same
          backends are subject to be used by the same clients (e.g.
          HTTP/HTTPS), care should be taken to use different cookie names
          between all backends if persistence between them is not desired.

rewrite   This keyword indicates that the cookie will be provided by the
          server and that HAProxy will have to modify its value to set the
          server's identifier in it. This mode is handy when the management
          of complex combinations of &quot;Set-cookie&quot; and &quot;Cache-control&quot;
          headers is left to the application. The application can then
          decide whether or not it is appropriate to emit a persistence
          cookie. Since all responses should be monitored, this mode
          doesn't work in HTTP tunnel mode. Unless the application
          behavior is very complex and/or broken, it is advised not to
          start with this mode for new deployments. This keyword is
          incompatible with &quot;insert&quot; and &quot;prefix&quot;.

insert    This keyword indicates that the persistence cookie will have to
          be inserted by HAProxy in server responses if the client did not

          already have a cookie that would have permitted it to access this
          server. When used without the &quot;preserve&quot; option, if the server
          emits a cookie with the same name, it will be removed before
          processing. For this reason, this mode can be used to upgrade
          existing configurations running in the &quot;rewrite&quot; mode. The cookie
          will only be a session cookie and will not be stored on the
          client's disk. By default, unless the &quot;indirect&quot; option is added,
          the server will see the cookies emitted by the client. Due to
          caching effects, it is generally wise to add the &quot;nocache&quot; or
          &quot;postonly&quot; keywords (see below). The &quot;insert&quot; keyword is not
          compatible with &quot;rewrite&quot; and &quot;prefix&quot;.

prefix    This keyword indicates that instead of relying on a dedicated
          cookie for the persistence, an existing one will be completed.
          This may be needed in some specific environments where the client
          does not support more than one single cookie and the application
          already needs it. In this case, whenever the server sets a cookie
          named &lt;name&gt;, it will be prefixed with the server's identifier
          and a delimiter. The prefix will be removed from all client
          requests so that the server still finds the cookie it emitted.
          Since all requests and responses are subject to being modified,
          this mode doesn't work with tunnel mode. The &quot;prefix&quot; keyword is
          not compatible with &quot;rewrite&quot; and &quot;insert&quot;. Note: it is highly
          recommended not to use &quot;indirect&quot; with &quot;prefix&quot;, otherwise server
          cookie updates would not be sent to clients.

indirect  When this option is specified, no cookie will be emitted to a
          client which already has a valid one for the server which has
          processed the request. If the server sets such a cookie itself,
          it will be removed, unless the &quot;preserve&quot; option is also set. In
          &quot;insert&quot; mode, this will additionally remove cookies from the
          requests transmitted to the server, making the persistence
          mechanism totally transparent from an application point of view.
          Note: it is highly recommended not to use &quot;indirect&quot; with
          &quot;prefix&quot;, otherwise server cookie updates would not be sent to
          clients.

nocache   This option is recommended in conjunction with the insert mode
          when there is a cache between the client and HAProxy, as it
          ensures that a cacheable response will be tagged non-cacheable if
          a cookie needs to be inserted. This is important because if all
          persistence cookies are added on a cacheable home page for
          instance, then all customers will then fetch the page from an
          outer cache and will all share the same persistence cookie,
          leading to one server receiving much more traffic than others.
          See also the &quot;insert&quot; and &quot;postonly&quot; options.

postonly  This option ensures that cookie insertion will only be performed
          on responses to POST requests. It is an alternative to the
          &quot;nocache&quot; option, because POST responses are not cacheable, so
          this ensures that the persistence cookie will never get cached.
          Since most sites do not need any sort of persistence before the
          first POST which generally is a login request, this is a very
          efficient method to optimize caching without risking to find a
          persistence cookie in the cache.
          See also the &quot;insert&quot; and &quot;nocache&quot; options.

preserve  This option may only be used with &quot;insert&quot; and/or &quot;indirect&quot;. It
          allows the server to emit the persistence cookie itself. In this
          case, if a cookie is found in the response, HAProxy will leave it
          untouched. This is useful in order to end persistence after a
          logout request for instance. For this, the server just has to
          emit a cookie with an invalid value (e.g. empty) or with a date in
          the past. By combining this mechanism with the &quot;disable-on-404&quot;
          check option, it is possible to perform a completely graceful
          shutdown because users will definitely leave the server after
          they logout.

httponly  This option tells HAProxy to add an &quot;HttpOnly&quot; cookie attribute
          when a cookie is inserted. This attribute is used so that a
          user agent doesn't share the cookie with non-HTTP components.
          Please check RFC6265 for more information on this attribute.

secure    This option tells HAProxy to add a &quot;Secure&quot; cookie attribute when
          a cookie is inserted. This attribute is used so that a user agent
          never emits this cookie over non-secure channels, which means
          that a cookie learned with this flag will be presented only over
          SSL/TLS connections. Please check RFC6265 for more information on
          this attribute.

domain    This option allows to specify the domain at which a cookie is
          inserted. It requires exactly one parameter: a valid domain
          name. If the domain begins with a dot, the browser is allowed to
          use it for any host ending with that name. It is also possible to
          specify several domain names by invoking this option multiple
          times. Some browsers might have small limits on the number of
          domains, so be careful when doing that. For the record, sending
          10 domains to MSIE 6 or Firefox 2 works as expected.

maxidle   This option allows inserted cookies to be ignored after some idle
          time. It only works with insert-mode cookies. When a cookie is
          sent to the client, the date this cookie was emitted is sent too.
          Upon further presentations of this cookie, if the date is older
          than the delay indicated by the parameter (in seconds), it will
          be ignored. Otherwise, it will be refreshed if needed when the
          response is sent to the client. This is particularly useful to
          prevent users who never close their browsers from remaining for
          too long on the same server (e.g. after a farm size change). When
          this option is set and a cookie has no date, it is always
          accepted, but gets refreshed in the response. This maintains the
          ability for admins to access their sites. Cookies that have a
          date in the future further than 24 hours are ignored. Doing so
          lets admins fix timezone issues without risking kicking users off
          the site.

maxlife   This option allows inserted cookies to be ignored after some life
          time, whether they're in use or not. It only works with insert
          mode cookies. When a cookie is first sent to the client, the date
          this cookie was emitted is sent too. Upon further presentations
          of this cookie, if the date is older than the delay indicated by
          the parameter (in seconds), it will be ignored. If the cookie in
          the request has no date, it is accepted and a date will be set.
          Cookies that have a date in the future further than 24 hours are
          ignored. Doing so lets admins fix timezone issues without risking
          kicking users off the site. Contrary to maxidle, this value is
          not refreshed, only the first visit date counts. Both maxidle and
          maxlife may be used at the time. This is particularly useful to
          prevent users who never close their browsers from remaining for
          too long on the same server (e.g. after a farm size change). This
          is stronger than the maxidle method in that it forces a
          redispatch after some absolute delay.

dynamic   Activate dynamic cookies. When used, a session cookie is
          dynamically created for each server, based on the IP and port
          of the server, and a secret key, specified in the
          &quot;<a href="#dynamic-cookie-key">dynamic-cookie-key</a>&quot; backend directive.
          The cookie will be regenerated each time the IP address change,
          and is only generated for IPv4/IPv6.

attr      This option tells HAProxy to add an extra attribute when a
          cookie is inserted. The attribute value can contain any
          characters except control ones or &quot;;&quot;. This option may be
          repeated.</pre>
</div>
<pre class="text">There can be only one persistence cookie per HTTP backend, and it can be
declared in a defaults section. The value of the cookie will be the value
indicated after the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">cookie<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#cookie%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#cookie%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li><li><a href="#cookie%20%28Fetching%20HTTP%20samples%20%28Layer%207%29%29">Fetching HTTP samples (Layer 7)</a></li></ul></span>&quot; keyword in a &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; statement. If no cookie
is declared for a given server, the cookie is not set.
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code>cookie JSESSIONID prefix
cookie SRV insert indirect nocache
cookie SRV insert postonly indirect
cookie SRV insert indirect nocache maxidle 30m maxlife 8h
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;balance source&quot;, &quot;<a href="#capture%20cookie">capture cookie</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; and &quot;<a href="#ignore-persist">ignore-persist</a>&quot;.</div>
<a class="anchor" name="declare"></a><a class="anchor" name="4-declare"></a><a class="anchor" name="4.2-declare"></a><a class="anchor" name="declare (Proxies)"></a><a class="anchor" name="declare (Alphabetically sorted keywords reference)"></a><a class="anchor" name="declare capture"></a><a class="anchor" name="4-declare capture"></a><a class="anchor" name="4.2-declare capture"></a><a class="anchor" name="declare capture (Proxies)"></a><a class="anchor" name="declare capture (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="declare capture"></a><a href="#4.2-declare%20capture">declare capture</a></b> <span style="color: #008">[ request | response ]</span> len <span style="color: #080">&lt;length&gt;</span></div><pre class="text">Declares a capture slot.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments:</span><pre class="prettyprint arguments">&lt;length&gt; is the length allowed for the capture.</pre>
</div>
<pre class="text">This declaration is only available in the frontend or listen section, but the
reserved slot can be used in the backends. The &quot;request&quot; keyword allocates a
capture slot for use in the request, and &quot;response&quot; allocates a capture slot
for use in the response.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#capture-req">capture-req</a>&quot;, &quot;<a href="#capture-res">capture-res</a>&quot; (sample converters), &quot;<a href="#capture.req.hdr">capture.req.hdr</a>&quot;, &quot;<a href="#capture.res.hdr">capture.res.hdr</a>&quot; (sample fetches), &quot;http-request capture&quot; and &quot;http-response capture&quot;.</div>
<a class="anchor" name="default-server"></a><a class="anchor" name="4-default-server"></a><a class="anchor" name="4.2-default-server"></a><a class="anchor" name="default-server (Proxies)"></a><a class="anchor" name="default-server (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="default-server"></a><a href="#4.2-default-server">default-server</a></b> <span style="color: #008">[param*]</span></div><pre class="text">Change default options for a server in a backend

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments:</span><pre class="prettyprint arguments">&lt;param*&gt;  is a list of parameters for this server. The &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;
          keyword accepts an important number of options and has a complete
          section dedicated to it. Please refer to <a href="#5">section 5</a> for more
          details.</pre>
</div>
<div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>default-server inter 1000 weight 13
</code></pre>
</div><div class="page-header"><b>See also:</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; and <a href="#5">section 5</a> about server options</div>
<a class="anchor" name="default_backend"></a><a class="anchor" name="4-default_backend"></a><a class="anchor" name="4.2-default_backend"></a><a class="anchor" name="default_backend (Proxies)"></a><a class="anchor" name="default_backend (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="default_backend"></a><a href="#4.2-default_backend">default_backend</a></b> <span style="color: #080">&lt;backend&gt;</span></div><pre class="text">Specify the backend to use when no &quot;<a href="#use_backend">use_backend</a>&quot; rule has been matched.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;backend&gt; is the name of the backend to use.</pre>
</div>
<pre class="text">When doing content-switching between frontend and backends using the
&quot;<a href="#use_backend">use_backend</a>&quot; keyword, it is often useful to indicate which backend will be
used when no rule has matched. It generally is the dynamic backend which
will catch all undetermined requests.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>use_backend     dynamic  if  url_dyn
use_backend     static   if  url_css url_img extension_img
default_backend dynamic
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#use_backend">use_backend</a>&quot;</div>
<a class="anchor" name="description"></a><a class="anchor" name="4-description"></a><a class="anchor" name="4.2-description"></a><a class="anchor" name="description (Proxies)"></a><a class="anchor" name="description (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="description"></a><a href="#4.2-description">description</a></b> <span style="color: #080">&lt;string&gt;</span></div><pre class="text">Describe a listen, frontend or backend.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> string
</div>
<pre class="text">Allows to add a sentence to describe the related object in the HAProxy HTML
stats page. The description will be printed on the right of the object name
it describes.
No need to backslash spaces in the &lt;string&gt; arguments.
</pre><a class="anchor" name="disabled"></a><a class="anchor" name="4-disabled"></a><a class="anchor" name="4.2-disabled"></a><a class="anchor" name="disabled (Proxies)"></a><a class="anchor" name="disabled (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="disabled"></a><a href="#4.2-disabled">disabled</a></b></div><pre class="text">Disable a proxy, frontend or backend.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">The &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">disabled<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#disabled%20%28Peers%29">Peers</a></li><li><a href="#disabled%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#disabled%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword is used to disable an instance, mainly in order to
liberate a listening port or to temporarily disable a service. The instance
will still be created and its configuration will be checked, but it will be
created in the &quot;stopped&quot; state and will appear as such in the statistics. It
will not receive any traffic nor will it send any health-checks or logs. It
is possible to disable many instances at once by adding the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">disabled<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#disabled%20%28Peers%29">Peers</a></li><li><a href="#disabled%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#disabled%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
keyword in a &quot;defaults&quot; section.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">enabled<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#enabled%20%28Peers%29">Peers</a></li><li><a href="#enabled%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#enabled%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;</div>
<a class="anchor" name="dispatch"></a><a class="anchor" name="4-dispatch"></a><a class="anchor" name="4.2-dispatch"></a><a class="anchor" name="dispatch (Proxies)"></a><a class="anchor" name="dispatch (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="dispatch"></a><a href="#4.2-dispatch">dispatch</a></b> <span style="color: #080">&lt;address&gt;</span>:<span style="color: #080">&lt;port&gt;</span></div><pre class="text">Set a default server address

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;address&gt; is the IPv4 address of the default server. Alternatively, a
          resolvable hostname is supported, but this name will be resolved
          during start-up.

&lt;ports&gt;   is a mandatory port specification. All connections will be sent
          to this port, and it is not permitted to use port offsets as is
          possible with normal servers.</pre>
</div>
<pre class="text">The &quot;<a href="#dispatch">dispatch</a>&quot; keyword designates a default server for use when no other
server can take the connection. In the past it was used to forward non
persistent connections to an auxiliary load balancer. Due to its simple
syntax, it has also been used for simple TCP relays. It is recommended not to
use it for more clarity, and to use the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive instead.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;</div>
<a class="anchor" name="dynamic-cookie-key"></a><a class="anchor" name="4-dynamic-cookie-key"></a><a class="anchor" name="4.2-dynamic-cookie-key"></a><a class="anchor" name="dynamic-cookie-key (Proxies)"></a><a class="anchor" name="dynamic-cookie-key (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="dynamic-cookie-key"></a><a href="#4.2-dynamic-cookie-key">dynamic-cookie-key</a></b> <span style="color: #080">&lt;string&gt;</span></div><pre class="text">Set the dynamic cookie secret key for a backend.

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> The secret key to be used.
</div>
<pre class="text">When dynamic cookies are enabled (see the &quot;dynamic&quot; directive for cookie),
a dynamic cookie is created for each server (unless one is explicitly
specified on the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line), using a hash of the IP address of the
server, the TCP port, and the secret key.
That way, we can ensure session persistence across multiple load-balancers,
even if servers are dynamically added or removed.
</pre><a class="anchor" name="enabled"></a><a class="anchor" name="4-enabled"></a><a class="anchor" name="4.2-enabled"></a><a class="anchor" name="enabled (Proxies)"></a><a class="anchor" name="enabled (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="enabled"></a><a href="#4.2-enabled">enabled</a></b></div><pre class="text">Enable a proxy, frontend or backend.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">The &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">enabled<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#enabled%20%28Peers%29">Peers</a></li><li><a href="#enabled%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#enabled%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword is used to explicitly enable an instance, when the
defaults has been set to &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">disabled<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#disabled%20%28Peers%29">Peers</a></li><li><a href="#disabled%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#disabled%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;. This is very rarely used.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">disabled<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#disabled%20%28Peers%29">Peers</a></li><li><a href="#disabled%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#disabled%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;</div>
<a class="anchor" name="errorfile"></a><a class="anchor" name="4-errorfile"></a><a class="anchor" name="4.2-errorfile"></a><a class="anchor" name="errorfile (Proxies)"></a><a class="anchor" name="errorfile (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="errorfile"></a><a href="#4.2-errorfile">errorfile</a></b> <span style="color: #080">&lt;code&gt;</span> <span style="color: #080">&lt;file&gt;</span></div><pre class="text">Return a file contents instead of errors generated by HAProxy

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;code&gt;    is the HTTP status code. Currently, HAProxy is capable of
          generating codes 200, 400, 401, 403, 404, 405, 407, 408, 410,
          413, 414, 425, 429, 431, 500, 501, 502, 503, and 504.

&lt;file&gt;    designates a file containing the full HTTP response. It is
          recommended to follow the common practice of appending &quot;.http&quot; to
          the filename so that people do not confuse the response with HTML
          error pages, and to use absolute paths, since files are read
          before any chroot is performed.</pre>
</div>
<pre class="text">It is important to understand that this keyword is not meant to rewrite
errors returned by the server, but errors detected and returned by HAProxy.
This is why the list of supported errors is limited to a small set.

Code 200 is emitted in response to requests matching a &quot;<a href="#monitor-uri">monitor-uri</a>&quot; rule.

The files are parsed when HAProxy starts and must be valid according to the
HTTP specification. They should not exceed the configured buffer size
(BUFSIZE), which generally is 16 kB, otherwise an internal error will be
returned. It is also wise not to put any reference to local contents
(e.g. images) in order to avoid loops between the client and HAProxy when all
servers are down, causing an error to be returned instead of an
image. Finally, The response cannot exceed (tune.bufsize - tune.maxrewrite)
so that &quot;<a href="#http-after-response">http-after-response</a>&quot; rules still have room to operate (see
&quot;<a href="#tune.maxrewrite">tune.maxrewrite</a>&quot;).

The files are read at the same time as the configuration and kept in memory.
For this reason, the errors continue to be returned even when the process is
chrooted, and no file change is considered while the process is running. A
simple method for developing those files consists in associating them to the
403 status code and interrogating a blocked URL.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#http-error">http-error</a>&quot;, &quot;<a href="#errorloc">errorloc</a>&quot;, &quot;<a href="#errorloc302">errorloc302</a>&quot;, &quot;<a href="#errorloc303">errorloc303</a>&quot;</div>
<div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>errorfile 400 /etc/haproxy/errorfiles/400badreq.http
errorfile 408 /dev/null  <span class="comment"># work around Chrome pre-connect bug</span>
errorfile 403 /etc/haproxy/errorfiles/403forbid.http
errorfile 503 /etc/haproxy/errorfiles/503sorry.http
</code></pre>
</div><a class="anchor" name="errorfiles"></a><a class="anchor" name="4-errorfiles"></a><a class="anchor" name="4.2-errorfiles"></a><a class="anchor" name="errorfiles (Proxies)"></a><a class="anchor" name="errorfiles (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="errorfiles"></a><a href="#4.2-errorfiles">errorfiles</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #008">[<span style="color: #080">&lt;code&gt;</span> ...]</span></div><pre class="text">Import, fully or partially, the error files defined in the &lt;name&gt; http-errors
section.

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;name&gt;  is the name of an existing http-errors section.

&lt;code&gt;  is a HTTP status code. Several status code may be listed.
        Currently, HAProxy is capable of generating codes 200, 400, 401,
        403, 404, 405, 407, 408, 410, 413, 414, 425, 429, 431, 500, 501,
        502, 503, and 504.</pre>
</div>
<pre class="text">Errors defined in the http-errors section with the name &lt;name&gt; are imported
in the current proxy. If no status code is specified, all error files of the
http-errors section are imported. Otherwise, only error files associated to
the listed status code are imported. Those error files override the already
defined custom errors for the proxy. And they may be overridden by following
ones. Functionally, it is exactly the same as declaring all error files by
hand using &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">errorfile<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#errorfile%20%28HTTP-errors%29">HTTP-errors</a></li><li><a href="#errorfile%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directives.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#http-error">http-error</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">errorfile<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#errorfile%20%28HTTP-errors%29">HTTP-errors</a></li><li><a href="#errorfile%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#errorloc">errorloc</a>&quot;, &quot;<a href="#errorloc302">errorloc302</a>&quot; , &quot;<a href="#errorloc303">errorloc303</a>&quot; and <a href="#3.8">section 3.8</a> about http-errors.</div>
<div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>errorfiles generic
errorfiles site-1 403 404
</code></pre>
</div><a class="anchor" name="errorloc"></a><a class="anchor" name="4-errorloc"></a><a class="anchor" name="4.2-errorloc"></a><a class="anchor" name="errorloc (Proxies)"></a><a class="anchor" name="errorloc (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="errorloc"></a><a href="#4.2-errorloc">errorloc</a></b> <span style="color: #080">&lt;code&gt;</span> <span style="color: #080">&lt;url&gt;</span></div><a class="anchor" name="errorloc302"></a><a class="anchor" name="4-errorloc302"></a><a class="anchor" name="4.2-errorloc302"></a><a class="anchor" name="errorloc302 (Proxies)"></a><a class="anchor" name="errorloc302 (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="errorloc302"></a><a href="#4.2-errorloc302">errorloc302</a></b> <span style="color: #080">&lt;code&gt;</span> <span style="color: #080">&lt;url&gt;</span></div><pre class="text">Return an HTTP redirection to a URL instead of errors generated by HAProxy

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;code&gt;    is the HTTP status code. Currently, HAProxy is capable of
          generating codes 200, 400, 401, 403, 404, 405, 407, 408, 410,
          413, 414, 425, 429, 431, 500, 501, 502, 503, and 504.

&lt;url&gt;     it is the exact contents of the &quot;Location&quot; header. It may contain
          either a relative URI to an error page hosted on the same site,
          or an absolute URI designating an error page on another site.
          Special care should be given to relative URIs to avoid redirect
          loops if the URI itself may generate the same error (e.g. 500).</pre>
</div>
<pre class="text">It is important to understand that this keyword is not meant to rewrite
errors returned by the server, but errors detected and returned by HAProxy.
This is why the list of supported errors is limited to a small set.

Code 200 is emitted in response to requests matching a &quot;<a href="#monitor-uri">monitor-uri</a>&quot; rule.

Note that both keyword return the HTTP 302 status code, which tells the
client to fetch the designated URL using the same HTTP method. This can be
quite problematic in case of non-GET methods such as POST, because the URL
sent to the client might not be allowed for something other than GET. To
work around this problem, please use &quot;<a href="#errorloc303">errorloc303</a>&quot; which send the HTTP 303
status code, indicating to the client that the URL must be fetched with a GET
request.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#http-error">http-error</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">errorfile<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#errorfile%20%28HTTP-errors%29">HTTP-errors</a></li><li><a href="#errorfile%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#errorloc303">errorloc303</a>&quot;</div>
<a class="anchor" name="errorloc303"></a><a class="anchor" name="4-errorloc303"></a><a class="anchor" name="4.2-errorloc303"></a><a class="anchor" name="errorloc303 (Proxies)"></a><a class="anchor" name="errorloc303 (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="errorloc303"></a><a href="#4.2-errorloc303">errorloc303</a></b> <span style="color: #080">&lt;code&gt;</span> <span style="color: #080">&lt;url&gt;</span></div><pre class="text">Return an HTTP redirection to a URL instead of errors generated by HAProxy

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;code&gt;    is the HTTP status code. Currently, HAProxy is capable of
          generating codes 200, 400, 401, 403, 404, 405, 407, 408, 410,
          413, 414, 425, 429, 431, 500, 501, 502, 503, and 504.

&lt;url&gt;     it is the exact contents of the &quot;Location&quot; header. It may contain
          either a relative URI to an error page hosted on the same site,
          or an absolute URI designating an error page on another site.
          Special care should be given to relative URIs to avoid redirect
          loops if the URI itself may generate the same error (e.g. 500).</pre>
</div>
<pre class="text">It is important to understand that this keyword is not meant to rewrite
errors returned by the server, but errors detected and returned by HAProxy.
This is why the list of supported errors is limited to a small set.

Code 200 is emitted in response to requests matching a &quot;<a href="#monitor-uri">monitor-uri</a>&quot; rule.

Note that both keyword return the HTTP 303 status code, which tells the
client to fetch the designated URL using the same HTTP GET method. This
solves the usual problems associated with &quot;<a href="#errorloc">errorloc</a>&quot; and the 302 code. It is
possible that some very old browsers designed before HTTP/1.1 do not support
it, but no such problem has been reported till now.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#http-error">http-error</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">errorfile<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#errorfile%20%28HTTP-errors%29">HTTP-errors</a></li><li><a href="#errorfile%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#errorloc">errorloc</a>&quot;, &quot;<a href="#errorloc302">errorloc302</a>&quot;</div>
<a class="anchor" name="email-alert"></a><a class="anchor" name="4-email-alert"></a><a class="anchor" name="4.2-email-alert"></a><a class="anchor" name="email-alert (Proxies)"></a><a class="anchor" name="email-alert (Alphabetically sorted keywords reference)"></a><a class="anchor" name="email-alert from"></a><a class="anchor" name="4-email-alert from"></a><a class="anchor" name="4.2-email-alert from"></a><a class="anchor" name="email-alert from (Proxies)"></a><a class="anchor" name="email-alert from (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="email-alert from"></a><a href="#4.2-email-alert%20from">email-alert from</a></b> <span style="color: #080">&lt;emailaddr&gt;</span></div><pre class="text">Declare the from email address to be used in both the envelope and header
of email alerts. This is the address that email alerts are sent from.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;emailaddr&gt; is the from email address to use when sending email alerts</pre>
</div>
<pre class="text">Also requires &quot;<a href="#email-alert%20mailers">email-alert mailers</a>&quot; and &quot;<a href="#email-alert%20to">email-alert to</a>&quot; to be set
and if so sending email alerts is enabled for the proxy.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#email-alert%20level">email-alert level</a>&quot;, &quot;<a href="#email-alert%20mailers">email-alert mailers</a>&quot;, &quot;<a href="#email-alert%20myhostname">email-alert myhostname</a>&quot;, &quot;<a href="#email-alert%20to">email-alert to</a>&quot;, <a href="#3.6">section 3.6</a> about mailers.</div>
<a class="anchor" name="email-alert"></a><a class="anchor" name="4-email-alert"></a><a class="anchor" name="4.2-email-alert"></a><a class="anchor" name="email-alert (Proxies)"></a><a class="anchor" name="email-alert (Alphabetically sorted keywords reference)"></a><a class="anchor" name="email-alert level"></a><a class="anchor" name="4-email-alert level"></a><a class="anchor" name="4.2-email-alert level"></a><a class="anchor" name="email-alert level (Proxies)"></a><a class="anchor" name="email-alert level (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="email-alert level"></a><a href="#4.2-email-alert%20level">email-alert level</a></b> <span style="color: #080">&lt;level&gt;</span></div><pre class="text">Declare the maximum log level of messages for which email alerts will be
sent. This acts as a filter on the sending of email alerts.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;level&gt; One of the 8 syslog levels:
          emerg alert crit err warning notice info  debug
        The above syslog levels are ordered from lowest to highest.</pre>
</div>
<pre class="text">By default level is alert

Also requires &quot;<a href="#email-alert%20from">email-alert from</a>&quot;, &quot;<a href="#email-alert%20mailers">email-alert mailers</a>&quot; and
&quot;<a href="#email-alert%20to">email-alert to</a>&quot; to be set and if so sending email alerts is enabled
for the proxy.

Alerts are sent when :

* An un-paused server is marked as down and &lt;level&gt; is alert or lower
* A paused server is marked as down and &lt;level&gt; is notice or lower
* A server is marked as up or enters the drain state and &lt;level&gt;
  is notice or lower
* &quot;<a href="#option%20log-health-checks">option log-health-checks</a>&quot; is enabled, &lt;level&gt; is info or lower,
   and a health check status update occurs
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#email-alert%20from">email-alert from</a>&quot;, &quot;<a href="#email-alert%20mailers">email-alert mailers</a>&quot;, &quot;<a href="#email-alert%20myhostname">email-alert myhostname</a>&quot;, &quot;<a href="#email-alert%20to">email-alert to</a>&quot;, <a href="#3.6">section 3.6</a> about mailers.</div>
<a class="anchor" name="email-alert"></a><a class="anchor" name="4-email-alert"></a><a class="anchor" name="4.2-email-alert"></a><a class="anchor" name="email-alert (Proxies)"></a><a class="anchor" name="email-alert (Alphabetically sorted keywords reference)"></a><a class="anchor" name="email-alert mailers"></a><a class="anchor" name="4-email-alert mailers"></a><a class="anchor" name="4.2-email-alert mailers"></a><a class="anchor" name="email-alert mailers (Proxies)"></a><a class="anchor" name="email-alert mailers (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="email-alert mailers"></a><a href="#4.2-email-alert%20mailers">email-alert mailers</a></b> <span style="color: #080">&lt;mailersect&gt;</span></div><pre class="text">Declare the mailers to be used when sending email alerts

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;mailersect&gt; is the name of the mailers section to send email alerts.</pre>
</div>
<pre class="text">Also requires &quot;<a href="#email-alert%20from">email-alert from</a>&quot; and &quot;<a href="#email-alert%20to">email-alert to</a>&quot; to be set
and if so sending email alerts is enabled for the proxy.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#email-alert%20from">email-alert from</a>&quot;, &quot;<a href="#email-alert%20level">email-alert level</a>&quot;, &quot;<a href="#email-alert%20myhostname">email-alert myhostname</a>&quot;, &quot;<a href="#email-alert%20to">email-alert to</a>&quot;, <a href="#3.6">section 3.6</a> about mailers.</div>
<a class="anchor" name="email-alert"></a><a class="anchor" name="4-email-alert"></a><a class="anchor" name="4.2-email-alert"></a><a class="anchor" name="email-alert (Proxies)"></a><a class="anchor" name="email-alert (Alphabetically sorted keywords reference)"></a><a class="anchor" name="email-alert myhostname"></a><a class="anchor" name="4-email-alert myhostname"></a><a class="anchor" name="4.2-email-alert myhostname"></a><a class="anchor" name="email-alert myhostname (Proxies)"></a><a class="anchor" name="email-alert myhostname (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="email-alert myhostname"></a><a href="#4.2-email-alert%20myhostname">email-alert myhostname</a></b> <span style="color: #080">&lt;hostname&gt;</span></div><pre class="text">Declare the to hostname address to be used when communicating with
mailers.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;hostname&gt; is the hostname to use when communicating with mailers</pre>
</div>
<pre class="text">By default the systems hostname is used.

Also requires &quot;<a href="#email-alert%20from">email-alert from</a>&quot;, &quot;<a href="#email-alert%20mailers">email-alert mailers</a>&quot; and
&quot;<a href="#email-alert%20to">email-alert to</a>&quot; to be set and if so sending email alerts is enabled
for the proxy.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#email-alert%20from">email-alert from</a>&quot;, &quot;<a href="#email-alert%20level">email-alert level</a>&quot;, &quot;<a href="#email-alert%20mailers">email-alert mailers</a>&quot;, &quot;<a href="#email-alert%20to">email-alert to</a>&quot;, <a href="#3.6">section 3.6</a> about mailers.</div>
<a class="anchor" name="email-alert"></a><a class="anchor" name="4-email-alert"></a><a class="anchor" name="4.2-email-alert"></a><a class="anchor" name="email-alert (Proxies)"></a><a class="anchor" name="email-alert (Alphabetically sorted keywords reference)"></a><a class="anchor" name="email-alert to"></a><a class="anchor" name="4-email-alert to"></a><a class="anchor" name="4.2-email-alert to"></a><a class="anchor" name="email-alert to (Proxies)"></a><a class="anchor" name="email-alert to (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="email-alert to"></a><a href="#4.2-email-alert%20to">email-alert to</a></b> <span style="color: #080">&lt;emailaddr&gt;</span></div><pre class="text">Declare both the recipient address in the envelope and to address in the
header of email alerts. This is the address that email alerts are sent to.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;emailaddr&gt; is the to email address to use when sending email alerts</pre>
</div>
<pre class="text">Also requires &quot;<a href="#email-alert%20mailers">email-alert mailers</a>&quot; and &quot;<a href="#email-alert%20to">email-alert to</a>&quot; to be set
and if so sending email alerts is enabled for the proxy.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#email-alert%20from">email-alert from</a>&quot;, &quot;<a href="#email-alert%20level">email-alert level</a>&quot;, &quot;<a href="#email-alert%20mailers">email-alert mailers</a>&quot;, &quot;<a href="#email-alert%20myhostname">email-alert myhostname</a>&quot;, <a href="#3.6">section 3.6</a> about mailers.</div>
<a class="anchor" name="error-log-format"></a><a class="anchor" name="4-error-log-format"></a><a class="anchor" name="4.2-error-log-format"></a><a class="anchor" name="error-log-format (Proxies)"></a><a class="anchor" name="error-log-format (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="error-log-format"></a><a href="#4.2-error-log-format">error-log-format</a></b> <span style="color: #080">&lt;fmt&gt;</span></div><pre class="text">Specifies the log format string to use in case of connection error on the frontend side.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<pre class="text">This directive specifies the log format string that will be used for logs
containing information related to errors, timeouts, retries redispatches or
HTTP status code 5xx. This format will in short be used for every log line
that would be concerned by the &quot;<a href="#option%20log-separate-errors">log-separate-errors</a>&quot; option, including
connection errors described in <a href="#8.2.5">section 8.2.5</a>.

If the directive is used in a defaults section, all subsequent frontends will
use the same log format. Please see <a href="#8.2.6">section 8.2.6</a> which covers the custom log
format string in depth.

&quot;<a href="#error-log-format">error-log-format</a>&quot; directive overrides previous &quot;<a href="#error-log-format">error-log-format</a>&quot;
directives.
</pre><a class="anchor" name="force-persist"></a><a class="anchor" name="4-force-persist"></a><a class="anchor" name="4.2-force-persist"></a><a class="anchor" name="force-persist (Proxies)"></a><a class="anchor" name="force-persist (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="force-persist"></a><a href="#4.2-force-persist">force-persist</a></b> <span style="color: #800">{ if | unless }</span> <span style="color: #080">&lt;condition&gt;</span></div><pre class="text">Declare a condition to force persistence on down servers

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">By default, requests are not dispatched to down servers. It is possible to
force this using &quot;<a href="#option%20persist">option persist</a>&quot;, but it is unconditional and redispatches
to a valid server if &quot;<a href="#option%20redispatch">option redispatch</a>&quot; is set. That leaves with very little
possibilities to force some requests to reach a server which is artificially
marked down for maintenance operations.

The &quot;<a href="#force-persist">force-persist</a>&quot; statement allows one to declare various ACL-based
conditions which, when met, will cause a request to ignore the down status of
a server and still try to connect to it. That makes it possible to start a
server, still replying an error to the health checks, and run a specially
configured browser to test the service. Among the handy methods, one could
use a specific source IP address, or a specific cookie. The cookie also has
the advantage that it can easily be added/removed on the browser from a test
page. Once the service is validated, it is then possible to open the service
to the world by returning a valid response to health checks.

The forced persistence is enabled when an &quot;if&quot; condition is met, or unless an
&quot;unless&quot; condition is met. The final redispatch is always disabled when this
is used.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20redispatch">option redispatch</a>&quot;, &quot;<a href="#ignore-persist">ignore-persist</a>&quot;, &quot;<a href="#option%20persist">persist</a>&quot;, and <a href="#7">section 7</a> about ACL usage.</div>
<a class="anchor" name="filter"></a><a class="anchor" name="4-filter"></a><a class="anchor" name="4.2-filter"></a><a class="anchor" name="filter (Proxies)"></a><a class="anchor" name="filter (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="filter"></a><a href="#4.2-filter">filter</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #008">[param*]</span></div><pre class="text">Add the filter &lt;name&gt; in the filter list attached to the proxy.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;name&gt;     is the name of the filter. Officially supported filters are
           referenced in <a href="#9">section 9</a>.

&lt;param*&gt;   is a list of parameters accepted by the filter &lt;name&gt;. The
           parsing of these parameters are the responsibility of the
           filter. Please refer to the documentation of the corresponding
           filter (<a href="#9">section 9</a>) for all details on the supported parameters.</pre>
</div>
<pre class="text">Multiple occurrences of the filter line can be used for the same proxy. The
same filter can be referenced many times if needed.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>listen
  bind *:80

  filter trace name BEFORE-HTTP-COMP
  filter compression
  filter trace name AFTER-HTTP-COMP

  compression algo gzip
  compression offload

  server srv1 192.168.0.1:80
</code></pre>
</div><div class="page-header"><b>See also :</b> <a href="#9">section 9</a>.</div>
<a class="anchor" name="fullconn"></a><a class="anchor" name="4-fullconn"></a><a class="anchor" name="4.2-fullconn"></a><a class="anchor" name="fullconn (Proxies)"></a><a class="anchor" name="fullconn (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="fullconn"></a><a href="#4.2-fullconn">fullconn</a></b> <span style="color: #080">&lt;conns&gt;</span></div><pre class="text">Specify at what backend load the servers will reach their maxconn

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;conns&gt;   is the number of connections on the backend which will make the
          servers use the maximal number of connections.</pre>
</div>
<pre class="text">When a server has a &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; parameter specified, it means that its number
of concurrent connections will never go higher. Additionally, if it has a
&quot;<a href="#minconn">minconn</a>&quot; parameter, it indicates a dynamic limit following the backend's
load. The server will then always accept at least &lt;minconn&gt; connections,
never more than &lt;maxconn&gt;, and the limit will be on the ramp between both
values when the backend has less than &lt;conns&gt; concurrent connections. This
makes it possible to limit the load on the servers during normal loads, but
push it further for important loads without overloading the servers during
exceptional loads.

Since it's hard to get this value right, HAProxy automatically sets it to
10% of the sum of the maxconns of all frontends that may branch to this
backend (based on &quot;<a href="#use_backend">use_backend</a>&quot; and &quot;<a href="#default_backend">default_backend</a>&quot; rules). That way it's
safe to leave it unset. However, &quot;<a href="#use_backend">use_backend</a>&quot; involving dynamic names are
not counted since there is no way to know if they could match or not.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># The servers will accept between 100 and 1000 concurrent connections each</span>
<span class="comment"># and the maximum of 1000 will be reached when the backend reaches 10000</span>
<span class="comment"># connections.</span>
backend dynamic
   fullconn   10000
   server     srv1   dyn1:80 minconn 100 maxconn 1000
   server     srv2   dyn2:80 minconn 100 maxconn 1000
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;</div>
<a class="anchor" name="guid"></a><a class="anchor" name="4-guid"></a><a class="anchor" name="4.2-guid"></a><a class="anchor" name="guid (Proxies)"></a><a class="anchor" name="guid (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="guid"></a><a href="#4.2-guid">guid</a></b> <span style="color: #080">&lt;string&gt;</span></div><pre class="text">Specify a case-sensitive global unique ID for this proxy.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">&lt;string&gt; must be unique across all haproxy configuration on every object
types. Format is left unspecified to allow the user to select its naming
policy. The only restriction is its length which cannot be greater than
127 characters. All alphanumerical values and '.', ':', '-' and '_'
characters are valid.
</pre><a class="anchor" name="hash-balance-factor"></a><a class="anchor" name="4-hash-balance-factor"></a><a class="anchor" name="4.2-hash-balance-factor"></a><a class="anchor" name="hash-balance-factor (Proxies)"></a><a class="anchor" name="hash-balance-factor (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="hash-balance-factor"></a><a href="#4.2-hash-balance-factor">hash-balance-factor</a></b> <span style="color: #080">&lt;factor&gt;</span></div><pre class="text">Specify the balancing factor for bounded-load consistent hashing

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;factor&gt; is the control for the maximum number of concurrent requests to
         send to a server, expressed as a percentage of the average number
         of concurrent requests across all of the active servers.</pre>
</div>
<pre class="text">Specifying a &quot;<a href="#hash-balance-factor">hash-balance-factor</a>&quot; for a server with &quot;hash-type consistent&quot;
enables an algorithm that prevents any one server from getting too many
requests at once, even if some hash buckets receive many more requests than
others. Setting &lt;factor&gt; to 0 (the default) disables the feature. Otherwise,
&lt;factor&gt; is a percentage greater than 100. For example, if &lt;factor&gt; is 150,
then no server will be allowed to have a load more than 1.5 times the average.
If server weights are used, they will be respected.

If the first-choice server is disqualified, the algorithm will choose another
server based on the request hash, until a server with additional capacity is
found. A higher &lt;factor&gt; allows more imbalance between the servers, while a
lower &lt;factor&gt; means that more servers will be checked on average, affecting
performance. Reasonable values are from 125 to 200.

This setting is also used by &quot;balance random&quot; which internally relies on the
consistent hashing mechanism.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#balance">balance</a>&quot; and &quot;<a href="#hash-type">hash-type</a>&quot;.</div>
<a class="anchor" name="hash-type"></a><a class="anchor" name="4-hash-type"></a><a class="anchor" name="4.2-hash-type"></a><a class="anchor" name="hash-type (Proxies)"></a><a class="anchor" name="hash-type (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="hash-type"></a><a href="#4.2-hash-type">hash-type</a></b> <span style="color: #080">&lt;method&gt;</span> <span style="color: #080">&lt;function&gt;</span> <span style="color: #080">&lt;modifier&gt;</span></div><pre class="text">Specify a method to use for mapping hashes to servers

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;method&gt; is the method used to select a server from the hash computed by
         the &lt;function&gt; :

  map-based   the hash table is a static array containing all alive servers.
              The hashes will be very smooth, will consider weights, but
              will be static in that weight changes while a server is up
              will be ignored. This means that there will be no slow start.
              Also, since a server is selected by its position in the array,
              most mappings are changed when the server count changes. This
              means that when a server goes up or down, or when a server is
              added to a farm, most connections will be redistributed to
              different servers. This can be inconvenient with caches for
              instance.

  consistent  the hash table is a tree filled with many occurrences of each
              server. The hash key is looked up in the tree and the closest
              server is chosen. This hash is dynamic, it supports changing
              weights while the servers are up, so it is compatible with the
              slow start feature. It has the advantage that when a server
              goes up or down, only its associations are moved. When a
              server is added to the farm, only a few part of the mappings
              are redistributed, making it an ideal method for caches.
              However, due to its principle, the distribution will never be
              very smooth and it may sometimes be necessary to adjust a
              server's weight or its ID to get a more balanced distribution.
              In order to get the same distribution on multiple load
              balancers, it is important that all servers have the exact
              same IDs. Note: consistent hash uses sdbm and avalanche if no
              hash function is specified.

&lt;function&gt; is the hash function to be used :

   sdbm   this function was created initially for sdbm (a public-domain
          reimplementation of ndbm) database library. It was found to do
          well in scrambling bits, causing better distribution of the keys
          and fewer splits. It also happens to be a good general hashing
          function with good distribution, unless the total server weight
          is a multiple of 64, in which case applying the avalanche
          modifier may help.

   djb2   this function was first proposed by Dan Bernstein many years ago
          on comp.lang.c. Studies have shown that for certain workload this
          function provides a better distribution than sdbm. It generally
          works well with text-based inputs though it can perform extremely
          poorly with numeric-only input or when the total server weight is
          a multiple of 33, unless the avalanche modifier is also used.

   wt6    this function was designed for HAProxy while testing other
          functions in the past. It is not as smooth as the other ones, but
          is much less sensible to the input data set or to the number of
          servers. It can make sense as an alternative to sdbm+avalanche or
          djb2+avalanche for consistent hashing or when hashing on numeric
          data such as a source IP address or a visitor identifier in a URL
          parameter.

   crc32  this is the most common CRC32 implementation as used in Ethernet,
          gzip, PNG, etc. It is slower than the other ones but may provide
          a better distribution or less predictable results especially when
          used on strings.

   none   don't hash the key, the key will be used as a hash, this can be
          useful to manually hash the key using a converter for that purpose
          and let haproxy use the result directly.

&lt;modifier&gt; indicates an optional method applied after hashing the key :

   avalanche   This directive indicates that the result from the hash
               function above should not be used in its raw form but that
               a 4-byte full avalanche hash must be applied first. The
               purpose of this step is to mix the resulting bits from the
               previous hash in order to avoid any undesired effect when
               the input contains some limited values or when the number of
               servers is a multiple of one of the hash's components (64
               for SDBM, 33 for DJB2). Enabling avalanche tends to make the
               result less predictable, but it's also not as smooth as when
               using the original function. Some testing might be needed
               with some workloads. This hash is one of the many proposed
               by Bob Jenkins.</pre>
</div>
<pre class="text">The default hash type is &quot;map-based&quot; and is recommended for most usages. The
default function is &quot;<a href="#sdbm">sdbm</a>&quot;, the selection of a function should be based on
the range of the values being hashed.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#balance">balance</a>&quot;, &quot;<a href="#hash-balance-factor">hash-balance-factor</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;</div>
<a class="anchor" name="http-after-response"></a><a class="anchor" name="4-http-after-response"></a><a class="anchor" name="4.2-http-after-response"></a><a class="anchor" name="http-after-response (Proxies)"></a><a class="anchor" name="http-after-response (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="http-after-response"></a><a href="#4.2-http-after-response">http-after-response</a></b> <span style="color: #080">&lt;action&gt;</span> <span style="color: #080">&lt;options...&gt;</span> <span style="color: #008">[ <span style="color: #800">{ if | unless }</span> <span style="color: #080">&lt;condition&gt;</span> ]</span></div><pre class="text">Access control for all Layer 7 responses (server, applet/service and internal
ones).

May be used in the following contexts: http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-info pagination-centered">yes(!)<br /><img src="../css/checkmark.png" alt="yes(!)" title="yes(!)" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">The http-after-response statement defines a set of rules which apply to layer
7 processing. The rules are evaluated in their declaration order when they
are met in a frontend, listen or backend section. Since these rules apply on
responses, the backend rules are applied first, followed by the frontend's
rules. Any rule may optionally be followed by an ACL-based condition, in
which case it will only be evaluated if the condition evaluates true.

Unlike http-response rules, these ones are applied on all responses, the
server ones but also to all responses generated by HAProxy. These rules are
evaluated at the end of the responses analysis, before the data forwarding
phase.

The condition is evaluated just before the action is executed, and the action
is performed exactly once. As such, there is no problem if an action changes
an element which is checked as part of the condition. This also means that
multiple actions may rely on the same condition so that the first action that
changes the condition's evaluation is sufficient to implicitly disable the
remaining actions. This is used for example when trying to assign a value to
a variable from various sources when it's empty. There is no limit to the
number of &quot;<a href="#http-after-response">http-after-response</a>&quot; statements per instance.

The first keyword after &quot;<a href="#http-after-response">http-after-response</a>&quot; in the syntax is the rule's
action, optionally followed by a varying number of arguments for the action.
The supported actions and their respective syntaxes are enumerated in section
4.3 &quot;Actions&quot; (look for actions which tick &quot;HTTP Aft&quot;).

This directive is only available from named defaults sections, not anonymous
ones. Rules defined in the defaults section are evaluated before ones in the
associated proxy section. To avoid ambiguities, in this case the same
defaults section cannot be used by proxies with the frontend capability and
by proxies with the backend capability. It means a listen section cannot use
a defaults section defining such rules.

Note: Errors emitted in early stage of the request parsing are handled by the
      multiplexer at a lower level, before any http analysis. Thus no
      http-after-response ruleset is evaluated on these errors.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-after-response set-header Strict-Transport-Security &quot;max-age=31536000&quot;
http-after-response set-header Cache-Control &quot;no-store,no-cache,private&quot;
http-after-response set-header Pragma &quot;no-cache&quot;
</code></pre>
</div><a class="anchor" name="http-check"></a><a class="anchor" name="4-http-check"></a><a class="anchor" name="4.2-http-check"></a><a class="anchor" name="http-check (Proxies)"></a><a class="anchor" name="http-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="http-check comment"></a><a class="anchor" name="4-http-check comment"></a><a class="anchor" name="4.2-http-check comment"></a><a class="anchor" name="http-check comment (Proxies)"></a><a class="anchor" name="http-check comment (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="http-check comment"></a><a href="#4.2-http-check%20comment">http-check comment</a></b> <span style="color: #080">&lt;string&gt;</span></div><pre class="text">Defines a comment for the following the http-check rule, reported in logs if
it fails.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;string&gt;  is the comment message to add in logs if the following http-check
          rule fails.</pre>
</div>
<pre class="text">It only works for connect, send and expect rules. It is useful to make
user-friendly error reporting.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httpchk">option httpchk</a>&quot;, &quot;<a href="#http-check%20connect">http-check connect</a>&quot;, &quot;<a href="#http-check%20send">http-check send</a>&quot; and &quot;<a href="#http-check%20expect">http-check expect</a>&quot;.</div>
<a class="anchor" name="http-check"></a><a class="anchor" name="4-http-check"></a><a class="anchor" name="4.2-http-check"></a><a class="anchor" name="http-check (Proxies)"></a><a class="anchor" name="http-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="http-check connect"></a><a class="anchor" name="4-http-check connect"></a><a class="anchor" name="4.2-http-check connect"></a><a class="anchor" name="http-check connect (Proxies)"></a><a class="anchor" name="http-check connect (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="http-check connect"></a><a href="#4.2-http-check%20connect">http-check connect</a></b> <span style="color: #008">[default]</span> <span style="color: #008">[port <span style="color: #080">&lt;expr&gt;</span>]</span> <span style="color: #008">[addr <span style="color: #080">&lt;ip&gt;</span>]</span> <span style="color: #008">[send-proxy]</span>
                   <span style="color: #008">[via-socks4]</span> <span style="color: #008">[ssl]</span> <span style="color: #008">[sni <span style="color: #080">&lt;sni&gt;</span>]</span> <span style="color: #008">[alpn <span style="color: #080">&lt;alpn&gt;</span>]</span> <span style="color: #008">[linger]</span>
                   <span style="color: #008">[proto <span style="color: #080">&lt;name&gt;</span>]</span> <span style="color: #008">[comment <span style="color: #080">&lt;msg&gt;</span>]</span></div><pre class="text">Opens a new connection to perform an HTTP health check

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">comment &lt;msg&gt;  defines a message to report if the rule evaluation fails.

default      Use default options of the server line to do the health
             checks. The server options are used only if not redefined.

port &lt;expr&gt;  if not set, check port or server port is used.
             It tells HAProxy where to open the connection to.
             &lt;port&gt; must be a valid TCP port source integer, from 1 to
             65535 or an sample-fetch expression.

addr &lt;ip&gt;    defines the IP address to do the health check.

send-proxy   send a PROXY protocol string

via-socks4   enables outgoing health checks using upstream socks4 proxy.

ssl          opens a ciphered connection

sni &lt;sni&gt;    specifies the SNI to use to do health checks over SSL.

alpn &lt;alpn&gt;  defines which protocols to advertise with ALPN. The protocol
             list consists in a comma-delimited list of protocol names,
             for instance: &quot;h2,http/1.1&quot;. If it is not set, the server ALPN
             is used.

proto &lt;name&gt; forces the multiplexer's protocol to use for this connection.
             It must be an HTTP mux protocol and it must be usable on the
             backend side. The list of available protocols is reported in
             haproxy -vv.

linger       cleanly close the connection instead of using a single RST.</pre>
</div>
<pre class="text">Just like tcp-check health checks, it is possible to configure the connection
to use to perform HTTP health check. This directive should also be used to
describe a scenario involving several request/response exchanges, possibly on
different ports or with different servers.

When there are no TCP port configured on the server line neither server port
directive, then the first step of the http-check sequence must be to specify
the port with a &quot;<a href="#http-check%20connect">http-check connect</a>&quot;.

In an http-check ruleset a 'connect' is required, it is also mandatory to start
the ruleset with a 'connect' rule. Purpose is to ensure admin know what they
do.

When a connect must start the ruleset, if may still be preceded by set-var,
unset-var or comment rules.
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code><span class="comment"># check HTTP and HTTPs services on a server.</span>
<span class="comment"># first open port 80 thanks to server line port directive, then</span>
<span class="comment"># tcp-check opens port 443, ciphered and run a request on it:</span>
option httpchk

http-check connect
http-check send meth GET uri / ver HTTP/1.1 hdr host haproxy.1wt.eu
http-check expect status 200-399
http-check connect port 443 ssl sni haproxy.1wt.eu
http-check send meth GET uri / ver HTTP/1.1 hdr host haproxy.1wt.eu
http-check expect status 200-399

server www 10.0.0.1 check port 80
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httpchk">option httpchk</a>&quot;, &quot;<a href="#http-check%20send">http-check send</a>&quot;, &quot;<a href="#http-check%20expect">http-check expect</a>&quot;</div>
<a class="anchor" name="http-check"></a><a class="anchor" name="4-http-check"></a><a class="anchor" name="4.2-http-check"></a><a class="anchor" name="http-check (Proxies)"></a><a class="anchor" name="http-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="http-check disable-on-404"></a><a class="anchor" name="4-http-check disable-on-404"></a><a class="anchor" name="4.2-http-check disable-on-404"></a><a class="anchor" name="http-check disable-on-404 (Proxies)"></a><a class="anchor" name="http-check disable-on-404 (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="http-check disable-on-404"></a><a href="#4.2-http-check%20disable-on-404">http-check disable-on-404</a></b></div><pre class="text">Enable a maintenance mode upon HTTP/404 response to health-checks

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">When this option is set, a server which returns an HTTP code 404 will be
excluded from further load-balancing, but will still receive persistent
connections. This provides a very convenient method for Web administrators
to perform a graceful shutdown of their servers. It is also important to note
that a server which is detected as failed while it was in this mode will not
generate an alert, just a notice. If the server responds 2xx or 3xx again, it
will immediately be reinserted into the farm. The status on the stats page
reports &quot;NOLB&quot; for a server in this mode. It is important to note that this
option only works in conjunction with the &quot;<a href="#option%20httpchk">httpchk</a>&quot; option. If this option
is used with &quot;<a href="#http-check%20expect">http-check expect</a>&quot;, then it has precedence over it so that 404
responses will still be considered as soft-stop. Note also that a stopped
server will stay stopped even if it replies 404s. This option is only
evaluated for running servers.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httpchk">option httpchk</a>&quot; and &quot;<a href="#http-check%20expect">http-check expect</a>&quot;.</div>
<a class="anchor" name="http-check"></a><a class="anchor" name="4-http-check"></a><a class="anchor" name="4.2-http-check"></a><a class="anchor" name="http-check (Proxies)"></a><a class="anchor" name="http-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="http-check expect"></a><a class="anchor" name="4-http-check expect"></a><a class="anchor" name="4.2-http-check expect"></a><a class="anchor" name="http-check expect (Proxies)"></a><a class="anchor" name="http-check expect (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="http-check expect"></a><a href="#4.2-http-check%20expect">http-check expect</a></b> <span style="color: #008">[min-recv <span style="color: #080">&lt;int&gt;</span>]</span> <span style="color: #008">[comment <span style="color: #080">&lt;msg&gt;</span>]</span>
                  <span style="color: #008">[ok-status <span style="color: #080">&lt;st&gt;</span>]</span> <span style="color: #008">[error-status <span style="color: #080">&lt;st&gt;</span>]</span> <span style="color: #008">[tout-status <span style="color: #080">&lt;st&gt;</span>]</span>
                  <span style="color: #008">[on-success <span style="color: #080">&lt;fmt&gt;</span>]</span> <span style="color: #008">[on-error <span style="color: #080">&lt;fmt&gt;</span>]</span> <span style="color: #008">[status-code <span style="color: #080">&lt;expr&gt;</span>]</span>
                  <span style="color: #008">[!]</span> <span style="color: #080">&lt;match&gt;</span> <span style="color: #080">&lt;pattern&gt;</span></div><pre class="text">Make HTTP health checks consider response contents or specific status codes

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">comment &lt;msg&gt;  defines a message to report if the rule evaluation fails.

min-recv  is optional and can define the minimum amount of data required to
          evaluate the current expect rule. If the number of received bytes
          is under this limit, the check will wait for more data. This
          option can be used to resolve some ambiguous matching rules or to
          avoid executing costly regex matches on content known to be still
          incomplete. If an exact string is used, the minimum between the
          string length and this parameter is used. This parameter is
          ignored if it is set to -1. If the expect rule does not match,
          the check will wait for more data. If set to 0, the evaluation
          result is always conclusive.

ok-status &lt;st&gt;     is optional and can be used to set the check status if
                   the expect rule is successfully evaluated and if it is
                   the last rule in the tcp-check ruleset. &quot;L7OK&quot;, &quot;L7OKC&quot;,
                   &quot;L6OK&quot; and &quot;L4OK&quot; are supported :
                     - L7OK  : check passed on layer 7
                     - L7OKC : check conditionally passed on layer 7, set
                               server to NOLB state.
                     - L6OK  : check passed on layer 6
                     - L4OK  : check passed on layer 4
                   By default &quot;L7OK&quot; is used.

error-status &lt;st&gt;  is optional and can be used to set the check status if
                   an error occurred during the expect rule evaluation.
                   &quot;L7OKC&quot;, &quot;L7RSP&quot;, &quot;L7STS&quot;, &quot;L6RSP&quot; and &quot;L4CON&quot; are
                   supported :
                     - L7OKC : check conditionally passed on layer 7, set
                               server to NOLB state.
                     - L7RSP : layer 7 invalid response - protocol error
                     - L7STS : layer 7 response error, for example HTTP 5xx
                     - L6RSP : layer 6 invalid response - protocol error
                     - L4CON : layer 1-4 connection problem
                   By default &quot;L7RSP&quot; is used.

tout-status &lt;st&gt;   is optional and can be used to set the check status if
                   a timeout occurred during the expect rule evaluation.
                   &quot;L7TOUT&quot;, &quot;L6TOUT&quot;, and &quot;L4TOUT&quot; are supported :
                     - L7TOUT : layer 7 (HTTP/SMTP) timeout
                     - L6TOUT : layer 6 (SSL) timeout
                     - L4TOUT : layer 1-4 timeout
                   By default &quot;L7TOUT&quot; is used.

on-success &lt;fmt&gt;   is optional and can be used to customize the
                   informational message reported in logs if the expect
                   rule is successfully evaluated and if it is the last rule
                   in the tcp-check ruleset. &lt;fmt&gt; is a Custom log format
                   string (see <a href="#8.2.6">section 8.2.6</a>).

on-error &lt;fmt&gt;     is optional and can be used to customize the
                   informational message reported in logs if an error
                   occurred during the expect rule evaluation. &lt;fmt&gt; is a
                   Custom log format string (see <a href="#8.2.6">section 8.2.6</a>).

&lt;match&gt;   is a keyword indicating how to look for a specific pattern in the
          response. The keyword may be one of &quot;<a href="#status">status</a>&quot;, &quot;rstatus&quot;, &quot;<a href="#hdr">hdr</a>&quot;,
          &quot;fhdr&quot;, &quot;string&quot;, or &quot;rstring&quot;. The keyword may be preceded by an
          exclamation mark (&quot;!&quot;) to negate the match. Spaces are allowed
          between the exclamation mark and the keyword. See below for more
          details on the supported keywords.

&lt;pattern&gt; is the pattern to look for. It may be a string, a regular
          expression or a more complex pattern with several arguments. If
          the string pattern contains spaces, they must be escaped with the
          usual backslash ('\').</pre>
</div>
<pre class="text">By default, &quot;<a href="#option%20httpchk">option httpchk</a>&quot; considers that response statuses 2xx and 3xx
are valid, and that others are invalid. When &quot;<a href="#http-check%20expect">http-check expect</a>&quot; is used,
it defines what is considered valid or invalid. Only one &quot;<a href="#http-check">http-check</a>&quot;
statement is supported in a backend. If a server fails to respond or times
out, the check obviously fails. The available matches are :

  status &lt;codes&gt; :  test the status codes found parsing &lt;codes&gt; string. it
                    must be a comma-separated list of status codes or range
                    codes. A health check response will be considered as
                    valid if the response's status code matches any status
                    code or is inside any range of the list. If the &quot;<a href="#status">status</a>&quot;
                    keyword is prefixed with &quot;!&quot;, then the response will be
                    considered invalid if the status code matches.

  rstatus &lt;regex&gt; : test a regular expression for the HTTP status code.
                    A health check response will be considered valid if the
                    response's status code matches the expression. If the
                    &quot;rstatus&quot; keyword is prefixed with &quot;!&quot;, then the response
                    will be considered invalid if the status code matches.
                    This is mostly used to check for multiple codes.

  hdr  { name | name-lf } [ -m &lt;meth&gt; ] &lt;name&gt;
       [ { value | value-lf } [ -m &lt;meth&gt; ] &lt;value&gt; :
                    test the specified header pattern on the HTTP response
                    headers. The name pattern is mandatory but the value
                    pattern is optional. If not specified, only the header
                    presence is verified. &lt;meth&gt; is the matching method,
                    applied on the header name or the header value. Supported
                    matching methods are &quot;<a href="#str">str</a>&quot; (exact match), &quot;beg&quot; (prefix
                    match), &quot;end&quot; (suffix match), &quot;<a href="#sub">sub</a>&quot; (substring match) or
                    &quot;reg&quot; (regex match). If not specified, exact matching
                    method is used. If the &quot;name-lf&quot; parameter is used,
                    &lt;name&gt; is evaluated as a Custom log format string (see
                    <a href="#8.2.6">section 8.2.6</a>). If &quot;value-lf&quot; parameter is used, &lt;value&gt;
                    is evaluated as a log-format string. These parameters
                    cannot be used with the regex matching method. Finally,
                    the header value is considered as comma-separated
                    list. Note that matchings are case insensitive on the
                    header names.

  fhdr { name | name-lf } [ -m &lt;meth&gt; ] &lt;name&gt;
       [ { value | value-lf } [ -m &lt;meth&gt; ] &lt;value&gt; :
                    test the specified full header pattern on the HTTP
                    response headers. It does exactly the same as the &quot;<a href="#hdr">hdr</a>&quot;
                    keyword, except the full header value is tested, commas
                    are not considered as delimiters.

  string &lt;string&gt; : test the exact string match in the HTTP response body.
                    A health check response will be considered valid if the
                    response's body contains this exact string. If the
                    &quot;string&quot; keyword is prefixed with &quot;!&quot;, then the response
                    will be considered invalid if the body contains this
                    string. This can be used to look for a mandatory word at
                    the end of a dynamic page, or to detect a failure when a
                    specific error appears on the check page (e.g. a stack
                    trace).

  rstring &lt;regex&gt; : test a regular expression on the HTTP response body.
                    A health check response will be considered valid if the
                    response's body matches this expression. If the &quot;rstring&quot;
                    keyword is prefixed with &quot;!&quot;, then the response will be
                    considered invalid if the body matches the expression.
                    This can be used to look for a mandatory word at the end
                    of a dynamic page, or to detect a failure when a specific
                    error appears on the check page (e.g. a stack trace).

  string-lf &lt;fmt&gt; : test a Custom log format string (see <a href="#8.2.6">section 8.2.6</a>) match
                    in the HTTP response body. A health check response will
                    be considered valid if the response's body contains the
                    string resulting of the evaluation of &lt;fmt&gt;, which
                    follows the log-format rules. If prefixed with &quot;!&quot;, then
                    the response will be considered invalid if the body
                    contains the string.

It is important to note that the responses will be limited to a certain size
defined by the global &quot;<a href="#tune.bufsize">tune.bufsize</a>&quot; option, which defaults to 16384 bytes.
Thus, too large responses may not contain the mandatory pattern when using
&quot;string&quot; or &quot;rstring&quot;. If a large response is absolutely required, it is
possible to change the default max size by setting the global variable.
However, it is worth keeping in mind that parsing very large responses can
waste some CPU cycles, especially when regular expressions are used, and that
it is always better to focus the checks on smaller resources.

In an http-check ruleset, the last expect rule may be implicit. If no expect
rule is specified after the last &quot;<a href="#http-check%20send">http-check send</a>&quot;, an implicit expect rule
is defined to match on 2xx or 3xx status codes. It means this rule is also
defined if there is no &quot;<a href="#http-check">http-check</a>&quot; rule at all, when only &quot;<a href="#option%20httpchk">option httpchk</a>&quot;
is set.

Last, if &quot;<a href="#http-check%20expect">http-check expect</a>&quot; is combined with &quot;<a href="#http-check%20disable-on-404">http-check disable-on-404</a>&quot;,
then this last one has precedence when the server responds with 404.
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code><span class="comment"># only accept status 200 as valid</span>
http-check expect status 200,201,300-310

<span class="comment"># be sure a sessid coookie is set</span>
http-check expect header name &quot;<a href="#set-cookie">set-cookie</a>&quot; value -m beg &quot;sessid=&quot;

<span class="comment"># consider SQL errors as errors</span>
http-check expect ! string SQL\ Error

<span class="comment"># consider status 5xx only as errors</span>
http-check expect ! rstatus ^5

<span class="comment"># check that we have a correct hexadecimal tag before /html</span>
http-check expect rstring &lt;!--tag:[0-9a-f]*--&gt;&lt;/html&gt;
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httpchk">option httpchk</a>&quot;, &quot;<a href="#http-check%20connect">http-check connect</a>&quot;, &quot;<a href="#http-check%20disable-on-404">http-check disable-on-404</a>&quot; and &quot;<a href="#http-check%20send">http-check send</a>&quot;.</div>
<a class="anchor" name="http-check"></a><a class="anchor" name="4-http-check"></a><a class="anchor" name="4.2-http-check"></a><a class="anchor" name="http-check (Proxies)"></a><a class="anchor" name="http-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="http-check send"></a><a class="anchor" name="4-http-check send"></a><a class="anchor" name="4.2-http-check send"></a><a class="anchor" name="http-check send (Proxies)"></a><a class="anchor" name="http-check send (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="http-check send"></a><a href="#4.2-http-check%20send">http-check send</a></b> <span style="color: #008">[meth <span style="color: #080">&lt;method&gt;</span>]</span> <span style="color: #008">[<span style="color: #800">{ uri <span style="color: #080">&lt;uri&gt;</span> | uri-lf <span style="color: #080">&lt;fmt&gt;</span> }</span></span>&gt;] <span style="color: #008">[ver <span style="color: #080">&lt;version&gt;</span>]</span>
                <span style="color: #008">[hdr <span style="color: #080">&lt;name&gt;</span> <span style="color: #080">&lt;fmt&gt;</span>]</span>* <span style="color: #008">[<span style="color: #800">{ body <span style="color: #080">&lt;string&gt;</span> | body-lf <span style="color: #080">&lt;fmt&gt;</span> }</span>]</span>
                <span style="color: #008">[comment <span style="color: #080">&lt;msg&gt;</span>]</span></div><pre class="text">Add a possible list of headers and/or a body to the request sent during HTTP
health checks.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">comment &lt;msg&gt;  defines a message to report if the rule evaluation fails.

meth &lt;method&gt;  is the optional HTTP method used with the requests. When not
               set, the &quot;OPTIONS&quot; method is used, as it generally requires
               low server processing and is easy to filter out from the
               logs. Any method may be used, though it is not recommended
               to invent non-standard ones.

uri &lt;uri&gt;      is optional and set the URI referenced in the HTTP requests
               to the string &lt;uri&gt;. It defaults to &quot;/&quot; which is accessible
               by default on almost any server, but may be changed to any
               other URI. Query strings are permitted.

uri-lf &lt;fmt&gt;   is optional and set the URI referenced in the HTTP requests
               using the Custom log format &lt;fmt&gt; (see <a href="#8.2.6">section 8.2.6</a>). It
               defaults to &quot;/&quot; which is accessible by default on almost any
               server, but may be changed to any other URI. Query strings
               are permitted.

ver &lt;version&gt;  is the optional HTTP version string. It defaults to
               &quot;HTTP/1.0&quot; but some servers might behave incorrectly in HTTP
               1.0, so turning it to HTTP/1.1 may sometimes help. Note that
               the Host field is mandatory in HTTP/1.1, use &quot;<a href="#hdr">hdr</a>&quot; argument
               to add it.

hdr &lt;name&gt; &lt;fmt&gt;  adds the HTTP header field whose name is specified in
                  &lt;name&gt; and whose value is defined by &lt;fmt&gt;, which follows
                  the Custom log format rules described in <a href="#8.2.6">section 8.2.6</a>.

body &lt;string&gt;  add the body defined by &lt;string&gt; to the request sent during
               HTTP health checks. If defined, the &quot;Content-Length&quot; header
               is thus automatically added to the request.

body-lf &lt;fmt&gt;  add the body defined by the Custom log format &lt;fmt&gt; (see
               <a href="#8.2.6">section 8.2.6</a>) to the request sent during HTTP health
               checks. If defined, the &quot;Content-Length&quot; header is thus
               automatically added to the request.</pre>
</div>
<pre class="text">In addition to the request line defined by the &quot;<a href="#option%20httpchk">option httpchk</a>&quot; directive,
this one is the valid way to add some headers and optionally a body to the
request sent during HTTP health checks. If a body is defined, the associate
&quot;Content-Length&quot; header is automatically added. Thus, this header or
&quot;Transfer-encoding&quot; header should not be present in the request provided by
&quot;<a href="#http-check%20send">http-check send</a>&quot;. If so, it will be ignored. The old trick consisting to add
headers after the version string on the &quot;<a href="#option%20httpchk">option httpchk</a>&quot; line is now
deprecated.

Also &quot;<a href="#http-check%20send">http-check send</a>&quot; doesn't support HTTP keep-alive. Keep in mind that it
will automatically append a &quot;Connection: close&quot; header, unless a Connection
header has already already been configured via a hdr entry.

Note that the Host header and the request authority, when both defined, are
automatically synchronized. It means when the HTTP request is sent, when a
Host is inserted in the request, the request authority is accordingly
updated. Thus, don't be surprised if the Host header value overwrites the
configured request authority.

Note also for now, no Host header is automatically added in HTTP/1.1 or above
requests. You should add it explicitly.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httpchk">option httpchk</a>&quot;, &quot;<a href="#http-check%20send-state">http-check send-state</a>&quot; and &quot;<a href="#http-check%20expect">http-check expect</a>&quot;.</div>
<a class="anchor" name="http-check"></a><a class="anchor" name="4-http-check"></a><a class="anchor" name="4.2-http-check"></a><a class="anchor" name="http-check (Proxies)"></a><a class="anchor" name="http-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="http-check send-state"></a><a class="anchor" name="4-http-check send-state"></a><a class="anchor" name="4.2-http-check send-state"></a><a class="anchor" name="http-check send-state (Proxies)"></a><a class="anchor" name="http-check send-state (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="http-check send-state"></a><a href="#4.2-http-check%20send-state">http-check send-state</a></b></div><pre class="text">Enable emission of a state header with HTTP health checks

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">When this option is set, HAProxy will systematically send a special header
&quot;X-Haproxy-Server-State&quot; with a list of parameters indicating to each server
how they are seen by HAProxy. This can be used for instance when a server is
manipulated without access to HAProxy and the operator needs to know whether
HAProxy still sees it up or not, or if the server is the last one in a farm.

The header is composed of fields delimited by semi-colons, the first of which
is a word (&quot;UP&quot;, &quot;DOWN&quot;, &quot;NOLB&quot;), possibly followed by a number of valid
checks on the total number before transition, just as appears in the stats
interface. Next headers are in the form &quot;&lt;variable&gt;=&lt;value&gt;&quot;, indicating in
no specific order some values available in the stats interface :
  - a variable &quot;address&quot;, containing the address of the backend server.
    This corresponds to the &lt;address&gt; field in the server declaration. For
    unix domain sockets, it will read &quot;unix&quot;.

  - a variable &quot;<a href="#port">port</a>&quot;, containing the port of the backend server. This
    corresponds to the &lt;port&gt; field in the server declaration. For unix
    domain sockets, it will read &quot;unix&quot;.

  - a variable &quot;<a href="#name">name</a>&quot;, containing the name of the backend followed by a slash
    (&quot;/&quot;) then the name of the server. This can be used when a server is
    checked in multiple backends.

  - a variable &quot;<a href="#node">node</a>&quot; containing the name of the HAProxy node, as set in the
    global &quot;<a href="#node">node</a>&quot; variable, otherwise the system's hostname if unspecified.

  - a variable &quot;<a href="#weight">weight</a>&quot; indicating the weight of the server, a slash (&quot;/&quot;)
    and the total weight of the farm (just counting usable servers). This
    helps to know if other servers are available to handle the load when this
    one fails.

  - a variable &quot;scur&quot; indicating the current number of concurrent connections
    on the server, followed by a slash (&quot;/&quot;) then the total number of
    connections on all servers of the same backend.

  - a variable &quot;qcur&quot; indicating the current number of requests in the
    server's queue.

Example of a header received by the application server :
  &gt;&gt;&gt;  X-Haproxy-Server-State: UP 2/3; name=bck/srv2; node=lb1; weight=1/2; \
         scur=13/22; qcur=0
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httpchk">option httpchk</a>&quot;, &quot;<a href="#http-check%20disable-on-404">http-check disable-on-404</a>&quot; and &quot;<a href="#http-check%20send">http-check send</a>&quot;.</div>
<a class="anchor" name="http-check"></a><a class="anchor" name="4-http-check"></a><a class="anchor" name="4.2-http-check"></a><a class="anchor" name="http-check (Proxies)"></a><a class="anchor" name="http-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="http-check set-var"></a><a class="anchor" name="4-http-check set-var"></a><a class="anchor" name="4.2-http-check set-var"></a><a class="anchor" name="http-check set-var (Proxies)"></a><a class="anchor" name="http-check set-var (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="http-check set-var"></a><a href="#4.2-http-check%20set-var">http-check set-var</a></b>(<span style="color: #080">&lt;var-name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;cond&gt;</span>...]</span>) <span style="color: #080">&lt;expr&gt;</span></div><a class="anchor" name="http-check"></a><a class="anchor" name="4-http-check"></a><a class="anchor" name="4.2-http-check"></a><a class="anchor" name="http-check (Proxies)"></a><a class="anchor" name="http-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="http-check set-var-fmt"></a><a class="anchor" name="4-http-check set-var-fmt"></a><a class="anchor" name="4.2-http-check set-var-fmt"></a><a class="anchor" name="http-check set-var-fmt (Proxies)"></a><a class="anchor" name="http-check set-var-fmt (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="http-check set-var-fmt"></a><a href="#4.2-http-check%20set-var-fmt">http-check set-var-fmt</a></b>(<span style="color: #080">&lt;var-name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;cond&gt;</span>...]</span>) <span style="color: #080">&lt;fmt&gt;</span></div><pre class="text">This operation sets the content of a variable. The variable is declared inline.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;var-name&gt;   The name of the variable. Only &quot;<a href="#proc">proc</a>&quot;, &quot;sess&quot; and &quot;<a href="#check">check</a>&quot;
             scopes can be used. See <a href="#2.8">section 2.8</a> about variables for details.

 &lt;cond&gt;      A set of conditions that must all be true for the variable to
             actually be set (such as &quot;ifnotempty&quot;, &quot;ifgt&quot; ...). See the
             set-var converter's description for a full list of possible
             conditions.

 &lt;expr&gt;      Is a sample-fetch expression potentially followed by converters.

 &lt;fmt&gt;       This is the value expressed using Custom log format (see Custom
             Log Format in <a href="#8.2.6">section 8.2.6</a>).</pre>
</div>
<div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code>http-check set-var(check.port) int(1234)
http-check set-var-fmt(check.port) &quot;name=%H&quot;
</code></pre>
</div><a class="anchor" name="http-check"></a><a class="anchor" name="4-http-check"></a><a class="anchor" name="4.2-http-check"></a><a class="anchor" name="http-check (Proxies)"></a><a class="anchor" name="http-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="http-check unset-var"></a><a class="anchor" name="4-http-check unset-var"></a><a class="anchor" name="4.2-http-check unset-var"></a><a class="anchor" name="http-check unset-var (Proxies)"></a><a class="anchor" name="http-check unset-var (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="http-check unset-var"></a><a href="#4.2-http-check%20unset-var">http-check unset-var</a></b>(<span style="color: #080">&lt;var-name&gt;</span>)</div><pre class="text">Free a reference to a variable within its scope.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;var-name&gt;   The name of the variable. Only &quot;<a href="#proc">proc</a>&quot;, &quot;sess&quot; and &quot;<a href="#check">check</a>&quot;
             scopes can be used. See <a href="#2.8">section 2.8</a> about variables for details.</pre>
</div>
<div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code>http-check unset-var(check.port)
</code></pre>
</div><a class="anchor" name="http-error"></a><a class="anchor" name="4-http-error"></a><a class="anchor" name="4.2-http-error"></a><a class="anchor" name="http-error (Proxies)"></a><a class="anchor" name="http-error (Alphabetically sorted keywords reference)"></a><a class="anchor" name="http-error status"></a><a class="anchor" name="4-http-error status"></a><a class="anchor" name="4.2-http-error status"></a><a class="anchor" name="http-error status (Proxies)"></a><a class="anchor" name="http-error status (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="http-error status"></a><a href="#4.2-http-error%20status">http-error status</a></b> <span style="color: #080">&lt;code&gt;</span> <span style="color: #008">[content-type <span style="color: #080">&lt;type&gt;</span>]</span>
           <span style="color: #008">[ <span style="color: #800">{ default-errorfiles | errorfile <span style="color: #080">&lt;file&gt;</span> | errorfiles <span style="color: #080">&lt;name&gt;</span> |
               file <span style="color: #080">&lt;file&gt;</span> | lf-file <span style="color: #080">&lt;file&gt;</span> | string <span style="color: #080">&lt;str&gt;</span> | lf-string <span style="color: #080">&lt;fmt&gt;</span> }</span> ]</span>
           <span style="color: #008">[ hdr <span style="color: #080">&lt;name&gt;</span> <span style="color: #080">&lt;fmt&gt;</span> ]</span>*</div><pre class="text">Defines a custom error message to use instead of errors generated by HAProxy.

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">status &lt;code&gt;        is the HTTP status code. It must be specified.
                     Currently, HAProxy is capable of generating codes
                     200, 400, 401, 403, 404, 405, 407, 408, 410, 413,
                     414, 425, 429, 431, 500, 501, 502, 503, and 504.

content-type &lt;type&gt;  is the response content type, for instance
                     &quot;text/plain&quot;. This parameter is ignored and should be
                     omitted when an errorfile is configured or when the
                     payload is empty. Otherwise, it must be defined.

default-errorfiles   Reset the previously defined error message for current
                     proxy for the status &lt;code&gt;. If used on a backend, the
                     frontend error message is used, if defined. If used on
                     a frontend, the default error message is used.

errorfile &lt;file&gt;     designates a file containing the full HTTP response.
                     It is recommended to follow the common practice of
                     appending &quot;.http&quot; to the filename so that people do
                     not confuse the response with HTML error pages, and to
                     use absolute paths, since files are read before any
                     chroot is performed.

errorfiles &lt;name&gt;    designates the http-errors section to use to import
                     the error message with the status code &lt;code&gt;. If no
                     such message is found, the proxy's error messages are
                     considered.

file &lt;file&gt;          specifies the file to use as response payload. If the
                     file is not empty, its content-type must be set as
                     argument to &quot;content-type&quot;, otherwise, any
                     &quot;content-type&quot; argument is ignored. &lt;file&gt; is
                     considered as a raw string.

string &lt;str&gt;         specifies the raw string to use as response payload.
                     The content-type must always be set as argument to
                     &quot;content-type&quot;.

lf-file &lt;file&gt;       specifies the file to use as response payload. If the
                     file is not empty, its content-type must be set as
                     argument to &quot;content-type&quot;, otherwise, any
                     &quot;content-type&quot; argument is ignored. &lt;file&gt; is
                     evaluated as a Custom log format (see <a href="#8.2.6">section 8.2.6</a>).

lf-string &lt;str&gt;      specifies the log-format string to use as response
                     payload. The content-type must always be set as
                     argument to &quot;content-type&quot;.

hdr &lt;name&gt; &lt;fmt&gt;     adds to the response the HTTP header field whose name
                     is specified in &lt;name&gt; and whose value is defined by
                     &lt;fmt&gt;, which follows the Custom log format rules (see
                     <a href="#8.2.6">section 8.2.6</a>). This parameter is ignored if an
                     errorfile is used.</pre>
</div>
<pre class="text">This directive may be used instead of &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">errorfile<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#errorfile%20%28HTTP-errors%29">HTTP-errors</a></li><li><a href="#errorfile%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, to define a custom error
message. As &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">errorfile<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#errorfile%20%28HTTP-errors%29">HTTP-errors</a></li><li><a href="#errorfile%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive, it is used for errors detected and
returned by HAProxy. If an errorfile is defined, it is parsed when HAProxy
starts and must be valid according to the HTTP standards. The generated
response must not exceed the configured buffer size (BUFFSIZE), otherwise an
internal error will be returned.  Finally, if you consider to use some
http-after-response rules to rewrite these errors, the reserved buffer space
should be available (see &quot;<a href="#tune.maxrewrite">tune.maxrewrite</a>&quot;).

The files are read at the same time as the configuration and kept in memory.
For this reason, the errors continue to be returned even when the process is
chrooted, and no file change is considered while the process is running.

Note: 400/408/500 errors emitted in early stage of the request parsing are
      handled by the multiplexer at a lower level. No custom formatting is
      supported at this level. Thus only static error messages, defined with
      &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">errorfile<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#errorfile%20%28HTTP-errors%29">HTTP-errors</a></li><li><a href="#errorfile%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive, are supported. However, this limitation only
      exists during the request headers parsing or between two transactions.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">errorfile<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#errorfile%20%28HTTP-errors%29">HTTP-errors</a></li><li><a href="#errorfile%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#errorfiles">errorfiles</a>&quot;, &quot;<a href="#errorloc">errorloc</a>&quot;, &quot;<a href="#errorloc302">errorloc302</a>&quot;, &quot;<a href="#errorloc303">errorloc303</a>&quot; and <a href="#3.8">section 3.8</a> about http-errors.</div>
<a class="anchor" name="http-request"></a><a class="anchor" name="4-http-request"></a><a class="anchor" name="4.2-http-request"></a><a class="anchor" name="http-request (Proxies)"></a><a class="anchor" name="http-request (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="http-request"></a><a href="#4.2-http-request">http-request</a></b> <span style="color: #080">&lt;action&gt;</span> <span style="color: #008">[options...]</span> <span style="color: #008">[ <span style="color: #800">{ if | unless }</span> <span style="color: #080">&lt;condition&gt;</span> ]</span></div><pre class="text">Access control for Layer 7 requests

May be used in the following contexts: http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-info pagination-centered">yes(!)<br /><img src="../css/checkmark.png" alt="yes(!)" title="yes(!)" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">The http-request statement defines a set of rules which apply to layer 7
processing. The rules are evaluated in their declaration order when they are
met in a frontend, listen or backend section. Any rule may optionally be
followed by an ACL-based condition, in which case it will only be evaluated
if the condition evaluates to true.

The condition is evaluated just before the action is executed, and the action
is performed exactly once. As such, there is no problem if an action changes
an element which is checked as part of the condition. This also means that
multiple actions may rely on the same condition so that the first action that
changes the condition's evaluation is sufficient to implicitly disable the
remaining actions. This is used for example when trying to assign a value to
a variable from various sources when it's empty. There is no limit to the
number of &quot;<a href="#http-request">http-request</a>&quot; statements per instance.

The first keyword after &quot;<a href="#http-request">http-request</a>&quot; in the syntax is the rule's action,
optionally followed by a varying number of arguments for the action. The
supported actions and their respective syntaxes are enumerated in <a href="#4.3">section 4.3</a>
&quot;Actions&quot; (look for actions which tick &quot;HTTP Req&quot;).

This directive is only available from named defaults sections, not anonymous
ones. Rules defined in the defaults section are evaluated before ones in the
associated proxy section. To avoid ambiguities, in this case the same
defaults section cannot be used by proxies with the frontend capability and
by proxies with the backend capability. It means a listen section cannot use
a defaults section defining such rules.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>acl nagios src 192.168.129.3
acl local_net src 192.168.0.0/16
acl auth_ok http_auth(L1)

http-request allow if nagios
http-request allow if local_net auth_ok
http-request auth realm Gimme if local_net auth_ok
http-request deny
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>acl key req.hdr(X-Add-Acl-Key) -m found
acl add path /addacl
acl del path /delacl

acl myhost hdr(Host) -f myhost.lst

http-request add-acl(myhost.lst) %[req.hdr(X-Add-Acl-Key)] if key add
http-request del-acl(myhost.lst) %[req.hdr(X-Add-Acl-Key)] if key del
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>acl value  req.hdr(X-Value) -m found
acl setmap path /setmap
acl delmap path /delmap

use_backend bk_appli if { hdr(Host),map_str(map.lst) -m found }

http-request set-map(map.lst) %[src] %[req.hdr(X-Value)] if setmap value
http-request del-map(map.lst) %[src]                     if delmap
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#stats%20http-request">stats http-request</a>&quot;, <a href="#3.4">section 3.4</a> about userlists and <a href="#7">section 7</a> about ACL usage.</div>
<a class="anchor" name="http-response"></a><a class="anchor" name="4-http-response"></a><a class="anchor" name="4.2-http-response"></a><a class="anchor" name="http-response (Proxies)"></a><a class="anchor" name="http-response (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="http-response"></a><a href="#4.2-http-response">http-response</a></b> <span style="color: #080">&lt;action&gt;</span> <span style="color: #080">&lt;options...&gt;</span> <span style="color: #008">[ <span style="color: #800">{ if | unless }</span> <span style="color: #080">&lt;condition&gt;</span> ]</span></div><pre class="text">Access control for Layer 7 responses

May be used in the following contexts: http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-info pagination-centered">yes(!)<br /><img src="../css/checkmark.png" alt="yes(!)" title="yes(!)" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">The http-response statement defines a set of rules which apply to layer 7
processing. The rules are evaluated in their declaration order when they are
met in a frontend, listen or backend section. Since these rules apply on
responses, the backend rules are applied first, followed by the frontend's
rules. Any rule may optionally be followed by an ACL-based condition, in
which case it will only be evaluated if the condition evaluates to true.

The condition is evaluated just before the action is executed, and the action
is performed exactly once. As such, there is no problem if an action changes
an element which is checked as part of the condition. This also means that
multiple actions may rely on the same condition so that the first action that
changes the condition's evaluation is sufficient to implicitly disable the
remaining actions. This is used for example when trying to assign a value to
a variable from various sources when it's empty. There is no limit to the
number of &quot;<a href="#http-response">http-response</a>&quot; statements per instance.

The first keyword after &quot;<a href="#http-response">http-response</a>&quot; in the syntax is the rule's action,
optionally followed by a varying number of arguments for the action. The
supported actions and their respective syntaxes are enumerated in <a href="#4.3">section 4.3</a>
&quot;Actions&quot; (look for actions which tick &quot;HTTP Res&quot;).

This directive is only available from named defaults sections, not anonymous
ones. Rules defined in the defaults section are evaluated before ones in the
associated proxy section. To avoid ambiguities, in this case the same
defaults section cannot be used by proxies with the frontend capability and
by proxies with the backend capability. It means a listen section cannot use
a defaults section defining such rules.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>acl key_acl res.hdr(X-Acl-Key) -m found

acl myhost hdr(Host) -f myhost.lst

http-response add-acl(myhost.lst) %[res.hdr(X-Acl-Key)] if key_acl
http-response del-acl(myhost.lst) %[res.hdr(X-Acl-Key)] if key_acl
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>acl value  res.hdr(X-Value) -m found

use_backend bk_appli if { hdr(Host),map_str(map.lst) -m found }

http-response set-map(map.lst) %[src] %[res.hdr(X-Value)] if value
http-response del-map(map.lst) %[src]                     if ! value
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#http-request">http-request</a>&quot;, <a href="#3.4">section 3.4</a> about userlists and <a href="#7">section 7</a> about ACL usage.</div>
<a class="anchor" name="http-reuse"></a><a class="anchor" name="4-http-reuse"></a><a class="anchor" name="4.2-http-reuse"></a><a class="anchor" name="http-reuse (Proxies)"></a><a class="anchor" name="http-reuse (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="http-reuse"></a><a href="#4.2-http-reuse">http-reuse</a></b> <span style="color: #800">{ never | safe | aggressive | always }</span></div><pre class="text">Declare how idle HTTP connections may be shared between requests

May be used in the following contexts: http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">In order to avoid the cost of setting up new connections to backend servers
for each HTTP request, HAProxy tries to keep such idle connections opened
after being used. These connections are specific to a server and are stored
in a list called a pool, and are grouped together by a set of common key
properties. Subsequent HTTP requests will cause a lookup of a compatible
connection sharing identical properties in the associated pool and result in
this connection being reused instead of establishing a new one.

A limit on the number of idle connections to keep on a server can be
specified via the &quot;<a href="#pool-max-conn">pool-max-conn</a>&quot; server keyword. Unused connections are
periodically purged according to the &quot;<a href="#pool-purge-delay">pool-purge-delay</a>&quot; interval.

The following connection properties are used to determine if an idle
connection is eligible for reuse on a given request:
- source and destination addresses
- proxy protocol
- TOS and mark socket options
- connection name, determined either by the result of the evaluation of the
  &quot;<a href="#pool-conn-name">pool-conn-name</a>&quot; expression if present, otherwise by the &quot;<a href="#sni">sni</a>&quot; expression

In some occasions, connection lookup or reuse is not performed due to extra
restrictions. This is determined by the reuse strategy specified via the
keyword argument:

  - &quot;never&quot;  : idle connections are never shared between sessions. This mode
               may be enforced to cancel a different strategy inherited from
               a defaults section or for troubleshooting. For example, if an
               old bogus application considers that multiple requests over
               the same connection come from the same client and it is not
               possible to fix the application, it may be desirable to
               disable connection sharing in a single backend. An example of
               such an application could be an old HAProxy using cookie
               insertion in tunnel mode and not checking any request past the
               first one.

  - &quot;safe&quot;   : this is the default and the recommended strategy. The first
               request of a session is always sent over its own connection,
               and only subsequent requests may be dispatched over other
               existing connections. This ensures that in case the server
               closes the connection when the request is being sent, the
               browser can decide to silently retry it. Since it is exactly
               equivalent to regular keep-alive, there should be no side
               effects. There is also a special handling for the connections
               using protocols subject to Head-of-line blocking (backend with
               h2 or fcgi). In this case, when at least one stream is
               processed, the used connection is reserved to handle streams
               of the same session. When no more streams are processed, the
               connection is released and can be reused.

  - &quot;aggressive&quot; : this mode may be useful in webservices environments where
               all servers are not necessarily known and where it would be
               appreciable to deliver most first requests over existing
               connections. In this case, first requests are only delivered
               over existing connections that have been reused at least once,
               proving that the server correctly supports connection reuse.
               It should only be used when it's sure that the client can
               retry a failed request once in a while and where the benefit
               of aggressive connection reuse significantly outweighs the
               downsides of rare connection failures.

  - &quot;always&quot; : this mode is only recommended when the path to the server is
               known for never breaking existing connections quickly after
               releasing them. It allows the first request of a session to be
               sent to an existing connection. This can provide a significant
               performance increase over the &quot;safe&quot; strategy when the backend
               is a cache farm, since such components tend to show a
               consistent behavior and will benefit from the connection
               sharing. It is recommended that the &quot;<a href="#option%20http-keep-alive">http-keep-alive</a>&quot; timeout
               remains low in this mode so that no dead connections remain
               usable. In most cases, this will lead to the same performance
               gains as &quot;aggressive&quot; but with more risks. It should only be
               used when it improves the situation over &quot;aggressive&quot;.

Also note that connections with certain bogus authentication schemes (relying
on the connection) like NTLM are marked private if possible and never shared.
This won't be the case however when using a protocol with multiplexing
abilities and using reuse mode level value greater than the default &quot;safe&quot;
strategy as in this case nothing prevents the connection from being already
shared.

The rules to decide to keep an idle connection opened or to close it after
processing are also governed by the &quot;<a href="#tune.pool-low-fd-ratio">tune.pool-low-fd-ratio</a>&quot; (default: 20%)
and &quot;<a href="#tune.pool-high-fd-ratio">tune.pool-high-fd-ratio</a>&quot; (default: 25%). These correspond to the
percentage of total file descriptors spent in idle connections above which
haproxy will respectively refrain from keeping a connection opened after a
response, and actively kill idle connections. Some setups using a very high
ratio of idle connections, either because of too low a global &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;, or
due to a lot of HTTP/2 or HTTP/3 traffic on the frontend (few connections)
but HTTP/1 connections on the backend, may observe a lower reuse rate because
too few connections are kept open. It may be desirable in this case to adjust
such thresholds or simply to increase the global &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; value.

When thread groups are explicitly enabled, it is important to understand that
idle connections are only usable between threads from a same group. As such
it may happen that unfair load between groups leads to more idle connections
being needed, causing a lower reuse rate. The same solution may then be
applied (increase global &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; or increase pool ratios).
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20http-keep-alive">option http-keep-alive</a>&quot;, &quot;<a href="#pool-conn-name">pool-conn-name</a>&quot;, &quot;<a href="#pool-max-conn">pool-max-conn</a>&quot;, &quot;<a href="#pool-purge-delay">pool-purge-delay</a>&quot;, &quot;server maxconn&quot;, &quot;<a href="#sni">sni</a>&quot;, &quot;<a href="#thread-groups">thread-groups</a>&quot;, &quot;<a href="#tune.pool-high-fd-ratio">tune.pool-high-fd-ratio</a>&quot;, &quot;<a href="#tune.pool-low-fd-ratio">tune.pool-low-fd-ratio</a>&quot;</div>
<a class="anchor" name="http-send-name-header"></a><a class="anchor" name="4-http-send-name-header"></a><a class="anchor" name="4.2-http-send-name-header"></a><a class="anchor" name="http-send-name-header (Proxies)"></a><a class="anchor" name="http-send-name-header (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="http-send-name-header"></a><a href="#4.2-http-send-name-header">http-send-name-header</a></b> <span style="color: #008">[<span style="color: #080">&lt;header&gt;</span>]</span></div><pre class="text">Add the server name to a request. Use the header string given by &lt;header&gt;

May be used in the following contexts: http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;header&gt;  The header string to use to send the server name</pre>
</div>
<pre class="text">The &quot;<a href="#http-send-name-header">http-send-name-header</a>&quot; statement causes the header field named &lt;header&gt;
to be set to the name of the target server at the moment the request is about
to be sent on the wire. Any existing occurrences of this header are removed.
Upon retries and redispatches, the header field is updated to always reflect
the server being attempted to connect to. Given that this header is modified
very late in the connection setup, it may have unexpected effects on already
modified headers. For example using it with transport-level header such as
connection, content-length, transfer-encoding and so on will likely result in
invalid requests being sent to the server. Additionally it has been reported
that this directive is currently being used as a way to overwrite the Host
header field in outgoing requests; while this trick has been known to work
as a side effect of the feature for some time, it is not officially supported
and might possibly not work anymore in a future version depending on the
technical difficulties this feature induces. A long-term solution instead
consists in fixing the application which required this trick so that it binds
to the correct host name.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;</div>
<a class="anchor" name="id"></a><a class="anchor" name="4-id"></a><a class="anchor" name="4.2-id"></a><a class="anchor" name="id (Proxies)"></a><a class="anchor" name="id (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="id"></a><a href="#4.2-id">id</a></b> <span style="color: #080">&lt;value&gt;</span></div><pre class="text">Set a persistent ID to a proxy.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">Set a persistent ID for the proxy. This ID must be unique and positive.
An unused ID will automatically be assigned if unset. The first assigned
value will be 1. This ID is currently only returned in statistics.
</pre><a class="anchor" name="ignore-persist"></a><a class="anchor" name="4-ignore-persist"></a><a class="anchor" name="4.2-ignore-persist"></a><a class="anchor" name="ignore-persist (Proxies)"></a><a class="anchor" name="ignore-persist (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="ignore-persist"></a><a href="#4.2-ignore-persist">ignore-persist</a></b> <span style="color: #800">{ if | unless }</span> <span style="color: #080">&lt;condition&gt;</span></div><pre class="text">Declare a condition to ignore persistence

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">By default, when cookie persistence is enabled, every requests containing
the cookie are unconditionally persistent (assuming the target server is up
and running).

The &quot;<a href="#ignore-persist">ignore-persist</a>&quot; statement allows one to declare various ACL-based
conditions which, when met, will cause a request to ignore persistence.
This is sometimes useful to load balance requests for static files, which
often don't require persistence. This can also be used to fully disable
persistence for a specific User-Agent (for example, some web crawler bots).

The persistence is ignored when an &quot;if&quot; condition is met, or unless an
&quot;unless&quot; condition is met.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>acl url_static  path_beg         /static /images /img /css
acl url_static  path_end         .gif .png .jpg .css .js
ignore-persist  if url_static
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#force-persist">force-persist</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">cookie<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#cookie%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#cookie%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li><li><a href="#cookie%20%28Fetching%20HTTP%20samples%20%28Layer%207%29%29">Fetching HTTP samples (Layer 7)</a></li></ul></span>&quot;, and <a href="#7">section 7</a> about ACL usage.</div>
<a class="anchor" name="load-server-state-from-file"></a><a class="anchor" name="4-load-server-state-from-file"></a><a class="anchor" name="4.2-load-server-state-from-file"></a><a class="anchor" name="load-server-state-from-file (Proxies)"></a><a class="anchor" name="load-server-state-from-file (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="load-server-state-from-file"></a><a href="#4.2-load-server-state-from-file">load-server-state-from-file</a></b> <span style="color: #800">{ global | local | none }</span></div><pre class="text">Allow seamless reload of HAProxy

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">This directive points HAProxy to a file where server state from previous
running process has been saved. That way, when starting up, before handling
traffic, the new process can apply old states to servers exactly has if no
reload occurred. The purpose of the &quot;<a href="#load-server-state-from-file">load-server-state-from-file</a>&quot; directive is
to tell HAProxy which file to use. For now, only 2 arguments to either prevent
loading state or load states from a file containing all backends and servers.
The state file can be generated by running the command &quot;show servers state&quot;
over the stats socket and redirect output.

The format of the file is versioned and is very specific. To understand it,
please read the documentation of the &quot;show servers state&quot; command (chapter
9.3 of Management Guide).
</pre><div class="separator">
<span class="label label-info">Arguments:</span><pre class="prettyprint arguments">global     load the content of the file pointed by the global directive
           named &quot;<a href="#server-state-file">server-state-file</a>&quot;.

local      load the content of the file pointed by the directive
           &quot;<a href="#server-state-file-name">server-state-file-name</a>&quot; if set. If not set, then the backend
           name is used as a file name.

none       don't load any stat for this backend</pre>
</div>
<pre class="text">Notes:
  - server's IP address is preserved across reloads by default, but the
    order can be changed thanks to the server's &quot;<a href="#init-addr">init-addr</a>&quot; setting. This
    means that an IP address change performed on the CLI at run time will
    be preserved, and that any change to the local resolver (e.g. /etc/hosts)
    will possibly not have any effect if the state file is in use.

  - server's weight is applied from previous running process unless it has
    has changed between previous and new configuration files.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<div class="example-desc">Minimal configuration</div><code>global
 stats socket /tmp/socket
 server-state-file /tmp/server_state

defaults
 load-server-state-from-file global

backend bk
 server s1 127.0.0.1:22 check weight 11
 server s2 127.0.0.1:22 check weight 12
</code></pre>
</div><pre class="text">Then one can run :

  socat /tmp/socket - &lt;&lt;&lt; &quot;show servers state&quot; &gt; /tmp/server_state

Content of the file /tmp/server_state would be like this:

  1
  # &lt;field names skipped for the doc example&gt;
  1 bk 1 s1 127.0.0.1 2 0 11 11 4 6 3 4 6 0 0
  1 bk 2 s2 127.0.0.1 2 0 12 12 4 6 3 4 6 0 0
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<div class="example-desc">Minimal configuration</div><code>global
 stats socket /tmp/socket
 server-state-base /etc/haproxy/states

defaults
 load-server-state-from-file local

backend bk
 server s1 127.0.0.1:22 check weight 11
 server s2 127.0.0.1:22 check weight 12
</code></pre>
</div><pre class="text">Then one can run :

  socat /tmp/socket - &lt;&lt;&lt; &quot;show servers state bk&quot; &gt; /etc/haproxy/states/bk

Content of the file /etc/haproxy/states/bk would be like this:

  1
  # &lt;field names skipped for the doc example&gt;
  1 bk 1 s1 127.0.0.1 2 0 11 11 4 6 3 4 6 0 0
  1 bk 2 s2 127.0.0.1 2 0 12 12 4 6 3 4 6 0 0
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#server-state-file">server-state-file</a>&quot;, &quot;<a href="#server-state-file-name">server-state-file-name</a>&quot;, and &quot;show servers state&quot;</div>
<a class="anchor" name="log"></a><a class="anchor" name="4-log"></a><a class="anchor" name="4.2-log"></a><a class="anchor" name="log (Proxies)"></a><a class="anchor" name="log (Alphabetically sorted keywords reference)"></a><a class="anchor" name="log global"></a><a class="anchor" name="4-log global"></a><a class="anchor" name="4.2-log global"></a><a class="anchor" name="log global (Proxies)"></a><a class="anchor" name="log global (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="log global"></a><a href="#4.2-log%20global">log global</a></b></div><a class="anchor" name="log"></a><a class="anchor" name="4-log"></a><a class="anchor" name="4.2-log"></a><a class="anchor" name="log (Proxies)"></a><a class="anchor" name="log (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="log"></a><a href="#4.2-log">log</a></b> <span style="color: #080">&lt;target&gt;</span> <span style="color: #008">[len <span style="color: #080">&lt;length&gt;</span>]</span> <span style="color: #008">[format <span style="color: #080">&lt;format&gt;</span>]</span> <span style="color: #008">[sample <span style="color: #080">&lt;ranges&gt;</span>:<span style="color: #080">&lt;sample_size&gt;</span>]</span>
    <span style="color: #008">[profile <span style="color: #080">&lt;prof&gt;</span>]</span> <span style="color: #080">&lt;facility&gt;</span> <span style="color: #008">[<span style="color: #080">&lt;level&gt;</span> <span style="color: #008">[<span style="color: #080">&lt;minlevel&gt;</span>]</span>]</span></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no log"></a><a class="anchor" name="4-no log"></a><a class="anchor" name="4.2-no log"></a><a class="anchor" name="no log (Proxies)"></a><a class="anchor" name="no log (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no log"></a><a href="#4.2-no%20log">no log</a></b></div><pre class="text">Enable per-instance logging of events and traffic.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">Prefix :
  no         should be used when the logger list must be flushed. For example,
             if you don't want to inherit from the default logger list. This
             prefix does not allow arguments.
</pre><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">global     should be used when the instance's logging parameters are the
           same as the global ones. This is the most common usage. &quot;global&quot;
           replaces all log arguments with those of the log entries found
           in the &quot;global&quot; section. Only one &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log global<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20global%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20global%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; statement may be
           used per instance, and this form takes no other parameter.

&lt;target&gt;   indicates where to send the logs. It takes the same format as
           for the &quot;global&quot; section's logs, and can be one of :

           - An IPv4 address optionally followed by a colon (':') and a UDP
             port. If no port is specified, 514 is used by default (the
             standard syslog port).

           - An IPv6 address followed by a colon (':') and optionally a UDP
             port. If no port is specified, 514 is used by default (the
             standard syslog port).

           - A filesystem path to a UNIX domain socket, keeping in mind
             considerations for chroot (be sure the path is accessible
             inside the chroot) and uid/gid (be sure the path is
             appropriately writable).

           - A file descriptor number in the form &quot;fd@&lt;number&gt;&quot;, which may
             point to a pipe, terminal, or socket. In this case unbuffered
             logs are used and one writev() call per log is performed. This
             is a bit expensive but acceptable for most workloads. Messages
             sent this way will not be truncated but may be dropped, in
             which case the DroppedLogs counter will be incremented. The
             writev() call is atomic even on pipes for messages up to
             PIPE_BUF size, which POSIX recommends to be at least 512 and
             which is 4096 bytes on most modern operating systems. Any
             larger message may be interleaved with messages from other
             processes.  Exceptionally for debugging purposes the file
             descriptor may also be directed to a file, but doing so will
             significantly slow HAProxy down as non-blocking calls will be
             ignored. Also there will be no way to purge nor rotate this
             file without restarting the process. Note that the configured
             syslog format is preserved, so the output is suitable for use
             with a TCP syslog server. See also the &quot;short&quot; and &quot;raw&quot;
             formats below.

           - &quot;stdout&quot; / &quot;stderr&quot;, which are respectively aliases for &quot;fd@1&quot;
             and &quot;fd@2&quot;, see above.

           - A ring buffer in the form &quot;ring@&lt;name&gt;&quot;, which will correspond
             to an in-memory ring buffer accessible over the CLI using the
             &quot;show events&quot; command, which will also list existing rings and
             their sizes. Such buffers are lost on reload or restart but
             when used as a complement this can help troubleshooting by
             having the logs instantly available.

           - A log backend in the form &quot;backend@&lt;name&gt;&quot;, which will send
             log messages to the corresponding log backend responsible for
             sending the message to the proper server according to the
             backend's lb settings. A log backend is a backend section with
             &quot;mode log&quot; set (see &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">mode<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#mode%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#mode%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; for more information).

           - An explicit stream address prefix such as &quot;tcp@&quot;,&quot;tcp6@&quot;,
             &quot;tcp4@&quot; or &quot;uxst@&quot; will allocate an implicit ring buffer with
             a stream forward server targeting the given address.

           You may want to reference some environment variables in the
           address parameter, see <a href="#2.3">section 2.3</a> about environment variables.

&lt;length&gt;   is an optional maximum line length. Log lines larger than this
           value will be truncated before being sent. The reason is that
           syslog servers act differently on log line length. All servers
           support the default value of 1024, but some servers simply drop
           larger lines while others do log them. If a server supports long
           lines, it may make sense to set this value here in order to avoid
           truncating long lines. Similarly, if a server drops long lines,
           it is preferable to truncate them before sending them. Accepted
           values are 80 to 65535 inclusive. The default value of 1024 is
           generally fine for all standard usages. Some specific cases of
           long captures or JSON-formatted logs may require larger values.
           You may also need to increase &quot;<a href="#tune.http.logurilen">tune.http.logurilen</a>&quot; if your
           request URIs are truncated.

&lt;ranges&gt;   A list of comma-separated ranges to identify the logs to sample.
           This is used to balance the load of the logs to send to the log
           server. The limits of the ranges cannot be null. They are numbered
           from 1. The size or period (in number of logs) of the sample must
           be set with &lt;sample_size&gt; parameter.

&lt;sample_size&gt;
           The size of the sample in number of logs to consider when balancing
           their logging loads. It is used to balance the load of the logs to
           send to the syslog server. This size must be greater or equal to the
           maximum of the high limits of the ranges.
           (see also &lt;ranges&gt; parameter).

&lt;format&gt; is the log format used when generating syslog messages. It may be
         one of the following :

  local     Analog to rfc3164 syslog message format except that hostname
            field is stripped. This is the default.
            Note: option &quot;<a href="#log-send-hostname">log-send-hostname</a>&quot; switches the default to
            rfc3164.

  rfc3164   The RFC3164 syslog message format.
            (https://tools.ietf.org/html/rfc3164)

  rfc5424   The RFC5424 syslog message format.
            (https://tools.ietf.org/html/rfc5424)

  priority  A message containing only a level plus syslog facility between
            angle brackets such as '&lt;63&gt;', followed by the text. The PID,
            date, time, process name and system name are omitted. This is
            designed to be used with a local log server.

  short     A message containing only a level between angle brackets such as
            '&lt;3&gt;', followed by the text. The PID, date, time, process name
            and system name are omitted. This is designed to be used with a
            local log server. This format is compatible with what the
            systemd logger consumes.

  timed     A message containing only a level between angle brackets such as
            '&lt;3&gt;', followed by ISO date and by the text. The PID, process
            name and system name are omitted. This is designed to be
            used with a local log server.

  iso       A message containing only the ISO date, followed by the text.
            The PID, process name and system name are omitted. This is
            designed to be used with a local log server.

  raw       A message containing only the text. The level, PID, date, time,
            process name and system name are omitted. This is designed to
            be used in containers or during development, where the severity
            only depends on the file descriptor used (stdout/stderr).

&lt;prof&gt;     name of the optional &quot;<a href="#log-profile">log-profile</a>&quot; section that will be
           considered during the log building process to override some
           log options. Check out &quot;8.3.5. Log profiles&quot; for more info.

&lt;facility&gt; must be one of the 24 standard syslog facilities :

               kern   user   mail   daemon auth   syslog lpr    news
               uucp   cron   auth2  ftp    ntp    audit  alert  cron2
               local0 local1 local2 local3 local4 local5 local6 local7

           Note that the facility is ignored for the &quot;short&quot; and &quot;raw&quot;
           formats, but still required as a positional field. It is
           recommended to use &quot;<a href="#daemon">daemon</a>&quot; in this case to make it clear that
           it's only supposed to be used locally.

&lt;level&gt;    is optional and can be specified to filter outgoing messages. By
           default, all messages are sent. If a level is specified, only
           messages with a severity at least as important as this level
           will be sent. An optional minimum level can be specified. If it
           is set, logs emitted with a more severe level than this one will
           be capped to this level. This is used to avoid sending &quot;emerg&quot;
           messages on all terminals on some default syslog configurations.
           Eight levels are known :

             emerg  alert  crit   err    warning notice info  debug</pre>
</div>
<pre class="text">It is important to keep in mind that it is the frontend which decides what to
log from a connection, and that in case of content switching, the log entries
from the backend will be ignored. Connections are logged at level &quot;info&quot;.

However, backend log declaration define how and where servers status changes
will be logged. Level &quot;notice&quot; will be used to indicate a server going up,
&quot;warning&quot; will be used for termination signals and definitive service
termination, and &quot;alert&quot; will be used for when a server goes down.

Note : According to RFC3164, messages are truncated to 1024 bytes before
       being emitted.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>log global
log stdout format short daemon          <span class="comment"># send log to systemd</span>
log stdout format raw daemon            <span class="comment"># send everything to stdout</span>
log stderr format raw daemon notice     <span class="comment"># send important events to stderr</span>
log 127.0.0.1:514 local0 notice         <span class="comment"># only send important events</span>
log tcp@127.0.0.1:514 local0 notice notice  <span class="comment"># same but limit output</span>
                                            <span class="comment"># level and send in tcp</span>
log &quot;${LOCAL_SYSLOG}:514&quot; local0 notice   <span class="comment"># send to local server</span>
</code></pre>
</div><a class="anchor" name="log-format"></a><a class="anchor" name="4-log-format"></a><a class="anchor" name="4.2-log-format"></a><a class="anchor" name="log-format (Proxies)"></a><a class="anchor" name="log-format (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="log-format"></a><a href="#4.2-log-format">log-format</a></b> <span style="color: #080">&lt;fmt&gt;</span></div><pre class="text">Specifies the custom log format string to use for traffic logs

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<pre class="text">This directive specifies the log format string that will be used for all logs
resulting from traffic passing through the frontend using this line. If the
directive is used in a defaults section, all subsequent frontends will use
the same log format. Please see <a href="#8.2.6">section 8.2.6</a> which covers the custom log
format string in depth.

A specific log-format used only in case of connection error can also be
defined, see the &quot;<a href="#error-log-format">error-log-format</a>&quot; option.

&quot;<a href="#log-format">log-format</a>&quot; directive overrides previous &quot;<a href="#option%20tcplog">option tcplog</a>&quot;, &quot;<a href="#log-format">log-format</a>&quot;,
&quot;<a href="#option%20httplog">option httplog</a>&quot; and &quot;<a href="#option%20httpslog">option httpslog</a>&quot; directives.
</pre><a class="anchor" name="log-format-sd"></a><a class="anchor" name="4-log-format-sd"></a><a class="anchor" name="4.2-log-format-sd"></a><a class="anchor" name="log-format-sd (Proxies)"></a><a class="anchor" name="log-format-sd (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="log-format-sd"></a><a href="#4.2-log-format-sd">log-format-sd</a></b> <span style="color: #080">&lt;fmt&gt;</span></div><pre class="text">Specifies the Custom log format string used to produce RFC5424 structured-data

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<pre class="text">This directive specifies the RFC5424 structured-data log format string that
will be used for all logs resulting from traffic passing through the frontend
using this line. If the directive is used in a defaults section, all
subsequent frontends will use the same log format. Please see <a href="#8.2.6">section 8.2.6</a>
which covers the log format string in depth.

See https://tools.ietf.org/html/rfc5424#section-6.3 for more information
about the RFC5424 structured-data part.

Note : This log format string will be used only for loggers that have set
       log format to &quot;rfc5424&quot;.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>log-format-sd [exampleSDID@1234\ bytes=\&quot;%B\&quot;\ status=\&quot;%ST\&quot;]
</code></pre>
</div><a class="anchor" name="log-steps"></a><a class="anchor" name="4-log-steps"></a><a class="anchor" name="4.2-log-steps"></a><a class="anchor" name="log-steps (Proxies)"></a><a class="anchor" name="log-steps (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="log-steps"></a><a href="#4.2-log-steps">log-steps</a></b> <span style="color: #080">&lt;steps&gt;</span></div><pre class="text">Specifies at which steps during transaction processing logs should be
generated.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<pre class="text">During tcp/http transaction processing, haproxy may produce logs at different
steps during the processing (ie: accept, connect, request, response, close).

By default, HAProxy emits a single log per transaction, once all of the
items used in the logformat expression could be satisfied, which means
that in practice the log is usually emitted at the end of the transaction
(after the end of the response for HTTP or end of connection for TCP),
unless &quot;<a href="#option%20logasap">option logasap</a>&quot; is used.

The &quot;<a href="#log-steps">log-steps</a>&quot; directive allows to refine the precise instants where
logs will be emitted, and even permits to emit multiple logs for a
same transaction. Special value 'all' may be used to enable all available
log origins, making it possible to track a transaction from accept to close.
Indidivual log origins may also be specified using their names separated by
spaces to selectively enable when logs should be produced.

Common log origins are: accept, connect, request, response, close.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>frontend myfront
    option httplog
    log-steps accept,close         <span class="comment">#only log accept and close for the txn</span>
</code></pre>
</div><pre class="text">Log origins specified as &quot;logging steps&quot; (such as accept, close) can be
used as-is in log-profiles (after 'on' directive). Combining &quot;<a href="#log-steps">log-steps</a>&quot;
with log-profiles is really interesting to have fine-grained control over
logs automatically generated by haproxy during transaction processing.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#log-profile">log-profile</a>&quot;</div>
<a class="anchor" name="log-tag"></a><a class="anchor" name="4-log-tag"></a><a class="anchor" name="4.2-log-tag"></a><a class="anchor" name="log-tag (Proxies)"></a><a class="anchor" name="log-tag (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="log-tag"></a><a href="#4.2-log-tag">log-tag</a></b> <span style="color: #080">&lt;string&gt;</span></div><pre class="text">Specifies the log tag to use for all outgoing logs

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">Sets the tag field in the syslog header to this string. It defaults to the
log-tag set in the global section, otherwise the program name as launched
from the command line, which usually is &quot;HAProxy&quot;. Sometimes it can be useful
to differentiate between multiple processes running on the same host, or to
differentiate customer instances running in the same process. In the backend,
logs about servers up/down will use this tag. As a hint, it can be convenient
to set a log-tag related to a hosted customer in a defaults section then put
all the frontends and backends for that customer, then start another customer
in a new defaults section. See also the global &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log-tag<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log-tag%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log-tag%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#log-tag%20%28Log%20profiles%29">Log profiles</a></li></ul></span>&quot; directive.
</pre><a class="anchor" name="max-keep-alive-queue"></a><a class="anchor" name="4-max-keep-alive-queue"></a><a class="anchor" name="4.2-max-keep-alive-queue"></a><a class="anchor" name="max-keep-alive-queue (Proxies)"></a><a class="anchor" name="max-keep-alive-queue (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="max-keep-alive-queue"></a><a href="#4.2-max-keep-alive-queue">max-keep-alive-queue</a></b> <span style="color: #080">&lt;value&gt;</span></div><pre class="text">Set the maximum server queue size for maintaining keep-alive connections

May be used in the following contexts: http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">HTTP keep-alive tries to reuse the same server connection whenever possible,
but sometimes it can be counter-productive, for example if a server has a lot
of connections while other ones are idle. This is especially true for static
servers.

The purpose of this setting is to set a threshold on the number of queued
connections at which HAProxy stops trying to reuse the same server and prefers
to find another one. The default value, -1, means there is no limit. A value
of zero means that keep-alive requests will never be queued. For very close
servers which can be reached with a low latency and which are not sensible to
breaking keep-alive, a low value is recommended (e.g. local static server can
use a value of 10 or less). For remote servers suffering from a high latency,
higher values might be needed to cover for the latency and/or the cost of
picking a different server.

Note that this has no impact on responses which are maintained to the same
server consecutively to a 401 response. They will still go to the same server
even if they have to be queued.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20http-server-close">option http-server-close</a>&quot;, &quot;<a href="#option%20prefer-last-server">option prefer-last-server</a>&quot;, server &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and cookie persistence.</div>
<a class="anchor" name="max-session-srv-conns"></a><a class="anchor" name="4-max-session-srv-conns"></a><a class="anchor" name="4.2-max-session-srv-conns"></a><a class="anchor" name="max-session-srv-conns (Proxies)"></a><a class="anchor" name="max-session-srv-conns (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="max-session-srv-conns"></a><a href="#4.2-max-session-srv-conns">max-session-srv-conns</a></b> <span style="color: #080">&lt;nb&gt;</span></div><pre class="text">Set the maximum number of outgoing connections we can keep idling for a given
client session. The default is 5 (it precisely equals MAX_SRV_LIST which is
defined at build time).

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<a class="anchor" name="maxconn"></a><a class="anchor" name="4-maxconn"></a><a class="anchor" name="4.2-maxconn"></a><a class="anchor" name="maxconn (Proxies)"></a><a class="anchor" name="maxconn (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="maxconn"></a><a href="#4.2-maxconn">maxconn</a></b> <span style="color: #080">&lt;conns&gt;</span></div><pre class="text">Fix the maximum number of concurrent connections on a frontend

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;conns&gt;   is the maximum number of concurrent connections the frontend will
          accept to serve. Excess connections will be queued by the system
          in the socket's listen queue and will be served once a connection
          closes.</pre>
</div>
<pre class="text">If the system supports it, it can be useful on big sites to raise this limit
very high so that HAProxy manages connection queues, instead of leaving the
clients with unanswered connection attempts. This value should not exceed the
global maxconn. Also, keep in mind that a connection contains two buffers
of tune.bufsize (16kB by default) each, as well as some other data resulting
in about 33 kB of RAM being consumed per established connection. That means
that a medium system equipped with 1GB of RAM can withstand around
20000-25000 concurrent connections if properly tuned.

Also, when &lt;conns&gt; is set to large values, it is possible that the servers
are not sized to accept such loads, and for this reason it is generally wise
to assign them some reasonable connection limits.

When this value is set to zero, which is the default, the global &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
value is used.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, global section's &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;, &quot;<a href="#fullconn">fullconn</a>&quot;</div>
<a class="anchor" name="mode"></a><a class="anchor" name="4-mode"></a><a class="anchor" name="4.2-mode"></a><a class="anchor" name="mode (Proxies)"></a><a class="anchor" name="mode (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="mode"></a><a href="#4.2-mode">mode</a></b> <span style="color: #800">{ tcp|http|log|spop }</span></div><pre class="text">Set the running mode or protocol of the instance
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">tcp       The instance will work in pure TCP mode. A full-duplex connection
          will be established between clients and servers, and no layer 7
          examination will be performed. This is the default mode. It
          should be used for SSL, SSH, SMTP, ...

http      The instance will work in HTTP mode. The client request will be
          analyzed in depth before connecting to any server. Any request
          which is not RFC-compliant will be rejected. Layer 7 filtering,
          processing and switching will be possible. This is the mode which
          brings HAProxy most of its value.

log       When used in a backend section, it will turn the backend into a
          log backend. Such backend can be used as a log destination for
          any &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive by using the &quot;backend@&lt;name&gt;&quot; syntax. Log
          messages will be distributed to the servers from the backend
          according to the lb settings which can be configured using the
          &quot;<a href="#balance">balance</a>&quot; keyword. Log backends support UDP servers by prefixing
          the server's address with the &quot;udp@&quot; prefix. Common backend and
          server features are supported, but not TCP or HTTP specific ones.

spop      When used in a backend section, it will turn the backend into a
          log backend. This mode is mandatory and automatically set, if
          necessary, for backends referenced by SPOE engines.</pre>
</div>
<pre class="text">When doing content switching, it is mandatory that the frontend and the
backend are in the same mode (generally HTTP), otherwise the configuration
will be refused.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>defaults http_instances
    mode http
</code></pre>
</div><a class="anchor" name="monitor"></a><a class="anchor" name="4-monitor"></a><a class="anchor" name="4.2-monitor"></a><a class="anchor" name="monitor (Proxies)"></a><a class="anchor" name="monitor (Alphabetically sorted keywords reference)"></a><a class="anchor" name="monitor fail"></a><a class="anchor" name="4-monitor fail"></a><a class="anchor" name="4.2-monitor fail"></a><a class="anchor" name="monitor fail (Proxies)"></a><a class="anchor" name="monitor fail (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="monitor fail"></a><a href="#4.2-monitor%20fail">monitor fail</a></b> <span style="color: #800">{ if | unless }</span> <span style="color: #080">&lt;condition&gt;</span></div><pre class="text">Add a condition to report a failure to a monitor HTTP request.

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">if &lt;cond&gt;     the monitor request will fail if the condition is satisfied,
              and will succeed otherwise. The condition should describe a
              combined test which must induce a failure if all conditions
              are met, for instance a low number of servers both in a
              backend and its backup.

unless &lt;cond&gt; the monitor request will succeed only if the condition is
              satisfied, and will fail otherwise. Such a condition may be
              based on a test on the presence of a minimum number of active
              servers in a list of backends.</pre>
</div>
<pre class="text">This statement adds a condition which can force the response to a monitor
request to report a failure. By default, when an external component queries
the URI dedicated to monitoring, a 200 response is returned. When one of the
conditions above is met, HAProxy will return 503 instead of 200. This is
very useful to report a site failure to an external component which may base
routing advertisements between multiple sites on the availability reported by
HAProxy. In this case, one would rely on an ACL involving the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">nbsrv<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#nbsrv%20%28Converters%29">Converters</a></li><li><a href="#nbsrv%20%28Fetching%20samples%20from%20internal%20states%29">Fetching samples from internal states</a></li></ul></span>&quot;
criterion. Note that &quot;<a href="#monitor%20fail">monitor fail</a>&quot; only works in HTTP mode. Both status
messages may be tweaked using &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">errorfile<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#errorfile%20%28HTTP-errors%29">HTTP-errors</a></li><li><a href="#errorfile%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; or &quot;<a href="#errorloc">errorloc</a>&quot; if needed.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>frontend www
   mode http
   acl site_dead nbsrv(dynamic) lt 2
   acl site_dead nbsrv(static)  lt 2
   monitor-uri   /site_alive
   monitor fail  if site_dead
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#monitor-uri">monitor-uri</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">errorfile<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#errorfile%20%28HTTP-errors%29">HTTP-errors</a></li><li><a href="#errorfile%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#errorloc">errorloc</a>&quot;</div>
<a class="anchor" name="monitor-uri"></a><a class="anchor" name="4-monitor-uri"></a><a class="anchor" name="4.2-monitor-uri"></a><a class="anchor" name="monitor-uri (Proxies)"></a><a class="anchor" name="monitor-uri (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="monitor-uri"></a><a href="#4.2-monitor-uri">monitor-uri</a></b> <span style="color: #080">&lt;uri&gt;</span></div><pre class="text">Intercept a URI used by external components' monitor requests

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;uri&gt;     is the exact URI which we want to intercept to return HAProxy's
          health status instead of forwarding the request.</pre>
</div>
<pre class="text">When an HTTP request referencing &lt;uri&gt; will be received on a frontend,
HAProxy will not forward it nor log it, but instead will return either
&quot;HTTP/1.0 200 OK&quot; or &quot;HTTP/1.0 503 Service unavailable&quot;, depending on failure
conditions defined with &quot;<a href="#monitor%20fail">monitor fail</a>&quot;. This is normally enough for any
front-end HTTP probe to detect that the service is UP and running without
forwarding the request to a backend server. Note that the HTTP method, the
version and all headers are ignored, but the request must at least be valid
at the HTTP level. This keyword may only be used with an HTTP-mode frontend.

Monitor requests are processed very early, just after the request is parsed
and even before any &quot;<a href="#http-request">http-request</a>&quot;. The only rulesets applied before are the
tcp-request ones. They cannot be logged either, and it is the intended
purpose. Only one URI may be configured for monitoring; when multiple
&quot;<a href="#monitor-uri">monitor-uri</a>&quot; statements are present, the last one will define the URI to
be used. They are only used to report HAProxy's health to an upper component,
nothing more. However, it is possible to add any number of conditions using
&quot;<a href="#monitor%20fail">monitor fail</a>&quot; and ACLs so that the result can be adjusted to whatever check
can be imagined (most often the number of available servers in a backend).

Note: if &lt;uri&gt; starts by a slash ('/'), the matching is performed against the
      request's path instead of the request's uri. It is a workaround to let
      the HTTP/2 requests match the monitor-uri. Indeed, in HTTP/2, clients
      are encouraged to send absolute URIs only.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># Use /haproxy_test to report HAProxy's status</span>
frontend www
    mode http
    monitor-uri /haproxy_test
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#monitor%20fail">monitor fail</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option abortonclose"></a><a class="anchor" name="4-option abortonclose"></a><a class="anchor" name="4.2-option abortonclose"></a><a class="anchor" name="option abortonclose (Proxies)"></a><a class="anchor" name="option abortonclose (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option abortonclose"></a><a href="#4.2-option%20abortonclose">option abortonclose</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option abortonclose"></a><a class="anchor" name="4-no option abortonclose"></a><a class="anchor" name="4.2-no option abortonclose"></a><a class="anchor" name="no option abortonclose (Proxies)"></a><a class="anchor" name="no option abortonclose (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option abortonclose"></a><a href="#4.2-no%20option%20abortonclose">no option abortonclose</a></b></div><pre class="text">Enable or disable early dropping of aborted requests pending in queues.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">In presence of very high loads, the servers will take some time to respond.
The per-instance connection queue will inflate, and the response time will
increase respective to the size of the queue times the average per-stream
response time. When clients will wait for more than a few seconds, they will
often hit the &quot;STOP&quot; button on their browser, leaving a useless request in
the queue, and slowing down other users, and the servers as well, because the
request will eventually be served, then aborted at the first error
encountered while delivering the response.

As there is no way to distinguish between a full STOP and a simple output
close on the client side, HTTP agents should be conservative and consider
that the client might only have closed its output channel while waiting for
the response. However, this introduces risks of congestion when lots of users
do the same, and is completely useless nowadays because probably no client at
all will close the stream while waiting for the response. Some HTTP agents
support this behavior (Squid, Apache, HAProxy), and others do not (TUX, most
hardware-based load balancers). So the probability for a closed input channel
to represent a user hitting the &quot;STOP&quot; button is close to 100%, and the risk
of being the single component to break rare but valid traffic is extremely
low, which adds to the temptation to be able to abort a stream early while
still not served and not pollute the servers.

In HAProxy, the user can choose the desired behavior using the option
&quot;<a href="#option%20abortonclose">abortonclose</a>&quot;. By default (without the option) the behavior is HTTP
compliant and aborted requests will be served. But when the option is
specified, a stream with an incoming channel closed will be aborted while
it is still possible, either pending in the queue for a connection slot, or
during the connection establishment if the server has not yet acknowledged
the connection request. This considerably reduces the queue size and the load
on saturated servers when users are tempted to click on STOP, which in turn
reduces the response time for other users.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#timeout%20queue">timeout queue</a>&quot; and server's &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and &quot;<a href="#maxqueue">maxqueue</a>&quot; parameters</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option accept-invalid-http-request"></a><a class="anchor" name="4-option accept-invalid-http-request"></a><a class="anchor" name="4.2-option accept-invalid-http-request"></a><a class="anchor" name="option accept-invalid-http-request (Proxies)"></a><a class="anchor" name="option accept-invalid-http-request (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option accept-invalid-http-request"></a><a href="#4.2-option%20accept-invalid-http-request">option accept-invalid-http-request</a></b>     <span class="label label-warning">(deprecated)</span></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option accept-invalid-http-request"></a><a class="anchor" name="4-no option accept-invalid-http-request"></a><a class="anchor" name="4.2-no option accept-invalid-http-request"></a><a class="anchor" name="no option accept-invalid-http-request (Proxies)"></a><a class="anchor" name="no option accept-invalid-http-request (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option accept-invalid-http-request"></a><a href="#4.2-no%20option%20accept-invalid-http-request">no option accept-invalid-http-request</a></b>  <span class="label label-warning">(deprecated)</span></div><pre class="text">Enable or disable relaxing of HTTP request parsing

The &quot;<a href="#option%20accept-invalid-http-request">accept-invalid-http-request</a>&quot; keyword is deprecated, use &quot;option
accept-unsafe-violations-in-http-request&quot; instead.
</pre><a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option accept-invalid-http-response"></a><a class="anchor" name="4-option accept-invalid-http-response"></a><a class="anchor" name="4.2-option accept-invalid-http-response"></a><a class="anchor" name="option accept-invalid-http-response (Proxies)"></a><a class="anchor" name="option accept-invalid-http-response (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option accept-invalid-http-response"></a><a href="#4.2-option%20accept-invalid-http-response">option accept-invalid-http-response</a></b>     <span class="label label-warning">(deprecated)</span></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option accept-invalid-http-response"></a><a class="anchor" name="4-no option accept-invalid-http-response"></a><a class="anchor" name="4.2-no option accept-invalid-http-response"></a><a class="anchor" name="no option accept-invalid-http-response (Proxies)"></a><a class="anchor" name="no option accept-invalid-http-response (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option accept-invalid-http-response"></a><a href="#4.2-no%20option%20accept-invalid-http-response">no option accept-invalid-http-response</a></b>  <span class="label label-warning">(deprecated)</span></div><pre class="text">Enable or disable relaxing of HTTP response parsing

The &quot;<a href="#option%20accept-invalid-http-response">accept-invalid-http-response</a>&quot; keyword is deprecated, use &quot;option
accept-unsafe-violations-in-http-response&quot; instead.
</pre><a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option accept-unsafe-violations-in-http-request"></a><a class="anchor" name="4-option accept-unsafe-violations-in-http-request"></a><a class="anchor" name="4.2-option accept-unsafe-violations-in-http-request"></a><a class="anchor" name="option accept-unsafe-violations-in-http-request (Proxies)"></a><a class="anchor" name="option accept-unsafe-violations-in-http-request (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option accept-unsafe-violations-in-http-request"></a><a href="#4.2-option%20accept-unsafe-violations-in-http-request">option accept-unsafe-violations-in-http-request</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option accept-unsafe-violations-in-http-request"></a><a class="anchor" name="4-no option accept-unsafe-violations-in-http-request"></a><a class="anchor" name="4.2-no option accept-unsafe-violations-in-http-request"></a><a class="anchor" name="no option accept-unsafe-violations-in-http-request (Proxies)"></a><a class="anchor" name="no option accept-unsafe-violations-in-http-request (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option accept-unsafe-violations-in-http-request"></a><a href="#4.2-no%20option%20accept-unsafe-violations-in-http-request">no option accept-unsafe-violations-in-http-request</a></b></div><pre class="text">Enable or disable relaxing of HTTP request parsing

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">By default, HAProxy complies with the different HTTP RFCs in terms of message
parsing. This means the message parsing is quite strict and causes an error
to be returned to the client for malformed messages. This is the desired
behavior as such malformed messages are essentially used to build attacks
exploiting server weaknesses, and bypass security filtering. Sometimes, a
buggy browser will not respect these RCFs for whatever reason (configuration,
implementation...) and the issue will not be immediately fixed. In such case,
it is possible to relax HAProxy's parser to accept some invalid requests by
specifying this option. Most of rules concern the H1 parsing for historical
reason. Newer HTTP versions tends to be cleaner and applications follow more
stickly these protocols.

When this option is set, the following rules are observed:

  * In H1 only, invalid characters, including NULL character, in header name
    will be accepted;

  * In H1 only, NULL character in header value will be accepted;

  * The list of characters allowed to appear in a URI is well defined by
    RFC3986, and chars 0-31, 32 (space), 34 ('&quot;'), 60 ('&lt;'), 62 ('&gt;'), 92
    ('\'), 94 ('^'), 96 ('`'), 123 ('{'), 124 ('|'), 125 ('}'), 127 (delete)
    and anything above are normally not allowed. But here, in H1 only,
    HAProxy will only block a number of them (0..32, 127);

  * In H1 and H2, URLs containing fragment references ('#' after the path)
    will be accepted;

  * In H1 only, no check will be performed on the authority for CONNECT
    requests;

  * In H1 only, no check will be performed against the authority and the Host
    header value.

  * In H1 only, tests on the HTTP version will be relaxed. It will allow
    HTTP/0.9 GET requests to pass through (no version specified), as well as
    different protocol names (e.g. RTSP), and multiple digits for both the
    major and the minor version.

This option should never be enabled by default as it hides application bugs
and open security breaches. It should only be deployed after a problem has
been confirmed.

When this option is enabled, invalid but accepted H1 requests will be
captured in order to permit later analysis using the &quot;show errors&quot; request on
the UNIX stats socket.Doing this also helps confirming that the issue has
been solved.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20accept-unsafe-violations-in-http-response">option accept-unsafe-violations-in-http-response</a>&quot; and &quot;show errors&quot; on the stats socket.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option accept-unsafe-violations-in-http-response"></a><a class="anchor" name="4-option accept-unsafe-violations-in-http-response"></a><a class="anchor" name="4.2-option accept-unsafe-violations-in-http-response"></a><a class="anchor" name="option accept-unsafe-violations-in-http-response (Proxies)"></a><a class="anchor" name="option accept-unsafe-violations-in-http-response (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option accept-unsafe-violations-in-http-response"></a><a href="#4.2-option%20accept-unsafe-violations-in-http-response">option accept-unsafe-violations-in-http-response</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option accept-unsafe-violations-in-http-response"></a><a class="anchor" name="4-no option accept-unsafe-violations-in-http-response"></a><a class="anchor" name="4.2-no option accept-unsafe-violations-in-http-response"></a><a class="anchor" name="no option accept-unsafe-violations-in-http-response (Proxies)"></a><a class="anchor" name="no option accept-unsafe-violations-in-http-response (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option accept-unsafe-violations-in-http-response"></a><a href="#4.2-no%20option%20accept-unsafe-violations-in-http-response">no option accept-unsafe-violations-in-http-response</a></b></div><pre class="text">Enable or disable relaxing of HTTP response parsing

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">Similarly to &quot;<a href="#option%20accept-unsafe-violations-in-http-request">option accept-unsafe-violations-in-http-request</a>&quot;, this option
may be used to relax parsing rules of HTTP responses. It should only be
enabled for trusted legacy servers to accept some invalid responses. Most of
rules concern the H1 parsing for historical reason. Newer HTTP versions tends
to be cleaner and applications follow more stickly these protocols.

When this option is set, the following rules are observed:

  * In H1 only, invalid characters, including NULL character, in header name
    will be accepted;

  * In H1 only, NULL character in header value will be accepted;

  * In H1 only, empty values or several &quot;chunked&quot; value occurrences for
    Transfer-Encoding header will be accepted;

  * In H1 only, no check will be performed against the authority and the Host
    header value.

  * In H1 only, tests on the HTTP version will be relaxed. It will allow
    different protocol names (e.g. RTSP), and multiple digits for both the
    major and the minor version.

This option should never be enabled by default as it hides application bugs
and open security breaches. It should only be deployed after a problem has
been confirmed.

When this option is enabled, erroneous header names will still be accepted in
responses, but the complete response will be captured in order to permit
later analysis using the &quot;show errors&quot; request on the UNIX stats socket.
Doing this also helps confirming that the issue has been solved.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20accept-unsafe-violations-in-http-request">option accept-unsafe-violations-in-http-request</a>&quot; and &quot;show errors&quot; on the stats socket.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option allbackups"></a><a class="anchor" name="4-option allbackups"></a><a class="anchor" name="4.2-option allbackups"></a><a class="anchor" name="option allbackups (Proxies)"></a><a class="anchor" name="option allbackups (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option allbackups"></a><a href="#4.2-option%20allbackups">option allbackups</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option allbackups"></a><a class="anchor" name="4-no option allbackups"></a><a class="anchor" name="4.2-no option allbackups"></a><a class="anchor" name="no option allbackups (Proxies)"></a><a class="anchor" name="no option allbackups (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option allbackups"></a><a href="#4.2-no%20option%20allbackups">no option allbackups</a></b></div><pre class="text">Use either all backup servers at a time or only the first one

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">By default, the first operational backup server gets all traffic when normal
servers are all down. Sometimes, it may be preferred to use multiple backups
at once, because one will not be enough. When &quot;<a href="#option%20allbackups">option allbackups</a>&quot; is enabled,
the load balancing will be performed among all backup servers when all normal
ones are unavailable. The same load balancing algorithm will be used and the
servers' weights will be respected. Thus, there will not be any priority
order between the backup servers anymore.

This option is mostly used with static server farms dedicated to return a
&quot;sorry&quot; page when an application is completely offline.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option checkcache"></a><a class="anchor" name="4-option checkcache"></a><a class="anchor" name="4.2-option checkcache"></a><a class="anchor" name="option checkcache (Proxies)"></a><a class="anchor" name="option checkcache (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option checkcache"></a><a href="#4.2-option%20checkcache">option checkcache</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option checkcache"></a><a class="anchor" name="4-no option checkcache"></a><a class="anchor" name="4.2-no option checkcache"></a><a class="anchor" name="no option checkcache (Proxies)"></a><a class="anchor" name="no option checkcache (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option checkcache"></a><a href="#4.2-no%20option%20checkcache">no option checkcache</a></b></div><pre class="text">Analyze all server responses and block responses with cacheable cookies

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">Some high-level frameworks set application cookies everywhere and do not
always let enough control to the developer to manage how the responses should
be cached. When a session cookie is returned on a cacheable object, there is a
high risk of session crossing or stealing between users traversing the same
caches. In some situations, it is better to block the response than to let
some sensitive session information go in the wild.

The option &quot;<a href="#option%20checkcache">checkcache</a>&quot; enables deep inspection of all server responses for
strict compliance with HTTP specification in terms of cacheability. It
carefully checks &quot;Cache-control&quot;, &quot;Pragma&quot; and &quot;Set-cookie&quot; headers in server
response to check if there's a risk of caching a cookie on a client-side
proxy. When this option is enabled, the only responses which can be delivered
to the client are :
  - all those without &quot;Set-Cookie&quot; header;
  - all those with a return code other than 200, 203, 204, 206, 300, 301,
    404, 405, 410, 414, 501, provided that the server has not set a
    &quot;Cache-control: public&quot; header field;
  - all those that result from a request using a method other than GET, HEAD,
    OPTIONS, TRACE, provided that the server has not set a 'Cache-Control:
    public' header field;
  - those with a 'Pragma: no-cache' header
  - those with a 'Cache-control: private' header
  - those with a 'Cache-control: no-store' header
  - those with a 'Cache-control: max-age=0' header
  - those with a 'Cache-control: s-maxage=0' header
  - those with a 'Cache-control: no-cache' header
  - those with a 'Cache-control: no-cache=&quot;<a href="#set-cookie">set-cookie</a>&quot;' header
  - those with a 'Cache-control: no-cache=&quot;set-cookie,' header
    (allowing other fields after set-cookie)

If a response doesn't respect these requirements, then it will be blocked
just as if it was from an &quot;http-response deny&quot; rule, with an &quot;HTTP 502 bad
gateway&quot;. The session state shows &quot;PH--&quot; meaning that the proxy blocked the
response during headers processing. Additionally, an alert will be sent in
the logs so that admins are informed that there's something to be fixed.

Due to the high impact on the application, the application should be tested
in depth with the option enabled before going to production. It is also a
good practice to always activate it during tests, even if it is not used in
production, as it will report potentially dangerous application behaviors.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option clitcpka"></a><a class="anchor" name="4-option clitcpka"></a><a class="anchor" name="4.2-option clitcpka"></a><a class="anchor" name="option clitcpka (Proxies)"></a><a class="anchor" name="option clitcpka (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option clitcpka"></a><a href="#4.2-option%20clitcpka">option clitcpka</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option clitcpka"></a><a class="anchor" name="4-no option clitcpka"></a><a class="anchor" name="4.2-no option clitcpka"></a><a class="anchor" name="no option clitcpka (Proxies)"></a><a class="anchor" name="no option clitcpka (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option clitcpka"></a><a href="#4.2-no%20option%20clitcpka">no option clitcpka</a></b></div><pre class="text">Enable or disable the sending of TCP keepalive packets on the client side

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">When there is a firewall or any session-aware component between a client and
a server, and when the protocol involves very long sessions with long idle
periods (e.g. remote desktops), there is a risk that one of the intermediate
components decides to expire a session which has remained idle for too long.

Enabling socket-level TCP keep-alives makes the system regularly send packets
to the other end of the connection, leaving it active. The delay between
keep-alive probes is controlled by the system only and depends both on the
operating system and its tuning parameters.

It is important to understand that keep-alive packets are neither emitted nor
received at the application level. It is only the network stacks which sees
them. For this reason, even if one side of the proxy already uses keep-alives
to maintain its connection alive, those keep-alive packets will not be
forwarded to the other side of the proxy.

Please note that this has nothing to do with HTTP keep-alive.

Using option &quot;<a href="#option%20clitcpka">clitcpka</a>&quot; enables the emission of TCP keep-alive probes on the
client side of a connection, which should help when session expirations are
noticed between HAProxy and a client.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20srvtcpka">option srvtcpka</a>&quot;, &quot;<a href="#option%20tcpka">option tcpka</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option contstats"></a><a class="anchor" name="4-option contstats"></a><a class="anchor" name="4.2-option contstats"></a><a class="anchor" name="option contstats (Proxies)"></a><a class="anchor" name="option contstats (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option contstats"></a><a href="#4.2-option%20contstats">option contstats</a></b></div><pre class="text">Enable continuous traffic statistics updates

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">By default, counters used for statistics calculation are incremented
only when a stream finishes. It works quite well when serving small
objects, but with big ones (for example large images or archives) or
with A/V streaming, a graph generated from HAProxy counters looks like
a hedgehog. With this option enabled counters get incremented frequently
along the stream, typically every 5 seconds, which is often enough to
produce clean graphs. Recounting touches a hotpath directly so it is not
not enabled by default, as it can cause a lot of wakeups for very large
session counts and cause a small performance drop.
</pre><a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option disable-h2-upgrade"></a><a class="anchor" name="4-option disable-h2-upgrade"></a><a class="anchor" name="4.2-option disable-h2-upgrade"></a><a class="anchor" name="option disable-h2-upgrade (Proxies)"></a><a class="anchor" name="option disable-h2-upgrade (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option disable-h2-upgrade"></a><a href="#4.2-option%20disable-h2-upgrade">option disable-h2-upgrade</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option disable-h2-upgrade"></a><a class="anchor" name="4-no option disable-h2-upgrade"></a><a class="anchor" name="4.2-no option disable-h2-upgrade"></a><a class="anchor" name="no option disable-h2-upgrade (Proxies)"></a><a class="anchor" name="no option disable-h2-upgrade (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option disable-h2-upgrade"></a><a href="#4.2-no%20option%20disable-h2-upgrade">no option disable-h2-upgrade</a></b></div><pre class="text">Enable or disable the implicit HTTP/2 upgrade from an HTTP/1.x client
connection.

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">By default, HAProxy is able to implicitly upgrade an HTTP/1.x client
connection to an HTTP/2 connection if the first request it receives from a
given HTTP connection matches the HTTP/2 connection preface (i.e. the string
&quot;PRI * HTTP/2.0\r\n\r\nSM\r\n\r\n&quot;). This way, it is possible to support
HTTP/1.x and HTTP/2 clients on a non-SSL connections. This option must be
used to disable the implicit upgrade. Note this implicit upgrade is only
supported for HTTP proxies, thus this option too. Note also it is possible to
force the HTTP/2 on clear connections by specifying &quot;proto h2&quot; on the bind
line. Finally, this option is applied on all bind lines. To disable implicit
HTTP/2 upgrades for a specific bind line, it is possible to use &quot;proto h1&quot;.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option dontlog-normal"></a><a class="anchor" name="4-option dontlog-normal"></a><a class="anchor" name="4.2-option dontlog-normal"></a><a class="anchor" name="option dontlog-normal (Proxies)"></a><a class="anchor" name="option dontlog-normal (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option dontlog-normal"></a><a href="#4.2-option%20dontlog-normal">option dontlog-normal</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option dontlog-normal"></a><a class="anchor" name="4-no option dontlog-normal"></a><a class="anchor" name="4.2-no option dontlog-normal"></a><a class="anchor" name="no option dontlog-normal (Proxies)"></a><a class="anchor" name="no option dontlog-normal (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option dontlog-normal"></a><a href="#4.2-no%20option%20dontlog-normal">no option dontlog-normal</a></b></div><pre class="text">Enable or disable logging of normal, successful connections

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">There are large sites dealing with several thousand connections per second
and for which logging is a major pain. Some of them are even forced to turn
logs off and cannot debug production issues. Setting this option ensures that
normal connections, those which experience no error, no timeout, no retry nor
redispatch, will not be logged. This leaves disk space for anomalies. In HTTP
mode, the response status code is checked and return codes 5xx will still be
logged.

It is strongly discouraged to use this option as most of the time, the key to
complex issues is in the normal logs which will not be logged here. If you
need to separate logs, see the &quot;<a href="#option%20log-separate-errors">log-separate-errors</a>&quot; option instead.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#option%20dontlognull">dontlognull</a>&quot;, &quot;<a href="#option%20log-separate-errors">log-separate-errors</a>&quot; and <a href="#8">section 8</a> about logging.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option dontlognull"></a><a class="anchor" name="4-option dontlognull"></a><a class="anchor" name="4.2-option dontlognull"></a><a class="anchor" name="option dontlognull (Proxies)"></a><a class="anchor" name="option dontlognull (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option dontlognull"></a><a href="#4.2-option%20dontlognull">option dontlognull</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option dontlognull"></a><a class="anchor" name="4-no option dontlognull"></a><a class="anchor" name="4.2-no option dontlognull"></a><a class="anchor" name="no option dontlognull (Proxies)"></a><a class="anchor" name="no option dontlognull (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option dontlognull"></a><a href="#4.2-no%20option%20dontlognull">no option dontlognull</a></b></div><pre class="text">Enable or disable logging of null connections

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">In certain environments, there are components which will regularly connect to
various systems to ensure that they are still alive. It can be the case from
another load balancer as well as from monitoring systems. By default, even a
simple port probe or scan will produce a log. If those connections pollute
the logs too much, it is possible to enable option &quot;<a href="#option%20dontlognull">dontlognull</a>&quot; to indicate
that a connection on which no data has been transferred will not be logged,
which typically corresponds to those probes. Note that errors will still be
returned to the client and accounted for in the stats. If this is not what is
desired, option http-ignore-probes can be used instead.

It is generally recommended not to use this option in uncontrolled
environments (e.g. internet), otherwise scans and other malicious activities
would not be logged.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#option%20http-ignore-probes">http-ignore-probes</a>&quot;, &quot;<a href="#monitor-uri">monitor-uri</a>&quot;, and <a href="#8">section 8</a> about logging.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option forwarded"></a><a class="anchor" name="4-option forwarded"></a><a class="anchor" name="4.2-option forwarded"></a><a class="anchor" name="option forwarded (Proxies)"></a><a class="anchor" name="option forwarded (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option forwarded"></a><a href="#4.2-option%20forwarded">option forwarded</a></b> <span style="color: #008">[ proto ]</span>
                 <span style="color: #008">[ host | host-expr <span style="color: #080">&lt;host_expr&gt;</span> ]</span>
                 <span style="color: #008">[ by | by-expr <span style="color: #080">&lt;by_expr&gt;</span> ]</span> <span style="color: #008">[ by_port | by_port-expr <span style="color: #080">&lt;by_port_expr&gt;</span>]</span>
                 <span style="color: #008">[ for | for-expr <span style="color: #080">&lt;for_expr&gt;</span> ]</span> <span style="color: #008">[ for_port | for_port-expr <span style="color: #080">&lt;for_port_expr&gt;</span>]</span></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option forwarded"></a><a class="anchor" name="4-no option forwarded"></a><a class="anchor" name="4.2-no option forwarded"></a><a class="anchor" name="no option forwarded (Proxies)"></a><a class="anchor" name="no option forwarded (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option forwarded"></a><a href="#4.2-no%20option%20forwarded">no option forwarded</a></b></div><pre class="text">Enable insertion of the rfc 7239 forwarded header in requests sent to servers

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;host_expr&gt;     optional argument to specify a custom sample expression
                those result will be used as 'host' parameter value

&lt;by_expr&gt;       optional argument to specify a custom sample expression
                those result will be used as 'by' parameter nodename value

&lt;for_expr&gt;      optional argument to specify a custom sample expression
                those result will be used as 'for' parameter nodename value

&lt;by_port_expr&gt;  optional argument to specify a custom sample expression
                those result will be used as 'by' parameter nodeport value

&lt;for_port_expr&gt; optional argument to specify a custom sample expression
                those result will be used as 'for' parameter nodeport value</pre>
</div>
<pre class="text">Since HAProxy works in reverse-proxy mode, servers are losing some request
context (request origin: client ip address, protocol used...)

A common way to address this limitation is to use the well known
x-forward-for and x-forward-* friends to expose some of this context to the
underlying servers/applications.
While this use to work and is widely deployed, it is not officially supported
by the IETF and can be the root of some interoperability as well as security
issues.

To solve this, a new HTTP extension has been described by the IETF:
forwarded header (RFC7239).
More information here: https://www.rfc-editor.org/rfc/rfc7239.html

The use of this single header allow to convey numerous details
within the same header, and most importantly, fixes the proxy chaining
issue. (the rfc allows for multiple chained proxies to append their own
values to an already existing header).

This option may be specified in defaults, listen or backend section, but it
will be ignored for frontend sections.

Setting option forwarded without arguments results in using default implicit
behavior.
Default behavior enables proto parameter and injects original client ip.

The equivalent explicit/manual configuration would be:
      option forwarded proto for

The keyword 'by' is used to enable 'by' parameter (&quot;nodename&quot;) in
forwarded header. It allows to embed request proxy information.
'by' value will be set to proxy ip (destination address)
If not available (ie: UNIX listener), 'by' will be set to
&quot;unknown&quot;.

The keyword 'by-expr' is used to enable 'by' parameter (&quot;nodename&quot;) in
forwarded header. It allows to embed request proxy information.
'by' value will be set to the result of the sample expression
&lt;by_expr&gt;, if valid, otherwise it will be set to &quot;unknown&quot;.

The keyword 'for' is used to enable 'for' parameter (&quot;nodename&quot;) in
forwarded header. It allows to embed request client information.
'for' value will be set to client ip (source address)
If not available (ie: UNIX listener), 'for' will be set to
&quot;unknown&quot;.

The keyword 'for-expr' is used to enable 'for' parameter (&quot;nodename&quot;) in
forwarded header. It allows to embed request client information.
'for' value will be set to the result of the sample expression
&lt;for_expr&gt;, if valid, otherwise it will be set to &quot;unknown&quot;.

The keyword 'by_port' is used to provide &quot;nodeport&quot; info to
'by' parameter. 'by_port' requires 'by' or 'by-expr' to be set or
it will be ignored.
&quot;nodeport&quot; will be set to proxy (destination) port if available,
otherwise it will be ignored.

The keyword 'by_port-expr' is used to provide &quot;nodeport&quot; info to
'by' parameter. 'by_port-expr' requires 'by' or 'by-expr' to be set or
it will be ignored.
&quot;nodeport&quot; will be set to the result of the sample expression
&lt;by_port_expr&gt;, if valid, otherwise it will be ignored.

The keyword 'for_port' is used to provide &quot;nodeport&quot; info to
'for' parameter. 'for_port' requires 'for' or 'for-expr' to be set or
it will be ignored.
&quot;nodeport&quot; will be set to client (source) port if available,
otherwise it will be ignored.

The keyword 'for_port-expr' is used to provide &quot;nodeport&quot; info to
'for' parameter. 'for_port-expr' requires 'for' or 'for-expr' to be set or
it will be ignored.
&quot;nodeport&quot; will be set to the result of the sample expression
&lt;for_port_expr&gt;, if valid, otherwise it will be ignored.
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code><span class="comment"># Those servers want the ip address and protocol of the client request</span>
<span class="comment"># Resulting header would look like this:</span>
<span class="comment">#   forwarded: proto=http;for=127.0.0.1</span>
backend www_default
    mode http
    option forwarded
    <span class="comment">#equivalent to: option forwarded proto for</span>

<span class="comment"># Those servers want the requested host and hashed client ip address</span>
<span class="comment"># as well as client source port (you should use seed for xxh32 if ensuring</span>
<span class="comment"># ip privacy is a concern)</span>
<span class="comment"># Resulting header would look like this:</span>
<span class="comment">#   forwarded: host=&quot;haproxy.org&quot;;for=&quot;_000000007F2F367E:60138&quot;</span>
backend www_host
    mode http
    option forwarded host for-expr src,xxh32,hex for_port

<span class="comment"># Those servers want custom data in host, for and by parameters</span>
<span class="comment"># Resulting header would look like this:</span>
<span class="comment">#   forwarded: host=&quot;host.com&quot;;by=_haproxy;for=&quot;[::1]:10&quot;</span>
backend www_custom
    mode http
    option forwarded host-expr str(host.com) by-expr str(_haproxy) for for_port-expr int(10)

<span class="comment"># Those servers want random 'for' obfuscated identifiers for request</span>
<span class="comment"># tracing purposes while protecting sensitive IP information</span>
<span class="comment"># Resulting header would look like this:</span>
<span class="comment">#   forwarded: for=_000000002B1F4D63</span>
backend www_for_hide
    mode http
    option forwarded for-expr rand,hex
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#option%20forwardfor">option forwardfor</a>&quot;, &quot;<a href="#option%20originalto">option originalto</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option forwardfor"></a><a class="anchor" name="4-option forwardfor"></a><a class="anchor" name="4.2-option forwardfor"></a><a class="anchor" name="option forwardfor (Proxies)"></a><a class="anchor" name="option forwardfor (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option forwardfor"></a><a href="#4.2-option%20forwardfor">option forwardfor</a></b> <span style="color: #008">[ except <span style="color: #080">&lt;network&gt;</span> ]</span> <span style="color: #008">[ header <span style="color: #080">&lt;name&gt;</span> ]</span> <span style="color: #008">[ if-none ]</span></div><pre class="text">Enable insertion of the X-Forwarded-For header to requests sent to servers

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;network&gt; is an optional argument used to disable this option for sources
          matching &lt;network&gt;
&lt;name&gt;    an optional argument to specify a different &quot;X-Forwarded-For&quot;
          header name.</pre>
</div>
<pre class="text">Since HAProxy works in reverse-proxy mode, the servers see its IP address as
their client address. This is sometimes annoying when the client's IP address
is expected in server logs. To solve this problem, the well-known HTTP header
&quot;X-Forwarded-For&quot; may be added by HAProxy to all requests sent to the server.
This header contains a value representing the client's IP address. Since this
header is always appended at the end of the existing header list, the server
must be configured to always use the last occurrence of this header only. See
the server's manual to find how to enable use of this standard header. Note
that only the last occurrence of the header must be used, since it is really
possible that the client has already brought one.

The keyword &quot;header&quot; may be used to supply a different header name to replace
the default &quot;X-Forwarded-For&quot;. This can be useful where you might already
have a &quot;X-Forwarded-For&quot; header from a different application (e.g. stunnel),
and you need preserve it. Also if your backend server doesn't use the
&quot;X-Forwarded-For&quot; header and requires different one (e.g. Zeus Web Servers
require &quot;X-Cluster-Client-IP&quot;).

Sometimes, a same HAProxy instance may be shared between a direct client
access and a reverse-proxy access (for instance when an SSL reverse-proxy is
used to decrypt HTTPS traffic). It is possible to disable the addition of the
header for a known source address or network by adding the &quot;except&quot; keyword
followed by the network address. In this case, any source IP matching the
network will not cause an addition of this header. Most common uses are with
private networks or 127.0.0.1. IPv4 and IPv6 are both supported.

Alternatively, the keyword &quot;if-none&quot; states that the header will only be
added if it is not present. This should only be used in perfectly trusted
environment, as this might cause a security issue if headers reaching HAProxy
are under the control of the end-user.

This option may be specified either in the frontend or in the backend. If at
least one of them uses it, the header will be added. Note that the backend's
setting of the header subargument takes precedence over the frontend's if
both are defined. In the case of the &quot;if-none&quot; argument, if at least one of
the frontend or the backend does not specify it, it wants the addition to be
mandatory, so it wins.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># Public HTTP address also used by stunnel on the same machine</span>
frontend www
    mode http
    option forwardfor except 127.0.0.1  <span class="comment"># stunnel already adds the header</span>

<span class="comment"># Those servers want the IP Address in X-Client</span>
backend www
    mode http
    option forwardfor header X-Client
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httpclose">option httpclose</a>&quot;, &quot;<a href="#option%20http-server-close">option http-server-close</a>&quot;, &quot;<a href="#option%20http-keep-alive">option http-keep-alive</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option h1-case-adjust-bogus-client"></a><a class="anchor" name="4-option h1-case-adjust-bogus-client"></a><a class="anchor" name="4.2-option h1-case-adjust-bogus-client"></a><a class="anchor" name="option h1-case-adjust-bogus-client (Proxies)"></a><a class="anchor" name="option h1-case-adjust-bogus-client (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option h1-case-adjust-bogus-client"></a><a href="#4.2-option%20h1-case-adjust-bogus-client">option h1-case-adjust-bogus-client</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option h1-case-adjust-bogus-client"></a><a class="anchor" name="4-no option h1-case-adjust-bogus-client"></a><a class="anchor" name="4.2-no option h1-case-adjust-bogus-client"></a><a class="anchor" name="no option h1-case-adjust-bogus-client (Proxies)"></a><a class="anchor" name="no option h1-case-adjust-bogus-client (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option h1-case-adjust-bogus-client"></a><a href="#4.2-no%20option%20h1-case-adjust-bogus-client">no option h1-case-adjust-bogus-client</a></b></div><pre class="text">Enable or disable the case adjustment of HTTP/1 headers sent to bogus clients

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">There is no standard case for header names because, as stated in RFC7230,
they are case-insensitive. So applications must handle them in a case-
insensitive manner. But some bogus applications violate the standards and
erroneously rely on the cases most commonly used by browsers. This problem
becomes critical with HTTP/2 because all header names must be exchanged in
lower case, and HAProxy follows the same convention. All header names are
sent in lower case to clients and servers, regardless of the HTTP version.

When HAProxy receives an HTTP/1 response, its header names are converted to
lower case and manipulated and sent this way to the clients. If a client is
known to violate the HTTP standards and to fail to process a response coming
from HAProxy, it is possible to transform the lower case header names to a
different format when the response is formatted and sent to the client, by
enabling this option and specifying the list of headers to be reformatted
using the global directives &quot;<a href="#h1-case-adjust">h1-case-adjust</a>&quot; or &quot;<a href="#h1-case-adjust-file">h1-case-adjust-file</a>&quot;. This
must only be a temporary workaround for the time it takes the client to be
fixed, because clients which require such workarounds might be vulnerable to
content smuggling attacks and must absolutely be fixed.

Please note that this option will not affect standards-compliant clients.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#option%20h1-case-adjust-bogus-server">option h1-case-adjust-bogus-server</a>&quot;, &quot;<a href="#h1-case-adjust">h1-case-adjust</a>&quot;, &quot;<a href="#h1-case-adjust-file">h1-case-adjust-file</a>&quot;.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option h1-case-adjust-bogus-server"></a><a class="anchor" name="4-option h1-case-adjust-bogus-server"></a><a class="anchor" name="4.2-option h1-case-adjust-bogus-server"></a><a class="anchor" name="option h1-case-adjust-bogus-server (Proxies)"></a><a class="anchor" name="option h1-case-adjust-bogus-server (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option h1-case-adjust-bogus-server"></a><a href="#4.2-option%20h1-case-adjust-bogus-server">option h1-case-adjust-bogus-server</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option h1-case-adjust-bogus-server"></a><a class="anchor" name="4-no option h1-case-adjust-bogus-server"></a><a class="anchor" name="4.2-no option h1-case-adjust-bogus-server"></a><a class="anchor" name="no option h1-case-adjust-bogus-server (Proxies)"></a><a class="anchor" name="no option h1-case-adjust-bogus-server (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option h1-case-adjust-bogus-server"></a><a href="#4.2-no%20option%20h1-case-adjust-bogus-server">no option h1-case-adjust-bogus-server</a></b></div><pre class="text">Enable or disable the case adjustment of HTTP/1 headers sent to bogus servers

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">There is no standard case for header names because, as stated in RFC7230,
they are case-insensitive. So applications must handle them in a case-
insensitive manner. But some bogus applications violate the standards and
erroneously rely on the cases most commonly used by browsers. This problem
becomes critical with HTTP/2 because all header names must be exchanged in
lower case, and HAProxy follows the same convention. All header names are
sent in lower case to clients and servers, regardless of the HTTP version.

When HAProxy receives an HTTP/1 request, its header names are converted to
lower case and manipulated and sent this way to the servers. If a server is
known to violate the HTTP standards and to fail to process a request coming
from HAProxy, it is possible to transform the lower case header names to a
different format when the request is formatted and sent to the server, by
enabling this option and specifying the list of headers to be reformatted
using the global directives &quot;<a href="#h1-case-adjust">h1-case-adjust</a>&quot; or &quot;<a href="#h1-case-adjust-file">h1-case-adjust-file</a>&quot;. This
must only be a temporary workaround for the time it takes the server to be
fixed, because servers which require such workarounds might be vulnerable to
content smuggling attacks and must absolutely be fixed.

Please note that this option will not affect standards-compliant servers.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#option%20h1-case-adjust-bogus-client">option h1-case-adjust-bogus-client</a>&quot;, &quot;<a href="#h1-case-adjust">h1-case-adjust</a>&quot;, &quot;<a href="#h1-case-adjust-file">h1-case-adjust-file</a>&quot;.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option http-buffer-request"></a><a class="anchor" name="4-option http-buffer-request"></a><a class="anchor" name="4.2-option http-buffer-request"></a><a class="anchor" name="option http-buffer-request (Proxies)"></a><a class="anchor" name="option http-buffer-request (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option http-buffer-request"></a><a href="#4.2-option%20http-buffer-request">option http-buffer-request</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option http-buffer-request"></a><a class="anchor" name="4-no option http-buffer-request"></a><a class="anchor" name="4.2-no option http-buffer-request"></a><a class="anchor" name="no option http-buffer-request (Proxies)"></a><a class="anchor" name="no option http-buffer-request (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option http-buffer-request"></a><a href="#4.2-no%20option%20http-buffer-request">no option http-buffer-request</a></b></div><pre class="text">Enable or disable waiting for whole HTTP request body before proceeding

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">It is sometimes desirable to wait for the body of an HTTP request before
taking a decision. This is what is being done by &quot;<a href="#balance%20url_param">balance url_param</a>&quot; for
example. The first use case is to buffer requests from slow clients before
connecting to the server. Another use case consists in taking the routing
decision based on the request body's contents. This option placed in a
frontend or backend forces the HTTP processing to wait until either the whole
body is received or the request buffer is full. It can have undesired side
effects with some applications abusing HTTP by expecting unbuffered
transmissions between the frontend and the backend, so this should definitely
not be used by default.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20http-no-delay">option http-no-delay</a>&quot;, &quot;<a href="#timeout%20http-request">timeout http-request</a>&quot;, &quot;http-request wait-for-body&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option http-ignore-probes"></a><a class="anchor" name="4-option http-ignore-probes"></a><a class="anchor" name="4.2-option http-ignore-probes"></a><a class="anchor" name="option http-ignore-probes (Proxies)"></a><a class="anchor" name="option http-ignore-probes (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option http-ignore-probes"></a><a href="#4.2-option%20http-ignore-probes">option http-ignore-probes</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option http-ignore-probes"></a><a class="anchor" name="4-no option http-ignore-probes"></a><a class="anchor" name="4.2-no option http-ignore-probes"></a><a class="anchor" name="no option http-ignore-probes (Proxies)"></a><a class="anchor" name="no option http-ignore-probes (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option http-ignore-probes"></a><a href="#4.2-no%20option%20http-ignore-probes">no option http-ignore-probes</a></b></div><pre class="text">Enable or disable logging of null connections and request timeouts

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">Recently some browsers started to implement a &quot;pre-connect&quot; feature
consisting in speculatively connecting to some recently visited web sites
just in case the user would like to visit them. This results in many
connections being established to web sites, which end up in 408 Request
Timeout if the timeout strikes first, or 400 Bad Request when the browser
decides to close them first. These ones pollute the log and feed the error
counters. There was already &quot;<a href="#option%20dontlognull">option dontlognull</a>&quot; but it's insufficient in
this case. Instead, this option does the following things :
   - prevent any 400/408 message from being sent to the client if nothing
     was received over a connection before it was closed;
   - prevent any log from being emitted in this situation;
   - prevent any error counter from being incremented

That way the empty connection is silently ignored. Note that it is better
not to use this unless it is clear that it is needed, because it will hide
real problems. The most common reason for not receiving a request and seeing
a 408 is due to an MTU inconsistency between the client and an intermediary
element such as a VPN, which blocks too large packets. These issues are
generally seen with POST requests as well as GET with large cookies. The logs
are often the only way to detect them.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#option%20dontlognull">dontlognull</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">errorfile<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#errorfile%20%28HTTP-errors%29">HTTP-errors</a></li><li><a href="#errorfile%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, and <a href="#8">section 8</a> about logging.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option http-keep-alive"></a><a class="anchor" name="4-option http-keep-alive"></a><a class="anchor" name="4.2-option http-keep-alive"></a><a class="anchor" name="option http-keep-alive (Proxies)"></a><a class="anchor" name="option http-keep-alive (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option http-keep-alive"></a><a href="#4.2-option%20http-keep-alive">option http-keep-alive</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option http-keep-alive"></a><a class="anchor" name="4-no option http-keep-alive"></a><a class="anchor" name="4.2-no option http-keep-alive"></a><a class="anchor" name="no option http-keep-alive (Proxies)"></a><a class="anchor" name="no option http-keep-alive (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option http-keep-alive"></a><a href="#4.2-no%20option%20http-keep-alive">no option http-keep-alive</a></b></div><pre class="text">Enable or disable HTTP keep-alive from client to server for HTTP/1.x
connections

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">By default HAProxy operates in keep-alive mode with regards to persistent
HTTP/1.x connections: for each connection it processes each request and
response, and leaves the connection idle on both sides. This mode may be
changed by several options such as &quot;<a href="#option%20http-server-close">option http-server-close</a>&quot; or &quot;option
httpclose&quot;. This option allows to set back the keep-alive mode, which can be
useful when another mode was used in a defaults section.

Setting &quot;<a href="#option%20http-keep-alive">option http-keep-alive</a>&quot; enables HTTP keep-alive mode on the client-
and server- sides. This provides the lowest latency on the client side (slow
network) and the fastest session reuse on the server side at the expense
of maintaining idle connections to the servers. In general, it is possible
with this option to achieve approximately twice the request rate that the
&quot;<a href="#option%20http-server-close">http-server-close</a>&quot; option achieves on small objects. There are mainly two
situations where this option may be useful :

  - when the server is non-HTTP compliant and authenticates the connection
    instead of requests (e.g. NTLM authentication)

  - when the cost of establishing the connection to the server is significant
    compared to the cost of retrieving the associated object from the server.

This last case can happen when the server is a fast static server of cache.

At the moment, logs will not indicate whether requests came from the same
session or not. The accept date reported in the logs corresponds to the end
of the previous request, and the request time corresponds to the time spent
waiting for a new request. The keep-alive request time is still bound to the
timeout defined by &quot;<a href="#timeout%20http-keep-alive">timeout http-keep-alive</a>&quot; or &quot;<a href="#timeout%20http-request">timeout http-request</a>&quot; if
not set.

This option disables and replaces any previous &quot;<a href="#option%20httpclose">option httpclose</a>&quot; or &quot;option
http-server-close&quot;.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httpclose">option httpclose</a>&quot;,, &quot;<a href="#option%20http-server-close">option http-server-close</a>&quot;, &quot;<a href="#option%20prefer-last-server">option prefer-last-server</a>&quot; and &quot;<a href="#option%20http-pretend-keepalive">option http-pretend-keepalive</a>&quot;.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option http-no-delay"></a><a class="anchor" name="4-option http-no-delay"></a><a class="anchor" name="4.2-option http-no-delay"></a><a class="anchor" name="option http-no-delay (Proxies)"></a><a class="anchor" name="option http-no-delay (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option http-no-delay"></a><a href="#4.2-option%20http-no-delay">option http-no-delay</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option http-no-delay"></a><a class="anchor" name="4-no option http-no-delay"></a><a class="anchor" name="4.2-no option http-no-delay"></a><a class="anchor" name="no option http-no-delay (Proxies)"></a><a class="anchor" name="no option http-no-delay (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option http-no-delay"></a><a href="#4.2-no%20option%20http-no-delay">no option http-no-delay</a></b></div><pre class="text">Instruct the system to favor low interactive delays over performance in HTTP

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">In HTTP, each payload is unidirectional and has no notion of interactivity.
Any agent is expected to queue data somewhat for a reasonably low delay.
There are some very rare server-to-server applications that abuse the HTTP
protocol and expect the payload phase to be highly interactive, with many
interleaved data chunks in both directions within a single request. This is
absolutely not supported by the HTTP specification and will not work across
most proxies or servers. When such applications attempt to do this through
HAProxy, it works but they will experience high delays due to the network
optimizations which favor performance by instructing the system to wait for
enough data to be available in order to only send full packets. Typical
delays are around 200 ms per round trip. Note that this only happens with
abnormal uses. Normal uses such as CONNECT requests nor WebSockets are not
affected.

When &quot;<a href="#option%20http-no-delay">option http-no-delay</a>&quot; is present in either the frontend or the backend
used by a connection, all such optimizations will be disabled in order to
make the exchanges as fast as possible. Of course this offers no guarantee on
the functionality, as it may break at any other place. But if it works via
HAProxy, it will work as fast as possible. This option should never be used
by default, and should never be used at all unless such a buggy application
is discovered. The impact of using this option is an increase of bandwidth
usage and CPU usage, which may significantly lower performance in high
latency environments.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20http-buffer-request">option http-buffer-request</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option http-pretend-keepalive"></a><a class="anchor" name="4-option http-pretend-keepalive"></a><a class="anchor" name="4.2-option http-pretend-keepalive"></a><a class="anchor" name="option http-pretend-keepalive (Proxies)"></a><a class="anchor" name="option http-pretend-keepalive (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option http-pretend-keepalive"></a><a href="#4.2-option%20http-pretend-keepalive">option http-pretend-keepalive</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option http-pretend-keepalive"></a><a class="anchor" name="4-no option http-pretend-keepalive"></a><a class="anchor" name="4.2-no option http-pretend-keepalive"></a><a class="anchor" name="no option http-pretend-keepalive (Proxies)"></a><a class="anchor" name="no option http-pretend-keepalive (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option http-pretend-keepalive"></a><a href="#4.2-no%20option%20http-pretend-keepalive">no option http-pretend-keepalive</a></b></div><pre class="text">Define whether HAProxy will announce keepalive for HTTP/1.x connection to the
server or not

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">When running with &quot;<a href="#option%20http-server-close">option http-server-close</a>&quot; or &quot;<a href="#option%20httpclose">option httpclose</a>&quot;, HAProxy
adds a &quot;Connection: close&quot; header to the HTTP/1.x request forwarded to the
server. Unfortunately, when some servers see this header, they automatically
refrain from using the chunked encoding for responses of unknown length,
while this is totally unrelated. The effect is that a client or a cache could
receive an incomplete response without being aware of it, and consider the
response complete.

By setting &quot;<a href="#option%20http-pretend-keepalive">option http-pretend-keepalive</a>&quot;, HAProxy will make the server
believe it will keep the connection alive. The server will then not fall back
to the abnormal undesired above. When HAProxy gets the whole response, it
will close the connection with the server just as it would do with the
&quot;<a href="#option%20httpclose">option httpclose</a>&quot;. That way the client gets a normal response and the
connection is correctly closed on the server side.

It is recommended not to enable this option by default, because most servers
will more efficiently close the connection themselves after the last packet,
and release its buffers slightly earlier. Also, the added packet on the
network could slightly reduce the overall peak performance. However it is
worth noting that when this option is enabled, HAProxy will have slightly
less work to do. So if HAProxy is the bottleneck on the whole architecture,
enabling this option might save a few CPU cycles.

This option may be set in backend and listen sections. Using it in a frontend
section will be ignored and a warning will be reported during startup. It is
a backend related option, so there is no real reason to set it on a
frontend.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httpclose">option httpclose</a>&quot;, &quot;<a href="#option%20http-server-close">option http-server-close</a>&quot;, and &quot;<a href="#option%20http-keep-alive">option http-keep-alive</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option http-restrict-req-hdr-names"></a><a class="anchor" name="4-option http-restrict-req-hdr-names"></a><a class="anchor" name="4.2-option http-restrict-req-hdr-names"></a><a class="anchor" name="option http-restrict-req-hdr-names (Proxies)"></a><a class="anchor" name="option http-restrict-req-hdr-names (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option http-restrict-req-hdr-names"></a><a href="#4.2-option%20http-restrict-req-hdr-names">option http-restrict-req-hdr-names</a></b> <span style="color: #800">{ preserve | delete | reject }</span></div><pre class="text">Set HAProxy policy about HTTP request header names containing characters
outside the &quot;[a-zA-Z0-9-]&quot; charset

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">preserve  disable the filtering. It is the default mode for HTTP proxies
          with no FastCGI application configured.

delete    remove request headers with a name containing a character
          outside the &quot;[a-zA-Z0-9-]&quot; charset. It is the default mode for
          HTTP backends with a configured FastCGI application.

reject    reject the request with a 403-Forbidden response if it contains a
          header name with a character outside the &quot;[a-zA-Z0-9-]&quot; charset.</pre>
</div>
<pre class="text">This option may be used to restrict the request header names to alphanumeric
and hyphen characters ([A-Za-z0-9-]). This may be mandatory to interoperate
with non-HTTP compliant servers that fail to handle some characters in header
names. It may also be mandatory for FastCGI applications because all
non-alphanumeric characters in header names are replaced by an underscore
('_'). Thus, it is easily possible to mix up header names and bypass some
rules. For instance, &quot;X-Forwarded-For&quot; and &quot;X_Forwarded-For&quot; headers are both
converted to &quot;HTTP_X_FORWARDED_FOR&quot; in FastCGI.

Note this option is evaluated per proxy and after the http-request rules
evaluation.
</pre><a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option http-server-close"></a><a class="anchor" name="4-option http-server-close"></a><a class="anchor" name="4.2-option http-server-close"></a><a class="anchor" name="option http-server-close (Proxies)"></a><a class="anchor" name="option http-server-close (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option http-server-close"></a><a href="#4.2-option%20http-server-close">option http-server-close</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option http-server-close"></a><a class="anchor" name="4-no option http-server-close"></a><a class="anchor" name="4.2-no option http-server-close"></a><a class="anchor" name="no option http-server-close (Proxies)"></a><a class="anchor" name="no option http-server-close (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option http-server-close"></a><a href="#4.2-no%20option%20http-server-close">no option http-server-close</a></b></div><pre class="text">Enable or disable HTTP/1.x connection closing on the server side

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">By default HAProxy operates in keep-alive mode with regards to persistent
HTTP/1.x connections: for each connection it processes each request and
response, and leaves the connection idle on both sides. This mode may be
changed by several options such as &quot;<a href="#option%20http-server-close">option http-server-close</a>&quot; or &quot;option
httpclose&quot;. Setting &quot;<a href="#option%20http-server-close">option http-server-close</a>&quot; enables HTTP connection-close
mode on the server side while keeping the ability to support HTTP keep-alive
and pipelining on the client side. This provides the lowest latency on the
client side (slow network) and the fastest session reuse on the server side
to save server resources, similarly to &quot;<a href="#option%20httpclose">option httpclose</a>&quot;.  It also permits
non-keepalive capable servers to be served in keep-alive mode to the clients
if they conform to the requirements of RFC7230. Please note that some servers
do not always conform to those requirements when they see &quot;Connection: close&quot;
in the request. The effect will be that keep-alive will never be used. A
workaround consists in enabling &quot;<a href="#option%20http-pretend-keepalive">option http-pretend-keepalive</a>&quot;.

At the moment, logs will not indicate whether requests came from the same
session or not. The accept date reported in the logs corresponds to the end
of the previous request, and the request time corresponds to the time spent
waiting for a new request. The keep-alive request time is still bound to the
timeout defined by &quot;<a href="#timeout%20http-keep-alive">timeout http-keep-alive</a>&quot; or &quot;<a href="#timeout%20http-request">timeout http-request</a>&quot; if
not set.

This option may be set both in a frontend and in a backend. It is enabled if
at least one of the frontend or backend holding a connection has it enabled.
It disables and replaces any previous &quot;<a href="#option%20httpclose">option httpclose</a>&quot; or &quot;option
http-keep-alive&quot;. Please check <a href="#4">section 4</a> (&quot;Proxies&quot;) to see how this option
combines with others when frontend and backend options differ.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httpclose">option httpclose</a>&quot;, &quot;<a href="#option%20http-pretend-keepalive">option http-pretend-keepalive</a>&quot; and &quot;<a href="#option%20http-keep-alive">option http-keep-alive</a>&quot;.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option http-use-proxy-header"></a><a class="anchor" name="4-option http-use-proxy-header"></a><a class="anchor" name="4.2-option http-use-proxy-header"></a><a class="anchor" name="option http-use-proxy-header (Proxies)"></a><a class="anchor" name="option http-use-proxy-header (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option http-use-proxy-header"></a><a href="#4.2-option%20http-use-proxy-header">option http-use-proxy-header</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option http-use-proxy-header"></a><a class="anchor" name="4-no option http-use-proxy-header"></a><a class="anchor" name="4.2-no option http-use-proxy-header"></a><a class="anchor" name="no option http-use-proxy-header (Proxies)"></a><a class="anchor" name="no option http-use-proxy-header (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option http-use-proxy-header"></a><a href="#4.2-no%20option%20http-use-proxy-header">no option http-use-proxy-header</a></b></div><pre class="text">Make use of non-standard Proxy-Connection header instead of Connection

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">While RFC7230 explicitly states that HTTP/1.1 agents must use the
Connection header to indicate their wish of persistent or non-persistent
connections, both browsers and proxies ignore this header for proxied
connections and make use of the undocumented, non-standard Proxy-Connection
header instead. The issue begins when trying to put a load balancer between
browsers and such proxies, because there will be a difference between what
HAProxy understands and what the client and the proxy agree on.

By setting this option in a frontend, HAProxy can automatically switch to use
that non-standard header if it sees proxied requests. A proxied request is
defined here as one where the URI begins with neither a '/' nor a '*'. This
is incompatible with the HTTP tunnel mode. Note that this option can only be
specified in a frontend and will affect the request along its whole life.

Also, when this option is set, a request which requires authentication will
automatically switch to use proxy authentication headers if it is itself a
proxied request. That makes it possible to check or enforce authentication in
front of an existing proxy.

This option should normally never be used, except in front of a proxy.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httpclose">option httpclose</a>&quot;, and &quot;<a href="#option%20http-server-close">option http-server-close</a>&quot;.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option httpchk"></a><a class="anchor" name="4-option httpchk"></a><a class="anchor" name="4.2-option httpchk"></a><a class="anchor" name="option httpchk (Proxies)"></a><a class="anchor" name="option httpchk (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option httpchk"></a><a href="#4.2-option%20httpchk">option httpchk</a></b></div><a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option httpchk"></a><a class="anchor" name="4-option httpchk"></a><a class="anchor" name="4.2-option httpchk"></a><a class="anchor" name="option httpchk (Proxies)"></a><a class="anchor" name="option httpchk (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option httpchk"></a><a href="#4.2-option%20httpchk">option httpchk</a></b> <span style="color: #080">&lt;uri&gt;</span></div><a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option httpchk"></a><a class="anchor" name="4-option httpchk"></a><a class="anchor" name="4.2-option httpchk"></a><a class="anchor" name="option httpchk (Proxies)"></a><a class="anchor" name="option httpchk (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option httpchk"></a><a href="#4.2-option%20httpchk">option httpchk</a></b> <span style="color: #080">&lt;method&gt;</span> <span style="color: #080">&lt;uri&gt;</span></div><a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option httpchk"></a><a class="anchor" name="4-option httpchk"></a><a class="anchor" name="4.2-option httpchk"></a><a class="anchor" name="option httpchk (Proxies)"></a><a class="anchor" name="option httpchk (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option httpchk"></a><a href="#4.2-option%20httpchk">option httpchk</a></b> <span style="color: #080">&lt;method&gt;</span> <span style="color: #080">&lt;uri&gt;</span> <span style="color: #080">&lt;version&gt;</span></div><a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option httpchk"></a><a class="anchor" name="4-option httpchk"></a><a class="anchor" name="4.2-option httpchk"></a><a class="anchor" name="option httpchk (Proxies)"></a><a class="anchor" name="option httpchk (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option httpchk"></a><a href="#4.2-option%20httpchk">option httpchk</a></b> <span style="color: #080">&lt;method&gt;</span> <span style="color: #080">&lt;uri&gt;</span> <span style="color: #080">&lt;version&gt;</span> <span style="color: #080">&lt;host&gt;</span></div><pre class="text">Enables HTTP protocol to check on the servers health

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;method&gt;  is the optional HTTP method used with the requests. When not set,
          the &quot;OPTIONS&quot; method is used, as it generally requires low server
          processing and is easy to filter out from the logs. Any method
          may be used, though it is not recommended to invent non-standard
          ones.

&lt;uri&gt;     is the URI referenced in the HTTP requests. It defaults to &quot; / &quot;
          which is accessible by default on almost any server, but may be
          changed to any other URI. Query strings are permitted.

&lt;version&gt; is the optional HTTP version string. It defaults to &quot;HTTP/1.0&quot;
          but some servers might behave incorrectly in HTTP 1.0, so turning
          it to HTTP/1.1 may sometimes help. Note that the Host field is
          mandatory in HTTP/1.1.

&lt;host&gt;    is the optional HTTP Host header value. It is not set by default.
          It is a log-format string.</pre>
</div>
<pre class="text">By default, server health checks only consist in trying to establish a TCP
connection. When &quot;<a href="#option%20httpchk">option httpchk</a>&quot; is specified, a complete HTTP request is
sent once the TCP connection is established, and responses 2xx and 3xx are
considered valid, while all other ones indicate a server failure, including
the lack of any response.

Combined with &quot;<a href="#http-check">http-check</a>&quot; directives, it is possible to customize the
request sent during the HTTP health checks or the matching rules on the
response. It is also possible to configure a send/expect sequence, just like
with the directive &quot;<a href="#option%20tcp-check">tcp-check</a>&quot; for TCP health checks.

The server configuration is used by default to open connections to perform
HTTP health checks. By it is also possible to overwrite server parameters
using &quot;<a href="#http-check%20connect">http-check connect</a>&quot; rules.

&quot;<a href="#option%20httpchk">httpchk</a>&quot; option does not necessarily require an HTTP backend, it also works
with plain TCP backends. This is particularly useful to check simple scripts
bound to some dedicated ports using the inetd daemon. However, it will always
internally relies on an HTX multiplexer. Thus, it means the request
formatting and the response parsing will be strict.
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code><span class="comment"># Relay HTTPS traffic to Apache instance and check service availability</span>
<span class="comment"># using HTTP request &quot;OPTIONS * HTTP/1.1&quot; on port 80.</span>
backend https_relay
    mode tcp
    option httpchk OPTIONS * HTTP/1.1
    http-check send hdr Host www
    server apache1 192.168.1.1:443 check port 80
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#option%20ssl-hello-chk">option ssl-hello-chk</a>&quot;, &quot;<a href="#option%20smtpchk">option smtpchk</a>&quot;, &quot;<a href="#option%20mysql-check">option mysql-check</a>&quot;, &quot;<a href="#option%20pgsql-check">option pgsql-check</a>&quot;, &quot;<a href="#http-check">http-check</a>&quot; and the &quot;<a href="#check">check</a>&quot;, &quot;<a href="#port">port</a>&quot; and &quot;<a href="#inter">inter</a>&quot; server options.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option httpclose"></a><a class="anchor" name="4-option httpclose"></a><a class="anchor" name="4.2-option httpclose"></a><a class="anchor" name="option httpclose (Proxies)"></a><a class="anchor" name="option httpclose (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option httpclose"></a><a href="#4.2-option%20httpclose">option httpclose</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option httpclose"></a><a class="anchor" name="4-no option httpclose"></a><a class="anchor" name="4.2-no option httpclose"></a><a class="anchor" name="no option httpclose (Proxies)"></a><a class="anchor" name="no option httpclose (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option httpclose"></a><a href="#4.2-no%20option%20httpclose">no option httpclose</a></b></div><pre class="text">Enable or disable HTTP/1.x connection closing

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">By default HAProxy operates in keep-alive mode with regards to persistent
HTTP/1.x connections: for each connection it processes each request and
response, and leaves the connection idle on both sides. This mode may be
changed by several options such as &quot;<a href="#option%20http-server-close">option http-server-close</a>&quot; or &quot;option
httpclose&quot;.

If &quot;<a href="#option%20httpclose">option httpclose</a>&quot; is set, HAProxy will close the client or the server
connection, depending where the option is set. The frontend is considered for
client connections while the backend is considered for server ones. If the
option is set on a listener, it is applied both on client and server
connections. It will check if a &quot;Connection: close&quot; header is already set in
each direction, and will add one if missing.

This option may also be combined with &quot;<a href="#option%20http-pretend-keepalive">option http-pretend-keepalive</a>&quot;, which
will disable sending of the &quot;Connection: close&quot; request header, but will
still cause the connection to be closed once the whole response is received.

It disables and replaces any previous &quot;<a href="#option%20http-server-close">option http-server-close</a>&quot; or &quot;option
http-keep-alive&quot;.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20http-server-close">option http-server-close</a>&quot;.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option httplog"></a><a class="anchor" name="4-option httplog"></a><a class="anchor" name="4.2-option httplog"></a><a class="anchor" name="option httplog (Proxies)"></a><a class="anchor" name="option httplog (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option httplog"></a><a href="#4.2-option%20httplog">option httplog</a></b> <span style="color: #008">[ clf ]</span></div><pre class="text">Enable logging of HTTP request, stream state and timers

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">clf       if the &quot;clf&quot; argument is added, then the output format will be
          the CLF format instead of HAProxy's default HTTP format. You can
          use this when you need to feed HAProxy's logs through a specific
          log analyzer which only support the CLF format and which is not
          extensible.</pre>
</div>
<pre class="text">By default, the log output format is very poor, as it only contains the
source and destination addresses, and the instance name. By specifying
&quot;<a href="#option%20httplog">option httplog</a>&quot;, each log line turns into a much richer format including,
but not limited to, the HTTP request, the connection timers, the stream
status, the connections numbers, the captured headers and cookies, the
frontend, backend and server name, and of course the source address and
ports.

Specifying only &quot;<a href="#option%20httplog">option httplog</a>&quot; will automatically clear the 'clf' mode
if it was set by default.

&quot;<a href="#option%20httplog">option httplog</a>&quot; overrides any previous &quot;<a href="#log-format">log-format</a>&quot; directive.
</pre><div class="page-header"><b>See also :</b> <a href="#8">section 8</a> about logging.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option httpslog"></a><a class="anchor" name="4-option httpslog"></a><a class="anchor" name="4.2-option httpslog"></a><a class="anchor" name="option httpslog (Proxies)"></a><a class="anchor" name="option httpslog (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option httpslog"></a><a href="#4.2-option%20httpslog">option httpslog</a></b></div><pre class="text">Enable logging of HTTPS request, stream state and timers

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<pre class="text">By default, the log output format is very poor, as it only contains the
source and destination addresses, and the instance name. By specifying
&quot;<a href="#option%20httpslog">option httpslog</a>&quot;, each log line turns into a much richer format including,
but not limited to, the HTTP request, the connection timers, the stream
status, the connections numbers, the captured headers and cookies, the
frontend, backend and server name, the SSL certificate verification and SSL
handshake statuses, and of course the source address and ports.

&quot;<a href="#option%20httpslog">option httpslog</a>&quot; overrides any previous &quot;<a href="#log-format">log-format</a>&quot; directive.
</pre><div class="page-header"><b>See also :</b> <a href="#8">section 8</a> about logging.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option independent-streams"></a><a class="anchor" name="4-option independent-streams"></a><a class="anchor" name="4.2-option independent-streams"></a><a class="anchor" name="option independent-streams (Proxies)"></a><a class="anchor" name="option independent-streams (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option independent-streams"></a><a href="#4.2-option%20independent-streams">option independent-streams</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option independent-streams"></a><a class="anchor" name="4-no option independent-streams"></a><a class="anchor" name="4.2-no option independent-streams"></a><a class="anchor" name="no option independent-streams (Proxies)"></a><a class="anchor" name="no option independent-streams (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option independent-streams"></a><a href="#4.2-no%20option%20independent-streams">no option independent-streams</a></b></div><pre class="text">Enable or disable independent timeout processing for both directions

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">By default, when data is sent over a socket, both the write timeout and the
read timeout for that socket are refreshed, because we consider that there is
activity on that socket, and we have no other means of guessing if we should
receive data or not.

While this default behavior is desirable for almost all applications, there
exists a situation where it is desirable to disable it, and only refresh the
read timeout if there are incoming data. This happens on streams with large
timeouts and low amounts of exchanged data such as telnet session. If the
server suddenly disappears, the output data accumulates in the system's
socket buffers, both timeouts are correctly refreshed, and there is no way
to know the server does not receive them, so we don't timeout. However, when
the underlying protocol always echoes sent data, it would be enough by itself
to detect the issue using the read timeout. Note that this problem does not
happen with more verbose protocols because data won't accumulate long in the
socket buffers.

When this option is set on the frontend, it will disable read timeout updates
on data sent to the client. There probably is little use of this case. When
the option is set on the backend, it will disable read timeout updates on
data sent to the server. Doing so will typically break large HTTP posts from
slow lines, so use it with caution.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout client<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20client%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#timeout%20client%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20server%20%28Rings%29">Rings</a></li><li><a href="#timeout%20server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; and &quot;<a href="#timeout%20tunnel">timeout tunnel</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option ldap-check"></a><a class="anchor" name="4-option ldap-check"></a><a class="anchor" name="4.2-option ldap-check"></a><a class="anchor" name="option ldap-check (Proxies)"></a><a class="anchor" name="option ldap-check (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option ldap-check"></a><a href="#4.2-option%20ldap-check">option ldap-check</a></b></div><pre class="text">Use LDAPv3 health checks for server testing

May be used in the following contexts: tcp
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">It is possible to test that the server correctly talks LDAPv3 instead of just
testing that it accepts the TCP connection. When this option is set, an
LDAPv3 anonymous simple bind message is sent to the server, and the response
is analyzed to find an LDAPv3 bind response message.

The server is considered valid only when the LDAP response contains success
resultCode (http://tools.ietf.org/html/rfc4511#section-4.1.9).

Logging of bind requests is server dependent see your documentation how to
configure it.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>option ldap-check
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httpchk">option httpchk</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option external-check"></a><a class="anchor" name="4-option external-check"></a><a class="anchor" name="4.2-option external-check"></a><a class="anchor" name="option external-check (Proxies)"></a><a class="anchor" name="option external-check (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option external-check"></a><a href="#4.2-option%20external-check">option external-check</a></b></div><pre class="text">Use external processes for server health checks

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">It is possible to test the health of a server using an external command.
This is achieved by running the executable set using &quot;external-check
command&quot;.

Requires the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">external-check<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#external-check%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#external-check%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; global to be set.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">external-check<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#external-check%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#external-check%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#external-check%20command">external-check command</a>&quot;, &quot;<a href="#external-check%20path">external-check path</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option idle-close-on-response"></a><a class="anchor" name="4-option idle-close-on-response"></a><a class="anchor" name="4.2-option idle-close-on-response"></a><a class="anchor" name="option idle-close-on-response (Proxies)"></a><a class="anchor" name="option idle-close-on-response (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option idle-close-on-response"></a><a href="#4.2-option%20idle-close-on-response">option idle-close-on-response</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option idle-close-on-response"></a><a class="anchor" name="4-no option idle-close-on-response"></a><a class="anchor" name="4.2-no option idle-close-on-response"></a><a class="anchor" name="no option idle-close-on-response (Proxies)"></a><a class="anchor" name="no option idle-close-on-response (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option idle-close-on-response"></a><a href="#4.2-no%20option%20idle-close-on-response">no option idle-close-on-response</a></b></div><pre class="text">Avoid closing idle frontend connections if a soft stop is in progress

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">By default, idle connections will be closed during a soft stop. In some
environments, a client talking to the proxy may have prepared some idle
connections in order to send requests later. If there is no proper retry on
write errors, this can result in errors while haproxy is reloading. Even
though a proper implementation should retry on connection/write errors, this
option was introduced to support backwards compatibility with haproxy prior
to version 2.4. Indeed before v2.4, haproxy used to wait for a last request
and response to add a &quot;connection: close&quot; header before closing, thus
notifying the client that the connection would not be reusable.

In a real life example, this behavior was seen in AWS using the ALB in front
of a haproxy. The end result was ALB sending 502 during haproxy reloads.

Users are warned that using this option may increase the number of old
processes if connections remain idle for too long. Adjusting the client
timeouts and/or the &quot;<a href="#hard-stop-after">hard-stop-after</a>&quot; parameter accordingly might be
needed in case of frequent reloads.
</pre><div class="page-header"><b>See also:</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout client<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20client%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#timeout%20client%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#timeout%20client-fin">timeout client-fin</a>&quot;, &quot;<a href="#timeout%20http-request">timeout http-request</a>&quot;, &quot;<a href="#hard-stop-after">hard-stop-after</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option log-health-checks"></a><a class="anchor" name="4-option log-health-checks"></a><a class="anchor" name="4.2-option log-health-checks"></a><a class="anchor" name="option log-health-checks (Proxies)"></a><a class="anchor" name="option log-health-checks (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option log-health-checks"></a><a href="#4.2-option%20log-health-checks">option log-health-checks</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option log-health-checks"></a><a class="anchor" name="4-no option log-health-checks"></a><a class="anchor" name="4.2-no option log-health-checks"></a><a class="anchor" name="no option log-health-checks (Proxies)"></a><a class="anchor" name="no option log-health-checks (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option log-health-checks"></a><a href="#4.2-no%20option%20log-health-checks">no option log-health-checks</a></b></div><pre class="text">Enable or disable logging of health checks status updates

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">By default, failed health check are logged if server is UP and successful
health checks are logged if server is DOWN, so the amount of additional
information is limited.

When this option is enabled, any change of the health check status or to
the server's health will be logged, so that it becomes possible to know
that a server was failing occasional checks before crashing, or exactly when
it failed to respond a valid HTTP status, then when the port started to
reject connections, then when the server stopped responding at all.

Note that status changes not caused by health checks (e.g. enable/disable on
the CLI) are intentionally not logged by this option.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#option%20httpchk">option httpchk</a>&quot;, &quot;<a href="#option%20ldap-check">option ldap-check</a>&quot;, &quot;<a href="#option%20mysql-check">option mysql-check</a>&quot;, &quot;<a href="#option%20pgsql-check">option pgsql-check</a>&quot;, &quot;<a href="#option%20redis-check">option redis-check</a>&quot;, &quot;<a href="#option%20smtpchk">option smtpchk</a>&quot;, &quot;<a href="#option%20tcp-check">option tcp-check</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; and <a href="#8">section 8</a> about logging.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option log-separate-errors"></a><a class="anchor" name="4-option log-separate-errors"></a><a class="anchor" name="4.2-option log-separate-errors"></a><a class="anchor" name="option log-separate-errors (Proxies)"></a><a class="anchor" name="option log-separate-errors (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option log-separate-errors"></a><a href="#4.2-option%20log-separate-errors">option log-separate-errors</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option log-separate-errors"></a><a class="anchor" name="4-no option log-separate-errors"></a><a class="anchor" name="4.2-no option log-separate-errors"></a><a class="anchor" name="no option log-separate-errors (Proxies)"></a><a class="anchor" name="no option log-separate-errors (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option log-separate-errors"></a><a href="#4.2-no%20option%20log-separate-errors">no option log-separate-errors</a></b></div><pre class="text">Change log level for non-completely successful connections

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">Sometimes looking for errors in logs is not easy. This option makes HAProxy
raise the level of logs containing potentially interesting information such
as errors, timeouts, retries, redispatches, or HTTP status codes 5xx. The
level changes from &quot;info&quot; to &quot;err&quot;. This makes it possible to log them
separately to a different file with most syslog daemons. Be careful not to
remove them from the original file, otherwise you would lose ordering which
provides very important information.

Using this option, large sites dealing with several thousand connections per
second may log normal traffic to a rotating buffer and only archive smaller
error logs.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#option%20dontlognull">dontlognull</a>&quot;, &quot;<a href="#option%20dontlog-normal">dontlog-normal</a>&quot; and <a href="#8">section 8</a> about logging.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option logasap"></a><a class="anchor" name="4-option logasap"></a><a class="anchor" name="4.2-option logasap"></a><a class="anchor" name="option logasap (Proxies)"></a><a class="anchor" name="option logasap (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option logasap"></a><a href="#4.2-option%20logasap">option logasap</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option logasap"></a><a class="anchor" name="4-no option logasap"></a><a class="anchor" name="4.2-no option logasap"></a><a class="anchor" name="no option logasap (Proxies)"></a><a class="anchor" name="no option logasap (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option logasap"></a><a href="#4.2-no%20option%20logasap">no option logasap</a></b></div><pre class="text">Enable or disable early logging.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">By default, logs are emitted when all the log format aliases and sample
fetches used in the definition of the log-format string return a value, or
when the stream is terminated. This allows the built in log-format strings
to account for the transfer time, or the number of bytes in log messages.

When handling long lived connections such as large file transfers or RDP,
it may take a while for the request or connection to appear in the logs.
Using &quot;<a href="#option%20logasap">option logasap</a>&quot;, the log message is created as soon as the server
connection is established in mode tcp, or as soon as the server sends the
complete headers in mode http. Missing information in the logs will be the
total number of bytes which will only indicate the amount of data transferred
before the message was created and the total time which will not take the
remainder of the connection life or transfer time into account. For the case
of HTTP, it is good practice to capture the Content-Length response header
so that the logs at least indicate how many bytes are expected to be
transferred.
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code>  listen http_proxy 0.0.0.0:80
      mode http
      option httplog
      option logasap
      log 192.168.2.200 local3

&gt;&gt;&gt; Feb  6 12:14:14 localhost \
      haproxy[14389]: 10.0.1.2:33317 [06/Feb/2009:12:14:14.655] http-in \
      static/srv1 9/10/7/14/+30 200 +243 - - ---- 3/1/1/1/0 1/0 \
      &quot;GET /image.iso HTTP/1.0&quot;
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httplog">option httplog</a>&quot;, &quot;<a href="#capture%20response%20header">capture response header</a>&quot;, and <a href="#8">section 8</a> about logging.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option mysql-check"></a><a class="anchor" name="4-option mysql-check"></a><a class="anchor" name="4.2-option mysql-check"></a><a class="anchor" name="option mysql-check (Proxies)"></a><a class="anchor" name="option mysql-check (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option mysql-check"></a><a href="#4.2-option%20mysql-check">option mysql-check</a></b> <span style="color: #008">[ user <span style="color: #080">&lt;username&gt;</span> <span style="color: #008">[ <span style="color: #800">{ post-41 | pre-41 }</span> ]</span> ]</span></div><pre class="text">Use MySQL health checks for server testing

May be used in the following contexts: tcp
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;username&gt; This is the username which will be used when connecting to MySQL
           server.
post-41    Send post v4.1 client compatible checks (the default)
pre-41     Send pre v4.1 client compatible checks</pre>
</div>
<pre class="text">If you specify a username, the check consists of sending two MySQL packet,
one Client Authentication packet, and one QUIT packet, to correctly close
MySQL session. We then parse the MySQL Handshake Initialization packet and/or
Error packet. It is a basic but useful test which does not produce error nor
aborted connect on the server. However, it requires an unlocked authorised
user without a password. To create a basic limited user in MySQL with
optional resource limits:

    CREATE USER '&lt;username&gt;'@'&lt;ip_of_haproxy|network_of_haproxy/netmask&gt;'
    /*!50701 WITH MAX_QUERIES_PER_HOUR 1 MAX_UPDATES_PER_HOUR 0 */
    /*M!100201 MAX_STATEMENT_TIME 0.0001 */;

If you don't specify a username (it is deprecated and not recommended), the
check only consists in parsing the Mysql Handshake Initialization packet or
Error packet, we don't send anything in this mode. It was reported that it
can generate lockout if check is too frequent and/or if there is not enough
traffic. In fact, you need in this case to check MySQL &quot;max_connect_errors&quot;
value as if a connection is established successfully within fewer than MySQL
&quot;max_connect_errors&quot; attempts after a previous connection was interrupted,
the error count for the host is cleared to zero. If HAProxy's server get
blocked, the &quot;FLUSH HOSTS&quot; statement is the only way to unblock it.

Remember that this does not check database presence nor database consistency.
To do this, you can use an external check with xinetd for example.

The check requires MySQL &gt;=3.22, for older version, please use TCP check.

Most often, an incoming MySQL server needs to see the client's IP address for
various purposes, including IP privilege matching and connection logging.
When possible, it is often wise to masquerade the client's IP address when
connecting to the server using the &quot;usesrc&quot; argument of the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">source<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#source%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#source%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword,
which requires the transparent proxy feature to be compiled in, and the MySQL
server to route the client via the machine hosting HAProxy.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#option%20httpchk">option httpchk</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option nolinger"></a><a class="anchor" name="4-option nolinger"></a><a class="anchor" name="4.2-option nolinger"></a><a class="anchor" name="option nolinger (Proxies)"></a><a class="anchor" name="option nolinger (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option nolinger"></a><a href="#4.2-option%20nolinger">option nolinger</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option nolinger"></a><a class="anchor" name="4-no option nolinger"></a><a class="anchor" name="4.2-no option nolinger"></a><a class="anchor" name="no option nolinger (Proxies)"></a><a class="anchor" name="no option nolinger (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option nolinger"></a><a href="#4.2-no%20option%20nolinger">no option nolinger</a></b></div><pre class="text">Enable or disable immediate session resource cleaning after close

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">When clients or servers abort connections in a dirty way (e.g. they are
physically disconnected), the session timeouts triggers and the session is
closed. But it will remain in FIN_WAIT1 state for some time in the system,
using some resources and possibly limiting the ability to establish newer
connections.

When this happens, it is possible to activate &quot;<a href="#option%20nolinger">option nolinger</a>&quot; which forces
the system to immediately remove any socket's pending data on close. Thus,
a TCP RST is emitted, any pending data are truncated, and the session is
instantly purged from the system's tables. The generally visible effect for
a client is that responses are truncated if the close happens with a last
block of data (e.g. on a redirect or error response). On the server side,
it may help release the source ports immediately when forwarding a client
aborts in tunnels. In both cases, TCP resets are emitted and given that
the session is instantly destroyed, there will be no retransmit. On a lossy
network this can increase problems, especially when there is a firewall on
the lossy side, because the firewall might see and process the reset (hence
purge its session) and block any further traffic for this session,, including
retransmits from the other side. So if the other side doesn't receive it,
it will never receive any RST again, and the firewall might log many blocked
packets.

For all these reasons, it is strongly recommended NOT to use this option,
unless absolutely needed as a last resort. In most situations, using the
&quot;client-fin&quot; or &quot;server-fin&quot; timeouts achieves similar results with a more
reliable behavior. On Linux it's also possible to use the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">tcp-ut<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#tcp-ut%20%28Bind%20options%29">Bind options</a></li><li><a href="#tcp-ut%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; bind or
server setting.

This option may be used both on frontends and backends, depending on the side
where it is required. Use it on the frontend for clients, and on the backend
for servers. While this option is technically supported in &quot;defaults&quot;
sections, it must really not be used there as it risks to accidentally
propagate to sections that must no use it and to cause problems there.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#timeout%20client-fin">timeout client-fin</a>&quot;, &quot;<a href="#timeout%20server-fin">timeout server-fin</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">tcp-ut<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#tcp-ut%20%28Bind%20options%29">Bind options</a></li><li><a href="#tcp-ut%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; bind or server keywords.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option originalto"></a><a class="anchor" name="4-option originalto"></a><a class="anchor" name="4.2-option originalto"></a><a class="anchor" name="option originalto (Proxies)"></a><a class="anchor" name="option originalto (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option originalto"></a><a href="#4.2-option%20originalto">option originalto</a></b> <span style="color: #008">[ except <span style="color: #080">&lt;network&gt;</span> ]</span> <span style="color: #008">[ header <span style="color: #080">&lt;name&gt;</span> ]</span></div><pre class="text">Enable insertion of the X-Original-To header to requests sent to servers

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;network&gt; is an optional argument used to disable this option for sources
          matching &lt;network&gt;
&lt;name&gt;    an optional argument to specify a different &quot;X-Original-To&quot;
          header name.</pre>
</div>
<pre class="text">Since HAProxy can work in transparent mode, every request from a client can
be redirected to the proxy and HAProxy itself can proxy every request to a
complex SQUID environment and the destination host from SO_ORIGINAL_DST will
be lost. This is annoying when you want access rules based on destination ip
addresses. To solve this problem, a new HTTP header &quot;X-Original-To&quot; may be
added by HAProxy to all requests sent to the server. This header contains a
value representing the original destination IP address. Since this must be
configured to always use the last occurrence of this header only. Note that
only the last occurrence of the header must be used, since it is really
possible that the client has already brought one.

The keyword &quot;header&quot; may be used to supply a different header name to replace
the default &quot;X-Original-To&quot;. This can be useful where you might already
have a &quot;X-Original-To&quot; header from a different application, and you need
preserve it. Also if your backend server doesn't use the &quot;X-Original-To&quot;
header and requires different one.

Sometimes, a same HAProxy instance may be shared between a direct client
access and a reverse-proxy access (for instance when an SSL reverse-proxy is
used to decrypt HTTPS traffic). It is possible to disable the addition of the
header for a known destination address or network by adding the &quot;except&quot;
keyword followed by the network address. In this case, any destination IP
matching the network will not cause an addition of this header. Most common
uses are with private networks or 127.0.0.1. IPv4 and IPv6 are both
supported.

This option may be specified either in the frontend or in the backend. If at
least one of them uses it, the header will be added. Note that the backend's
setting of the header subargument takes precedence over the frontend's if
both are defined.
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code><span class="comment"># Original Destination address</span>
frontend www
    mode http
    option originalto except 127.0.0.1

<span class="comment"># Those servers want the IP Address in X-Client-Dst</span>
backend www
    mode http
    option originalto header X-Client-Dst
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httpclose">option httpclose</a>&quot;, &quot;<a href="#option%20http-server-close">option http-server-close</a>&quot;.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option persist"></a><a class="anchor" name="4-option persist"></a><a class="anchor" name="4.2-option persist"></a><a class="anchor" name="option persist (Proxies)"></a><a class="anchor" name="option persist (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option persist"></a><a href="#4.2-option%20persist">option persist</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option persist"></a><a class="anchor" name="4-no option persist"></a><a class="anchor" name="4.2-no option persist"></a><a class="anchor" name="no option persist (Proxies)"></a><a class="anchor" name="no option persist (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option persist"></a><a href="#4.2-no%20option%20persist">no option persist</a></b></div><pre class="text">Enable or disable forced persistence on down servers

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">When an HTTP request reaches a backend with a cookie which references a dead
server, by default it is redispatched to another server. It is possible to
force the request to be sent to the dead server first using &quot;<a href="#option%20persist">option persist</a>&quot;
if absolutely needed. A common use case is when servers are under extreme
load and spend their time flapping. In this case, the users would still be
directed to the server they opened the session on, in the hope they would be
correctly served. It is recommended to use &quot;<a href="#option%20redispatch">option redispatch</a>&quot; in conjunction
with this option so that in the event it would not be possible to connect to
the server at all (server definitely dead), the client would finally be
redirected to another valid server.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20redispatch">option redispatch</a>&quot;, &quot;<a href="#retries">retries</a>&quot;, &quot;<a href="#force-persist">force-persist</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option pgsql-check"></a><a class="anchor" name="4-option pgsql-check"></a><a class="anchor" name="4.2-option pgsql-check"></a><a class="anchor" name="option pgsql-check (Proxies)"></a><a class="anchor" name="option pgsql-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option pgsql-check user"></a><a class="anchor" name="4-option pgsql-check user"></a><a class="anchor" name="4.2-option pgsql-check user"></a><a class="anchor" name="option pgsql-check user (Proxies)"></a><a class="anchor" name="option pgsql-check user (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option pgsql-check user"></a><a href="#4.2-option%20pgsql-check%20user">option pgsql-check user</a></b> <span style="color: #080">&lt;username&gt;</span></div><pre class="text">Use PostgreSQL health checks for server testing

May be used in the following contexts: tcp
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;username&gt; This is the username which will be used when connecting to
           PostgreSQL server.</pre>
</div>
<pre class="text">The check sends a PostgreSQL StartupMessage and waits for either
Authentication request or ErrorResponse message. It is a basic but useful
test which does not produce error nor aborted connect on the server.
This check is identical with the &quot;<a href="#option%20mysql-check">mysql-check</a>&quot;.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#option%20httpchk">option httpchk</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option prefer-last-server"></a><a class="anchor" name="4-option prefer-last-server"></a><a class="anchor" name="4.2-option prefer-last-server"></a><a class="anchor" name="option prefer-last-server (Proxies)"></a><a class="anchor" name="option prefer-last-server (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option prefer-last-server"></a><a href="#4.2-option%20prefer-last-server">option prefer-last-server</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option prefer-last-server"></a><a class="anchor" name="4-no option prefer-last-server"></a><a class="anchor" name="4.2-no option prefer-last-server"></a><a class="anchor" name="no option prefer-last-server (Proxies)"></a><a class="anchor" name="no option prefer-last-server (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option prefer-last-server"></a><a href="#4.2-no%20option%20prefer-last-server">no option prefer-last-server</a></b></div><pre class="text">Allow multiple load balanced requests to remain on the same server

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">When the load balancing algorithm in use is not deterministic, and a previous
request was sent to a server to which HAProxy still holds a connection, it is
sometimes desirable that subsequent requests on a same session go to the same
server as much as possible. Note that this is different from persistence, as
we only indicate a preference which HAProxy tries to apply without any form
of warranty. The real use is for keep-alive connections sent to servers. When
this option is used, HAProxy will try to reuse the same connection that is
attached to the server instead of rebalancing to another server, causing a
close of the connection. This can make sense for static file servers. It does
not make much sense to use this in combination with hashing algorithms. Note,
HAProxy already automatically tries to stick to a server which sends a 401 or
to a proxy which sends a 407 (authentication required), when the load
balancing algorithm is not deterministic. This is mandatory for use with the
broken NTLM authentication challenge, and significantly helps in
troubleshooting some faulty applications. Option prefer-last-server might be
desirable in these environments as well, to avoid redistributing the traffic
after every other response.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#option%20http-keep-alive">option http-keep-alive</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option redispatch"></a><a class="anchor" name="4-option redispatch"></a><a class="anchor" name="4.2-option redispatch"></a><a class="anchor" name="option redispatch (Proxies)"></a><a class="anchor" name="option redispatch (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option redispatch"></a><a href="#4.2-option%20redispatch">option redispatch</a></b></div><a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option redispatch"></a><a class="anchor" name="4-option redispatch"></a><a class="anchor" name="4.2-option redispatch"></a><a class="anchor" name="option redispatch (Proxies)"></a><a class="anchor" name="option redispatch (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option redispatch"></a><a href="#4.2-option%20redispatch">option redispatch</a></b> <span style="color: #080">&lt;interval&gt;</span></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option redispatch"></a><a class="anchor" name="4-no option redispatch"></a><a class="anchor" name="4.2-no option redispatch"></a><a class="anchor" name="no option redispatch (Proxies)"></a><a class="anchor" name="no option redispatch (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option redispatch"></a><a href="#4.2-no%20option%20redispatch">no option redispatch</a></b></div><pre class="text">Enable or disable session redistribution in case of connection failure

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;interval&gt; The optional integer value that controls how often redispatches
           occur when retrying connections. Positive value P indicates a
           redispatch is desired on every Pth retry, and negative value
           N indicate a redispatch is desired on the Nth retry prior to the
           last retry. For example, the default of -1 preserves the
           historical behavior of redispatching on the last retry, a
           positive value of 1 would indicate a redispatch on every retry,
           and a positive value of 3 would indicate a redispatch on every
           third retry. You can disable redispatches with a value of 0.</pre>
</div>
<pre class="text">In HTTP mode, if a server designated by a cookie is down, clients may
definitely stick to it because they cannot flush the cookie, so they will not
be able to access the service anymore.

Specifying &quot;<a href="#option%20redispatch">option redispatch</a>&quot; will allow the proxy to break cookie or
consistent hash based persistence and redistribute them to a working server.

Active servers are selected from a subset of the list of available
servers. Active servers that are not down or in maintenance (i.e., whose
health is not checked or that have been checked as &quot;up&quot;), are selected in the
following order:

  1. Any active, non-backup server, if any, or,

  2. If the &quot;<a href="#option%20allbackups">allbackups</a>&quot; option is not set, the first backup server in the
     list, or

  3. If the &quot;<a href="#option%20allbackups">allbackups</a>&quot; option is set, any backup server.

When a retry occurs, HAProxy tries to select another server than the last
one. The new server is selected from the current list of servers.

Sometimes, if the list is updated between retries (e.g., if numerous retries
occur and last longer than the time needed to check that a server is down,
remove it from the list and fall back on the list of backup servers),
connections may be redirected to a backup server, though.

It also allows to retry connections to another server in case of multiple
connection failures. Of course, it requires having &quot;<a href="#retries">retries</a>&quot; set to a nonzero
value.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#retries">retries</a>&quot;, &quot;<a href="#force-persist">force-persist</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option redis-check"></a><a class="anchor" name="4-option redis-check"></a><a class="anchor" name="4.2-option redis-check"></a><a class="anchor" name="option redis-check (Proxies)"></a><a class="anchor" name="option redis-check (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option redis-check"></a><a href="#4.2-option%20redis-check">option redis-check</a></b></div><pre class="text">Use redis health checks for server testing

May be used in the following contexts: tcp
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">It is possible to test that the server correctly talks REDIS protocol instead
of just testing that it accepts the TCP connection. When this option is set,
a PING redis command is sent to the server, and the response is analyzed to
find the &quot;+PONG&quot; response message.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>option redis-check
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httpchk">option httpchk</a>&quot;, &quot;<a href="#option%20tcp-check">option tcp-check</a>&quot;, &quot;<a href="#tcp-check%20expect">tcp-check expect</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option smtpchk"></a><a class="anchor" name="4-option smtpchk"></a><a class="anchor" name="4.2-option smtpchk"></a><a class="anchor" name="option smtpchk (Proxies)"></a><a class="anchor" name="option smtpchk (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option smtpchk"></a><a href="#4.2-option%20smtpchk">option smtpchk</a></b></div><a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option smtpchk"></a><a class="anchor" name="4-option smtpchk"></a><a class="anchor" name="4.2-option smtpchk"></a><a class="anchor" name="option smtpchk (Proxies)"></a><a class="anchor" name="option smtpchk (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option smtpchk"></a><a href="#4.2-option%20smtpchk">option smtpchk</a></b> <span style="color: #080">&lt;hello&gt;</span> <span style="color: #080">&lt;domain&gt;</span></div><pre class="text">Use SMTP health checks for server testing

May be used in the following contexts: tcp
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;hello&gt;   is an optional argument. It is the &quot;hello&quot; command to use. It can
          be either &quot;HELO&quot; (for SMTP) or &quot;EHLO&quot; (for ESMTP). All other
          values will be turned into the default command (&quot;HELO&quot;).

&lt;domain&gt;  is the domain name to present to the server. It may only be
          specified (and is mandatory) if the hello command has been
          specified. By default, &quot;localhost&quot; is used.</pre>
</div>
<pre class="text">When &quot;<a href="#option%20smtpchk">option smtpchk</a>&quot; is set, the health checks will consist in TCP
connections followed by an SMTP command. By default, this command is
&quot;HELO localhost&quot;. The server's return code is analyzed and only return codes
starting with a &quot;2&quot; will be considered as valid. All other responses,
including a lack of response will constitute an error and will indicate a
dead server.

This test is meant to be used with SMTP servers or relays. Depending on the
request, it is possible that some servers do not log each connection attempt,
so you may want to experiment to improve the behavior. Using telnet on port
25 is often easier than adjusting the configuration.

Most often, an incoming SMTP server needs to see the client's IP address for
various purposes, including spam filtering, anti-spoofing and logging. When
possible, it is often wise to masquerade the client's IP address when
connecting to the server using the &quot;usesrc&quot; argument of the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">source<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#source%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#source%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword,
which requires the transparent proxy feature to be compiled in.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>option smtpchk HELO mydomain.org
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httpchk">option httpchk</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">source<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#source%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#source%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option socket-stats"></a><a class="anchor" name="4-option socket-stats"></a><a class="anchor" name="4.2-option socket-stats"></a><a class="anchor" name="option socket-stats (Proxies)"></a><a class="anchor" name="option socket-stats (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option socket-stats"></a><a href="#4.2-option%20socket-stats">option socket-stats</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option socket-stats"></a><a class="anchor" name="4-no option socket-stats"></a><a class="anchor" name="4.2-no option socket-stats"></a><a class="anchor" name="no option socket-stats (Proxies)"></a><a class="anchor" name="no option socket-stats (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option socket-stats"></a><a href="#4.2-no%20option%20socket-stats">no option socket-stats</a></b></div><pre class="text">Enable or disable collecting &amp; providing separate statistics for each socket.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option splice-auto"></a><a class="anchor" name="4-option splice-auto"></a><a class="anchor" name="4.2-option splice-auto"></a><a class="anchor" name="option splice-auto (Proxies)"></a><a class="anchor" name="option splice-auto (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option splice-auto"></a><a href="#4.2-option%20splice-auto">option splice-auto</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option splice-auto"></a><a class="anchor" name="4-no option splice-auto"></a><a class="anchor" name="4.2-no option splice-auto"></a><a class="anchor" name="no option splice-auto (Proxies)"></a><a class="anchor" name="no option splice-auto (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option splice-auto"></a><a href="#4.2-no%20option%20splice-auto">no option splice-auto</a></b></div><pre class="text">Enable or disable automatic kernel acceleration on sockets in both directions

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">When this option is enabled either on a frontend or on a backend, HAProxy
will automatically evaluate the opportunity to use kernel tcp splicing to
forward data between the client and the server, in either direction. HAProxy
uses heuristics to estimate if kernel splicing might improve performance or
not. Both directions are handled independently. Note that the heuristics used
are not much aggressive in order to limit excessive use of splicing. This
option requires splicing to be enabled at compile time, and may be globally
disabled with the global option &quot;<a href="#nosplice">nosplice</a>&quot;. Since splice uses pipes, using it
requires that there are enough spare pipes.

Important note: kernel-based TCP splicing is a Linux-specific feature which
first appeared in kernel 2.6.25. It offers kernel-based acceleration to
transfer data between sockets without copying these data to user-space, thus
providing noticeable performance gains and CPU cycles savings. Since many
early implementations are buggy, corrupt data and/or are inefficient, this
feature is not enabled by default, and it should be used with extreme care.
While it is not possible to detect the correctness of an implementation,
2.6.29 is the first version offering a properly working implementation. In
case of doubt, splicing may be globally disabled using the global &quot;<a href="#nosplice">nosplice</a>&quot;
keyword.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>option splice-auto
</code></pre>
</div><pre class="text">If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20splice-request">option splice-request</a>&quot;, &quot;<a href="#option%20splice-response">option splice-response</a>&quot;, and global options &quot;<a href="#nosplice">nosplice</a>&quot; and &quot;<a href="#maxpipes">maxpipes</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option splice-request"></a><a class="anchor" name="4-option splice-request"></a><a class="anchor" name="4.2-option splice-request"></a><a class="anchor" name="option splice-request (Proxies)"></a><a class="anchor" name="option splice-request (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option splice-request"></a><a href="#4.2-option%20splice-request">option splice-request</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option splice-request"></a><a class="anchor" name="4-no option splice-request"></a><a class="anchor" name="4.2-no option splice-request"></a><a class="anchor" name="no option splice-request (Proxies)"></a><a class="anchor" name="no option splice-request (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option splice-request"></a><a href="#4.2-no%20option%20splice-request">no option splice-request</a></b></div><pre class="text">Enable or disable automatic kernel acceleration on sockets for requests

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">When this option is enabled either on a frontend or on a backend, HAProxy
will use kernel tcp splicing whenever possible to forward data going from
the client to the server. It might still use the recv/send scheme if there
are no spare pipes left. This option requires splicing to be enabled at
compile time, and may be globally disabled with the global option &quot;<a href="#nosplice">nosplice</a>&quot;.
Since splice uses pipes, using it requires that there are enough spare pipes.

Important note: see &quot;<a href="#option%20splice-auto">option splice-auto</a>&quot; for usage limitations.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>option splice-request
</code></pre>
</div><pre class="text">If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20splice-auto">option splice-auto</a>&quot;, &quot;<a href="#option%20splice-response">option splice-response</a>&quot;, and global options &quot;<a href="#nosplice">nosplice</a>&quot; and &quot;<a href="#maxpipes">maxpipes</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option splice-response"></a><a class="anchor" name="4-option splice-response"></a><a class="anchor" name="4.2-option splice-response"></a><a class="anchor" name="option splice-response (Proxies)"></a><a class="anchor" name="option splice-response (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option splice-response"></a><a href="#4.2-option%20splice-response">option splice-response</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option splice-response"></a><a class="anchor" name="4-no option splice-response"></a><a class="anchor" name="4.2-no option splice-response"></a><a class="anchor" name="no option splice-response (Proxies)"></a><a class="anchor" name="no option splice-response (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option splice-response"></a><a href="#4.2-no%20option%20splice-response">no option splice-response</a></b></div><pre class="text">Enable or disable automatic kernel acceleration on sockets for responses

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">When this option is enabled either on a frontend or on a backend, HAProxy
will use kernel tcp splicing whenever possible to forward data going from
the server to the client. It might still use the recv/send scheme if there
are no spare pipes left. This option requires splicing to be enabled at
compile time, and may be globally disabled with the global option &quot;<a href="#nosplice">nosplice</a>&quot;.
Since splice uses pipes, using it requires that there are enough spare pipes.

Important note: see &quot;<a href="#option%20splice-auto">option splice-auto</a>&quot; for usage limitations.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>option splice-response
</code></pre>
</div><pre class="text">If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20splice-auto">option splice-auto</a>&quot;, &quot;<a href="#option%20splice-request">option splice-request</a>&quot;, and global options &quot;<a href="#nosplice">nosplice</a>&quot; and &quot;<a href="#maxpipes">maxpipes</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option spop-check"></a><a class="anchor" name="4-option spop-check"></a><a class="anchor" name="4.2-option spop-check"></a><a class="anchor" name="option spop-check (Proxies)"></a><a class="anchor" name="option spop-check (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option spop-check"></a><a href="#4.2-option%20spop-check">option spop-check</a></b></div><pre class="text">Use SPOP health checks for server testing

May be used in the following contexts: tcp
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">It is possible to test that the server correctly talks SPOP protocol instead
of just testing that it accepts the TCP connection. When this option is set,
a HELLO handshake is performed between HAProxy and the server, and the
response is analyzed to check no error is reported.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>option spop-check
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httpchk">option httpchk</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option srvtcpka"></a><a class="anchor" name="4-option srvtcpka"></a><a class="anchor" name="4.2-option srvtcpka"></a><a class="anchor" name="option srvtcpka (Proxies)"></a><a class="anchor" name="option srvtcpka (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option srvtcpka"></a><a href="#4.2-option%20srvtcpka">option srvtcpka</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option srvtcpka"></a><a class="anchor" name="4-no option srvtcpka"></a><a class="anchor" name="4.2-no option srvtcpka"></a><a class="anchor" name="no option srvtcpka (Proxies)"></a><a class="anchor" name="no option srvtcpka (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option srvtcpka"></a><a href="#4.2-no%20option%20srvtcpka">no option srvtcpka</a></b></div><pre class="text">Enable or disable the sending of TCP keepalive packets on the server side

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">When there is a firewall or any session-aware component between a client and
a server, and when the protocol involves very long sessions with long idle
periods (e.g. remote desktops), there is a risk that one of the intermediate
components decides to expire a session which has remained idle for too long.

Enabling socket-level TCP keep-alives makes the system regularly send packets
to the other end of the connection, leaving it active. The delay between
keep-alive probes is controlled by the system only and depends both on the
operating system and its tuning parameters.

It is important to understand that keep-alive packets are neither emitted nor
received at the application level. It is only the network stacks which sees
them. For this reason, even if one side of the proxy already uses keep-alives
to maintain its connection alive, those keep-alive packets will not be
forwarded to the other side of the proxy.

Please note that this has nothing to do with HTTP keep-alive.

Using option &quot;<a href="#option%20srvtcpka">srvtcpka</a>&quot; enables the emission of TCP keep-alive probes on the
server side of a connection, which should help when session expirations are
noticed between HAProxy and a server.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20clitcpka">option clitcpka</a>&quot;, &quot;<a href="#option%20tcpka">option tcpka</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option ssl-hello-chk"></a><a class="anchor" name="4-option ssl-hello-chk"></a><a class="anchor" name="4.2-option ssl-hello-chk"></a><a class="anchor" name="option ssl-hello-chk (Proxies)"></a><a class="anchor" name="option ssl-hello-chk (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option ssl-hello-chk"></a><a href="#4.2-option%20ssl-hello-chk">option ssl-hello-chk</a></b></div><pre class="text">Use SSLv3 client hello health checks for server testing

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">When some SSL-based protocols are relayed in TCP mode through HAProxy, it is
possible to test that the server correctly talks SSL instead of just testing
that it accepts the TCP connection. When &quot;<a href="#option%20ssl-hello-chk">option ssl-hello-chk</a>&quot; is set, pure
SSLv3 client hello messages are sent once the connection is established to
the server, and the response is analyzed to find an SSL server hello message.
The server is considered valid only when the response contains this server
hello message.

All servers tested till there correctly reply to SSLv3 client hello messages,
and most servers tested do not even log the requests containing only hello
messages, which is appreciable.

Note that this check works even when SSL support was not built into HAProxy
because it forges the SSL message. When SSL support is available, it is best
to use native SSL health checks instead of this one.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#option%20httpchk">option httpchk</a>&quot;, &quot;<a href="#check-ssl">check-ssl</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option tcp-check"></a><a class="anchor" name="4-option tcp-check"></a><a class="anchor" name="4.2-option tcp-check"></a><a class="anchor" name="option tcp-check (Proxies)"></a><a class="anchor" name="option tcp-check (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option tcp-check"></a><a href="#4.2-option%20tcp-check">option tcp-check</a></b></div><pre class="text">Perform health checks using tcp-check send/expect sequences

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">This health check method is intended to be combined with &quot;<a href="#option%20tcp-check">tcp-check</a>&quot; command
lists in order to support send/expect types of health check sequences.

TCP checks currently support 4 modes of operations :
  - no &quot;<a href="#option%20tcp-check">tcp-check</a>&quot; directive : the health check only consists in a connection
    attempt, which remains the default mode.

  - &quot;<a href="#tcp-check%20send">tcp-check send</a>&quot; or &quot;<a href="#tcp-check%20send-binary">tcp-check send-binary</a>&quot; only is mentioned : this is
    used to send a string along with a connection opening. With some
    protocols, it helps sending a &quot;QUIT&quot; message for example that prevents
    the server from logging a connection error for each health check. The
    check result will still be based on the ability to open the connection
    only.

  - &quot;<a href="#tcp-check%20expect">tcp-check expect</a>&quot; only is mentioned : this is used to test a banner.
    The connection is opened and HAProxy waits for the server to present some
    contents which must validate some rules. The check result will be based
    on the matching between the contents and the rules. This is suited for
    POP, IMAP, SMTP, FTP, SSH, TELNET.

  - both &quot;<a href="#tcp-check%20send">tcp-check send</a>&quot; and &quot;<a href="#tcp-check%20expect">tcp-check expect</a>&quot; are mentioned : this is
    used to test a hello-type protocol. HAProxy sends a message, the server
    responds and its response is analyzed. the check result will be based on
    the matching between the response contents and the rules. This is often
    suited for protocols which require a binding or a request/response model.
    LDAP, MySQL, Redis and SSL are example of such protocols, though they
    already all have their dedicated checks with a deeper understanding of
    the respective protocols.
    In this mode, many questions may be sent and many answers may be
    analyzed.

A fifth mode can be used to insert comments in different steps of the script.

For each tcp-check rule you create, you can add a &quot;comment&quot; directive,
followed by a string. This string will be reported in the log and stderr in
debug mode. It is useful to make user-friendly error reporting.  The
&quot;comment&quot; is of course optional.

During the execution of a health check, a variable scope is made available to
store data samples, using the &quot;<a href="#tcp-check%20set-var">tcp-check set-var</a>&quot; operation. Freeing those
variable is possible using &quot;<a href="#tcp-check%20unset-var">tcp-check unset-var</a>&quot;.
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code><span class="comment"># perform a POP check (analyze only server's banner)</span>
option tcp-check
tcp-check expect string +OK\ POP3\ ready comment POP\ protocol

<span class="comment"># perform an IMAP check (analyze only server's banner)</span>
option tcp-check
tcp-check expect string *\ OK\ IMAP4\ ready comment IMAP\ protocol

<span class="comment"># look for the redis master server after ensuring it speaks well</span>
<span class="comment"># redis protocol, then it exits properly.</span>
<span class="comment"># (send a command then analyze the response 3 times)</span>
option tcp-check
tcp-check comment PING\ phase
tcp-check send PING\r\n
tcp-check expect string +PONG
tcp-check comment role\ check
tcp-check send info\ replication\r\n
tcp-check expect string role:master
tcp-check comment QUIT\ phase
tcp-check send QUIT\r\n
tcp-check expect string +OK

forge a HTTP request, then analyze the response
(send many headers before analyzing)
option tcp-check
tcp-check comment forge\ and\ send\ HTTP\ request
tcp-check send HEAD\ /\ HTTP/1.1\r\n
tcp-check send Host:\ www.mydomain.com\r\n
tcp-check send User-Agent:\ HAProxy\ tcpcheck\r\n
tcp-check send \r\n
tcp-check expect rstring HTTP/1\..\ (2..|3..) comment check\ HTTP\ response
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#tcp-check%20connect">tcp-check connect</a>&quot;, &quot;<a href="#tcp-check%20expect">tcp-check expect</a>&quot; and &quot;<a href="#tcp-check%20send">tcp-check send</a>&quot;.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option tcp-smart-accept"></a><a class="anchor" name="4-option tcp-smart-accept"></a><a class="anchor" name="4.2-option tcp-smart-accept"></a><a class="anchor" name="option tcp-smart-accept (Proxies)"></a><a class="anchor" name="option tcp-smart-accept (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option tcp-smart-accept"></a><a href="#4.2-option%20tcp-smart-accept">option tcp-smart-accept</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option tcp-smart-accept"></a><a class="anchor" name="4-no option tcp-smart-accept"></a><a class="anchor" name="4.2-no option tcp-smart-accept"></a><a class="anchor" name="no option tcp-smart-accept (Proxies)"></a><a class="anchor" name="no option tcp-smart-accept (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option tcp-smart-accept"></a><a href="#4.2-no%20option%20tcp-smart-accept">no option tcp-smart-accept</a></b></div><pre class="text">Enable or disable the saving of one ACK packet during the accept sequence

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">When an HTTP connection request comes in, the system acknowledges it on
behalf of HAProxy, then the client immediately sends its request, and the
system acknowledges it too while it is notifying HAProxy about the new
connection. HAProxy then reads the request and responds. This means that we
have one TCP ACK sent by the system for nothing, because the request could
very well be acknowledged by HAProxy when it sends its response.

For this reason, in HTTP mode, HAProxy automatically asks the system to avoid
sending this useless ACK on platforms which support it (currently at least
Linux). It must not cause any problem, because the system will send it anyway
after 40 ms if the response takes more time than expected to come.

During complex network debugging sessions, it may be desirable to disable
this optimization because delayed ACKs can make troubleshooting more complex
when trying to identify where packets are delayed. It is then possible to
fall back to normal behavior by specifying &quot;<a href="#no%20option%20tcp-smart-accept">no option tcp-smart-accept</a>&quot;.

It is also possible to force it for non-HTTP proxies by simply specifying
&quot;<a href="#option%20tcp-smart-accept">option tcp-smart-accept</a>&quot;. For instance, it can make sense with some services
such as SMTP where the server speaks first.

It is recommended to avoid forcing this option in a defaults section. In case
of doubt, consider setting it back to automatic values by prepending the
&quot;default&quot; keyword before it, or disabling it using the &quot;no&quot; keyword.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20tcp-smart-connect">option tcp-smart-connect</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option tcp-smart-connect"></a><a class="anchor" name="4-option tcp-smart-connect"></a><a class="anchor" name="4.2-option tcp-smart-connect"></a><a class="anchor" name="option tcp-smart-connect (Proxies)"></a><a class="anchor" name="option tcp-smart-connect (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option tcp-smart-connect"></a><a href="#4.2-option%20tcp-smart-connect">option tcp-smart-connect</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option tcp-smart-connect"></a><a class="anchor" name="4-no option tcp-smart-connect"></a><a class="anchor" name="4.2-no option tcp-smart-connect"></a><a class="anchor" name="no option tcp-smart-connect (Proxies)"></a><a class="anchor" name="no option tcp-smart-connect (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option tcp-smart-connect"></a><a href="#4.2-no%20option%20tcp-smart-connect">no option tcp-smart-connect</a></b></div><pre class="text">Enable or disable the saving of one ACK packet during the connect sequence

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">On certain systems (at least Linux), HAProxy can ask the kernel not to
immediately send an empty ACK upon a connection request, but to directly
send the buffer request instead. This saves one packet on the network and
thus boosts performance. It can also be useful for some servers, because they
immediately get the request along with the incoming connection.

This feature is enabled when &quot;<a href="#option%20tcp-smart-connect">option tcp-smart-connect</a>&quot; is set in a backend.
It is not enabled by default because it makes network troubleshooting more
complex.

It only makes sense to enable it with protocols where the client speaks first
such as HTTP. In other situations, if there is no data to send in place of
the ACK, a normal ACK is sent.

If this option has been enabled in a &quot;defaults&quot; section, it can be disabled
in a specific instance by prepending the &quot;no&quot; keyword before it.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20tcp-smart-accept">option tcp-smart-accept</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option tcpka"></a><a class="anchor" name="4-option tcpka"></a><a class="anchor" name="4.2-option tcpka"></a><a class="anchor" name="option tcpka (Proxies)"></a><a class="anchor" name="option tcpka (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option tcpka"></a><a href="#4.2-option%20tcpka">option tcpka</a></b></div><pre class="text">Enable or disable the sending of TCP keepalive packets on both sides

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">When there is a firewall or any session-aware component between a client and
a server, and when the protocol involves very long sessions with long idle
periods (e.g. remote desktops), there is a risk that one of the intermediate
components decides to expire a session which has remained idle for too long.

Enabling socket-level TCP keep-alives makes the system regularly send packets
to the other end of the connection, leaving it active. The delay between
keep-alive probes is controlled by the system only and depends both on the
operating system and its tuning parameters.

It is important to understand that keep-alive packets are neither emitted nor
received at the application level. It is only the network stacks which sees
them. For this reason, even if one side of the proxy already uses keep-alives
to maintain its connection alive, those keep-alive packets will not be
forwarded to the other side of the proxy.

Please note that this has nothing to do with HTTP keep-alive.

Using option &quot;<a href="#option%20tcpka">tcpka</a>&quot; enables the emission of TCP keep-alive probes on both
the client and server sides of a connection. Note that this is meaningful
only in &quot;defaults&quot; or &quot;listen&quot; sections. If this option is used in a
frontend, only the client side will get keep-alives, and if this option is
used in a backend, only the server side will get keep-alives. For this
reason, it is strongly recommended to explicitly use &quot;<a href="#option%20clitcpka">option clitcpka</a>&quot; and
&quot;<a href="#option%20srvtcpka">option srvtcpka</a>&quot; when the configuration is split between frontends and
backends.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20clitcpka">option clitcpka</a>&quot;, &quot;<a href="#option%20srvtcpka">option srvtcpka</a>&quot;</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option tcplog"></a><a class="anchor" name="4-option tcplog"></a><a class="anchor" name="4.2-option tcplog"></a><a class="anchor" name="option tcplog (Proxies)"></a><a class="anchor" name="option tcplog (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option tcplog"></a><a href="#4.2-option%20tcplog">option tcplog</a></b> <span style="color: #008">[clf]</span></div><pre class="text">Enable advanced logging of TCP connections with stream state and timers

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">clf       if the &quot;clf&quot; argument is added, then the output format will be
          the CLF format instead of HAProxy's default TCP format. You can
          use this when you need to feed HAProxy's logs through a specific
          log analyzer which only support the CLF format and which is not
          extensible.  Since this expects an HTTP format some of the
          values have been pre set. The http request will show as TCP and
          the response code will show as 000.</pre>
</div>
<pre class="text">By default, the log output format is very poor, as it only contains the
source and destination addresses, and the instance name. By specifying
&quot;<a href="#option%20tcplog">option tcplog</a>&quot;, each log line turns into a much richer format including, but
not limited to, the connection timers, the stream status, the connections
numbers, the frontend, backend and server name, and of course the source
address and ports. This option is useful for pure TCP proxies in order to
find which of the client or server disconnects or times out. For normal HTTP
proxies, it's better to use &quot;<a href="#option%20httplog">option httplog</a>&quot; which is even more complete.

&quot;<a href="#option%20tcplog">option tcplog</a>&quot; overrides any previous &quot;<a href="#log-format">log-format</a>&quot; directive.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20httplog">option httplog</a>&quot;, and <a href="#8">section 8</a> about logging.</div>
<a class="anchor" name="option"></a><a class="anchor" name="4-option"></a><a class="anchor" name="4.2-option"></a><a class="anchor" name="option (Proxies)"></a><a class="anchor" name="option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="option transparent"></a><a class="anchor" name="4-option transparent"></a><a class="anchor" name="4.2-option transparent"></a><a class="anchor" name="option transparent (Proxies)"></a><a class="anchor" name="option transparent (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="option transparent"></a><a href="#4.2-option%20transparent">option transparent</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="4-no"></a><a class="anchor" name="4.2-no"></a><a class="anchor" name="no (Proxies)"></a><a class="anchor" name="no (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option"></a><a class="anchor" name="4-no option"></a><a class="anchor" name="4.2-no option"></a><a class="anchor" name="no option (Proxies)"></a><a class="anchor" name="no option (Alphabetically sorted keywords reference)"></a><a class="anchor" name="no option transparent"></a><a class="anchor" name="4-no option transparent"></a><a class="anchor" name="4.2-no option transparent"></a><a class="anchor" name="no option transparent (Proxies)"></a><a class="anchor" name="no option transparent (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="no option transparent"></a><a href="#4.2-no%20option%20transparent">no option transparent</a></b></div><pre class="text">Enable client-side transparent proxying

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">This option was introduced in order to provide layer 7 persistence to layer 3
load balancers. The idea is to use the OS's ability to redirect an incoming
connection for a remote address to a local process (here HAProxy), and let
this process know what address was initially requested. When this option is
used, sessions without cookies will be forwarded to the original destination
IP address of the incoming request (which should match that of another
equipment), while requests with cookies will still be forwarded to the
appropriate server.

Note that contrary to a common belief, this option does NOT make HAProxy
present the client's IP to the server when establishing the connection.
</pre><div class="page-header"><b>See also:</b> the &quot;usesrc&quot; argument of the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">source<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#source%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#source%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword, and the &quot;<a href="#option%20transparent">transparent</a>&quot; option of the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword.</div>
<a class="anchor" name="external-check"></a><a class="anchor" name="4-external-check"></a><a class="anchor" name="4.2-external-check"></a><a class="anchor" name="external-check (Proxies)"></a><a class="anchor" name="external-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="external-check command"></a><a class="anchor" name="4-external-check command"></a><a class="anchor" name="4.2-external-check command"></a><a class="anchor" name="external-check command (Proxies)"></a><a class="anchor" name="external-check command (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="external-check command"></a><a href="#4.2-external-check%20command">external-check command</a></b> <span style="color: #080">&lt;command&gt;</span></div><pre class="text">Executable to run when performing an external-check

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;command&gt; is the external command to run</pre>
</div>
<pre class="text">The arguments passed to the to the command are:

&lt;proxy_address&gt; &lt;proxy_port&gt; &lt;server_address&gt; &lt;server_port&gt;

The &lt;proxy_address&gt; and &lt;proxy_port&gt; are derived from the first listener
that is either IPv4, IPv6 or a UNIX socket. In the case of a UNIX socket
listener the proxy_address will be the path of the socket and the
&lt;proxy_port&gt; will be the string &quot;NOT_USED&quot;. In a backend section, it's not
possible to determine a listener, and both &lt;proxy_address&gt; and &lt;proxy_port&gt;
will have the string value &quot;NOT_USED&quot;.

Some values are also provided through environment variables.

Environment variables :
  HAPROXY_PROXY_ADDR      The first bind address if available (or empty if not
                          applicable, for example in a &quot;backend&quot; section).

  HAPROXY_PROXY_ID        The backend id.

  HAPROXY_PROXY_NAME      The backend name.

  HAPROXY_PROXY_PORT      The first bind port if available (or empty if not
                          applicable, for example in a &quot;backend&quot; section or
                          for a UNIX socket).

  HAPROXY_SERVER_ADDR     The server address.

  HAPROXY_SERVER_CURCONN  The current number of connections on the server.

  HAPROXY_SERVER_ID       The server id.

  HAPROXY_SERVER_MAXCONN  The server max connections.

  HAPROXY_SERVER_NAME     The server name.

  HAPROXY_SERVER_PORT     The server port if available (or empty for a UNIX
                          socket).

  HAPROXY_SERVER_SSL      &quot;0&quot; when SSL is not used, &quot;1&quot; when it is used

  HAPROXY_SERVER_PROTO    The protocol used by this server, which can be one
                          of &quot;cli&quot; (the haproxy CLI), &quot;syslog&quot; (syslog TCP
                          server), &quot;<a href="#peers">peers</a>&quot; (peers TCP server), &quot;h1&quot; (HTTP/1.x
                          server), &quot;h2&quot; (HTTP/2 server), or &quot;tcp&quot; (any other
                          TCP server).

  PATH                    The PATH environment variable used when executing
                          the command may be set using &quot;<a href="#external-check%20path">external-check path</a>&quot;.

If the command executed and exits with a zero status then the check is
considered to have passed, otherwise the check is considered to have
failed.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>external-check command /bin/true
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">external-check<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#external-check%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#external-check%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#option%20external-check">option external-check</a>&quot;, &quot;<a href="#external-check%20path">external-check path</a>&quot;</div>
<a class="anchor" name="external-check"></a><a class="anchor" name="4-external-check"></a><a class="anchor" name="4.2-external-check"></a><a class="anchor" name="external-check (Proxies)"></a><a class="anchor" name="external-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="external-check path"></a><a class="anchor" name="4-external-check path"></a><a class="anchor" name="4.2-external-check path"></a><a class="anchor" name="external-check path (Proxies)"></a><a class="anchor" name="external-check path (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="external-check path"></a><a href="#4.2-external-check%20path">external-check path</a></b> <span style="color: #080">&lt;path&gt;</span></div><pre class="text">The value of the PATH environment variable used when running an external-check

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;path&gt; is the path used when executing external command to run</pre>
</div>
<pre class="text">The default path is &quot;&quot;.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>external-check path &quot;/usr/bin:/bin&quot;
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">external-check<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#external-check%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#external-check%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#option%20external-check">option external-check</a>&quot;, &quot;<a href="#external-check%20command">external-check command</a>&quot;</div>
<a class="anchor" name="persist"></a><a class="anchor" name="4-persist"></a><a class="anchor" name="4.2-persist"></a><a class="anchor" name="persist (Proxies)"></a><a class="anchor" name="persist (Alphabetically sorted keywords reference)"></a><a class="anchor" name="persist rdp-cookie"></a><a class="anchor" name="4-persist rdp-cookie"></a><a class="anchor" name="4.2-persist rdp-cookie"></a><a class="anchor" name="persist rdp-cookie (Proxies)"></a><a class="anchor" name="persist rdp-cookie (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="persist rdp-cookie"></a><a href="#4.2-persist%20rdp-cookie">persist rdp-cookie</a></b></div><a class="anchor" name="persist"></a><a class="anchor" name="4-persist"></a><a class="anchor" name="4.2-persist"></a><a class="anchor" name="persist (Proxies)"></a><a class="anchor" name="persist (Alphabetically sorted keywords reference)"></a><a class="anchor" name="persist rdp-cookie"></a><a class="anchor" name="4-persist rdp-cookie"></a><a class="anchor" name="4.2-persist rdp-cookie"></a><a class="anchor" name="persist rdp-cookie (Proxies)"></a><a class="anchor" name="persist rdp-cookie (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="persist rdp-cookie"></a><a href="#4.2-persist%20rdp-cookie">persist rdp-cookie</a></b>(<span style="color: #080">&lt;name&gt;</span>)</div><pre class="text">Enable RDP cookie-based persistence

May be used in the following contexts: tcp
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;name&gt;    is the optional name of the RDP cookie to check. If omitted, the
          default cookie name &quot;msts&quot; will be used. There currently is no
          valid reason to change this name.</pre>
</div>
<pre class="text">This statement enables persistence based on an RDP cookie. The RDP cookie
contains all information required to find the server in the list of known
servers. So when this option is set in the backend, the request is analyzed
and if an RDP cookie is found, it is decoded. If it matches a known server
which is still UP (or if &quot;<a href="#option%20persist">option persist</a>&quot; is set), then the connection is
forwarded to this server.

Note that this only makes sense in a TCP backend, but for this to work, the
frontend must have waited long enough to ensure that an RDP cookie is present
in the request buffer. This is the same requirement as with the &quot;rdp-cookie&quot;
load-balancing method. Thus it is highly recommended to put all statements in
a single &quot;listen&quot; section.

Also, it is important to understand that the terminal server will emit this
RDP cookie only if it is configured for &quot;token redirection mode&quot;, which means
that the &quot;IP address redirection&quot; option is disabled.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>listen tse-farm
    bind :3389
    <span class="comment"># wait up to 5s for an RDP cookie in the request</span>
    tcp-request inspect-delay 5s
    tcp-request content accept if RDP_COOKIE
    <span class="comment"># apply RDP cookie persistence</span>
    persist rdp-cookie
    <span class="comment"># if server is unknown, let's balance on the same cookie.</span>
    <span class="comment"># alternatively, &quot;balance leastconn&quot; may be useful too.</span>
    balance rdp-cookie
    server srv1 1.1.1.1:3389
    server srv2 1.1.1.2:3389
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;balance rdp-cookie&quot;, &quot;<a href="#tcp-request">tcp-request</a>&quot; and the &quot;<a href="#req.rdp_cookie">req.rdp_cookie</a>&quot; ACL.</div>
<a class="anchor" name="quic-initial"></a><a class="anchor" name="4-quic-initial"></a><a class="anchor" name="4.2-quic-initial"></a><a class="anchor" name="quic-initial (Proxies)"></a><a class="anchor" name="quic-initial (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="quic-initial"></a><a href="#4.2-quic-initial">quic-initial</a></b> <span style="color: #080">&lt;action&gt;</span> <span style="color: #008">[ <span style="color: #800">{ if | unless }</span> <span style="color: #080">&lt;condition&gt;</span> ]</span></div><pre class="text">Perform an action on an incoming QUIC Initial packet. Contrary to
&quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot;, this is executed prior to any connection element
instantiation and starting and completion of the SSL handshake, which is more
efficient when wanting to reject connections attempts.

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-info pagination-centered">yes(!)<br /><img src="../css/checkmark.png" alt="yes(!)" title="yes(!)" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;action&gt;    defines the action to perform if the condition applies. See
            below.

&lt;condition&gt; is a standard layer4-only ACL-based condition (see <a href="#7">section 7</a>).
            However, QUIC initial rules are executed too early even for
            some layer4 sample fetch methods despite no configuration
            warning and may result in unspecified runtime behavior,
            although they will not crash. Consider that only internal
            samples and layer4 &quot;src*&quot; and &quot;dst*&quot; are considered as
            supported for now.</pre>
</div>
<pre class="text">This action is executed early during QUIC packet parsing. As such, only a
minimal list of actions is supported :
  - <a href="#accept">accept</a>
  - <a href="#dgram-drop">dgram-drop</a>
  - <a href="#reject">reject</a>
  - <a href="#send-retry">send-retry</a>
</pre><a class="anchor" name="rate-limit"></a><a class="anchor" name="4-rate-limit"></a><a class="anchor" name="4.2-rate-limit"></a><a class="anchor" name="rate-limit (Proxies)"></a><a class="anchor" name="rate-limit (Alphabetically sorted keywords reference)"></a><a class="anchor" name="rate-limit sessions"></a><a class="anchor" name="4-rate-limit sessions"></a><a class="anchor" name="4.2-rate-limit sessions"></a><a class="anchor" name="rate-limit sessions (Proxies)"></a><a class="anchor" name="rate-limit sessions (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="rate-limit sessions"></a><a href="#4.2-rate-limit%20sessions">rate-limit sessions</a></b> <span style="color: #080">&lt;rate&gt;</span></div><pre class="text">Set a limit on the number of new sessions accepted per second on a frontend

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;rate&gt;    The &lt;rate&gt; parameter is an integer designating the maximum number
          of new sessions per second to accept on the frontend.</pre>
</div>
<pre class="text">When the frontend reaches the specified number of new sessions per second, it
stops accepting new connections until the rate drops below the limit again.
During this time, the pending sessions will be kept in the socket's backlog
(in system buffers) and HAProxy will not even be aware that sessions are
pending. When applying very low limit on a highly loaded service, it may make
sense to increase the socket's backlog using the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">backlog<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#backlog%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#backlog%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#backlog%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; keyword.

This feature is particularly efficient at blocking connection-based attacks
or service abuse on fragile servers. Since the session rate is measured every
millisecond, it is extremely accurate. Also, the limit applies immediately,
no delay is needed at all to detect the threshold.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<div class="example-desc">Limit the connection rate on SMTP to 10 per second max</div><code>listen smtp
    mode tcp
    bind :25
    rate-limit sessions 10
    server smtp1 127.0.0.1:1025
</code></pre>
</div><pre class="text">Note : when the maximum rate is reached, the frontend's status is not changed
       but its sockets appear as &quot;WAITING&quot; in the statistics if the
       &quot;<a href="#option%20socket-stats">socket-stats</a>&quot; option is enabled.
</pre><div class="page-header"><b>See also :</b> the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">backlog<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#backlog%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#backlog%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#backlog%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; keyword and the &quot;<a href="#fe_sess_rate">fe_sess_rate</a>&quot; ACL criterion.</div>
<a class="anchor" name="redirect"></a><a class="anchor" name="4-redirect"></a><a class="anchor" name="4.2-redirect"></a><a class="anchor" name="redirect (Proxies)"></a><a class="anchor" name="redirect (Alphabetically sorted keywords reference)"></a><a class="anchor" name="redirect location"></a><a class="anchor" name="4-redirect location"></a><a class="anchor" name="4.2-redirect location"></a><a class="anchor" name="redirect location (Proxies)"></a><a class="anchor" name="redirect location (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="redirect location"></a><a href="#4.2-redirect%20location">redirect location</a></b> <span style="color: #080">&lt;loc&gt;</span> <span style="color: #008">[code <span style="color: #080">&lt;code&gt;</span>]</span> <span style="color: #080">&lt;option&gt;</span> <span style="color: #008">[<span style="color: #800">{if | unless}</span> <span style="color: #080">&lt;condition&gt;</span>]</span></div><a class="anchor" name="redirect"></a><a class="anchor" name="4-redirect"></a><a class="anchor" name="4.2-redirect"></a><a class="anchor" name="redirect (Proxies)"></a><a class="anchor" name="redirect (Alphabetically sorted keywords reference)"></a><a class="anchor" name="redirect prefix"></a><a class="anchor" name="4-redirect prefix"></a><a class="anchor" name="4.2-redirect prefix"></a><a class="anchor" name="redirect prefix (Proxies)"></a><a class="anchor" name="redirect prefix (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="redirect prefix"></a><a href="#4.2-redirect%20prefix">redirect prefix</a></b>   <span style="color: #080">&lt;pfx&gt;</span> <span style="color: #008">[code <span style="color: #080">&lt;code&gt;</span>]</span> <span style="color: #080">&lt;option&gt;</span> <span style="color: #008">[<span style="color: #800">{if | unless}</span> <span style="color: #080">&lt;condition&gt;</span>]</span></div><a class="anchor" name="redirect"></a><a class="anchor" name="4-redirect"></a><a class="anchor" name="4.2-redirect"></a><a class="anchor" name="redirect (Proxies)"></a><a class="anchor" name="redirect (Alphabetically sorted keywords reference)"></a><a class="anchor" name="redirect scheme"></a><a class="anchor" name="4-redirect scheme"></a><a class="anchor" name="4.2-redirect scheme"></a><a class="anchor" name="redirect scheme (Proxies)"></a><a class="anchor" name="redirect scheme (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="redirect scheme"></a><a href="#4.2-redirect%20scheme">redirect scheme</a></b>   <span style="color: #080">&lt;sch&gt;</span> <span style="color: #008">[code <span style="color: #080">&lt;code&gt;</span>]</span> <span style="color: #080">&lt;option&gt;</span> <span style="color: #008">[<span style="color: #800">{if | unless}</span> <span style="color: #080">&lt;condition&gt;</span>]</span></div><pre class="text">Return an HTTP redirection if/unless a condition is matched

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">If/unless the condition is matched, the HTTP request will lead to a redirect
response. If no condition is specified, the redirect applies unconditionally.
</pre><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;loc&gt;     With &quot;<a href="#redirect%20location">redirect location</a>&quot;, the exact value in &lt;loc&gt; is placed into
          the HTTP &quot;Location&quot; header. When used in an &quot;<a href="#http-request">http-request</a>&quot; rule,
          &lt;loc&gt; value follows the Custom log format rules and can include
          some dynamic values (see Custom log format in <a href="#8.2.6">section 8.2.6</a>).

&lt;pfx&gt;     With &quot;<a href="#redirect%20prefix">redirect prefix</a>&quot;, the &quot;Location&quot; header is built from the
          concatenation of &lt;pfx&gt; and the complete URI path, including the
          query string, unless the &quot;drop-query&quot; option is specified (see
          below). As a special case, if &lt;pfx&gt; equals exactly &quot;/&quot;, then
          nothing is inserted before the original URI. It allows one to
          redirect to the same URL (for instance, to insert a cookie). When
          used in an &quot;<a href="#http-request">http-request</a>&quot; rule, &lt;pfx&gt; value follows the Custom
          Log Format rules and can include some dynamic values (see Custom
          Log Format in <a href="#8.2.6">section 8.2.6</a>).

&lt;sch&gt;     With &quot;<a href="#redirect%20scheme">redirect scheme</a>&quot;, then the &quot;Location&quot; header is built by
          concatenating &lt;sch&gt; with &quot;://&quot; then the first occurrence of the
          &quot;Host&quot; header, and then the URI path, including the query string
          unless the &quot;drop-query&quot; option is specified (see below). If no
          path is found or if the path is &quot;*&quot;, then &quot;/&quot; is used instead. If
          no &quot;Host&quot; header is found, then an empty host component will be
          returned, which most recent browsers interpret as redirecting to
          the same host. This directive is mostly used to redirect HTTP to
          HTTPS. When used in an &quot;<a href="#http-request">http-request</a>&quot; rule, &lt;sch&gt; value follows
          the Custom log format rules and can include some dynamic values
          (see Custom log format in <a href="#8.2.6">section 8.2.6</a>).

&lt;code&gt;    The code is optional. It indicates which type of HTTP redirection
          is desired. Only codes 301, 302, 303, 307 and 308 are supported,
          with 302 used by default if no code is specified. 301 means
          &quot;Moved permanently&quot;, and a browser may cache the Location. 302
          means &quot;Moved temporarily&quot; and means that the browser should not
          cache the redirection. 303 is equivalent to 302 except that the
          browser will fetch the location with a GET method. 307 is just
          like 302 but makes it clear that the same method must be reused.
          Likewise, 308 replaces 301 if the same method must be used.

&lt;option&gt;  There are several options which can be specified to adjust the
          expected behavior of a redirection :

  - &quot;drop-query&quot;
    When this keyword is used in a prefix-based redirection, then the
    location will be set without any possible query-string, which is useful
    for directing users to a non-secure page for instance. It has no effect
    with a location-type redirect.

  - &quot;append-slash&quot;
    This keyword may be used in conjunction with &quot;drop-query&quot; to redirect
    users who use a URL not ending with a '/' to the same one with the '/'.
    It can be useful to ensure that search engines will only see one URL.
    For this, a return code 301 is preferred.

  - &quot;ignore-empty&quot;
    This keyword only has effect when a location is produced using a log
    format expression (i.e. when used in http-request or http-response).
    It indicates that if the result of the expression is empty, the rule
    should silently be skipped. The main use is to allow mass-redirects
    of known paths using a simple map.

  - &quot;set-cookie NAME[=value]&quot;
    A &quot;Set-Cookie&quot; header will be added with NAME (and optionally &quot;=value&quot;)
    to the response. This is sometimes used to indicate that a user has
    been seen, for instance to protect against some types of DoS. No other
    cookie option is added, so the cookie will be a session cookie. Note
    that for a browser, a sole cookie name without an equal sign is
    different from a cookie with an equal sign.

  - &quot;set-cookie-fmt &lt;fmt&gt;&quot;
    It is equivaliant to the option above, except the &quot;Set-Cookie&quot; header
    will be filled with the result of the log-format string &lt;fmt&gt;
    evaluation. Be carefull to respect the &quot;NAME[=value]&quot; format because no
    special check are performed during the configuration parsing.

  - &quot;clear-cookie NAME[=]&quot;
    A &quot;Set-Cookie&quot; header will be added with NAME (and optionally &quot;=&quot;), but
    with the &quot;Max-Age&quot; attribute set to zero. This will tell the browser to
    delete this cookie. It is useful for instance on logout pages. It is
    important to note that clearing the cookie &quot;NAME&quot; will not remove a
    cookie set with &quot;NAME=value&quot;. You have to clear the cookie &quot;NAME=&quot; for
    that, because the browser makes the difference.

  - &quot;keep-query&quot;
    When this keyword is used in a location-based redirection, then the
    query-string of the original URI, if any, will be appended to the
    location. If no query-string is found, nothing is added. If the
    location already contains a query-string, the original one will be
    appended with the '&amp;' delimiter.</pre>
</div>
<div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<div class="example-desc">Move the login URL only to HTTPS.</div><code>acl clear      dst_port  80
acl secure     dst_port  8080
acl login_page url_beg   /login
acl logout     url_beg   /logout
acl uid_given  url_reg   /login?userid=[^&amp;]+
acl cookie_set hdr_sub(cookie) SEEN=1

redirect prefix   https://mysite.com set-cookie SEEN=1 if !cookie_set
redirect prefix   https://mysite.com           if login_page !secure
redirect prefix   http://mysite.com drop-query if login_page !uid_given
redirect location http://mysite.com/           if !login_page secure
redirect location / clear-cookie USERID=       if logout
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<div class="example-desc">Send redirects for request for articles without a '/'.</div><code>acl missing_slash path_reg ^/article/[^/]*$
redirect code 301 prefix / drop-query append-slash if missing_slash
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<div class="example-desc">Redirect all HTTP traffic to HTTPS when SSL is handled by HAProxy.</div><code>redirect scheme https if !{ ssl_fc }
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<div class="example-desc">Append 'www.' prefix in front of all hosts not having it</div><code>http-request redirect code 301 location      \
  http://www.%[hdr(host)]%[capture.req.uri]  \
  unless { hdr_beg(host) -i www }
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<div class="example-desc">Permanently redirect only old URLs to new ones</div><code>http-request redirect code 301 location               \
  %[path,map_str(old-blog-articles.map)] ignore-empty
</code></pre>
</div><pre class="text">See <a href="#7">section 7</a> about ACL usage.
</pre><a class="anchor" name="retries"></a><a class="anchor" name="4-retries"></a><a class="anchor" name="4.2-retries"></a><a class="anchor" name="retries (Proxies)"></a><a class="anchor" name="retries (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="retries"></a><a href="#4.2-retries">retries</a></b> <span style="color: #080">&lt;value&gt;</span></div><pre class="text">Set the number of retries to perform on a server after a failure

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;value&gt;   is the number of times a request or connection attempt should be
          retried on a server after a failure.</pre>
</div>
<pre class="text">By default, retries apply only to new connection attempts. However, when
the &quot;<a href="#retry-on">retry-on</a>&quot; directive is used, other conditions might trigger a retry
(e.g. empty response, undesired status code), and each of them will count
one attempt, and when the total number attempts reaches the value here, an
error will be returned.

In order to avoid immediate reconnections to a server which is restarting,
a turn-around timer of min(&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout connect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20connect%20%28Rings%29">Rings</a></li><li><a href="#timeout%20connect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, one second) is applied before
a retry occurs on the same server.

When &quot;<a href="#option%20redispatch">option redispatch</a>&quot; is set, some retries may be performed on another
server even if a cookie references a different server. By default this will
only be the last retry unless an argument is passed to &quot;<a href="#option%20redispatch">option redispatch</a>&quot;.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20redispatch">option redispatch</a>&quot;</div>
<a class="anchor" name="retry-on"></a><a class="anchor" name="4-retry-on"></a><a class="anchor" name="4.2-retry-on"></a><a class="anchor" name="retry-on (Proxies)"></a><a class="anchor" name="retry-on (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="retry-on"></a><a href="#4.2-retry-on">retry-on</a></b> <span style="color: #008">[space-delimited list of keywords]</span></div><pre class="text">Specify when to attempt to automatically retry a failed request.
This setting is only valid when &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">mode<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#mode%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#mode%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; is set to http and is silently ignored
otherwise.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;keywords&gt;  is a space-delimited list of keywords or HTTP status codes, each
            representing a type of failure event on which an attempt to
            retry the request is desired. Please read the notes at the
            bottom before changing this setting. The following keywords are
            supported :

  none              never retry

  conn-failure      retry when the connection or the SSL handshake failed
                    and the request could not be sent. This is the default.

  empty-response    retry when the server connection was closed after part
                    of the request was sent, and nothing was received from
                    the server. This type of failure may be caused by the
                    request timeout on the server side, poor network
                    condition, or a server crash or restart while
                    processing the request.

  junk-response     retry when the server returned something not looking
                    like a complete HTTP response. This includes partial
                    responses headers as well as non-HTTP contents. It
                    usually is a bad idea to retry on such events, which
                    may be caused a configuration issue (wrong server port)
                    or by the request being harmful to the server (buffer
                    overflow attack for example).

  response-timeout  the server timeout stroke while waiting for the server
                    to respond to the request. This may be caused by poor
                    network condition, the reuse of an idle connection
                    which has expired on the path, or by the request being
                    extremely expensive to process. It generally is a bad
                    idea to retry on such events on servers dealing with
                    heavy database processing (full scans, etc) as it may
                    amplify denial of service attacks.

  0rtt-rejected     retry requests which were sent over early data and were
                    rejected by the server. These requests are generally
                    considered to be safe to retry.

  &lt;status&gt;          any HTTP status code among &quot;401&quot; (Unauthorized), &quot;403&quot;
                    (Forbidden), &quot;404&quot; (Not Found), &quot;408&quot; (Request Timeout),
                    &quot;421&quot; (Misdirected Request), &quot;425&quot; (Too Early),
                    &quot;429&quot; (Too Many Requests), &quot;500&quot; (Server Error),
                    &quot;501&quot; (Not Implemented), &quot;502&quot; (Bad Gateway),
                    &quot;503&quot; (Service Unavailable), &quot;504&quot; (Gateway Timeout).

  all-retryable-errors
                    retry request for any error that are considered
                    retryable. This currently activates &quot;conn-failure&quot;,
                    &quot;empty-response&quot;, &quot;junk-response&quot;, &quot;response-timeout&quot;,
                    &quot;0rtt-rejected&quot;, &quot;500&quot;, &quot;502&quot;, &quot;503&quot;, and &quot;504&quot;.</pre>
</div>
<pre class="text">Using this directive replaces any previous settings with the new ones; it is
not cumulative.

Please note that using anything other than &quot;none&quot; and &quot;conn-failure&quot; requires
to allocate a buffer and copy the whole request into it, so it has memory and
performance impacts. Requests not fitting in a single buffer will never be
retried (see the global tune.bufsize setting).

You have to make sure the application has a replay protection mechanism built
in such as a unique transaction IDs passed in requests, or that replaying the
same request has no consequence, or it is very dangerous to use any retry-on
value beside &quot;conn-failure&quot; and &quot;none&quot;. Static file servers and caches are
generally considered safe against any type of retry. Using a status code can
be useful to quickly leave a server showing an abnormal behavior (out of
memory, file system issues, etc), but in this case it may be a good idea to
immediately redispatch the connection to another server (please see &quot;option
redispatch&quot; for this). Last, it is important to understand that most causes
of failures are the requests themselves and that retrying a request causing a
server to misbehave will often make the situation even worse for this server,
or for the whole service in case of redispatch.

Unless you know exactly how the application deals with replayed requests, you
should not use this directive.

The default is &quot;conn-failure&quot;.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>retry-on 503 504
</code></pre>
</div><div class="page-header"><b>See also:</b> &quot;<a href="#retries">retries</a>&quot;, &quot;<a href="#option%20redispatch">option redispatch</a>&quot;, &quot;<a href="#tune.bufsize">tune.bufsize</a>&quot;</div>
<a class="anchor" name="server"></a><a class="anchor" name="4-server"></a><a class="anchor" name="4.2-server"></a><a class="anchor" name="server (Proxies)"></a><a class="anchor" name="server (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="server"></a><a href="#4.2-server">server</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #080">&lt;address&gt;</span><span style="color: #008">[:<span style="color: #008">[port]</span>]</span> <span style="color: #008">[param*]</span></div><pre class="text">Declare a server in a backend

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;name&gt;    is the internal name assigned to this server. This name will
          appear in logs and alerts. If &quot;<a href="#http-send-name-header">http-send-name-header</a>&quot; is
          set, it will be added to the request header sent to the server.

&lt;address&gt; is the IPv4 or IPv6 address of the server. Alternatively, a
          resolvable hostname is supported, but this name will be resolved
          during start-up. Address &quot;0.0.0.0&quot; or &quot;*&quot; has a special meaning.
          It indicates that the connection will be forwarded to the same IP
          address as the one from the client connection. This is useful in
          transparent proxy architectures where the client's connection is
          intercepted and HAProxy must forward to the original destination
          address. This is more or less what the &quot;<a href="#option%20transparent">transparent</a>&quot; keyword does
          except that with a server it's possible to limit concurrency and
          to report statistics. Optionally, an address family prefix may be
          used before the address to force the family regardless of the
          address format, which can be useful to specify a path to a unix
          socket with no slash ('/'). Currently supported prefixes are :
                - 'ipv4@'  -&gt; address is always IPv4
                - 'ipv6@'  -&gt; address is always IPv6
                - 'unix@'  -&gt; address is a path to a local unix socket
                - 'abns@'  -&gt; address is in abstract namespace (Linux only)
                - 'abnsz@'  -&gt; address is in abstract namespace (Linux only)
                   but it is explicitly zero-terminated. This means no \0
                   padding is used to complete sun_path. It is useful to
                   interconnect with programs that don't implement the
                   default abns naming logic that haproxy uses.
                - 'sockpair@' -&gt; address is the FD of a connected unix
                  socket or of a socketpair. During a connection, the
                  backend creates a pair of connected sockets, and passes
                  one of them over the FD. The bind part will use the
                  received socket as the client FD. Should be used
                  carefully.
                - 'rhttp@' [ EXPERIMENTAL ] -&gt; custom address family for a
                  passive server in HTTP reverse context. This is an
                  experimental features which requires
                  &quot;<a href="#expose-experimental-directives">expose-experimental-directives</a>&quot; on a line before this
                  server.
          You may want to reference some environment variables in the
          address parameter, see <a href="#2.3">section 2.3</a> about environment
          variables. The &quot;<a href="#init-addr">init-addr</a>&quot; setting can be used to modify the way
          IP addresses should be resolved upon startup.

&lt;port&gt;    is an optional port specification. If set, all connections will
          be sent to this port. If unset, the same port the client
          connected to will be used. The port may also be prefixed by a &quot;+&quot;
          or a &quot;-&quot;. In this case, the server's port will be determined by
          adding this value to the client's port.

&lt;param*&gt;  is a list of parameters for this server. The &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keywords
          accepts an important number of options and has a complete section
          dedicated to it. Please refer to <a href="#5">section 5</a> for more details.</pre>
</div>
<div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code>server first  10.1.1.1:1080 cookie first  check inter 1000
server second 10.1.1.2:1080 cookie second check inter 1000
server transp ipv4@
server backup &quot;${SRV_BACKUP}:1080&quot; backup
server www1_dc1 &quot;${LAN_DC1}.101:80&quot;
server www1_dc2 &quot;${LAN_DC2}.101:80&quot;
</code></pre>
</div><pre class="text">Note: regarding Linux's abstract namespace sockets, &quot;abns&quot; HAProxy sockets
      uses the whole sun_path length is used for the address length. Some
      other programs such as socat use the string length only by default.
      Pass the option &quot;,unix-tightsocklen=0&quot; to any abstract socket
      definition in socat to make it compatible with HAProxy's, or use the
      &quot;abnsz&quot; HAProxy socket family instead.
</pre><div class="page-header"><b>See also:</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#http-send-name-header">http-send-name-header</a>&quot; and <a href="#5">section 5</a> about server options</div>
<a class="anchor" name="server-state-file-name"></a><a class="anchor" name="4-server-state-file-name"></a><a class="anchor" name="4.2-server-state-file-name"></a><a class="anchor" name="server-state-file-name (Proxies)"></a><a class="anchor" name="server-state-file-name (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="server-state-file-name"></a><a href="#4.2-server-state-file-name">server-state-file-name</a></b> <span style="color: #008">[ <span style="color: #800">{ use-backend-name | <span style="color: #080">&lt;file&gt;</span> }</span> ]</span></div><pre class="text">Set the server state file to read, load and apply to servers available in
this backend.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">It only applies when the directive &quot;<a href="#load-server-state-from-file">load-server-state-from-file</a>&quot; is set to
&quot;local&quot;. When &lt;file&gt; is not provided, if &quot;use-backend-name&quot; is used or if
this directive is not set, then backend name is used. If &lt;file&gt; starts with a
slash '/', then it is considered as an absolute path. Otherwise, &lt;file&gt; is
concatenated to the global directive &quot;<a href="#server-state-base">server-state-base</a>&quot;.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<div class="example-desc">The minimal configuration below would make HAProxy look for the state server file '/etc/haproxy/states/bk':</div><code>global
  server-state-file-base /etc/haproxy/states

backend bk
  load-server-state-from-file
</code></pre>
</div><div class="page-header"><b>See also:</b> &quot;<a href="#server-state-base">server-state-base</a>&quot;, &quot;<a href="#load-server-state-from-file">load-server-state-from-file</a>&quot;, and &quot;show servers state&quot;</div>
<a class="anchor" name="server-template"></a><a class="anchor" name="4-server-template"></a><a class="anchor" name="4.2-server-template"></a><a class="anchor" name="server-template (Proxies)"></a><a class="anchor" name="server-template (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="server-template"></a><a href="#4.2-server-template">server-template</a></b> <span style="color: #080">&lt;prefix&gt;</span> <span style="color: #080">&lt;num | range&gt;</span> <span style="color: #080">&lt;fqdn&gt;</span><span style="color: #008">[:<span style="color: #080">&lt;port&gt;</span>]</span> <span style="color: #008">[params*]</span></div><pre class="text">Set a template to initialize servers with shared parameters.
The names of these servers are built from &lt;prefix&gt; and &lt;num | range&gt; parameters.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments:</span><pre class="prettyprint arguments">&lt;prefix&gt;  A prefix for the server names to be built.

&lt;num | range&gt;
          If &lt;num&gt; is provided, this template initializes &lt;num&gt; servers
          with 1 up to &lt;num&gt; as server name suffixes. A range of numbers
          &lt;num_low&gt;-&lt;num_high&gt; may also be used to use &lt;num_low&gt; up to
          &lt;num_high&gt; as server name suffixes.

&lt;fqdn&gt;    A FQDN for all the servers this template initializes.

&lt;port&gt;    Same meaning as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; &lt;port&gt; argument (see &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword).

&lt;params*&gt;
          Remaining server parameters among all those supported by &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;
          keyword.</pre>
</div>
<div class="separator">
<span class="label label-success">Examples:</span>
<pre class="prettyprint">
<code><span class="comment"># Initializes 3 servers with srv1, srv2 and srv3 as names,</span>
<span class="comment"># google.com as FQDN, and health-check enabled.</span>
server-template srv 1-3 google.com:80 check

<span class="comment"># or</span>
server-template srv 3 google.com:80 check

<span class="comment"># would be equivalent to:</span>
server srv1 google.com:80 check
server srv2 google.com:80 check
server srv3 google.com:80 check
</code></pre>
</div><a class="anchor" name="source"></a><a class="anchor" name="4-source"></a><a class="anchor" name="4.2-source"></a><a class="anchor" name="source (Proxies)"></a><a class="anchor" name="source (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="source"></a><a href="#4.2-source">source</a></b> <span style="color: #080">&lt;addr&gt;</span><span style="color: #008">[:<span style="color: #080">&lt;port&gt;</span>]</span> <span style="color: #008">[usesrc <span style="color: #800">{ <span style="color: #080">&lt;addr2&gt;</span><span style="color: #008">[:<span style="color: #080">&lt;port2&gt;</span>]</span> | client | clientip }</span> ]</span></div><a class="anchor" name="source"></a><a class="anchor" name="4-source"></a><a class="anchor" name="4.2-source"></a><a class="anchor" name="source (Proxies)"></a><a class="anchor" name="source (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="source"></a><a href="#4.2-source">source</a></b> <span style="color: #080">&lt;addr&gt;</span><span style="color: #008">[:<span style="color: #080">&lt;port&gt;</span>]</span> <span style="color: #008">[usesrc <span style="color: #800">{ <span style="color: #080">&lt;addr2&gt;</span><span style="color: #008">[:<span style="color: #080">&lt;port2&gt;</span>]</span> | hdr_ip(<span style="color: #080">&lt;hdr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>) }</span> ]</span></div><a class="anchor" name="source"></a><a class="anchor" name="4-source"></a><a class="anchor" name="4.2-source"></a><a class="anchor" name="source (Proxies)"></a><a class="anchor" name="source (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="source"></a><a href="#4.2-source">source</a></b> <span style="color: #080">&lt;addr&gt;</span><span style="color: #008">[:<span style="color: #080">&lt;port&gt;</span>]</span> <span style="color: #008">[interface <span style="color: #080">&lt;name&gt;</span>]</span></div><pre class="text">Set the source address for outgoing connections

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;addr&gt;    is the IPv4 address HAProxy will bind to before connecting to a
          server. This address is also used as a source for health checks.

          The default value of 0.0.0.0 means that the system will select
          the most appropriate address to reach its destination. Optionally
          an address family prefix may be used before the address to force
          the family regardless of the address format, which can be useful
          to specify a path to a unix socket with no slash ('/'). Currently
          supported prefixes are :
            - 'ipv4@' -&gt; address is always IPv4
            - 'ipv6@' -&gt; address is always IPv6
            - 'unix@' -&gt; address is a path to a local unix socket
            - 'abns@' -&gt; address is in abstract namespace (Linux only)
            - 'abnsz@'  -&gt; address is in zero-terminated abstract namespace
                           (Linux only)

          You may want to reference some environment variables in the
          address parameter, see <a href="#2.3">section 2.3</a> about environment variables.

&lt;port&gt;    is an optional port. It is normally not needed but may be useful
          in some very specific contexts. The default value of zero means
          the system will select a free port. Note that port ranges are not
          supported in the backend. If you want to force port ranges, you
          have to specify them on each &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line.

&lt;addr2&gt;   is the IP address to present to the server when connections are
          forwarded in full transparent proxy mode. This is currently only
          supported on some patched Linux kernels. When this address is
          specified, clients connecting to the server will be presented
          with this address, while health checks will still use the address
          &lt;addr&gt;.

&lt;port2&gt;   is the optional port to present to the server when connections
          are forwarded in full transparent proxy mode (see &lt;addr2&gt; above).
          The default value of zero means the system will select a free
          port.

&lt;hdr&gt;     is the name of a HTTP header in which to fetch the IP to bind to.
          This is the name of a comma-separated header list which can
          contain multiple IP addresses. By default, the last occurrence is
          used. This is designed to work with the X-Forwarded-For header
          and to automatically bind to the client's IP address as seen
          by previous proxy, typically Stunnel. In order to use another
          occurrence from the last one, please see the &lt;occ&gt; parameter
          below. When the header (or occurrence) is not found, no binding
          is performed so that the proxy's default IP address is used. Also
          keep in mind that the header name is case insensitive, as for any
          HTTP header.

&lt;occ&gt;     is the occurrence number of a value to be used in a multi-value
          header. This is to be used in conjunction with &quot;hdr_ip(&lt;hdr&gt;)&quot;,
          in order to specify which occurrence to use for the source IP
          address. Positive values indicate a position from the first
          occurrence, 1 being the first one. Negative values indicate
          positions relative to the last one, -1 being the last one. This
          is helpful for situations where an X-Forwarded-For header is set
          at the entry point of an infrastructure and must be used several
          proxy layers away. When this value is not specified, -1 is
          assumed. Passing a zero here disables the feature.

&lt;name&gt;    is an optional interface name to which to bind to for outgoing
          traffic. On systems supporting this features (currently, only
          Linux), this allows one to bind all traffic to the server to
          this interface even if it is not the one the system would select
          based on routing tables. This should be used with extreme care.
          Note that using this option requires root privileges.</pre>
</div>
<pre class="text">The &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">source<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#source%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#source%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword is useful in complex environments where a specific
address only is allowed to connect to the servers. It may be needed when a
private address must be used through a public gateway for instance, and it is
known that the system cannot determine the adequate source address by itself.

An extension which is available on certain patched Linux kernels may be used
through the &quot;usesrc&quot; optional keyword. It makes it possible to connect to the
servers with an IP address which does not belong to the system itself. This
is called &quot;full transparent proxy mode&quot;. For this to work, the destination
servers have to route their traffic back to this address through the machine
running HAProxy, and IP forwarding must generally be enabled on this machine.

In this &quot;full transparent proxy&quot; mode, it is possible to force a specific IP
address to be presented to the servers. This is not much used in fact. A more
common use is to tell HAProxy to present the client's IP address. For this,
there are two methods :

  - present the client's IP and port addresses. This is the most transparent
    mode, but it can cause problems when IP connection tracking is enabled on
    the machine, because a same connection may be seen twice with different
    states. However, this solution presents the huge advantage of not
    limiting the system to the 64k outgoing address+port couples, because all
    of the client ranges may be used.

  - present only the client's IP address and select a spare port. This
    solution is still quite elegant but slightly less transparent (downstream
    firewalls logs will not match upstream's). It also presents the downside
    of limiting the number of concurrent connections to the usual 64k ports.
    However, since the upstream and downstream ports are different, local IP
    connection tracking on the machine will not be upset by the reuse of the
    same session.

This option sets the default source for all servers in the backend. It may
also be specified in a &quot;defaults&quot; section. Finer source address specification
is possible at the server level using the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">source<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#source%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#source%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; server option. Refer to
<a href="#5">section 5</a> for more information.

In order to work, &quot;usesrc&quot; requires root privileges, or on supported systems,
the &quot;cap_net_raw&quot; capability. See also the &quot;<a href="#setcap">setcap</a>&quot; global directive.
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code>backend private
    <span class="comment"># Connect to the servers using our 192.168.1.200 source address</span>
    source 192.168.1.200

backend transparent_ssl1
    <span class="comment"># Connect to the SSL farm from the client's source address</span>
    source 192.168.1.200 usesrc clientip

backend transparent_ssl2
    <span class="comment"># Connect to the SSL farm from the client's source address and port</span>
    <span class="comment"># not recommended if IP conntrack is present on the local machine.</span>
    source 192.168.1.200 usesrc client

backend transparent_ssl3
    <span class="comment"># Connect to the SSL farm from the client's source address. It</span>
    <span class="comment"># is more conntrack-friendly.</span>
    source 192.168.1.200 usesrc clientip

backend transparent_smtp
    <span class="comment"># Connect to the SMTP farm from the client's source address/port</span>
    <span class="comment"># with Tproxy version 4.</span>
    source 0.0.0.0 usesrc clientip

backend transparent_http
    <span class="comment"># Connect to the servers using the client's IP as seen by previous</span>
    <span class="comment"># proxy.</span>
    source 0.0.0.0 usesrc hdr_ip(x-forwarded-for,-1)
</code></pre>
</div><div class="page-header"><b>See also :</b> the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">source<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#source%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#source%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; server option in <a href="#5">section 5</a>, the Tproxy patches for the Linux kernel on www.balabit.com, the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword.</div>
<a class="anchor" name="srvtcpka-cnt"></a><a class="anchor" name="4-srvtcpka-cnt"></a><a class="anchor" name="4.2-srvtcpka-cnt"></a><a class="anchor" name="srvtcpka-cnt (Proxies)"></a><a class="anchor" name="srvtcpka-cnt (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="srvtcpka-cnt"></a><a href="#4.2-srvtcpka-cnt">srvtcpka-cnt</a></b> <span style="color: #080">&lt;count&gt;</span></div><pre class="text">Sets the maximum number of keepalive probes TCP should send before dropping
the connection on the server side.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;count&gt;   is the maximum number of keepalive probes.</pre>
</div>
<pre class="text">This keyword corresponds to the socket option TCP_KEEPCNT. If this keyword
is not specified, system-wide TCP parameter (tcp_keepalive_probes) is used.
The availability of this setting depends on the operating system. It is
known to work on Linux.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20srvtcpka">option srvtcpka</a>&quot;, &quot;<a href="#srvtcpka-idle">srvtcpka-idle</a>&quot;, &quot;<a href="#srvtcpka-intvl">srvtcpka-intvl</a>&quot;.</div>
<a class="anchor" name="srvtcpka-idle"></a><a class="anchor" name="4-srvtcpka-idle"></a><a class="anchor" name="4.2-srvtcpka-idle"></a><a class="anchor" name="srvtcpka-idle (Proxies)"></a><a class="anchor" name="srvtcpka-idle (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="srvtcpka-idle"></a><a href="#4.2-srvtcpka-idle">srvtcpka-idle</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Sets the time the connection needs to remain idle before TCP starts sending
keepalive probes, if enabled the sending of TCP keepalive packets on the
server side.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the time the connection needs to remain idle before TCP starts
          sending keepalive probes. It is specified in seconds by default,
          but can be in any other unit if the number is suffixed by the
          unit, as explained at the top of this document.</pre>
</div>
<pre class="text">This keyword corresponds to the socket option TCP_KEEPIDLE. If this keyword
is not specified, system-wide TCP parameter (tcp_keepalive_time) is used.
The availability of this setting depends on the operating system. It is
known to work on Linux.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20srvtcpka">option srvtcpka</a>&quot;, &quot;<a href="#srvtcpka-cnt">srvtcpka-cnt</a>&quot;, &quot;<a href="#srvtcpka-intvl">srvtcpka-intvl</a>&quot;.</div>
<a class="anchor" name="srvtcpka-intvl"></a><a class="anchor" name="4-srvtcpka-intvl"></a><a class="anchor" name="4.2-srvtcpka-intvl"></a><a class="anchor" name="srvtcpka-intvl (Proxies)"></a><a class="anchor" name="srvtcpka-intvl (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="srvtcpka-intvl"></a><a href="#4.2-srvtcpka-intvl">srvtcpka-intvl</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Sets the time between individual keepalive probes on the server side.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the time between individual keepalive probes. It is specified
          in seconds by default, but can be in any other unit if the number
          is suffixed by the unit, as explained at the top of this
          document.</pre>
</div>
<pre class="text">This keyword corresponds to the socket option TCP_KEEPINTVL. If this keyword
is not specified, system-wide TCP parameter (tcp_keepalive_intvl) is used.
The availability of this setting depends on the operating system. It is
known to work on Linux.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20srvtcpka">option srvtcpka</a>&quot;, &quot;<a href="#srvtcpka-cnt">srvtcpka-cnt</a>&quot;, &quot;<a href="#srvtcpka-idle">srvtcpka-idle</a>&quot;.</div>
<a class="anchor" name="stats"></a><a class="anchor" name="4-stats"></a><a class="anchor" name="4.2-stats"></a><a class="anchor" name="stats (Proxies)"></a><a class="anchor" name="stats (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stats admin"></a><a class="anchor" name="4-stats admin"></a><a class="anchor" name="4.2-stats admin"></a><a class="anchor" name="stats admin (Proxies)"></a><a class="anchor" name="stats admin (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stats admin"></a><a href="#4.2-stats%20admin">stats admin</a></b> <span style="color: #800">{ if | unless }</span> <span style="color: #080">&lt;cond&gt;</span></div><pre class="text">Enable statistics admin level if/unless a condition is matched

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">This statement enables the statistics admin level if/unless a condition is
matched.

The admin level allows to enable/disable servers from the web interface. By
default, statistics page is read-only for security reasons.

Currently, the POST request is limited to the buffer size minus the reserved
buffer space, which means that if the list of servers is too long, the
request won't be processed. It is recommended to alter few servers at a
time.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># statistics admin level only for localhost</span>
backend stats_localhost
    stats enable
    stats admin if LOCALHOST
</code></pre>
</div><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># statistics admin level always enabled because of the authentication</span>
backend stats_auth
    stats enable
    stats auth  admin:AdMiN123
    stats admin if TRUE
</code></pre>
</div><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># statistics admin level depends on the authenticated user</span>
userlist stats-auth
    group admin    users admin
    user  admin    insecure-password AdMiN123
    group readonly users haproxy
    user  haproxy  insecure-password haproxy

backend stats_auth
    stats enable
    acl AUTH       http_auth(stats-auth)
    acl AUTH_ADMIN http_auth_group(stats-auth) admin
    stats http-request auth unless AUTH
    stats admin if AUTH_ADMIN
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#stats%20enable">stats enable</a>&quot;, &quot;<a href="#stats%20auth">stats auth</a>&quot;, &quot;<a href="#stats%20http-request">stats http-request</a>&quot;, <a href="#3.4">section 3.4</a> about userlists and <a href="#7">section 7</a> about ACL usage.</div>
<a class="anchor" name="stats"></a><a class="anchor" name="4-stats"></a><a class="anchor" name="4.2-stats"></a><a class="anchor" name="stats (Proxies)"></a><a class="anchor" name="stats (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stats auth"></a><a class="anchor" name="4-stats auth"></a><a class="anchor" name="4.2-stats auth"></a><a class="anchor" name="stats auth (Proxies)"></a><a class="anchor" name="stats auth (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stats auth"></a><a href="#4.2-stats%20auth">stats auth</a></b> <span style="color: #080">&lt;user&gt;</span>:<span style="color: #080">&lt;passwd&gt;</span></div><pre class="text">Enable statistics with authentication and grant access to an account

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;user&gt;    is a user name to grant access to

&lt;passwd&gt;  is the cleartext password associated to this user</pre>
</div>
<pre class="text">This statement enables statistics with default settings, and restricts access
to declared users only. It may be repeated as many times as necessary to
allow as many users as desired. When a user tries to access the statistics
without a valid account, a &quot;401 Forbidden&quot; response will be returned so that
the browser asks the user to provide a valid user and password. The real
which will be returned to the browser is configurable using &quot;<a href="#stats%20realm">stats realm</a>&quot;.

Since the authentication method is HTTP Basic Authentication, the passwords
circulate in cleartext on the network. Thus, it was decided that the
configuration file would also use cleartext passwords to remind the users
that those ones should not be sensitive and not shared with any other account.

It is also possible to reduce the scope of the proxies which appear in the
report using &quot;<a href="#stats%20scope">stats scope</a>&quot;.

Though this statement alone is enough to enable statistics reporting, it is
recommended to set all other settings in order to avoid relying on default
unobvious parameters.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># public access (limited to this backend only)</span>
backend public_www
    server srv1 192.168.0.1:80
    stats enable
    stats hide-version
    stats scope   .
    stats uri     /admin?stats
    stats realm   HAProxy\ Statistics
    stats auth    admin1:AdMiN123
    stats auth    admin2:AdMiN321

<span class="comment"># internal monitoring access (unlimited)</span>
backend private_monitoring
    stats enable
    stats uri     /admin?stats
    stats refresh 5s
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#stats%20enable">stats enable</a>&quot;, &quot;<a href="#stats%20realm">stats realm</a>&quot;, &quot;<a href="#stats%20scope">stats scope</a>&quot;, &quot;<a href="#stats%20uri">stats uri</a>&quot;</div>
<a class="anchor" name="stats"></a><a class="anchor" name="4-stats"></a><a class="anchor" name="4.2-stats"></a><a class="anchor" name="stats (Proxies)"></a><a class="anchor" name="stats (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stats enable"></a><a class="anchor" name="4-stats enable"></a><a class="anchor" name="4.2-stats enable"></a><a class="anchor" name="stats enable (Proxies)"></a><a class="anchor" name="stats enable (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stats enable"></a><a href="#4.2-stats%20enable">stats enable</a></b></div><pre class="text">Enable statistics reporting with default settings

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">This statement enables statistics reporting with default settings defined
at build time. Unless stated otherwise, these settings are used :
  - stats uri   : /haproxy?stats
  - stats realm : &quot;HAProxy Statistics&quot;
  - stats auth  : no authentication
  - stats scope : no restriction

Though this statement alone is enough to enable statistics reporting, it is
recommended to set all other settings in order to avoid relying on default
unobvious parameters.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># public access (limited to this backend only)</span>
backend public_www
    server srv1 192.168.0.1:80
    stats enable
    stats hide-version
    stats scope   .
    stats uri     /admin?stats
    stats realm   HAProxy\ Statistics
    stats auth    admin1:AdMiN123
    stats auth    admin2:AdMiN321

<span class="comment"># internal monitoring access (unlimited)</span>
backend private_monitoring
    stats enable
    stats uri     /admin?stats
    stats refresh 5s
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#stats%20auth">stats auth</a>&quot;, &quot;<a href="#stats%20realm">stats realm</a>&quot;, &quot;<a href="#stats%20uri">stats uri</a>&quot;</div>
<a class="anchor" name="stats"></a><a class="anchor" name="4-stats"></a><a class="anchor" name="4.2-stats"></a><a class="anchor" name="stats (Proxies)"></a><a class="anchor" name="stats (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stats hide-version"></a><a class="anchor" name="4-stats hide-version"></a><a class="anchor" name="4.2-stats hide-version"></a><a class="anchor" name="stats hide-version (Proxies)"></a><a class="anchor" name="stats hide-version (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stats hide-version"></a><a href="#4.2-stats%20hide-version">stats hide-version</a></b></div><pre class="text">Enable statistics and hide HAProxy version reporting

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">By default, the stats page reports some useful status information along with
the statistics. Among them is HAProxy's version. However, it is generally
considered dangerous to report precise version to anyone, as it can help them
target known weaknesses with specific attacks. The &quot;<a href="#stats%20hide-version">stats hide-version</a>&quot;
statement removes the version from the statistics report. This is recommended
for public sites or any site with a weak login/password.

Though this statement alone is enough to enable statistics reporting, it is
recommended to set all other settings in order to avoid relying on default
unobvious parameters.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># public access (limited to this backend only)</span>
backend public_www
    server srv1 192.168.0.1:80
    stats enable
    stats hide-version
    stats scope   .
    stats uri     /admin?stats
    stats realm   HAProxy\ Statistics
    stats auth    admin1:AdMiN123
    stats auth    admin2:AdMiN321

<span class="comment"># internal monitoring access (unlimited)</span>
backend private_monitoring
    stats enable
    stats uri     /admin?stats
    stats refresh 5s
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#stats%20auth">stats auth</a>&quot;, &quot;<a href="#stats%20enable">stats enable</a>&quot;, &quot;<a href="#stats%20realm">stats realm</a>&quot;, &quot;<a href="#stats%20uri">stats uri</a>&quot;</div>
<a class="anchor" name="stats"></a><a class="anchor" name="4-stats"></a><a class="anchor" name="4.2-stats"></a><a class="anchor" name="stats (Proxies)"></a><a class="anchor" name="stats (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stats http-request"></a><a class="anchor" name="4-stats http-request"></a><a class="anchor" name="4.2-stats http-request"></a><a class="anchor" name="stats http-request (Proxies)"></a><a class="anchor" name="stats http-request (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stats http-request"></a><a href="#4.2-stats%20http-request">stats http-request</a></b> <span style="color: #800">{ allow | deny | auth <span style="color: #008">[realm <span style="color: #080">&lt;realm&gt;</span>]</span> }</span>
             <span style="color: #008">[ <span style="color: #800">{ if | unless }</span> <span style="color: #080">&lt;condition&gt;</span> ]</span></div><pre class="text">Access control for statistics

May be used in the following contexts: http
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">As &quot;<a href="#http-request">http-request</a>&quot;, these set of options allow to fine control access to
statistics. Each option may be followed by if/unless and acl.
First option with matched condition (or option without condition) is final.
For &quot;<a href="#deny">deny</a>&quot; a 403 error will be returned, for &quot;<a href="#allow">allow</a>&quot; normal processing is
performed, for &quot;<a href="#auth">auth</a>&quot; a 401/407 error code is returned so the client
should be asked to enter a username and password.

There is no fixed limit to the number of http-request statements per
instance.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#http-request">http-request</a>&quot;, <a href="#3.4">section 3.4</a> about userlists and <a href="#7">section 7</a> about ACL usage.</div>
<a class="anchor" name="stats"></a><a class="anchor" name="4-stats"></a><a class="anchor" name="4.2-stats"></a><a class="anchor" name="stats (Proxies)"></a><a class="anchor" name="stats (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stats realm"></a><a class="anchor" name="4-stats realm"></a><a class="anchor" name="4.2-stats realm"></a><a class="anchor" name="stats realm (Proxies)"></a><a class="anchor" name="stats realm (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stats realm"></a><a href="#4.2-stats%20realm">stats realm</a></b> <span style="color: #080">&lt;realm&gt;</span></div><pre class="text">Enable statistics and set authentication realm

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;realm&gt;   is the name of the HTTP Basic Authentication realm reported to
          the browser. The browser uses it to display it in the pop-up
          inviting the user to enter a valid username and password.</pre>
</div>
<pre class="text">The realm is read as a single word, so any spaces in it should be escaped
using a backslash ('\').

This statement is useful only in conjunction with &quot;<a href="#stats%20auth">stats auth</a>&quot; since it is
only related to authentication.

Though this statement alone is enough to enable statistics reporting, it is
recommended to set all other settings in order to avoid relying on default
unobvious parameters.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># public access (limited to this backend only)</span>
backend public_www
    server srv1 192.168.0.1:80
    stats enable
    stats hide-version
    stats scope   .
    stats uri     /admin?stats
    stats realm   HAProxy\ Statistics
    stats auth    admin1:AdMiN123
    stats auth    admin2:AdMiN321

<span class="comment"># internal monitoring access (unlimited)</span>
backend private_monitoring
    stats enable
    stats uri     /admin?stats
    stats refresh 5s
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#stats%20auth">stats auth</a>&quot;, &quot;<a href="#stats%20enable">stats enable</a>&quot;, &quot;<a href="#stats%20uri">stats uri</a>&quot;</div>
<a class="anchor" name="stats"></a><a class="anchor" name="4-stats"></a><a class="anchor" name="4.2-stats"></a><a class="anchor" name="stats (Proxies)"></a><a class="anchor" name="stats (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stats refresh"></a><a class="anchor" name="4-stats refresh"></a><a class="anchor" name="4.2-stats refresh"></a><a class="anchor" name="stats refresh (Proxies)"></a><a class="anchor" name="stats refresh (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stats refresh"></a><a href="#4.2-stats%20refresh">stats refresh</a></b> <span style="color: #080">&lt;delay&gt;</span></div><pre class="text">Enable statistics with automatic refresh

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;delay&gt;   is the suggested refresh delay, specified in seconds, which will
          be returned to the browser consulting the report page. While the
          browser is free to apply any delay, it will generally respect it
          and refresh the page this every seconds. The refresh interval may
          be specified in any other non-default time unit, by suffixing the
          unit after the value, as explained at the top of this document.</pre>
</div>
<pre class="text">This statement is useful on monitoring displays with a permanent page
reporting the load balancer's activity. When set, the HTML report page will
include a link &quot;refresh&quot;/&quot;stop refresh&quot; so that the user can select whether
they want automatic refresh of the page or not.

Though this statement alone is enough to enable statistics reporting, it is
recommended to set all other settings in order to avoid relying on default
unobvious parameters.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># public access (limited to this backend only)</span>
backend public_www
    server srv1 192.168.0.1:80
    stats enable
    stats hide-version
    stats scope   .
    stats uri     /admin?stats
    stats realm   HAProxy\ Statistics
    stats auth    admin1:AdMiN123
    stats auth    admin2:AdMiN321

<span class="comment"># internal monitoring access (unlimited)</span>
backend private_monitoring
    stats enable
    stats uri     /admin?stats
    stats refresh 5s
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#stats%20auth">stats auth</a>&quot;, &quot;<a href="#stats%20enable">stats enable</a>&quot;, &quot;<a href="#stats%20realm">stats realm</a>&quot;, &quot;<a href="#stats%20uri">stats uri</a>&quot;</div>
<a class="anchor" name="stats"></a><a class="anchor" name="4-stats"></a><a class="anchor" name="4.2-stats"></a><a class="anchor" name="stats (Proxies)"></a><a class="anchor" name="stats (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stats scope"></a><a class="anchor" name="4-stats scope"></a><a class="anchor" name="4.2-stats scope"></a><a class="anchor" name="stats scope (Proxies)"></a><a class="anchor" name="stats scope (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stats scope"></a><a href="#4.2-stats%20scope">stats scope</a></b> <span style="color: #800">{ <span style="color: #080">&lt;name&gt;</span> | &quot;.&quot; }</span></div><pre class="text">Enable statistics and limit access scope

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;name&gt;    is the name of a listen, frontend or backend section to be
          reported. The special name &quot;.&quot; (a single dot) designates the
          section in which the statement appears.</pre>
</div>
<pre class="text">When this statement is specified, only the sections enumerated with this
statement will appear in the report. All other ones will be hidden. This
statement may appear as many times as needed if multiple sections need to be
reported. Please note that the name checking is performed as simple string
comparisons, and that it is never checked that a give section name really
exists.

Though this statement alone is enough to enable statistics reporting, it is
recommended to set all other settings in order to avoid relying on default
unobvious parameters.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># public access (limited to this backend only)</span>
backend public_www
    server srv1 192.168.0.1:80
    stats enable
    stats hide-version
    stats scope   .
    stats uri     /admin?stats
    stats realm   HAProxy\ Statistics
    stats auth    admin1:AdMiN123
    stats auth    admin2:AdMiN321

<span class="comment"># internal monitoring access (unlimited)</span>
backend private_monitoring
    stats enable
    stats uri     /admin?stats
    stats refresh 5s
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#stats%20auth">stats auth</a>&quot;, &quot;<a href="#stats%20enable">stats enable</a>&quot;, &quot;<a href="#stats%20realm">stats realm</a>&quot;, &quot;<a href="#stats%20uri">stats uri</a>&quot;</div>
<a class="anchor" name="stats"></a><a class="anchor" name="4-stats"></a><a class="anchor" name="4.2-stats"></a><a class="anchor" name="stats (Proxies)"></a><a class="anchor" name="stats (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stats show-desc"></a><a class="anchor" name="4-stats show-desc"></a><a class="anchor" name="4.2-stats show-desc"></a><a class="anchor" name="stats show-desc (Proxies)"></a><a class="anchor" name="stats show-desc (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stats show-desc"></a><a href="#4.2-stats%20show-desc">stats show-desc</a></b> <span style="color: #008">[ <span style="color: #080">&lt;desc&gt;</span> ]</span></div><pre class="text">Enable reporting of a description on the statistics page.

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">  &lt;desc&gt;    is an optional description to be reported. If unspecified, the
            description from global section is automatically used instead.

This statement is useful for users that offer shared services to their
customers, where node or description should be different for each customer.

Though this statement alone is enough to enable statistics reporting, it is
recommended to set all other settings in order to avoid relying on default
unobvious parameters. By default description is not shown.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># internal monitoring access (unlimited)</span>
backend private_monitoring
    stats enable
    stats show-desc Master node for Europe, Asia, Africa
    stats uri       /admin?stats
    stats refresh   5s
</code></pre>
</div><div class="page-header"><b>See also:</b> &quot;show-node&quot;, &quot;<a href="#stats%20enable">stats enable</a>&quot;, &quot;<a href="#stats%20uri">stats uri</a>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">description<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#description%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#description%20%28Rings%29">Rings</a></li><li><a href="#description%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; in global section.</div>
<a class="anchor" name="stats"></a><a class="anchor" name="4-stats"></a><a class="anchor" name="4.2-stats"></a><a class="anchor" name="stats (Proxies)"></a><a class="anchor" name="stats (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stats show-legends"></a><a class="anchor" name="4-stats show-legends"></a><a class="anchor" name="4.2-stats show-legends"></a><a class="anchor" name="stats show-legends (Proxies)"></a><a class="anchor" name="stats show-legends (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stats show-legends"></a><a href="#4.2-stats%20show-legends">stats show-legends</a></b></div><pre class="text">Enable reporting additional information on the statistics page

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">Enable reporting additional information on the statistics page :
  - cap: capabilities (proxy)
  - mode: one of tcp, http or health (proxy)
  - id: SNMP ID (proxy, socket, server)
  - IP (socket, server)
  - cookie (backend, server)

Though this statement alone is enough to enable statistics reporting, it is
recommended to set all other settings in order to avoid relying on default
unobvious parameters. Default behavior is not to show this information.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#stats%20enable">stats enable</a>&quot;, &quot;<a href="#stats%20uri">stats uri</a>&quot;.</div>
<a class="anchor" name="stats"></a><a class="anchor" name="4-stats"></a><a class="anchor" name="4.2-stats"></a><a class="anchor" name="stats (Proxies)"></a><a class="anchor" name="stats (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stats show-modules"></a><a class="anchor" name="4-stats show-modules"></a><a class="anchor" name="4.2-stats show-modules"></a><a class="anchor" name="stats show-modules (Proxies)"></a><a class="anchor" name="stats show-modules (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stats show-modules"></a><a href="#4.2-stats%20show-modules">stats show-modules</a></b></div><pre class="text">Enable display of extra statistics module on the statistics page

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">New columns are added at the end of the line containing the extra statistics
values as a tooltip.

Though this statement alone is enough to enable statistics reporting, it is
recommended to set all other settings in order to avoid relying on default
unobvious parameters. Default behavior is not to show this information.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#stats%20enable">stats enable</a>&quot;, &quot;<a href="#stats%20uri">stats uri</a>&quot;.</div>
<a class="anchor" name="stats"></a><a class="anchor" name="4-stats"></a><a class="anchor" name="4.2-stats"></a><a class="anchor" name="stats (Proxies)"></a><a class="anchor" name="stats (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stats show-node"></a><a class="anchor" name="4-stats show-node"></a><a class="anchor" name="4.2-stats show-node"></a><a class="anchor" name="stats show-node (Proxies)"></a><a class="anchor" name="stats show-node (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stats show-node"></a><a href="#4.2-stats%20show-node">stats show-node</a></b> <span style="color: #008">[ <span style="color: #080">&lt;name&gt;</span> ]</span></div><pre class="text">Enable reporting of a host name on the statistics page.

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments:</span><pre class="prettyprint arguments">&lt;name&gt;    is an optional name to be reported. If unspecified, the
          node name from global section is automatically used instead.</pre>
</div>
<pre class="text">This statement is useful for users that offer shared services to their
customers, where node or description might be different on a stats page
provided for each customer. Default behavior is not to show host name.

Though this statement alone is enough to enable statistics reporting, it is
recommended to set all other settings in order to avoid relying on default
unobvious parameters.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># internal monitoring access (unlimited)</span>
backend private_monitoring
    stats enable
    stats show-node Europe-1
    stats uri       /admin?stats
    stats refresh   5s
</code></pre>
</div><div class="page-header"><b>See also:</b> &quot;show-desc&quot;, &quot;<a href="#stats%20enable">stats enable</a>&quot;, &quot;<a href="#stats%20uri">stats uri</a>&quot;, and &quot;<a href="#node">node</a>&quot; in global section.</div>
<a class="anchor" name="stats"></a><a class="anchor" name="4-stats"></a><a class="anchor" name="4.2-stats"></a><a class="anchor" name="stats (Proxies)"></a><a class="anchor" name="stats (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stats uri"></a><a class="anchor" name="4-stats uri"></a><a class="anchor" name="4.2-stats uri"></a><a class="anchor" name="stats uri (Proxies)"></a><a class="anchor" name="stats uri (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stats uri"></a><a href="#4.2-stats%20uri">stats uri</a></b> <span style="color: #080">&lt;prefix&gt;</span></div><pre class="text">Enable statistics and define the URI prefix to access them

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;prefix&gt;  is the prefix of any URI which will be redirected to stats. This
          prefix may contain a question mark ('?') to indicate part of a
          query string.</pre>
</div>
<pre class="text">The statistics URI is intercepted on the relayed traffic, so it appears as a
page within the normal application. It is strongly advised to ensure that the
selected URI will never appear in the application, otherwise it will never be
possible to reach it in the application.

The default URI compiled in HAProxy is &quot;/haproxy?stats&quot;, but this may be
changed at build time, so it's better to always explicitly specify it here.
It is generally a good idea to include a question mark in the URI so that
intermediate proxies refrain from caching the results. Also, since any string
beginning with the prefix will be accepted as a stats request, the question
mark helps ensuring that no valid URI will begin with the same words.

It is sometimes very convenient to use &quot;/&quot; as the URI prefix, and put that
statement in a &quot;listen&quot; instance of its own. That makes it easy to dedicate
an address or a port to statistics only.

Though this statement alone is enough to enable statistics reporting, it is
recommended to set all other settings in order to avoid relying on default
unobvious parameters.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># public access (limited to this backend only)</span>
backend public_www
    server srv1 192.168.0.1:80
    stats enable
    stats hide-version
    stats scope   .
    stats uri     /admin?stats
    stats realm   HAProxy\ Statistics
    stats auth    admin1:AdMiN123
    stats auth    admin2:AdMiN321

<span class="comment"># internal monitoring access (unlimited)</span>
backend private_monitoring
    stats enable
    stats uri     /admin?stats
    stats refresh 5s
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#stats%20auth">stats auth</a>&quot;, &quot;<a href="#stats%20enable">stats enable</a>&quot;, &quot;<a href="#stats%20realm">stats realm</a>&quot;</div>
<a class="anchor" name="stick"></a><a class="anchor" name="4-stick"></a><a class="anchor" name="4.2-stick"></a><a class="anchor" name="stick (Proxies)"></a><a class="anchor" name="stick (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stick match"></a><a class="anchor" name="4-stick match"></a><a class="anchor" name="4.2-stick match"></a><a class="anchor" name="stick match (Proxies)"></a><a class="anchor" name="stick match (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stick match"></a><a href="#4.2-stick%20match">stick match</a></b> <span style="color: #080">&lt;pattern&gt;</span> <span style="color: #008">[table <span style="color: #080">&lt;table&gt;</span>]</span> <span style="color: #008">[<span style="color: #800">{if | unless}</span> <span style="color: #080">&lt;cond&gt;</span>]</span></div><pre class="text">Define a request pattern matching condition to stick a user to a server

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;pattern&gt;  is a sample expression rule as described in <a href="#7.3">section 7.3</a>. It
           describes what elements of the incoming request or connection
           will be analyzed in the hope to find a matching entry in a
           stickiness table. This rule is mandatory.

&lt;table&gt;    is an optional stickiness table name. If unspecified, the same
           backend's table is used. A stickiness table is declared using
           the &quot;<a href="#stick-table">stick-table</a>&quot; statement.

&lt;cond&gt;     is an optional matching condition. It makes it possible to match
           on a certain criterion only when other conditions are met (or
           not met). For instance, it could be used to match on a source IP
           address except when a request passes through a known proxy, in
           which case we'd match on a header containing that IP address.</pre>
</div>
<pre class="text">Some protocols or applications require complex stickiness rules and cannot
always simply rely on cookies nor hashing. The &quot;<a href="#stick%20match">stick match</a>&quot; statement
describes a rule to extract the stickiness criterion from an incoming request
or connection. See <a href="#7">section 7</a> for a complete list of possible patterns and
transformation rules.

The table has to be declared using the &quot;<a href="#stick-table">stick-table</a>&quot; statement. It must be of
a type compatible with the pattern. By default it is the one which is present
in the same backend. It is possible to share a table with other backends by
referencing it using the &quot;<a href="#table">table</a>&quot; keyword. If another table is referenced,
the server's ID inside the backends are used. By default, all server IDs
start at 1 in each backend, so the server ordering is enough. But in case of
doubt, it is highly recommended to force server IDs using their &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">id<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#id%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#id%20%28Bind%20options%29">Bind options</a></li><li><a href="#id%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; setting.

It is possible to restrict the conditions where a &quot;<a href="#stick%20match">stick match</a>&quot; statement
will apply, using &quot;if&quot; or &quot;unless&quot; followed by a condition. See <a href="#7">section 7</a> for
ACL based conditions.

There is no limit on the number of &quot;<a href="#stick%20match">stick match</a>&quot; statements. The first that
applies and matches will cause the request to be directed to the same server
as was used for the request which created the entry. That way, multiple
matches can be used as fallbacks.

The stick rules are checked after the persistence cookies, so they will not
affect stickiness if a cookie has already been used to select a server. That
way, it becomes very easy to insert cookies and match on IP addresses in
order to maintain stickiness between HTTP and HTTPS.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># forward SMTP users to the same server they just used for POP in the</span>
<span class="comment"># last 30 minutes</span>
backend pop
    mode tcp
    balance roundrobin
    stick store-request src
    stick-table type ip size 200k expire 30m
    server s1 192.168.1.1:110
    server s2 192.168.1.1:110

backend smtp
    mode tcp
    balance roundrobin
    stick match src table pop
    server s1 192.168.1.1:25
    server s2 192.168.1.1:25
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#stick-table">stick-table</a>&quot;, &quot;<a href="#stick%20on">stick on</a>&quot;, and <a href="#7">section 7</a> about ACLs and samples fetching.</div>
<a class="anchor" name="stick"></a><a class="anchor" name="4-stick"></a><a class="anchor" name="4.2-stick"></a><a class="anchor" name="stick (Proxies)"></a><a class="anchor" name="stick (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stick on"></a><a class="anchor" name="4-stick on"></a><a class="anchor" name="4.2-stick on"></a><a class="anchor" name="stick on (Proxies)"></a><a class="anchor" name="stick on (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stick on"></a><a href="#4.2-stick%20on">stick on</a></b> <span style="color: #080">&lt;pattern&gt;</span> <span style="color: #008">[table <span style="color: #080">&lt;table&gt;</span>]</span> <span style="color: #008">[<span style="color: #800">{if | unless}</span> <span style="color: #080">&lt;condition&gt;</span>]</span></div><pre class="text">Define a request pattern to associate a user to a server

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">Note : This form is exactly equivalent to &quot;<a href="#stick%20match">stick match</a>&quot; followed by
       &quot;<a href="#stick%20store-request">stick store-request</a>&quot;, all with the same arguments. Please refer
       to both keywords for details. It is only provided as a convenience
       for writing more maintainable configurations.
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code><span class="comment"># The following form ...</span>
stick on src table pop if !localhost

<span class="comment"># ...is strictly equivalent to this one :</span>
stick match src table pop if !localhost
stick store-request src table pop if !localhost


<span class="comment"># Use cookie persistence for HTTP, and stick on source address for HTTPS as</span>
<span class="comment"># well as HTTP without cookie. Share the same table between both accesses.</span>
backend http
    mode http
    balance roundrobin
    stick on src table https
    cookie SRV insert indirect nocache
    server s1 192.168.1.1:80 cookie s1
    server s2 192.168.1.1:80 cookie s2

backend https
    mode tcp
    balance roundrobin
    stick-table type ip size 200k expire 30m
    stick on src
    server s1 192.168.1.1:443
    server s2 192.168.1.1:443
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#stick%20match">stick match</a>&quot;, &quot;<a href="#stick%20store-request">stick store-request</a>&quot;.</div>
<a class="anchor" name="stick"></a><a class="anchor" name="4-stick"></a><a class="anchor" name="4.2-stick"></a><a class="anchor" name="stick (Proxies)"></a><a class="anchor" name="stick (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stick store-request"></a><a class="anchor" name="4-stick store-request"></a><a class="anchor" name="4.2-stick store-request"></a><a class="anchor" name="stick store-request (Proxies)"></a><a class="anchor" name="stick store-request (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stick store-request"></a><a href="#4.2-stick%20store-request">stick store-request</a></b> <span style="color: #080">&lt;pattern&gt;</span> <span style="color: #008">[table <span style="color: #080">&lt;table&gt;</span>]</span> <span style="color: #008">[<span style="color: #800">{if | unless}</span> <span style="color: #080">&lt;condition&gt;</span>]</span></div><pre class="text">Define a request pattern used to create an entry in a stickiness table

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;pattern&gt;  is a sample expression rule as described in <a href="#7.3">section 7.3</a>. It
           describes what elements of the incoming request or connection
           will be analyzed, extracted and stored in the table once a
           server is selected.

&lt;table&gt;    is an optional stickiness table name. If unspecified, the same
           backend's table is used. A stickiness table is declared using
           the &quot;<a href="#stick-table">stick-table</a>&quot; statement.

&lt;cond&gt;     is an optional storage condition. It makes it possible to store
           certain criteria only when some conditions are met (or not met).
           For instance, it could be used to store the source IP address
           except when the request passes through a known proxy, in which
           case we'd store a converted form of a header containing that IP
           address.</pre>
</div>
<pre class="text">Some protocols or applications require complex stickiness rules and cannot
always simply rely on cookies nor hashing. The &quot;<a href="#stick%20store-request">stick store-request</a>&quot; statement
describes a rule to decide what to extract from the request and when to do
it, in order to store it into a stickiness table for further requests to
match it using the &quot;<a href="#stick%20match">stick match</a>&quot; statement. Obviously the extracted part must
make sense and have a chance to be matched in a further request. Storing a
client's IP address for instance often makes sense. Storing an ID found in a
URL parameter also makes sense. Storing a source port will almost never make
any sense because it will be randomly matched. See <a href="#7">section 7</a> for a complete
list of possible patterns and transformation rules.

The table has to be declared using the &quot;<a href="#stick-table">stick-table</a>&quot; statement. It must be of
a type compatible with the pattern. By default it is the one which is present
in the same backend. It is possible to share a table with other backends by
referencing it using the &quot;<a href="#table">table</a>&quot; keyword. If another table is referenced,
the server's ID inside the backends are used. By default, all server IDs
start at 1 in each backend, so the server ordering is enough. But in case of
doubt, it is highly recommended to force server IDs using their &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">id<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#id%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#id%20%28Bind%20options%29">Bind options</a></li><li><a href="#id%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; setting.

It is possible to restrict the conditions where a &quot;<a href="#stick%20store-request">stick store-request</a>&quot;
statement will apply, using &quot;if&quot; or &quot;unless&quot; followed by a condition. This
condition will be evaluated while parsing the request, so any criteria can be
used. See <a href="#7">section 7</a> for ACL based conditions.

There is no limit on the number of &quot;<a href="#stick%20store-request">stick store-request</a>&quot; statements, but
there is a limit of 8 simultaneous stores per request or response. This
makes it possible to store up to 8 criteria, all extracted from either the
request or the response, regardless of the number of rules. Only the 8 first
ones which match will be kept. Using this, it is possible to feed multiple
tables at once in the hope to increase the chance to recognize a user on
another protocol or access method. Using multiple store-request rules with
the same table is possible and may be used to find the best criterion to rely
on, by arranging the rules by decreasing preference order. Only the first
extracted criterion for a given table will be stored. All subsequent store-
request rules referencing the same table will be skipped and their ACLs will
not be evaluated.

The &quot;store-request&quot; rules are evaluated once the server connection has been
established, so that the table will contain the real server that processed
the request.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># forward SMTP users to the same server they just used for POP in the</span>
<span class="comment"># last 30 minutes</span>
backend pop
    mode tcp
    balance roundrobin
    stick store-request src
    stick-table type ip size 200k expire 30m
    server s1 192.168.1.1:110
    server s2 192.168.1.1:110

backend smtp
    mode tcp
    balance roundrobin
    stick match src table pop
    server s1 192.168.1.1:25
    server s2 192.168.1.1:25
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#stick-table">stick-table</a>&quot;, &quot;<a href="#stick%20on">stick on</a>&quot;, about ACLs and sample fetching.</div>
<a class="anchor" name="stick-table"></a><a class="anchor" name="4-stick-table"></a><a class="anchor" name="4.2-stick-table"></a><a class="anchor" name="stick-table (Proxies)"></a><a class="anchor" name="stick-table (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stick-table type"></a><a class="anchor" name="4-stick-table type"></a><a class="anchor" name="4.2-stick-table type"></a><a class="anchor" name="stick-table type (Proxies)"></a><a class="anchor" name="stick-table type (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stick-table type"></a><a href="#4.2-stick-table%20type">stick-table type</a></b> <span style="color: #800">{ip | integer | string <span style="color: #008">[len <span style="color: #080">&lt;length&gt;</span>]</span> | binary <span style="color: #008">[len <span style="color: #080">&lt;length&gt;</span>]</span>}</span>
            size <span style="color: #080">&lt;size&gt;</span> <span style="color: #008">[expire <span style="color: #080">&lt;expire&gt;</span>]</span> <span style="color: #008">[nopurge]</span> <span style="color: #008">[peers <span style="color: #080">&lt;peersect&gt;</span>]</span> <span style="color: #008">[srvkey <span style="color: #080">&lt;srvkey&gt;</span>]</span>
            <span style="color: #008">[write-to <span style="color: #080">&lt;wtable&gt;</span>]</span> <span style="color: #008">[store <span style="color: #080">&lt;data_type&gt;</span>]</span>* <span style="color: #008">[brates-factor <span style="color: #080">&lt;factor&gt;</span>]</span></div><pre class="text">Configure the stickiness table for the current section

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments"> ip         a table declared with &quot;type ip&quot; will only store IPv4 addresses.
            This form is very compact (about 50 bytes per entry) and allows
            very fast entry lookup and stores with almost no overhead. This
            is mainly used to store client source IP addresses.

 ipv6       a table declared with &quot;type ipv6&quot; will only store IPv6 addresses.
            This form is very compact (about 60 bytes per entry) and allows
            very fast entry lookup and stores with almost no overhead. This
            is mainly used to store client source IP addresses.

 integer    a table declared with &quot;type integer&quot; will store 32bit integers
            which can represent a client identifier found in a request for
            instance.

 string     a table declared with &quot;type string&quot; will store substrings of up
            to &lt;len&gt; characters. If the string provided by the pattern
            extractor is larger than &lt;len&gt;, it will be truncated before
            being stored. During matching, at most &lt;len&gt; characters will be
            compared between the string in the table and the extracted
            pattern. When not specified, the string is automatically limited
            to 32 characters.

 binary     a table declared with &quot;type binary&quot; will store binary blocks
            of &lt;len&gt; bytes. If the block provided by the pattern
            extractor is larger than &lt;len&gt;, it will be truncated before
            being stored. If the block provided by the sample expression
            is shorter than &lt;len&gt;, it will be padded by 0. When not
            specified, the block is automatically limited to 32 bytes.

 &lt;length&gt;   is the maximum number of characters that will be stored in a
            &quot;string&quot; type table (See type &quot;string&quot; above). Or the number
            of bytes of the block in &quot;binary&quot; type table. Be careful when
            changing this parameter as memory usage will proportionally
            increase.

 &lt;size&gt;     is the maximum number of entries that can fit in the table. This
            value directly impacts memory usage. Count approximately
            50 bytes per entry, plus the size of a string if any. The size
            supports suffixes &quot;k&quot;, &quot;m&quot;, &quot;g&quot; for 2^10, 2^20 and 2^30 factors.

 [nopurge]  indicates that we refuse to purge older entries when the table
            is full. When not specified and the table is full when HAProxy
            wants to store an entry in it, it will flush a few of the oldest
            entries in order to release some space for the new ones. This is
            most often the desired behavior. In some specific cases, it
            be desirable to refuse new entries instead of purging the older
            ones. That may be the case when the amount of data to store is
            far above the hardware limits and we prefer not to offer access
            to new clients than to reject the ones already connected. When
            using this parameter, be sure to properly set the &quot;expire&quot;
            parameter (see below).

 &lt;peersect&gt; is the name of the peers section to use for replication. Entries
            which associate keys to server IDs are kept synchronized with
            the remote peers declared in this section. All entries are also
            automatically learned from the local peer (old process) during a
            soft restart.

&lt;wtable&gt;    is the name of the stick table where peers updates will be
            written to in addition to the source table. &lt;wtable&gt; must be of
            the same type as the table being defined and must have the same
            key length, and source table cannot be used as a target table
            itself. Every time an entry update will be received on the source
            table through a peer, haproxy will try to refresh related
            &lt;wtable&gt; entry. If the entry doesn't exist yet, it will be
            created, else its values will be updated as well as its timer.
            Note that only types that are not involved in arithmetic ops such
            as server_id, server_key and gpt will be written to &lt;wtable&gt; to
            prevent processed values from a remote table from interfering with
            arithmetic operations performed on the local target table.
            (ie: prevent shared cumulative counter from growing indefinitely)
            One common use of this option is to be able to use sticking rules
            (for server persistence) in a peers cluster setup, because
            matching keys will be learned from remote tables.

 &lt;expire&gt;   defines the maximum duration of an entry in the table since it
            was last created, refreshed using 'track-sc' or matched using
            'stick match' or 'stick on' rule. The expiration delay is
            defined using the standard time format, similarly as the various
            timeouts. The maximum duration is slightly above 24 days. See
            <a href="#2.5">section 2.5</a> for more information. If this delay is not specified,
            the session won't automatically expire, but older entries will
            be removed once full. Be sure not to use the &quot;nopurge&quot; parameter
            if not expiration delay is specified.
            Note: 'table_*' converters performs lookups but won't update touch
            expire since they don't require 'track-sc'.

 &lt;srvkey&gt;   specifies how each server is identified for the purposes of the
            stick table. The valid values are &quot;<a href="#name">name</a>&quot; and &quot;<a href="#addr">addr</a>&quot;. If &quot;<a href="#name">name</a>&quot; is
            given, then &lt;name&gt; argument for the server (may be generated by
            a template). If &quot;<a href="#addr">addr</a>&quot; is given, then the server is identified
            by its current network address, including the port. &quot;<a href="#addr">addr</a>&quot; is
            especially useful if you are using service discovery to generate
            the addresses for servers with peered stick-tables and want
            to consistently use the same host across peers for a stickiness
            token.

&lt;data_type&gt; is used to store additional information in the stick-table. This
            may be used by ACLs in order to control various criteria related
            to the activity of the client matching the stick-table. For each
            item specified here, the size of each entry will be inflated so
            that the additional data can fit. Several data types may be
            stored with an entry. Multiple data types may be specified after
            the &quot;store&quot; keyword, as a comma-separated list. Alternatively,
            it is possible to repeat the &quot;store&quot; keyword followed by one or
            several data types. Except for the &quot;server_id&quot; type which is
            automatically detected and enabled, all data types must be
            explicitly declared to be stored. If an ACL references a data
            type which is not stored, the ACL will simply not match. Some
            data types require an argument which must be passed just after
            the type between parenthesis. See below for the supported data
            types and their arguments.

&lt;factor&gt;    is used to define a factor to be applied on in/out bytes rate.
            Instead of counting each bytes, blocks of bytes are counted.
            Internally, rates are defined on 32-bits counters. By using this
            parameter, it is possible to have rates exceeding the 4G on the
            defined period. The factor must be greater than 0 and lower or
            equal to 1024.</pre>
</div>
<pre class="text">The data types that can be stored with an entry are the following :
  - server_id : this is an integer which holds the numeric ID of the server a
    request was assigned to. It is used by the &quot;<a href="#stick%20match">stick match</a>&quot;, &quot;stick store&quot;,
    and &quot;<a href="#stick%20on">stick on</a>&quot; rules. It is automatically enabled when referenced.

  - gpc(&lt;nb&gt;) : General Purpose Counters Array of &lt;nb&gt; elements. This is an
    array of positive 32-bit integers which may be used to count anything.
    Most of the time they will be used as a incremental counters on some
    entries, for instance to note that a limit is reached and trigger some
    actions. This array is limited to a maximum of 100 elements:
    gpc0 to gpc99, to ensure that the build of a peer update
    message can fit into the buffer. Users should take in consideration
    that a large amount of counters will increase the data size and the
    traffic load using peers protocol since all data/counters are pushed
    each time any of them is updated.
    This data_type will exclude the usage of the legacy data_types 'gpc0'
    and 'gpc1' on the same table. Using the 'gpc' array data_type, all 'gpc0'
    and 'gpc1' related fetches and actions will apply to the two first
    elements of this array.

  - gpc_rate(&lt;nb&gt;,&lt;period&gt;) : Array of increment rates of General Purpose
    Counters over a period. Those elements are positive 32-bit integers which
    may be used for anything. Just like &lt;gpc&gt;, the count events, but instead
    of keeping a cumulative number, they maintain the rate at which the
    counter is incremented. Most of the time it will be used to measure the
    frequency of occurrence of certain events (e.g. requests to a specific
    URL). This array is limited to a maximum of 100 elements: gpt(100)
    allowing the storage of gpc0 to gpc99, to ensure that the build of a peer
    update message can fit into the buffer.
    The array cannot contain less than 1 element: use gpc(1) if you want to
    store only the counter gpc0.
    Users should take in consideration that a large amount of
    counters will increase the data size and the traffic load using peers
    protocol since all data/counters are pushed each time any of them is
    updated.
    This data_type will exclude the usage of the legacy data_types
    'gpc0_rate' and 'gpc1_rate' on the same table. Using the 'gpc_rate'
    array data_type, all 'gpc0' and 'gpc1' related fetches and actions
    will apply to the two first elements of this array.

  - gpc0 : first General Purpose Counter. It is a positive 32-bit integer
    integer which may be used for anything. Most of the time it will be used
    to put a special tag on some entries, for instance to note that a
    specific behavior was detected and must be known for future matches.

  - gpc0_rate(&lt;period&gt;) : increment rate of the first General Purpose Counter
    over a period. It is a positive 32-bit integer integer which may be used
    for anything. Just like &lt;gpc0&gt;, it counts events, but instead of keeping
    a cumulative number, it maintains the rate at which the counter is
    incremented. Most of the time it will be used to measure the frequency of
    occurrence of certain events (e.g. requests to a specific URL).

  - gpc1 : second General Purpose Counter. It is a positive 32-bit integer
    integer which may be used for anything. Most of the time it will be used
    to put a special tag on some entries, for instance to note that a
    specific behavior was detected and must be known for future matches.

  - gpc1_rate(&lt;period&gt;) : increment rate of the second General Purpose Counter
    over a period. It is a positive 32-bit integer integer which may be used
    for anything. Just like &lt;gpc1&gt;, it counts events, but instead of keeping
    a cumulative number, it maintains the rate at which the counter is
    incremented. Most of the time it will be used to measure the frequency of
    occurrence of certain events (e.g. requests to a specific URL).

  - gpt(&lt;nb&gt;) : General Purpose Tags Array of &lt;nb&gt; elements. This is an array
    of positive 32-bit integers which may be used for anything.
    Most of the time they will be used to put a special tags on some entries,
    for instance to note that a specific behavior was detected and must be
    known for future matches. This array is limited to a maximum of 100
    elements: gpt(100) allowing the storage of gpt0 to gpt99, to ensure that
    the build of a peer update message can fit into the buffer.
    The array cannot contain less than 1 element: use gpt(1) if you want to
    to store only the tag gpt0.
    Users should take in consideration that a large amount of counters will
    increase the data size and the traffic load using peers protocol since
    all data/counters are pushed each time any of them is updated.
    This data_type will exclude the usage of the legacy data_type 'gpt0'
    on the same table. Using the 'gpt' array data_type, all 'gpt0' related
    fetches and actions will apply to the first element of this array.

  - gpt0 : first General Purpose Tag. It is a positive 32-bit integer
    integer which may be used for anything. Most of the time it will be used
    to put a special tag on some entries, for instance to note that a
    specific behavior was detected and must be known for future matches

  - conn_cnt : Connection Count. It is a positive 32-bit integer which counts
    the absolute number of connections received from clients which matched
    this entry. It does not mean the connections were accepted, just that
    they were received.

  - conn_cur : Current Connections. It is a positive 32-bit integer which
    stores the concurrent connection counts for the entry. It is incremented
    once an incoming connection matches the entry, and decremented once the
    connection leaves. That way it is possible to know at any time the exact
    number of concurrent connections for an entry.

  - conn_rate(&lt;period&gt;) : frequency counter (takes 12 bytes). It takes an
    integer parameter &lt;period&gt; which indicates in milliseconds the length
    of the period over which the average is measured. It reports the average
    incoming connection rate over that period, in connections per period. The
    result is an integer which can be matched using ACLs.

  - sess_cnt : Session Count. It is a positive 32-bit integer which counts
    the absolute number of sessions received from clients which matched this
    entry. A session is a connection that was accepted by the layer 4 rules.

  - sess_rate(&lt;period&gt;) : frequency counter (takes 12 bytes). It takes an
    integer parameter &lt;period&gt; which indicates in milliseconds the length
    of the period over which the average is measured. It reports the average
    incoming session rate over that period, in sessions per period. The
    result is an integer which can be matched using ACLs.

  - http_req_cnt : HTTP request Count. It is a positive 32-bit integer which
    counts the absolute number of HTTP requests received from clients which
    matched this entry. It does not matter whether they are valid requests or
    not. Note that this is different from sessions when keep-alive is used on
    the client side.

  - http_req_rate(&lt;period&gt;) : frequency counter (takes 12 bytes). It takes an
    integer parameter &lt;period&gt; which indicates in milliseconds the length
    of the period over which the average is measured. It reports the average
    HTTP request rate over that period, in requests per period. The result is
    an integer which can be matched using ACLs. It does not matter whether
    they are valid requests or not. Note that this is different from sessions
    when keep-alive is used on the client side.

  - http_err_cnt : HTTP Error Count. It is a positive 32-bit integer which
    counts the absolute number of HTTP requests errors induced by clients
    which matched this entry. Errors are counted on invalid and truncated
    requests, as well as on denied or tarpitted requests, and on failed
    authentications. If the server responds with 4xx, then the request is
    also counted as an error since it's an error triggered by the client
    (e.g. vulnerability scan).

  - http_err_rate(&lt;period&gt;) : frequency counter (takes 12 bytes). It takes an
    integer parameter &lt;period&gt; which indicates in milliseconds the length
    of the period over which the average is measured. It reports the average
    HTTP request error rate over that period, in requests per period (see
    http_err_cnt above for what is accounted as an error). The result is an
    integer which can be matched using ACLs.

  - http_fail_cnt : HTTP Failure Count. It is a positive 32-bit integer which
    counts the absolute number of HTTP response failures induced by servers
    which matched this entry. Errors are counted on invalid and truncated
    responses, as well as any 5xx response other than 501 or 505. It aims at
    being used combined with path or URI to detect service failures.

  - http_fail_rate(&lt;period&gt;) : frequency counter (takes 12 bytes). It takes
    an integer parameter &lt;period&gt; which indicates in milliseconds the length
    of the period over which the average is measured. It reports the average
    HTTP response failure rate over that period, in requests per period (see
    http_fail_cnt above for what is accounted as a failure). The result is an
    integer which can be matched using ACLs.

  - bytes_in_cnt : client to server byte count. It is a positive 64-bit
    integer which counts the cumulative number of bytes received from clients
    which matched this entry. Headers are included in the count. This may be
    used to limit abuse of upload features on photo or video servers.

  - bytes_in_rate(&lt;period&gt;) : frequency counter (takes 12 bytes). It takes an
    integer parameter &lt;period&gt; which indicates in milliseconds the length
    of the period over which the average is measured. It reports the average
    incoming bytes rate over that period, in bytes per period. It may be used
    to detect users which upload too much and too fast. Warning: with large
    uploads, it is possible that the amount of uploaded data will be counted
    once upon termination, thus causing spikes in the average transfer speed
    instead of having a smooth one. This may partially be smoothed with
    &quot;<a href="#option%20contstats">option contstats</a>&quot; though this is not perfect yet. Use of byte_in_cnt is
    recommended for better fairness.

  - bytes_out_cnt : server to client byte count. It is a positive 64-bit
    integer which counts the cumulative number of bytes sent to clients which
    matched this entry. Headers are included in the count. This may be used
    to limit abuse of bots sucking the whole site.

  - bytes_out_rate(&lt;period&gt;) : frequency counter (takes 12 bytes). It takes
    an integer parameter &lt;period&gt; which indicates in milliseconds the length
    of the period over which the average is measured. It reports the average
    outgoing bytes rate over that period, in bytes per period. It may be used
    to detect users which download too much and too fast. Warning: with large
    transfers, it is possible that the amount of transferred data will be
    counted once upon termination, thus causing spikes in the average
    transfer speed instead of having a smooth one. This may partially be
    smoothed with &quot;<a href="#option%20contstats">option contstats</a>&quot; though this is not perfect yet. Use of
    byte_out_cnt is recommended for better fairness.

  - glitch_cnt : front glitches count. It is a positive 32-bit integer which
    counts the cumulative number of glitches reported on a front connection.
    Glitches correspond to either unusual or unexpected actions (protocol-
    wise) from the client that could indicate a badly defective client or
    possibly an attacker. As such, this counter can help in order to decide
    how to act with them in such case.

  - glitch_rate(&lt;period&gt;) : frequency counter (takes 12 bytes). It takes an
    integer parameter &lt;period&gt; which indicates in milliseconds the length of
    the period over which the average is measured. It reports the average
    front glitches rate over that period. It may be used to detect defective
    clients or potential attackers that perform uncommon or unexpected
    actions from a protocol point of view, provided that HAProxy flagged them
    them as such.

There is only one stick-table per proxy. At the moment of writing this doc,
it does not seem useful to have multiple tables per proxy. If this happens
to be required, simply create a dummy backend with a stick-table in it and
reference it.

It is important to understand that stickiness based on learning information
has some limitations, including the fact that all learned associations are
lost upon restart unless peers are properly configured to transfer such
information upon restart (recommended). In general it can be good as a
complement but not always as an exclusive stickiness.

Last, memory requirements may be important when storing many data types.
Indeed, storing all indicators above at once in each entry requires 116 bytes
per entry, or 116 MB for a 1-million entries table. This is definitely not
something that can be ignored.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># Keep track of counters of up to 1 million IP addresses over 5 minutes</span>
<span class="comment"># and store a general purpose counter and the average connection rate</span>
<span class="comment"># computed over a sliding window of 30 seconds.</span>
stick-table type ip size 1m expire 5m store gpc0,conn_rate(30s)
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#stick%20match">stick match</a>&quot;, &quot;<a href="#stick%20on">stick on</a>&quot;, &quot;<a href="#stick%20store-request">stick store-request</a>&quot;, <a href="#2.5">section 2.5</a> about time format and <a href="#7">section 7</a> about ACLs.</div>
<a class="anchor" name="stick"></a><a class="anchor" name="4-stick"></a><a class="anchor" name="4.2-stick"></a><a class="anchor" name="stick (Proxies)"></a><a class="anchor" name="stick (Alphabetically sorted keywords reference)"></a><a class="anchor" name="stick store-response"></a><a class="anchor" name="4-stick store-response"></a><a class="anchor" name="4.2-stick store-response"></a><a class="anchor" name="stick store-response (Proxies)"></a><a class="anchor" name="stick store-response (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="stick store-response"></a><a href="#4.2-stick%20store-response">stick store-response</a></b> <span style="color: #080">&lt;pattern&gt;</span> <span style="color: #008">[table <span style="color: #080">&lt;table&gt;</span>]</span> <span style="color: #008">[<span style="color: #800">{if | unless}</span> <span style="color: #080">&lt;condition&gt;</span>]</span></div><pre class="text">Define a response pattern used to create an entry in a stickiness table

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;pattern&gt;  is a sample expression rule as described in <a href="#7.3">section 7.3</a>. It
           describes what elements of the response or connection will
           be analyzed, extracted and stored in the table once a
           server is selected.

&lt;table&gt;    is an optional stickiness table name. If unspecified, the same
           backend's table is used. A stickiness table is declared using
           the &quot;<a href="#stick-table">stick-table</a>&quot; statement.

&lt;cond&gt;     is an optional storage condition. It makes it possible to store
           certain criteria only when some conditions are met (or not met).
           For instance, it could be used to store the SSL session ID only
           when the response is a SSL server hello.</pre>
</div>
<pre class="text">Some protocols or applications require complex stickiness rules and cannot
always simply rely on cookies nor hashing. The &quot;<a href="#stick%20store-response">stick store-response</a>&quot;
statement  describes a rule to decide what to extract from the response and
when to do it, in order to store it into a stickiness table for further
requests to match it using the &quot;<a href="#stick%20match">stick match</a>&quot; statement. Obviously the
extracted part must make sense and have a chance to be matched in a further
request. Storing an ID found in a header of a response makes sense.
See <a href="#7">section 7</a> for a complete list of possible patterns and transformation
rules.

The table has to be declared using the &quot;<a href="#stick-table">stick-table</a>&quot; statement. It must be of
a type compatible with the pattern. By default it is the one which is present
in the same backend. It is possible to share a table with other backends by
referencing it using the &quot;<a href="#table">table</a>&quot; keyword. If another table is referenced,
the server's ID inside the backends are used. By default, all server IDs
start at 1 in each backend, so the server ordering is enough. But in case of
doubt, it is highly recommended to force server IDs using their &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">id<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#id%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#id%20%28Bind%20options%29">Bind options</a></li><li><a href="#id%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; setting.

It is possible to restrict the conditions where a &quot;<a href="#stick%20store-response">stick store-response</a>&quot;
statement will apply, using &quot;if&quot; or &quot;unless&quot; followed by a condition. This
condition will be evaluated while parsing the response, so any criteria can
be used. See <a href="#7">section 7</a> for ACL based conditions.

There is no limit on the number of &quot;<a href="#stick%20store-response">stick store-response</a>&quot; statements, but
there is a limit of 8 simultaneous stores per request or response. This
makes it possible to store up to 8 criteria, all extracted from either the
request or the response, regardless of the number of rules. Only the 8 first
ones which match will be kept. Using this, it is possible to feed multiple
tables at once in the hope to increase the chance to recognize a user on
another protocol or access method. Using multiple store-response rules with
the same table is possible and may be used to find the best criterion to rely
on, by arranging the rules by decreasing preference order. Only the first
extracted criterion for a given table will be stored. All subsequent store-
response rules referencing the same table will be skipped and their ACLs will
not be evaluated. However, even if a store-request rule references a table, a
store-response rule may also use the same table. This means that each table
may learn exactly one element from the request and one element from the
response at once.

The table will contain the real server that processed the request.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># Learn SSL session ID from both request and response and create affinity.</span>
backend https
    mode tcp
    balance roundrobin
    <span class="comment"># maximum SSL session ID length is 32 bytes.</span>
    stick-table type binary len 32 size 30k expire 30m

    acl clienthello req.ssl_hello_type 1
    acl serverhello res.ssl_hello_type 2

    <span class="comment"># use tcp content accepts to detects ssl client and server hello.</span>
    tcp-request inspect-delay 5s
    tcp-request content accept if clienthello

    <span class="comment"># no timeout on response inspect delay by default.</span>
    tcp-response content accept if serverhello

    <span class="comment"># SSL session ID (SSLID) may be present on a client or server hello.</span>
    <span class="comment"># Its length is coded on 1 byte at offset 43 and its value starts</span>
    <span class="comment"># at offset 44.</span>

    <span class="comment"># Match and learn on request if client hello.</span>
    stick on req.payload_lv(43,1) if clienthello

    <span class="comment"># Learn on response if server hello.</span>
    stick store-response resp.payload_lv(43,1) if serverhello

    server s1 192.168.1.1:443
    server s2 192.168.1.1:443
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#stick-table">stick-table</a>&quot;, &quot;<a href="#stick%20on">stick on</a>&quot;, and <a href="#7">section 7</a> about ACLs and pattern extraction.</div>
<a class="anchor" name="tcp-check"></a><a class="anchor" name="4-tcp-check"></a><a class="anchor" name="4.2-tcp-check"></a><a class="anchor" name="tcp-check (Proxies)"></a><a class="anchor" name="tcp-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="tcp-check comment"></a><a class="anchor" name="4-tcp-check comment"></a><a class="anchor" name="4.2-tcp-check comment"></a><a class="anchor" name="tcp-check comment (Proxies)"></a><a class="anchor" name="tcp-check comment (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="tcp-check comment"></a><a href="#4.2-tcp-check%20comment">tcp-check comment</a></b> <span style="color: #080">&lt;string&gt;</span></div><pre class="text">Defines a comment for the following the tcp-check rule, reported in logs if
it fails.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;string&gt;  is the comment message to add in logs if the following tcp-check
          rule fails.</pre>
</div>
<pre class="text">It only works for connect, send and expect rules. It is useful to make
user-friendly error reporting.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#option%20tcp-check">option tcp-check</a>&quot;, &quot;<a href="#tcp-check%20connect">tcp-check connect</a>&quot;, &quot;<a href="#tcp-check%20send">tcp-check send</a>&quot; and &quot;<a href="#tcp-check%20expect">tcp-check expect</a>&quot;.</div>
<a class="anchor" name="tcp-check"></a><a class="anchor" name="4-tcp-check"></a><a class="anchor" name="4.2-tcp-check"></a><a class="anchor" name="tcp-check (Proxies)"></a><a class="anchor" name="tcp-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="tcp-check connect"></a><a class="anchor" name="4-tcp-check connect"></a><a class="anchor" name="4.2-tcp-check connect"></a><a class="anchor" name="tcp-check connect (Proxies)"></a><a class="anchor" name="tcp-check connect (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="tcp-check connect"></a><a href="#4.2-tcp-check%20connect">tcp-check connect</a></b> <span style="color: #008">[default]</span> <span style="color: #008">[port <span style="color: #080">&lt;expr&gt;</span>]</span> <span style="color: #008">[addr <span style="color: #080">&lt;ip&gt;</span>]</span> <span style="color: #008">[send-proxy]</span> <span style="color: #008">[via-socks4]</span>
                  <span style="color: #008">[ssl]</span> <span style="color: #008">[sni <span style="color: #080">&lt;sni&gt;</span>]</span> <span style="color: #008">[alpn <span style="color: #080">&lt;alpn&gt;</span>]</span> <span style="color: #008">[linger]</span>
                  <span style="color: #008">[proto <span style="color: #080">&lt;name&gt;</span>]</span> <span style="color: #008">[comment <span style="color: #080">&lt;msg&gt;</span>]</span></div><pre class="text">Opens a new connection

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">comment &lt;msg&gt;  defines a message to report if the rule evaluation fails.

default      Use default options of the server line to do the health
             checks. The server options are used only if not redefined.

port &lt;expr&gt;  if not set, check port or server port is used.
             It tells HAProxy where to open the connection to.
             &lt;port&gt; must be a valid TCP port source integer, from 1 to
             65535 or an sample-fetch expression.

addr &lt;ip&gt;    defines the IP address to do the health check.

send-proxy   send a PROXY protocol string

via-socks4   enables outgoing health checks using upstream socks4 proxy.

ssl          opens a ciphered connection

sni &lt;sni&gt;    specifies the SNI to use to do health checks over SSL.

alpn &lt;alpn&gt;  defines which protocols to advertise with ALPN. The protocol
             list consists in a comma-delimited list of protocol names,
             for instance: &quot;http/1.1,http/1.0&quot; (without quotes).
             If it is not set, the server ALPN is used.

proto &lt;name&gt; forces the multiplexer's protocol to use for this connection.
             It must be a TCP mux protocol and it must be usable on the
             backend side. The list of available protocols is reported in
             haproxy -vv.

linger       cleanly close the connection instead of using a single RST.</pre>
</div>
<pre class="text">When an application lies on more than a single TCP port or when HAProxy
load-balance many services in a single backend, it makes sense to probe all
the services individually before considering a server as operational.

When there are no TCP port configured on the server line neither server port
directive, then the 'tcp-check connect port &lt;port&gt;' must be the first step
of the sequence.

In a tcp-check ruleset a 'connect' is required, it is also mandatory to start
the ruleset with a 'connect' rule. Purpose is to ensure admin know what they
do.

When a connect must start the ruleset, if may still be preceded by set-var,
unset-var or comment rules.
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code><span class="comment"># check HTTP and HTTPs services on a server.</span>
<span class="comment"># first open port 80 thanks to server line port directive, then</span>
<span class="comment"># tcp-check opens port 443, ciphered and run a request on it:</span>
option tcp-check
tcp-check connect
tcp-check send GET\ /\ HTTP/1.0\r\n
tcp-check send Host:\ haproxy.1wt.eu\r\n
tcp-check send \r\n
tcp-check expect rstring (2..|3..)
tcp-check connect port 443 ssl
tcp-check send GET\ /\ HTTP/1.0\r\n
tcp-check send Host:\ haproxy.1wt.eu\r\n
tcp-check send \r\n
tcp-check expect rstring (2..|3..)
server www 10.0.0.1 check port 80

<span class="comment"># check both POP and IMAP from a single server:</span>
option tcp-check
tcp-check connect port 110 linger
tcp-check expect string +OK\ POP3\ ready
tcp-check connect port 143
tcp-check expect string *\ OK\ IMAP4\ ready
server mail 10.0.0.1 check
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#option%20tcp-check">option tcp-check</a>&quot;, &quot;<a href="#tcp-check%20send">tcp-check send</a>&quot;, &quot;<a href="#tcp-check%20expect">tcp-check expect</a>&quot;</div>
<a class="anchor" name="tcp-check"></a><a class="anchor" name="4-tcp-check"></a><a class="anchor" name="4.2-tcp-check"></a><a class="anchor" name="tcp-check (Proxies)"></a><a class="anchor" name="tcp-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="tcp-check expect"></a><a class="anchor" name="4-tcp-check expect"></a><a class="anchor" name="4.2-tcp-check expect"></a><a class="anchor" name="tcp-check expect (Proxies)"></a><a class="anchor" name="tcp-check expect (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="tcp-check expect"></a><a href="#4.2-tcp-check%20expect">tcp-check expect</a></b> <span style="color: #008">[min-recv <span style="color: #080">&lt;int&gt;</span>]</span> <span style="color: #008">[comment <span style="color: #080">&lt;msg&gt;</span>]</span>
                 <span style="color: #008">[ok-status <span style="color: #080">&lt;st&gt;</span>]</span> <span style="color: #008">[error-status <span style="color: #080">&lt;st&gt;</span>]</span> <span style="color: #008">[tout-status <span style="color: #080">&lt;st&gt;</span>]</span>
                 <span style="color: #008">[on-success <span style="color: #080">&lt;fmt&gt;</span>]</span> <span style="color: #008">[on-error <span style="color: #080">&lt;fmt&gt;</span>]</span> <span style="color: #008">[status-code <span style="color: #080">&lt;expr&gt;</span>]</span>
                 <span style="color: #008">[!]</span> <span style="color: #080">&lt;match&gt;</span> <span style="color: #080">&lt;pattern&gt;</span></div><pre class="text">Specify data to be collected and analyzed during a generic health check

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">comment &lt;msg&gt;  defines a message to report if the rule evaluation fails.

min-recv  is optional and can define the minimum amount of data required to
          evaluate the current expect rule. If the number of received bytes
          is under this limit, the check will wait for more data. This
          option can be used to resolve some ambiguous matching rules or to
          avoid executing costly regex matches on content known to be still
          incomplete. If an exact string (string or binary) is used, the
          minimum between the string length and this parameter is used.
          This parameter is ignored if it is set to -1. If the expect rule
          does not match, the check will wait for more data. If set to 0,
          the evaluation result is always conclusive.

&lt;match&gt;   is a keyword indicating how to look for a specific pattern in the
          response. The keyword may be one of &quot;string&quot;, &quot;rstring&quot;, &quot;binary&quot; or
          &quot;rbinary&quot;.
          The keyword may be preceded by an exclamation mark (&quot;!&quot;) to negate
          the match. Spaces are allowed between the exclamation mark and the
          keyword. See below for more details on the supported keywords.

ok-status &lt;st&gt;     is optional and can be used to set the check status if
                   the expect rule is successfully evaluated and if it is
                   the last rule in the tcp-check ruleset. &quot;L7OK&quot;, &quot;L7OKC&quot;,
                   &quot;L6OK&quot; and &quot;L4OK&quot; are supported :
                     - L7OK  : check passed on layer 7
                     - L7OKC : check conditionally passed on layer 7, set
                               server to NOLB state.
                     - L6OK  : check passed on layer 6
                     - L4OK  : check passed on layer 4
                    By default &quot;L7OK&quot; is used.

error-status &lt;st&gt;  is optional and can be used to set the check status if
                   an error occurred during the expect rule evaluation.
                   &quot;L7OKC&quot;, &quot;L7RSP&quot;, &quot;L7STS&quot;, &quot;L6RSP&quot; and &quot;L4CON&quot; are
                   supported :
                     - L7OKC : check conditionally passed on layer 7, set
                               server to NOLB state.
                     - L7RSP : layer 7 invalid response - protocol error
                     - L7STS : layer 7 response error, for example HTTP 5xx
                     - L6RSP : layer 6 invalid response - protocol error
                     - L4CON : layer 1-4 connection problem
                   By default &quot;L7RSP&quot; is used.

tout-status &lt;st&gt;   is optional and can be used to set the check status if
                   a timeout occurred during the expect rule evaluation.
                   &quot;L7TOUT&quot;, &quot;L6TOUT&quot;, and &quot;L4TOUT&quot; are supported :
                     - L7TOUT : layer 7 (HTTP/SMTP) timeout
                     - L6TOUT : layer 6 (SSL) timeout
                     - L4TOUT : layer 1-4 timeout
                   By default &quot;L7TOUT&quot; is used.

on-success &lt;fmt&gt;   is optional and can be used to customize the
                   informational message reported in logs if the expect
                   rule is successfully evaluated and if it is the last rule
                   in the tcp-check ruleset. &lt;fmt&gt; is a Custom log format
                   (see <a href="#8.2.6">section 8.2.6</a>).

on-error &lt;fmt&gt;     is optional and can be used to customize the
                   informational message reported in logs if an error
                   occurred during the expect rule evaluation. &lt;fmt&gt; is a
                   Custom log format (see <a href="#8.2.6">section 8.2.6</a>).

status-code &lt;expr&gt; is optional and can be used to set the check status code
                   reported in logs, on success or on error. &lt;expr&gt; is a
                   standard HAProxy expression formed by a sample-fetch
                   followed by some converters.

&lt;pattern&gt; is the pattern to look for. It may be a string or a regular
          expression. If the pattern contains spaces, they must be escaped
          with the usual backslash ('\').
          If the match is set to binary, then the pattern must be passed as
          a series of hexadecimal digits in an even number. Each sequence of
          two digits will represent a byte. The hexadecimal digits may be
          used upper or lower case.</pre>
</div>
<pre class="text">The available matches are intentionally similar to their http-check cousins :

  string &lt;string&gt; : test the exact string matches in the response buffer.
                    A health check response will be considered valid if the
                    response's buffer contains this exact string. If the
                    &quot;string&quot; keyword is prefixed with &quot;!&quot;, then the response
                    will be considered invalid if the body contains this
                    string. This can be used to look for a mandatory pattern
                    in a protocol response, or to detect a failure when a
                    specific error appears in a protocol banner.

  rstring &lt;regex&gt; : test a regular expression on the response buffer.
                    A health check response will be considered valid if the
                    response's buffer matches this expression. If the
                    &quot;rstring&quot; keyword is prefixed with &quot;!&quot;, then the response
                    will be considered invalid if the body matches the
                    expression.

  string-lf &lt;fmt&gt; : test a Custom log format match in the response's buffer.
                    A health check response will be considered valid if the
                    response's buffer contains the  string resulting of the
                    evaluation of &lt;fmt&gt;, which follows the Custom log format
                    rules described in <a href="#8.2.6">section 8.2.6</a>. If prefixed with &quot;!&quot;,
                    then the response will be considered invalid if the
                    buffer contains the string.

  binary &lt;hexstring&gt; : test the exact string in its hexadecimal form matches
                       in the response buffer. A health check response will
                       be considered valid if the response's buffer contains
                       this exact hexadecimal string.
                       Purpose is to match data on binary protocols.

  rbinary &lt;regex&gt; : test a regular expression on the response buffer, like
                    &quot;rstring&quot;. However, the response buffer is transformed
                    into its hexadecimal form, including NUL-bytes. This
                    allows using all regex engines to match any binary
                    content.  The hexadecimal transformation takes twice the
                    size of the original response. As such, the expected
                    pattern should work on at-most half the response buffer
                    size.

  binary-lf &lt;hexfmt&gt; : test a Custom log format in its hexadecimal form match
                       in the response's buffer. A health check response will
                       be considered valid if the response's buffer contains
                       the hexadecimal string resulting of the evaluation of
                       &lt;fmt&gt;, which follows the Custom log format rules (see
                       <a href="#8.2.6">section 8.2.6</a>). If prefixed with &quot;!&quot;, then the
                       response will be considered invalid if the buffer
                       contains the hexadecimal string. The hexadecimal
                       string is converted in a binary string before matching
                       the response's buffer.

It is important to note that the responses will be limited to a certain size
defined by the global &quot;<a href="#tune.bufsize">tune.bufsize</a>&quot; option, which defaults to 16384 bytes.
Thus, too large responses may not contain the mandatory pattern when using
&quot;string&quot;, &quot;rstring&quot; or binary. If a large response is absolutely required, it
is possible to change the default max size by setting the global variable.
However, it is worth keeping in mind that parsing very large responses can
waste some CPU cycles, especially when regular expressions are used, and that
it is always better to focus the checks on smaller resources. Also, in its
current state, the check will not find any string nor regex past a null
character in the response. Similarly it is not possible to request matching
the null character.
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code><span class="comment"># perform a POP check</span>
option tcp-check
tcp-check expect string +OK\ POP3\ ready

<span class="comment"># perform an IMAP check</span>
option tcp-check
tcp-check expect string *\ OK\ IMAP4\ ready

<span class="comment"># look for the redis master server</span>
option tcp-check
tcp-check send PING\r\n
tcp-check expect string +PONG
tcp-check send info\ replication\r\n
tcp-check expect string role:master
tcp-check send QUIT\r\n
tcp-check expect string +OK
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#option%20tcp-check">option tcp-check</a>&quot;, &quot;<a href="#tcp-check%20connect">tcp-check connect</a>&quot;, &quot;<a href="#tcp-check%20send">tcp-check send</a>&quot;, &quot;<a href="#tcp-check%20send-binary">tcp-check send-binary</a>&quot;, &quot;<a href="#http-check%20expect">http-check expect</a>&quot;, tune.bufsize</div>
<a class="anchor" name="tcp-check"></a><a class="anchor" name="4-tcp-check"></a><a class="anchor" name="4.2-tcp-check"></a><a class="anchor" name="tcp-check (Proxies)"></a><a class="anchor" name="tcp-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="tcp-check send"></a><a class="anchor" name="4-tcp-check send"></a><a class="anchor" name="4.2-tcp-check send"></a><a class="anchor" name="tcp-check send (Proxies)"></a><a class="anchor" name="tcp-check send (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="tcp-check send"></a><a href="#4.2-tcp-check%20send">tcp-check send</a></b> <span style="color: #080">&lt;data&gt;</span> <span style="color: #008">[comment <span style="color: #080">&lt;msg&gt;</span>]</span></div><a class="anchor" name="tcp-check"></a><a class="anchor" name="4-tcp-check"></a><a class="anchor" name="4.2-tcp-check"></a><a class="anchor" name="tcp-check (Proxies)"></a><a class="anchor" name="tcp-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="tcp-check send-lf"></a><a class="anchor" name="4-tcp-check send-lf"></a><a class="anchor" name="4.2-tcp-check send-lf"></a><a class="anchor" name="tcp-check send-lf (Proxies)"></a><a class="anchor" name="tcp-check send-lf (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="tcp-check send-lf"></a><a href="#4.2-tcp-check%20send-lf">tcp-check send-lf</a></b> <span style="color: #080">&lt;fmt&gt;</span> <span style="color: #008">[comment <span style="color: #080">&lt;msg&gt;</span>]</span></div><pre class="text">Specify a string or a Custom log format to be sent as a question during a
generic health check

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">comment &lt;msg&gt;  defines a message to report if the rule evaluation fails.

&lt;data&gt;         is the string that will be sent during a generic health
               check session.

&lt;fmt&gt;          is the Custom log format that will be sent, once evaluated,
               during a generic health check session (see <a href="#8.2.6">section 8.2.6</a>).</pre>
</div>
<div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code><span class="comment"># look for the redis master server</span>
option tcp-check
tcp-check send info\ replication\r\n
tcp-check expect string role:master
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#option%20tcp-check">option tcp-check</a>&quot;, &quot;<a href="#tcp-check%20connect">tcp-check connect</a>&quot;, &quot;<a href="#tcp-check%20expect">tcp-check expect</a>&quot;, &quot;<a href="#tcp-check%20send-binary">tcp-check send-binary</a>&quot;, tune.bufsize</div>
<a class="anchor" name="tcp-check"></a><a class="anchor" name="4-tcp-check"></a><a class="anchor" name="4.2-tcp-check"></a><a class="anchor" name="tcp-check (Proxies)"></a><a class="anchor" name="tcp-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="tcp-check send-binary"></a><a class="anchor" name="4-tcp-check send-binary"></a><a class="anchor" name="4.2-tcp-check send-binary"></a><a class="anchor" name="tcp-check send-binary (Proxies)"></a><a class="anchor" name="tcp-check send-binary (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="tcp-check send-binary"></a><a href="#4.2-tcp-check%20send-binary">tcp-check send-binary</a></b> <span style="color: #080">&lt;hexstring&gt;</span> <span style="color: #008">[comment <span style="color: #080">&lt;msg&gt;</span>]</span></div><a class="anchor" name="tcp-check"></a><a class="anchor" name="4-tcp-check"></a><a class="anchor" name="4.2-tcp-check"></a><a class="anchor" name="tcp-check (Proxies)"></a><a class="anchor" name="tcp-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="tcp-check send-binary-lf"></a><a class="anchor" name="4-tcp-check send-binary-lf"></a><a class="anchor" name="4.2-tcp-check send-binary-lf"></a><a class="anchor" name="tcp-check send-binary-lf (Proxies)"></a><a class="anchor" name="tcp-check send-binary-lf (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="tcp-check send-binary-lf"></a><a href="#4.2-tcp-check%20send-binary-lf">tcp-check send-binary-lf</a></b> <span style="color: #080">&lt;hexfmt&gt;</span> <span style="color: #008">[comment <span style="color: #080">&lt;msg&gt;</span>]</span></div><pre class="text">Specify an hex digits string or an hex digits Custom log format to be sent as
a binary question during a raw tcp health check

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">comment &lt;msg&gt;  defines a message to report if the rule evaluation fails.

&lt;hexstring&gt;    is the hexadecimal string that will be send, once converted
               to binary, during a generic health check session.

&lt;hexfmt&gt;       is the hexadecimal Custom log format that will be send, once
               evaluated and converted to binary, during a generic health
               check session (see <a href="#8.2.6">section 8.2.6</a>).</pre>
</div>
<div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code><span class="comment"># redis check in binary</span>
option tcp-check
tcp-check send-binary 50494e470d0a <span class="comment"># PING\r\n</span>
tcp-check expect binary 2b504F4e47 <span class="comment"># +PONG</span>
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#option%20tcp-check">option tcp-check</a>&quot;, &quot;<a href="#tcp-check%20connect">tcp-check connect</a>&quot;, &quot;<a href="#tcp-check%20expect">tcp-check expect</a>&quot;, &quot;<a href="#tcp-check%20send">tcp-check send</a>&quot;, tune.bufsize</div>
<a class="anchor" name="tcp-check"></a><a class="anchor" name="4-tcp-check"></a><a class="anchor" name="4.2-tcp-check"></a><a class="anchor" name="tcp-check (Proxies)"></a><a class="anchor" name="tcp-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="tcp-check set-var"></a><a class="anchor" name="4-tcp-check set-var"></a><a class="anchor" name="4.2-tcp-check set-var"></a><a class="anchor" name="tcp-check set-var (Proxies)"></a><a class="anchor" name="tcp-check set-var (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="tcp-check set-var"></a><a href="#4.2-tcp-check%20set-var">tcp-check set-var</a></b>(<span style="color: #080">&lt;var-name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;cond&gt;</span>...]</span>) <span style="color: #080">&lt;expr&gt;</span></div><a class="anchor" name="tcp-check"></a><a class="anchor" name="4-tcp-check"></a><a class="anchor" name="4.2-tcp-check"></a><a class="anchor" name="tcp-check (Proxies)"></a><a class="anchor" name="tcp-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="tcp-check set-var-fmt"></a><a class="anchor" name="4-tcp-check set-var-fmt"></a><a class="anchor" name="4.2-tcp-check set-var-fmt"></a><a class="anchor" name="tcp-check set-var-fmt (Proxies)"></a><a class="anchor" name="tcp-check set-var-fmt (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="tcp-check set-var-fmt"></a><a href="#4.2-tcp-check%20set-var-fmt">tcp-check set-var-fmt</a></b>(<span style="color: #080">&lt;var-name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;cond&gt;</span>...]</span>) <span style="color: #080">&lt;fmt&gt;</span></div><pre class="text">This operation sets the content of a variable. The variable is declared inline.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;var-name&gt;   The name of the variable. Only &quot;<a href="#proc">proc</a>&quot;, &quot;sess&quot; and &quot;<a href="#check">check</a>&quot;
             scopes can be used. See <a href="#2.8">section 2.8</a> about variables for details.

 &lt;cond&gt;      A set of conditions that must all be true for the variable to
             actually be set (such as &quot;ifnotempty&quot;, &quot;ifgt&quot; ...). See the
             set-var converter's description for a full list of possible
             conditions.

 &lt;expr&gt;      Is a sample-fetch expression potentially followed by converters.

 &lt;fmt&gt;       This is the value expressed using Custom log format rules (see
             Custom log format in <a href="#8.2.6">section 8.2.6</a>).</pre>
</div>
<div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code>tcp-check set-var(check.port) int(1234)
tcp-check set-var-fmt(check.name) &quot;%H&quot;
</code></pre>
</div><a class="anchor" name="tcp-check"></a><a class="anchor" name="4-tcp-check"></a><a class="anchor" name="4.2-tcp-check"></a><a class="anchor" name="tcp-check (Proxies)"></a><a class="anchor" name="tcp-check (Alphabetically sorted keywords reference)"></a><a class="anchor" name="tcp-check unset-var"></a><a class="anchor" name="4-tcp-check unset-var"></a><a class="anchor" name="4.2-tcp-check unset-var"></a><a class="anchor" name="tcp-check unset-var (Proxies)"></a><a class="anchor" name="tcp-check unset-var (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="tcp-check unset-var"></a><a href="#4.2-tcp-check%20unset-var">tcp-check unset-var</a></b>(<span style="color: #080">&lt;var-name&gt;</span>)</div><pre class="text">Free a reference to a variable within its scope.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;var-name&gt;   The name of the variable. Only &quot;<a href="#proc">proc</a>&quot;, &quot;sess&quot; and &quot;<a href="#check">check</a>&quot;
             scopes can be used. See <a href="#2.8">section 2.8</a> about variables for details.</pre>
</div>
<div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code>tcp-check unset-var(check.port)
</code></pre>
</div><a class="anchor" name="tcp-request"></a><a class="anchor" name="4-tcp-request"></a><a class="anchor" name="4.2-tcp-request"></a><a class="anchor" name="tcp-request (Proxies)"></a><a class="anchor" name="tcp-request (Alphabetically sorted keywords reference)"></a><a class="anchor" name="tcp-request connection"></a><a class="anchor" name="4-tcp-request connection"></a><a class="anchor" name="4.2-tcp-request connection"></a><a class="anchor" name="tcp-request connection (Proxies)"></a><a class="anchor" name="tcp-request connection (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="tcp-request connection"></a><a href="#4.2-tcp-request%20connection">tcp-request connection</a></b> <span style="color: #080">&lt;action&gt;</span> <span style="color: #080">&lt;options...&gt;</span> <span style="color: #008">[ <span style="color: #800">{ if | unless }</span> <span style="color: #080">&lt;condition&gt;</span> ]</span></div><pre class="text">Perform an action on an incoming connection depending on a layer 4 condition

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-info pagination-centered">yes(!)<br /><img src="../css/checkmark.png" alt="yes(!)" title="yes(!)" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;action&gt;    defines the action to perform if the condition applies. See
            below.

&lt;condition&gt; is a standard layer4-only ACL-based condition (see <a href="#7">section 7</a>).</pre>
</div>
<pre class="text">Immediately after acceptance of a new incoming connection, it is possible to
evaluate some conditions to decide whether this connection must be accepted
or dropped or have its counters tracked. Those conditions cannot make use of
any data contents because the connection has not been read from yet, and the
buffers are not yet allocated. This is used to selectively and very quickly
accept or drop connections from various sources with a very low overhead. If
some contents need to be inspected in order to take the decision, the
&quot;<a href="#tcp-request%20content">tcp-request content</a>&quot; statements must be used instead.

The &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; rules are evaluated in their exact declaration
order. If no rule matches or if there is no rule, the default action is to
accept the incoming connection. There is no specific limit to the number of
rules which may be inserted. Any rule may optionally be followed by an
ACL-based condition, in which case it will only be evaluated if the condition
evaluates to true.

The condition is evaluated just before the action is executed, and the action
is performed exactly once. As such, there is no problem if an action changes
an element which is checked as part of the condition. This also means that
multiple actions may rely on the same condition so that the first action that
changes the condition's evaluation is sufficient to implicitly disable the
remaining actions. This is used for example when trying to assign a value to
a variable from various sources when it's empty.

The first keyword after &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; in the syntax is the rule's
action, optionally followed by a varying number of arguments for the action.
The supported actions and their respective syntaxes are enumerated in
<a href="#4.3">section 4.3</a> &quot;Actions&quot; (look for actions which tick &quot;TCP RqCon&quot;).

This directive is only available from named defaults sections, not anonymous
ones. Rules defined in the defaults section are evaluated before ones in the
associated proxy section. To avoid ambiguities, in this case the same
defaults section cannot be used by proxies with the frontend capability and
by proxies with the backend capability. It means a listen section cannot use
a defaults section defining such rules.

Note that the &quot;if/unless&quot; condition is optional. If no condition is set on
the action, it is simply performed unconditionally. That can be useful for
&quot;track-sc*&quot; actions as well as for changing the default action to a reject.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<div class="example-desc">Accept all connections from white-listed hosts, reject too fast connection without counting them, and track accepted connections. This results in connection rate being capped from abusive sources.</div><code>tcp-request connection accept if { src -f /etc/haproxy/whitelist.lst }
tcp-request connection reject if { src_conn_rate gt 10 }
tcp-request connection track-sc0 src
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<div class="example-desc">Accept all connections from white-listed hosts, count all other connections and reject too fast ones. This results in abusive ones being blocked as long as they don't slow down.</div><code>tcp-request connection accept if { src -f /etc/haproxy/whitelist.lst }
tcp-request connection track-sc0 src
tcp-request connection reject if { sc0_conn_rate gt 10 }
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<div class="example-desc">Enable the PROXY protocol for traffic coming from all known proxies.</div><code>tcp-request connection expect-proxy layer4 if { src -f proxies.lst }
</code></pre>
</div><pre class="text">See <a href="#7">section 7</a> about ACL usage.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#tcp-request%20session">tcp-request session</a>&quot;, &quot;<a href="#tcp-request%20content">tcp-request content</a>&quot;, &quot;<a href="#stick-table">stick-table</a>&quot;</div>
<a class="anchor" name="tcp-request"></a><a class="anchor" name="4-tcp-request"></a><a class="anchor" name="4.2-tcp-request"></a><a class="anchor" name="tcp-request (Proxies)"></a><a class="anchor" name="tcp-request (Alphabetically sorted keywords reference)"></a><a class="anchor" name="tcp-request content"></a><a class="anchor" name="4-tcp-request content"></a><a class="anchor" name="4.2-tcp-request content"></a><a class="anchor" name="tcp-request content (Proxies)"></a><a class="anchor" name="tcp-request content (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="tcp-request content"></a><a href="#4.2-tcp-request%20content">tcp-request content</a></b> <span style="color: #080">&lt;action&gt;</span> <span style="color: #008">[<span style="color: #800">{if | unless}</span> <span style="color: #080">&lt;condition&gt;</span>]</span></div><pre class="text">Perform an action on a new session depending on a layer 4-7 condition

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-info pagination-centered">yes(!)<br /><img src="../css/checkmark.png" alt="yes(!)" title="yes(!)" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;action&gt;    defines the action to perform if the condition applies. See
            below.

&lt;condition&gt; is a standard layer 4-7 ACL-based condition (see <a href="#7">section 7</a>).</pre>
</div>
<pre class="text">A request's contents can be analyzed at an early stage of request processing
called &quot;TCP content inspection&quot;. During this stage, ACL-based rules are
evaluated every time the request contents are updated, until either an
&quot;<a href="#accept">accept</a>&quot;, a &quot;<a href="#reject">reject</a>&quot; or a &quot;<a href="#switch-mode">switch-mode</a>&quot; rule matches, or the TCP request
inspection delay expires with no matching rule.

The first difference between these rules and &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; rules
is that &quot;<a href="#tcp-request%20content">tcp-request content</a>&quot; rules can make use of contents to take a
decision. Most often, these decisions will consider a protocol recognition or
validity. The second difference is that content-based rules can be used in
both frontends and backends. In case of HTTP keep-alive with the client, all
tcp-request content rules are evaluated again, so HAProxy keeps a record of
what sticky counters were assigned by a &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; versus a
&quot;<a href="#tcp-request%20content">tcp-request content</a>&quot; rule, and flushes all the content-related ones after
processing an HTTP request, so that they may be evaluated again by the rules
being evaluated again for the next request. This is of particular importance
when the rule tracks some L7 information or when it is conditioned by an
L7-based ACL, since tracking may change between requests.

Content-based rules are evaluated in their exact declaration order. If no
rule matches or if there is no rule, the default action is to accept the
contents. There is no specific limit to the number of rules which may be
inserted.

While there is nothing mandatory about it, it is recommended to use the
track-sc0 in &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; rules, track-sc1 for &quot;tcp-request
content&quot; rules in the frontend, and track-sc2 for &quot;<a href="#tcp-request%20content">tcp-request content</a>&quot;
rules in the backend, because that makes the configuration more readable
and easier to troubleshoot, but this is just a guideline and all counters
may be used everywhere.

The first keyword after &quot;<a href="#tcp-request%20content">tcp-request content</a>&quot; in the syntax is the rule's
action, optionally followed by a varying number of arguments for the action.
The supported actions and their respective syntaxes are enumerated in
<a href="#4.3">section 4.3</a> &quot;Actions&quot; (look for actions which tick &quot;TCP RqCnt&quot;).

This directive is only available from named defaults sections, not anonymous
ones. Rules defined in the defaults section are evaluated before ones in the
associated proxy section. To avoid ambiguities, in this case the same
defaults section cannot be used by proxies with the frontend capability and
by proxies with the backend capability. It means a listen section cannot use
a defaults section defining such rules.

Note that the &quot;if/unless&quot; condition is optional. If no condition is set on
the action, it is simply performed unconditionally. That can be useful for
&quot;track-sc*&quot; actions as well as for changing the default action to a reject.

Note also that it is recommended to use a &quot;<a href="#tcp-request%20session">tcp-request session</a>&quot; rule to track
information that does *not* depend on Layer 7 contents, especially for HTTP
frontends. Some HTTP processing are performed at the session level and may
lead to an early rejection of the requests. Thus, the tracking at the content
level may be disturbed in such case. A warning is emitted during startup to
prevent, as far as possible, such unreliable usage.

It is perfectly possible to match layer 7 contents with &quot;<a href="#tcp-request%20content">tcp-request content</a>&quot;
rules from a TCP proxy, since HTTP-specific ACL matches are able to
preliminarily parse the contents of a buffer before extracting the required
data. If the buffered contents do not parse as a valid HTTP message, then the
ACL does not match.  The parser which is involved there is exactly the same
as for all other HTTP processing, so there is no risk of parsing something
differently. In an HTTP frontend or an HTTP backend, it is guaranteed that
HTTP contents will always be immediately present when the rule is evaluated
first because the HTTP parsing is performed in the early stages of the
connection processing, at the session level. But for such proxies, using
&quot;<a href="#http-request">http-request</a>&quot; rules is much more natural and recommended.

Tracking layer7 information is also possible provided that the information
are present when the rule is processed. The rule processing engine is able to
wait until the inspect delay expires when the data to be tracked is not yet
available.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>tcp-request content use-service lua.deny if { src -f /etc/haproxy/blacklist.lst }
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>tcp-request content set-var(sess.my_var) src
tcp-request content set-var-fmt(sess.from) %[src]:%[src_port]
tcp-request content unset-var(sess.my_var2)
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># Accept HTTP requests containing a Host header saying &quot;example.com&quot;</span>
<span class="comment"># and reject everything else. (Only works for HTTP/1 connections)</span>
acl is_host_com hdr(Host) -i example.com
tcp-request inspect-delay 30s
tcp-request content accept if is_host_com
tcp-request content reject

<span class="comment"># Accept HTTP requests containing a Host header saying &quot;example.com&quot;</span>
<span class="comment"># and reject everything else. (works for HTTP/1 and HTTP/2 connections)</span>
acl is_host_com hdr(Host) -i example.com
tcp-request inspect-delay 5s
tcp-request switch-mode http if HTTP
tcp-request reject   <span class="comment"># non-HTTP traffic is implicit here</span>
...
http-request reject unless is_host_com
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># reject SMTP connection if client speaks first</span>
tcp-request inspect-delay 30s
acl content_present req.len gt 0
tcp-request content reject if content_present

<span class="comment"># Forward HTTPS connection only if client speaks</span>
tcp-request inspect-delay 30s
acl content_present req.len gt 0
tcp-request content accept if content_present
tcp-request content reject
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># Track the last IP(stick-table type string) from X-Forwarded-For</span>
tcp-request inspect-delay 10s
tcp-request content track-sc0 hdr(x-forwarded-for,-1)
<span class="comment"># Or track the last IP(stick-table type ip|ipv6) from X-Forwarded-For</span>
tcp-request content track-sc0 req.hdr_ip(x-forwarded-for,-1)
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># track request counts per &quot;<a href="#base">base</a>&quot; (concatenation of Host+URL)</span>
tcp-request inspect-delay 10s
tcp-request content track-sc0 base table req-rate
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<div class="example-desc">Track per-frontend and per-backend counters, block abusers at the frontend when the backend detects abuse(and marks gpc0).</div><code>frontend http
    <span class="comment"># Use General Purpose Counter 0 in SC0 as a global abuse counter</span>
    <span class="comment"># protecting all our sites</span>
    stick-table type ip size 1m expire 5m store gpc0
    tcp-request connection track-sc0 src
    tcp-request connection reject if { sc0_get_gpc0 gt 0 }
    ...
    use_backend http_dynamic if { path_end .php }

backend http_dynamic
    <span class="comment"># if a source makes too fast requests to this dynamic site (tracked</span>
    <span class="comment"># by SC1), block it globally in the frontend.</span>
    stick-table type ip size 1m expire 5m store http_req_rate(10s)
    acl click_too_fast sc1_http_req_rate gt 10
    acl mark_as_abuser sc0_inc_gpc0(http) gt 0
    tcp-request content track-sc1 src
    tcp-request content reject if click_too_fast mark_as_abuser
</code></pre>
</div><pre class="text">See <a href="#7">section 7</a> about ACL usage.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot;, &quot;<a href="#tcp-request%20session">tcp-request session</a>&quot;, &quot;<a href="#tcp-request%20inspect-delay">tcp-request inspect-delay</a>&quot;, and &quot;<a href="#http-request">http-request</a>&quot;.</div>
<a class="anchor" name="tcp-request"></a><a class="anchor" name="4-tcp-request"></a><a class="anchor" name="4.2-tcp-request"></a><a class="anchor" name="tcp-request (Proxies)"></a><a class="anchor" name="tcp-request (Alphabetically sorted keywords reference)"></a><a class="anchor" name="tcp-request inspect-delay"></a><a class="anchor" name="4-tcp-request inspect-delay"></a><a class="anchor" name="4.2-tcp-request inspect-delay"></a><a class="anchor" name="tcp-request inspect-delay (Proxies)"></a><a class="anchor" name="tcp-request inspect-delay (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="tcp-request inspect-delay"></a><a href="#4.2-tcp-request%20inspect-delay">tcp-request inspect-delay</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set the maximum allowed time to wait for data during content inspection

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-info pagination-centered">yes(!)<br /><img src="../css/checkmark.png" alt="yes(!)" title="yes(!)" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the timeout value specified in milliseconds by default, but
          can be in any other unit if the number is suffixed by the unit,
          as explained at the top of this document.</pre>
</div>
<pre class="text">People using HAProxy primarily as a TCP relay are often worried about the
risk of passing any type of protocol to a server without any analysis. In
order to be able to analyze the request contents, we must first withhold
the data then analyze them. This statement simply enables withholding of
data for at most the specified amount of time.

TCP content inspection applies very early when a connection reaches a
frontend, then very early when the connection is forwarded to a backend. This
means that a connection may experience a first delay in the frontend and a
second delay in the backend if both have tcp-request rules.

Note that when performing content inspection, HAProxy will evaluate the whole
rules for every new chunk which gets in, taking into account the fact that
those data are partial. If no rule matches before the aforementioned delay,
a last check is performed upon expiration, this time considering that the
contents are definitive. If no delay is set, HAProxy will not wait at all
and will immediately apply a verdict based on the available information.
Obviously this is unlikely to be very useful and might even be racy, so such
setups are not recommended.

Note the inspection delay is shortened if an connection error or shutdown is
experienced or if the request buffer appears as full.

As soon as a rule matches, the request is released and continues as usual. If
the timeout is reached and no rule matches, the default policy will be to let
it pass through unaffected.

For most protocols, it is enough to set it to a few seconds, as most clients
send the full request immediately upon connection. Add 3 or more seconds to
cover TCP retransmits but that's all. For some protocols, it may make sense
to use large values, for instance to ensure that the client never talks
before the server (e.g. SMTP), or to wait for a client to talk before passing
data to the server (e.g. SSL). Note that the client timeout must cover at
least the inspection delay, otherwise it will expire first. If the client
closes the connection or if the buffer is full, the delay immediately expires
since the contents will not be able to change anymore.

This directive is only available from named defaults sections, not anonymous
ones. Proxies inherit this value from their defaults section.
</pre><div class="page-header"><b>See also :</b> &quot;tcp-request content accept&quot;, &quot;tcp-request content reject&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout client<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20client%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#timeout%20client%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;.</div>
<a class="anchor" name="tcp-request"></a><a class="anchor" name="4-tcp-request"></a><a class="anchor" name="4.2-tcp-request"></a><a class="anchor" name="tcp-request (Proxies)"></a><a class="anchor" name="tcp-request (Alphabetically sorted keywords reference)"></a><a class="anchor" name="tcp-request session"></a><a class="anchor" name="4-tcp-request session"></a><a class="anchor" name="4.2-tcp-request session"></a><a class="anchor" name="tcp-request session (Proxies)"></a><a class="anchor" name="tcp-request session (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="tcp-request session"></a><a href="#4.2-tcp-request%20session">tcp-request session</a></b> <span style="color: #080">&lt;action&gt;</span> <span style="color: #008">[<span style="color: #800">{if | unless}</span> <span style="color: #080">&lt;condition&gt;</span>]</span></div><pre class="text">Perform an action on a validated session depending on a layer 5 condition

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-info pagination-centered">yes(!)<br /><img src="../css/checkmark.png" alt="yes(!)" title="yes(!)" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;action&gt;    defines the action to perform if the condition applies. See
            below.

&lt;condition&gt; is a standard layer5-only ACL-based condition (see <a href="#7">section 7</a>).</pre>
</div>
<pre class="text">Once a session is validated, (i.e. after all handshakes have been completed),
it is possible to evaluate some conditions to decide whether this session
must be accepted or dropped or have its counters tracked. Those conditions
cannot make use of any data contents because no buffers are allocated yet and
the processing cannot wait at this stage. The main use case is to copy some
early information into variables (since variables are accessible in the
session), or to keep track of some information collected after the handshake,
such as SSL-level elements (SNI, ciphers, client cert's CN) or information
from the PROXY protocol header (e.g. track a source forwarded this way). The
extracted information can thus be copied to a variable or tracked using
&quot;track-sc&quot; rules. Of course it is also possible to decide to accept/reject as
with other rulesets. Most operations performed here could also be performed
in &quot;<a href="#tcp-request%20content">tcp-request content</a>&quot; rules, except that in HTTP these rules are evaluated
for each new request, and that might not always be acceptable. For example a
rule might increment a counter on each evaluation. It would also be possible
that a country is resolved by geolocation from the source IP address,
assigned to a session-wide variable, then the source address rewritten from
an HTTP header for all requests. If some contents need to be inspected in
order to take the decision, the &quot;<a href="#tcp-request%20content">tcp-request content</a>&quot; statements must be used
instead.

The &quot;<a href="#tcp-request%20session">tcp-request session</a>&quot; rules are evaluated in their exact declaration
order. If no rule matches or if there is no rule, the default action is to
accept the incoming session. There is no specific limit to the number of
rules which may be inserted.

The first keyword after &quot;<a href="#tcp-request%20session">tcp-request session</a>&quot; in the syntax is the rule's
action, optionally followed by a varying number of arguments for the action.
The supported actions and their respective syntaxes are enumerated in
<a href="#4.3">section 4.3</a> &quot;Actions&quot; (look for actions which tick &quot;TCP RqSes&quot;).

This directive is only available from named defaults sections, not anonymous
ones. Rules defined in the defaults section are evaluated before ones in the
associated proxy section. To avoid ambiguities, in this case the same
defaults section cannot be used by proxies with the frontend capability and
by proxies with the backend capability. It means a listen section cannot use
a defaults section defining such rules.

Note that the &quot;if/unless&quot; condition is optional. If no condition is set on
the action, it is simply performed unconditionally. That can be useful for
&quot;track-sc*&quot; actions as well as for changing the default action to a reject.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<div class="example-desc">Track the original source address by default, or the one advertised in the PROXY protocol header for connection coming from the local proxies. The first connection-level rule enables receipt of the PROXY protocol for these ones, the second rule tracks whatever address we decide to keep after optional decoding.</div><code>tcp-request connection expect-proxy layer4 if { src -f proxies.lst }
tcp-request session track-sc0 src
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<div class="example-desc">Accept all sessions from white-listed hosts, reject too fast sessions without counting them, and track accepted sessions. This results in session rate being capped from abusive sources.</div><code>tcp-request session accept if { src -f /etc/haproxy/whitelist.lst }
tcp-request session reject if { src_sess_rate gt 10 }
tcp-request session track-sc0 src
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<div class="example-desc">Accept all sessions from white-listed hosts, count all other sessions and reject too fast ones. This results in abusive ones being blocked as long as they don't slow down.</div><code>tcp-request session accept if { src -f /etc/haproxy/whitelist.lst }
tcp-request session track-sc0 src
tcp-request session reject if { sc0_sess_rate gt 10 }
</code></pre>
</div><pre class="text">See <a href="#7">section 7</a> about ACL usage.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot;, &quot;<a href="#tcp-request%20content">tcp-request content</a>&quot;, &quot;<a href="#stick-table">stick-table</a>&quot;</div>
<a class="anchor" name="tcp-response"></a><a class="anchor" name="4-tcp-response"></a><a class="anchor" name="4.2-tcp-response"></a><a class="anchor" name="tcp-response (Proxies)"></a><a class="anchor" name="tcp-response (Alphabetically sorted keywords reference)"></a><a class="anchor" name="tcp-response content"></a><a class="anchor" name="4-tcp-response content"></a><a class="anchor" name="4.2-tcp-response content"></a><a class="anchor" name="tcp-response content (Proxies)"></a><a class="anchor" name="tcp-response content (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="tcp-response content"></a><a href="#4.2-tcp-response%20content">tcp-response content</a></b> <span style="color: #080">&lt;action&gt;</span> <span style="color: #008">[<span style="color: #800">{if | unless}</span> <span style="color: #080">&lt;condition&gt;</span>]</span></div><pre class="text">Perform an action on a session response depending on a layer 4-7 condition

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-info pagination-centered">yes(!)<br /><img src="../css/checkmark.png" alt="yes(!)" title="yes(!)" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;action&gt;    defines the action to perform if the condition applies. See
            below.

&lt;condition&gt; is a standard layer 4-7 ACL-based condition (see <a href="#7">section 7</a>).</pre>
</div>
<pre class="text">Response contents can be analyzed at an early stage of response processing
called &quot;TCP content inspection&quot;. During this stage, ACL-based rules are
evaluated every time the response contents are updated, until either a final
rule matches, or a TCP response inspection delay is set and expires with no
matching rule.

Most often, these decisions will consider a protocol recognition or validity.

Content-based rules are evaluated in their exact declaration order. If no
rule matches or if there is no rule, the default action is to accept the
contents. There is no specific limit to the number of rules which may be
inserted.

The first keyword after &quot;<a href="#tcp-response%20content">tcp-response content</a>&quot; in the syntax is the rule's
action, optionally followed by a varying number of arguments for the action.
The supported actions and their respective syntaxes are enumerated in
<a href="#4.3">section 4.3</a> &quot;Actions&quot; (look for actions which tick &quot;TCP RsCnt&quot;).

This directive is only available from named defaults sections, not anonymous
ones. Rules defined in the defaults section are evaluated before ones in the
associated proxy section. To avoid ambiguities, in this case the same
defaults section cannot be used by proxies with the frontend capability and
by proxies with the backend capability. It means a listen section cannot use
a defaults section defining such rules.

Note that the &quot;if/unless&quot; condition is optional. If no condition is set on
the action, it is simply performed unconditionally. That can be useful for
for changing the default action to a reject.

Several types of actions are supported :

It is perfectly possible to match layer 7 contents with &quot;tcp-response
content&quot; rules, but then it is important to ensure that a full response has
been buffered, otherwise no contents will match. In order to achieve this,
the best solution involves detecting the HTTP protocol during the inspection
period.

See <a href="#7">section 7</a> about ACL usage.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#tcp-request%20content">tcp-request content</a>&quot;, &quot;<a href="#tcp-response%20inspect-delay">tcp-response inspect-delay</a>&quot;</div>
<a class="anchor" name="tcp-response"></a><a class="anchor" name="4-tcp-response"></a><a class="anchor" name="4.2-tcp-response"></a><a class="anchor" name="tcp-response (Proxies)"></a><a class="anchor" name="tcp-response (Alphabetically sorted keywords reference)"></a><a class="anchor" name="tcp-response inspect-delay"></a><a class="anchor" name="4-tcp-response inspect-delay"></a><a class="anchor" name="4.2-tcp-response inspect-delay"></a><a class="anchor" name="tcp-response inspect-delay (Proxies)"></a><a class="anchor" name="tcp-response inspect-delay (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="tcp-response inspect-delay"></a><a href="#4.2-tcp-response%20inspect-delay">tcp-response inspect-delay</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set the maximum allowed time to wait for a response during content inspection

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-info pagination-centered">yes(!)<br /><img src="../css/checkmark.png" alt="yes(!)" title="yes(!)" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the timeout value specified in milliseconds by default, but
          can be in any other unit if the number is suffixed by the unit,
          as explained at the top of this document.</pre>
</div>
<pre class="text">This directive is only available from named defaults sections, not anonymous
ones. Proxies inherit this value from their defaults section.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#tcp-response%20content">tcp-response content</a>&quot;, &quot;<a href="#tcp-request%20inspect-delay">tcp-request inspect-delay</a>&quot;.</div>
<a class="anchor" name="timeout"></a><a class="anchor" name="4-timeout"></a><a class="anchor" name="4.2-timeout"></a><a class="anchor" name="timeout (Proxies)"></a><a class="anchor" name="timeout (Alphabetically sorted keywords reference)"></a><a class="anchor" name="timeout check"></a><a class="anchor" name="4-timeout check"></a><a class="anchor" name="4.2-timeout check"></a><a class="anchor" name="timeout check (Proxies)"></a><a class="anchor" name="timeout check (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="timeout check"></a><a href="#4.2-timeout%20check">timeout check</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set additional check timeout, but only after a connection has been already
established.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments:</span><pre class="prettyprint arguments">&lt;timeout&gt; is the timeout value specified in milliseconds by default, but
          can be in any other unit if the number is suffixed by the unit,
          as explained at the top of this document.</pre>
</div>
<pre class="text">If set, HAProxy uses min(&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout connect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20connect%20%28Rings%29">Rings</a></li><li><a href="#timeout%20connect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#inter">inter</a>&quot;) as a connect timeout
for check and &quot;<a href="#timeout%20check">timeout check</a>&quot; as an additional read timeout. The &quot;min&quot; is
used so that people running with *very* long &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout connect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20connect%20%28Rings%29">Rings</a></li><li><a href="#timeout%20connect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; (e.g. those
who needed this due to the queue or tarpit) do not slow down their checks.
(Please also note that there is no valid reason to have such long connect
timeouts, because &quot;<a href="#timeout%20queue">timeout queue</a>&quot; and &quot;<a href="#timeout%20tarpit">timeout tarpit</a>&quot; can always be used to
avoid that).

If &quot;<a href="#timeout%20check">timeout check</a>&quot; is not set HAProxy uses &quot;<a href="#inter">inter</a>&quot; for complete check
timeout (connect + read) exactly like all &lt;1.3.15 version.

In most cases check request is much simpler and faster to handle than normal
requests and people may want to kick out laggy servers so this timeout should
be smaller than &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20server%20%28Rings%29">Rings</a></li><li><a href="#timeout%20server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;.

This parameter is specific to backends, but can be specified once for all in
&quot;defaults&quot; sections. This is in fact one of the easiest solutions not to
forget about it.
</pre><div class="page-header"><b>See also:</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout connect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20connect%20%28Rings%29">Rings</a></li><li><a href="#timeout%20connect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#timeout%20queue">timeout queue</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20server%20%28Rings%29">Rings</a></li><li><a href="#timeout%20server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#timeout%20tarpit">timeout tarpit</a>&quot;.</div>
<a class="anchor" name="timeout"></a><a class="anchor" name="4-timeout"></a><a class="anchor" name="4.2-timeout"></a><a class="anchor" name="timeout (Proxies)"></a><a class="anchor" name="timeout (Alphabetically sorted keywords reference)"></a><a class="anchor" name="timeout client"></a><a class="anchor" name="4-timeout client"></a><a class="anchor" name="4.2-timeout client"></a><a class="anchor" name="timeout client (Proxies)"></a><a class="anchor" name="timeout client (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="timeout client"></a><a href="#4.2-timeout%20client">timeout client</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set the maximum inactivity time on the client side.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the timeout value specified in milliseconds by default, but
          can be in any other unit if the number is suffixed by the unit,
          as explained at the top of this document.</pre>
</div>
<pre class="text">The inactivity timeout applies when the client is expected to acknowledge or
send data. In HTTP mode, this timeout is particularly important to consider
during the first phase, when the client sends the request, and during the
response while it is reading data sent by the server. That said, for the
first phase, it is preferable to set the &quot;<a href="#timeout%20http-request">timeout http-request</a>&quot; to better
protect HAProxy from Slowloris like attacks. The value is specified in
milliseconds by default, but can be in any other unit if the number is
suffixed by the unit, as specified at the top of this document. In TCP mode
(and to a lesser extent, in HTTP mode), it is highly recommended that the
client timeout remains equal to the server timeout in order to avoid complex
situations to debug. It is a good practice to cover one or several TCP packet
losses by specifying timeouts that are slightly above multiples of 3 seconds
(e.g. 4 or 5 seconds). If some long-lived streams are mixed with short-lived
streams (e.g. WebSocket and HTTP), it's worth considering &quot;<a href="#timeout%20tunnel">timeout tunnel</a>&quot;,
which overrides &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout client<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20client%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#timeout%20client%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20server%20%28Rings%29">Rings</a></li><li><a href="#timeout%20server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; for tunnels, as well as
&quot;<a href="#timeout%20client-fin">timeout client-fin</a>&quot; for half-closed connections.

This parameter is specific to frontends, but can be specified once for all in
&quot;defaults&quot; sections. This is in fact one of the easiest solutions not to
forget about it. An unspecified timeout results in an infinite timeout, which
is not recommended. Such a usage is accepted and works but reports a warning
during startup because it may result in accumulation of expired sessions in
the system if the system's timeouts are not configured either.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20server%20%28Rings%29">Rings</a></li><li><a href="#timeout%20server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#timeout%20tunnel">timeout tunnel</a>&quot;, &quot;<a href="#timeout%20http-request">timeout http-request</a>&quot;.</div>
<a class="anchor" name="timeout"></a><a class="anchor" name="4-timeout"></a><a class="anchor" name="4.2-timeout"></a><a class="anchor" name="timeout (Proxies)"></a><a class="anchor" name="timeout (Alphabetically sorted keywords reference)"></a><a class="anchor" name="timeout client-fin"></a><a class="anchor" name="4-timeout client-fin"></a><a class="anchor" name="4.2-timeout client-fin"></a><a class="anchor" name="timeout client-fin (Proxies)"></a><a class="anchor" name="timeout client-fin (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="timeout client-fin"></a><a href="#4.2-timeout%20client-fin">timeout client-fin</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set the inactivity timeout on the client side for half-closed connections.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the timeout value specified in milliseconds by default, but
          can be in any other unit if the number is suffixed by the unit,
          as explained at the top of this document.</pre>
</div>
<pre class="text">The inactivity timeout applies when the client is expected to acknowledge or
send data while one direction is already shut down. This timeout is different
from &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout client<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20client%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#timeout%20client%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; in that it only applies to connections which are closed
in one direction. This is particularly useful to avoid keeping connections in
FIN_WAIT state for too long when clients do not disconnect cleanly. This
problem is particularly common long connections such as RDP or WebSocket.
Note that this timeout can override &quot;<a href="#timeout%20tunnel">timeout tunnel</a>&quot; when a connection shuts
down in one direction. It is applied to idle HTTP/2 connections once a GOAWAY
frame was sent, often indicating an expectation that the connection quickly
ends.

This parameter is specific to frontends, but can be specified once for all in
&quot;defaults&quot; sections. By default it is not set, so half-closed connections
will use the other timeouts (timeout.client or timeout.tunnel).
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout client<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20client%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#timeout%20client%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#timeout%20server-fin">timeout server-fin</a>&quot;, and &quot;<a href="#timeout%20tunnel">timeout tunnel</a>&quot;.</div>
<a class="anchor" name="timeout"></a><a class="anchor" name="4-timeout"></a><a class="anchor" name="4.2-timeout"></a><a class="anchor" name="timeout (Proxies)"></a><a class="anchor" name="timeout (Alphabetically sorted keywords reference)"></a><a class="anchor" name="timeout client-hs"></a><a class="anchor" name="4-timeout client-hs"></a><a class="anchor" name="4.2-timeout client-hs"></a><a class="anchor" name="timeout client-hs (Proxies)"></a><a class="anchor" name="timeout client-hs (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="timeout client-hs"></a><a href="#4.2-timeout%20client-hs">timeout client-hs</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set the maximum time to wait for a client TLS handshake to complete. This is
usable both for TCP and QUIC connections.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the timeout value specified in milliseconds by default, but
          can be in any other unit if the number is suffixed by the unit,
          as explained at the top of this document.</pre>
</div>
<pre class="text">If this handshake timeout is not set, this is the client timeout which is used
in place.
</pre><a class="anchor" name="timeout"></a><a class="anchor" name="4-timeout"></a><a class="anchor" name="4.2-timeout"></a><a class="anchor" name="timeout (Proxies)"></a><a class="anchor" name="timeout (Alphabetically sorted keywords reference)"></a><a class="anchor" name="timeout connect"></a><a class="anchor" name="4-timeout connect"></a><a class="anchor" name="4.2-timeout connect"></a><a class="anchor" name="timeout connect (Proxies)"></a><a class="anchor" name="timeout connect (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="timeout connect"></a><a href="#4.2-timeout%20connect">timeout connect</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set the maximum time to wait for a connection attempt to a server to succeed.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the timeout value specified in milliseconds by default, but
          can be in any other unit if the number is suffixed by the unit,
          as explained at the top of this document.</pre>
</div>
<pre class="text">If the server is located on the same LAN as HAProxy, the connection should be
immediate (less than a few milliseconds). Anyway, it is a good practice to
cover one or several TCP packet losses by specifying timeouts that are
slightly above multiples of 3 seconds (e.g. 4 or 5 seconds). By default, the
connect timeout also presets both queue and tarpit timeouts to the same value
if these have not been specified.

This parameter is specific to backends, but can be specified once for all in
&quot;defaults&quot; sections. This is in fact one of the easiest solutions not to
forget about it. An unspecified timeout results in an infinite timeout, which
is not recommended. Such a usage is accepted and works but reports a warning
during startup because it may result in accumulation of failed sessions in
the system if the system's timeouts are not configured either.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#timeout%20check">timeout check</a>&quot;, &quot;<a href="#timeout%20queue">timeout queue</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20server%20%28Rings%29">Rings</a></li><li><a href="#timeout%20server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#timeout%20tarpit">timeout tarpit</a>&quot;.</div>
<a class="anchor" name="timeout"></a><a class="anchor" name="4-timeout"></a><a class="anchor" name="4.2-timeout"></a><a class="anchor" name="timeout (Proxies)"></a><a class="anchor" name="timeout (Alphabetically sorted keywords reference)"></a><a class="anchor" name="timeout http-keep-alive"></a><a class="anchor" name="4-timeout http-keep-alive"></a><a class="anchor" name="4.2-timeout http-keep-alive"></a><a class="anchor" name="timeout http-keep-alive (Proxies)"></a><a class="anchor" name="timeout http-keep-alive (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="timeout http-keep-alive"></a><a href="#4.2-timeout%20http-keep-alive">timeout http-keep-alive</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set the maximum allowed time to wait for a new HTTP request to appear

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the timeout value specified in milliseconds by default, but
          can be in any other unit if the number is suffixed by the unit,
          as explained at the top of this document.</pre>
</div>
<pre class="text">By default, the time to wait for a new request in case of keep-alive is set
by &quot;<a href="#timeout%20http-request">timeout http-request</a>&quot;. However this is not always convenient because some
people want very short keep-alive timeouts in order to release connections
faster, and others prefer to have larger ones but still have short timeouts
once the request has started to present itself.

The &quot;<a href="#option%20http-keep-alive">http-keep-alive</a>&quot; timeout covers these needs. It will define how long to
wait for a new HTTP request to start coming after a response was sent. Once
the first byte of request has been seen, the &quot;<a href="#http-request">http-request</a>&quot; timeout is used
to wait for the complete request to come. Note that empty lines prior to a
new request do not refresh the timeout and are not counted as a new request.

There is also another difference between the two timeouts : when a connection
expires during timeout http-keep-alive, no error is returned, the connection
just closes. If the connection expires in &quot;<a href="#http-request">http-request</a>&quot; while waiting for a
request to complete, an HTTP 408 error is returned to the client before
closing the connection, unless &quot;<a href="#option%20http-ignore-probes">option http-ignore-probes</a>&quot; is set in the
frontend.

In general &quot;<a href="#timeout%20http-keep-alive">timeout http-keep-alive</a>&quot; is best used to prevent clients from
holding open an otherwise idle connection too long on sites seeing large
amounts of short connections. This can be accomplished by setting the value
to a few tens to hundreds of milliseconds in HTTP/1.1. This will close the
connection after the client requests a page without having to hold that
connection open to wait for more activity from the client. In that scenario,
a new activity from the browser would result in a new handshake at the TCP
and/or SSL layer. A common use case for this is HTTP sites serving only a
redirect to the HTTPS page. Such connections are better not kept idle too
long because they won't be reused, unless maybe to fetch a favicon.

Another use case is the exact opposite: some sites want to permit clients
to reuse idle connections for a long time (e.g. 30 seconds to one minute) but
do not want to wait that long for the first request, in order to avoid a very
inexpensive attack vector. In this case, the http-keep-alive timeout would be
set to a large value, but http-request would remain low (a few seconds).

When set to a very small value additional requests that are not pipelined
are likely going to be handled over another connection unless the requests
are truly pipelined, which is very rare with HTTP/1.1 (requests being sent
back-to-back without waiting for a response). Most HTTP/1.1 implementations
send a request, wait for a response and then send another request. A small
value here for HTTP/1.1 may be advantageous to use less memory and sockets
for sites with hundreds of thousands of clients, at the expense of an
increase in handshake computation costs.

Special care should be taken with small values when dealing with HTTP/2. The
nature of HTTP/2 is to multiplex requests over a connection in order to save
on the overhead of reconnecting the TCP and/or SSL layers. The protocol also
uses control frames which cope poorly with early TCP connection closures, on
very rare occasions this may result in truncated responses when data are
destroyed in flight after leaving HAProxy (which then cannot even log an
error). A suggested low starting value for HTTP/2 connections would be around
4 seconds. This would prevent most modern keep-alive implementations from
needlessly holding open stale connections, and at the same time would allow
subsequent requests to reuse the connection. However, this should be adjusted
as needed and is simply a starting point.

If this parameter is not set, the &quot;<a href="#http-request">http-request</a>&quot; timeout applies, and if both
are not set, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout client<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20client%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#timeout%20client%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; still applies at the lower level. It should be
set in the frontend to take effect, unless the frontend is in TCP mode, in
which case the HTTP backend's timeout will be used.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#timeout%20http-request">timeout http-request</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout client<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20client%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#timeout%20client%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;.</div>
<a class="anchor" name="timeout"></a><a class="anchor" name="4-timeout"></a><a class="anchor" name="4.2-timeout"></a><a class="anchor" name="timeout (Proxies)"></a><a class="anchor" name="timeout (Alphabetically sorted keywords reference)"></a><a class="anchor" name="timeout http-request"></a><a class="anchor" name="4-timeout http-request"></a><a class="anchor" name="4.2-timeout http-request"></a><a class="anchor" name="timeout http-request (Proxies)"></a><a class="anchor" name="timeout http-request (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="timeout http-request"></a><a href="#4.2-timeout%20http-request">timeout http-request</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set the maximum allowed time to wait for a complete HTTP request

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the timeout value specified in milliseconds by default, but
          can be in any other unit if the number is suffixed by the unit,
          as explained at the top of this document.</pre>
</div>
<pre class="text">In order to offer DoS protection, it may be required to lower the maximum
accepted time to receive a complete HTTP request without affecting the client
timeout. This helps protecting against established connections on which
nothing is sent. The client timeout cannot offer a good protection against
this abuse because it is an inactivity timeout, which means that if the
attacker sends one character every now and then, the timeout will not
trigger. With the HTTP request timeout, no matter what speed the client
types, the request will be aborted if it does not complete in time. When the
timeout expires, an HTTP 408 response is sent to the client to inform it
about the problem, and the connection is closed. The logs will report
termination codes &quot;cR&quot;. Some recent browsers are having problems with this
standard, well-documented behavior, so it might be needed to hide the 408
code using &quot;<a href="#option%20http-ignore-probes">option http-ignore-probes</a>&quot; or &quot;errorfile 408 /dev/null&quot;. See
more details in the explanations of the &quot;cR&quot; termination code in <a href="#8.5">section 8.5</a>.

By default, this timeout only applies to the header part of the request,
and not to any data. As soon as the empty line is received, this timeout is
not used anymore. When combined with &quot;<a href="#option%20http-buffer-request">option http-buffer-request</a>&quot;, this
timeout also applies to the body of the request..
It is used again on keep-alive connections to wait for a second
request if &quot;<a href="#timeout%20http-keep-alive">timeout http-keep-alive</a>&quot; is not set.

Generally it is enough to set it to a few seconds, as most clients send the
full request immediately upon connection. Add 3 or more seconds to cover TCP
retransmits but that's all. Setting it to very low values (e.g. 50 ms) will
generally work on local networks as long as there are no packet losses. This
will prevent people from sending bare HTTP requests using telnet.

If this parameter is not set, the client timeout still applies between each
chunk of the incoming request. It should be set in the frontend to take
effect, unless the frontend is in TCP mode, in which case the HTTP backend's
timeout will be used.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">errorfile<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#errorfile%20%28HTTP-errors%29">HTTP-errors</a></li><li><a href="#errorfile%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#option%20http-ignore-probes">http-ignore-probes</a>&quot;, &quot;<a href="#timeout%20http-keep-alive">timeout http-keep-alive</a>&quot;, and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout client<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20client%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#timeout%20client%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#option%20http-buffer-request">option http-buffer-request</a>&quot;.</div>
<a class="anchor" name="timeout"></a><a class="anchor" name="4-timeout"></a><a class="anchor" name="4.2-timeout"></a><a class="anchor" name="timeout (Proxies)"></a><a class="anchor" name="timeout (Alphabetically sorted keywords reference)"></a><a class="anchor" name="timeout queue"></a><a class="anchor" name="4-timeout queue"></a><a class="anchor" name="4.2-timeout queue"></a><a class="anchor" name="timeout queue (Proxies)"></a><a class="anchor" name="timeout queue (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="timeout queue"></a><a href="#4.2-timeout%20queue">timeout queue</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set the maximum time to wait in the queue for a connection slot to be free

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the timeout value specified in milliseconds by default, but
          can be in any other unit if the number is suffixed by the unit,
          as explained at the top of this document.</pre>
</div>
<pre class="text">When a server's maxconn is reached, connections are left pending in a queue
which may be server-specific or global to the backend. In order not to wait
indefinitely, a timeout is applied to requests pending in the queue. If the
timeout is reached, it is considered that the request will almost never be
served, so it is dropped and a 503 error is returned to the client.

The &quot;<a href="#timeout%20queue">timeout queue</a>&quot; statement allows to fix the maximum time for a request to
be left pending in a queue. If unspecified, the same value as the backend's
connection timeout (&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout connect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20connect%20%28Rings%29">Rings</a></li><li><a href="#timeout%20connect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;) is used, for backwards compatibility
with older versions with no &quot;<a href="#timeout%20queue">timeout queue</a>&quot; parameter.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout connect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20connect%20%28Rings%29">Rings</a></li><li><a href="#timeout%20connect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;.</div>
<a class="anchor" name="timeout"></a><a class="anchor" name="4-timeout"></a><a class="anchor" name="4.2-timeout"></a><a class="anchor" name="timeout (Proxies)"></a><a class="anchor" name="timeout (Alphabetically sorted keywords reference)"></a><a class="anchor" name="timeout server"></a><a class="anchor" name="4-timeout server"></a><a class="anchor" name="4.2-timeout server"></a><a class="anchor" name="timeout server (Proxies)"></a><a class="anchor" name="timeout server (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="timeout server"></a><a href="#4.2-timeout%20server">timeout server</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set the maximum inactivity time on the server side.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the timeout value specified in milliseconds by default, but
          can be in any other unit if the number is suffixed by the unit,
          as explained at the top of this document.</pre>
</div>
<pre class="text">The inactivity timeout applies when the server is expected to acknowledge or
send data. In HTTP mode, this timeout is particularly important to consider
during the first phase of the server's response, when it has to send the
headers, as it directly represents the server's processing time for the
request. To find out what value to put there, it's often good to start with
what would be considered as unacceptable response times, then check the logs
to observe the response time distribution, and adjust the value accordingly.

The value is specified in milliseconds by default, but can be in any other
unit if the number is suffixed by the unit, as specified at the top of this
document. In TCP mode (and to a lesser extent, in HTTP mode), it is highly
recommended that the client timeout remains equal to the server timeout in
order to avoid complex situations to debug. Whatever the expected server
response times, it is a good practice to cover at least one or several TCP
packet losses by specifying timeouts that are slightly above multiples of 3
seconds (e.g. 4 or 5 seconds minimum). If some long-lived streams are mixed
with short-lived streams (e.g. WebSocket and HTTP), it's worth considering
&quot;<a href="#timeout%20tunnel">timeout tunnel</a>&quot;, which overrides &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout client<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20client%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#timeout%20client%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20server%20%28Rings%29">Rings</a></li><li><a href="#timeout%20server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; for
tunnels.

This parameter is specific to backends, but can be specified once for all in
&quot;defaults&quot; sections. This is in fact one of the easiest solutions not to
forget about it. An unspecified timeout results in an infinite timeout, which
is not recommended. Such a usage is accepted and works but reports a warning
during startup because it may result in accumulation of expired sessions in
the system if the system's timeouts are not configured either.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout client<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20client%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#timeout%20client%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; and &quot;<a href="#timeout%20tunnel">timeout tunnel</a>&quot;.</div>
<a class="anchor" name="timeout"></a><a class="anchor" name="4-timeout"></a><a class="anchor" name="4.2-timeout"></a><a class="anchor" name="timeout (Proxies)"></a><a class="anchor" name="timeout (Alphabetically sorted keywords reference)"></a><a class="anchor" name="timeout server-fin"></a><a class="anchor" name="4-timeout server-fin"></a><a class="anchor" name="4.2-timeout server-fin"></a><a class="anchor" name="timeout server-fin (Proxies)"></a><a class="anchor" name="timeout server-fin (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="timeout server-fin"></a><a href="#4.2-timeout%20server-fin">timeout server-fin</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set the inactivity timeout on the server side for half-closed connections.

May be used in the following contexts: tcp, http, log
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the timeout value specified in milliseconds by default, but
          can be in any other unit if the number is suffixed by the unit,
          as explained at the top of this document.</pre>
</div>
<pre class="text">The inactivity timeout applies when the server is expected to acknowledge or
send data while one direction is already shut down. This timeout is different
from &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20server%20%28Rings%29">Rings</a></li><li><a href="#timeout%20server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; in that it only applies to connections which are closed
in one direction. This is particularly useful to avoid keeping connections in
FIN_WAIT state for too long when a remote server does not disconnect cleanly.
This problem is particularly common long connections such as RDP or WebSocket.
Note that this timeout can override &quot;<a href="#timeout%20tunnel">timeout tunnel</a>&quot; when a connection shuts
down in one direction. This setting was provided for completeness, but in most
situations, it should not be needed.

This parameter is specific to backends, but can be specified once for all in
&quot;defaults&quot; sections. By default it is not set, so half-closed connections
will use the other timeouts (timeout.server or timeout.tunnel).
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#timeout%20client-fin">timeout client-fin</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20server%20%28Rings%29">Rings</a></li><li><a href="#timeout%20server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, and &quot;<a href="#timeout%20tunnel">timeout tunnel</a>&quot;.</div>
<a class="anchor" name="timeout"></a><a class="anchor" name="4-timeout"></a><a class="anchor" name="4.2-timeout"></a><a class="anchor" name="timeout (Proxies)"></a><a class="anchor" name="timeout (Alphabetically sorted keywords reference)"></a><a class="anchor" name="timeout tarpit"></a><a class="anchor" name="4-timeout tarpit"></a><a class="anchor" name="4.2-timeout tarpit"></a><a class="anchor" name="timeout tarpit (Proxies)"></a><a class="anchor" name="timeout tarpit (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="timeout tarpit"></a><a href="#4.2-timeout%20tarpit">timeout tarpit</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set the duration for which tarpitted connections will be maintained

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the tarpit duration specified in milliseconds by default, but
          can be in any other unit if the number is suffixed by the unit,
          as explained at the top of this document.</pre>
</div>
<pre class="text">When a connection is tarpitted using &quot;http-request tarpit&quot;, it is maintained
open with no activity for a certain amount of time, then closed. &quot;timeout
tarpit&quot; defines how long it will be maintained open.

The value is specified in milliseconds by default, but can be in any other
unit if the number is suffixed by the unit, as specified at the top of this
document. If unspecified, the same value as the backend's connection timeout
(&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout connect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20connect%20%28Rings%29">Rings</a></li><li><a href="#timeout%20connect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;) is used, for backwards compatibility with older versions
with no &quot;<a href="#timeout%20tarpit">timeout tarpit</a>&quot; parameter.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout connect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20connect%20%28Rings%29">Rings</a></li><li><a href="#timeout%20connect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;.</div>
<a class="anchor" name="timeout"></a><a class="anchor" name="4-timeout"></a><a class="anchor" name="4.2-timeout"></a><a class="anchor" name="timeout (Proxies)"></a><a class="anchor" name="timeout (Alphabetically sorted keywords reference)"></a><a class="anchor" name="timeout tunnel"></a><a class="anchor" name="4-timeout tunnel"></a><a class="anchor" name="4.2-timeout tunnel"></a><a class="anchor" name="timeout tunnel (Proxies)"></a><a class="anchor" name="timeout tunnel (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="timeout tunnel"></a><a href="#4.2-timeout%20tunnel">timeout tunnel</a></b> <span style="color: #080">&lt;timeout&gt;</span></div><pre class="text">Set the maximum inactivity time on the client and server side for tunnels.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;timeout&gt; is the timeout value specified in milliseconds by default, but
          can be in any other unit if the number is suffixed by the unit,
          as explained at the top of this document.</pre>
</div>
<pre class="text">The tunnel timeout applies when a bidirectional connection is established
between a client and a server, and the connection remains inactive in both
directions. This timeout supersedes both the client and server timeouts once
the connection becomes a tunnel. In TCP, this timeout is used as soon as no
analyzer remains attached to either connection (e.g. tcp content rules are
accepted). In HTTP, this timeout is used when a connection is upgraded (e.g.
when switching to the WebSocket protocol, or forwarding a CONNECT request
to a proxy), or after the first response when no keepalive/close option is
specified.

Since this timeout is usually used in conjunction with long-lived connections,
it usually is a good idea to also set &quot;<a href="#timeout%20client-fin">timeout client-fin</a>&quot; to handle the
situation where a client suddenly disappears from the net and does not
acknowledge a close, or sends a shutdown and does not acknowledge pending
data anymore. This can happen in lossy networks where firewalls are present,
and is detected by the presence of large amounts of sessions in a FIN_WAIT
state.

The value is specified in milliseconds by default, but can be in any other
unit if the number is suffixed by the unit, as specified at the top of this
document. Whatever the expected normal idle time, it is a good practice to
cover at least one or several TCP packet losses by specifying timeouts that
are slightly above multiples of 3 seconds (e.g. 4 or 5 seconds minimum).

This parameter is specific to backends, but can be specified once for all in
&quot;defaults&quot; sections. This is in fact one of the easiest solutions not to
forget about it.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>defaults http
    option http-server-close
    timeout connect 5s
    timeout client 30s
    timeout client-fin 30s
    timeout server 30s
    timeout tunnel  1h    <span class="comment"># timeout to use with WebSocket and CONNECT</span>
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout client<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20client%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#timeout%20client%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#timeout%20client-fin">timeout client-fin</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20server%20%28Rings%29">Rings</a></li><li><a href="#timeout%20server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;.</div>
<a class="anchor" name="transparent"></a><a class="anchor" name="4-transparent"></a><a class="anchor" name="4.2-transparent"></a><a class="anchor" name="transparent (Proxies)"></a><a class="anchor" name="transparent (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="transparent"></a><a href="#4.2-transparent">transparent</a></b> <span class="label label-warning">(deprecated)</span></div><pre class="text">Enable client-side transparent proxying

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span> none
</div>
<pre class="text">This keyword was introduced in order to provide layer 7 persistence to layer
3 load balancers. The idea is to use the OS's ability to redirect an incoming
connection for a remote address to a local process (here HAProxy), and let
this process know what address was initially requested. When this option is
used, sessions without cookies will be forwarded to the original destination
IP address of the incoming request (which should match that of another
equipment), while requests with cookies will still be forwarded to the
appropriate server.

The &quot;<a href="#option%20transparent">transparent</a>&quot; keyword is deprecated, use &quot;<a href="#option%20transparent">option transparent</a>&quot; instead.

Note that contrary to a common belief, this option does NOT make HAProxy
present the client's IP to the server when establishing the connection.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#option%20transparent">option transparent</a>&quot;</div>
<a class="anchor" name="unique-id-format"></a><a class="anchor" name="4-unique-id-format"></a><a class="anchor" name="4.2-unique-id-format"></a><a class="anchor" name="unique-id-format (Proxies)"></a><a class="anchor" name="unique-id-format (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="unique-id-format"></a><a href="#4.2-unique-id-format">unique-id-format</a></b> <span style="color: #080">&lt;fmt&gt;</span></div><pre class="text">Generate a unique ID for each request.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;fmt&gt;   is a Custom log format string (see <a href="#8.2.6">section 8.2.6</a>).</pre>
</div>
<pre class="text">This keyword creates a ID for each request using the custom log format. A
unique ID is useful to trace a request passing through many components of
a complex infrastructure. The newly created ID may also be logged using the
%ID alias in the Custom log format string.

The format should be composed from elements that are guaranteed to be
unique when combined together. For instance, if multiple HAProxy instances
are involved, it might be important to include the node name. It is often
needed to log the incoming connection's source and destination addresses
and ports. Note that since multiple requests may be performed over the same
connection, including a request counter may help differentiate them.
Similarly, a timestamp may protect against a rollover of the counter.
Logging the process ID will avoid collisions after a service restart.

It is recommended to use hexadecimal notation for many fields since it
makes them more compact and saves space in logs.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>unique-id-format %{+X}o\ %ci:%cp_%fi:%fp_%Ts_%rt:%pid

will generate:

       7F000001:8296_7F00001E:1F90_4F7B0A69_0003:790A
</code></pre>
</div><div class="page-header"><b>See also:</b> &quot;<a href="#unique-id-header">unique-id-header</a>&quot;</div>
<a class="anchor" name="unique-id-header"></a><a class="anchor" name="4-unique-id-header"></a><a class="anchor" name="4.2-unique-id-header"></a><a class="anchor" name="unique-id-header (Proxies)"></a><a class="anchor" name="unique-id-header (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="unique-id-header"></a><a href="#4.2-unique-id-header">unique-id-header</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">Add a unique ID header in the HTTP request.

May be used in the following contexts: http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;name&gt;   is the name of the header.</pre>
</div>
<pre class="text">Add a unique-id header in the HTTP request sent to the server, using the
unique-id-format. It can't work if the unique-id-format doesn't exist.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>    unique-id-format %{+X}o\ %ci:%cp_%fi:%fp_%Ts_%rt:%pid
    unique-id-header X-Unique-ID

    will generate:

       X-Unique-ID: 7F000001:8296_7F00001E:1F90_4F7B0A69_0003:790A

See also: &quot;<a href="#unique-id-format">unique-id-format</a>&quot;
</code></pre>
</div><a class="anchor" name="use_backend"></a><a class="anchor" name="4-use_backend"></a><a class="anchor" name="4.2-use_backend"></a><a class="anchor" name="use_backend (Proxies)"></a><a class="anchor" name="use_backend (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="use_backend"></a><a href="#4.2-use_backend">use_backend</a></b> <span style="color: #080">&lt;backend&gt;</span> <span style="color: #008">[<span style="color: #800">{if | unless}</span> <span style="color: #080">&lt;condition&gt;</span>]</span></div><pre class="text">Switch to a specific backend if/unless an ACL-based condition is matched.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;backend&gt;   is the name of a valid backend or &quot;listen&quot; section, or a
            Custom log format resolving to a backend name (see Custom
            Log Format in <a href="#8.2.6">section 8.2.6</a>).

&lt;condition&gt; is a condition composed of ACLs, as described in <a href="#7">section 7</a>. If
            it is omitted, the rule is unconditionally applied.</pre>
</div>
<pre class="text">When doing content-switching, connections arrive on a frontend and are then
dispatched to various backends depending on a number of conditions. The
relation between the conditions and the backends is described with the
&quot;<a href="#use_backend">use_backend</a>&quot; keyword. While it is normally used with HTTP processing, it can
also be used in pure TCP, either without content using stateless ACLs (e.g.
source address validation) or combined with a &quot;<a href="#tcp-request">tcp-request</a>&quot; rule to wait for
some payload.

There may be as many &quot;<a href="#use_backend">use_backend</a>&quot; rules as desired. All of these rules are
evaluated in their declaration order, and the first one which matches will
assign the backend.

In the first form, the backend will be used if the condition is met. In the
second form, the backend will be used if the condition is not met. If no
condition is valid, the backend defined with &quot;<a href="#default_backend">default_backend</a>&quot; will be used.
If no default backend is defined, either the servers in the same section are
used (in case of a &quot;listen&quot; section) or, in case of a frontend, no server is
used and a 503 service unavailable response is returned.

Note that it is possible to switch from a TCP frontend to an HTTP backend. In
this case, either the frontend has already checked that the protocol is HTTP,
and backend processing will immediately follow, or the backend will wait for
a complete HTTP request to get in. This feature is useful when a frontend
must decode several protocols on a unique port, one of them being HTTP.

When &lt;backend&gt; is a simple name, it is resolved at configuration time, and an
error is reported if the specified backend does not exist. If &lt;backend&gt; is
a Custom log format instead, no check may be done at configuration time, so
the backend name is resolved dynamically at run time. If the resulting
backend name does not correspond to any valid backend, no other rule is
evaluated, and the default_backend directive is applied instead. Note that
when using dynamic backend names, it is highly recommended to use a prefix
that no other backend uses in order to ensure that an unauthorized backend
cannot be forced from the request.

It is worth mentioning that &quot;<a href="#use_backend">use_backend</a>&quot; rules with an explicit name are
used to detect the association between frontends and backends to compute the
backend's &quot;<a href="#fullconn">fullconn</a>&quot; setting. This cannot be done for dynamic names.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#default_backend">default_backend</a>&quot;, &quot;<a href="#tcp-request">tcp-request</a>&quot;, &quot;<a href="#fullconn">fullconn</a>&quot;, &quot;<a href="#log-format">log-format</a>&quot;, and <a href="#7">section 7</a> about ACLs.</div>
<a class="anchor" name="use-fcgi-app"></a><a class="anchor" name="4-use-fcgi-app"></a><a class="anchor" name="4.2-use-fcgi-app"></a><a class="anchor" name="use-fcgi-app (Proxies)"></a><a class="anchor" name="use-fcgi-app (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="use-fcgi-app"></a><a href="#4.2-use-fcgi-app">use-fcgi-app</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">Defines the FastCGI application to use for the backend.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;name&gt;    is the name of the FastCGI application to use.</pre>
</div>
<pre class="text">See <a href="#10.1">section 10.1</a> about FastCGI application setup for details.
</pre><a class="anchor" name="use-server"></a><a class="anchor" name="4-use-server"></a><a class="anchor" name="4.2-use-server"></a><a class="anchor" name="use-server (Proxies)"></a><a class="anchor" name="use-server (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="use-server"></a><a href="#4.2-use-server">use-server</a></b> <span style="color: #080">&lt;server&gt;</span> if <span style="color: #080">&lt;condition&gt;</span></div><a class="anchor" name="use-server"></a><a class="anchor" name="4-use-server"></a><a class="anchor" name="4.2-use-server"></a><a class="anchor" name="use-server (Proxies)"></a><a class="anchor" name="use-server (Alphabetically sorted keywords reference)"></a><div class="keyword"><b><a class="anchor" name="use-server"></a><a href="#4.2-use-server">use-server</a></b> <span style="color: #080">&lt;server&gt;</span> unless <span style="color: #080">&lt;condition&gt;</span></div><pre class="text">Only use a specific server if/unless an ACL-based condition is matched.

May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;server&gt;    is the name of a valid server in the same backend section
            or a Custom log format string resolving to a server name
            (see <a href="#8.2.6">section 8.2.6</a>).

&lt;condition&gt; is a condition composed of ACLs, as described in <a href="#7">section 7</a>.</pre>
</div>
<pre class="text">By default, connections which arrive to a backend are load-balanced across
the available servers according to the configured algorithm, unless a
persistence mechanism such as a cookie is used and found in the request.

Sometimes it is desirable to forward a particular request to a specific
server without having to declare a dedicated backend for this server. This
can be achieved using the &quot;<a href="#use-server">use-server</a>&quot; rules. These rules are evaluated after
the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">redirect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#redirect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#redirect%20%28Alphabetically%20sorted%20actions%20reference%29">Alphabetically sorted actions reference</a></li></ul></span>&quot; rules and before evaluating cookies, and they have precedence
on them. There may be as many &quot;<a href="#use-server">use-server</a>&quot; rules as desired. All of these
rules are evaluated in their declaration order, and the first one which
matches will assign the server.

If a rule designates a server which is down, and &quot;<a href="#option%20persist">option persist</a>&quot; is not used
and no force-persist rule was validated, it is ignored and evaluation goes on
with the next rules until one matches.

In the first form, the server will be used if the condition is met. In the
second form, the server will be used if the condition is not met. If no
condition is valid, the processing continues and the server will be assigned
according to other persistence mechanisms.

Note that even if a rule is matched, cookie processing is still performed but
does not assign the server. This allows prefixed cookies to have their prefix
stripped.

The &quot;<a href="#use-server">use-server</a>&quot; statement works both in HTTP and TCP mode. This makes it
suitable for use with content-based inspection. For instance, a server could
be selected in a farm according to the TLS SNI field when using protocols with
implicit TLS (also see &quot;<a href="#req.ssl_sni">req.ssl_sni</a>&quot;). And if these servers have their weight
set to zero, they will not be used for other traffic.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># intercept incoming TLS requests based on the SNI field</span>
use-server www if { req.ssl_sni -i www.example.com }
server     www 192.168.0.1:443 weight 0
use-server mail if { req.ssl_sni -i mail.example.com }
server     mail 192.168.0.1:465 weight 0
use-server imap if { req.ssl_sni -i imap.example.com }
server     imap 192.168.0.1:993 weight 0
<span class="comment"># all the rest is forwarded to this server</span>
server  default 192.168.0.2:443 check
</code></pre>
</div><pre class="text">When &lt;server&gt; is a simple name, it is checked against existing servers in the
configuration and an error is reported if the specified server does not exist.
If it is a Custom log format, no check is performed when parsing the
configuration, and if we can't resolve a valid server name at runtime but the
use-server rule was conditioned by an ACL returning true, no other use-server
rule is applied and we fall back to load balancing.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#use_backend">use_backend</a>&quot;, <a href="#5">section 5</a> about server and <a href="#7">section 7</a> about ACLs.</div>
</div>
<a class="anchor" id="4.3" name="4.3"></a>
<h2 id="chapter-4.3" data-target="4.3"><small><a class="small" href="#4.3">4.3.</a></small> Actions keywords matrix</h2>
<div><pre class="text">Several rule sets are evaluated at various stages of the request or response
processing, and for each rule found in these rule sets, an action may be
executed if the optional condition is met.

A large number of actions are provided by default, they can modify contents,
accept/block processing, change internal states etc. And it is possible to
define new actions in Lua (in which case their names will always be prefixed
with &quot;lua.&quot;).

While historically some actions did only exist in specific rule sets, nowadays
many actions are usable with many rule sets. The listing in this section will
indicate for which supported action where it may be used, by ticking the
corresponding abbreviated entry names among the following rule sets:

  - QUIC  Ini: the action is valid for &quot;<a href="#quic-initial">quic-initial</a>&quot; rules
  - TCP RqCon: the action is valid for &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; rules
  - TCP RqSes: the action is valid for &quot;<a href="#tcp-request%20session">tcp-request session</a>&quot; rules
  - TCP RqCnt: the action is valid for &quot;<a href="#tcp-request%20content">tcp-request content</a>&quot; rules
  - TCP RsCnt: the action is valid for &quot;<a href="#tcp-response%20content">tcp-response content</a>&quot; rules
  - HTTP  Req:  the action is valid for &quot;<a href="#http-request">http-request</a>&quot; rules
  - HTTP  Res:  the action is valid for &quot;<a href="#http-response">http-response</a>&quot; rules
  - HTTP  Aft:  the action is valid for &quot;<a href="#http-after-response">http-after-response</a>&quot; rules

The same abbreviations are used in the reference <a href="#4.4">section 4.4</a> below.
</pre><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>keyword</th><th>QUIC: Ini</th><th>TCP: RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP: Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td ><a href="#4-accept">accept</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-add-acl">add-acl</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-add-header">add-header</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-allow">allow</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-attach-srv">attach-srv</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-auth">auth</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-cache-store">cache-store</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-cache-use">cache-use</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-capture">capture</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-close">close</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-del-acl">del-acl</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-del-header">del-header</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-del-map">del-map</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-deny">deny</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-dgram-drop">dgram-drop</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-disable-l7-retry">disable-l7-retry</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-do-log">do-log</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-do-resolve">do-resolve</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-early-hint">early-hint</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-expect-netscaler-cip">expect-netscaler-cip</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<thead><tr><th>keyword</th><th>QUIC: Ini</th><th>TCP: RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP: Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td ><a href="#4-expect-proxy%20layer4">expect-proxy layer4</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-normalize-uri">normalize-uri</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-redirect">redirect</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-reject">reject</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-replace-header">replace-header</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-replace-path">replace-path</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-replace-pathq">replace-pathq</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-replace-uri">replace-uri</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-replace-value">replace-value</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-return">return</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-sc-add-gpc">sc-add-gpc</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-sc-inc-gpc">sc-inc-gpc</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-sc-inc-gpc0">sc-inc-gpc0</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-sc-inc-gpc1">sc-inc-gpc1</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-sc-set-gpt">sc-set-gpt</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-sc-set-gpt0">sc-set-gpt0</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-send-retry">send-retry</a></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-send-spoe-group">send-spoe-group</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-bandwidth-limit">set-bandwidth-limit</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-bc-mark">set-bc-mark</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<thead><tr><th>keyword</th><th>QUIC: Ini</th><th>TCP: RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP: Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td ><a href="#4-set-bc-tos">set-bc-tos</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-dst">set-dst</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-dst-port">set-dst-port</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-fc-mark">set-fc-mark</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-fc-tos">set-fc-tos</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-header">set-header</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-set-log-level">set-log-level</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-set-map">set-map</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-set-mark"><span class="pull-right"><span class="label label-warning">(deprecated)</span></span>set-mark</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-method">set-method</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-nice">set-nice</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-path">set-path</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-pathq">set-pathq</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-priority-class">set-priority-class</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-priority-offset">set-priority-offset</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-query">set-query</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-retries">set-retries</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-src">set-src</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-src-port">set-src-port</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-status">set-status</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<thead><tr><th>keyword</th><th>QUIC: Ini</th><th>TCP: RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP: Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td ><a href="#4-set-timeout">set-timeout</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-tos"><span class="pull-right"><span class="label label-warning">(deprecated)</span></span>set-tos</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-uri">set-uri</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-set-var">set-var</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-set-var-fmt">set-var-fmt</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-silent-drop">silent-drop</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-strict-mode">strict-mode</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-switch-mode">switch-mode</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-tarpit">tarpit</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-track-sc1">track-sc1</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-track-sc2">track-sc2</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-unset-var">unset-var</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
<tr><td ><a href="#4-use-service">use-service</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-wait-for-body">wait-for-body</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
<tr><td ><a href="#4-wait-for-handshake">wait-for-handshake</a></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<a class="anchor" id="4.4" name="4.4"></a>
<h2 id="chapter-4.4" data-target="4.4"><small><a class="small" href="#4.4">4.4.</a></small> Alphabetically sorted actions reference</h2>
<div><pre class="text">This section provides a detailed description of each action and its usage,
using the same ruleset terminology marking as described in <a href="#4.3">section 4.3</a> above.
</pre><a class="anchor" name="accept"></a><a class="anchor" name="4-accept"></a><a class="anchor" name="4.4-accept"></a><a class="anchor" name="accept (Proxies)"></a><a class="anchor" name="accept (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="accept"></a><a href="#4.4-accept">accept</a></b></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This stops the evaluation of the rules and lets the request or response pass
the check. This action is final, i.e. no further rules from the same rule set
are evaluated for the current section. There is no difference between this
and the &quot;<a href="#allow">allow</a>&quot; action except that for historical compatibility, &quot;<a href="#accept">accept</a>&quot; is
used for TCP and QUIC rules and &quot;<a href="#allow">allow</a>&quot; for HTTP rules. See also the &quot;<a href="#allow">allow</a>&quot;
action below.
</pre><a class="anchor" name="add-acl"></a><a class="anchor" name="4-add-acl"></a><a class="anchor" name="4.4-add-acl"></a><a class="anchor" name="add-acl (Proxies)"></a><a class="anchor" name="add-acl (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="add-acl"></a><a href="#4.4-add-acl">add-acl</a></b>(<span style="color: #080">&lt;file-name&gt;</span>) <span style="color: #080">&lt;key fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This is used to add a new entry into an ACL. The ACL must be loaded from a
file (even a dummy empty file). The file name of the ACL to be updated is
passed between parentheses. It takes one argument: &lt;key fmt&gt;, which follows
Custom log format rules described in <a href="#8.2.6">section 8.2.6</a>, to collect content of the
new entry. It performs a lookup in the ACL before insertion, to avoid
duplicated (or more) values. It is the equivalent of the &quot;add acl&quot; command
from the stats socket, but can be triggered by an HTTP request.
</pre><a class="anchor" name="add-header"></a><a class="anchor" name="4-add-header"></a><a class="anchor" name="4.4-add-header"></a><a class="anchor" name="add-header (Proxies)"></a><a class="anchor" name="add-header (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="add-header"></a><a href="#4.4-add-header">add-header</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #080">&lt;fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This appends an HTTP header field whose name is specified in &lt;name&gt; and
whose value is defined by &lt;fmt&gt; which follows the Custom log format rules
(see Custom log format in <a href="#8.2.6">section 8.2.6</a>). This is particularly useful to pass
connection-specific information to the server (e.g. the client's SSL
certificate), or to combine several headers into one. This rule is not final,
so it is possible to add other similar rules. Note that header addition is
performed immediately, so one rule might reuse the resulting header from a
previous rule.
</pre><a class="anchor" name="allow"></a><a class="anchor" name="4-allow"></a><a class="anchor" name="4.4-allow"></a><a class="anchor" name="allow (Proxies)"></a><a class="anchor" name="allow (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="allow"></a><a href="#4.4-allow">allow</a></b></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This stops the evaluation of the rules and lets the request pass the check.
This action is final, i.e. no further rules from the same rule set are
evaluated for the current section. There is no difference between this and
the &quot;<a href="#accept">accept</a>&quot; action except that for historical compatibility, &quot;<a href="#accept">accept</a>&quot; is
used for TCP rules and &quot;<a href="#allow">allow</a>&quot; for HTTP rules. See also the &quot;<a href="#accept">accept</a>&quot; action
above.
</pre><a class="anchor" name="attach-srv"></a><a class="anchor" name="4-attach-srv"></a><a class="anchor" name="4.4-attach-srv"></a><a class="anchor" name="attach-srv (Proxies)"></a><a class="anchor" name="attach-srv (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="attach-srv"></a><a href="#4.4-attach-srv">attach-srv</a></b> <span style="color: #080">&lt;srv&gt;</span> <span style="color: #008">[name <span style="color: #080">&lt;expr&gt;</span>]</span> <span style="color: #008">[ EXPERIMENTAL ]</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This is used to intercept the connection after proper HTTP/2 establishment.
The connection is reversed to the backend side and inserted into the idle
pool of server &lt;srv&gt;. This may only be used with servers having an 'rhttp@'
address.

The connection is inserted into the server idle pool with a name defined by
the result of the &lt;expr&gt; evaluation. This is the name that will be matched
against by requests subject to &quot;<a href="#pool-conn-name">pool-conn-name</a>&quot; or &quot;<a href="#sni">sni</a>&quot; parameter. See
&quot;<a href="#http-reuse">http-reuse</a>&quot; for more details.

Reverse HTTP is currently still in active development. Configuration
mechanism may change in the future. For this reason it is internally marked
as experimental, meaning that &quot;<a href="#expose-experimental-directives">expose-experimental-directives</a>&quot; must appear on
a line before this directive.

Note that a very similar but independent protocol is under development. See
https://www.ietf.org/archive/id/draft-bt-httpbis-reverse-http-00.html.
</pre><a class="anchor" name="auth"></a><a class="anchor" name="4-auth"></a><a class="anchor" name="4.4-auth"></a><a class="anchor" name="auth (Proxies)"></a><a class="anchor" name="auth (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="auth"></a><a href="#4.4-auth">auth</a></b> <span style="color: #008">[realm <span style="color: #080">&lt;realm&gt;</span>]</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This stops the evaluation of the rules and immediately responds with an
HTTP 401 or 407 error code to invite the user to present a valid user name
and password. No further &quot;<a href="#http-request">http-request</a>&quot; rules are evaluated. An optional
&quot;realm&quot; parameter is supported, it sets the authentication realm that is
returned with the response (typically the application's name).

The corresponding proxy's error message is used. It may be customized using
an &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">errorfile<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#errorfile%20%28HTTP-errors%29">HTTP-errors</a></li><li><a href="#errorfile%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; or an &quot;<a href="#http-error">http-error</a>&quot; directive. For 401 responses, all
occurrences of the WWW-Authenticate header are removed and replaced by a new
one with a basic authentication challenge for realm &quot;&lt;realm&gt;&quot;. For 407
responses, the same is done on the Proxy-Authenticate header. If the error
message must not be altered, consider to use &quot;http-request return&quot; rule
instead.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>acl auth_ok http_auth_group(L1) G1
http-request auth unless auth_ok
</code></pre>
</div><a class="anchor" name="cache-store"></a><a class="anchor" name="4-cache-store"></a><a class="anchor" name="4.4-cache-store"></a><a class="anchor" name="cache-store (Proxies)"></a><a class="anchor" name="cache-store (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="cache-store"></a><a href="#4.4-cache-store">cache-store</a></b> <span style="color: #080">&lt;name&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">Store an http-response within the cache. The storage of the response headers
is done at this step, which means you can use others http-response actions
to modify headers before or after the storage of the response. This action
is responsible for the setup of the cache storage filter.

See <a href="#6.2">section 6.2</a> about cache setup.
</pre><a class="anchor" name="cache-use"></a><a class="anchor" name="4-cache-use"></a><a class="anchor" name="4.4-cache-use"></a><a class="anchor" name="cache-use (Proxies)"></a><a class="anchor" name="cache-use (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="cache-use"></a><a href="#4.4-cache-use">cache-use</a></b> <span style="color: #080">&lt;name&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">Try to deliver a cached object from the cache &lt;name&gt;. This directive is also
mandatory to store the cache as it calculates the cache hash. If you want to
use a condition for both storage and delivering that's a good idea to put it
after this one.

See <a href="#6.2">section 6.2</a> about cache setup.
</pre><a class="anchor" name="capture"></a><a class="anchor" name="4-capture"></a><a class="anchor" name="4.4-capture"></a><a class="anchor" name="capture (Proxies)"></a><a class="anchor" name="capture (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="capture"></a><a href="#4.4-capture">capture</a></b> <span style="color: #080">&lt;sample&gt;</span> <span style="color: #008">[ len <span style="color: #080">&lt;length&gt;</span> | id <span style="color: #080">&lt;id&gt;</span> ]</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This captures sample expression &lt;sample&gt; from the request or response buffer,
and converts it to a string of at most &lt;len&gt; characters. The resulting string
is stored into the next &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">capture<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#capture%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#capture%20%28Alphabetically%20sorted%20actions%20reference%29">Alphabetically sorted actions reference</a></li></ul></span>&quot; slot (either request or response), so it
will possibly appear next to some captured HTTP headers. It will then
automatically appear in the logs, and it will be possible to extract it using
sample fetch methods to feed it into headers or anything. The length should
be limited given that this size will be allocated for each capture during the
whole stream life. Note that the length is only usable with &quot;<a href="#http-request">http-request</a>&quot;
rules. Please check <a href="#7.3">section 7.3</a> (Fetching samples), &quot;<a href="#capture%20request%20header">capture request header</a>&quot;
and &quot;<a href="#capture%20response%20header">capture response header</a>&quot; for more information.

If the keyword &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">id<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#id%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#id%20%28Bind%20options%29">Bind options</a></li><li><a href="#id%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; is used instead of &quot;len&quot;, the action tries to store the
captured string in a previously declared capture slot. This is useful to run
captures in backends. The slot id can be declared by a previous directive
&quot;http-request capture&quot; or with the &quot;<a href="#declare%20capture">declare capture</a>&quot; keyword.

When using this action in a backend, please double check that the relevant
frontend(s) have the required capture slots otherwise, this rule will be
ignored at run time. This can't be detected at configuration parsing time due
to HAProxy's ability to dynamically resolve backend name at runtime.
</pre><a class="anchor" name="close"></a><a class="anchor" name="4-close"></a><a class="anchor" name="4.4-close"></a><a class="anchor" name="close (Proxies)"></a><a class="anchor" name="close (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="close"></a><a href="#4.4-close">close</a></b></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This is used to immediately close the connection with the server. No further
&quot;<a href="#tcp-response%20content">tcp-response content</a>&quot; rules are evaluated. The main purpose of this action
is to force a connection to be finished between a client and a server after
an exchange when the application protocol expects some long time outs to
elapse first. The goal is to eliminate idle connections which take
significant resources on servers with certain protocols.
</pre><a class="anchor" name="del-acl"></a><a class="anchor" name="4-del-acl"></a><a class="anchor" name="4.4-del-acl"></a><a class="anchor" name="del-acl (Proxies)"></a><a class="anchor" name="del-acl (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="del-acl"></a><a href="#4.4-del-acl">del-acl</a></b>(<span style="color: #080">&lt;file-name&gt;</span>) <span style="color: #080">&lt;key fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This is used to delete an entry from an ACL. The ACL must be loaded from a
file (even a dummy empty file). The file name of the ACL to be updated is
passed between parentheses. It takes one argument: &lt;key fmt&gt;, which follows
Custom log format rules of <a href="#8.2.6">section 8.2.6</a>, to collect content of the entry to
delete.  It is the equivalent of the &quot;del acl&quot; command from the stats socket,
but can be triggered by an HTTP request or response.
</pre><a class="anchor" name="del-header"></a><a class="anchor" name="4-del-header"></a><a class="anchor" name="4.4-del-header"></a><a class="anchor" name="del-header (Proxies)"></a><a class="anchor" name="del-header (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="del-header"></a><a href="#4.4-del-header">del-header</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #008">[ -m <span style="color: #080">&lt;meth&gt;</span> ]</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This removes all HTTP header fields whose name is specified in &lt;name&gt;. &lt;meth&gt;
is the matching method, applied on the header name. Supported matching methods
are &quot;<a href="#str">str</a>&quot; (exact match), &quot;beg&quot; (prefix match), &quot;end&quot; (suffix match), &quot;<a href="#sub">sub</a>&quot;
(substring match) and &quot;reg&quot; (regex match). If not specified, exact matching
method is used.
</pre><a class="anchor" name="del-map"></a><a class="anchor" name="4-del-map"></a><a class="anchor" name="4.4-del-map"></a><a class="anchor" name="del-map (Proxies)"></a><a class="anchor" name="del-map (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="del-map"></a><a href="#4.4-del-map">del-map</a></b>(<span style="color: #080">&lt;map-name&gt;</span>) <span style="color: #080">&lt;key fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This is used to delete an entry from a MAP. &lt;map-name&gt; must follow the format
described in 2.7. about name format for maps and ACLs. The name of the MAP to
be updated is passed between parentheses. It takes one argument: &lt;key fmt&gt;,
which follows Custom log format rules of <a href="#8.2.6">section 8.2.6</a>, to collect content of
the entry to delete.  It takes one argument: &quot;file name&quot; It is the equivalent
of the &quot;del map&quot; command from the stats socket, but can be triggered by an
HTTP request or response.
</pre><a class="anchor" name="deny"></a><a class="anchor" name="4-deny"></a><a class="anchor" name="4.4-deny"></a><a class="anchor" name="deny (Proxies)"></a><a class="anchor" name="deny (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="deny"></a><a href="#4.4-deny">deny</a></b> <span style="color: #008">[ <span style="color: #800">{ status | deny_status }</span> <span style="color: #080">&lt;code&gt;</span> ]</span> <span style="color: #008">[ content-type <span style="color: #080">&lt;type&gt;</span> ]</span>
     <span style="color: #008">[ <span style="color: #800">{ default-errorfiles | errorfile <span style="color: #080">&lt;file&gt;</span> | errorfiles <span style="color: #080">&lt;name&gt;</span> |
       file <span style="color: #080">&lt;file&gt;</span> | lf-file <span style="color: #080">&lt;file&gt;</span> | string <span style="color: #080">&lt;str&gt;</span> | lf-string <span style="color: #080">&lt;fmt&gt;</span> }</span> ]</span>
     <span style="color: #008">[ hdr <span style="color: #080">&lt;name&gt;</span> <span style="color: #080">&lt;fmt&gt;</span> ]</span>*</div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This stops the evaluation of the rules and immediately rejects the request or
response. By default an HTTP 403 error is returned for requests, and 502 for
responses, but the returned response may be customized using same syntax as
for the &quot;<a href="#return">return</a>&quot; action. Thus, see &quot;<a href="#return">return</a>&quot; below for details. For
compatibility purposes, when no argument is defined, or only &quot;deny_status&quot;,
the argument &quot;default-errorfiles&quot; is implied. It means &quot;deny [deny_status
&lt;status&gt;]&quot; is an alias of &quot;deny [status &lt;status&gt;] default-errorfiles&quot;. This
action is final, i.e. no further rules from the same rule set are evaluated
for the current section. See also the &quot;<a href="#return">return</a>&quot; action for the advanced
syntax.
</pre><a class="anchor" name="dgram-drop"></a><a class="anchor" name="4-dgram-drop"></a><a class="anchor" name="4.4-dgram-drop"></a><a class="anchor" name="dgram-drop (Proxies)"></a><a class="anchor" name="dgram-drop (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="dgram-drop"></a><a href="#4.4-dgram-drop">dgram-drop</a></b></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This silently ignores the reception of a QUIC initial packet which otherwise
would have resulted in a new QUIC connection instantiation and its SSL
handshake execution.
</pre><a class="anchor" name="disable-l7-retry"></a><a class="anchor" name="4-disable-l7-retry"></a><a class="anchor" name="4.4-disable-l7-retry"></a><a class="anchor" name="disable-l7-retry (Proxies)"></a><a class="anchor" name="disable-l7-retry (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="disable-l7-retry"></a><a href="#4.4-disable-l7-retry">disable-l7-retry</a></b></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This disables any attempt to retry the request if it fails for any other
reason than a connection failure. This can be useful for example to make
sure POST requests aren't retried on failure.
</pre><a class="anchor" name="do-log"></a><a class="anchor" name="4-do-log"></a><a class="anchor" name="4.4-do-log"></a><a class="anchor" name="do-log (Proxies)"></a><a class="anchor" name="do-log (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="do-log"></a><a href="#4.4-do-log">do-log</a></b></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This action manually triggers a log emission on the proxy. This means
log options on the proxy will be considered (including formatting options
such as &quot;<a href="#log-format">log-format</a>&quot;), but it will not interfere with the logs automatically
generated by the proxy during transaction handling. It currently doesn't
support any argument, though extensions may appear in future versions.

Using &quot;<a href="#log-profile">log-profile</a>&quot;, it is possible to precisely describe how the log should
be emitted for each of the available contexts where the action may be used.
That is, 'on' keyword followed by of the following values: 'quic-init',
'tcp-req-conn', 'tcp-req-sess', 'tcp-req-cont', 'tcp-res-cont', 'http-req',
'http-res', 'http-after-res'.

Also, they will be properly reported when using &quot;%OG&quot; logformat alias.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>log-profile myprof
  on tcp-req-conn format &quot;Connect: %ci&quot;

frontend myfront
  log stdout format rfc5424 profile myprof local0
  log-format &quot;log generated using proxy logformat, from '%OG'&quot;
  tcp-request connection do-log             <span class="comment">#uses special log-profile format</span>
  tcp-request content do-log                <span class="comment">#uses proxy logformat</span>
</code></pre>
</div><a class="anchor" name="do-resolve"></a><a class="anchor" name="4-do-resolve"></a><a class="anchor" name="4.4-do-resolve"></a><a class="anchor" name="do-resolve (Proxies)"></a><a class="anchor" name="do-resolve (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="do-resolve"></a><a href="#4.4-do-resolve">do-resolve</a></b>(<span style="color: #080">&lt;var&gt;</span>,<span style="color: #080">&lt;resolvers&gt;</span>,<span style="color: #008">[ipv4,ipv6]</span>) <span style="color: #080">&lt;expr&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This action performs a DNS resolution of the output of &lt;expr&gt; and stores
the result in the variable &lt;var&gt;. It uses the DNS resolvers section
pointed by &lt;resolvers&gt;.
It is possible to choose a resolution preference using the optional
arguments 'ipv4' or 'ipv6'.
When performing the DNS resolution, the client side connection is on
pause waiting till the end of the resolution.
If an IP address can be found, it is stored into &lt;var&gt;. If any kind of
error occurs, then &lt;var&gt; is not set.
One can use this action to discover a server IP address at run time and
based on information found in the request (IE a Host header).
If this action is used to find the server's IP address (using the
&quot;<a href="#set-dst">set-dst</a>&quot; action), then the server IP address in the backend must be set
to 0.0.0.0. The do-resolve action takes an host-only parameter, any port must
be removed from the string.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>resolvers mydns
  nameserver local 127.0.0.53:53
  nameserver google 8.8.8.8:53
  timeout retry   1s
  hold valid 10s
  hold nx 3s
  hold other 3s
  hold obsolete 0s
  accepted_payload_size 8192

frontend fe
  bind 10.42.0.1:80
  http-request do-resolve(txn.myip,mydns,ipv4) hdr(Host),host_only
  http-request capture var(txn.myip) len 40

  <span class="comment"># return 503 when the variable is not set,</span>
  <span class="comment"># which mean DNS resolution error</span>
  use_backend b_503 unless { var(txn.myip) -m found }

  default_backend be

backend b_503
  <span class="comment"># dummy backend used to return 503.</span>
  <span class="comment"># one can use the errorfile directive to send a nice</span>
  <span class="comment"># 503 error page to end users</span>

backend be
  <span class="comment"># rule to prevent HAProxy from reconnecting to services</span>
  <span class="comment"># on the local network (forged DNS name used to scan the network)</span>
  http-request deny if { var(txn.myip) -m ip 127.0.0.0/8 10.0.0.0/8 }
  http-request set-dst var(txn.myip)
  server clear 0.0.0.0:0
</code></pre>
</div><pre class="text">NOTE: Don't forget to set the &quot;protection&quot; rules to ensure HAProxy won't
      be used to scan the network or worst won't loop over itself...
</pre><a class="anchor" name="early-hint"></a><a class="anchor" name="4-early-hint"></a><a class="anchor" name="4.4-early-hint"></a><a class="anchor" name="early-hint (Proxies)"></a><a class="anchor" name="early-hint (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="early-hint"></a><a href="#4.4-early-hint">early-hint</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #080">&lt;fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This is used to build an HTTP 103 Early Hints response prior to any other one.
This appends an HTTP header field to this response whose name is specified in
&lt;name&gt; and whose value is defined by &lt;fmt&gt; which follows the Custom Log
Format rules (see Custom log format in <a href="#8.2.6">section 8.2.6</a>). This is particularly
useful to pass to the client some Link headers to preload resources required
to render the HTML documents.

See RFC 8297 for more information.
</pre><a class="anchor" name="expect-netscaler-cip"></a><a class="anchor" name="4-expect-netscaler-cip"></a><a class="anchor" name="4.4-expect-netscaler-cip"></a><a class="anchor" name="expect-netscaler-cip (Proxies)"></a><a class="anchor" name="expect-netscaler-cip (Alphabetically sorted actions reference)"></a><a class="anchor" name="expect-netscaler-cip layer4"></a><a class="anchor" name="4-expect-netscaler-cip layer4"></a><a class="anchor" name="4.4-expect-netscaler-cip layer4"></a><a class="anchor" name="expect-netscaler-cip layer4 (Proxies)"></a><a class="anchor" name="expect-netscaler-cip layer4 (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="expect-netscaler-cip layer4"></a><a href="#4.4-expect-netscaler-cip%20layer4">expect-netscaler-cip layer4</a></b></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This configures the client-facing connection to receive a NetScaler Client IP
insertion protocol header before any byte is read from the socket.  This is
equivalent to having the &quot;<a href="#accept-netscaler-cip">accept-netscaler-cip</a>&quot; keyword on the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line,
except that using the TCP rule allows the PROXY protocol to be accepted only
for certain IP address ranges using an ACL. This is convenient when multiple
layers of load balancers are passed through by traffic coming from public
hosts.
</pre><a class="anchor" name="expect-proxy"></a><a class="anchor" name="4-expect-proxy"></a><a class="anchor" name="4.4-expect-proxy"></a><a class="anchor" name="expect-proxy (Proxies)"></a><a class="anchor" name="expect-proxy (Alphabetically sorted actions reference)"></a><a class="anchor" name="expect-proxy layer4"></a><a class="anchor" name="4-expect-proxy layer4"></a><a class="anchor" name="4.4-expect-proxy layer4"></a><a class="anchor" name="expect-proxy layer4 (Proxies)"></a><a class="anchor" name="expect-proxy layer4 (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="expect-proxy layer4"></a><a href="#4.4-expect-proxy%20layer4">expect-proxy layer4</a></b></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This configures the client-facing connection to receive a PROXY protocol
header before any byte is read from the socket. This is equivalent to having
the &quot;<a href="#accept-proxy">accept-proxy</a>&quot; keyword on the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line, except that using the TCP rule
allows the PROXY protocol to be accepted only for certain IP address ranges
using an ACL. This is convenient when multiple layers of load balancers are
passed through by traffic coming from public hosts.
</pre><a class="anchor" name="normalize-uri"></a><a class="anchor" name="4-normalize-uri"></a><a class="anchor" name="4.4-normalize-uri"></a><a class="anchor" name="normalize-uri (Proxies)"></a><a class="anchor" name="normalize-uri (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="normalize-uri"></a><a href="#4.4-normalize-uri">normalize-uri</a></b> <span style="color: #080">&lt;normalizer&gt;</span></div><a class="anchor" name="normalize-uri"></a><a class="anchor" name="4-normalize-uri"></a><a class="anchor" name="4.4-normalize-uri"></a><a class="anchor" name="normalize-uri (Proxies)"></a><a class="anchor" name="normalize-uri (Alphabetically sorted actions reference)"></a><a class="anchor" name="normalize-uri fragment-encode"></a><a class="anchor" name="4-normalize-uri fragment-encode"></a><a class="anchor" name="4.4-normalize-uri fragment-encode"></a><a class="anchor" name="normalize-uri fragment-encode (Proxies)"></a><a class="anchor" name="normalize-uri fragment-encode (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="normalize-uri fragment-encode"></a><a href="#4.4-normalize-uri%20fragment-encode">normalize-uri fragment-encode</a></b></div><a class="anchor" name="normalize-uri"></a><a class="anchor" name="4-normalize-uri"></a><a class="anchor" name="4.4-normalize-uri"></a><a class="anchor" name="normalize-uri (Proxies)"></a><a class="anchor" name="normalize-uri (Alphabetically sorted actions reference)"></a><a class="anchor" name="normalize-uri fragment-strip"></a><a class="anchor" name="4-normalize-uri fragment-strip"></a><a class="anchor" name="4.4-normalize-uri fragment-strip"></a><a class="anchor" name="normalize-uri fragment-strip (Proxies)"></a><a class="anchor" name="normalize-uri fragment-strip (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="normalize-uri fragment-strip"></a><a href="#4.4-normalize-uri%20fragment-strip">normalize-uri fragment-strip</a></b></div><a class="anchor" name="normalize-uri"></a><a class="anchor" name="4-normalize-uri"></a><a class="anchor" name="4.4-normalize-uri"></a><a class="anchor" name="normalize-uri (Proxies)"></a><a class="anchor" name="normalize-uri (Alphabetically sorted actions reference)"></a><a class="anchor" name="normalize-uri path-merge-slashes"></a><a class="anchor" name="4-normalize-uri path-merge-slashes"></a><a class="anchor" name="4.4-normalize-uri path-merge-slashes"></a><a class="anchor" name="normalize-uri path-merge-slashes (Proxies)"></a><a class="anchor" name="normalize-uri path-merge-slashes (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="normalize-uri path-merge-slashes"></a><a href="#4.4-normalize-uri%20path-merge-slashes">normalize-uri path-merge-slashes</a></b></div><a class="anchor" name="normalize-uri"></a><a class="anchor" name="4-normalize-uri"></a><a class="anchor" name="4.4-normalize-uri"></a><a class="anchor" name="normalize-uri (Proxies)"></a><a class="anchor" name="normalize-uri (Alphabetically sorted actions reference)"></a><a class="anchor" name="normalize-uri path-strip-dot"></a><a class="anchor" name="4-normalize-uri path-strip-dot"></a><a class="anchor" name="4.4-normalize-uri path-strip-dot"></a><a class="anchor" name="normalize-uri path-strip-dot (Proxies)"></a><a class="anchor" name="normalize-uri path-strip-dot (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="normalize-uri path-strip-dot"></a><a href="#4.4-normalize-uri%20path-strip-dot">normalize-uri path-strip-dot</a></b></div><a class="anchor" name="normalize-uri"></a><a class="anchor" name="4-normalize-uri"></a><a class="anchor" name="4.4-normalize-uri"></a><a class="anchor" name="normalize-uri (Proxies)"></a><a class="anchor" name="normalize-uri (Alphabetically sorted actions reference)"></a><a class="anchor" name="normalize-uri path-strip-dotdot"></a><a class="anchor" name="4-normalize-uri path-strip-dotdot"></a><a class="anchor" name="4.4-normalize-uri path-strip-dotdot"></a><a class="anchor" name="normalize-uri path-strip-dotdot (Proxies)"></a><a class="anchor" name="normalize-uri path-strip-dotdot (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="normalize-uri path-strip-dotdot"></a><a href="#4.4-normalize-uri%20path-strip-dotdot">normalize-uri path-strip-dotdot</a></b> <span style="color: #008">[ full ]</span></div><a class="anchor" name="normalize-uri"></a><a class="anchor" name="4-normalize-uri"></a><a class="anchor" name="4.4-normalize-uri"></a><a class="anchor" name="normalize-uri (Proxies)"></a><a class="anchor" name="normalize-uri (Alphabetically sorted actions reference)"></a><a class="anchor" name="normalize-uri percent-decode-unreserved"></a><a class="anchor" name="4-normalize-uri percent-decode-unreserved"></a><a class="anchor" name="4.4-normalize-uri percent-decode-unreserved"></a><a class="anchor" name="normalize-uri percent-decode-unreserved (Proxies)"></a><a class="anchor" name="normalize-uri percent-decode-unreserved (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="normalize-uri percent-decode-unreserved"></a><a href="#4.4-normalize-uri%20percent-decode-unreserved">normalize-uri percent-decode-unreserved</a></b> <span style="color: #008">[ strict ]</span></div><a class="anchor" name="normalize-uri"></a><a class="anchor" name="4-normalize-uri"></a><a class="anchor" name="4.4-normalize-uri"></a><a class="anchor" name="normalize-uri (Proxies)"></a><a class="anchor" name="normalize-uri (Alphabetically sorted actions reference)"></a><a class="anchor" name="normalize-uri percent-to-uppercase"></a><a class="anchor" name="4-normalize-uri percent-to-uppercase"></a><a class="anchor" name="4.4-normalize-uri percent-to-uppercase"></a><a class="anchor" name="normalize-uri percent-to-uppercase (Proxies)"></a><a class="anchor" name="normalize-uri percent-to-uppercase (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="normalize-uri percent-to-uppercase"></a><a href="#4.4-normalize-uri%20percent-to-uppercase">normalize-uri percent-to-uppercase</a></b> <span style="color: #008">[ strict ]</span></div><a class="anchor" name="normalize-uri"></a><a class="anchor" name="4-normalize-uri"></a><a class="anchor" name="4.4-normalize-uri"></a><a class="anchor" name="normalize-uri (Proxies)"></a><a class="anchor" name="normalize-uri (Alphabetically sorted actions reference)"></a><a class="anchor" name="normalize-uri query-sort-by-name"></a><a class="anchor" name="4-normalize-uri query-sort-by-name"></a><a class="anchor" name="4.4-normalize-uri query-sort-by-name"></a><a class="anchor" name="normalize-uri query-sort-by-name (Proxies)"></a><a class="anchor" name="normalize-uri query-sort-by-name (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="normalize-uri query-sort-by-name"></a><a href="#4.4-normalize-uri%20query-sort-by-name">normalize-uri query-sort-by-name</a></b></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">Performs normalization of the request's URI.

URI normalization in HAProxy 2.4 is currently available as an experimental
technical preview. As such, it requires the global directive
'expose-experimental-directives' first to be able to invoke it. You should be
prepared that the behavior of normalizers might change to fix possible
issues, possibly breaking proper request processing in your infrastructure.

Each normalizer handles a single type of normalization to allow for a
fine-grained selection of the level of normalization that is appropriate for
the supported backend.

As an example the &quot;path-strip-dotdot&quot; normalizer might be useful for a static
fileserver that directly maps the requested URI to the path within the local
filesystem. However it might break routing of an API that expects a specific
number of segments in the path.

It is important to note that some normalizers might result in unsafe
transformations for broken URIs. It might also be possible that a combination
of normalizers that are safe by themselves results in unsafe transformations
when improperly combined.

As an example the &quot;percent-decode-unreserved&quot; normalizer might result in
unexpected results when a broken URI includes bare percent characters. One
such a broken URI is &quot;/%%36%36&quot; which would be decoded to &quot;/%66&quot; which in
turn is equivalent to &quot;/f&quot;. By specifying the &quot;strict&quot; option requests to
such a broken URI would safely be rejected.

The following normalizers are available:

- fragment-encode: Encodes &quot;#&quot; as &quot;%23&quot;.

    The &quot;fragment-strip&quot; normalizer should be preferred, unless it is known
    that broken clients do not correctly encode '#' within the path component.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>- /#foo  -&gt; /%23foo
</code></pre>
</div><pre class="text">- fragment-strip: Removes the URI's &quot;fragment&quot; component.

    According to RFC 3986#3.5 the &quot;fragment&quot; component of an URI should not
    be sent, but handled by the User Agent after retrieving a resource.

    This normalizer should be applied first to ensure that the fragment is
    not interpreted as part of the request's path component.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>- /#foo  -&gt; /
</code></pre>
</div><pre class="text">- path-strip-dot: Removes &quot;/./&quot; segments within the &quot;<a href="#path">path</a>&quot; component
    (RFC 3986#6.2.2.3).

    Segments including percent encoded dots (&quot;%2E&quot;) will not be detected. Use
    the &quot;percent-decode-unreserved&quot; normalizer first if this is undesired.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>- /.            -&gt; /
- /./bar/       -&gt; /bar/
- /a/./a        -&gt; /a/a
- /.well-known/ -&gt; /.well-known/ (no change)
</code></pre>
</div><pre class="text">- path-strip-dotdot: Normalizes &quot;/../&quot; segments within the &quot;<a href="#path">path</a>&quot; component
    (RFC 3986#6.2.2.3).

    This merges segments that attempt to access the parent directory with
    their preceding segment.

    Empty segments do not receive special treatment. Use the &quot;merge-slashes&quot;
    normalizer first if this is undesired.

    Segments including percent encoded dots (&quot;%2E&quot;) will not be detected. Use
    the &quot;percent-decode-unreserved&quot; normalizer first if this is undesired.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>- /foo/../     -&gt; /
- /foo/../bar/ -&gt; /bar/
- /foo/bar/../ -&gt; /foo/
- /../bar/     -&gt; /../bar/
- /bar/../../  -&gt; /../
- /foo//../    -&gt; /foo/
- /foo/%2E%2E/ -&gt; /foo/%2E%2E/
</code></pre>
</div><pre class="text">If the &quot;full&quot; option is specified then &quot;../&quot; at the beginning will be
removed as well:
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>- /../bar/     -&gt; /bar/
- /bar/../../  -&gt; /
</code></pre>
</div><pre class="text">- path-merge-slashes: Merges adjacent slashes within the &quot;<a href="#path">path</a>&quot; component
    into a single slash.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>- //        -&gt; /
- /foo//bar -&gt; /foo/bar
</code></pre>
</div><pre class="text">- percent-decode-unreserved: Decodes unreserved percent encoded characters to
    their representation as a regular character (RFC 3986#6.2.2.2).

    The set of unreserved characters includes all letters, all digits, &quot;-&quot;,
    &quot;.&quot;, &quot;_&quot;, and &quot;~&quot;.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>- /%61dmin       -&gt; /admin
- /foo%3Fbar=baz -&gt; /foo%3Fbar=baz (no change)
- /%%36%36       -&gt; /%66           (unsafe)
- /%ZZ           -&gt; /%ZZ
</code></pre>
</div><pre class="text">If the &quot;strict&quot; option is specified then invalid sequences will result
in a HTTP 400 Bad Request being returned.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>- /%%36%36 -&gt; HTTP 400
- /%ZZ     -&gt; HTTP 400
</code></pre>
</div><pre class="text">- percent-to-uppercase: Uppercases letters within percent-encoded sequences
    (RFC 3986#6.2.2.1).
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>- /%6f -&gt; /%6F
- /%zz -&gt; /%zz
</code></pre>
</div><pre class="text">If the &quot;strict&quot; option is specified then invalid sequences will result
in a HTTP 400 Bad Request being returned.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>- /%zz -&gt; HTTP 400
</code></pre>
</div><pre class="text">- query-sort-by-name: Sorts the query string parameters by parameter name.
    Parameters are assumed to be delimited by '&amp;'. Shorter names sort before
    longer names and identical parameter names maintain their relative order.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>- /?c=3&amp;a=1&amp;b=2         -&gt; /?a=1&amp;b=2&amp;c=3
- /?aaa=3&amp;a=1&amp;aa=2      -&gt; /?a=1&amp;aa=2&amp;aaa=3
- /?a=3&amp;b=4&amp;a=1&amp;b=5&amp;a=2 -&gt; /?a=3&amp;a=1&amp;a=2&amp;b=4&amp;b=5
</code></pre>
</div><a class="anchor" name="redirect"></a><a class="anchor" name="4-redirect"></a><a class="anchor" name="4.4-redirect"></a><a class="anchor" name="redirect (Proxies)"></a><a class="anchor" name="redirect (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="redirect"></a><a href="#4.4-redirect">redirect</a></b> <span style="color: #080">&lt;rule&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This performs an HTTP redirection based on a redirect rule. This is exactly
the same as the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">redirect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#redirect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#redirect%20%28Alphabetically%20sorted%20actions%20reference%29">Alphabetically sorted actions reference</a></li></ul></span>&quot; statement except that it inserts a redirect rule
which is processed in the middle of other &quot;<a href="#http-request">http-request</a>&quot; or &quot;<a href="#http-response">http-response</a>&quot;
rules and that these rules use the Custom log format. For responses, only
the &quot;location&quot; type of redirect is permitted. In addition, when a redirect is
performed during a response, the transfer from the server to HAProxy is
interrupted so that no payload can be forwarded to the client. This may cause
some connections to be closed on HTTP/1. This action is final, i.e. no
further rules from the same rule set are evaluated for the current section.
See the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">redirect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#redirect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#redirect%20%28Alphabetically%20sorted%20actions%20reference%29">Alphabetically sorted actions reference</a></li></ul></span>&quot; keyword for the rule's syntax.
</pre><a class="anchor" name="reject"></a><a class="anchor" name="4-reject"></a><a class="anchor" name="4.4-reject"></a><a class="anchor" name="reject (Proxies)"></a><a class="anchor" name="reject (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="reject"></a><a href="#4.4-reject">reject</a></b></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This stops the evaluation of the rules and immediately closes the connection
without sending any response. For HTTP rules, it acts similarly to the
&quot;tcp-request content reject&quot; rules. It can be useful to force an immediate
connection closure on HTTP/2 connections.

In &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; rules, rejected connections do not even become a
session, which is why they are accounted separately for in the stats, as
&quot;denied connections&quot;. They are not considered for the session rate-limit and
are not logged either. The reason is that these rules should only be used to
filter extremely high connection rates such as the ones encountered during a
massive DDoS attack. Under these extreme conditions, the simple action of
logging each event would make the system collapse and would considerably
lower the filtering capacity. If logging is absolutely desired, then
&quot;<a href="#tcp-request%20content">tcp-request content</a>&quot; rules should be used instead, as &quot;<a href="#tcp-request%20session">tcp-request session</a>&quot;
rules will not log either.

When used in &quot;<a href="#tcp-response%20content">tcp-response content</a>&quot; rules, the server connection will be
closed and the response aborted. This is generally used to prevent sensitive
information from leaking, typically after inspecting contents in conjunction
with the &quot;<a href="#wait-for-body">wait-for-body</a>&quot; action.

This action can also be used in &quot;<a href="#quic-initial">quic-initial</a>&quot; rules. The newly opened QUIC
connection is immediately closed without any SSL handshake processing and the
client is notified via a CONNECTION_REFUSED error code.
</pre><a class="anchor" name="replace-header"></a><a class="anchor" name="4-replace-header"></a><a class="anchor" name="4.4-replace-header"></a><a class="anchor" name="replace-header (Proxies)"></a><a class="anchor" name="replace-header (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="replace-header"></a><a href="#4.4-replace-header">replace-header</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #080">&lt;match-regex&gt;</span> <span style="color: #080">&lt;replace-fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This matches the value of all occurrences of header field &lt;name&gt; against
&lt;match-regex&gt;. Matching is performed case-sensitively. Matching values are
completely replaced by &lt;replace-fmt&gt;. Format characters are allowed in
&lt;replace-fmt&gt; and work like &lt;fmt&gt; arguments in &quot;http-request add-header&quot;.
Standard back-references using the backslash ('\') followed by a number are
supported.

This action acts on whole header lines, regardless of the number of values
they may contain. Thus it is well-suited to process headers naturally
containing commas in their value, such as If-Modified-Since or Set-Cookie.
Headers that contain a comma-separated list of values, such as Accept, or
Cache-Control should be processed using the &quot;<a href="#replace-value">replace-value</a>&quot; action instead.
See also the &quot;<a href="#replace-value">replace-value</a>&quot; action.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request replace-header Cookie foo=([^;]*);(.*) foo=\1;ip=%bi;\2

<span class="comment"># applied to:</span>
Cookie: foo=foobar; expires=Tue, 14-Jun-2016 01:40:45 GMT;

<span class="comment"># outputs:</span>
Cookie: foo=foobar;ip=192.168.1.20; expires=Tue, 14-Jun-2016 01:40:45 GMT;

<span class="comment"># assuming the backend IP is 192.168.1.20</span>

http-request replace-header User-Agent curl foo

<span class="comment"># applied to:</span>
User-Agent: curl/7.47.0

<span class="comment"># outputs:</span>
User-Agent: foo
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-response replace-header Set-Cookie (C=[^;]*);(.*) \1;ip=%bi;\2

<span class="comment"># applied to:</span>
Set-Cookie: C=1; expires=Tue, 14-Jun-2016 01:40:45 GMT

<span class="comment"># outputs:</span>
Set-Cookie: C=1;ip=192.168.1.20; expires=Tue, 14-Jun-2016 01:40:45 GMT

<span class="comment"># assuming the backend IP is 192.168.1.20.</span>
</code></pre>
</div><a class="anchor" name="replace-path"></a><a class="anchor" name="4-replace-path"></a><a class="anchor" name="4.4-replace-path"></a><a class="anchor" name="replace-path (Proxies)"></a><a class="anchor" name="replace-path (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="replace-path"></a><a href="#4.4-replace-path">replace-path</a></b> <span style="color: #080">&lt;match-regex&gt;</span> <span style="color: #080">&lt;replace-fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This works like &quot;<a href="#replace-header">replace-header</a>&quot; except that it works on the request's path
component instead of a header. The path component starts at the first '/'
after an optional scheme+authority and ends before the question mark. Thus,
the replacement does not modify the scheme, the authority and the
query-string.

It is worth noting that regular expressions may be more expensive to evaluate
than certain ACLs, so rare replacements may benefit from a condition to avoid
performing the evaluation at all if it does not match.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># prefix /foo : turn /bar?q=1 into /foo/bar?q=1 :</span>
http-request replace-path (.*) /foo\1

<span class="comment"># strip /foo : turn /foo/bar?q=1 into /bar?q=1</span>
http-request replace-path /foo/(.*) /\1
<span class="comment"># or more efficient if only some requests match :</span>
http-request replace-path /foo/(.*) /\1 if { url_beg /foo/ }
</code></pre>
</div><a class="anchor" name="replace-pathq"></a><a class="anchor" name="4-replace-pathq"></a><a class="anchor" name="4.4-replace-pathq"></a><a class="anchor" name="replace-pathq (Proxies)"></a><a class="anchor" name="replace-pathq (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="replace-pathq"></a><a href="#4.4-replace-pathq">replace-pathq</a></b> <span style="color: #080">&lt;match-regex&gt;</span> <span style="color: #080">&lt;replace-fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This does the same as &quot;http-request replace-path&quot; except that the path
contains the query-string if any is present. Thus, the path and the
query-string are replaced.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># suffix /foo : turn /bar?q=1 into /bar/foo?q=1 :</span>
http-request replace-pathq ([^?]*)(\?(.*))? \1/foo\2
</code></pre>
</div><a class="anchor" name="replace-uri"></a><a class="anchor" name="4-replace-uri"></a><a class="anchor" name="4.4-replace-uri"></a><a class="anchor" name="replace-uri (Proxies)"></a><a class="anchor" name="replace-uri (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="replace-uri"></a><a href="#4.4-replace-uri">replace-uri</a></b> <span style="color: #080">&lt;match-regex&gt;</span> <span style="color: #080">&lt;replace-fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This works like &quot;<a href="#replace-header">replace-header</a>&quot; except that it works on the request's URI part
instead of a header. The URI part may contain an optional scheme, authority or
query string. These are considered to be part of the value that is matched
against.

It is worth noting that regular expressions may be more expensive to evaluate
than certain ACLs, so rare replacements may benefit from a condition to avoid
performing the evaluation at all if it does not match.

IMPORTANT NOTE: historically in HTTP/1.x, the vast majority of requests sent
by browsers use the &quot;origin form&quot;, which differs from the &quot;absolute form&quot; in
that they do not contain a scheme nor authority in the URI portion. Mostly
only requests sent to proxies, those forged by hand and some emitted by
certain applications use the absolute form. As such, &quot;<a href="#replace-uri">replace-uri</a>&quot; usually
works fine most of the time in HTTP/1.x with rules starting with a &quot;/&quot;. But
with HTTP/2, clients are encouraged to send absolute URIs only, which look
like the ones HTTP/1 clients use to talk to proxies. Such partial replace-uri
rules may then fail in HTTP/2 when they work in HTTP/1. Either the rules need
to be adapted to optionally match a scheme and authority, or replace-path
should be used.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># rewrite all &quot;http&quot; absolute requests to &quot;https&quot;:</span>
http-request replace-uri ^http://(.*) https://\1

<span class="comment"># prefix /foo : turn /bar?q=1 into /foo/bar?q=1 :</span>
http-request replace-uri ([^/:]*://[^/]*)?(.*) \1/foo\2
</code></pre>
</div><a class="anchor" name="replace-value"></a><a class="anchor" name="4-replace-value"></a><a class="anchor" name="4.4-replace-value"></a><a class="anchor" name="replace-value (Proxies)"></a><a class="anchor" name="replace-value (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="replace-value"></a><a href="#4.4-replace-value">replace-value</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #080">&lt;match-regex&gt;</span> <span style="color: #080">&lt;replace-fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This works like &quot;<a href="#replace-header">replace-header</a>&quot; except that it matches the regex against
every comma-delimited value of the header field &lt;name&gt; instead of the
entire header. This is suited for all headers which are allowed to carry
more than one value. An example could be the Accept request header, or
Cache-Control for requests or responses.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request replace-value X-Forwarded-For ^192\.168\.(.*)$ 172.16.\1

<span class="comment"># applied to:</span>
X-Forwarded-For: 192.168.10.1, 192.168.13.24, 10.0.0.37

<span class="comment"># outputs:</span>
X-Forwarded-For: 172.16.10.1, 172.16.13.24, 10.0.0.37
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-after-response replace-value Cache-control ^public$ private

<span class="comment"># applied to:</span>
Cache-Control: max-age=3600, public

<span class="comment"># outputs:</span>
Cache-Control: max-age=3600, private
</code></pre>
</div><a class="anchor" name="return"></a><a class="anchor" name="4-return"></a><a class="anchor" name="4.4-return"></a><a class="anchor" name="return (Proxies)"></a><a class="anchor" name="return (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="return"></a><a href="#4.4-return">return</a></b> <span style="color: #008">[ status <span style="color: #080">&lt;code&gt;</span> ]</span> <span style="color: #008">[ content-type <span style="color: #080">&lt;type&gt;</span> ]</span>
       <span style="color: #008">[ <span style="color: #800">{ default-errorfiles | errorfile <span style="color: #080">&lt;file&gt;</span> | errorfiles <span style="color: #080">&lt;name&gt;</span> |
         file <span style="color: #080">&lt;file&gt;</span> | lf-file <span style="color: #080">&lt;file&gt;</span> | string <span style="color: #080">&lt;str&gt;</span> | lf-string <span style="color: #080">&lt;fmt&gt;</span> }</span> ]</span>
       <span style="color: #008">[ hdr <span style="color: #080">&lt;name&gt;</span> <span style="color: #080">&lt;fmt&gt;</span> ]</span>*</div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This stops the evaluation of the rules and immediately returns a response. The
default status code used for the response is 200. It can be optionally
specified as an arguments to &quot;<a href="#status">status</a>&quot;. The response content-type may also be
specified as an argument to &quot;content-type&quot;. Finally the response itself may
be defined. It can be a full HTTP response specifying the errorfile to use,
or the response payload specifying the file or the string to use. These rules
are followed to create the response :

* If neither the errorfile nor the payload to use is defined, a dummy
  response is returned. Only the &quot;<a href="#status">status</a>&quot; argument is considered. It can be
  any code in the range [200, 599]. The &quot;content-type&quot; argument, if any, is
  ignored.

* If &quot;default-errorfiles&quot; argument is set, the proxy's errorfiles are
  considered.  If the &quot;<a href="#status">status</a>&quot; argument is defined, it must be one of the
  status code handled by HAProxy (200, 400, 403, 404, 405, 408, 410, 413,
  414, 425, 429, 431, 500, 501, 502, 503, and 504). The &quot;content-type&quot;
  argument, if any, is ignored.

* If a specific errorfile is defined, with an &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">errorfile<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#errorfile%20%28HTTP-errors%29">HTTP-errors</a></li><li><a href="#errorfile%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; argument, the
  corresponding file, containing a full HTTP response, is returned. Only the
  &quot;<a href="#status">status</a>&quot; argument is considered. It must be one of the status code handled
  by HAProxy (200, 400, 403, 404, 405, 408, 410, 413, 414, 425, 429, 431,
  500, 501, 502, 503, and 504). The &quot;content-type&quot; argument, if any, is
  ignored.

* If an http-errors section is defined, with an &quot;<a href="#errorfiles">errorfiles</a>&quot; argument, the
  corresponding file in the specified http-errors section, containing a full
  HTTP response, is returned. Only the &quot;<a href="#status">status</a>&quot; argument is considered. It
  must be one of the status code handled by HAProxy (200, 400, 403, 404, 405,
  408, 410, 413, 414, 425, 429, 431, 500, 501, 502, 503, and 504).
  The &quot;content-type&quot; argument, if any, is ignored.

* If a &quot;file&quot; or a &quot;lf-file&quot; argument is specified, the file's content is
  used as the response payload. If the file is not empty, its content-type
  must be set as argument to &quot;content-type&quot;. Otherwise, any &quot;content-type&quot;
  argument is ignored. With a &quot;lf-file&quot; argument, the file's content is
  evaluated as a Custom log format (see <a href="#8.2.6">section 8.2.6</a>). With a &quot;file&quot;
  argument, it is considered as a raw content.

* If a &quot;string&quot; or &quot;lf-string&quot; argument is specified, the defined string is
  used as the response payload. The content-type must always be set as
  argument to &quot;content-type&quot;. With a &quot;lf-string&quot; argument, the string is
  evaluated as a Custom log format (see <a href="#8.2.6">section 8.2.6</a>). With a &quot;string&quot;
  argument, it is considered as a raw string.

When the response is not based on an errorfile, it is possible to append HTTP
header fields to the response using &quot;<a href="#hdr">hdr</a>&quot; arguments. Otherwise, all &quot;<a href="#hdr">hdr</a>&quot;
arguments are ignored. For each one, the header name is specified in &lt;name&gt;
and its value is defined by &lt;fmt&gt; which follows the Custom log format rules
described in <a href="#8.2.6">section 8.2.6</a>.

Note that the generated response must be smaller than a buffer. And to avoid
any warning, when an errorfile or a raw file is loaded, the buffer space
reserved for the headers rewriting should also be free.

This action is final, i.e. no further rules from the same rule set are
evaluated for the current section.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request return errorfile /etc/haproxy/errorfiles/200.http \
    if { path /ping }

http-request return content-type image/x-icon file /var/www/favicon.ico  \
    if { path /favicon.ico }

http-request return status 403 content-type text/plain    \
    lf-string &quot;Access denied. IP %[src] is blacklisted.&quot;  \
    if { src -f /etc/haproxy/blacklist.lst }
</code></pre>
</div><a class="anchor" name="sc-add-gpc"></a><a class="anchor" name="4-sc-add-gpc"></a><a class="anchor" name="4.4-sc-add-gpc"></a><a class="anchor" name="sc-add-gpc (Proxies)"></a><a class="anchor" name="sc-add-gpc (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="sc-add-gpc"></a><a href="#4.4-sc-add-gpc">sc-add-gpc</a></b>(<span style="color: #080">&lt;idx&gt;</span>,<span style="color: #080">&lt;sc-id&gt;</span>) <span style="color: #800">{ <span style="color: #080">&lt;int&gt;</span> | <span style="color: #080">&lt;expr&gt;</span> }</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This action increments the General Purpose Counter at the index &lt;idx&gt; of the
array associated to the sticky counter designated by &lt;sc-id&gt; by the value of
either integer &lt;int&gt; or the integer evaluation of expression &lt;expr&gt;. Integers
and expressions are limited to unsigned 32-bit values. If an error occurs,
this action silently fails and the actions evaluation continues. &lt;idx&gt; is an
integer between 0 and 99 and &lt;sc-id&gt; is an integer between 0 and 2. It also
silently fails if the there is no GPC stored at this index. The entry in the
table is refreshed even if the value is zero. The 'gpc_rate' is automatically
adjusted to reflect the average growth rate of the gpc value.

This action applies only to the 'gpc' and 'gpc_rate' array data_types (and
not to the legacy 'gpc0', 'gpc1', 'gpc0_rate' nor 'gpc1_rate' data_types).
There is no equivalent function for legacy data types, but if the value is
always 1, please see 'sc-inc-gpc()', 'sc-inc-gpc0()' and 'sc-inc-gpc1()'.
There is no way to decrement the value either, but it is possible to store
exact values in a General Purpose Tag using 'sc-set-gpt()' instead.

The main use of this action is to count scores or total volumes (e.g.
estimated danger per source IP reported by the server or a WAF, total
uploaded bytes, etc).
</pre><a class="anchor" name="sc-inc-gpc"></a><a class="anchor" name="4-sc-inc-gpc"></a><a class="anchor" name="4.4-sc-inc-gpc"></a><a class="anchor" name="sc-inc-gpc (Proxies)"></a><a class="anchor" name="sc-inc-gpc (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="sc-inc-gpc"></a><a href="#4.4-sc-inc-gpc">sc-inc-gpc</a></b>(<span style="color: #080">&lt;idx&gt;</span>,<span style="color: #080">&lt;sc-id&gt;</span>)</div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This actions increments the General Purpose Counter at the index &lt;idx&gt; of the
array associated to the sticky counter designated by &lt;sc-id&gt;. If an error
occurs, this action silently fails and the actions evaluation continues.
&lt;idx&gt; is an integer between 0 and 99 and &lt;sc-id&gt; is an integer between 0 and
2. It also silently fails if the there is no GPC stored at this index. This
action applies only to the 'gpc' and 'gpc_rate' array data_types (and not to
the legacy 'gpc0', 'gpc1', 'gpc0_rate' nor 'gpc1_rate' data_types).
</pre><a class="anchor" name="sc-inc-gpc0"></a><a class="anchor" name="4-sc-inc-gpc0"></a><a class="anchor" name="4.4-sc-inc-gpc0"></a><a class="anchor" name="sc-inc-gpc0 (Proxies)"></a><a class="anchor" name="sc-inc-gpc0 (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="sc-inc-gpc0"></a><a href="#4.4-sc-inc-gpc0">sc-inc-gpc0</a></b>(<span style="color: #080">&lt;sc-id&gt;</span>)</div><a class="anchor" name="sc-inc-gpc1"></a><a class="anchor" name="4-sc-inc-gpc1"></a><a class="anchor" name="4.4-sc-inc-gpc1"></a><a class="anchor" name="sc-inc-gpc1 (Proxies)"></a><a class="anchor" name="sc-inc-gpc1 (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="sc-inc-gpc1"></a><a href="#4.4-sc-inc-gpc1">sc-inc-gpc1</a></b>(<span style="color: #080">&lt;sc-id&gt;</span>)</div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This actions increments the GPC0 or GPC1 counter according with the sticky
counter designated by &lt;sc-id&gt;. If an error occurs, this action silently fails
and the actions evaluation continues.
</pre><a class="anchor" name="sc-set-gpt"></a><a class="anchor" name="4-sc-set-gpt"></a><a class="anchor" name="4.4-sc-set-gpt"></a><a class="anchor" name="sc-set-gpt (Proxies)"></a><a class="anchor" name="sc-set-gpt (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="sc-set-gpt"></a><a href="#4.4-sc-set-gpt">sc-set-gpt</a></b>(<span style="color: #080">&lt;idx&gt;</span>,<span style="color: #080">&lt;sc-id&gt;</span>) <span style="color: #800">{ <span style="color: #080">&lt;int&gt;</span> | <span style="color: #080">&lt;expr&gt;</span> }</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This action sets the 32-bit unsigned GPT at the index &lt;idx&gt; of the array
associated to the sticky counter designated by &lt;sc-id&gt; at the value of
&lt;int&gt;/&lt;expr&gt;. The expected result is a boolean.

If an error occurs, this action silently fails and the actions evaluation
continues. &lt;idx&gt; is an integer between 0 and 99 and &lt;sc-id&gt; is an integer
between 0 and 2. It also silently fails if the there is no GPT stored
at this index.

This action applies only to the 'gpt' array data_type (and not to the
legacy 'gpt0' data-type).
</pre><a class="anchor" name="sc-set-gpt0"></a><a class="anchor" name="4-sc-set-gpt0"></a><a class="anchor" name="4.4-sc-set-gpt0"></a><a class="anchor" name="sc-set-gpt0 (Proxies)"></a><a class="anchor" name="sc-set-gpt0 (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="sc-set-gpt0"></a><a href="#4.4-sc-set-gpt0">sc-set-gpt0</a></b>(<span style="color: #080">&lt;sc-id&gt;</span>) <span style="color: #800">{ <span style="color: #080">&lt;int&gt;</span> | <span style="color: #080">&lt;expr&gt;</span> }</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This action sets the 32-bit unsigned GPT0 tag according to the sticky counter
designated by &lt;sc-id&gt; and the value of &lt;int&gt;/&lt;expr&gt;. The expected result is a
boolean. If an error occurs, this action silently fails and the actions
evaluation continues. This action is an alias for &quot;sc-set-gpt(0,&lt;sc-id&gt;)&quot;.
See also the &quot;<a href="#sc-set-gpt">sc-set-gpt</a>&quot; action.
</pre><a class="anchor" name="send-retry"></a><a class="anchor" name="4-send-retry"></a><a class="anchor" name="4.4-send-retry"></a><a class="anchor" name="send-retry (Proxies)"></a><a class="anchor" name="send-retry (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="send-retry"></a><a href="#4.4-send-retry">send-retry</a></b></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This action forces the emission of a Retry packet in response to a client
Initial packet without token. This is useful to ensure client address is
validated prior to instantiating any connection elements and starting the
handshake.
</pre><a class="anchor" name="send-spoe-group"></a><a class="anchor" name="4-send-spoe-group"></a><a class="anchor" name="4.4-send-spoe-group"></a><a class="anchor" name="send-spoe-group (Proxies)"></a><a class="anchor" name="send-spoe-group (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="send-spoe-group"></a><a href="#4.4-send-spoe-group">send-spoe-group</a></b> <span style="color: #080">&lt;engine-name&gt;</span> <span style="color: #080">&lt;group-name&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This action is used to trigger sending of a group of SPOE messages. To do so,
the SPOE engine used to send messages must be defined, as well as the SPOE
group to send. Of course, the SPOE engine must refer to an existing SPOE
filter. If not engine name is provided on the SPOE filter line, the SPOE
agent name must be used.
</pre><div class="separator">
<span class="label label-info">Arguments:</span><pre class="prettyprint arguments">&lt;engine-name&gt;  The SPOE engine name.

&lt;group-name&gt;   The SPOE group name as specified in the engine
               configuration.</pre>
</div>
<a class="anchor" name="set-bandwidth-limit"></a><a class="anchor" name="4-set-bandwidth-limit"></a><a class="anchor" name="4.4-set-bandwidth-limit"></a><a class="anchor" name="set-bandwidth-limit (Proxies)"></a><a class="anchor" name="set-bandwidth-limit (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-bandwidth-limit"></a><a href="#4.4-set-bandwidth-limit">set-bandwidth-limit</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #008">[limit <span style="color: #800">{<span style="color: #080">&lt;expr&gt;</span> | <span style="color: #080">&lt;size&gt;</span>}</span>]</span> <span style="color: #008">[period <span style="color: #800">{<span style="color: #080">&lt;expr&gt;</span> | <span style="color: #080">&lt;time&gt;</span>}</span>]</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This action is used to enable the bandwidth limitation filter &lt;name&gt;, either
on the upload or download direction depending on the filter type. Custom
limit and period may be defined, if and only if &lt;name&gt; references a
per-stream bandwidth limitation filter. When a set-bandwidth-limit rule is
executed, it first resets all settings of the filter to their defaults prior
to enabling it. As a consequence, if several &quot;<a href="#set-bandwidth-limit">set-bandwidth-limit</a>&quot; actions
are executed for the same filter, only the last one is considered. Several
bandwidth limitation filters can be enabled on the same stream.

Note that this action cannot be used in a defaults section because bandwidth
limitation filters cannot be defined in defaults sections. In addition, only
the HTTP payload transfer is limited. The HTTP headers are not considered.
</pre><div class="separator">
<span class="label label-info">Arguments:</span><pre class="prettyprint arguments">&lt;expr&gt;  Is a standard HAProxy expression formed by a sample-fetch followed
        by some converters. The result is converted to an integer. It is
        interpreted as a size in bytes for the &quot;limit&quot; parameter and as a
        duration in milliseconds for the &quot;period&quot; parameter.

&lt;size&gt;  Is a number. It follows the HAProxy size format and is expressed in
        bytes.

&lt;time&gt;  Is a number. It follows the HAProxy time format and is expressed in
        milliseconds.</pre>
</div>
<div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request set-bandwidth-limit global-limit
http-request set-bandwidth-limit my-limit limit 1m period 10s
</code></pre>
</div><pre class="text">See <a href="#9.7">section 9.7</a> about bandwidth limitation filter setup.
</pre><a class="anchor" name="set-bc-mark"></a><a class="anchor" name="4-set-bc-mark"></a><a class="anchor" name="4.4-set-bc-mark"></a><a class="anchor" name="set-bc-mark (Proxies)"></a><a class="anchor" name="set-bc-mark (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-bc-mark"></a><a href="#4.4-set-bc-mark">set-bc-mark</a></b> <span style="color: #800">{ <span style="color: #080">&lt;mark&gt;</span> | <span style="color: #080">&lt;expr&gt;</span> }</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This is used to set the Netfilter/IPFW MARK on the backend connection (all
packets sent to the server) to the value passed in &lt;mark&gt; or &lt;expr&gt; on
platforms which support it. This value is an unsigned 32 bit value which can
be matched by netfilter/ipfw and by the routing table or monitoring the
packets through DTrace. &lt;mark&gt; can be expressed both in decimal or hexadecimal
format (prefixed by &quot;0x&quot;). Alternatively, &lt;expr&gt; can be used: it is a standard
HAProxy expression formed by a sample-fetch followed by some converters which
must resolve to integer type. This action can be useful to force certain
packets to take a different route (for example a cheaper network path for bulk
downloads). This works on Linux kernels 2.6.32 and above and requires admin
privileges, as well on FreeBSD and OpenBSD. The mark will be set for the whole
duration of the backend/server connection (from connect to close).
</pre><a class="anchor" name="set-bc-tos"></a><a class="anchor" name="4-set-bc-tos"></a><a class="anchor" name="4.4-set-bc-tos"></a><a class="anchor" name="set-bc-tos (Proxies)"></a><a class="anchor" name="set-bc-tos (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-bc-tos"></a><a href="#4.4-set-bc-tos">set-bc-tos</a></b> <span style="color: #800">{ <span style="color: #080">&lt;tos&gt;</span> | <span style="color: #080">&lt;expr&gt;</span> }</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This is used to set the TOS or DSCP field value on the backend connection
(all packets sent to the server) to the value passed in &lt;tos&gt; or &lt;expr&gt; on
platforms which support this. This value represents the whole 8 bits of the
IP TOS field. Note that only the 6 higher bits are used in DSCP or TOS, and
the two lower bits are always 0. Alternatively, &lt;expr&gt; can be used: it is a
standard HAProxy expression formed by a sample-fetch followed by some
converters which must resolve to integer type. This action can be used to
adjust some routing behavior on inner routers based on some information from
the request. The tos will be set for the whole duration of the backend/server
connection (from connect to close).

See RFC 2474, 2597, 3260 and 4594 for more information.
</pre><a class="anchor" name="set-dst"></a><a class="anchor" name="4-set-dst"></a><a class="anchor" name="4.4-set-dst"></a><a class="anchor" name="set-dst (Proxies)"></a><a class="anchor" name="set-dst (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-dst"></a><a href="#4.4-set-dst">set-dst</a></b> <span style="color: #080">&lt;expr&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This is used to set the destination IP address to the value of specified
expression. Useful when a proxy in front of HAProxy rewrites destination IP,
but provides the correct IP in a HTTP header; or you want to mask the IP for
privacy. If you want to connect to the new address/port, use '0.0.0.0:0' as a
server address in the backend.
</pre><div class="separator">
<span class="label label-info">Arguments:</span><pre class="prettyprint arguments">&lt;expr&gt;  Is a standard HAProxy expression formed by a sample-fetch followed
        by some converters.</pre>
</div>
<div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request set-dst hdr(x-dst)
http-request set-dst dst,ipmask(24)
</code></pre>
</div><pre class="text">When possible, set-dst preserves the original destination port as long as the
address family allows it, otherwise the destination port is set to 0.
</pre><a class="anchor" name="set-dst-port"></a><a class="anchor" name="4-set-dst-port"></a><a class="anchor" name="4.4-set-dst-port"></a><a class="anchor" name="set-dst-port (Proxies)"></a><a class="anchor" name="set-dst-port (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-dst-port"></a><a href="#4.4-set-dst-port">set-dst-port</a></b> <span style="color: #080">&lt;expr&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This is used to set the destination port address to the value of specified
expression. If you want to connect to the new address/port, use '0.0.0.0:0'
as a server address in the backend.
</pre><div class="separator">
<span class="label label-info">Arguments:</span><pre class="prettyprint arguments">&lt;expr&gt;  Is a standard HAProxy expression formed by a sample-fetch
        followed by some converters.</pre>
</div>
<div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request set-dst-port hdr(x-port)
http-request set-dst-port int(4000)
</code></pre>
</div><pre class="text">When possible, set-dst-port preserves the original destination address as
long as the address family supports a port, otherwise it forces the
destination address to IPv4 &quot;0.0.0.0&quot; before rewriting the port.
</pre><a class="anchor" name="set-fc-mark"></a><a class="anchor" name="4-set-fc-mark"></a><a class="anchor" name="4.4-set-fc-mark"></a><a class="anchor" name="set-fc-mark (Proxies)"></a><a class="anchor" name="set-fc-mark (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-fc-mark"></a><a href="#4.4-set-fc-mark">set-fc-mark</a></b> <span style="color: #800">{ <span style="color: #080">&lt;mark&gt;</span> | <span style="color: #080">&lt;expr&gt;</span> }</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This is used to set the Netfilter/IPFW MARK on all packets sent to the client
to the value passed in &lt;mark&gt; or &lt;expr&gt; on platforms which support it. This
value is an unsigned 32 bit value which can be matched by netfilter/ipfw and
by the routing table or monitoring the packets through DTrace. &lt;mark&gt; can be
expressed both in decimal or hexadecimal format (prefixed by &quot;0x&quot;).
Alternatively, &lt;expr&gt; can be used: it is a standard HAProxy expression formed
by a sample-fetch followed by some converters which must resolve to integer
type. This action can be useful to force certain packets to take a different
route (for example a cheaper network path for bulk downloads). This works on
Linux kernels 2.6.32 and above and requires admin privileges, as well on
FreeBSD and OpenBSD.
</pre><a class="anchor" name="set-fc-tos"></a><a class="anchor" name="4-set-fc-tos"></a><a class="anchor" name="4.4-set-fc-tos"></a><a class="anchor" name="set-fc-tos (Proxies)"></a><a class="anchor" name="set-fc-tos (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-fc-tos"></a><a href="#4.4-set-fc-tos">set-fc-tos</a></b> <span style="color: #800">{ <span style="color: #080">&lt;tos | <span style="color: #080">&lt;expr&gt;</span> </span>}</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This is used to set the TOS or DSCP field value of packets sent to the client
to the value passed in &lt;tos&gt; or &lt;expr&gt; on platforms which support this. This
value represents the whole 8 bits of the IP TOS field. Note that only the 6
higher bits are used in DSCP or TOS, and the two lower bits are always 0.
Alternatively, &lt;expr&gt; can be used: it is a standard HAProxy expression formed
by a sample-fetch followed by some converters which must resolve to integer
type. This action can be used to adjust some routing behavior on border
routers based on some information from the request.

See RFC 2474, 2597, 3260 and 4594 for more information.
</pre><a class="anchor" name="set-header"></a><a class="anchor" name="4-set-header"></a><a class="anchor" name="4.4-set-header"></a><a class="anchor" name="set-header (Proxies)"></a><a class="anchor" name="set-header (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-header"></a><a href="#4.4-set-header">set-header</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #080">&lt;fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This does the same as the &quot;<a href="#add-header">add-header</a>&quot; action except that the header is first
removed if it existed. This is useful when passing security information to
the server, where the header must not be manipulated by external users, or to
force certain response headers such as &quot;Server&quot; to hide external information.
Note that the new value is computed before the removal so it is possible to
concatenate a value to an existing header.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request set-header X-Haproxy-Current-Date %T
http-request set-header X-SSL                  %[ssl_fc]
http-request set-header X-SSL-Session_ID       %[ssl_fc_session_id,hex]
http-request set-header X-SSL-Client-Verify    %[ssl_c_verify]
http-request set-header X-SSL-Client-DN        %{+Q}[ssl_c_s_dn]
http-request set-header X-SSL-Client-CN        %{+Q}[ssl_c_s_dn(cn)]
http-request set-header X-SSL-Issuer           %{+Q}[ssl_c_i_dn]
http-request set-header X-SSL-Client-NotBefore %{+Q}[ssl_c_notbefore]
http-request set-header X-SSL-Client-NotAfter  %{+Q}[ssl_c_notafter]
</code></pre>
</div><a class="anchor" name="set-log-level"></a><a class="anchor" name="4-set-log-level"></a><a class="anchor" name="4.4-set-log-level"></a><a class="anchor" name="set-log-level (Proxies)"></a><a class="anchor" name="set-log-level (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-log-level"></a><a href="#4.4-set-log-level">set-log-level</a></b> <span style="color: #080">&lt;level&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This is used to change the log level of the current request when a certain
condition is met. Valid levels are the 8 syslog levels (see the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;
keyword) plus the special level &quot;silent&quot; which disables logging for this
request. This rule is not final so the last matching rule wins. This rule
can be useful to disable health checks coming from another equipment.
</pre><a class="anchor" name="set-map"></a><a class="anchor" name="4-set-map"></a><a class="anchor" name="4.4-set-map"></a><a class="anchor" name="set-map (Proxies)"></a><a class="anchor" name="set-map (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-map"></a><a href="#4.4-set-map">set-map</a></b>(<span style="color: #080">&lt;map-name&gt;</span>) <span style="color: #080">&lt;key fmt&gt;</span> <span style="color: #080">&lt;value fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This is used to add a new entry into a map. &lt;map-name&gt; must follow the format
described in 2.7. about name format for maps and ACLs. The name of the MAP to
be updated is passed between parentheses. It takes 2 arguments: &lt;key fmt&gt;,
which follows Custom log format rules described in <a href="#8.2.6">section 8.2.6</a>, used to
collect map key, and &lt;value fmt&gt;, which follows Custom log format rules, used
to collect content for the new entry. It performs a lookup in the map before
insertion, to avoid duplicated (or more) values. It is the equivalent of the
&quot;set map&quot; command from the stats socket, but can be triggered by an HTTP
request.
</pre><a class="anchor" name="set-mark"></a><a class="anchor" name="4-set-mark"></a><a class="anchor" name="4.4-set-mark"></a><a class="anchor" name="set-mark (Proxies)"></a><a class="anchor" name="set-mark (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-mark"></a><a href="#4.4-set-mark">set-mark</a></b> <span style="color: #080">&lt;mark&gt;</span> <span class="label label-warning">(deprecated)</span></div><pre class="text">This is an alias for &quot;<a href="#set-fc-mark">set-fc-mark</a>&quot; (which should be used instead).
</pre><a class="anchor" name="set-method"></a><a class="anchor" name="4-set-method"></a><a class="anchor" name="4.4-set-method"></a><a class="anchor" name="set-method (Proxies)"></a><a class="anchor" name="set-method (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-method"></a><a href="#4.4-set-method">set-method</a></b> <span style="color: #080">&lt;fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This rewrites the request method with the result of the evaluation of format
string &lt;fmt&gt;. There should be very few valid reasons for having to do so as
this is more likely to break something than to fix it.
</pre><a class="anchor" name="set-nice"></a><a class="anchor" name="4-set-nice"></a><a class="anchor" name="4.4-set-nice"></a><a class="anchor" name="set-nice (Proxies)"></a><a class="anchor" name="set-nice (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-nice"></a><a href="#4.4-set-nice">set-nice</a></b> <span style="color: #080">&lt;nice&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This sets the &quot;<a href="#nice">nice</a>&quot; factor of the current request/response being processed.
It only has effect against the other requests being processed at the same
time.  The default value is 0, unless altered by the &quot;<a href="#nice">nice</a>&quot; setting on the
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line. The accepted range is -1024..1024. The higher the value, the
nicest the request will be. Lower values will make the request more important
than other ones. This can be useful to improve the speed of some requests, or
lower the priority of non-important requests. Using this setting without
prior experimentation can cause some major slowdown.
</pre><a class="anchor" name="set-path"></a><a class="anchor" name="4-set-path"></a><a class="anchor" name="4.4-set-path"></a><a class="anchor" name="set-path (Proxies)"></a><a class="anchor" name="set-path (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-path"></a><a href="#4.4-set-path">set-path</a></b> <span style="color: #080">&lt;fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This rewrites the request path with the result of the evaluation of format
string &lt;fmt&gt;. The query string, if any, is left intact. If a scheme and
authority is found before the path, they are left intact as well. If the
request doesn't have a path (&quot;*&quot;), this one is replaced with the format.
This can be used to prepend a directory component in front of a path for
example. See also &quot;http-request set-query&quot; and &quot;http-request set-uri&quot;.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># prepend the host name before the path</span>
http-request set-path /%[hdr(host)]%[path]
</code></pre>
</div><a class="anchor" name="set-pathq"></a><a class="anchor" name="4-set-pathq"></a><a class="anchor" name="4.4-set-pathq"></a><a class="anchor" name="set-pathq (Proxies)"></a><a class="anchor" name="set-pathq (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-pathq"></a><a href="#4.4-set-pathq">set-pathq</a></b> <span style="color: #080">&lt;fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This does the same as &quot;http-request set-path&quot; except that the query-string is
also rewritten. It may be used to remove the query-string, including the
question mark (it is not possible using &quot;http-request set-query&quot;).
</pre><a class="anchor" name="set-priority-class"></a><a class="anchor" name="4-set-priority-class"></a><a class="anchor" name="4.4-set-priority-class"></a><a class="anchor" name="set-priority-class (Proxies)"></a><a class="anchor" name="set-priority-class (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-priority-class"></a><a href="#4.4-set-priority-class">set-priority-class</a></b> <span style="color: #080">&lt;expr&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This is used to set the queue priority class of the current request.
The value must be a sample expression which converts to an integer in the
range -2047..2047. Results outside this range will be truncated.
The priority class determines the order in which queued requests are
processed. Lower values have higher priority.
</pre><a class="anchor" name="set-priority-offset"></a><a class="anchor" name="4-set-priority-offset"></a><a class="anchor" name="4.4-set-priority-offset"></a><a class="anchor" name="set-priority-offset (Proxies)"></a><a class="anchor" name="set-priority-offset (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-priority-offset"></a><a href="#4.4-set-priority-offset">set-priority-offset</a></b> <span style="color: #080">&lt;expr&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This is used to set the queue priority timestamp offset of the current
request. The value must be a sample expression which converts to an integer
in the range -524287..524287. Results outside this range will be truncated.
When a request is queued, it is ordered first by the priority class, then by
the current timestamp adjusted by the given offset in milliseconds. Lower
values have higher priority.
Note that the resulting timestamp is is only tracked with enough precision
for 524,287ms (8m44s287ms). If the request is queued long enough to where the
adjusted timestamp exceeds this value, it will be misidentified as highest
priority. Thus it is important to set &quot;<a href="#timeout%20queue">timeout queue</a>&quot; to a value, where when
combined with the offset, does not exceed this limit.
</pre><a class="anchor" name="set-query"></a><a class="anchor" name="4-set-query"></a><a class="anchor" name="4.4-set-query"></a><a class="anchor" name="set-query (Proxies)"></a><a class="anchor" name="set-query (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-query"></a><a href="#4.4-set-query">set-query</a></b> <span style="color: #080">&lt;fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This rewrites the request's query string which appears after the first
question mark (&quot;?&quot;) with the result of the evaluation of format string &lt;fmt&gt;.
The part prior to the question mark is left intact. If the request doesn't
contain a question mark and the new value is not empty, then one is added at
the end of the URI, followed by the new value. If a question mark was
present, it will never be removed even if the value is empty. This can be
used to add or remove parameters from the query string.

See also &quot;http-request set-query&quot; and &quot;http-request set-uri&quot;.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># replace &quot;%3D&quot; with &quot;=&quot; in the query string</span>
http-request set-query %[query,regsub(%3D,=,g)]
</code></pre>
</div><a class="anchor" name="set-retries"></a><a class="anchor" name="4-set-retries"></a><a class="anchor" name="4.4-set-retries"></a><a class="anchor" name="set-retries (Proxies)"></a><a class="anchor" name="set-retries (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-retries"></a><a href="#4.4-set-retries">set-retries</a></b> <span style="color: #080">&lt;int&gt;</span> | <span style="color: #080">&lt;epxr&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This action overrides the specified &quot;<a href="#retries">retries</a>&quot; value for the current stream
only. It can be an integer value, in the range [0, 100], or an expression
which must return a integer in the range [0, 100].

Note that this action is only relevant on the backend side and thus this rule
is only available for the proxies with backend capability. It is also not
allowed in &quot;defaults&quot; sections.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>tcp-request content set-retries 3
http-request set-retries var(txn.retries)
</code></pre>
</div><a class="anchor" name="set-src"></a><a class="anchor" name="4-set-src"></a><a class="anchor" name="4.4-set-src"></a><a class="anchor" name="set-src (Proxies)"></a><a class="anchor" name="set-src (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-src"></a><a href="#4.4-set-src">set-src</a></b> <span style="color: #080">&lt;expr&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This is used to set the source IP address to the value of specified
expression. Useful when a proxy in front of HAProxy rewrites source IP, but
provides the correct IP in a HTTP header; or you want to mask source IP for
privacy. All subsequent calls to &quot;<a href="#src">src</a>&quot; fetch will return this value
(see example).
</pre><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;expr&gt;  Is a standard HAProxy expression formed by a sample-fetch followed
        by some converters.</pre>
</div>
<pre class="text">See also &quot;<a href="#option%20forwardfor">option forwardfor</a>&quot;.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request set-src hdr(x-forwarded-for)
http-request set-src src,ipmask(24)

<span class="comment"># After the masking this will track connections</span>
<span class="comment"># based on the IP address with the last byte zeroed out.</span>
http-request track-sc0 src
</code></pre>
</div><pre class="text">When possible, set-src preserves the original source port as long as the
address family allows it, otherwise the source port is set to 0.
</pre><a class="anchor" name="set-src-port"></a><a class="anchor" name="4-set-src-port"></a><a class="anchor" name="4.4-set-src-port"></a><a class="anchor" name="set-src-port (Proxies)"></a><a class="anchor" name="set-src-port (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-src-port"></a><a href="#4.4-set-src-port">set-src-port</a></b> <span style="color: #080">&lt;expr&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This is used to set the source port address to the value of specified
expression.
</pre><div class="separator">
<span class="label label-info">Arguments:</span><pre class="prettyprint arguments">&lt;expr&gt;  Is a standard HAProxy expression formed by a sample-fetch followed
        by some converters.</pre>
</div>
<div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request set-src-port hdr(x-port)
http-request set-src-port int(4000)
</code></pre>
</div><pre class="text">When possible, set-src-port preserves the original source address as long as
the address family supports a port, otherwise it forces the source address to
IPv4 &quot;0.0.0.0&quot; before rewriting the port.
</pre><a class="anchor" name="set-status"></a><a class="anchor" name="4-set-status"></a><a class="anchor" name="4.4-set-status"></a><a class="anchor" name="set-status (Proxies)"></a><a class="anchor" name="set-status (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-status"></a><a href="#4.4-set-status">set-status</a></b> <span style="color: #080">&lt;status&gt;</span> <span style="color: #008">[reason <span style="color: #080">&lt;str&gt;</span>]</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This replaces the response status code with &lt;status&gt; which must be an integer
between 100 and 999. Optionally, a custom reason text can be provided defined
by &lt;str&gt;, or the default reason for the specified code will be used as a
fallback. Note that the reason string only exists in HTTP/1.x and is ignored
by other versions of the protocol.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># return &quot;431 Request Header Fields Too Large&quot;</span>
http-response set-status 431
<span class="comment"># return &quot;503 Slow Down&quot;, custom reason</span>
http-response set-status 503 reason &quot;Slow Down&quot;.
</code></pre>
</div><a class="anchor" name="set-timeout"></a><a class="anchor" name="4-set-timeout"></a><a class="anchor" name="4.4-set-timeout"></a><a class="anchor" name="set-timeout (Proxies)"></a><a class="anchor" name="set-timeout (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-timeout"></a><a href="#4.4-set-timeout">set-timeout</a></b> <span style="color: #800">{ client | server | tunnel }</span> <span style="color: #800">{ <span style="color: #080">&lt;timeout&gt;</span> | <span style="color: #080">&lt;expr&gt;</span> }</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This action overrides the specified &quot;client&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; or &quot;tunnel&quot; timeout
for the current stream only. The timeout can be specified in milliseconds or
with any other unit if the number is suffixed by the unit as explained at the
top of this document. It is also possible to write an expression which must
return a number interpreted as a timeout in milliseconds.

Note that the server/tunnel timeouts are only relevant on the backend side
and thus this rule is only available for the proxies with backend
capabilities. Likewise, client timeout is only relevant for frontend side.
Also the timeout value must be non-null to obtain the expected results.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request set-timeout tunnel 5s
http-request set-timeout server req.hdr(host),map_int(host.lst)
</code></pre>
</div><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-response set-timeout tunnel 5s
http-response set-timeout server res.hdr(X-Refresh-Seconds),mul(1000)
</code></pre>
</div><a class="anchor" name="set-tos"></a><a class="anchor" name="4-set-tos"></a><a class="anchor" name="4.4-set-tos"></a><a class="anchor" name="set-tos (Proxies)"></a><a class="anchor" name="set-tos (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-tos"></a><a href="#4.4-set-tos">set-tos</a></b> <span style="color: #080">&lt;tos&gt;</span> <span class="label label-warning">(deprecated)</span></div><pre class="text">This is an alias for &quot;<a href="#set-fc-tos">set-fc-tos</a>&quot; (which should be used instead).
</pre><a class="anchor" name="set-uri"></a><a class="anchor" name="4-set-uri"></a><a class="anchor" name="4.4-set-uri"></a><a class="anchor" name="set-uri (Proxies)"></a><a class="anchor" name="set-uri (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-uri"></a><a href="#4.4-set-uri">set-uri</a></b> <span style="color: #080">&lt;fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This rewrites the request URI with the result of the evaluation of format
string &lt;fmt&gt;. The scheme, authority, path and query string are all replaced
at once. This can be used to rewrite hosts in front of proxies, or to perform
complex modifications to the URI such as moving parts between the path and
the query string. If an absolute URI is set, it will be sent as is to
HTTP/1.1 servers. If it is not the desired behavior, the host, the path
and/or the query string should be set separately.
See also &quot;http-request set-path&quot; and &quot;http-request set-query&quot;.
</pre><a class="anchor" name="set-var"></a><a class="anchor" name="4-set-var"></a><a class="anchor" name="4.4-set-var"></a><a class="anchor" name="set-var (Proxies)"></a><a class="anchor" name="set-var (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-var"></a><a href="#4.4-set-var">set-var</a></b>(<span style="color: #080">&lt;var-name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;cond&gt;</span>...]</span>) <span style="color: #080">&lt;expr&gt;</span></div><a class="anchor" name="set-var-fmt"></a><a class="anchor" name="4-set-var-fmt"></a><a class="anchor" name="4.4-set-var-fmt"></a><a class="anchor" name="set-var-fmt (Proxies)"></a><a class="anchor" name="set-var-fmt (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="set-var-fmt"></a><a href="#4.4-set-var-fmt">set-var-fmt</a></b>(<span style="color: #080">&lt;var-name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;cond&gt;</span>...]</span>) <span style="color: #080">&lt;fmt&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This is used to set the contents of a variable. The variable is declared
inline.
</pre><div class="separator">
<span class="label label-info">Arguments:</span><pre class="prettyprint arguments">&lt;var-name&gt;   The name of the variable. Variable of the parent stream cannot
             be set. See <a href="#2.8">section 2.8</a> about variables for details.

 &lt;cond&gt;      A set of conditions that must all be true for the variable to
             actually be set (such as &quot;ifnotempty&quot;, &quot;ifgt&quot; ...). See the
             set-var converter's description for a full list of possible
             conditions.

 &lt;expr&gt;      Is a standard HAProxy expression formed by a sample-fetch
             followed by some converters.

 &lt;fmt&gt;       This is the value expressed using Custom log format rules (see
             Custom log format in <a href="#8.2.6">section 8.2.6</a>).</pre>
</div>
<pre class="text">All scopes are usable for HTTP rules, but scopes &quot;<a href="#proc">proc</a>&quot; and &quot;sess&quot; are the
only usable ones in rule sets which do not have access to contents such as
&quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; and &quot;<a href="#tcp-request%20session">tcp-request session</a>&quot;.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request set-var(req.my_var) req.fhdr(user-agent),lower
http-request set-var-fmt(txn.from) %[src]:%[src_port]
</code></pre>
</div><a class="anchor" name="silent-drop"></a><a class="anchor" name="4-silent-drop"></a><a class="anchor" name="4.4-silent-drop"></a><a class="anchor" name="silent-drop (Proxies)"></a><a class="anchor" name="silent-drop (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="silent-drop"></a><a href="#4.4-silent-drop">silent-drop</a></b> <span style="color: #008">[ rst-ttl <span style="color: #080">&lt;ttl&gt;</span> ]</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This stops the evaluation of the rules and makes the client-facing connection
suddenly disappear using a system-dependent way that tries to prevent the
client from being notified. When called without the rst-ttl argument,
we try to prevent sending any FIN or RST packet back to the client by
using TCP_REPAIR. If this fails (mainly because of missing privileges),
we fall back to sending a RST packet with a TTL of 1.

The effect is that the client still sees an established connection while
there is none on HAProxy, saving resources. However, stateful equipment
placed between the HAProxy and the client (firewalls, proxies,
load balancers) will also keep the established connection in their
session tables.

The optional rst-ttl changes this behaviour: TCP_REPAIR is not used, and an
RST packet with a configurable TTL is sent. When set to a reasonable value,
the RST packet travels through the local infrastructure, deleting the
connection in firewalls and other systems, but disappears before reaching
the client. Future packets from the client will then be dropped already by
front equipment. These local RSTs protect local resources, but not the
client's. This must not be used unless the consequences of doing this are
fully understood.
</pre><a class="anchor" name="strict-mode"></a><a class="anchor" name="4-strict-mode"></a><a class="anchor" name="4.4-strict-mode"></a><a class="anchor" name="strict-mode (Proxies)"></a><a class="anchor" name="strict-mode (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="strict-mode"></a><a href="#4.4-strict-mode">strict-mode</a></b> <span style="color: #800">{ on | off }</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This enables or disables the strict rewriting mode for following rules. It
does not affect rules declared before it and it is only applicable on rules
performing a rewrite on the requests. When the strict mode is enabled, any
rewrite failure triggers an internal error. Otherwise, such errors are
silently ignored. The purpose of the strict rewriting mode is to make some
rewrites optional while others must be performed to continue the request
processing.

By default, the strict rewriting mode is enabled. Its value is also reset
when a ruleset evaluation ends. So, for instance, if you change the mode on
the frontend, the default mode is restored when HAProxy starts the backend
rules evaluation.
</pre><a class="anchor" name="switch-mode"></a><a class="anchor" name="4-switch-mode"></a><a class="anchor" name="4.4-switch-mode"></a><a class="anchor" name="switch-mode (Proxies)"></a><a class="anchor" name="switch-mode (Alphabetically sorted actions reference)"></a><a class="anchor" name="switch-mode http"></a><a class="anchor" name="4-switch-mode http"></a><a class="anchor" name="4.4-switch-mode http"></a><a class="anchor" name="switch-mode http (Proxies)"></a><a class="anchor" name="switch-mode http (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="switch-mode http"></a><a href="#4.4-switch-mode%20http">switch-mode http</a></b> <span style="color: #008">[ proto <span style="color: #080">&lt;name&gt;</span> ]</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This action is used to perform a connection upgrade. Only HTTP upgrades are
supported for now. The protocol may optionally be specified. This action is
only available for a proxy with the frontend capability. The connection
upgrade is immediately performed, following &quot;<a href="#tcp-request%20content">tcp-request content</a>&quot; rules are
not evaluated. This upgrade method should be preferred to the implicit one
consisting to rely on the backend mode. When used, it is possible to set HTTP
directives in a frontend without any warning. These directives will be
conditionally evaluated if the HTTP upgrade is performed. However, an HTTP
backend must still be selected. It remains unsupported to route an HTTP
connection (upgraded or not) to a TCP server.

See <a href="#4">section 4</a> about Proxies for more details on HTTP upgrades.
</pre><a class="anchor" name="tarpit"></a><a class="anchor" name="4-tarpit"></a><a class="anchor" name="4.4-tarpit"></a><a class="anchor" name="tarpit (Proxies)"></a><a class="anchor" name="tarpit (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="tarpit"></a><a href="#4.4-tarpit">tarpit</a></b> <span style="color: #008">[ <span style="color: #800">{ status | deny_status }</span> <span style="color: #080">&lt;code&gt;</span>]</span> <span style="color: #008">[content-type <span style="color: #080">&lt;type&gt;</span>]</span>
       <span style="color: #008">[ <span style="color: #800">{ default-errorfiles | errorfile <span style="color: #080">&lt;file&gt;</span> | errorfiles <span style="color: #080">&lt;name&gt;</span> |
           file <span style="color: #080">&lt;file&gt;</span> | lf-file <span style="color: #080">&lt;file&gt;</span> | string <span style="color: #080">&lt;str&gt;</span> | lf-string <span style="color: #080">&lt;fmt&gt;</span> }</span> ]</span>
       <span style="color: #008">[ hdr <span style="color: #080">&lt;name&gt;</span> <span style="color: #080">&lt;fmt&gt;</span> ]</span>*</div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This stops the evaluation of the rules and immediately blocks the request
without responding for a delay specified by &quot;<a href="#timeout%20tarpit">timeout tarpit</a>&quot; or
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout connect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20connect%20%28Rings%29">Rings</a></li><li><a href="#timeout%20connect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; if the former is not set. After that delay, if the client
is still connected, a response is returned so that the client does not
suspect it has been tarpitted. Logs will report the flags &quot;PT&quot;. The goal of
the tarpit rule is to slow down robots during an attack when they're limited
on the number of concurrent requests. It can be very efficient against very
dumb robots, and will significantly reduce the load on firewalls compared to
a &quot;<a href="#deny">deny</a>&quot; rule. But when facing &quot;correctly&quot; developed robots, it can make
things worse by forcing HAProxy and the front firewall to support insane
number of concurrent connections. By default an HTTP error 500 is returned.
But the response may be customized using same syntax than
&quot;http-request return&quot; rules. Thus, see &quot;http-request return&quot; for details.

For compatibility purpose, when no argument is defined, or only &quot;deny_status&quot;,
the argument &quot;default-errorfiles&quot; is implied. It means
&quot;http-request tarpit [deny_status &lt;status&gt;]&quot; is an alias of
&quot;http-request tarpit [status &lt;status&gt;] default-errorfiles&quot;.
No further &quot;<a href="#http-request">http-request</a>&quot; rules are evaluated.
See also &quot;http-request return&quot; and &quot;http-request silent-drop&quot;.
</pre><a class="anchor" name="track-sc0"></a><a class="anchor" name="4-track-sc0"></a><a class="anchor" name="4.4-track-sc0"></a><a class="anchor" name="track-sc0 (Proxies)"></a><a class="anchor" name="track-sc0 (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="track-sc0"></a><a href="#4.4-track-sc0">track-sc0</a></b> <span style="color: #080">&lt;key&gt;</span> <span style="color: #008">[table <span style="color: #080">&lt;table&gt;</span>]</span></div><a class="anchor" name="track-sc1"></a><a class="anchor" name="4-track-sc1"></a><a class="anchor" name="4.4-track-sc1"></a><a class="anchor" name="track-sc1 (Proxies)"></a><a class="anchor" name="track-sc1 (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="track-sc1"></a><a href="#4.4-track-sc1">track-sc1</a></b> <span style="color: #080">&lt;key&gt;</span> <span style="color: #008">[table <span style="color: #080">&lt;table&gt;</span>]</span></div><a class="anchor" name="track-sc2"></a><a class="anchor" name="4-track-sc2"></a><a class="anchor" name="4.4-track-sc2"></a><a class="anchor" name="track-sc2 (Proxies)"></a><a class="anchor" name="track-sc2 (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="track-sc2"></a><a href="#4.4-track-sc2">track-sc2</a></b> <span style="color: #080">&lt;key&gt;</span> <span style="color: #008">[table <span style="color: #080">&lt;table&gt;</span>]</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This enables tracking of sticky counters from current request. These rules do
not stop evaluation and do not change default action. The number of counters
that may be simultaneously tracked by the same connection is set by the
global &quot;<a href="#tune.stick-counters">tune.stick-counters</a>&quot; setting, which defaults to MAX_SESS_STKCTR if
set at build time (it is reported in haproxy -vv) and which defaults to 3,
so the track-sc number is between 0 and (tune.stick-counters-1). The first
&quot;<a href="#track-sc0">track-sc0</a>&quot; rule executed enables tracking of the counters of the specified
table as the first set. The first &quot;<a href="#track-sc1">track-sc1</a>&quot; rule executed enables tracking
of the counters of the specified table as the second set. The first
&quot;<a href="#track-sc2">track-sc2</a>&quot; rule executed enables tracking of the counters of the specified
table as the third set. It is a recommended practice to use the first set of
counters for the per-frontend counters and the second set for the per-backend
ones. But this is just a guideline, all may be used everywhere.
</pre><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;key&gt;   is mandatory, and is a sample expression rule as described in
        <a href="#7.3">section 7.3</a>. It describes what elements of the incoming connection,
        request or response will be analyzed, extracted, combined, and used
        to select which table entry to update the counters.

&lt;table&gt; is an optional table to be used instead of the default one, which
        is the stick-table declared in the current proxy. All the counters
        for the matches and updates for the key will then be performed in
        that table until the session ends.</pre>
</div>
<pre class="text">Once a &quot;track-sc*&quot; rule is executed, the key is looked up in the table and if
it is not found, an entry is allocated for it. Then a pointer to that entry
is kept during all the session's life, and this entry's counters are updated
as often as possible, every time the session's counters are updated, and also
systematically when the session ends. Counters are only updated for events
that happen after the tracking has been started. As an exception, connection
counters and request counters are systematically updated so that they reflect
useful information.

If the entry tracks concurrent connection counters, one connection is counted
for as long as the entry is tracked, and the entry will not expire during
that time. Tracking counters also provides a performance advantage over just
checking the keys, because only one table lookup is performed for all ACL
checks that make use of it.
</pre><a class="anchor" name="unset-var"></a><a class="anchor" name="4-unset-var"></a><a class="anchor" name="4.4-unset-var"></a><a class="anchor" name="unset-var (Proxies)"></a><a class="anchor" name="unset-var (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="unset-var"></a><a href="#4.4-unset-var">unset-var</a></b>(<span style="color: #080">&lt;var-name&gt;</span>)</div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td></tr>
</table></div>
<pre class="text">This is used to unset a variable. See the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">set-var<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#set-var%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#set-var%20%28Alphabetically%20sorted%20actions%20reference%29">Alphabetically sorted actions reference</a></li><li><a href="#set-var%20%28Converters%29">Converters</a></li></ul></span>&quot; action for details about
&lt;var-name&gt;.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request unset-var(req.my_var)
</code></pre>
</div><a class="anchor" name="use-service"></a><a class="anchor" name="4-use-service"></a><a class="anchor" name="4.4-use-service"></a><a class="anchor" name="use-service (Proxies)"></a><a class="anchor" name="use-service (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="use-service"></a><a href="#4.4-use-service">use-service</a></b> <span style="color: #080">&lt;service-name&gt;</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This action executes the configured TCP or HTTP service to reply to the
request, depending on the rule set it's used in. The rule is final, i.e.
no further rules are evaluated in the same rule set.

A service may choose to reply by sending any valid response or it may
immediately close the connection without sending any response. For HTTP
services, a valid response requires a valid HTTP response. Outside natives
services, for instance the Prometheus exporter for HTTP services, it is
possible to write custom TCP and HTTP services in Lua.
</pre><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;service-name&gt;  is mandatory. It is the service to call</pre>
</div>
<div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request use-service prometheus-exporter if { path /metrics }
</code></pre>
</div><a class="anchor" name="wait-for-body"></a><a class="anchor" name="4-wait-for-body"></a><a class="anchor" name="4.4-wait-for-body"></a><a class="anchor" name="wait-for-body (Proxies)"></a><a class="anchor" name="wait-for-body (Alphabetically sorted actions reference)"></a><a class="anchor" name="wait-for-body time"></a><a class="anchor" name="4-wait-for-body time"></a><a class="anchor" name="4.4-wait-for-body time"></a><a class="anchor" name="wait-for-body time (Proxies)"></a><a class="anchor" name="wait-for-body time (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="wait-for-body time"></a><a href="#4.4-wait-for-body%20time">wait-for-body time</a></b> <span style="color: #080">&lt;time&gt;</span> <span style="color: #008">[ at-least <span style="color: #080">&lt;bytes&gt;</span> ]</span></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This will delay the processing of the request or response until one of the
following conditions occurs:
- The full request body is received, in which case processing proceeds
  normally.
- &lt;bytes&gt; bytes have been received, when the &quot;at-least&quot; argument is given and
  &lt;bytes&gt; is non-zero, in which case processing proceeds normally.
- The request buffer is full, in which case processing proceeds normally. The
  size of this buffer is determined by the &quot;<a href="#tune.bufsize">tune.bufsize</a>&quot; option.
- The request has been waiting for more than &lt;time&gt; milliseconds. In this
  case HAProxy will respond with a 408 &quot;Request Timeout&quot; error to the client
  and stop processing the request. Note that if any of the other conditions
  happens first, this timeout will not occur even if the full body has
  not yet been received.

This action may be used as a replacement for &quot;<a href="#option%20http-buffer-request">option http-buffer-request</a>&quot;.
</pre><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;time&gt;    is mandatory. It is the maximum time to wait for the body. It
          follows the HAProxy time format and is expressed in milliseconds.

&lt;bytes&gt;   is optional. It is the minimum payload size to receive to stop to
          wait. It follows the HAProxy size format and is expressed in
          bytes. A value of 0 (the default) means no limit.</pre>
</div>
<div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request wait-for-body time 1s at-least 1k if METH_POST
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;<a href="#option%20http-buffer-request">option http-buffer-request</a>&quot;</div>
<a class="anchor" name="wait-for-handshake"></a><a class="anchor" name="4-wait-for-handshake"></a><a class="anchor" name="4.4-wait-for-handshake"></a><a class="anchor" name="wait-for-handshake (Proxies)"></a><a class="anchor" name="wait-for-handshake (Alphabetically sorted actions reference)"></a><div class="keyword"><b><a class="anchor" name="wait-for-handshake"></a><a href="#4.4-wait-for-handshake">wait-for-handshake</a></b></div><div><p>  Usable in :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>QUIC Ini</th><th>TCP RqCon</th><th>RqSes</th><th>RqCnt</th><th>RsCnt</th><th>HTTP Req</th><th>Res</th><th>Aft</th></tr></thead>
<tr><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered"><img src="../css/check.png" alt="X" title="yes" /></td><td class="pagination-centered">&nbsp;</td><td class="pagination-centered">&nbsp;</td></tr>
</table></div>
<pre class="text">This will delay the processing of the request until the SSL handshake
happened. This is mostly useful to delay processing early data until we're
sure they are valid.
</pre></div>
<a class="anchor" id="5" name="5"></a>
<div class="page-header"><h1 id="chapter-5" data-target="5"><small><a class="small" href="#5">5.</a></small> Bind and server options</h1>
</div><div><pre class="text">The &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keywords support a number of settings
depending on some build options and on the system HAProxy was built on. These
settings generally each consist in one word sometimes followed by a value,
written on the same line as the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; or &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line. All these options are
described in this section.
</pre></div>
<a class="anchor" id="5.1" name="5.1"></a>
<h2 id="chapter-5.1" data-target="5.1"><small><a class="small" href="#5.1">5.1.</a></small> Bind options</h2>
<div><pre class="text">The &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword supports a certain number of settings which are all passed
as arguments on the same line. The order in which those arguments appear makes
no importance, provided that they appear after the bind address. All of these
parameters are optional. Some of them consist in a single words (booleans),
while other ones expect a value after them. In this case, the value must be
provided immediately after the setting name.

The currently supported settings are the following ones.
</pre><a class="anchor" name="accept-netscaler-cip"></a><a class="anchor" name="5-accept-netscaler-cip"></a><a class="anchor" name="5.1-accept-netscaler-cip"></a><a class="anchor" name="accept-netscaler-cip (Bind and server options)"></a><a class="anchor" name="accept-netscaler-cip (Bind options)"></a><div class="keyword"><b><a class="anchor" name="accept-netscaler-cip"></a><a href="#5.1-accept-netscaler-cip">accept-netscaler-cip</a></b> <span style="color: #080">&lt;magic number&gt;</span></div><pre class="text">Enforces the use of the NetScaler Client IP insertion protocol over any
connection accepted by any of the TCP sockets declared on the same line. The
NetScaler Client IP insertion protocol dictates the layer 3/4 addresses of
the incoming connection to be used everywhere an address is used, with the
only exception of &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; rules which will only see the
real connection address. Logs will reflect the addresses indicated in the
protocol, unless it is violated, in which case the real  address will still
be used. This keyword combined with support from external components can be
used as an efficient and reliable alternative to the X-Forwarded-For
mechanism which is not always reliable and not even always usable. See also
&quot;tcp-request connection expect-netscaler-cip&quot; for a finer-grained setting of
which client is allowed to use the protocol.
</pre><a class="anchor" name="accept-proxy"></a><a class="anchor" name="5-accept-proxy"></a><a class="anchor" name="5.1-accept-proxy"></a><a class="anchor" name="accept-proxy (Bind and server options)"></a><a class="anchor" name="accept-proxy (Bind options)"></a><div class="keyword"><b><a class="anchor" name="accept-proxy"></a><a href="#5.1-accept-proxy">accept-proxy</a></b></div><pre class="text">Enforces the use of the PROXY protocol over any connection accepted by any of
the sockets declared on the same line. Versions 1 and 2 of the PROXY protocol
are supported and correctly detected. The PROXY protocol dictates the layer
3/4 addresses of the incoming connection to be used everywhere an address is
used, with the only exception of &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; rules which will
only see the real connection address. Logs will reflect the addresses
indicated in the protocol, unless it is violated, in which case the real
address will still be used. This keyword combined with support from external
components can be used as an efficient and reliable alternative to the
X-Forwarded-For mechanism which is not always reliable and not even always
usable. See also &quot;tcp-request connection expect-proxy&quot; for a finer-grained
setting of which client is allowed to use the protocol.
</pre><a class="anchor" name="allow-0rtt"></a><a class="anchor" name="5-allow-0rtt"></a><a class="anchor" name="5.1-allow-0rtt"></a><a class="anchor" name="allow-0rtt (Bind and server options)"></a><a class="anchor" name="allow-0rtt (Bind options)"></a><div class="keyword"><b><a class="anchor" name="allow-0rtt"></a><a href="#5.1-allow-0rtt">allow-0rtt</a></b></div><pre class="text">Allow receiving early data when using TLSv1.3. This is disabled by default,
due to security considerations. Because it is vulnerable to replay attacks,
you should only allow if for requests that are safe to replay, i.e. requests
that are idempotent. You can use the &quot;<a href="#wait-for-handshake">wait-for-handshake</a>&quot; action for any
request that wouldn't be safe with early data.
</pre><a class="anchor" name="alpn"></a><a class="anchor" name="5-alpn"></a><a class="anchor" name="5.1-alpn"></a><a class="anchor" name="alpn (Bind and server options)"></a><a class="anchor" name="alpn (Bind options)"></a><div class="keyword"><b><a class="anchor" name="alpn"></a><a href="#5.1-alpn">alpn</a></b> <span style="color: #080">&lt;protocols&gt;</span></div><pre class="text">This enables the TLS ALPN extension and advertises the specified protocol
list as supported on top of ALPN. The protocol list consists in a comma-
delimited list of protocol names, for instance: &quot;http/1.1,http/1.0&quot; (without
quotes). This requires that the SSL library is built with support for TLS
extensions enabled (check with haproxy -vv). The ALPN extension replaces the
initial NPN extension. At the protocol layer, ALPN is required to enable
HTTP/2 on an HTTPS frontend and HTTP/3 on a QUIC frontend. However, when such
frontends have none of &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">npn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#npn%20%28Bind%20options%29">Bind options</a></li><li><a href="#npn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">alpn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#alpn%20%28Bind%20options%29">Bind options</a></li><li><a href="#alpn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and &quot;<a href="#no-alpn">no-alpn</a>&quot; set, a default value of
&quot;h2,http/1.1&quot; will be used for a regular HTTPS frontend, and &quot;h3&quot; for a QUIC
frontend. Versions of OpenSSL prior to 1.0.2 didn't support ALPN and only
supposed the now obsolete NPN extension. At the time of writing this, most
browsers still support both ALPN and NPN for HTTP/2 so a fallback to NPN may
still work for a while. But ALPN must be used whenever possible. Protocols
not advertised are not negotiated. For example it is possible to only accept
HTTP/2 connections with this:

     bind :443 ssl crt pub.pem alpn h2  # explicitly disable HTTP/1.1

QUIC supports only h3 and hq-interop as ALPN. h3 is for HTTP/3 and hq-interop
is used for http/0.9 and QUIC interop runner (see https://interop.seemann.io).
Each &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">alpn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#alpn%20%28Bind%20options%29">Bind options</a></li><li><a href="#alpn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; statement will replace a previous one. In order to remove them,
use &quot;<a href="#no-alpn">no-alpn</a>&quot;.

Note that some old browsers such as Firefox 88 used to experience issues with
WebSocket over H2, and in case such a setup is encountered, it may be needed
to either explicitly disable HTTP/2 in the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">alpn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#alpn%20%28Bind%20options%29">Bind options</a></li><li><a href="#alpn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; string by forcing it to
&quot;http/1.1&quot; or &quot;<a href="#no-alpn">no-alpn</a>&quot;, or to enable &quot;<a href="#h2-workaround-bogus-websocket-clients">h2-workaround-bogus-websocket-clients</a>&quot;
globally.
</pre><a class="anchor" name="backlog"></a><a class="anchor" name="5-backlog"></a><a class="anchor" name="5.1-backlog"></a><a class="anchor" name="backlog (Bind and server options)"></a><a class="anchor" name="backlog (Bind options)"></a><div class="keyword"><b><a class="anchor" name="backlog"></a><a href="#5.1-backlog">backlog</a></b> <span style="color: #080">&lt;backlog&gt;</span></div><pre class="text">Sets the socket's backlog to this value. If unspecified or 0, the frontend's
backlog is used instead, which generally defaults to the maxconn value.
</pre><a class="anchor" name="ca-file"></a><a class="anchor" name="5-ca-file"></a><a class="anchor" name="5.1-ca-file"></a><a class="anchor" name="ca-file (Bind and server options)"></a><a class="anchor" name="ca-file (Bind options)"></a><div class="keyword"><b><a class="anchor" name="ca-file"></a><a href="#5.1-ca-file">ca-file</a></b> <span style="color: #080">&lt;cafile&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It
designates a PEM file from which to load CA certificates used to verify
client's certificate. It is possible to load a directory containing multiple
CAs, in this case HAProxy will try to load every &quot;.pem&quot;, &quot;.crt&quot;, &quot;.cer&quot;, and
.crl&quot; available in the directory, files starting with a dot are ignored.

Warning: The &quot;@system-ca&quot; parameter could be used in place of the cafile
in order to use the trusted CAs of your system, like its done with the server
directive. But you mustn't use it unless you know what you are doing.
Configuring it this way basically mean that the bind will accept any client
certificate generated from one of the CA present on your system, which is
extremely insecure.
</pre><a class="anchor" name="ca-ignore-err"></a><a class="anchor" name="5-ca-ignore-err"></a><a class="anchor" name="5.1-ca-ignore-err"></a><a class="anchor" name="ca-ignore-err (Bind and server options)"></a><a class="anchor" name="ca-ignore-err (Bind options)"></a><div class="keyword"><b><a class="anchor" name="ca-ignore-err"></a><a href="#5.1-ca-ignore-err">ca-ignore-err</a></b> <span style="color: #008">[all|<span style="color: #080">&lt;errorID&gt;</span>,...]</span></div><pre class="text">This setting is only available when support for OpenSSL was built in.
Sets a comma separated list of errorIDs to ignore during verify at depth &gt; 0.
It could be a numerical ID, or the constant name (X509_V_ERR) which is
available in the OpenSSL documentation:
https://www.openssl.org/docs/manmaster/man3/X509_STORE_CTX_get_error.html#ERROR-CODES
It is recommended to use the constant name as the numerical value can change
in new version of OpenSSL.
If set to 'all', all errors are ignored. SSL handshake is not aborted if an
error is ignored.
</pre><a class="anchor" name="ca-sign-file"></a><a class="anchor" name="5-ca-sign-file"></a><a class="anchor" name="5.1-ca-sign-file"></a><a class="anchor" name="ca-sign-file (Bind and server options)"></a><a class="anchor" name="ca-sign-file (Bind options)"></a><div class="keyword"><b><a class="anchor" name="ca-sign-file"></a><a href="#5.1-ca-sign-file">ca-sign-file</a></b> <span style="color: #080">&lt;cafile&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It
designates a PEM file containing both the CA certificate and the CA private
key used to create and sign server's certificates. This is a mandatory
setting when the dynamic generation of certificates is enabled. See
'generate-certificates' for details.
</pre><a class="anchor" name="ca-sign-pass"></a><a class="anchor" name="5-ca-sign-pass"></a><a class="anchor" name="5.1-ca-sign-pass"></a><a class="anchor" name="ca-sign-pass (Bind and server options)"></a><a class="anchor" name="ca-sign-pass (Bind options)"></a><div class="keyword"><b><a class="anchor" name="ca-sign-pass"></a><a href="#5.1-ca-sign-pass">ca-sign-pass</a></b> <span style="color: #080">&lt;passphrase&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It is
the CA private key passphrase. This setting is optional and used only when
the dynamic generation of certificates is enabled. See
'generate-certificates' for details.
</pre><a class="anchor" name="ca-verify-file"></a><a class="anchor" name="5-ca-verify-file"></a><a class="anchor" name="5.1-ca-verify-file"></a><a class="anchor" name="ca-verify-file (Bind and server options)"></a><a class="anchor" name="ca-verify-file (Bind options)"></a><div class="keyword"><b><a class="anchor" name="ca-verify-file"></a><a href="#5.1-ca-verify-file">ca-verify-file</a></b> <span style="color: #080">&lt;cafile&gt;</span></div><pre class="text">This setting designates a PEM file from which to load CA certificates used to
verify client's certificate. It designates CA certificates which must not be
included in CA names sent in server hello message. Typically, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ca-file<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ca-file%20%28Bind%20options%29">Bind options</a></li><li><a href="#ca-file%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; must
be defined with intermediate certificates, and &quot;<a href="#ca-verify-file">ca-verify-file</a>&quot; with
certificates to ending the chain, like root CA.
</pre><a class="anchor" name="ciphers"></a><a class="anchor" name="5-ciphers"></a><a class="anchor" name="5.1-ciphers"></a><a class="anchor" name="ciphers (Bind and server options)"></a><a class="anchor" name="ciphers (Bind options)"></a><div class="keyword"><b><a class="anchor" name="ciphers"></a><a href="#5.1-ciphers">ciphers</a></b> <span style="color: #080">&lt;ciphers&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It sets
the string describing the list of cipher algorithms (&quot;cipher suite&quot;) that are
negotiated during the SSL/TLS handshake up to TLSv1.2. The format of the
string is defined in &quot;man 1 ciphers&quot; from OpenSSL man pages. For background
information and recommendations see e.g.
(https://wiki.mozilla.org/Security/Server_Side_TLS) and
(https://mozilla.github.io/server-side-tls/ssl-config-generator/). For TLSv1.3
cipher configuration, please check the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ciphersuites<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ciphersuites%20%28Bind%20options%29">Bind options</a></li><li><a href="#ciphersuites%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword.
</pre><a class="anchor" name="ciphersuites"></a><a class="anchor" name="5-ciphersuites"></a><a class="anchor" name="5.1-ciphersuites"></a><a class="anchor" name="ciphersuites (Bind and server options)"></a><a class="anchor" name="ciphersuites (Bind options)"></a><div class="keyword"><b><a class="anchor" name="ciphersuites"></a><a href="#5.1-ciphersuites">ciphersuites</a></b> <span style="color: #080">&lt;ciphersuites&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in and
OpenSSL 1.1.1 or later was used to build HAProxy. It sets the string describing
the list of cipher algorithms (&quot;cipher suite&quot;) that are negotiated during the
TLSv1.3 handshake. The format of the string is defined in &quot;man 1 ciphers&quot; from
OpenSSL man pages under the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ciphersuites<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ciphersuites%20%28Bind%20options%29">Bind options</a></li><li><a href="#ciphersuites%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; section. For cipher configuration
for TLSv1.2 and earlier, please check the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ciphers<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ciphers%20%28Bind%20options%29">Bind options</a></li><li><a href="#ciphers%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword.
This setting might accept TLSv1.2 ciphersuites however this is an
undocumented behavior and not recommended as it could be inconsistent or buggy.
The default TLSv1.3 ciphersuites of OpenSSL are:
&quot;TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256&quot;

TLSv1.3 only supports 5 ciphersuites:

- TLS_AES_128_GCM_SHA256
- TLS_AES_256_GCM_SHA384
- TLS_CHACHA20_POLY1305_SHA256
- TLS_AES_128_CCM_SHA256
- TLS_AES_128_CCM_8_SHA256
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>ciphers ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-RSA-AES128-GCM-SHA256
ciphersuites TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256
</code></pre>
</div><a class="anchor" name="client-sigalgs"></a><a class="anchor" name="5-client-sigalgs"></a><a class="anchor" name="5.1-client-sigalgs"></a><a class="anchor" name="client-sigalgs (Bind and server options)"></a><a class="anchor" name="client-sigalgs (Bind options)"></a><div class="keyword"><b><a class="anchor" name="client-sigalgs"></a><a href="#5.1-client-sigalgs">client-sigalgs</a></b> <span style="color: #080">&lt;sigalgs&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It sets
the string describing the list of signature algorithms related to client
authentication that are negotiated . The format of the string is defined in
&quot;man 3 SSL_CTX_set1_client_sigalgs&quot; from the OpenSSL man pages. It is not
recommended to use this setting if no specific usecase was identified.
</pre><a class="anchor" name="crl-file"></a><a class="anchor" name="5-crl-file"></a><a class="anchor" name="5.1-crl-file"></a><a class="anchor" name="crl-file (Bind and server options)"></a><a class="anchor" name="crl-file (Bind options)"></a><div class="keyword"><b><a class="anchor" name="crl-file"></a><a href="#5.1-crl-file">crl-file</a></b> <span style="color: #080">&lt;crlfile&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It
designates a PEM file from which to load certificate revocation list used
to verify client's certificate. You need to provide a certificate revocation
list for every certificate of your certificate authority chain.
</pre><a class="anchor" name="crt"></a><a class="anchor" name="5-crt"></a><a class="anchor" name="5.1-crt"></a><a class="anchor" name="crt (Bind and server options)"></a><a class="anchor" name="crt (Bind options)"></a><div class="keyword"><b><a class="anchor" name="crt"></a><a href="#5.1-crt">crt</a></b> <span style="color: #080">&lt;cert&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in.

HAProxy uses a cache system, the files are loaded only once in the certificate
storage, and each next &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crt<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crt%20%28Load%20options%29">Load options</a></li><li><a href="#crt%20%28Bind%20options%29">Bind options</a></li><li><a href="#crt%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword will use this cached version. When the
certificate was declared in a &quot;crt-store&quot;, the certificate storage is
populated from there and don't try to load additional files by detecting file
extensions.

It designates a PEM file containing both the required certificates and any
associated private keys. This file can be built by concatenating multiple
PEM files into one (e.g. cat cert.pem key.pem &gt; combined.pem). If your CA
requires an intermediate certificate, this can also be concatenated into this
file. Intermediate certificate can also be shared in a directory via
&quot;<a href="#issuers-chain-path">issuers-chain-path</a>&quot; directive.

If the file does not contain a private key, HAProxy will try to load
the key at the same path suffixed by a &quot;.key&quot;.

If the OpenSSL used supports Diffie-Hellman, parameters present in this file
are loaded.

If a directory name is used instead of a PEM file, then all files found in
that directory will be loaded in alphabetic order unless their name ends
with '.key', '.issuer', '.ocsp' or '.sctl' (reserved extensions). Files
starting with a dot are also ignored. This directive may be specified multiple
times in order to load certificates from multiple files or directories. The
certificates will be presented to clients who provide a valid TLS Server Name
Indication field matching one of their CN or alt subjects. Wildcards are
supported, where a wildcard character '*' is used instead of the first
hostname component (e.g. *.example.org matches www.example.org but not
www.sub.example.org). If an empty directory is used, HAProxy will not start
unless the &quot;<a href="#strict-sni">strict-sni</a>&quot; keyword is used.

If no SNI is provided by the client or if the SSL library does not support
TLS extensions, or if the client provides an SNI hostname which does not
match any certificate, then the first loaded certificate will be presented.
This means that when loading certificates from a directory, it is highly
recommended to load the default one first as a file or to ensure that it will
always be the first one in the directory. In order to chose multiple default
certificates (1 rsa and 1 ecdsa), there are 3 options:
- A multi-cert bundle can be configured as the first certificate
  (`crt foobar.pem` in the configuration where the existing files
  are `foobar.pem.ecdsa` and `foobar.pem.rsa`.
- Or a '*' filter for each certificate in a crt-list line.
- The 'default-crt' keyword can be used.

Note that the same cert may be loaded multiple times without side effects.

Some CAs (such as GoDaddy) offer a drop down list of server types that do not
include HAProxy when obtaining a certificate. If this happens be sure to
choose a web server that the CA believes requires an intermediate CA (for
GoDaddy, selection Apache Tomcat will get the correct bundle, but many
others, e.g. nginx, result in a wrong bundle that will not work for some
clients).

For each PEM file, HAProxy checks for the presence of file at the same path
suffixed by &quot;.ocsp&quot;. If such file is found, support for the TLS Certificate
Status Request extension (also known as &quot;OCSP stapling&quot;) is automatically
enabled. The content of this file is optional. If not empty, it must contain
a valid OCSP Response in DER format. In order to be valid an OCSP Response
must comply with the following rules: it has to indicate a good status,
it has to be a single response for the certificate of the PEM file, and it
has to be valid at the moment of addition. If these rules are not respected
the OCSP Response is ignored and a warning is emitted. In order to  identify
which certificate an OCSP Response applies to, the issuer's certificate is
necessary. If the issuer's certificate is not found in the PEM file, it will
be loaded from a file at the same path as the PEM file suffixed by &quot;.issuer&quot;
if it exists otherwise it will fail with an error.

For each PEM file, HAProxy also checks for the presence of file at the same
path suffixed by &quot;.sctl&quot;. If such file is found, support for Certificate
Transparency (RFC6962) TLS extension is enabled. The file must contain a
valid Signed Certificate Timestamp List, as described in RFC. File is parsed
to check basic syntax, but no signatures are verified.

There are cases where it is desirable to support multiple key types, e.g. RSA
and ECDSA in the cipher suites offered to the clients. This allows clients
that support EC certificates to be able to use EC ciphers, while
simultaneously supporting older, RSA only clients.

To achieve this, OpenSSL 1.1.1 is required, you can configure this behavior
by providing one crt entry per certificate type, or by configuring a &quot;cert
bundle&quot; like it was required before HAProxy 1.8. See &quot;<a href="#ssl-load-extra-files">ssl-load-extra-files</a>&quot;.
</pre><a class="anchor" name="crt-ignore-err"></a><a class="anchor" name="5-crt-ignore-err"></a><a class="anchor" name="5.1-crt-ignore-err"></a><a class="anchor" name="crt-ignore-err (Bind and server options)"></a><a class="anchor" name="crt-ignore-err (Bind options)"></a><div class="keyword"><b><a class="anchor" name="crt-ignore-err"></a><a href="#5.1-crt-ignore-err">crt-ignore-err</a></b> <span style="color: #080">&lt;errors&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. Sets a
comma separated list of errorIDs to ignore during verify at depth == 0.
It could be a numerical ID, or the constant name (X509_V_ERR) which is
available in the OpenSSL documentation:
https://www.openssl.org/docs/manmaster/man3/X509_STORE_CTX_get_error.html#ERROR-CODES
It is recommended to use the constant name as the numerical value can change
in new version of OpenSSL.
If set to 'all', all errors are ignored. SSL handshake is not aborted if an
error is ignored.
</pre><a class="anchor" name="crt-list"></a><a class="anchor" name="5-crt-list"></a><a class="anchor" name="5.1-crt-list"></a><a class="anchor" name="crt-list (Bind and server options)"></a><a class="anchor" name="crt-list (Bind options)"></a><div class="keyword"><b><a class="anchor" name="crt-list"></a><a href="#5.1-crt-list">crt-list</a></b> <span style="color: #080">&lt;file&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It
designates a list of PEM file with an optional ssl configuration and a SNI
filter per certificate, with the following format for each line :

      &lt;crtfile&gt; [\[&lt;sslbindconf&gt; ...\]] [[!]&lt;snifilter&gt; ...]

sslbindconf supports the following keywords from the bind line
(see Section 5.1. Bind options):

- <a href="#allow-0rtt">allow-0rtt</a>
- <a href="#alpn">alpn</a>
- <a href="#ca-file">ca-file</a>
- <a href="#ca-verify-file">ca-verify-file</a>
- <a href="#ciphers">ciphers</a>
- <a href="#ciphersuites">ciphersuites</a>
- <a href="#client-sigalgs">client-sigalgs</a>
- <a href="#crl-file">crl-file</a>
- <a href="#curves">curves</a>
- <a href="#ecdhe">ecdhe</a>
- <a href="#no-alpn">no-alpn</a>
- <a href="#no-ca-names">no-ca-names</a>
- <a href="#npn">npn</a>
- <a href="#sigalgs">sigalgs</a>
- <a href="#ssl-min-ver">ssl-min-ver</a>
- <a href="#ssl-max-ver">ssl-max-ver</a>
- <a href="#verify">verify</a>

sslbindconf also supports the following keywords from the crt-store load
keyword (see Section 3.12.1. Load options):

- <a href="#crt">crt</a>
- <a href="#key">key</a>
- <a href="#ocsp">ocsp</a>
- <a href="#issuer">issuer</a>
- <a href="#sctl">sctl</a>
- <a href="#ocsp-update">ocsp-update</a>

It overrides the configuration set in bind line for the certificate.

Wildcards are supported in the SNI filter. Negative filter are also supported,
useful in combination with a wildcard filter to exclude a particular SNI, or
after the first certificate to exclude a pattern from its CN or Subject Alt
Name (SAN). The certificates will be presented to clients who provide a valid
TLS Server Name Indication field matching one of the SNI filters. If no SNI
filter is specified, the CN and SAN are used. This directive may be specified
multiple times. See the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crt<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crt%20%28Load%20options%29">Load options</a></li><li><a href="#crt%20%28Bind%20options%29">Bind options</a></li><li><a href="#crt%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; option for more information. The default
certificate is still needed to meet OpenSSL expectations. If it is not used,
the 'strict-sni' option may be used.

Multi-cert bundling (see &quot;<a href="#ssl-load-extra-files">ssl-load-extra-files</a>&quot;) is supported with crt-list,
as long as only the base name is given in the crt-list. SNI filter will do
the same work on all bundled certificates.

Empty lines as well as lines beginning with a hash ('#') will be ignored.

The first declared certificate of a bind line is used as the default
certificate, either from crt or crt-list option, which HAProxy should use in
the TLS handshake if no other certificate matches. This certificate will also
be used if the provided SNI matches its CN or SAN, even if a matching SNI
filter is found on any crt-list. The SNI filter !* can be used after the first
declared certificate to not include its CN and SAN in the SNI tree, so it will
never match except if no other certificate matches. This way the first
declared certificate act as a fallback. It is also possible to declare a '*'
filter, which will allow to chose this certificate as default. When multiple
default certificates are defined, HAProxy is able to chose the right ECDSA or
RSA one depending on what the client supports.

When no ALPN is set, the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line's default one is used. If a &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line
has no &quot;<a href="#no-alpn">no-alpn</a>&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">alpn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#alpn%20%28Bind%20options%29">Bind options</a></li><li><a href="#alpn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; nor &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">npn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#npn%20%28Bind%20options%29">Bind options</a></li><li><a href="#npn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; set, a default value will be used
depending on the protocol (see &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">alpn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#alpn%20%28Bind%20options%29">Bind options</a></li><li><a href="#alpn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; above). However if the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line has
a different default, or explicitly disables ALPN using &quot;<a href="#no-alpn">no-alpn</a>&quot;, it is
possible to force a specific value for a certificate.

crt-list file example:
      cert1.pem !*
      # comment
      cert2.pem [alpn h2,http/1.1]
      certW.pem                   *.domain.tld !secure.domain.tld
      certS.pem [curves X25519:P-256 ciphers ECDHE-ECDSA-AES256-GCM-SHA384] secure.domain.tld
      default.pem.rsa *
      default.pem.ecdsa *
      foo.crt [key bar.pem ocsp foo.ocsp ocsp-update on] foo.bar.com
</pre><a class="anchor" name="default-crt"></a><a class="anchor" name="5-default-crt"></a><a class="anchor" name="5.1-default-crt"></a><a class="anchor" name="default-crt (Bind and server options)"></a><a class="anchor" name="default-crt (Bind options)"></a><div class="keyword"><b><a class="anchor" name="default-crt"></a><a href="#5.1-default-crt">default-crt</a></b> <span style="color: #080">&lt;cert&gt;</span></div><pre class="text">This option does the same as the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crt<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crt%20%28Load%20options%29">Load options</a></li><li><a href="#crt%20%28Bind%20options%29">Bind options</a></li><li><a href="#crt%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; option, with the difference that this
certificate will be used as a default one. It is possible to add multiple
default certificates to have an ECDSA and an RSA one, having more is not
really useful.

A default certificate is used when no &quot;<a href="#strict-sni">strict-sni</a>&quot; option is used on the bind
line. A default certificate is provided when the servername extension was not
used by the client, or when the servername does not match any configured
certificate.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>bind *:443 default-crt foobar.pem.rsa default-crt foobar.pem.ecdsa crt website.pem.rsa
</code></pre>
</div><pre class="text">See also the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crt<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crt%20%28Load%20options%29">Load options</a></li><li><a href="#crt%20%28Bind%20options%29">Bind options</a></li><li><a href="#crt%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword.
</pre><a class="anchor" name="curves"></a><a class="anchor" name="5-curves"></a><a class="anchor" name="5.1-curves"></a><a class="anchor" name="curves (Bind and server options)"></a><a class="anchor" name="curves (Bind options)"></a><div class="keyword"><b><a class="anchor" name="curves"></a><a href="#5.1-curves">curves</a></b> <span style="color: #080">&lt;curves&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It sets
the string describing the list of elliptic curves algorithms (&quot;curve suite&quot;)
that are negotiated during the SSL/TLS handshake with ECDHE. The format of the
string is a colon-delimited list of curve name.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<div class="example-desc">&quot;X25519:P-256&quot; (without quote)</div><code>When &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">curves<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#curves%20%28Bind%20options%29">Bind options</a></li><li><a href="#curves%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; is set, &quot;<a href="#ecdhe">ecdhe</a>&quot; parameter is ignored.
</code></pre>
</div><a class="anchor" name="defer-accept"></a><a class="anchor" name="5-defer-accept"></a><a class="anchor" name="5.1-defer-accept"></a><a class="anchor" name="defer-accept (Bind and server options)"></a><a class="anchor" name="defer-accept (Bind options)"></a><div class="keyword"><b><a class="anchor" name="defer-accept"></a><a href="#5.1-defer-accept">defer-accept</a></b></div><pre class="text">Is an optional keyword which is supported only on certain Linux kernels. It
states that a connection will only be accepted once some data arrive on it,
or at worst after the first retransmit. This should be used only on protocols
for which the client talks first (e.g. HTTP). It can slightly improve
performance by ensuring that most of the request is already available when
the connection is accepted. On the other hand, it will not be able to detect
connections which don't talk. It is important to note that this option is
broken in all kernels up to 2.6.31, as the connection is never accepted until
the client talks. This can cause issues with front firewalls which would see
an established connection while the proxy will only see it in SYN_RECV. This
option is only supported on TCPv4/TCPv6 sockets and ignored by other ones.
</pre><a class="anchor" name="ecdhe"></a><a class="anchor" name="5-ecdhe"></a><a class="anchor" name="5.1-ecdhe"></a><a class="anchor" name="ecdhe (Bind and server options)"></a><a class="anchor" name="ecdhe (Bind options)"></a><div class="keyword"><b><a class="anchor" name="ecdhe"></a><a href="#5.1-ecdhe">ecdhe</a></b> <span style="color: #080">&lt;named curve&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It sets
the named curve (RFC 4492) used to generate ECDH ephemeral keys. By default,
used named curve is prime256v1.
</pre><a class="anchor" name="expose-fd"></a><a class="anchor" name="5-expose-fd"></a><a class="anchor" name="5.1-expose-fd"></a><a class="anchor" name="expose-fd (Bind and server options)"></a><a class="anchor" name="expose-fd (Bind options)"></a><a class="anchor" name="expose-fd listeners"></a><a class="anchor" name="5-expose-fd listeners"></a><a class="anchor" name="5.1-expose-fd listeners"></a><a class="anchor" name="expose-fd listeners (Bind and server options)"></a><a class="anchor" name="expose-fd listeners (Bind options)"></a><div class="keyword"><b><a class="anchor" name="expose-fd listeners"></a><a href="#5.1-expose-fd%20listeners">expose-fd listeners</a></b></div><pre class="text">This option is only usable with the stats socket. It gives your stats socket
the capability to pass listeners FD to another HAProxy process.
In master-worker mode, this is not required anymore, the listeners will be
passed using the internal socketpairs between the master and the workers.
See also &quot;-x&quot; in the management guide.
</pre><a class="anchor" name="force-sslv3"></a><a class="anchor" name="5-force-sslv3"></a><a class="anchor" name="5.1-force-sslv3"></a><a class="anchor" name="force-sslv3 (Bind and server options)"></a><a class="anchor" name="force-sslv3 (Bind options)"></a><div class="keyword"><b><a class="anchor" name="force-sslv3"></a><a href="#5.1-force-sslv3">force-sslv3</a></b></div><pre class="text">This option enforces use of SSLv3 only on SSL connections instantiated from
this listener. SSLv3 is generally less expensive than the TLS counterparts
for high connection rates. This option is also available on global statement
&quot;<a href="#ssl-default-bind-options">ssl-default-bind-options</a>&quot;. See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-max-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-max-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-max-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;.
</pre><a class="anchor" name="force-tlsv10"></a><a class="anchor" name="5-force-tlsv10"></a><a class="anchor" name="5.1-force-tlsv10"></a><a class="anchor" name="force-tlsv10 (Bind and server options)"></a><a class="anchor" name="force-tlsv10 (Bind options)"></a><div class="keyword"><b><a class="anchor" name="force-tlsv10"></a><a href="#5.1-force-tlsv10">force-tlsv10</a></b></div><pre class="text">This option enforces use of TLSv1.0 only on SSL connections instantiated from
this listener. This option is also available on global statement
&quot;<a href="#ssl-default-bind-options">ssl-default-bind-options</a>&quot;. See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-max-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-max-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-max-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;.
</pre><a class="anchor" name="force-tlsv11"></a><a class="anchor" name="5-force-tlsv11"></a><a class="anchor" name="5.1-force-tlsv11"></a><a class="anchor" name="force-tlsv11 (Bind and server options)"></a><a class="anchor" name="force-tlsv11 (Bind options)"></a><div class="keyword"><b><a class="anchor" name="force-tlsv11"></a><a href="#5.1-force-tlsv11">force-tlsv11</a></b></div><pre class="text">This option enforces use of TLSv1.1 only on SSL connections instantiated from
this listener. This option is also available on global statement
&quot;<a href="#ssl-default-bind-options">ssl-default-bind-options</a>&quot;. See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-max-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-max-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-max-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;.
</pre><a class="anchor" name="force-tlsv12"></a><a class="anchor" name="5-force-tlsv12"></a><a class="anchor" name="5.1-force-tlsv12"></a><a class="anchor" name="force-tlsv12 (Bind and server options)"></a><a class="anchor" name="force-tlsv12 (Bind options)"></a><div class="keyword"><b><a class="anchor" name="force-tlsv12"></a><a href="#5.1-force-tlsv12">force-tlsv12</a></b></div><pre class="text">This option enforces use of TLSv1.2 only on SSL connections instantiated from
this listener. This option is also available on global statement
&quot;<a href="#ssl-default-bind-options">ssl-default-bind-options</a>&quot;. See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-max-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-max-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-max-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;.
</pre><a class="anchor" name="force-tlsv13"></a><a class="anchor" name="5-force-tlsv13"></a><a class="anchor" name="5.1-force-tlsv13"></a><a class="anchor" name="force-tlsv13 (Bind and server options)"></a><a class="anchor" name="force-tlsv13 (Bind options)"></a><div class="keyword"><b><a class="anchor" name="force-tlsv13"></a><a href="#5.1-force-tlsv13">force-tlsv13</a></b></div><pre class="text">This option enforces use of TLSv1.3 only on SSL connections instantiated from
this listener. This option is also available on global statement
&quot;<a href="#ssl-default-bind-options">ssl-default-bind-options</a>&quot;. See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-max-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-max-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-max-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;.
</pre><a class="anchor" name="generate-certificates"></a><a class="anchor" name="5-generate-certificates"></a><a class="anchor" name="5.1-generate-certificates"></a><a class="anchor" name="generate-certificates (Bind and server options)"></a><a class="anchor" name="generate-certificates (Bind options)"></a><div class="keyword"><b><a class="anchor" name="generate-certificates"></a><a href="#5.1-generate-certificates">generate-certificates</a></b></div><pre class="text">This setting is only available when support for OpenSSL was built in. It
enables the dynamic SSL certificates generation. A CA certificate and its
private key are necessary (see 'ca-sign-file'). When HAProxy is configured as
a transparent forward proxy, SSL requests generate errors because of a common
name mismatch on the certificate presented to the client. With this option
enabled, HAProxy will try to forge a certificate using the SNI hostname
indicated by the client. This is done only if no certificate matches the SNI
hostname (see 'crt-list'). If an error occurs, the default certificate is
used, else the 'strict-sni' option is set.
It can also be used when HAProxy is configured as a reverse proxy to ease the
deployment of an architecture with many backends.

Creating a SSL certificate is an expensive operation, so a LRU cache is used
to store forged certificates (see 'tune.ssl.ssl-ctx-cache-size'). It
increases the HAProxy's memory footprint to reduce latency when the same
certificate is used many times.
</pre><a class="anchor" name="gid"></a><a class="anchor" name="5-gid"></a><a class="anchor" name="5.1-gid"></a><a class="anchor" name="gid (Bind and server options)"></a><a class="anchor" name="gid (Bind options)"></a><div class="keyword"><b><a class="anchor" name="gid"></a><a href="#5.1-gid">gid</a></b> <span style="color: #080">&lt;gid&gt;</span></div><pre class="text">Sets the group of the UNIX sockets to the designated system gid. It can also
be set by default in the global section's &quot;<a href="#unix-bind">unix-bind</a>&quot; statement. Note that
some platforms simply ignore this. This setting is equivalent to the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">group<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#group%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#group%20%28Userlists%29">Userlists</a></li><li><a href="#group%20%28Programs%20%28deprecated%29%29">Programs (deprecated)</a></li><li><a href="#group%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot;
setting except that the group ID is used instead of its name. This setting is
ignored by non UNIX sockets.
</pre><a class="anchor" name="group"></a><a class="anchor" name="5-group"></a><a class="anchor" name="5.1-group"></a><a class="anchor" name="group (Bind and server options)"></a><a class="anchor" name="group (Bind options)"></a><div class="keyword"><b><a class="anchor" name="group"></a><a href="#5.1-group">group</a></b> <span style="color: #080">&lt;group&gt;</span></div><pre class="text">Sets the group of the UNIX sockets to the designated system group. It can
also be set by default in the global section's &quot;<a href="#unix-bind">unix-bind</a>&quot; statement. Note
that some platforms simply ignore this. This setting is equivalent to the
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">gid<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#gid%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#gid%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; setting except that the group name is used instead of its gid. This
setting is ignored by non UNIX sockets.
</pre><a class="anchor" name="guid-prefix"></a><a class="anchor" name="5-guid-prefix"></a><a class="anchor" name="5.1-guid-prefix"></a><a class="anchor" name="guid-prefix (Bind and server options)"></a><a class="anchor" name="guid-prefix (Bind options)"></a><div class="keyword"><b><a class="anchor" name="guid-prefix"></a><a href="#5.1-guid-prefix">guid-prefix</a></b> <span style="color: #080">&lt;string&gt;</span></div><pre class="text">Generate case-sensitive global unique IDs for each listening sockets
allocated on this bind line. Prefix will be concatenated to listeners
position index on the current bind line, with character '-' as separator. See
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">guid<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#guid%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#guid%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; proxy keyword description for more information on its format.
</pre><a class="anchor" name="id"></a><a class="anchor" name="5-id"></a><a class="anchor" name="5.1-id"></a><a class="anchor" name="id (Bind and server options)"></a><a class="anchor" name="id (Bind options)"></a><div class="keyword"><b><a class="anchor" name="id"></a><a href="#5.1-id">id</a></b> <span style="color: #080">&lt;id&gt;</span></div><pre class="text">Fixes the socket ID. By default, socket IDs are automatically assigned, but
sometimes it is more convenient to fix them to ease monitoring. This value
must be strictly positive and unique within the listener/frontend. This
option can only be used when defining only a single socket.
</pre><a class="anchor" name="interface"></a><a class="anchor" name="5-interface"></a><a class="anchor" name="5.1-interface"></a><a class="anchor" name="interface (Bind and server options)"></a><a class="anchor" name="interface (Bind options)"></a><div class="keyword"><b><a class="anchor" name="interface"></a><a href="#5.1-interface">interface</a></b> <span style="color: #080">&lt;interface&gt;</span></div><pre class="text">Restricts the socket to a specific interface. When specified, only packets
received from that particular interface are processed by the socket. This is
currently only supported on Linux. The interface must be a primary system
interface, not an aliased interface. It is also possible to bind multiple
frontends to the same address if they are bound to different interfaces. Note
that binding to a network interface requires root privileges. This parameter
is only compatible with TCPv4/TCPv6 sockets. When specified, return traffic
uses the same interface as inbound traffic, and its associated routing table,
even if there are explicit routes through different interfaces configured.
This can prove useful to address asymmetric routing issues when the same
client IP addresses need to be able to reach frontends hosted on different
interfaces.
</pre><a class="anchor" name="level"></a><a class="anchor" name="5-level"></a><a class="anchor" name="5.1-level"></a><a class="anchor" name="level (Bind and server options)"></a><a class="anchor" name="level (Bind options)"></a><div class="keyword"><b><a class="anchor" name="level"></a><a href="#5.1-level">level</a></b> <span style="color: #080">&lt;level&gt;</span></div><pre class="text">This setting is used with the stats sockets only to restrict the nature of
the commands that can be issued on the socket. It is ignored by other
sockets. &lt;level&gt; can be one of :
- &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">user<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#user%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#user%20%28Userlists%29">Userlists</a></li><li><a href="#user%20%28Programs%20%28deprecated%29%29">Programs (deprecated)</a></li><li><a href="#user%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; is the least privileged level; only non-sensitive stats can be
  read, and no change is allowed. It would make sense on systems where it
  is not easy to restrict access to the socket.
- &quot;operator&quot; is the default level and fits most common uses. All data can
  be read, and only non-sensitive changes are permitted (e.g. clear max
  counters).
- &quot;admin&quot; should be used with care, as everything is permitted (e.g. clear
  all counters).
</pre><a class="anchor" name="maxconn"></a><a class="anchor" name="5-maxconn"></a><a class="anchor" name="5.1-maxconn"></a><a class="anchor" name="maxconn (Bind and server options)"></a><a class="anchor" name="maxconn (Bind options)"></a><div class="keyword"><b><a class="anchor" name="maxconn"></a><a href="#5.1-maxconn">maxconn</a></b> <span style="color: #080">&lt;maxconn&gt;</span></div><pre class="text">Limits the sockets to this number of concurrent connections. Extraneous
connections will remain in the system's backlog until a connection is
released. If unspecified, the limit will be the same as the frontend's
maxconn. Note that in case of port ranges or multiple addresses, the same
value will be applied to each socket. This setting enables different
limitations on expensive sockets, for instance SSL entries which may easily
eat all memory.
</pre><a class="anchor" name="mode"></a><a class="anchor" name="5-mode"></a><a class="anchor" name="5.1-mode"></a><a class="anchor" name="mode (Bind and server options)"></a><a class="anchor" name="mode (Bind options)"></a><div class="keyword"><b><a class="anchor" name="mode"></a><a href="#5.1-mode">mode</a></b> <span style="color: #080">&lt;mode&gt;</span></div><pre class="text">Sets the octal mode used to define access permissions on the UNIX socket. It
can also be set by default in the global section's &quot;<a href="#unix-bind">unix-bind</a>&quot; statement.
Note that some platforms simply ignore this. This setting is ignored by non
UNIX sockets.
</pre><a class="anchor" name="mss"></a><a class="anchor" name="5-mss"></a><a class="anchor" name="5.1-mss"></a><a class="anchor" name="mss (Bind and server options)"></a><a class="anchor" name="mss (Bind options)"></a><div class="keyword"><b><a class="anchor" name="mss"></a><a href="#5.1-mss">mss</a></b> <span style="color: #080">&lt;maxseg&gt;</span></div><pre class="text">Sets the TCP Maximum Segment Size (MSS) value to be advertised on incoming
connections. This can be used to force a lower MSS for certain specific
ports, for instance for connections passing through a VPN. Note that this
relies on a kernel feature which is theoretically supported under Linux but
was buggy in all versions prior to 2.6.28. It may or may not work on other
operating systems. It may also not change the advertised value but change the
effective size of outgoing segments. The commonly advertised value for TCPv4
over Ethernet networks is 1460 = 1500(MTU) - 40(IP+TCP). If this value is
positive, it will be used as the advertised MSS. If it is negative, it will
indicate by how much to reduce the incoming connection's advertised MSS for
outgoing segments. This parameter is only compatible with TCP v4/v6 sockets.
</pre><a class="anchor" name="name"></a><a class="anchor" name="5-name"></a><a class="anchor" name="5.1-name"></a><a class="anchor" name="name (Bind and server options)"></a><a class="anchor" name="name (Bind options)"></a><div class="keyword"><b><a class="anchor" name="name"></a><a href="#5.1-name">name</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">Sets an optional name for these sockets, which will be reported on the stats
page.
</pre><a class="anchor" name="namespace"></a><a class="anchor" name="5-namespace"></a><a class="anchor" name="5.1-namespace"></a><a class="anchor" name="namespace (Bind and server options)"></a><a class="anchor" name="namespace (Bind options)"></a><div class="keyword"><b><a class="anchor" name="namespace"></a><a href="#5.1-namespace">namespace</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">On Linux, it is possible to specify which network namespace a socket will
belong to. This directive makes it possible to explicitly bind a listener to
a namespace different from the default one. Please refer to your operating
system's documentation to find more details about network namespaces.
</pre><a class="anchor" name="nbconn"></a><a class="anchor" name="5-nbconn"></a><a class="anchor" name="5.1-nbconn"></a><a class="anchor" name="nbconn (Bind and server options)"></a><a class="anchor" name="nbconn (Bind options)"></a><div class="keyword"><b><a class="anchor" name="nbconn"></a><a href="#5.1-nbconn">nbconn</a></b> <span style="color: #080">&lt;nbconn&gt;</span> <span style="color: #008">[ EXPERIMENTAL ]</span></div><pre class="text">This setting is only valid for listener instances which uses reverse HTTP.
This will define the count of connections which will be mounted in parallel.
If not specified, a default value of 1 is used.

Reverse HTTP is currently still in active development. Configuration
mechanism may change in the future. For this reason it is internally marked
as expirmental, meaning that &quot;<a href="#expose-experimental-directives">expose-experimental-directives</a>&quot; must appear on
a line before this directive.
</pre><a class="anchor" name="nice"></a><a class="anchor" name="5-nice"></a><a class="anchor" name="5.1-nice"></a><a class="anchor" name="nice (Bind and server options)"></a><a class="anchor" name="nice (Bind options)"></a><div class="keyword"><b><a class="anchor" name="nice"></a><a href="#5.1-nice">nice</a></b> <span style="color: #080">&lt;nice&gt;</span></div><pre class="text">Sets the 'niceness' of connections initiated from the socket. Value must be
in the range -1024..1024 inclusive, and defaults to zero. Positive values
means that such connections are more friendly to others and easily offer
their place in the scheduler. On the opposite, negative values mean that
connections want to run with a higher priority than others. The difference
only happens under high loads when the system is close to saturation.
Negative values are appropriate for low-latency or administration services,
and high values are generally recommended for CPU intensive tasks such as SSL
processing or bulk transfers which are less sensible to latency. For example,
it may make sense to use a positive value for an SMTP socket and a negative
one for an RDP socket.
</pre><a class="anchor" name="no-alpn"></a><a class="anchor" name="5-no-alpn"></a><a class="anchor" name="5.1-no-alpn"></a><a class="anchor" name="no-alpn (Bind and server options)"></a><a class="anchor" name="no-alpn (Bind options)"></a><div class="keyword"><b><a class="anchor" name="no-alpn"></a><a href="#5.1-no-alpn">no-alpn</a></b></div><pre class="text">Disables ALPN processing (technically speaking this sets the ALPN string to
an empty string that will not be advertised). It permits to cancel a previous
occurrence of an &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">alpn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#alpn%20%28Bind%20options%29">Bind options</a></li><li><a href="#alpn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; setting and to disable application protocol
negotiation. It may also be used to prevent a listener from negotiating ALPN
with a client on an HTTPS or QUIC listener; by default, HTTPS listeners will
advertise &quot;h2,http/1.1&quot; and QUIC listeners will advertise &quot;h3&quot;. See also
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">alpn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#alpn%20%28Bind%20options%29">Bind options</a></li><li><a href="#alpn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; bove. Note that when using &quot;<a href="#crt-list">crt-list</a>&quot;, a certificate may override the
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">alpn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#alpn%20%28Bind%20options%29">Bind options</a></li><li><a href="#alpn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; setting and re-enable its processing.
</pre><a class="anchor" name="no-ca-names"></a><a class="anchor" name="5-no-ca-names"></a><a class="anchor" name="5.1-no-ca-names"></a><a class="anchor" name="no-ca-names (Bind and server options)"></a><a class="anchor" name="no-ca-names (Bind options)"></a><div class="keyword"><b><a class="anchor" name="no-ca-names"></a><a href="#5.1-no-ca-names">no-ca-names</a></b></div><pre class="text">This setting is only available when support for OpenSSL was built in. It
prevents from send CA names in server hello message when ca-file is used.
Use &quot;<a href="#ca-verify-file">ca-verify-file</a>&quot; instead of &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ca-file<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ca-file%20%28Bind%20options%29">Bind options</a></li><li><a href="#ca-file%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; with &quot;<a href="#no-ca-names">no-ca-names</a>&quot;.
</pre><a class="anchor" name="no-sslv3"></a><a class="anchor" name="5-no-sslv3"></a><a class="anchor" name="5.1-no-sslv3"></a><a class="anchor" name="no-sslv3 (Bind and server options)"></a><a class="anchor" name="no-sslv3 (Bind options)"></a><div class="keyword"><b><a class="anchor" name="no-sslv3"></a><a href="#5.1-no-sslv3">no-sslv3</a></b></div><pre class="text">This setting is only available when support for OpenSSL was built in. It
disables support for SSLv3 on any sockets instantiated from the listener when
SSL is supported. Note that SSLv2 is forced disabled in the code and cannot
be enabled using any configuration option. This option is also available on
global statement &quot;<a href="#ssl-default-bind-options">ssl-default-bind-options</a>&quot;. Use &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-max-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-max-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-max-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; instead.
</pre><a class="anchor" name="no-tls-tickets"></a><a class="anchor" name="5-no-tls-tickets"></a><a class="anchor" name="5.1-no-tls-tickets"></a><a class="anchor" name="no-tls-tickets (Bind and server options)"></a><a class="anchor" name="no-tls-tickets (Bind options)"></a><div class="keyword"><b><a class="anchor" name="no-tls-tickets"></a><a href="#5.1-no-tls-tickets">no-tls-tickets</a></b></div><pre class="text">This setting is only available when support for OpenSSL was built in. It
disables the stateless session resumption (RFC 5077 TLS Ticket
extension) and force to use stateful session resumption. Stateless
session resumption is more expensive in CPU usage. This option is also
available on global statement &quot;<a href="#ssl-default-bind-options">ssl-default-bind-options</a>&quot;.
The TLS ticket mechanism is only used up to TLS 1.2.
Forward Secrecy is compromised with TLS tickets, unless ticket keys
are periodically rotated (via reload or by using &quot;<a href="#tls-ticket-keys">tls-ticket-keys</a>&quot;).
</pre><a class="anchor" name="no-tlsv10"></a><a class="anchor" name="5-no-tlsv10"></a><a class="anchor" name="5.1-no-tlsv10"></a><a class="anchor" name="no-tlsv10 (Bind and server options)"></a><a class="anchor" name="no-tlsv10 (Bind options)"></a><div class="keyword"><b><a class="anchor" name="no-tlsv10"></a><a href="#5.1-no-tlsv10">no-tlsv10</a></b></div><pre class="text">This setting is only available when support for OpenSSL was built in. It
disables support for TLSv1.0 on any sockets instantiated from the listener
when SSL is supported. Note that SSLv2 is forced disabled in the code and
cannot be enabled using any configuration option. This option is also
available on global statement &quot;<a href="#ssl-default-bind-options">ssl-default-bind-options</a>&quot;. Use &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-max-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-max-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-max-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; instead.
</pre><a class="anchor" name="no-tlsv11"></a><a class="anchor" name="5-no-tlsv11"></a><a class="anchor" name="5.1-no-tlsv11"></a><a class="anchor" name="no-tlsv11 (Bind and server options)"></a><a class="anchor" name="no-tlsv11 (Bind options)"></a><div class="keyword"><b><a class="anchor" name="no-tlsv11"></a><a href="#5.1-no-tlsv11">no-tlsv11</a></b></div><pre class="text">This setting is only available when support for OpenSSL was built in. It
disables support for TLSv1.1 on any sockets instantiated from the listener
when SSL is supported. Note that SSLv2 is forced disabled in the code and
cannot be enabled using any configuration option. This option is also
available on global statement &quot;<a href="#ssl-default-bind-options">ssl-default-bind-options</a>&quot;. Use &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-max-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-max-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-max-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; instead.
</pre><a class="anchor" name="no-tlsv12"></a><a class="anchor" name="5-no-tlsv12"></a><a class="anchor" name="5.1-no-tlsv12"></a><a class="anchor" name="no-tlsv12 (Bind and server options)"></a><a class="anchor" name="no-tlsv12 (Bind options)"></a><div class="keyword"><b><a class="anchor" name="no-tlsv12"></a><a href="#5.1-no-tlsv12">no-tlsv12</a></b></div><pre class="text">This setting is only available when support for OpenSSL was built in. It
disables support for TLSv1.2 on any sockets instantiated from the listener
when SSL is supported. Note that SSLv2 is forced disabled in the code and
cannot be enabled using any configuration option. This option is also
available on global statement &quot;<a href="#ssl-default-bind-options">ssl-default-bind-options</a>&quot;. Use &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-max-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-max-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-max-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; instead.
</pre><a class="anchor" name="no-tlsv13"></a><a class="anchor" name="5-no-tlsv13"></a><a class="anchor" name="5.1-no-tlsv13"></a><a class="anchor" name="no-tlsv13 (Bind and server options)"></a><a class="anchor" name="no-tlsv13 (Bind options)"></a><div class="keyword"><b><a class="anchor" name="no-tlsv13"></a><a href="#5.1-no-tlsv13">no-tlsv13</a></b></div><pre class="text">This setting is only available when support for OpenSSL was built in. It
disables support for TLSv1.3 on any sockets instantiated from the listener
when SSL is supported. Note that SSLv2 is forced disabled in the code and
cannot be enabled using any configuration option. This option is also
available on global statement &quot;<a href="#ssl-default-bind-options">ssl-default-bind-options</a>&quot;. Use &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-max-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-max-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-max-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; instead.
</pre><a class="anchor" name="npn"></a><a class="anchor" name="5-npn"></a><a class="anchor" name="5.1-npn"></a><a class="anchor" name="npn (Bind and server options)"></a><a class="anchor" name="npn (Bind options)"></a><div class="keyword"><b><a class="anchor" name="npn"></a><a href="#5.1-npn">npn</a></b> <span style="color: #080">&lt;protocols&gt;</span></div><pre class="text">This enables the NPN TLS extension and advertises the specified protocol list
as supported on top of NPN. The protocol list consists in a comma-delimited
list of protocol names, for instance: &quot;http/1.1,http/1.0&quot; (without quotes).
This requires that the SSL library is built with support for TLS extensions
enabled (check with haproxy -vv). Note that the NPN extension has been
replaced with the ALPN extension (see the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">alpn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#alpn%20%28Bind%20options%29">Bind options</a></li><li><a href="#alpn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword), though this one is
only available starting with OpenSSL 1.0.2. If HTTP/2 is desired on an older
version of OpenSSL, NPN might still be used as most clients still support it
at the time of writing this. It is possible to enable both NPN and ALPN
though it probably doesn't make any sense out of testing.
</pre><a class="anchor" name="prefer-client-ciphers"></a><a class="anchor" name="5-prefer-client-ciphers"></a><a class="anchor" name="5.1-prefer-client-ciphers"></a><a class="anchor" name="prefer-client-ciphers (Bind and server options)"></a><a class="anchor" name="prefer-client-ciphers (Bind options)"></a><div class="keyword"><b><a class="anchor" name="prefer-client-ciphers"></a><a href="#5.1-prefer-client-ciphers">prefer-client-ciphers</a></b></div><pre class="text">Use the client's preference when selecting the cipher suite, by default
the server's preference is enforced. This option is also available on
global statement &quot;<a href="#ssl-default-bind-options">ssl-default-bind-options</a>&quot;.
Note that with OpenSSL &gt;= 1.1.1 ChaCha20-Poly1305 is reprioritized anyway
(without setting this option), if a ChaCha20-Poly1305 cipher is at the top of
the client cipher list.
</pre><a class="anchor" name="proto"></a><a class="anchor" name="5-proto"></a><a class="anchor" name="5.1-proto"></a><a class="anchor" name="proto (Bind and server options)"></a><a class="anchor" name="proto (Bind options)"></a><div class="keyword"><b><a class="anchor" name="proto"></a><a href="#5.1-proto">proto</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">Forces the multiplexer's protocol to use for the incoming connections. It
must be compatible with the mode of the frontend (TCP or HTTP). It must also
be usable on the frontend side. The list of available protocols is reported
in haproxy -vv. The protocols properties are reported : the mode (TCP/HTTP),
the side (FE/BE), the mux name and its flags.

Some protocols are subject to the head-of-line blocking on server side
(flag=HOL_RISK). Finally some protocols don't support upgrades (flag=NO_UPG).
The HTX compatibility is also reported (flag=HTX).

Here are the protocols that may be used as argument to a &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">proto<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#proto%20%28Bind%20options%29">Bind options</a></li><li><a href="#proto%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; directive on
a bind line :

  h2   : mode=HTTP  side=FE|BE  mux=H2    flags=HTX|HOL_RISK|NO_UPG
  h1   : mode=HTTP  side=FE|BE  mux=H1    flags=HTX|NO_UPG
  none : mode=TCP   side=FE|BE  mux=PASS  flags=NO_UPG

Idea behind this option is to bypass the selection of the best multiplexer's
protocol for all connections instantiated from this listening socket. For
instance, it is possible to force the http/2 on clear TCP by specifying &quot;proto
h2&quot; on the bind line.
</pre><a class="anchor" name="quic-cc-algo"></a><a class="anchor" name="5-quic-cc-algo"></a><a class="anchor" name="5.1-quic-cc-algo"></a><a class="anchor" name="quic-cc-algo (Bind and server options)"></a><a class="anchor" name="quic-cc-algo (Bind options)"></a><div class="keyword"><b><a class="anchor" name="quic-cc-algo"></a><a href="#5.1-quic-cc-algo">quic-cc-algo</a></b> <span style="color: #800">{ cubic | newreno | bbr | nocc }</span><span style="color: #008">[(<span style="color: #080">&lt;args,...&gt;</span>)]</span></div><pre class="text">This is a QUIC specific setting to select the congestion control algorithm
for any connection attempts to the configured QUIC listeners. They are similar
to those used by TCP.

Default value: cubic

It is possible to enable pacing if the algorithm is compatible. This is done
by specifying an optional burst argument as described in the next paragraph.
The purpose of pacing is to smooth emission of data to reduce network losses.
In some scenario, it can significantly improve network throughput by avoiding
retransmissions. However, it can also increase CPU usage if haproxy is forced
to wait too long between each emission. Pacing support is still experimental,
as such it requires &quot;<a href="#expose-experimental-directives">expose-experimental-directives</a>&quot;. The BBR congestion
control algorithm depends on the pacing support which is in this case
implicitly enabled by choosing the &quot;bbr&quot; algorithm. Note that haproxy's BBR
implementation is still considered as experimental and cannot be enabled
without &quot;<a href="#expose-experimental-directives">expose-experimental-directives</a>&quot;.

For further customization, a list of parameters can be specified after the
algorithm token. It must be written between parenthesis, separated by a
comma. Each argument is optional and can be empty if needed. Here is the
mandatory order of each parameters :
- maximum window size in bytes. It must be greater than 10k and smaller than
  4g. By default &quot;<a href="#tune.quic.frontend.default-max-window-size">tune.quic.frontend.default-max-window-size</a>&quot; value is used.
- burst size in datagrams. By default, it is set to 0, which means unlimited.
  A positive value up to 1024 can be specified to smooth emission using
  pacing. Lower values provide a smoother traffic (hence less losses) at the
  expense of a higher CPU usage, while higher values will reduce CPU usage
  and provide a slightly more bursty traffic. Note that a datagram is usually
  around 1252 bytes, and that a typical receive buffer is 208kB or 170
  datagrams, so in order to keep the traffic smooth, bursts should only
  represent a small fraction of this value (between a few units to a few tens
  at most). See above paragraph for more explanation. This parameter is
  ignored by BBR.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># newreno congestion control algorithm</span>
quic-cc-algo newreno
<span class="comment"># cubic congestion control algorithm with one megabytes as window</span>
quic-cc-algo cubic(1m)
<span class="comment"># cubic with pacing on top of it, with burst limited to 12 datagrams</span>
quic-cc-algo cubic(,12)
</code></pre>
</div><pre class="text">A special value &quot;nocc&quot; may be used to force a fixed congestion window always
set at the maximum size. It is reserved for debugging scenarios to remove any
side effects caused by the congestion controller. It must not be used in
production as it can quickly lead to network issues such as a high loss rate.
</pre><a class="anchor" name="quic-force-retry"></a><a class="anchor" name="5-quic-force-retry"></a><a class="anchor" name="5.1-quic-force-retry"></a><a class="anchor" name="quic-force-retry (Bind and server options)"></a><a class="anchor" name="quic-force-retry (Bind options)"></a><div class="keyword"><b><a class="anchor" name="quic-force-retry"></a><a href="#5.1-quic-force-retry">quic-force-retry</a></b></div><pre class="text">This is a QUIC specific setting which forces the use of the QUIC Retry feature
for all the connection attempts to the configured QUIC listeners. It consists
in verifying the peers are able to receive packets at the transport address
they used to initiate a new connection, sending them a Retry packet which
contains a token. This token must be sent back to the Retry packet sender,
this latter being the only one to be able to validate the token. Note that QUIC
Retry will always be used even if a Retry threshold was set (see
&quot;<a href="#tune.quic.retry-threshold">tune.quic.retry-threshold</a>&quot; setting).

This setting requires the cluster secret to be set or else an error will be
reported on startup (see &quot;<a href="#cluster-secret">cluster-secret</a>&quot;).

See https://www.rfc-editor.org/rfc/rfc9000.html#section-8.1.2 for more
information about QUIC retry.
</pre><a class="anchor" name="quic-socket"></a><a class="anchor" name="5-quic-socket"></a><a class="anchor" name="5.1-quic-socket"></a><a class="anchor" name="quic-socket (Bind and server options)"></a><a class="anchor" name="quic-socket (Bind options)"></a><div class="keyword"><b><a class="anchor" name="quic-socket"></a><a href="#5.1-quic-socket">quic-socket</a></b> <span style="color: #008">[ connection | listener ]</span></div><pre class="text">This QUIC specific setting allows to define the socket allocation mode for
the specific listeners. See &quot;<a href="#tune.quic.socket-owner">tune.quic.socket-owner</a>&quot; for a full description
of its usage.
</pre><a class="anchor" name="severity-output"></a><a class="anchor" name="5-severity-output"></a><a class="anchor" name="5.1-severity-output"></a><a class="anchor" name="severity-output (Bind and server options)"></a><a class="anchor" name="severity-output (Bind options)"></a><div class="keyword"><b><a class="anchor" name="severity-output"></a><a href="#5.1-severity-output">severity-output</a></b> <span style="color: #080">&lt;format&gt;</span></div><pre class="text">This setting is used with the stats sockets only to configure severity
level output prepended to informational feedback messages. Severity
level of messages can range between 0 and 7, conforming to syslog
rfc5424. Valid and successful socket commands requesting data
(i.e. &quot;show map&quot;, &quot;get acl foo&quot; etc.) will never have a severity level
prepended. It is ignored by other sockets. &lt;format&gt; can be one of :
- &quot;none&quot; (default) no severity level is prepended to feedback messages.
- &quot;number&quot; severity level is prepended as a number.
- &quot;string&quot; severity level is prepended as a string following the
  rfc5424 convention.
</pre><a class="anchor" name="shards"></a><a class="anchor" name="5-shards"></a><a class="anchor" name="5.1-shards"></a><a class="anchor" name="shards (Bind and server options)"></a><a class="anchor" name="shards (Bind options)"></a><div class="keyword"><b><a class="anchor" name="shards"></a><a href="#5.1-shards">shards</a></b> <span style="color: #080">&lt;number&gt;</span> | by-thread | by-group</div><pre class="text">In multi-threaded mode, on operating systems supporting multiple listeners on
the same IP:port, this will automatically create this number of multiple
identical listeners for the same line, all bound to a fair share of the number
of the threads attached to this listener. This can sometimes be useful when
using very large thread counts where the in-kernel locking on a single socket
starts to cause a significant overhead. In this case the incoming traffic is
distributed over multiple sockets and the contention is reduced. Note that
doing this can easily increase the CPU usage by making more threads work a
little bit.

If the number of shards is higher than the number of available threads, it
will automatically be trimmed to the number of threads (i.e. one shard per
thread). The special &quot;by-thread&quot; value also creates as many shards as there
are threads on the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line. Since the system will evenly distribute the
incoming traffic between all these shards, it is important that this number
is an integral divisor of the number of threads. Alternately, the other
special value &quot;by-group&quot; will create one shard per thread group. This can
be useful when dealing with many threads and not wanting to create too many
sockets. The load distribution will be a bit less optimal but the contention
(especially in the system) will still be lower than with a single socket.

On operating systems that do not support multiple sockets bound to the same
address, &quot;by-thread&quot; and &quot;by-group&quot; will automatically fall back to a single
shard. For &quot;by-group&quot; this is done without any warning since it doesn't
change anything for a single group, and will result in sockets being
duplicated for each group anyway. However, for &quot;by-thread&quot;, a diagnostic
warning will be emitted if this happens since the resulting number of
listeners will not be the expected one.
</pre><a class="anchor" name="sigalgs"></a><a class="anchor" name="5-sigalgs"></a><a class="anchor" name="5.1-sigalgs"></a><a class="anchor" name="sigalgs (Bind and server options)"></a><a class="anchor" name="sigalgs (Bind options)"></a><div class="keyword"><b><a class="anchor" name="sigalgs"></a><a href="#5.1-sigalgs">sigalgs</a></b> <span style="color: #080">&lt;sigalgs&gt;</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. It sets
the string describing the list of signature algorithms that are negotiated
during the TLSv1.2 and TLSv1.3 handshake. The format of the string is defined
in &quot;man 3 SSL_CTX_set1_sigalgs&quot; from the OpenSSL man pages. It is not
recommended to use this setting unless compatibility with a middlebox is
required.
</pre><a class="anchor" name="ssl"></a><a class="anchor" name="5-ssl"></a><a class="anchor" name="5.1-ssl"></a><a class="anchor" name="ssl (Bind and server options)"></a><a class="anchor" name="ssl (Bind options)"></a><div class="keyword"><b><a class="anchor" name="ssl"></a><a href="#5.1-ssl">ssl</a></b></div><pre class="text">This setting is only available when support for OpenSSL was built in. It
enables SSL deciphering on connections instantiated from this listener. A
certificate is necessary (see &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crt<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crt%20%28Load%20options%29">Load options</a></li><li><a href="#crt%20%28Bind%20options%29">Bind options</a></li><li><a href="#crt%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; above). All contents in the buffers will
appear in clear text, so that ACLs and HTTP processing will only have access
to deciphered contents. SSLv3 is disabled per default, use &quot;ssl-min-ver SSLv3&quot;
to enable it.
</pre><a class="anchor" name="ssl-max-ver"></a><a class="anchor" name="5-ssl-max-ver"></a><a class="anchor" name="5.1-ssl-max-ver"></a><a class="anchor" name="ssl-max-ver (Bind and server options)"></a><a class="anchor" name="ssl-max-ver (Bind options)"></a><div class="keyword"><b><a class="anchor" name="ssl-max-ver"></a><a href="#5.1-ssl-max-ver">ssl-max-ver</a></b> <span style="color: #008">[ SSLv3 | TLSv1.0 | TLSv1.1 | TLSv1.2 | TLSv1.3 ]</span></div><pre class="text">This option enforces use of &lt;version&gt; or lower on SSL connections instantiated
from this listener. Using this setting without &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; can be
ambiguous because the default ssl-min-ver value could change in future HAProxy
versions. This option is also available on global statement
&quot;<a href="#ssl-default-bind-options">ssl-default-bind-options</a>&quot;. See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;.
</pre><a class="anchor" name="ssl-min-ver"></a><a class="anchor" name="5-ssl-min-ver"></a><a class="anchor" name="5.1-ssl-min-ver"></a><a class="anchor" name="ssl-min-ver (Bind and server options)"></a><a class="anchor" name="ssl-min-ver (Bind options)"></a><div class="keyword"><b><a class="anchor" name="ssl-min-ver"></a><a href="#5.1-ssl-min-ver">ssl-min-ver</a></b> <span style="color: #008">[ SSLv3 | TLSv1.0 | TLSv1.1 | TLSv1.2 | TLSv1.3 ]</span></div><pre class="text">This option enforces use of &lt;version&gt; or upper on SSL connections
instantiated from this listener. The default value is &quot;TLSv1.2&quot;. This option
is also available on global statement &quot;<a href="#ssl-default-bind-options">ssl-default-bind-options</a>&quot;.
See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-max-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-max-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-max-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;.
</pre><a class="anchor" name="strict-sni"></a><a class="anchor" name="5-strict-sni"></a><a class="anchor" name="5.1-strict-sni"></a><a class="anchor" name="strict-sni (Bind and server options)"></a><a class="anchor" name="strict-sni (Bind options)"></a><div class="keyword"><b><a class="anchor" name="strict-sni"></a><a href="#5.1-strict-sni">strict-sni</a></b></div><pre class="text">This setting is only available when support for OpenSSL was built in. The
SSL/TLS negotiation is allowed only if the client provided an SNI that matches
a certificate. The default certificate is not used. This option also allows
starting without any certificate on a bind line, so an empty directory could
be used and filled later from the stats socket.
See the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">crt<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#crt%20%28Load%20options%29">Load options</a></li><li><a href="#crt%20%28Bind%20options%29">Bind options</a></li><li><a href="#crt%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; option for more information. See &quot;add ssl crt-list&quot; command in
the management guide.
</pre><a class="anchor" name="tcp-ut"></a><a class="anchor" name="5-tcp-ut"></a><a class="anchor" name="5.1-tcp-ut"></a><a class="anchor" name="tcp-ut (Bind and server options)"></a><a class="anchor" name="tcp-ut (Bind options)"></a><div class="keyword"><b><a class="anchor" name="tcp-ut"></a><a href="#5.1-tcp-ut">tcp-ut</a></b> <span style="color: #080">&lt;delay&gt;</span></div><pre class="text">Sets the TCP User Timeout for all incoming connections instantiated from this
listening socket. This option is available on Linux since version 2.6.37. It
allows HAProxy to configure a timeout for sockets which contain data not
receiving an acknowledgment for the configured delay. This is especially
useful on long-lived connections experiencing long idle periods such as
remote terminals or database connection pools, where the client and server
timeouts must remain high to allow a long period of idle, but where it is
important to detect that the client has disappeared in order to release all
resources associated with its connection (and the server's session). The
argument is a delay expressed in milliseconds by default. This only works
for regular TCP connections, and is ignored for other protocols.
</pre><a class="anchor" name="tfo"></a><a class="anchor" name="5-tfo"></a><a class="anchor" name="5.1-tfo"></a><a class="anchor" name="tfo (Bind and server options)"></a><a class="anchor" name="tfo (Bind options)"></a><div class="keyword"><b><a class="anchor" name="tfo"></a><a href="#5.1-tfo">tfo</a></b></div><pre class="text">Is an optional keyword which is supported only on Linux kernels &gt;= 3.7. It
enables TCP Fast Open on the listening socket, which means that clients which
support this feature will be able to send a request and receive a response
during the 3-way handshake starting from second connection, thus saving one
round-trip after the first connection. This only makes sense with protocols
that use high connection rates and where each round trip matters. This can
possibly cause issues with many firewalls which do not accept data on SYN
packets, so this option should only be enabled once well tested. This option
is only supported on TCPv4/TCPv6 sockets and ignored by other ones. You may
need to build HAProxy with USE_TFO=1 if your libc doesn't define
TCP_FASTOPEN.
</pre><a class="anchor" name="thread"></a><a class="anchor" name="5-thread"></a><a class="anchor" name="5.1-thread"></a><a class="anchor" name="thread (Bind and server options)"></a><a class="anchor" name="thread (Bind options)"></a><div class="keyword"><b><a class="anchor" name="thread"></a><a href="#5.1-thread">thread</a></b> <span style="color: #008">[<span style="color: #080">&lt;thread-group&gt;</span>/]</span><span style="color: #080">&lt;thread-set&gt;</span><span style="color: #008">[,...]</span></div><pre class="text">This restricts the list of threads on which this listener is allowed to run.
It does not enforce any of them but eliminates those which do not match. It
limits the threads allowed to process incoming connections for this listener.

There are two numbering schemes. By default, thread numbers are absolute in
the process, comprised between 1 and the value specified in global.nbthread.
It is also possible to designate a thread number using its relative number
inside its thread group, by specifying the thread group number first, then a
slash ('/') and the relative thread number(s). In this case thread numbers
also start at 1 and end at 32 or 64 depending on the platform. When absolute
thread numbers are specified, they will be automatically translated to
relative numbers once thread groups are known. Usually, absolute numbers are
preferred for simple configurations, and relative ones are preferred for
complex configurations where CPU arrangement matters for performance.

After the optional thread group number, the &quot;thread-set&quot; specification must
use the following format:

    &quot;all&quot; | &quot;<a href="#odd">odd</a>&quot; | &quot;<a href="#even">even</a>&quot; | [number][-[number]]

As their names imply, &quot;all&quot; validates all threads within the set (either all
of the group's when a group is specified, or all of the process' threads),
&quot;<a href="#odd">odd</a>&quot; validates all odd-numberred threads (every other thread starting at 1)
either for the process or the group, and &quot;<a href="#even">even</a>&quot; validates all even-numberred
threads (every other thread starting at 2). If instead thread number ranges
are used, then all threads included in the range from the first to the last
thread number are validated. The numbers are either relative to the group
or absolute depending on the presence of a thread group number. If the first
thread number is omitted, &quot;1&quot; is used, representing either the first thread
of the group or the first thread of the process. If the last thread number is
omitted, either the last thread number of the group (32 or 64) is used, or
the last thread number of the process (global.nbthread).

These ranges may be repeated and delimited by a comma, so that non-contiguous
thread sets can be specified, and the group, if present, must be specified
again for each new range. Note that it is not permitted to mix group-relative
and absolute specifications because the whole &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line must use either
an absolute notation or a relative one, as those not set will be resolved at
the end of the parsing.

It is important to know that each listener described by a &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line creates
at least one socket represented by at least one file descriptor. Since file
descriptors cannot span multiple thread groups, if a &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line specifies a
thread range that covers more than one group, several file descriptors will
automatically be created so that there is at least one per group. Technically
speaking they all refer to the same socket in the kernel, but they will get a
distinct identifier in haproxy and will even have a dedicated stats entry if
&quot;<a href="#option%20socket-stats">option socket-stats</a>&quot; is used.

The main purpose is to have multiple bind lines sharing the same IP:port but
not the same thread in a listener, so that the system can distribute the
incoming connections into multiple queues, bypassing haproxy's internal queue
load balancing. Currently Linux 3.9 and above is known for supporting this.
See also the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">shards<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#shards%20%28Peers%29">Peers</a></li><li><a href="#shards%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; keyword above that automates duplication of &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;
lines and their assignment to multiple groups of threads.

This keyword is compatible with reverse HTTP binds. However, it is forbidden
to specify a thread set which spans across several thread groups for such a
listener as this may caused &quot;<a href="#nbconn">nbconn</a>&quot; to not work as intended.
</pre><a class="anchor" name="tls-ticket-keys"></a><a class="anchor" name="5-tls-ticket-keys"></a><a class="anchor" name="5.1-tls-ticket-keys"></a><a class="anchor" name="tls-ticket-keys (Bind and server options)"></a><a class="anchor" name="tls-ticket-keys (Bind options)"></a><div class="keyword"><b><a class="anchor" name="tls-ticket-keys"></a><a href="#5.1-tls-ticket-keys">tls-ticket-keys</a></b> <span style="color: #080">&lt;keyfile&gt;</span></div><pre class="text">Sets the TLS ticket keys file to load the keys from. The keys need to be 48
or 80 bytes long, depending if aes128 or aes256 is used, encoded with base64
with one line per key (ex. openssl rand 80 | openssl base64 -A | xargs echo).
The first key determines the key length used for next keys: you can't mix
aes128 and aes256 keys. Number of keys is specified by the TLS_TICKETS_NO
build option (default 3) and at least as many keys need to be present in
the file. Last TLS_TICKETS_NO keys will be used for decryption and the
penultimate one for encryption. This enables easy key rotation by just
appending new key to the file and reloading the process.  Keys must be
periodically rotated (ex. every 12h) or Perfect Forward Secrecy is
compromised. It is also a good idea to keep the keys off any permanent
storage such as hard drives (hint: use tmpfs and don't swap those files).
Lifetime hint can be changed using tune.ssl.timeout.
</pre><a class="anchor" name="transparent"></a><a class="anchor" name="5-transparent"></a><a class="anchor" name="5.1-transparent"></a><a class="anchor" name="transparent (Bind and server options)"></a><a class="anchor" name="transparent (Bind options)"></a><div class="keyword"><b><a class="anchor" name="transparent"></a><a href="#5.1-transparent">transparent</a></b></div><pre class="text">Is an optional keyword which is supported only on certain Linux kernels. It
indicates that the addresses will be bound even if they do not belong to the
local machine, and that packets targeting any of these addresses will be
intercepted just as if the addresses were locally configured. This normally
requires that IP forwarding is enabled. Caution! do not use this with the
default address '*', as it would redirect any traffic for the specified port.
This keyword is available only when HAProxy is built with USE_LINUX_TPROXY=1.
This parameter is only compatible with TCPv4 and TCPv6 sockets, depending on
kernel version. Some distribution kernels include backports of the feature,
so check for support with your vendor.
</pre><a class="anchor" name="uid"></a><a class="anchor" name="5-uid"></a><a class="anchor" name="5.1-uid"></a><a class="anchor" name="uid (Bind and server options)"></a><a class="anchor" name="uid (Bind options)"></a><div class="keyword"><b><a class="anchor" name="uid"></a><a href="#5.1-uid">uid</a></b> <span style="color: #080">&lt;uid&gt;</span></div><pre class="text">Sets the owner of the UNIX sockets to the designated system uid. It can also
be set by default in the global section's &quot;<a href="#unix-bind">unix-bind</a>&quot; statement. Note that
some platforms simply ignore this. This setting is equivalent to the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">user<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#user%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#user%20%28Userlists%29">Userlists</a></li><li><a href="#user%20%28Programs%20%28deprecated%29%29">Programs (deprecated)</a></li><li><a href="#user%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot;
setting except that the user numeric ID is used instead of its name. This
setting is ignored by non UNIX sockets.
</pre><a class="anchor" name="user"></a><a class="anchor" name="5-user"></a><a class="anchor" name="5.1-user"></a><a class="anchor" name="user (Bind and server options)"></a><a class="anchor" name="user (Bind options)"></a><div class="keyword"><b><a class="anchor" name="user"></a><a href="#5.1-user">user</a></b> <span style="color: #080">&lt;user&gt;</span></div><pre class="text">Sets the owner of the UNIX sockets to the designated system user. It can also
be set by default in the global section's &quot;<a href="#unix-bind">unix-bind</a>&quot; statement. Note that
some platforms simply ignore this. This setting is equivalent to the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">uid<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#uid%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#uid%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot;
setting except that the user name is used instead of its uid. This setting is
ignored by non UNIX sockets.
</pre><a class="anchor" name="v4v6"></a><a class="anchor" name="5-v4v6"></a><a class="anchor" name="5.1-v4v6"></a><a class="anchor" name="v4v6 (Bind and server options)"></a><a class="anchor" name="v4v6 (Bind options)"></a><div class="keyword"><b><a class="anchor" name="v4v6"></a><a href="#5.1-v4v6">v4v6</a></b></div><pre class="text">Is an optional keyword which is supported only on most recent systems
including Linux kernels &gt;= 2.4.21. It is used to bind a socket to both IPv4
and IPv6 when it uses the default address. Doing so is sometimes necessary
on systems which bind to IPv6 only by default. It has no effect on non-IPv6
sockets, and is overridden by the &quot;<a href="#v6only">v6only</a>&quot; option.
</pre><a class="anchor" name="v6only"></a><a class="anchor" name="5-v6only"></a><a class="anchor" name="5.1-v6only"></a><a class="anchor" name="v6only (Bind and server options)"></a><a class="anchor" name="v6only (Bind options)"></a><div class="keyword"><b><a class="anchor" name="v6only"></a><a href="#5.1-v6only">v6only</a></b></div><pre class="text">Is an optional keyword which is supported only on most recent systems
including Linux kernels &gt;= 2.4.21. It is used to bind a socket to IPv6 only
when it uses the default address. Doing so is sometimes preferred to doing it
system-wide as it is per-listener. It has no effect on non-IPv6 sockets and
has precedence over the &quot;<a href="#v4v6">v4v6</a>&quot; option.
</pre><a class="anchor" name="verify"></a><a class="anchor" name="5-verify"></a><a class="anchor" name="5.1-verify"></a><a class="anchor" name="verify (Bind and server options)"></a><a class="anchor" name="verify (Bind options)"></a><div class="keyword"><b><a class="anchor" name="verify"></a><a href="#5.1-verify">verify</a></b> <span style="color: #008">[none|optional|required]</span></div><pre class="text">This setting is only available when support for OpenSSL was built in. If set
to 'none', client certificate is not requested. This is the default. In other
cases, a client certificate is requested. If the client does not provide a
certificate after the request and if 'verify' is set to 'required', then the
handshake is aborted, while it would have succeeded if set to 'optional'. The
certificate provided by the client is always verified using CAs from
'ca-file' and optional CRLs from 'crl-file'. On verify failure the handshake
is aborted, regardless of the 'verify' option, unless the error code exactly
matches one of those listed with 'ca-ignore-err' or 'crt-ignore-err'.
</pre></div>
<a class="anchor" id="5.2" name="5.2"></a>
<h2 id="chapter-5.2" data-target="5.2"><small><a class="small" href="#5.2">5.2.</a></small> Server and default-server options</h2>
<div><pre class="text">The &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keywords support a certain number of settings
which are all passed as arguments on the server line. The order in which those
arguments appear does not count, and they are all optional. Some of those
settings are single words (booleans) while others expect one or several values
after them. In this case, the values must immediately follow the setting name.
Except default-server, all those settings must be specified after the server's
address if they are used:

  server &lt;name&gt; &lt;address&gt;[:port] [settings ...]
  default-server [settings ...]

Note that all these settings are supported both by &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;
keywords, except &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">id<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#id%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#id%20%28Bind%20options%29">Bind options</a></li><li><a href="#id%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; which is only supported by &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;.

The currently supported settings are the following ones.
</pre><a class="anchor" name="addr"></a><a class="anchor" name="5-addr"></a><a class="anchor" name="5.2-addr"></a><a class="anchor" name="addr (Bind and server options)"></a><a class="anchor" name="addr (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="addr"></a><a href="#5.2-addr">addr</a></b> <span style="color: #080">&lt;ipv4|ipv6&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

Using the &quot;<a href="#addr">addr</a>&quot; parameter, it becomes possible to use a different IP address
to send health-checks or to probe the agent-check. On some servers, it may be
desirable to dedicate an IP address to specific component able to perform
complex tests which are more suitable to health-checks than the application.
This parameter is ignored if the &quot;<a href="#check">check</a>&quot; parameter is not set. See also the
&quot;<a href="#port">port</a>&quot; parameter.
</pre><a class="anchor" name="agent-check"></a><a class="anchor" name="5-agent-check"></a><a class="anchor" name="5.2-agent-check"></a><a class="anchor" name="agent-check (Bind and server options)"></a><a class="anchor" name="agent-check (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="agent-check"></a><a href="#5.2-agent-check">agent-check</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log

Enable an auxiliary agent check which is run independently of a regular
health check. An agent health check is performed by making a TCP connection
to the port set by the &quot;<a href="#agent-port">agent-port</a>&quot; parameter and reading an ASCII string
terminated by the first '\r' or '\n' met. The string is made of a series of
words delimited by spaces, tabs or commas in any order, each consisting of :

- An ASCII representation of a positive integer percentage, e.g. &quot;75%&quot;.
  Values in this format will set the weight proportional to the initial
  weight of a server as configured when HAProxy starts. Note that a zero
  weight is reported on the stats page as &quot;DRAIN&quot; since it has the same
  effect on the server (it's removed from the LB farm). It is the legacy way
  to set the weight of a server. Setting it with the &quot;weight:&quot; prefix is
  preferred.

- The string &quot;weight:&quot; following by an positive interger or a positive
  interger percentage, with no space. If the value ends with the '%' sign,
  then the new weight will be proportional to the initially weight of the
  server. Otherwise, the value is considered as an absolute weight and must
  be between 0 and 256. Servers which are part of a farm running a static
  load-balancing algorithm have stricter limitations because the weight
  cannot change once set. Thus for these servers, the only accepted values
  are 0 and 100% (or 0 and the initial weight). Changes take effect
  immediately, though certain LB algorithms require a certain amount of
  requests to consider changes. Note that a zero weight is reported on the
  stats page as &quot;DRAIN&quot; since it has the same effect on the server (it's
  removed from the LB farm).

- The string &quot;maxconn:&quot; followed by an integer (no space between). Values
  in this format will set the maxconn of a server. The maximum number of
  connections advertised needs to be multiplied by the number of load
  balancers and different backends that use this health check to get the
  total number of connections the server might receive. Example: maxconn:30

- The word &quot;ready&quot;. This will turn the server's administrative state to the
  READY mode, thus canceling any DRAIN or MAINT state

- The word &quot;drain&quot;. This will turn the server's administrative state to the
  DRAIN mode, thus it will not accept any new connections other than those
  that are accepted via persistence.

- The word &quot;maint&quot;. This will turn the server's administrative state to the
  MAINT mode, thus it will not accept any new connections at all, and health
  checks will be stopped.

- The words &quot;down&quot;, &quot;fail&quot;, or &quot;stopped&quot;, optionally followed by a
  description string after a sharp ('#'). All of these mark the server's
  operating state as DOWN, but since the word itself is reported on the stats
  page, the difference allows an administrator to know if the situation was
  expected or not : the service may intentionally be stopped, may appear up
  but fail some validity tests, or may be seen as down (e.g. missing process,
  or port not responding).

- The word &quot;up&quot; sets back the server's operating state as UP if health checks
  also report that the service is accessible.

Parameters which are not advertised by the agent are not changed. For
example, an agent might be designed to monitor CPU usage and only report a
relative weight and never interact with the operating status. Similarly, an
agent could be designed as an end-user interface with 3 radio buttons
allowing an administrator to change only the administrative state. However,
it is important to consider that only the agent may revert its own actions,
so if a server is set to DRAIN mode or to DOWN state using the agent, the
agent must implement the other equivalent actions to bring the service into
operations again.

Failure to connect to the agent is not considered an error as connectivity
is tested by the regular health check which is enabled by the &quot;<a href="#check">check</a>&quot;
parameter. Warning though, it is not a good idea to stop an agent after it
reports &quot;down&quot;, since only an agent reporting &quot;up&quot; will be able to turn the
server up again. Note that the CLI on the Unix stats socket is also able to
force an agent's result in order to work around a bogus agent if needed.

Requires the &quot;<a href="#agent-port">agent-port</a>&quot; parameter to be set. See also the &quot;<a href="#agent-inter">agent-inter</a>&quot;
and &quot;<a href="#no-agent-check">no-agent-check</a>&quot; parameters.
</pre><a class="anchor" name="agent-send"></a><a class="anchor" name="5-agent-send"></a><a class="anchor" name="5.2-agent-send"></a><a class="anchor" name="agent-send (Bind and server options)"></a><a class="anchor" name="agent-send (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="agent-send"></a><a href="#5.2-agent-send">agent-send</a></b> <span style="color: #080">&lt;string&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

If this option is specified, HAProxy will send the given string (verbatim)
to the agent server upon connection. You could, for example, encode
the backend name into this string, which would enable your agent to send
different responses based on the backend. Make sure to include a '\n' if
you want to terminate your request with a newline.
</pre><a class="anchor" name="agent-inter"></a><a class="anchor" name="5-agent-inter"></a><a class="anchor" name="5.2-agent-inter"></a><a class="anchor" name="agent-inter (Bind and server options)"></a><a class="anchor" name="agent-inter (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="agent-inter"></a><a href="#5.2-agent-inter">agent-inter</a></b> <span style="color: #080">&lt;delay&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

The &quot;<a href="#agent-inter">agent-inter</a>&quot; parameter sets the interval between two agent checks
to &lt;delay&gt; milliseconds. If left unspecified, the delay defaults to 2000 ms.

Just as with every other time-based parameter, it may be entered in any
other explicit unit among { us, ms, s, m, h, d }. The &quot;<a href="#agent-inter">agent-inter</a>&quot;
parameter also serves as a timeout for agent checks &quot;<a href="#timeout%20check">timeout check</a>&quot; is
not set. In order to reduce &quot;resonance&quot; effects when multiple servers are
hosted on the same hardware, the agent and health checks of all servers
are started with a small time offset between them. It is also possible to
add some random noise in the agent and health checks interval using the
global &quot;<a href="#spread-checks">spread-checks</a>&quot; keyword. This makes sense for instance when a lot
of backends use the same servers.

See also the &quot;<a href="#agent-check">agent-check</a>&quot; and &quot;<a href="#agent-port">agent-port</a>&quot; parameters.
</pre><a class="anchor" name="agent-addr"></a><a class="anchor" name="5-agent-addr"></a><a class="anchor" name="5.2-agent-addr"></a><a class="anchor" name="agent-addr (Bind and server options)"></a><a class="anchor" name="agent-addr (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="agent-addr"></a><a href="#5.2-agent-addr">agent-addr</a></b> <span style="color: #080">&lt;addr&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

The &quot;<a href="#agent-addr">agent-addr</a>&quot; parameter sets address for agent check.

You can offload agent-check to another target, so you can make single place
managing status and weights of servers defined in HAProxy in case you can't
make self-aware and self-managing services. You can specify both IP or
hostname, it will be resolved.
</pre><a class="anchor" name="agent-port"></a><a class="anchor" name="5-agent-port"></a><a class="anchor" name="5.2-agent-port"></a><a class="anchor" name="agent-port (Bind and server options)"></a><a class="anchor" name="agent-port (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="agent-port"></a><a href="#5.2-agent-port">agent-port</a></b> <span style="color: #080">&lt;port&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

The &quot;<a href="#agent-port">agent-port</a>&quot; parameter sets the TCP port used for agent checks.

See also the &quot;<a href="#agent-check">agent-check</a>&quot; and &quot;<a href="#agent-inter">agent-inter</a>&quot; parameters.
</pre><a class="anchor" name="allow-0rtt"></a><a class="anchor" name="5-allow-0rtt"></a><a class="anchor" name="5.2-allow-0rtt"></a><a class="anchor" name="allow-0rtt (Bind and server options)"></a><a class="anchor" name="allow-0rtt (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="allow-0rtt"></a><a href="#5.2-allow-0rtt">allow-0rtt</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

Allow sending early data to the server when using TLS 1.3.
Note that early data will be sent only if the client used early data, or
if the backend uses &quot;<a href="#retry-on">retry-on</a>&quot; with the &quot;0rtt-rejected&quot; keyword.
</pre><a class="anchor" name="alpn"></a><a class="anchor" name="5-alpn"></a><a class="anchor" name="5.2-alpn"></a><a class="anchor" name="alpn (Bind and server options)"></a><a class="anchor" name="alpn (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="alpn"></a><a href="#5.2-alpn">alpn</a></b> <span style="color: #080">&lt;protocols&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http

This enables the TLS ALPN extension and advertises the specified protocol
list as supported on top of ALPN. The protocol list consists in a comma-
delimited list of protocol names, for instance: &quot;http/1.1,http/1.0&quot; (without
quotes). This requires that the SSL library is built with support for TLS
extensions enabled (check with haproxy -vv). The ALPN extension replaces the
initial NPN extension. ALPN is required to connect to HTTP/2 servers.
Versions of OpenSSL prior to 1.0.2 didn't support ALPN and only supposed the
now obsolete NPN extension.
If both HTTP/2 and HTTP/1.1 are expected to be supported, both versions can
be advertised, in order of preference, like below :

     server 127.0.0.1:443 ssl crt pub.pem alpn h2,http/1.1

See also &quot;<a href="#ws">ws</a>&quot; to use an alternative ALPN for websocket streams.
</pre><a class="anchor" name="backup"></a><a class="anchor" name="5-backup"></a><a class="anchor" name="5.2-backup"></a><a class="anchor" name="backup (Bind and server options)"></a><a class="anchor" name="backup (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="backup"></a><a href="#5.2-backup">backup</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log

When &quot;<a href="#backup">backup</a>&quot; is present on a server line, the server is only used in load
balancing when all other non-backup servers are unavailable. Requests coming
with a persistence cookie referencing the server will always be served
though. By default, only the first operational backup server is used, unless
the &quot;<a href="#option%20allbackups">allbackups</a>&quot; option is set in the backend. See also the &quot;<a href="#no-backup">no-backup</a>&quot; and
&quot;<a href="#option%20allbackups">allbackups</a>&quot; options.
</pre><a class="anchor" name="ca-file"></a><a class="anchor" name="5-ca-file"></a><a class="anchor" name="5.2-ca-file"></a><a class="anchor" name="ca-file (Bind and server options)"></a><a class="anchor" name="ca-file (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="ca-file"></a><a href="#5.2-ca-file">ca-file</a></b> <span style="color: #080">&lt;cafile&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This setting is only available when support for OpenSSL was built in. It
designates a PEM file from which to load CA certificates used to verify
server's certificate. It is possible to load a directory containing multiple
CAs, in this case HAProxy will try to load every &quot;.pem&quot;, &quot;.crt&quot;, &quot;.cer&quot;, and
.crl&quot; available in the directory, files starting with a dot are ignored.

In order to use the trusted CAs of your system, the &quot;@system-ca&quot; parameter
could be used in place of the cafile. The location of this directory could be
overwritten by setting the SSL_CERT_DIR environment variable.
</pre><a class="anchor" name="check"></a><a class="anchor" name="5-check"></a><a class="anchor" name="5.2-check"></a><a class="anchor" name="check (Bind and server options)"></a><a class="anchor" name="check (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="check"></a><a href="#5.2-check">check</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log

This option enables health checks on a server:
  - when not set, no health checking is performed, and the server is always
    considered available.
  - when set and no other check method is configured, the server is considered
    available when a connection can be established at the highest configured
    transport layer. This means TCP by default, or SSL/TLS when &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; or
    &quot;<a href="#check-ssl">check-ssl</a>&quot; are set, both possibly combined with connection prefixes such
    as a PROXY protocol header when &quot;<a href="#send-proxy">send-proxy</a>&quot; or &quot;<a href="#check-send-proxy">check-send-proxy</a>&quot; are
    set. This behavior is slightly different for dynamic servers, read the
    following paragraphs for more details.
  - when set and an application-level health check is defined, the
    application-level exchanges are performed on top of the configured
    transport layer and the server is considered available if all of the
    exchanges succeed.

By default, health checks are performed on the same address and port as
configured on the server, using the same encapsulation parameters (SSL/TLS,
proxy-protocol header, etc... ). It is possible to change the destination
address using &quot;<a href="#addr">addr</a>&quot; and the port using &quot;<a href="#port">port</a>&quot;. When done, it is assumed the
server isn't checked on the service port, and configured encapsulation
parameters are not reused. One must explicitly set &quot;<a href="#check-send-proxy">check-send-proxy</a>&quot; to send
connection headers, &quot;<a href="#check-ssl">check-ssl</a>&quot; to use SSL/TLS.

Note that the implicit configuration of ssl and PROXY protocol is not
performed for dynamic servers. In this case, it is required to explicitly
use &quot;<a href="#check-ssl">check-ssl</a>&quot; and &quot;<a href="#check-send-proxy">check-send-proxy</a>&quot; when wanted, even if the check port is
not overridden.

When &quot;<a href="#sni">sni</a>&quot; or &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">alpn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#alpn%20%28Bind%20options%29">Bind options</a></li><li><a href="#alpn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; are set on the server line, their value is not used for
health checks and one must use &quot;<a href="#check-sni">check-sni</a>&quot; or &quot;<a href="#check-alpn">check-alpn</a>&quot;.

The default source address for health check traffic is the same as the one
defined in the backend. It can be changed with the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">source<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#source%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#source%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword.

The interval between checks can be set using the &quot;<a href="#inter">inter</a>&quot; keyword, and the
&quot;<a href="#rise">rise</a>&quot; and &quot;<a href="#fall">fall</a>&quot; keywords can be used to define how many successful or
failed health checks are required to flag a server available or not
available.

Optional application-level health checks can be configured with &quot;option
httpchk&quot;, &quot;<a href="#option%20mysql-check">option mysql-check</a>&quot; &quot;<a href="#option%20smtpchk">option smtpchk</a>&quot;, &quot;<a href="#option%20pgsql-check">option pgsql-check</a>&quot;,
&quot;<a href="#option%20ldap-check">option ldap-check</a>&quot;, or &quot;<a href="#option%20redis-check">option redis-check</a>&quot;.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># simple tcp check</span>
backend foo
  server s1 192.168.0.1:80 check
<span class="comment"># this does a tcp connect + tls handshake</span>
backend foo
  server s1 192.168.0.1:443 ssl check
<span class="comment"># simple tcp check is enough for check success</span>
backend foo
  option tcp-check
  tcp-check connect
  server s1 192.168.0.1:443 ssl check
</code></pre>
</div><a class="anchor" name="check-send-proxy"></a><a class="anchor" name="5-check-send-proxy"></a><a class="anchor" name="5.2-check-send-proxy"></a><a class="anchor" name="check-send-proxy (Bind and server options)"></a><a class="anchor" name="check-send-proxy (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="check-send-proxy"></a><a href="#5.2-check-send-proxy">check-send-proxy</a></b></div><pre class="text">May be used in the following contexts: tcp, http

This option forces emission of a PROXY protocol line with outgoing health
checks, regardless of whether the server uses send-proxy or not for the
normal traffic. By default, the PROXY protocol is enabled for health checks
if it is already enabled for normal traffic and if no &quot;<a href="#port">port</a>&quot; nor &quot;<a href="#addr">addr</a>&quot;
directive is present. However, if such a directive is present, the
&quot;<a href="#check-send-proxy">check-send-proxy</a>&quot; option needs to be used to force the use of the
protocol. See also the &quot;<a href="#send-proxy">send-proxy</a>&quot; option for more information.
</pre><a class="anchor" name="check-alpn"></a><a class="anchor" name="5-check-alpn"></a><a class="anchor" name="5.2-check-alpn"></a><a class="anchor" name="check-alpn (Bind and server options)"></a><a class="anchor" name="check-alpn (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="check-alpn"></a><a href="#5.2-check-alpn">check-alpn</a></b> <span style="color: #080">&lt;protocols&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http

Defines which protocols to advertise with ALPN. The protocol list consists in
a comma-delimited list of protocol names, for instance: &quot;http/1.1,http/1.0&quot;
(without quotes). If it is not set, the server ALPN is used.
</pre><a class="anchor" name="check-proto"></a><a class="anchor" name="5-check-proto"></a><a class="anchor" name="5.2-check-proto"></a><a class="anchor" name="check-proto (Bind and server options)"></a><a class="anchor" name="check-proto (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="check-proto"></a><a href="#5.2-check-proto">check-proto</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http

Forces the multiplexer's protocol to use for the server's health-check
connections. It must be compatible with the health-check type (TCP or
HTTP). It must also be usable on the backend side. The list of available
protocols is reported in haproxy -vv. The protocols properties are
reported : the mode (TCP/HTTP), the side (FE/BE), the mux name and its flags.

Some protocols are subject to the head-of-line blocking on server side
(flag=HOL_RISK). Finally some protocols don't support upgrades (flag=NO_UPG).
The HTX compatibility is also reported (flag=HTX).

Here are the protocols that may be used as argument to a &quot;<a href="#check-proto">check-proto</a>&quot;
directive on a server line:

  h2   : mode=HTTP  side=FE|BE  mux=H2    flags=HTX|HOL_RISK|NO_UPG
  fcgi : mode=HTTP  side=BE     mux=FCGI  flags=HTX|HOL_RISK|NO_UPG
  h1   : mode=HTTP  side=FE|BE  mux=H1    flags=HTX|NO_UPG
  none : mode=TCP   side=FE|BE  mux=PASS  flags=NO_UPG

Idea behind this option is to bypass the selection of the best multiplexer's
protocol for health-check connections established to this server.
If not defined, the server one will be used, if set.
</pre><a class="anchor" name="check-sni"></a><a class="anchor" name="5-check-sni"></a><a class="anchor" name="5.2-check-sni"></a><a class="anchor" name="check-sni (Bind and server options)"></a><a class="anchor" name="check-sni (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="check-sni"></a><a href="#5.2-check-sni">check-sni</a></b> <span style="color: #080">&lt;sni&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

This option allows you to specify the SNI to be used when doing health checks
over SSL. It is only possible to use a string to set &lt;sni&gt;. If you want to
set a SNI for proxied traffic, see &quot;<a href="#sni">sni</a>&quot;.
</pre><a class="anchor" name="check-ssl"></a><a class="anchor" name="5-check-ssl"></a><a class="anchor" name="5.2-check-ssl"></a><a class="anchor" name="check-ssl (Bind and server options)"></a><a class="anchor" name="check-ssl (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="check-ssl"></a><a href="#5.2-check-ssl">check-ssl</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log

This option forces encryption of all health checks over SSL, regardless of
whether the server uses SSL or not for the normal traffic. This is generally
used when an explicit &quot;<a href="#port">port</a>&quot; or &quot;<a href="#addr">addr</a>&quot; directive is specified and SSL health
checks are not inherited. It is important to understand that this option
inserts an SSL transport layer below the checks, so that a simple TCP connect
check becomes an SSL connect, which replaces the old ssl-hello-chk. The most
common use is to send HTTPS checks by combining &quot;<a href="#option%20httpchk">httpchk</a>&quot; with SSL checks.
All SSL settings are common to health checks and traffic (e.g. ciphers).
See the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; option for more information and &quot;<a href="#no-check-ssl">no-check-ssl</a>&quot; to disable
this option.
</pre><a class="anchor" name="check-via-socks4"></a><a class="anchor" name="5-check-via-socks4"></a><a class="anchor" name="5.2-check-via-socks4"></a><a class="anchor" name="check-via-socks4 (Bind and server options)"></a><a class="anchor" name="check-via-socks4 (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="check-via-socks4"></a><a href="#5.2-check-via-socks4">check-via-socks4</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log

This option enables outgoing health checks using upstream socks4 proxy. By
default, the health checks won't go through socks tunnel even it was enabled
for normal traffic.
</pre><a class="anchor" name="ciphers"></a><a class="anchor" name="5-ciphers"></a><a class="anchor" name="5.2-ciphers"></a><a class="anchor" name="ciphers (Bind and server options)"></a><a class="anchor" name="ciphers (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="ciphers"></a><a href="#5.2-ciphers">ciphers</a></b> <span style="color: #080">&lt;ciphers&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This setting is only available when support for OpenSSL was built in. This
option sets the string describing the list of cipher algorithms that is
negotiated during the SSL/TLS handshake with the server. The format of the
string is defined in &quot;man 1 ciphers&quot; from OpenSSL man pages. For background
information and recommendations see e.g.
(https://wiki.mozilla.org/Security/Server_Side_TLS) and
(https://mozilla.github.io/server-side-tls/ssl-config-generator/). For TLSv1.3
cipher configuration, please check the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ciphersuites<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ciphersuites%20%28Bind%20options%29">Bind options</a></li><li><a href="#ciphersuites%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword.
</pre><a class="anchor" name="ciphersuites"></a><a class="anchor" name="5-ciphersuites"></a><a class="anchor" name="5.2-ciphersuites"></a><a class="anchor" name="ciphersuites (Bind and server options)"></a><a class="anchor" name="ciphersuites (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="ciphersuites"></a><a href="#5.2-ciphersuites">ciphersuites</a></b> <span style="color: #080">&lt;ciphersuites&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This setting is only available when support for OpenSSL was built in and
OpenSSL 1.1.1 or later was used to build HAProxy. This option sets the string
describing the list of cipher algorithms that is negotiated during the TLS
1.3 handshake with the server. The format of the string is defined in
&quot;man 1 ciphers&quot; from OpenSSL man pages under the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ciphersuites<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ciphersuites%20%28Bind%20options%29">Bind options</a></li><li><a href="#ciphersuites%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; section.
For cipher configuration for TLSv1.2 and earlier, please check the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ciphers<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ciphers%20%28Bind%20options%29">Bind options</a></li><li><a href="#ciphers%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
keyword.
</pre><a class="anchor" name="client-sigalgs"></a><a class="anchor" name="5-client-sigalgs"></a><a class="anchor" name="5.2-client-sigalgs"></a><a class="anchor" name="client-sigalgs (Bind and server options)"></a><a class="anchor" name="client-sigalgs (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="client-sigalgs"></a><a href="#5.2-client-sigalgs">client-sigalgs</a></b> <span style="color: #080">&lt;sigalgs&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This setting is only available when support for OpenSSL was built in. It sets
the string describing the list of signature algorithms related to client
authentication that are negotiated . The format of the string is defined in
&quot;man 3 SSL_CTX_set1_client_sigalgs&quot; from the OpenSSL man pages. It is not
recommended to use this setting if no specific usecase was identified.
</pre><a class="anchor" name="cookie"></a><a class="anchor" name="5-cookie"></a><a class="anchor" name="5.2-cookie"></a><a class="anchor" name="cookie (Bind and server options)"></a><a class="anchor" name="cookie (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="cookie"></a><a href="#5.2-cookie">cookie</a></b> <span style="color: #080">&lt;value&gt;</span></div><pre class="text">May be used in the following contexts: http

The &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">cookie<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#cookie%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#cookie%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li><li><a href="#cookie%20%28Fetching%20HTTP%20samples%20%28Layer%207%29%29">Fetching HTTP samples (Layer 7)</a></li></ul></span>&quot; parameter sets the cookie value assigned to the server to
&lt;value&gt;. This value will be checked in incoming requests, and the first
operational server possessing the same value will be selected. In return, in
cookie insertion or rewrite modes, this value will be assigned to the cookie
sent to the client. There is nothing wrong in having several servers sharing
the same cookie value, and it is in fact somewhat common between normal and
backup servers. See also the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">cookie<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#cookie%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#cookie%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li><li><a href="#cookie%20%28Fetching%20HTTP%20samples%20%28Layer%207%29%29">Fetching HTTP samples (Layer 7)</a></li></ul></span>&quot; keyword in backend section.
</pre><a class="anchor" name="crl-file"></a><a class="anchor" name="5-crl-file"></a><a class="anchor" name="5.2-crl-file"></a><a class="anchor" name="crl-file (Bind and server options)"></a><a class="anchor" name="crl-file (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="crl-file"></a><a href="#5.2-crl-file">crl-file</a></b> <span style="color: #080">&lt;crlfile&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This setting is only available when support for OpenSSL was built in. It
designates a PEM file from which to load certificate revocation list used
to verify server's certificate.
</pre><a class="anchor" name="crt"></a><a class="anchor" name="5-crt"></a><a class="anchor" name="5.2-crt"></a><a class="anchor" name="crt (Bind and server options)"></a><a class="anchor" name="crt (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="crt"></a><a href="#5.2-crt">crt</a></b> <span style="color: #080">&lt;cert&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This setting is only available when support for OpenSSL was built in.
It designates a PEM file from which to load both a certificate and the
associated private key. This file can be built by concatenating both PEM
files into one. This certificate will be sent if the server send a client
certificate request.

If the file does not contain a private key, HAProxy will try to load the key
at the same path suffixed by a &quot;.key&quot; (provided the &quot;<a href="#ssl-load-extra-files">ssl-load-extra-files</a>&quot;
option is set accordingly).
</pre><a class="anchor" name="curves"></a><a class="anchor" name="5-curves"></a><a class="anchor" name="5.2-curves"></a><a class="anchor" name="curves (Bind and server options)"></a><a class="anchor" name="curves (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="curves"></a><a href="#5.2-curves">curves</a></b> <span style="color: #080">&lt;curves&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This setting is only available when support for OpenSSL was built in. It sets
the string describing the list of elliptic curves algorithms (&quot;curve suite&quot;)
that are negotiated during the SSL/TLS handshake with ECDHE. The format of the
string is a colon-delimited list of curve name.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<div class="example-desc">&quot;X25519:P-256&quot; (without quote)</div><code></code></pre>
</div><a class="anchor" name="disabled"></a><a class="anchor" name="5-disabled"></a><a class="anchor" name="5.2-disabled"></a><a class="anchor" name="disabled (Bind and server options)"></a><a class="anchor" name="disabled (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="disabled"></a><a href="#5.2-disabled">disabled</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log

The &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">disabled<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#disabled%20%28Peers%29">Peers</a></li><li><a href="#disabled%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#disabled%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword starts the server in the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">disabled<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#disabled%20%28Peers%29">Peers</a></li><li><a href="#disabled%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#disabled%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; state. That means
that it is marked down in maintenance mode, and no connection other than the
ones allowed by persist mode will reach it. It is very well suited to setup
new servers, because normal traffic will never reach them, while it is still
possible to test the service by making use of the force-persist mechanism.
See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">enabled<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#enabled%20%28Peers%29">Peers</a></li><li><a href="#enabled%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#enabled%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; setting.
</pre><a class="anchor" name="enabled"></a><a class="anchor" name="5-enabled"></a><a class="anchor" name="5.2-enabled"></a><a class="anchor" name="enabled (Bind and server options)"></a><a class="anchor" name="enabled (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="enabled"></a><a href="#5.2-enabled">enabled</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log

This option may be used as 'server' setting to reset any 'disabled'
setting which would have been inherited from 'default-server' directive as
default value.
It may also be used as 'default-server' setting to reset any previous
'default-server' 'disabled' setting.
</pre><a class="anchor" name="error-limit"></a><a class="anchor" name="5-error-limit"></a><a class="anchor" name="5.2-error-limit"></a><a class="anchor" name="error-limit (Bind and server options)"></a><a class="anchor" name="error-limit (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="error-limit"></a><a href="#5.2-error-limit">error-limit</a></b> <span style="color: #080">&lt;count&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

If health observing is enabled, the &quot;<a href="#error-limit">error-limit</a>&quot; parameter specifies the
number of consecutive errors that triggers event selected by the &quot;<a href="#on-error">on-error</a>&quot;
option. By default it is set to 10 consecutive errors.

See also the &quot;<a href="#check">check</a>&quot;, &quot;<a href="#error-limit">error-limit</a>&quot; and &quot;<a href="#on-error">on-error</a>&quot;.
</pre><a class="anchor" name="fall"></a><a class="anchor" name="5-fall"></a><a class="anchor" name="5.2-fall"></a><a class="anchor" name="fall (Bind and server options)"></a><a class="anchor" name="fall (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="fall"></a><a href="#5.2-fall">fall</a></b> <span style="color: #080">&lt;count&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

The &quot;<a href="#fall">fall</a>&quot; parameter states that a server will be considered as dead after
&lt;count&gt; consecutive unsuccessful health checks. This value defaults to 3 if
unspecified. See also the &quot;<a href="#check">check</a>&quot;, &quot;<a href="#inter">inter</a>&quot; and &quot;<a href="#rise">rise</a>&quot; parameters.
</pre><a class="anchor" name="force-sslv3"></a><a class="anchor" name="5-force-sslv3"></a><a class="anchor" name="5.2-force-sslv3"></a><a class="anchor" name="force-sslv3 (Bind and server options)"></a><a class="anchor" name="force-sslv3 (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="force-sslv3"></a><a href="#5.2-force-sslv3">force-sslv3</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option enforces use of SSLv3 only when SSL is used to communicate with
the server. SSLv3 is generally less expensive than the TLS counterparts for
high connection rates. This option is also available on global statement
&quot;<a href="#ssl-default-server-options">ssl-default-server-options</a>&quot;. See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and ssl-max-ver&quot;.
</pre><a class="anchor" name="force-tlsv10"></a><a class="anchor" name="5-force-tlsv10"></a><a class="anchor" name="5.2-force-tlsv10"></a><a class="anchor" name="force-tlsv10 (Bind and server options)"></a><a class="anchor" name="force-tlsv10 (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="force-tlsv10"></a><a href="#5.2-force-tlsv10">force-tlsv10</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option enforces use of TLSv1.0 only when SSL is used to communicate with
the server. This option is also available on global statement
&quot;<a href="#ssl-default-server-options">ssl-default-server-options</a>&quot;. See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and ssl-max-ver&quot;.
</pre><a class="anchor" name="force-tlsv11"></a><a class="anchor" name="5-force-tlsv11"></a><a class="anchor" name="5.2-force-tlsv11"></a><a class="anchor" name="force-tlsv11 (Bind and server options)"></a><a class="anchor" name="force-tlsv11 (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="force-tlsv11"></a><a href="#5.2-force-tlsv11">force-tlsv11</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option enforces use of TLSv1.1 only when SSL is used to communicate with
the server. This option is also available on global statement
&quot;<a href="#ssl-default-server-options">ssl-default-server-options</a>&quot;. See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and ssl-max-ver&quot;.
</pre><a class="anchor" name="force-tlsv12"></a><a class="anchor" name="5-force-tlsv12"></a><a class="anchor" name="5.2-force-tlsv12"></a><a class="anchor" name="force-tlsv12 (Bind and server options)"></a><a class="anchor" name="force-tlsv12 (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="force-tlsv12"></a><a href="#5.2-force-tlsv12">force-tlsv12</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option enforces use of TLSv1.2 only when SSL is used to communicate with
the server. This option is also available on global statement
&quot;<a href="#ssl-default-server-options">ssl-default-server-options</a>&quot;. See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and ssl-max-ver&quot;.
</pre><a class="anchor" name="force-tlsv13"></a><a class="anchor" name="5-force-tlsv13"></a><a class="anchor" name="5.2-force-tlsv13"></a><a class="anchor" name="force-tlsv13 (Bind and server options)"></a><a class="anchor" name="force-tlsv13 (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="force-tlsv13"></a><a href="#5.2-force-tlsv13">force-tlsv13</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option enforces use of TLSv1.3 only when SSL is used to communicate with
the server. This option is also available on global statement
&quot;<a href="#ssl-default-server-options">ssl-default-server-options</a>&quot;. See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and ssl-max-ver&quot;.
</pre><a class="anchor" name="guid"></a><a class="anchor" name="5-guid"></a><a class="anchor" name="5.2-guid"></a><a class="anchor" name="guid (Bind and server options)"></a><a class="anchor" name="guid (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="guid"></a><a href="#5.2-guid">guid</a></b> <span style="color: #080">&lt;string&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

Specify a case-sensitive global unique ID for this server. This must be
unique across all haproxy configuration on every object types. See &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">guid<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#guid%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#guid%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
proxy keyword description for more information on its format.
</pre><a class="anchor" name="hash-key"></a><a class="anchor" name="5-hash-key"></a><a class="anchor" name="5.2-hash-key"></a><a class="anchor" name="hash-key (Bind and server options)"></a><a class="anchor" name="hash-key (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="hash-key"></a><a href="#5.2-hash-key">hash-key</a></b> <span style="color: #080">&lt;key&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

Specify how &quot;hash-type consistent&quot; node keys are computed
</pre><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;key&gt;   &lt;key&gt; may be one of the following :

  id         The node keys will be derived from the server's numeric
             identifier as set from &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">id<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#id%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#id%20%28Bind%20options%29">Bind options</a></li><li><a href="#id%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; or which defaults to its position
             in the server list.

  addr       The node keys will be derived from the server's address, when
             available, or else fall back on &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">id<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#id%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#id%20%28Bind%20options%29">Bind options</a></li><li><a href="#id%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;.

  addr-port  The node keys will be derived from the server's address and
             port, when available, or else fall back on &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">id<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#id%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#id%20%28Bind%20options%29">Bind options</a></li><li><a href="#id%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;.</pre>
</div>
<pre class="text">The &quot;<a href="#addr">addr</a>&quot; and &quot;addr-port&quot; options may be useful in scenarios where multiple
HAProxy processes are balancing traffic to the same set of servers. If the
server order of each process is different (because, for example, DNS records
were resolved in different orders) then this will allow each independent
HAProxy processes to agree on routing decisions.
</pre><a class="anchor" name="id"></a><a class="anchor" name="5-id"></a><a class="anchor" name="5.2-id"></a><a class="anchor" name="id (Bind and server options)"></a><a class="anchor" name="id (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="id"></a><a href="#5.2-id">id</a></b> <span style="color: #080">&lt;value&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

Set a persistent ID for the server. This ID must be positive and unique for
the proxy. An unused ID will automatically be assigned if unset. The first
assigned value will be 1. This ID is currently only returned in statistics.
</pre><a class="anchor" name="init-addr"></a><a class="anchor" name="5-init-addr"></a><a class="anchor" name="5.2-init-addr"></a><a class="anchor" name="init-addr (Bind and server options)"></a><a class="anchor" name="init-addr (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="init-addr"></a><a href="#5.2-init-addr">init-addr</a></b> <span style="color: #800">{last | libc | none | <span style="color: #080">&lt;ip&gt;</span>}</span>,<span style="color: #008">[...]</span>*</div><pre class="text">May be used in the following contexts: tcp, http, log

Indicate in what order the server's address should be resolved upon startup
if it uses an FQDN. Attempts are made to resolve the address by applying in
turn each of the methods mentioned in the comma-delimited list. The first
method which succeeds is used. If the end of the list is reached without
finding a working method, an error is thrown. Method &quot;last&quot; suggests to pick
the address which appears in the state file (see &quot;<a href="#server-state-file">server-state-file</a>&quot;). Method
&quot;libc&quot; uses the libc's internal resolver (gethostbyname() or getaddrinfo()
depending on the operating system and build options). Method &quot;none&quot;
specifically indicates that the server should start without any valid IP
address in a down state. It can be useful to ignore some DNS issues upon
startup, waiting for the situation to get fixed later. Finally, an IP address
(IPv4 or IPv6) may be provided. It can be the currently known address of the
server (e.g. filled by a configuration generator), or the address of a dummy
server used to catch old sessions and present them with a decent error
message for example. When the &quot;first&quot; load balancing algorithm is used, this
IP address could point to a fake server used to trigger the creation of new
instances on the fly. This option defaults to &quot;last,libc&quot; indicating that the
previous address found in the state file (if any) is used first, otherwise
the libc's resolver is used. This ensures continued compatibility with the
historic behavior.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>defaults
    <span class="comment"># never fail on address resolution</span>
    default-server init-addr last,libc,none
</code></pre>
</div><a class="anchor" name="inter"></a><a class="anchor" name="5-inter"></a><a class="anchor" name="5.2-inter"></a><a class="anchor" name="inter (Bind and server options)"></a><a class="anchor" name="inter (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="inter"></a><a href="#5.2-inter">inter</a></b> <span style="color: #080">&lt;delay&gt;</span></div><a class="anchor" name="fastinter"></a><a class="anchor" name="5-fastinter"></a><a class="anchor" name="5.2-fastinter"></a><a class="anchor" name="fastinter (Bind and server options)"></a><a class="anchor" name="fastinter (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="fastinter"></a><a href="#5.2-fastinter">fastinter</a></b> <span style="color: #080">&lt;delay&gt;</span></div><a class="anchor" name="downinter"></a><a class="anchor" name="5-downinter"></a><a class="anchor" name="5.2-downinter"></a><a class="anchor" name="downinter (Bind and server options)"></a><a class="anchor" name="downinter (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="downinter"></a><a href="#5.2-downinter">downinter</a></b> <span style="color: #080">&lt;delay&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

The &quot;<a href="#inter">inter</a>&quot; parameter sets the interval between two consecutive health checks
to &lt;delay&gt; milliseconds. If left unspecified, the delay defaults to 2000 ms.
It is also possible to use &quot;<a href="#fastinter">fastinter</a>&quot; and &quot;<a href="#downinter">downinter</a>&quot; to optimize delays
between checks depending on the server state :
</pre><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>Server state</th><th>Interval used</th></tr></thead>
<tr><td >UP 100% (non-transitional)</td><td >&quot;<a href="#inter">inter</a>&quot;</td></tr>
<tr><td >Transitionally UP (going down &quot;<a href="#fall">fall</a>&quot;),<br />Transitionally DOWN (going up &quot;<a href="#rise">rise</a>&quot;),<br />or yet unchecked.</td><td >&quot;<a href="#fastinter">fastinter</a>&quot; if set,<br />&quot;<a href="#inter">inter</a>&quot; otherwise.<br /></td></tr>
<tr><td >DOWN 100% (non-transitional)<br /></td><td >&quot;<a href="#downinter">downinter</a>&quot; if set,<br />&quot;<a href="#inter">inter</a>&quot; otherwise.</td></tr>
</table><pre class="text">Just as with every other time-based parameter, they can be entered in any
other explicit unit among { us, ms, s, m, h, d }. The &quot;<a href="#inter">inter</a>&quot; parameter also
serves as a timeout for health checks sent to servers if &quot;<a href="#timeout%20check">timeout check</a>&quot; is
not set. In order to reduce &quot;resonance&quot; effects when multiple servers are
hosted on the same hardware, the agent and health checks of all servers
are started with a small time offset between them. It is also possible to
add some random noise in the agent and health checks interval using the
global &quot;<a href="#spread-checks">spread-checks</a>&quot; keyword. This makes sense for instance when a lot
of backends use the same servers. The global &quot;<a href="#tune.max-checks-per-thread">tune.max-checks-per-thread</a>&quot;
setting, if defined to a non-nul value, will limit the number of concurrent
checks being performed at once on any given thread. In order to achieve this,
haproxy will put in a queue the checks that were about to start on a thread
that has reached this limit, until another check finishes. This will have for
effect to extend the effective check interval. In such a case, reducing the
&quot;<a href="#inter">inter</a>&quot; setting will have a very limited effect as it will not be able to
reduce the time spent in the queue.
</pre><a class="anchor" name="init-state"></a><a class="anchor" name="5-init-state"></a><a class="anchor" name="5.2-init-state"></a><a class="anchor" name="init-state (Bind and server options)"></a><a class="anchor" name="init-state (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="init-state"></a><a href="#5.2-init-state">init-state</a></b> <span style="color: #800">{ fully-up | up | down | fully-down }</span></div><pre class="text">May be used in the following contexts: tcp, http
</pre><div><p>  May be used in sections  :</p><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>defaults</th><th>frontend</th><th>listen</th><th>backend</th></tr></thead>
<tr><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-error pagination-centered">no<br /><img src="../css/cross.png" alt="no" title="no" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td><td class="alert-success pagination-centered">yes<br /><img src="../css/check.png" alt="yes" title="yes" /></td></tr>
</table></div>
<pre class="text">The &quot;<a href="#init-state">init-state</a>&quot; option sets the initial state of the server:
  - when set to 'fully-up', the server is considered immediately available
    and can turn to the DOWN sate when ALL health checks fail.
  - when set to 'up' (the default), the server is considered immediately
    available and will initiate a health check that can turn it to the DOWN
    state immediately if it fails.
  - when set to 'down', the server initially is considered unavailable and
    will initiate a health check that can turn it to the UP state immediately
    if it succeeds.
  - when set to 'fully-down', the server is initially considered unavailable
    and can turn to the UP state when ALL health checks succeed.

The server's init-state is considered when the HAProxy instance is
(re)started, a new server is detected (for example via service discovery /
DNS resolution), a dynamic server is inlived, a server exits maintenance,
etc.
</pre><div class="separator">
<span class="label label-success">Examples:</span>
<pre class="prettyprint">
<code><span class="comment"># pass client traffic ONLY to Redis &quot;master&quot; node</span>
backend redis-master
  mode tcp
  balance first
  option tcp-check
  tcp-check send role\r\n
  tcp-check expect string master
  server-template redis 3 _redis._tcp.redis-headless-service.sandbox.svc.cluster.local:6379 check ... init-state down

<span class="comment"># pass traffic to the server only after 3 successful health checks</span>
backend google-backend
  mode http
  server srv1 google.com:80 check init-state fully-down rise 3
  server srv2 google.com:80 check init-state fully-down rise 3
</code></pre>
</div><div class="page-header"><b>See also:</b> &quot;<a href="#option%20tcp-check">option tcp-check</a>&quot;, &quot;<a href="#option%20httpchk">option httpchk</a>&quot;</div>
<a class="anchor" name="log-bufsize"></a><a class="anchor" name="5-log-bufsize"></a><a class="anchor" name="5.2-log-bufsize"></a><a class="anchor" name="log-bufsize (Bind and server options)"></a><a class="anchor" name="log-bufsize (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="log-bufsize"></a><a href="#5.2-log-bufsize">log-bufsize</a></b> <span style="color: #080">&lt;bufsize&gt;</span></div><pre class="text">May be used in the following contexts: log

The &quot;<a href="#log-bufsize">log-bufsize</a>&quot; specifies the ring bufsize to use for the implicit ring
that will be associated to the log server in a log backend. When not
specified, this defaults to BUFSIZE. Use of a greater value will increase
memory usage but can help to prevent the loss of log messages with slow
servers since the buffer will be able to hold more pending messages.
This keyword may only be used in log backend sections (with &quot;mode log&quot;)
</pre><a class="anchor" name="log-proto"></a><a class="anchor" name="5-log-proto"></a><a class="anchor" name="5.2-log-proto"></a><a class="anchor" name="log-proto (Bind and server options)"></a><a class="anchor" name="log-proto (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="log-proto"></a><a href="#5.2-log-proto">log-proto</a></b> <span style="color: #080">&lt;logproto&gt;</span></div><pre class="text">May be used in the following contexts: log, ring

The &quot;<a href="#log-proto">log-proto</a>&quot; specifies the protocol used to forward event messages to
a server configured in a log or ring section. Possible values are &quot;legacy&quot;
and &quot;octet-count&quot; corresponding respectively to &quot;Non-transparent-framing&quot;
and &quot;Octet counting&quot; in rfc6587. &quot;legacy&quot; is the default.
</pre><a class="anchor" name="maxconn"></a><a class="anchor" name="5-maxconn"></a><a class="anchor" name="5.2-maxconn"></a><a class="anchor" name="maxconn (Bind and server options)"></a><a class="anchor" name="maxconn (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="maxconn"></a><a href="#5.2-maxconn">maxconn</a></b> <span style="color: #080">&lt;maxconn&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http

The &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; parameter specifies the maximal number of concurrent
connections that will be sent to this server. If the number of incoming
concurrent connections goes higher than this value, they will be queued,
waiting for a slot to be released. This parameter is very important as it can
save fragile servers from going down under extreme loads. If a &quot;<a href="#minconn">minconn</a>&quot;
parameter is specified, the limit becomes dynamic. The default value is &quot;0&quot;
which means unlimited. See also the &quot;<a href="#minconn">minconn</a>&quot; and &quot;<a href="#maxqueue">maxqueue</a>&quot; parameters, and
the backend's &quot;<a href="#fullconn">fullconn</a>&quot; keyword.

In HTTP mode this parameter limits the number of concurrent requests instead
of the number of connections. Multiple requests might be multiplexed over a
single TCP connection to the server. As an example if you specify a maxconn
of 50 you might see between 1 and 50 actual server connections, but no more
than 50 concurrent requests.
</pre><a class="anchor" name="maxqueue"></a><a class="anchor" name="5-maxqueue"></a><a class="anchor" name="5.2-maxqueue"></a><a class="anchor" name="maxqueue (Bind and server options)"></a><a class="anchor" name="maxqueue (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="maxqueue"></a><a href="#5.2-maxqueue">maxqueue</a></b> <span style="color: #080">&lt;maxqueue&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http

The &quot;<a href="#maxqueue">maxqueue</a>&quot; parameter specifies the maximal number of connections which
will wait in the queue for this server. If this limit is reached, next
requests will be redispatched to other servers instead of indefinitely
waiting to be served. This will break persistence but may allow people to
quickly re-log in when the server they try to connect to is dying. Some load
balancing algorithms such as leastconn take this into account and accept to
add requests into a server's queue up to this value if it is explicitly set
to a value greater than zero, which often allows to better smooth the load
when dealing with single-digit maxconn values. The default value is &quot;0&quot; which
means the queue is unlimited. See also the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and &quot;<a href="#minconn">minconn</a>&quot; parameters
and &quot;balance leastconn&quot;.
</pre><a class="anchor" name="max-reuse"></a><a class="anchor" name="5-max-reuse"></a><a class="anchor" name="5.2-max-reuse"></a><a class="anchor" name="max-reuse (Bind and server options)"></a><a class="anchor" name="max-reuse (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="max-reuse"></a><a href="#5.2-max-reuse">max-reuse</a></b> <span style="color: #080">&lt;count&gt;</span></div><pre class="text">May be used in the following contexts: http, ring

When used under http context:

The &quot;<a href="#max-reuse">max-reuse</a>&quot; argument indicates the HTTP connection processors that they
should not reuse a server connection more than this number of times to send
new requests. Permitted values are -1 (the default), which disables this
limit, or any positive value. Value zero will effectively disable keep-alive.
This is only used to work around certain server bugs which cause them to leak
resources over time. The argument is not necessarily respected by the lower
layers as there might be technical limitations making it impossible to
enforce. At least HTTP/2 connections to servers will respect it.

When used under ring context:

The &quot;<a href="#max-reuse">max-reuse</a>&quot; argument indicates that the sink TCP connection processors
that they should not reuse a server connection more than this number of
times to send messages. It means that the connection to the server will be
forcefully destroyed once at least &quot;max-reuse + 1&quot; messages were handled on
the same connection. The connection to the server will then be automatically
re-created. When dealing with a large amount of messages in multithreading
context, this can help to better distribute the ring's load over multiple
threads. Indeed, each connection is bound to the same CPU thread for its
entire duration: unlike HTTP, there is no thing like syslog transaction, so
the server connection could live indefinitely as long as the server doesn't
close the connection or no network error occurs. By destroying connections
from time to time we give the opportunity to other threads to pick-up some
messages in turn. It may also help gracefully rotate log servers in contexts
where there is an extra load-balancing layer between haproxy and the log
servers. However, keep in mind that each connection recycling will leave an
outgoing port in TIME_WAIT state that will not be reusable for around one
minute on modern operating systems, and that as such, one must be careful
not to use too low values to prevent rapid source port exhaustion. As a rule
of thumb, make sure never to close more than a few times per second, and
preferably much less often. Permitted values are -1 (the default), which
disables this limit, or any positive value. Unlike under HTTP context, when
used with sink servers &quot;<a href="#max-reuse">max-reuse</a>&quot; is a best-effort: ring messages are
batched, so the limit is checked between each batch.
</pre><a class="anchor" name="minconn"></a><a class="anchor" name="5-minconn"></a><a class="anchor" name="5.2-minconn"></a><a class="anchor" name="minconn (Bind and server options)"></a><a class="anchor" name="minconn (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="minconn"></a><a href="#5.2-minconn">minconn</a></b> <span style="color: #080">&lt;minconn&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http

When the &quot;<a href="#minconn">minconn</a>&quot; parameter is set, the maxconn limit becomes a dynamic
limit following the backend's load. The server will always accept at least
&lt;minconn&gt; connections, never more than &lt;maxconn&gt;, and the limit will be on
the ramp between both values when the backend has less than &lt;fullconn&gt;
concurrent connections. This makes it possible to limit the load on the
server during normal loads, but push it further for important loads without
overloading the server during exceptional loads. See also the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
and &quot;<a href="#maxqueue">maxqueue</a>&quot; parameters, as well as the &quot;<a href="#fullconn">fullconn</a>&quot; backend keyword.
</pre><a class="anchor" name="namespace"></a><a class="anchor" name="5-namespace"></a><a class="anchor" name="5.2-namespace"></a><a class="anchor" name="namespace (Bind and server options)"></a><a class="anchor" name="namespace (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="namespace"></a><a href="#5.2-namespace">namespace</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

On Linux, it is possible to specify which network namespace a socket will
belong to. This directive makes it possible to explicitly bind a server to
a namespace different from the default one. Please refer to your operating
system's documentation to find more details about network namespaces.
</pre><a class="anchor" name="no-agent-check"></a><a class="anchor" name="5-no-agent-check"></a><a class="anchor" name="5.2-no-agent-check"></a><a class="anchor" name="no-agent-check (Bind and server options)"></a><a class="anchor" name="no-agent-check (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-agent-check"></a><a href="#5.2-no-agent-check">no-agent-check</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log

This option may be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any &quot;<a href="#agent-check">agent-check</a>&quot;
setting which would have been inherited from &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive as
default value.
It may also be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any previous
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; &quot;<a href="#agent-check">agent-check</a>&quot; setting.
</pre><a class="anchor" name="no-backup"></a><a class="anchor" name="5-no-backup"></a><a class="anchor" name="5.2-no-backup"></a><a class="anchor" name="no-backup (Bind and server options)"></a><a class="anchor" name="no-backup (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-backup"></a><a href="#5.2-no-backup">no-backup</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log

This option may be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any &quot;<a href="#backup">backup</a>&quot;
setting which would have been inherited from &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive as
default value.
It may also be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any previous
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; &quot;<a href="#backup">backup</a>&quot; setting.
</pre><a class="anchor" name="no-check"></a><a class="anchor" name="5-no-check"></a><a class="anchor" name="5.2-no-check"></a><a class="anchor" name="no-check (Bind and server options)"></a><a class="anchor" name="no-check (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-check"></a><a href="#5.2-no-check">no-check</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log

This option may be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any &quot;<a href="#check">check</a>&quot;
setting which would have been inherited from &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive as
default value.
It may also be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any previous
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; &quot;<a href="#check">check</a>&quot; setting.
</pre><a class="anchor" name="no-check-ssl"></a><a class="anchor" name="5-no-check-ssl"></a><a class="anchor" name="5.2-no-check-ssl"></a><a class="anchor" name="no-check-ssl (Bind and server options)"></a><a class="anchor" name="no-check-ssl (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-check-ssl"></a><a href="#5.2-no-check-ssl">no-check-ssl</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log

This option may be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any &quot;<a href="#check-ssl">check-ssl</a>&quot;
setting which would have been inherited from &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive as
default value.
It may also be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any previous
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; &quot;<a href="#check-ssl">check-ssl</a>&quot; setting.
</pre><a class="anchor" name="no-send-proxy"></a><a class="anchor" name="5-no-send-proxy"></a><a class="anchor" name="5.2-no-send-proxy"></a><a class="anchor" name="no-send-proxy (Bind and server options)"></a><a class="anchor" name="no-send-proxy (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-send-proxy"></a><a href="#5.2-no-send-proxy">no-send-proxy</a></b></div><pre class="text">May be used in the following contexts: tcp, http

This option may be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any &quot;<a href="#send-proxy">send-proxy</a>&quot;
setting which would have been inherited from &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive as
default value.
It may also be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any previous
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; &quot;<a href="#send-proxy">send-proxy</a>&quot; setting.
</pre><a class="anchor" name="no-send-proxy-v2"></a><a class="anchor" name="5-no-send-proxy-v2"></a><a class="anchor" name="5.2-no-send-proxy-v2"></a><a class="anchor" name="no-send-proxy-v2 (Bind and server options)"></a><a class="anchor" name="no-send-proxy-v2 (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-send-proxy-v2"></a><a href="#5.2-no-send-proxy-v2">no-send-proxy-v2</a></b></div><pre class="text">May be used in the following contexts: tcp, http

This option may be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any &quot;<a href="#send-proxy-v2">send-proxy-v2</a>&quot;
setting which would have been inherited from &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive as
default value.
It may also be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any previous
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; &quot;<a href="#send-proxy-v2">send-proxy-v2</a>&quot; setting.
</pre><a class="anchor" name="no-send-proxy-v2-ssl"></a><a class="anchor" name="5-no-send-proxy-v2-ssl"></a><a class="anchor" name="5.2-no-send-proxy-v2-ssl"></a><a class="anchor" name="no-send-proxy-v2-ssl (Bind and server options)"></a><a class="anchor" name="no-send-proxy-v2-ssl (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-send-proxy-v2-ssl"></a><a href="#5.2-no-send-proxy-v2-ssl">no-send-proxy-v2-ssl</a></b></div><pre class="text">May be used in the following contexts: tcp, http

This option may be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any &quot;<a href="#send-proxy-v2-ssl">send-proxy-v2-ssl</a>&quot;
setting which would have been inherited from &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive as
default value.
It may also be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any previous
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; &quot;<a href="#send-proxy-v2-ssl">send-proxy-v2-ssl</a>&quot; setting.
</pre><a class="anchor" name="no-send-proxy-v2-ssl-cn"></a><a class="anchor" name="5-no-send-proxy-v2-ssl-cn"></a><a class="anchor" name="5.2-no-send-proxy-v2-ssl-cn"></a><a class="anchor" name="no-send-proxy-v2-ssl-cn (Bind and server options)"></a><a class="anchor" name="no-send-proxy-v2-ssl-cn (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-send-proxy-v2-ssl-cn"></a><a href="#5.2-no-send-proxy-v2-ssl-cn">no-send-proxy-v2-ssl-cn</a></b></div><pre class="text">May be used in the following contexts: tcp, http

This option may be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any &quot;<a href="#send-proxy-v2-ssl-cn">send-proxy-v2-ssl-cn</a>&quot;
setting which would have been inherited from &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive as
default value.
It may also be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any previous
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; &quot;<a href="#send-proxy-v2-ssl-cn">send-proxy-v2-ssl-cn</a>&quot; setting.
</pre><a class="anchor" name="no-ssl"></a><a class="anchor" name="5-no-ssl"></a><a class="anchor" name="5.2-no-ssl"></a><a class="anchor" name="no-ssl (Bind and server options)"></a><a class="anchor" name="no-ssl (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-ssl"></a><a href="#5.2-no-ssl">no-ssl</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option may be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
setting which would have been inherited from &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive as
default value.
It may also be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any previous
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; setting.

Note that using `default-server ssl` setting and `no-ssl` on server will
however init SSL connection, so it can be later be enabled through the
runtime API: see `set server` commands in management doc.
</pre><a class="anchor" name="no-ssl-reuse"></a><a class="anchor" name="5-no-ssl-reuse"></a><a class="anchor" name="5.2-no-ssl-reuse"></a><a class="anchor" name="no-ssl-reuse (Bind and server options)"></a><a class="anchor" name="no-ssl-reuse (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-ssl-reuse"></a><a href="#5.2-no-ssl-reuse">no-ssl-reuse</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option disables SSL session reuse when SSL is used to communicate with
the server. It will force the server to perform a full handshake for every
new connection. It's probably only useful for benchmarking, troubleshooting,
and for paranoid users.
</pre><a class="anchor" name="no-sslv3"></a><a class="anchor" name="5-no-sslv3"></a><a class="anchor" name="5.2-no-sslv3"></a><a class="anchor" name="no-sslv3 (Bind and server options)"></a><a class="anchor" name="no-sslv3 (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-sslv3"></a><a href="#5.2-no-sslv3">no-sslv3</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option disables support for SSLv3 when SSL is used to communicate with
the server. Note that SSLv2 is disabled in the code and cannot be enabled
using any configuration option. Use &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-max-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-max-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-max-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; instead.

Supported in default-server: No
</pre><a class="anchor" name="no-tls-tickets"></a><a class="anchor" name="5-no-tls-tickets"></a><a class="anchor" name="5.2-no-tls-tickets"></a><a class="anchor" name="no-tls-tickets (Bind and server options)"></a><a class="anchor" name="no-tls-tickets (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-tls-tickets"></a><a href="#5.2-no-tls-tickets">no-tls-tickets</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This setting is only available when support for OpenSSL was built in. It
disables the stateless session resumption (RFC 5077 TLS Ticket
extension) and force to use stateful session resumption. Stateless
session resumption is more expensive in CPU usage for servers. This option
is also available on global statement &quot;<a href="#ssl-default-server-options">ssl-default-server-options</a>&quot;.
The TLS ticket mechanism is only used up to TLS 1.2.
Forward Secrecy is compromised with TLS tickets, unless ticket keys
are periodically rotated (via reload or by using &quot;<a href="#tls-ticket-keys">tls-ticket-keys</a>&quot;).
See also &quot;<a href="#tls-tickets">tls-tickets</a>&quot;.
</pre><a class="anchor" name="no-tlsv10"></a><a class="anchor" name="5-no-tlsv10"></a><a class="anchor" name="5.2-no-tlsv10"></a><a class="anchor" name="no-tlsv10 (Bind and server options)"></a><a class="anchor" name="no-tlsv10 (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-tlsv10"></a><a href="#5.2-no-tlsv10">no-tlsv10</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option disables support for TLSv1.0 when SSL is used to communicate with
the server. Note that SSLv2 is disabled in the code and cannot be enabled
using any configuration option. TLSv1 is more expensive than SSLv3 so it
often makes sense to disable it when communicating with local servers. This
option is also available on global statement &quot;<a href="#ssl-default-server-options">ssl-default-server-options</a>&quot;.
Use &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-max-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-max-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-max-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; instead.

Supported in default-server: No
</pre><a class="anchor" name="no-tlsv11"></a><a class="anchor" name="5-no-tlsv11"></a><a class="anchor" name="5.2-no-tlsv11"></a><a class="anchor" name="no-tlsv11 (Bind and server options)"></a><a class="anchor" name="no-tlsv11 (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-tlsv11"></a><a href="#5.2-no-tlsv11">no-tlsv11</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option disables support for TLSv1.1 when SSL is used to communicate with
the server. Note that SSLv2 is disabled in the code and cannot be enabled
using any configuration option. TLSv1 is more expensive than SSLv3 so it
often makes sense to disable it when communicating with local servers. This
option is also available on global statement &quot;<a href="#ssl-default-server-options">ssl-default-server-options</a>&quot;.
Use &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-max-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-max-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-max-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; instead.

Supported in default-server: No
</pre><a class="anchor" name="no-tlsv12"></a><a class="anchor" name="5-no-tlsv12"></a><a class="anchor" name="5.2-no-tlsv12"></a><a class="anchor" name="no-tlsv12 (Bind and server options)"></a><a class="anchor" name="no-tlsv12 (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-tlsv12"></a><a href="#5.2-no-tlsv12">no-tlsv12</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option disables support for TLSv1.2 when SSL is used to communicate with
the server. Note that SSLv2 is disabled in the code and cannot be enabled
using any configuration option. TLSv1 is more expensive than SSLv3 so it
often makes sense to disable it when communicating with local servers. This
option is also available on global statement &quot;<a href="#ssl-default-server-options">ssl-default-server-options</a>&quot;.
Use &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-max-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-max-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-max-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; instead.

Supported in default-server: No
</pre><a class="anchor" name="no-tlsv13"></a><a class="anchor" name="5-no-tlsv13"></a><a class="anchor" name="5.2-no-tlsv13"></a><a class="anchor" name="no-tlsv13 (Bind and server options)"></a><a class="anchor" name="no-tlsv13 (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-tlsv13"></a><a href="#5.2-no-tlsv13">no-tlsv13</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option disables support for TLSv1.3 when SSL is used to communicate with
the server. Note that SSLv2 is disabled in the code and cannot be enabled
using any configuration option. TLSv1 is more expensive than SSLv3 so it
often makes sense to disable it when communicating with local servers. This
option is also available on global statement &quot;<a href="#ssl-default-server-options">ssl-default-server-options</a>&quot;.
Use &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-max-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-max-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-max-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; instead.

Supported in default-server: No
</pre><a class="anchor" name="no-verifyhost"></a><a class="anchor" name="5-no-verifyhost"></a><a class="anchor" name="5.2-no-verifyhost"></a><a class="anchor" name="no-verifyhost (Bind and server options)"></a><a class="anchor" name="no-verifyhost (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-verifyhost"></a><a href="#5.2-no-verifyhost">no-verifyhost</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option may be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any &quot;<a href="#verifyhost">verifyhost</a>&quot;
setting which would have been inherited from &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive as
default value.
It may also be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any previous
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; &quot;<a href="#verifyhost">verifyhost</a>&quot; setting.
</pre><a class="anchor" name="no-tfo"></a><a class="anchor" name="5-no-tfo"></a><a class="anchor" name="5.2-no-tfo"></a><a class="anchor" name="no-tfo (Bind and server options)"></a><a class="anchor" name="no-tfo (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="no-tfo"></a><a href="#5.2-no-tfo">no-tfo</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option may be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">tfo<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#tfo%20%28Bind%20options%29">Bind options</a></li><li><a href="#tfo%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
setting which would have been inherited from &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive as
default value.
It may also be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any previous
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">tfo<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#tfo%20%28Bind%20options%29">Bind options</a></li><li><a href="#tfo%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; setting.
</pre><a class="anchor" name="non-stick"></a><a class="anchor" name="5-non-stick"></a><a class="anchor" name="5.2-non-stick"></a><a class="anchor" name="non-stick (Bind and server options)"></a><a class="anchor" name="non-stick (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="non-stick"></a><a href="#5.2-non-stick">non-stick</a></b></div><pre class="text">May be used in the following contexts: tcp, http

Never add connections allocated to this sever to a stick-table.
This may be used in conjunction with backup to ensure that
stick-table persistence is disabled for backup servers.
</pre><a class="anchor" name="npn"></a><a class="anchor" name="5-npn"></a><a class="anchor" name="5.2-npn"></a><a class="anchor" name="npn (Bind and server options)"></a><a class="anchor" name="npn (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="npn"></a><a href="#5.2-npn">npn</a></b> <span style="color: #080">&lt;protocols&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http

This enables the NPN TLS extension and advertises the specified protocol list
as supported on top of NPN. The protocol list consists in a comma-delimited
list of protocol names, for instance: &quot;http/1.1,http/1.0&quot; (without quotes).
This requires that the SSL library is built with support for TLS extensions
enabled (check with haproxy -vv). Note that the NPN extension has been
replaced with the ALPN extension (see the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">alpn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#alpn%20%28Bind%20options%29">Bind options</a></li><li><a href="#alpn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword), though this one is
only available starting with OpenSSL 1.0.2.
</pre><a class="anchor" name="observe"></a><a class="anchor" name="5-observe"></a><a class="anchor" name="5.2-observe"></a><a class="anchor" name="observe (Bind and server options)"></a><a class="anchor" name="observe (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="observe"></a><a href="#5.2-observe">observe</a></b> <span style="color: #080">&lt;mode&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http

This option enables health adjusting based on observing communication with
the server. By default this functionality is disabled and enabling it also
requires to enable health checks. There are two supported modes: &quot;layer4&quot; and
&quot;layer7&quot;. In layer4 mode, only successful/unsuccessful tcp connections are
significant. In layer7, which is only allowed for http proxies, responses
received from server are verified, like valid/wrong http code, unparsable
headers, a timeout, etc. Valid status codes include 100 to 499, 501 and 505.

See also the &quot;<a href="#check">check</a>&quot;, &quot;<a href="#on-error">on-error</a>&quot; and &quot;<a href="#error-limit">error-limit</a>&quot;.
</pre><a class="anchor" name="on-error"></a><a class="anchor" name="5-on-error"></a><a class="anchor" name="5.2-on-error"></a><a class="anchor" name="on-error (Bind and server options)"></a><a class="anchor" name="on-error (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="on-error"></a><a href="#5.2-on-error">on-error</a></b> <span style="color: #080">&lt;mode&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

Select what should happen when enough consecutive errors are detected.
Currently, four modes are available:
- fastinter: force fastinter
- fail-check: simulate a failed check, also forces fastinter (default)
- sudden-death: simulate a pre-fatal failed health check, one more failed
  check will mark a server down, forces fastinter
- mark-down: mark the server immediately down and force fastinter

See also the &quot;<a href="#check">check</a>&quot;, &quot;<a href="#observe">observe</a>&quot; and &quot;<a href="#error-limit">error-limit</a>&quot;.
</pre><a class="anchor" name="on-marked-down"></a><a class="anchor" name="5-on-marked-down"></a><a class="anchor" name="5.2-on-marked-down"></a><a class="anchor" name="on-marked-down (Bind and server options)"></a><a class="anchor" name="on-marked-down (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="on-marked-down"></a><a href="#5.2-on-marked-down">on-marked-down</a></b> <span style="color: #080">&lt;action&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

Modify what occurs when a server is marked down.
Currently one action is available:
- shutdown-sessions: Shutdown peer streams. When this setting is enabled,
  all connections to the server are immediately terminated when the server
  goes down. It might be used if the health check detects more complex cases
  than a simple connection status, and long timeouts would cause the service
  to remain unresponsive for too long a time. For instance, a health check
  might detect that a database is stuck and that there's no chance to reuse
  existing connections anymore. Connections killed this way are logged with
  a 'D' termination code (for &quot;Down&quot;).

Actions are disabled by default
</pre><a class="anchor" name="on-marked-up"></a><a class="anchor" name="5-on-marked-up"></a><a class="anchor" name="5.2-on-marked-up"></a><a class="anchor" name="on-marked-up (Bind and server options)"></a><a class="anchor" name="on-marked-up (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="on-marked-up"></a><a href="#5.2-on-marked-up">on-marked-up</a></b> <span style="color: #080">&lt;action&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

Modify what occurs when a server is marked up.
Currently one action is available:
- shutdown-backup-sessions: Shutdown streams on all backup servers. This is
  done only if the server is not in backup state and if it is not disabled
  (it must have an effective weight &gt; 0). This can be used sometimes to force
  an active server to take all the traffic back after recovery when dealing
  with long sessions (e.g. LDAP, SQL, ...). Doing this can cause more trouble
  than it tries to solve (e.g. incomplete transactions), so use this feature
  with extreme care. Streams killed because a server comes up are logged
  with an 'U' termination code (for &quot;Up&quot;).

Actions are disabled by default
</pre><a class="anchor" name="pool-conn-name"></a><a class="anchor" name="5-pool-conn-name"></a><a class="anchor" name="5.2-pool-conn-name"></a><a class="anchor" name="pool-conn-name (Bind and server options)"></a><a class="anchor" name="pool-conn-name (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="pool-conn-name"></a><a href="#5.2-pool-conn-name">pool-conn-name</a></b> <span style="color: #080">&lt;expr&gt;</span></div><pre class="text">May be used in the following contexts: http

When a backend connection is established, this expression is evaluated to
generate the connection name. This name is one of the key properties of the
connection in the idle server pool. See the &quot;<a href="#http-reuse">http-reuse</a>&quot; keyword. When a
request looks up an existing idle connection, this expression is evaluated to
match an identical connection.

In context where SSL SNI is used for backend connection, the connection name
is automatically assigned to the result of the &quot;<a href="#sni">sni</a>&quot; expression. This suits
the most common usage. For more advanced setup, &quot;<a href="#pool-conn-name">pool-conn-name</a>&quot; may be used
to override this.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#http-reuse">http-reuse</a>&quot;, &quot;<a href="#sni">sni</a>&quot;</div>
<a class="anchor" name="pool-low-conn"></a><a class="anchor" name="5-pool-low-conn"></a><a class="anchor" name="5.2-pool-low-conn"></a><a class="anchor" name="pool-low-conn (Bind and server options)"></a><a class="anchor" name="pool-low-conn (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="pool-low-conn"></a><a href="#5.2-pool-low-conn">pool-low-conn</a></b> <span style="color: #080">&lt;max&gt;</span></div><pre class="text">May be used in the following contexts: http

Set a low threshold on the number of idling connections for a server, below
which a thread will not try to steal a connection from another thread. This
can be useful to improve CPU usage patterns in scenarios involving many very
fast servers, in order to ensure all threads will keep a few idle connections
all the time instead of letting them accumulate over one thread and migrating
them from thread to thread. Typical values of twice the number of threads
seem to show very good performance already with sub-millisecond response
times. The default is zero, indicating that any idle connection can be used
at any time. It is the recommended setting for normal use. This only applies
to connections that can be shared according to the same principles as those
applying to &quot;<a href="#http-reuse">http-reuse</a>&quot;. In case connection sharing between threads would
be disabled via &quot;<a href="#tune.idle-pool.shared">tune.idle-pool.shared</a>&quot;, it can become very important to use
this setting to make sure each thread always has a few connections, or the
connection reuse rate will decrease as thread count increases.
</pre><a class="anchor" name="pool-max-conn"></a><a class="anchor" name="5-pool-max-conn"></a><a class="anchor" name="5.2-pool-max-conn"></a><a class="anchor" name="pool-max-conn (Bind and server options)"></a><a class="anchor" name="pool-max-conn (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="pool-max-conn"></a><a href="#5.2-pool-max-conn">pool-max-conn</a></b> <span style="color: #080">&lt;max&gt;</span></div><pre class="text">May be used in the following contexts: http

Set the maximum number of idling connections for a server. -1 means unlimited
connections, 0 means no idle connections. The default is -1. When idle
connections are enabled, orphaned idle connections which do not belong to any
client session anymore are moved to a dedicated pool so that they remain
usable by future clients. This only applies to connections that can be shared
according to the same principles as those applying to &quot;<a href="#http-reuse">http-reuse</a>&quot;.
</pre><a class="anchor" name="pool-purge-delay"></a><a class="anchor" name="5-pool-purge-delay"></a><a class="anchor" name="5.2-pool-purge-delay"></a><a class="anchor" name="pool-purge-delay (Bind and server options)"></a><a class="anchor" name="pool-purge-delay (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="pool-purge-delay"></a><a href="#5.2-pool-purge-delay">pool-purge-delay</a></b> <span style="color: #080">&lt;delay&gt;</span></div><pre class="text">May be used in the following contexts: http

Sets the delay to start purging idle connections. Each &lt;delay&gt; interval, half
of the idle connections are closed. 0 means we don't keep any idle connection.
The default is 5s.
</pre><a class="anchor" name="port"></a><a class="anchor" name="5-port"></a><a class="anchor" name="5.2-port"></a><a class="anchor" name="port (Bind and server options)"></a><a class="anchor" name="port (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="port"></a><a href="#5.2-port">port</a></b> <span style="color: #080">&lt;port&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

Using the &quot;<a href="#port">port</a>&quot; parameter, it becomes possible to use a different port to
send health-checks or to probe the agent-check. On some servers, it may be
desirable to dedicate a port to a specific component able to perform complex
tests which are more suitable to health-checks than the application. It is
common to run a simple script in inetd for instance. This parameter is
ignored if the &quot;<a href="#check">check</a>&quot; parameter is not set. See also the &quot;<a href="#addr">addr</a>&quot; parameter.
</pre><a class="anchor" name="proto"></a><a class="anchor" name="5-proto"></a><a class="anchor" name="5.2-proto"></a><a class="anchor" name="proto (Bind and server options)"></a><a class="anchor" name="proto (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="proto"></a><a href="#5.2-proto">proto</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http

Forces the multiplexer's protocol to use for the outgoing connections to this
server. It must be compatible with the mode of the backend (TCP or HTTP). It
must also be usable on the backend side. The list of available protocols is
reported in haproxy -vv.The protocols properties are reported : the mode
(TCP/HTTP), the side (FE/BE), the mux name and its flags.

Some protocols are subject to the head-of-line blocking on server side
(flag=HOL_RISK). Finally some protocols don't support upgrades (flag=NO_UPG).
The HTX compatibility is also reported (flag=HTX).

Here are the protocols that may be used as argument to a &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">proto<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#proto%20%28Bind%20options%29">Bind options</a></li><li><a href="#proto%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; directive on
a server line :

  h2   : mode=HTTP  side=FE|BE  mux=H2    flags=HTX|HOL_RISK|NO_UPG
  fcgi : mode=HTTP  side=BE     mux=FCGI  flags=HTX|HOL_RISK|NO_UPG
  h1   : mode=HTTP  side=FE|BE  mux=H1    flags=HTX|NO_UPG
  none : mode=TCP   side=FE|BE  mux=PASS  flags=NO_UPG

Idea behind this option is to bypass the selection of the best multiplexer's
protocol for all connections established to this server.

See also &quot;<a href="#ws">ws</a>&quot; to use an alternative protocol for websocket streams.
</pre><a class="anchor" name="redir"></a><a class="anchor" name="5-redir"></a><a class="anchor" name="5.2-redir"></a><a class="anchor" name="redir (Bind and server options)"></a><a class="anchor" name="redir (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="redir"></a><a href="#5.2-redir">redir</a></b> <span style="color: #080">&lt;prefix&gt;</span></div><pre class="text">May be used in the following contexts: http

The &quot;<a href="#redir">redir</a>&quot; parameter enables the redirection mode for all GET and HEAD
requests addressing this server. This means that instead of having HAProxy
forward the request to the server, it will send an &quot;HTTP 302&quot; response with
the &quot;Location&quot; header composed of this prefix immediately followed by the
requested URI beginning at the leading '/' of the path component. That means
that no trailing slash should be used after &lt;prefix&gt;. All invalid requests
will be rejected, and all non-GET or HEAD requests will be normally served by
the server. Note that since the response is completely forged, no header
mangling nor cookie insertion is possible in the response. However, cookies in
requests are still analyzed, making this solution completely usable to direct
users to a remote location in case of local disaster. Main use consists in
increasing bandwidth for static servers by having the clients directly
connect to them. Note: never use a relative location here, it would cause a
loop between the client and HAProxy!
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<div class="example-desc">server srv1 192.168.1.1:80 redir http://image1.mydomain.com check</div><code></code></pre>
</div><a class="anchor" name="rise"></a><a class="anchor" name="5-rise"></a><a class="anchor" name="5.2-rise"></a><a class="anchor" name="rise (Bind and server options)"></a><a class="anchor" name="rise (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="rise"></a><a href="#5.2-rise">rise</a></b> <span style="color: #080">&lt;count&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

The &quot;<a href="#rise">rise</a>&quot; parameter states that a server will be considered as operational
after &lt;count&gt; consecutive successful health checks. This value defaults to 2
if unspecified. See also the &quot;<a href="#check">check</a>&quot;, &quot;<a href="#inter">inter</a>&quot; and &quot;<a href="#fall">fall</a>&quot; parameters.
</pre><a class="anchor" name="resolve-opts"></a><a class="anchor" name="5-resolve-opts"></a><a class="anchor" name="5.2-resolve-opts"></a><a class="anchor" name="resolve-opts (Bind and server options)"></a><a class="anchor" name="resolve-opts (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="resolve-opts"></a><a href="#5.2-resolve-opts">resolve-opts</a></b> <span style="color: #080">&lt;option&gt;</span>,<span style="color: #080">&lt;option&gt;</span>,...</div><pre class="text">May be used in the following contexts: tcp, http, log

Comma separated list of options to apply to DNS resolution linked to this
server.

Available options:

* allow-dup-ip
  By default, HAProxy prevents IP address duplication in a backend when DNS
  resolution at runtime is in operation.
  That said, for some cases, it makes sense that two servers (in the same
  backend, being resolved by the same FQDN) have the same IP address.
  For such case, simply enable this option.
  This is the opposite of prevent-dup-ip.

* ignore-weight
  Ignore any weight that is set within an SRV record.  This is useful when
  you would like to control the weights using an alternate method, such as
  using an &quot;<a href="#agent-check">agent-check</a>&quot; or through the runtime api.

* prevent-dup-ip
  Ensure HAProxy's default behavior is enforced on a server: prevent re-using
  an IP address already set to a server in the same backend and sharing the
  same fqdn.
  This is the opposite of allow-dup-ip.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>backend b_myapp
  default-server init-addr none resolvers dns
  server s1 myapp.example.com:80 check resolve-opts allow-dup-ip
  server s2 myapp.example.com:81 check resolve-opts allow-dup-ip
</code></pre>
</div><pre class="text">With the option allow-dup-ip set:
* if the nameserver returns a single IP address, then both servers will use
  it
* If the nameserver returns 2 IP addresses, then each server will pick up a
  different address

Default value: not set
</pre><a class="anchor" name="resolve-prefer"></a><a class="anchor" name="5-resolve-prefer"></a><a class="anchor" name="5.2-resolve-prefer"></a><a class="anchor" name="resolve-prefer (Bind and server options)"></a><a class="anchor" name="resolve-prefer (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="resolve-prefer"></a><a href="#5.2-resolve-prefer">resolve-prefer</a></b> <span style="color: #080">&lt;family&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

When DNS resolution is enabled for a server and multiple IP addresses from
different families are returned, HAProxy will prefer using an IP address
from the family mentioned in the &quot;<a href="#resolve-prefer">resolve-prefer</a>&quot; parameter.
Available families: &quot;<a href="#ipv4">ipv4</a>&quot; and &quot;<a href="#ipv6">ipv6</a>&quot;

Default value: ipv6
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>server s1 app1.domain.com:80 resolvers mydns resolve-prefer ipv6
</code></pre>
</div><a class="anchor" name="resolve-net"></a><a class="anchor" name="5-resolve-net"></a><a class="anchor" name="5.2-resolve-net"></a><a class="anchor" name="resolve-net (Bind and server options)"></a><a class="anchor" name="resolve-net (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="resolve-net"></a><a href="#5.2-resolve-net">resolve-net</a></b> <span style="color: #080">&lt;network&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;network<span style="color: #008">[,...]</span></span>]</span></div><pre class="text">May be used in the following contexts: tcp, http, log

This option prioritizes the choice of an ip address matching a network. This is
useful with clouds to prefer a local ip. In some cases, a cloud high
availability service can be announced with many ip addresses on many
different datacenters. The latency between datacenter is not negligible, so
this patch permits to prefer a local datacenter. If no address matches the
configured network, another address is selected.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>server s1 app1.domain.com:80 resolvers mydns resolve-net 10.0.0.0/8
</code></pre>
</div><a class="anchor" name="resolvers"></a><a class="anchor" name="5-resolvers"></a><a class="anchor" name="5.2-resolvers"></a><a class="anchor" name="resolvers (Bind and server options)"></a><a class="anchor" name="resolvers (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="resolvers"></a><a href="#5.2-resolvers">resolvers</a></b> <span style="color: #080">&lt;id&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

Points to an existing &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">resolvers<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#resolvers%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li><li><a href="#resolvers%20%28The%20resolvers%20section%29">The resolvers section</a></li></ul></span>&quot; section to resolve current server's
hostname.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>server s1 app1.domain.com:80 check resolvers mydns
</code></pre>
</div><pre class="text">See also <a href="#5.3">section 5.3</a>
</pre><a class="anchor" name="send-proxy"></a><a class="anchor" name="5-send-proxy"></a><a class="anchor" name="5.2-send-proxy"></a><a class="anchor" name="send-proxy (Bind and server options)"></a><a class="anchor" name="send-proxy (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="send-proxy"></a><a href="#5.2-send-proxy">send-proxy</a></b></div><pre class="text">May be used in the following contexts: tcp, http

The &quot;<a href="#send-proxy">send-proxy</a>&quot; parameter enforces use of the PROXY protocol over any
connection established to this server. The PROXY protocol informs the other
end about the layer 3/4 addresses of the incoming connection, so that it can
know the client's address or the public address it accessed to, whatever the
upper layer protocol. For connections accepted by an &quot;<a href="#accept-proxy">accept-proxy</a>&quot; or
&quot;<a href="#accept-netscaler-cip">accept-netscaler-cip</a>&quot; listener, the advertised address will be used. Only
TCPv4 and TCPv6 address families are supported. Other families such as
Unix sockets, will report an UNKNOWN family. Servers using this option can
fully be chained to another instance of HAProxy listening with an
&quot;<a href="#accept-proxy">accept-proxy</a>&quot; setting. This setting must not be used if the server isn't
aware of the protocol. When health checks are sent to the server, the PROXY
protocol is automatically used when this option is set, unless there is an
explicit &quot;<a href="#port">port</a>&quot; or &quot;<a href="#addr">addr</a>&quot; directive, in which case an explicit
&quot;<a href="#check-send-proxy">check-send-proxy</a>&quot; directive would also be needed to use the PROXY protocol.
See also the &quot;<a href="#no-send-proxy">no-send-proxy</a>&quot; option of this section and &quot;<a href="#accept-proxy">accept-proxy</a>&quot; and
&quot;<a href="#accept-netscaler-cip">accept-netscaler-cip</a>&quot; option of the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword.
</pre><a class="anchor" name="send-proxy-v2"></a><a class="anchor" name="5-send-proxy-v2"></a><a class="anchor" name="5.2-send-proxy-v2"></a><a class="anchor" name="send-proxy-v2 (Bind and server options)"></a><a class="anchor" name="send-proxy-v2 (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="send-proxy-v2"></a><a href="#5.2-send-proxy-v2">send-proxy-v2</a></b></div><pre class="text">May be used in the following contexts: tcp, http

The &quot;<a href="#send-proxy-v2">send-proxy-v2</a>&quot; parameter enforces use of the PROXY protocol version 2
over any connection established to this server. The PROXY protocol informs
the other end about the layer 3/4 addresses of the incoming connection, so
that it can know the client's address or the public address it accessed to,
whatever the upper layer protocol. It also send ALPN information if an alpn
have been negotiated. This setting must not be used if the server isn't aware
of this version of the protocol. See also the &quot;<a href="#no-send-proxy-v2">no-send-proxy-v2</a>&quot; option of
this section and send-proxy&quot; option of the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword.
</pre><a class="anchor" name="set-proxy-v2-tlv-fmt"></a><a class="anchor" name="5-set-proxy-v2-tlv-fmt"></a><a class="anchor" name="5.2-set-proxy-v2-tlv-fmt"></a><a class="anchor" name="set-proxy-v2-tlv-fmt (Bind and server options)"></a><a class="anchor" name="set-proxy-v2-tlv-fmt (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="set-proxy-v2-tlv-fmt"></a><a href="#5.2-set-proxy-v2-tlv-fmt">set-proxy-v2-tlv-fmt</a></b>(<span style="color: #080">&lt;id&gt;</span>) <span style="color: #080">&lt;fmt&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http

The &quot;<a href="#set-proxy-v2-tlv-fmt">set-proxy-v2-tlv-fmt</a>&quot; parameter is used to send arbitrary PROXY protocol
version 2 TLVs. For the type (&lt;id&gt;) range of the defined TLV type please refer
to <a href="#2.2.8">section 2.2.8</a>. of the proxy protocol specification. However, the value can
be chosen freely as long as it does not exceed the maximum length of 65,535
bytes. It can also be used for forwarding TLVs by using the fetch &quot;<a href="#fc_pp_tlv">fc_pp_tlv</a>&quot;
to retrieve a received TLV from the frontend. It may be used as a server or
a default-server option. It must be used in combination with send-proxy-v2
such that PPv2 TLVs are actually sent out.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>server srv1 192.168.1.1:80 send-proxy-v2 set-proxy-v2-tlv-fmt(0x20) %[fc_pp_tlv(0x20)]
</code></pre>
</div><pre class="text">In this case, we fetch the TLV with the type 0x20 as a string and set as the value
of a newly created TLV that also has the type 0x20.
</pre><a class="anchor" name="proxy-v2-options"></a><a class="anchor" name="5-proxy-v2-options"></a><a class="anchor" name="5.2-proxy-v2-options"></a><a class="anchor" name="proxy-v2-options (Bind and server options)"></a><a class="anchor" name="proxy-v2-options (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="proxy-v2-options"></a><a href="#5.2-proxy-v2-options">proxy-v2-options</a></b> <span style="color: #080">&lt;option&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;option&gt;</span>]</span>*</div><pre class="text">May be used in the following contexts: tcp, http

The &quot;<a href="#proxy-v2-options">proxy-v2-options</a>&quot; parameter add options to send in PROXY protocol
version 2 when &quot;<a href="#send-proxy-v2">send-proxy-v2</a>&quot; is used. Options available are:

- ssl       : See also &quot;<a href="#send-proxy-v2-ssl">send-proxy-v2-ssl</a>&quot;.
- cert-cn   : See also &quot;<a href="#send-proxy-v2-ssl-cn">send-proxy-v2-ssl-cn</a>&quot;.
- ssl-cipher: Name of the used cipher.
- cert-sig  : Signature algorithm of the used certificate.
- cert-key  : Key algorithm of the used certificate
- authority : Host name value passed by the client (only SNI from a TLS
              connection is supported).
- crc32c    : Checksum of the PROXYv2 header.
- unique-id : Send a unique ID generated using the frontend's
              &quot;<a href="#unique-id-format">unique-id-format</a>&quot; within the PROXYv2 header.
              This unique-id is primarily meant for &quot;mode tcp&quot;. It can
              lead to unexpected results in &quot;mode http&quot;, because the
              generated unique ID is also used for the first HTTP request
              within a Keep-Alive connection.
</pre><a class="anchor" name="send-proxy-v2-ssl"></a><a class="anchor" name="5-send-proxy-v2-ssl"></a><a class="anchor" name="5.2-send-proxy-v2-ssl"></a><a class="anchor" name="send-proxy-v2-ssl (Bind and server options)"></a><a class="anchor" name="send-proxy-v2-ssl (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="send-proxy-v2-ssl"></a><a href="#5.2-send-proxy-v2-ssl">send-proxy-v2-ssl</a></b></div><pre class="text">May be used in the following contexts: tcp, http

The &quot;<a href="#send-proxy-v2-ssl">send-proxy-v2-ssl</a>&quot; parameter enforces use of the PROXY protocol version
2 over any connection established to this server. The PROXY protocol informs
the other end about the layer 3/4 addresses of the incoming connection, so
that it can know the client's address or the public address it accessed to,
whatever the upper layer protocol. In addition, the SSL information extension
of the PROXY protocol is added to the PROXY protocol header. This setting
must not be used if the server isn't aware of this version of the protocol.
See also the &quot;<a href="#no-send-proxy-v2-ssl">no-send-proxy-v2-ssl</a>&quot; option of this section and the
&quot;<a href="#send-proxy-v2">send-proxy-v2</a>&quot; option of the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword.
</pre><a class="anchor" name="send-proxy-v2-ssl-cn"></a><a class="anchor" name="5-send-proxy-v2-ssl-cn"></a><a class="anchor" name="5.2-send-proxy-v2-ssl-cn"></a><a class="anchor" name="send-proxy-v2-ssl-cn (Bind and server options)"></a><a class="anchor" name="send-proxy-v2-ssl-cn (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="send-proxy-v2-ssl-cn"></a><a href="#5.2-send-proxy-v2-ssl-cn">send-proxy-v2-ssl-cn</a></b></div><pre class="text">May be used in the following contexts: tcp, http

The &quot;<a href="#send-proxy-v2-ssl">send-proxy-v2-ssl</a>&quot; parameter enforces use of the PROXY protocol version
2 over any connection established to this server. The PROXY protocol informs
the other end about the layer 3/4 addresses of the incoming connection, so
that it can know the client's address or the public address it accessed to,
whatever the upper layer protocol. In addition, the SSL information extension
of the PROXY protocol, along along with the Common Name from the subject of
the client certificate (if any), is added to the PROXY protocol header. This
setting must not be used if the server isn't aware of this version of the
protocol. See also the &quot;<a href="#no-send-proxy-v2-ssl-cn">no-send-proxy-v2-ssl-cn</a>&quot; option of this section and
the &quot;<a href="#send-proxy-v2">send-proxy-v2</a>&quot; option of the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword.
</pre><a class="anchor" name="shard"></a><a class="anchor" name="5-shard"></a><a class="anchor" name="5.2-shard"></a><a class="anchor" name="shard (Bind and server options)"></a><a class="anchor" name="shard (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="shard"></a><a href="#5.2-shard">shard</a></b> <span style="color: #080">&lt;shard&gt;</span></div><pre class="text">May be used in the following contexts: peers

This parameter in used only in the context of stick-tables synchronisation
with peers protocol. The &quot;<a href="#shard">shard</a>&quot; parameter identifies the peers which will
receive all the stick-table updates for keys with this shard as distribution
hash. The accepted values are 0 up to &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">shards<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#shards%20%28Peers%29">Peers</a></li><li><a href="#shards%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; parameter value specified in
the &quot;<a href="#peers">peers</a>&quot; section. 0 value is the default value meaning that the peer will
receive all the key updates. Greater values than &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">shards<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#shards%20%28Peers%29">Peers</a></li><li><a href="#shards%20%28Bind%20options%29">Bind options</a></li></ul></span>&quot; will be ignored.
This is also the case for any value provided to the local peer.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>peers mypeers
     shards 3
     peer A 127.0.0.1:40001 # local peer without shard value (0 internally)
     peer B 127.0.0.1:40002 shard 1
     peer C 127.0.0.1:40003 shard 2
     peer D 127.0.0.1:40004 shard 3
</code></pre>
</div><a class="anchor" name="sigalgs"></a><a class="anchor" name="5-sigalgs"></a><a class="anchor" name="5.2-sigalgs"></a><a class="anchor" name="sigalgs (Bind and server options)"></a><a class="anchor" name="sigalgs (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="sigalgs"></a><a href="#5.2-sigalgs">sigalgs</a></b> <span style="color: #080">&lt;sigalgs&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This setting is only available when support for OpenSSL was built in. It sets
the string describing the list of signature algorithms that are negotiated
during the TLSv1.2 and TLSv1.3 handshake. The format of the string is defined
in &quot;man 3 SSL_CTX_set1_sigalgs&quot; from the OpenSSL man pages. It is not
recommended to use this setting unless compatibility with a middlebox is
required.
</pre><a class="anchor" name="slowstart"></a><a class="anchor" name="5-slowstart"></a><a class="anchor" name="5.2-slowstart"></a><a class="anchor" name="slowstart (Bind and server options)"></a><a class="anchor" name="slowstart (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="slowstart"></a><a href="#5.2-slowstart">slowstart</a></b> <span style="color: #080">&lt;start_time_in_ms&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http

The &quot;<a href="#slowstart">slowstart</a>&quot; parameter for a server accepts a value in milliseconds which
indicates after how long a server which has just come back up will run at
full speed. Just as with every other time-based parameter, it can be entered
in any other explicit unit among { us, ms, s, m, h, d }. The speed grows
linearly from 0 to 100% during this time. The limitation applies to two
parameters :

- maxconn: the number of connections accepted by the server will grow from 1
  to 100% of the usual dynamic limit defined by (minconn,maxconn,fullconn).

- weight: when the backend uses a dynamic weighted algorithm, the weight
  grows linearly from 1 to 100%. In this case, the weight is updated at every
  health-check. For this reason, it is important that the &quot;<a href="#inter">inter</a>&quot; parameter
  is smaller than the &quot;<a href="#slowstart">slowstart</a>&quot;, in order to maximize the number of steps.

The slowstart never applies when HAProxy starts, otherwise it would cause
trouble to running servers. It only applies when a server has been previously
seen as failed.
</pre><a class="anchor" name="sni"></a><a class="anchor" name="5-sni"></a><a class="anchor" name="5.2-sni"></a><a class="anchor" name="sni (Bind and server options)"></a><a class="anchor" name="sni (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="sni"></a><a href="#5.2-sni">sni</a></b> <span style="color: #080">&lt;expression&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

The &quot;<a href="#sni">sni</a>&quot; parameter evaluates the sample fetch expression, converts it to a
string and uses the result as the host name sent in the SNI TLS extension to
the server. A typical use case is to send the SNI received from the client in
a bridged TCP/SSL scenario, using the &quot;<a href="#ssl_fc_sni">ssl_fc_sni</a>&quot; sample fetch for the
expression. THIS MUST NOT BE USED FOR HTTPS, where req.hdr(host) should be
used instead, since SNI in HTTPS must always match the Host field and clients
are allowed to use different host names over the same connection). If
&quot;verify required&quot; is set (which is the recommended setting), the resulting
name will also be matched against the server certificate's names. See the
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">verify<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#verify%20%28Bind%20options%29">Bind options</a></li><li><a href="#verify%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; directive for more details. If you want to set a SNI for health
checks, see the &quot;<a href="#check-sni">check-sni</a>&quot; directive for more details.

By default, the SNI is assigned to the connection name for &quot;<a href="#http-reuse">http-reuse</a>&quot;,
unless overridden by the &quot;<a href="#pool-conn-name">pool-conn-name</a>&quot; server keyword.
</pre><a class="anchor" name="source"></a><a class="anchor" name="5-source"></a><a class="anchor" name="5.2-source"></a><a class="anchor" name="source (Bind and server options)"></a><a class="anchor" name="source (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="source"></a><a href="#5.2-source">source</a></b> <span style="color: #080">&lt;addr&gt;</span><span style="color: #008">[:<span style="color: #080">&lt;pl&gt;</span><span style="color: #008">[-<span style="color: #080">&lt;ph&gt;</span>]</span>]</span> <span style="color: #008">[usesrc <span style="color: #800">{ <span style="color: #080">&lt;addr2&gt;</span><span style="color: #008">[:<span style="color: #080">&lt;port2&gt;</span>]</span> | client | clientip }</span> ]</span></div><a class="anchor" name="source"></a><a class="anchor" name="5-source"></a><a class="anchor" name="5.2-source"></a><a class="anchor" name="source (Bind and server options)"></a><a class="anchor" name="source (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="source"></a><a href="#5.2-source">source</a></b> <span style="color: #080">&lt;addr&gt;</span><span style="color: #008">[:<span style="color: #080">&lt;port&gt;</span>]</span> <span style="color: #008">[usesrc <span style="color: #800">{ <span style="color: #080">&lt;addr2&gt;</span><span style="color: #008">[:<span style="color: #080">&lt;port2&gt;</span>]</span> | hdr_ip(<span style="color: #080">&lt;hdr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>) }</span> ]</span></div><a class="anchor" name="source"></a><a class="anchor" name="5-source"></a><a class="anchor" name="5.2-source"></a><a class="anchor" name="source (Bind and server options)"></a><a class="anchor" name="source (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="source"></a><a href="#5.2-source">source</a></b> <span style="color: #080">&lt;addr&gt;</span><span style="color: #008">[:<span style="color: #080">&lt;pl&gt;</span><span style="color: #008">[-<span style="color: #080">&lt;ph&gt;</span>]</span>]</span> <span style="color: #008">[interface <span style="color: #080">&lt;name&gt;</span>]</span> ...</div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

The &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">source<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#source%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#source%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; parameter sets the source address which will be used when
connecting to the server. It follows the exact same parameters and principle
as the backend &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">source<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#source%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#source%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword, except that it only applies to the server
referencing it. Please consult the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">source<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#source%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#source%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword for details.

Additionally, the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">source<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#source%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#source%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; statement on a server line allows one to specify a
source port range by indicating the lower and higher bounds delimited by a
dash ('-'). Some operating systems might require a valid IP address when a
source port range is specified. It is permitted to have the same IP/range for
several servers. Doing so makes it possible to bypass the maximum of 64k
total concurrent connections. The limit will then reach 64k connections per
server.

Since Linux 4.2/libc 2.23 IP_BIND_ADDRESS_NO_PORT is set for connections
specifying the source address without port(s).
</pre><a class="anchor" name="ssl"></a><a class="anchor" name="5-ssl"></a><a class="anchor" name="5.2-ssl"></a><a class="anchor" name="ssl (Bind and server options)"></a><a class="anchor" name="ssl (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="ssl"></a><a href="#5.2-ssl">ssl</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option enables SSL ciphering on outgoing connections to the server. It
is critical to verify server certificates using &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">verify<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#verify%20%28Bind%20options%29">Bind options</a></li><li><a href="#verify%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; when using SSL to
connect to servers, otherwise the communication is prone to trivial man in
the-middle attacks rendering SSL useless. When this option is used, health
checks are automatically sent in SSL too unless there is a &quot;<a href="#port">port</a>&quot; or an
&quot;<a href="#addr">addr</a>&quot; directive indicating the check should be sent to a different location.
See the &quot;<a href="#no-ssl">no-ssl</a>&quot; to disable &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; option and &quot;<a href="#check-ssl">check-ssl</a>&quot; option to force
SSL health checks.
</pre><a class="anchor" name="ssl-max-ver"></a><a class="anchor" name="5-ssl-max-ver"></a><a class="anchor" name="5.2-ssl-max-ver"></a><a class="anchor" name="ssl-max-ver (Bind and server options)"></a><a class="anchor" name="ssl-max-ver (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="ssl-max-ver"></a><a href="#5.2-ssl-max-ver">ssl-max-ver</a></b> <span style="color: #008">[ SSLv3 | TLSv1.0 | TLSv1.1 | TLSv1.2 | TLSv1.3 ]</span></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option enforces use of &lt;version&gt; or lower when SSL is used to communicate
with the server. This option is also available on global statement
&quot;<a href="#ssl-default-server-options">ssl-default-server-options</a>&quot;. See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-min-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-min-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-min-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;.
</pre><a class="anchor" name="ssl-min-ver"></a><a class="anchor" name="5-ssl-min-ver"></a><a class="anchor" name="5.2-ssl-min-ver"></a><a class="anchor" name="ssl-min-ver (Bind and server options)"></a><a class="anchor" name="ssl-min-ver (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="ssl-min-ver"></a><a href="#5.2-ssl-min-ver">ssl-min-ver</a></b> <span style="color: #008">[ SSLv3 | TLSv1.0 | TLSv1.1 | TLSv1.2 | TLSv1.3 ]</span></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option enforces use of &lt;version&gt; or upper when SSL is used to communicate
with the server. This option is also available on global statement
&quot;<a href="#ssl-default-server-options">ssl-default-server-options</a>&quot;. See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl-max-ver<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl-max-ver%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl-max-ver%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;.
</pre><a class="anchor" name="ssl-reuse"></a><a class="anchor" name="5-ssl-reuse"></a><a class="anchor" name="5.2-ssl-reuse"></a><a class="anchor" name="ssl-reuse (Bind and server options)"></a><a class="anchor" name="ssl-reuse (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="ssl-reuse"></a><a href="#5.2-ssl-reuse">ssl-reuse</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option may be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any &quot;<a href="#no-ssl-reuse">no-ssl-reuse</a>&quot;
setting which would have been inherited from &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive as
default value.
It may also be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any previous
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; &quot;<a href="#no-ssl-reuse">no-ssl-reuse</a>&quot; setting.
</pre><a class="anchor" name="stick"></a><a class="anchor" name="5-stick"></a><a class="anchor" name="5.2-stick"></a><a class="anchor" name="stick (Bind and server options)"></a><a class="anchor" name="stick (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="stick"></a><a href="#5.2-stick">stick</a></b></div><pre class="text">May be used in the following contexts: tcp, http

This option may be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any &quot;<a href="#non-stick">non-stick</a>&quot;
setting which would have been inherited from &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive as
default value.
It may also be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any previous
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; &quot;<a href="#non-stick">non-stick</a>&quot; setting.
</pre><a class="anchor" name="socks4"></a><a class="anchor" name="5-socks4"></a><a class="anchor" name="5.2-socks4"></a><a class="anchor" name="socks4 (Bind and server options)"></a><a class="anchor" name="socks4 (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="socks4"></a><a href="#5.2-socks4">socks4</a></b> <span style="color: #080">&lt;addr&gt;</span>:<span style="color: #080">&lt;port&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option enables upstream socks4 tunnel for outgoing connections to the
server. Using this option won't force the health check to go via socks4 by
default. You will have to use the keyword &quot;<a href="#check-via-socks4">check-via-socks4</a>&quot; to enable it.
</pre><a class="anchor" name="tcp-ut"></a><a class="anchor" name="5-tcp-ut"></a><a class="anchor" name="5.2-tcp-ut"></a><a class="anchor" name="tcp-ut (Bind and server options)"></a><a class="anchor" name="tcp-ut (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="tcp-ut"></a><a href="#5.2-tcp-ut">tcp-ut</a></b> <span style="color: #080">&lt;delay&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

Sets the TCP User Timeout for all outgoing connections to this server. This
option is available on Linux since version 2.6.37. It allows HAProxy to
configure a timeout for sockets which contain data not receiving an
acknowledgment for the configured delay. This is especially useful on
long-lived connections experiencing long idle periods such as remote
terminals or database connection pools, where the client and server timeouts
must remain high to allow a long period of idle, but where it is important to
detect that the server has disappeared in order to release all resources
associated with its connection (and the client's session). One typical use
case is also to force dead server connections to die when health checks are
too slow or during a soft reload since health checks are then disabled. The
argument is a delay expressed in milliseconds by default. This only works for
regular TCP connections, and is ignored for other protocols.
</pre><a class="anchor" name="tfo"></a><a class="anchor" name="5-tfo"></a><a class="anchor" name="5.2-tfo"></a><a class="anchor" name="tfo (Bind and server options)"></a><a class="anchor" name="tfo (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="tfo"></a><a href="#5.2-tfo">tfo</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option enables using TCP fast open when connecting to servers, on
systems that support it (currently only the Linux kernel &gt;= 4.11).
See the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">tfo<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#tfo%20%28Bind%20options%29">Bind options</a></li><li><a href="#tfo%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; bind option for more information about TCP fast open.
Please note that when using tfo, you should also use the &quot;conn-failure&quot;,
&quot;empty-response&quot; and &quot;response-timeout&quot; keywords for &quot;<a href="#retry-on">retry-on</a>&quot;, or HAProxy
won't be able to retry the connection on failure. See also &quot;<a href="#no-tfo">no-tfo</a>&quot;.
</pre><a class="anchor" name="track"></a><a class="anchor" name="5-track"></a><a class="anchor" name="5.2-track"></a><a class="anchor" name="track (Bind and server options)"></a><a class="anchor" name="track (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="track"></a><a href="#5.2-track">track</a></b> <span style="color: #008">[<span style="color: #080">&lt;backend&gt;</span>/]</span><span style="color: #080">&lt;server&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log

This option enables ability to set the current state of the server by tracking
another one. It is possible to track a server which itself tracks another
server, provided that at the end of the chain, a server has health checks
enabled. If &lt;backend&gt; is omitted the current one is used. If disable-on-404 is
used, it has to be enabled on both proxies.
</pre><a class="anchor" name="tls-tickets"></a><a class="anchor" name="5-tls-tickets"></a><a class="anchor" name="5.2-tls-tickets"></a><a class="anchor" name="tls-tickets (Bind and server options)"></a><a class="anchor" name="tls-tickets (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="tls-tickets"></a><a href="#5.2-tls-tickets">tls-tickets</a></b></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This option may be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">no-tls-tickets<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#no-tls-tickets%20%28Bind%20options%29">Bind options</a></li><li><a href="#no-tls-tickets%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
setting which would have been inherited from &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive as
default value.
The TLS ticket mechanism is only used up to TLS 1.2.
Forward Secrecy is compromised with TLS tickets, unless ticket keys
are periodically rotated (via reload or by using &quot;<a href="#tls-ticket-keys">tls-ticket-keys</a>&quot;).
It may also be used as &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting to reset any previous
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">default-server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#default-server%20%28Peers%29">Peers</a></li><li><a href="#default-server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">no-tls-tickets<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#no-tls-tickets%20%28Bind%20options%29">Bind options</a></li><li><a href="#no-tls-tickets%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; setting.
</pre><a class="anchor" name="verify"></a><a class="anchor" name="5-verify"></a><a class="anchor" name="5.2-verify"></a><a class="anchor" name="verify (Bind and server options)"></a><a class="anchor" name="verify (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="verify"></a><a href="#5.2-verify">verify</a></b> <span style="color: #008">[none|required]</span></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This setting is only available when support for OpenSSL was built in. If set
to 'none', server certificate is not verified. In the other case, The
certificate provided by the server is verified using CAs from 'ca-file' and
optional CRLs from 'crl-file' after having checked that the names provided in
the certificate's subject and subjectAlternateNames attributes match either
the name passed using the &quot;<a href="#sni">sni</a>&quot; directive, or if not provided, the static
host name passed using the &quot;<a href="#verifyhost">verifyhost</a>&quot; directive. When no name is found, the
certificate's names are ignored. For this reason, without SNI it's important
to use &quot;<a href="#verifyhost">verifyhost</a>&quot;. On verification failure the handshake is aborted. It is
critically important to verify server certificates when using SSL to connect
to servers, otherwise the communication is prone to trivial man-in-the-middle
attacks rendering SSL totally useless. Unless &quot;ssl_server_verify&quot; appears in
the global section, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">verify<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#verify%20%28Bind%20options%29">Bind options</a></li><li><a href="#verify%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; is set to &quot;required&quot; by default.
</pre><a class="anchor" name="verifyhost"></a><a class="anchor" name="5-verifyhost"></a><a class="anchor" name="5.2-verifyhost"></a><a class="anchor" name="verifyhost (Bind and server options)"></a><a class="anchor" name="verifyhost (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="verifyhost"></a><a href="#5.2-verifyhost">verifyhost</a></b> <span style="color: #080">&lt;hostname&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http, log, peers, ring

This setting is only available when support for OpenSSL was built in, and
only takes effect if 'verify required' is also specified. This directive sets
a default static hostname to check the server's certificate against when no
SNI was used to connect to the server. If SNI is not used, this is the only
way to enable hostname verification. This static hostname, when set, will
also be used for health checks (which cannot provide an SNI value). If none
of the hostnames in the certificate match the specified hostname, the
handshake is aborted. The hostnames in the server-provided certificate may
include wildcards. See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">verify<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#verify%20%28Bind%20options%29">Bind options</a></li><li><a href="#verify%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;, &quot;<a href="#sni">sni</a>&quot; and &quot;<a href="#no-verifyhost">no-verifyhost</a>&quot; options.
</pre><a class="anchor" name="weight"></a><a class="anchor" name="5-weight"></a><a class="anchor" name="5.2-weight"></a><a class="anchor" name="weight (Bind and server options)"></a><a class="anchor" name="weight (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="weight"></a><a href="#5.2-weight">weight</a></b> <span style="color: #080">&lt;weight&gt;</span></div><pre class="text">May be used in the following contexts: tcp, http

The &quot;<a href="#weight">weight</a>&quot; parameter is used to adjust the server's weight relative to
other servers. All servers will receive a load proportional to their weight
relative to the sum of all weights, so the higher the weight, the higher the
load. The default weight is 1, and the maximal value is 256. A value of 0
means the server will not participate in load-balancing but will still accept
persistent connections. If this parameter is used to distribute the load
according to server's capacity, it is recommended to start with values which
can both grow and shrink, for instance between 10 and 100 to leave enough
room above and below for later adjustments.
</pre><a class="anchor" name="ws"></a><a class="anchor" name="5-ws"></a><a class="anchor" name="5.2-ws"></a><a class="anchor" name="ws (Bind and server options)"></a><a class="anchor" name="ws (Server and default-server options)"></a><div class="keyword"><b><a class="anchor" name="ws"></a><a href="#5.2-ws">ws</a></b> <span style="color: #800">{ auto | h1 | h2 }</span></div><pre class="text">May be used in the following contexts: http

This option allows to configure the protocol used when relaying websocket
streams. This is most notably useful when using an HTTP/2 backend without the
support for H2 websockets through the RFC8441.

The default mode is &quot;auto&quot;. This will reuse the same protocol as the main
one. The only difference is when using ALPN. In this case, it can try to
downgrade the ALPN to &quot;http/1.1&quot; only for websocket streams if the configured
server ALPN contains it.

The value &quot;h1&quot; is used to force HTTP/1.1 for websockets streams, through ALPN
if SSL ALPN is activated for the server. Similarly, &quot;h2&quot; can be used to
force HTTP/2.0 websockets. Use this value with care : the server must support
RFC8441 or an error will be reported by haproxy when relaying websockets.

Note that NPN is not taken into account as its usage has been deprecated in
favor of the ALPN extension.

See also &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">alpn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#alpn%20%28Bind%20options%29">Bind options</a></li><li><a href="#alpn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">proto<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#proto%20%28Bind%20options%29">Bind options</a></li><li><a href="#proto%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;.
</pre></div>
<a class="anchor" id="5.3" name="5.3"></a>
<h2 id="chapter-5.3" data-target="5.3"><small><a class="small" href="#5.3">5.3.</a></small> Server IP address resolution using DNS</h2>
<div><pre class="text">HAProxy allows using a host name on the server line to retrieve its IP address
using name servers. By default, HAProxy resolves the name when parsing the
configuration file, at startup and cache the result for the process's life.
This is not sufficient in some cases, such as in Amazon where a server's IP
can change after a reboot or an ELB Virtual IP can change based on current
workload.
This chapter describes how HAProxy can be configured to process server's name
resolution at run time.
Whether run time server name resolution has been enable or not, HAProxy will
carry on doing the first resolution when parsing the configuration.
</pre></div>
<a class="anchor" id="5.3.1" name="5.3.1"></a>
<h3 id="chapter-5.3.1" data-target="5.3.1"><small><a class="small" href="#5.3.1">5.3.1.</a></small> Global overview</h3>
<div><pre class="text">As we've seen in introduction, name resolution in HAProxy occurs at two
different steps of the process life:

  1. when starting up, HAProxy parses the server line definition and matches a
     host name. It uses libc functions to get the host name resolved. This
     resolution relies on /etc/resolv.conf file.

  2. at run time, HAProxy performs periodically name resolutions for servers
     requiring DNS resolutions.

A few other events can trigger a name resolution at run time:
  - when a server's health check ends up in a connection timeout: this may be
    because the server has a new IP address. So we need to trigger a name
    resolution to know this new IP.

When using resolvers, the server name can either be a hostname, or a SRV label.
HAProxy considers anything that starts with an underscore as a SRV label. If a
SRV label is specified, then the corresponding SRV records will be retrieved
from the DNS server, and the provided hostnames will be used. The SRV label
will be checked periodically, and if any server are added or removed, HAProxy
will automatically do the same.

A few things important to notice:
  - all the name servers are queried in the meantime. HAProxy will process the
    first valid response.

  - a resolution is considered as invalid (NX, timeout, refused), when all the
    servers return an error.
</pre></div>
<a class="anchor" id="5.3.2" name="5.3.2"></a>
<h3 id="chapter-5.3.2" data-target="5.3.2"><small><a class="small" href="#5.3.2">5.3.2.</a></small> The resolvers section</h3>
<div><pre class="text">This section is dedicated to host information related to name resolution in
HAProxy. There can be as many as resolvers section as needed. Each section can
contain many name servers.

At startup, HAProxy tries to generate a resolvers section named &quot;default&quot;, if
no section was named this way in the configuration. This section is used by
default by the httpclient and uses the parse-resolv-conf keyword. If HAProxy
failed to generate automatically this section, no error or warning are emitted.

When multiple name servers are configured in a resolvers section, then HAProxy
uses the first valid response. In case of invalid responses, only the last one
is treated. Purpose is to give the chance to a slow server to deliver a valid
answer after a fast faulty or outdated server.

When each server returns a different error type, then only the last error is
used by HAProxy. The following processing is applied on this error:

  1. HAProxy retries the same DNS query with a new query type. The A queries are
     switch to AAAA or the opposite. SRV queries are not concerned here. Timeout
     errors are also excluded.

  2. When the fallback on the query type was done (or not applicable), HAProxy
     retries the original DNS query, with the preferred query type.

  3. HAProxy retries previous steps &lt;resolve_retries&gt; times. If no valid
     response is received after that, it stops the DNS resolution and reports
     the error.

For example, with 2 name servers configured in a resolvers section, the
following scenarios are possible:

  - First response is valid and is applied directly, second response is
    ignored

  - First response is invalid and second one is valid, then second response is
    applied

  - First response is a NX domain and second one a truncated response, then
    HAProxy retries the query with a new type

  - First response is a NX domain and second one is a timeout, then HAProxy
    retries the query with a new type

  - Query timed out for both name servers, then HAProxy retries it with the
    same query type

As a DNS server may not answer all the IPs in one DNS request, HAProxy keeps
a cache of previous answers, an answer will be considered obsolete after
&lt;hold obsolete&gt; seconds without the IP returned.
</pre><a class="anchor" name="resolvers"></a><a class="anchor" name="5-resolvers"></a><a class="anchor" name="5.3.2-resolvers"></a><a class="anchor" name="resolvers (Bind and server options)"></a><a class="anchor" name="resolvers (The resolvers section)"></a><div class="keyword"><b><a class="anchor" name="resolvers"></a><a href="#5.3.2-resolvers">resolvers</a></b> <span style="color: #080">&lt;resolvers id&gt;</span></div><pre class="text">  Creates a new name server list labeled &lt;resolvers id&gt;

A resolvers section accept the following parameters:
</pre><a class="anchor" name="accepted_payload_size"></a><a class="anchor" name="5-accepted_payload_size"></a><a class="anchor" name="5.3.2-accepted_payload_size"></a><a class="anchor" name="accepted_payload_size (Bind and server options)"></a><a class="anchor" name="accepted_payload_size (The resolvers section)"></a><div class="keyword"><b><a class="anchor" name="accepted_payload_size"></a><a href="#5.3.2-accepted_payload_size">accepted_payload_size</a></b> <span style="color: #080">&lt;nb&gt;</span></div><pre class="text">Defines the maximum payload size accepted by HAProxy and announced to all the
name servers configured in this resolvers section.
&lt;nb&gt; is in bytes. If not set, HAProxy announces 512. (minimal value defined
     by RFC 6891)

Note: the maximum allowed value is 65535. Recommended value for UDP is
      4096 and it is not recommended to exceed 8192 except if you are sure
      that your system and network can handle this (over 65507 makes no sense
      since is the maximum UDP payload size). If you are using only TCP
      nameservers to handle huge DNS responses, you should put this value
      to the max: 65535.
</pre><a class="anchor" name="nameserver"></a><a class="anchor" name="5-nameserver"></a><a class="anchor" name="5.3.2-nameserver"></a><a class="anchor" name="nameserver (Bind and server options)"></a><a class="anchor" name="nameserver (The resolvers section)"></a><div class="keyword"><b><a class="anchor" name="nameserver"></a><a href="#5.3.2-nameserver">nameserver</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #080">&lt;address&gt;</span><span style="color: #008">[:port]</span> <span style="color: #008">[param*]</span></div><pre class="text">Used to configure a nameserver. &lt;name&gt; of the nameserver should ne unique.
By default the &lt;address&gt; is considered of type datagram. This means if an
IPv4 or IPv6 is configured without special address prefixes (paragraph 11.)
the UDP protocol will be used.  If an stream protocol address prefix is used,
the nameserver will be considered as a stream server (TCP for instance) and
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; parameters found in 5.2 paragraph which are relevant for DNS
resolving will be considered.  Note: currently, in TCP mode, 4 queries are
pipelined on the same connections. A batch of idle connections are removed
every 5 seconds. &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; can be configured to limit the amount of those
concurrent connections and TLS should also usable if the server supports.
</pre><a class="anchor" name="parse-resolv-conf"></a><a class="anchor" name="5-parse-resolv-conf"></a><a class="anchor" name="5.3.2-parse-resolv-conf"></a><a class="anchor" name="parse-resolv-conf (Bind and server options)"></a><a class="anchor" name="parse-resolv-conf (The resolvers section)"></a><div class="keyword"><b><a class="anchor" name="parse-resolv-conf"></a><a href="#5.3.2-parse-resolv-conf">parse-resolv-conf</a></b></div><pre class="text">Adds all nameservers found in /etc/resolv.conf to this resolvers nameservers
list. Ordered as if each nameserver in /etc/resolv.conf was individually
placed in the resolvers section in place of this directive.
</pre><a class="anchor" name="hold"></a><a class="anchor" name="5-hold"></a><a class="anchor" name="5.3.2-hold"></a><a class="anchor" name="hold (Bind and server options)"></a><a class="anchor" name="hold (The resolvers section)"></a><div class="keyword"><b><a class="anchor" name="hold"></a><a href="#5.3.2-hold">hold</a></b> <span style="color: #080">&lt;status&gt;</span> <span style="color: #080">&lt;period&gt;</span></div><pre class="text">Upon receiving the DNS response &lt;status&gt;, determines whether a server's state
should change from UP to DOWN. To make that determination, it checks whether
any valid status has been received during the past &lt;period&gt; in order to
counteract the just received invalid status.

  &lt;status&gt; : last name resolution status.
         nx        After receiving an NXDOMAIN status, check for any valid
                   status during the concluding period.

         refused   After receiving a REFUSED status, check for any valid
                   status during the concluding period.

         timeout   After the &quot;timeout retry&quot; has struck, check for any
                   valid status during the concluding period.

         other     After receiving any other invalid status, check for any
                   valid status during the concluding period.

         valid     Applies only to &quot;http-request do-resolve&quot; and
                   &quot;tcp-request content do-resolve&quot; actions. It defines the
                   period for which the server will maintain a valid response
                   before triggering another resolution. It does not affect
                   dynamic resolution of servers.

         obsolete  Defines how long to wait before removing obsolete DNS
                   records after an updated answer record is received. It
                   applies to SRV records.

  &lt;period&gt; : Amount of time into the past during which a valid response must
             have been received. It follows the HAProxy time format and is in
             milliseconds by default.

For a server that relies on dynamic DNS resolution to determine its IP
address, receiving an invalid DNS response, such as NXDOMAIN, will lead to
changing the server's state from UP to DOWN. The hold directives define how
far into the past to look for a valid response. If a valid response has been
received within &lt;period&gt;, the just received invalid status will be ignored.

Unless a valid response has been receiving during the concluding period, the
server will be marked as DOWN. For example, if &quot;hold nx 30s&quot; is set and the
last received DNS response was NXDOMAIN, the server will be marked DOWN
unless a valid response has been received during the last 30 seconds.

A server in the DOWN state will be marked UP immediately upon receiving a
valid status from the DNS server.

A separate behavior exists for &quot;hold valid&quot; and &quot;hold obsolete&quot;.
</pre><a class="anchor" name="resolve_retries"></a><a class="anchor" name="5-resolve_retries"></a><a class="anchor" name="5.3.2-resolve_retries"></a><a class="anchor" name="resolve_retries (Bind and server options)"></a><a class="anchor" name="resolve_retries (The resolvers section)"></a><div class="keyword"><b><a class="anchor" name="resolve_retries"></a><a href="#5.3.2-resolve_retries">resolve_retries</a></b> <span style="color: #080">&lt;nb&gt;</span></div><pre class="text">Defines the number &lt;nb&gt; of queries to send to resolve a server name before
giving up.
Default value: 3

A retry occurs on name server timeout or when the full sequence of DNS query
type failover is over and we need to start up from the default ANY query
type.
</pre><a class="anchor" name="timeout"></a><a class="anchor" name="5-timeout"></a><a class="anchor" name="5.3.2-timeout"></a><a class="anchor" name="timeout (Bind and server options)"></a><a class="anchor" name="timeout (The resolvers section)"></a><div class="keyword"><b><a class="anchor" name="timeout"></a><a href="#5.3.2-timeout">timeout</a></b> <span style="color: #080">&lt;event&gt;</span> <span style="color: #080">&lt;time&gt;</span></div><pre class="text">Defines timeouts related to name resolution
   &lt;event&gt; : the event on which the &lt;time&gt; timeout period applies to.
             events available are:
             - resolve : default time to trigger name resolutions when no
                         other time applied.
                         Default value: 1s
             - retry   : time between two DNS queries, when no valid response
                         have been received.
                         Default value: 1s
   &lt;time&gt;  : time related to the event. It follows the HAProxy time format.
             &lt;time&gt; is expressed in milliseconds.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>resolvers mydns
  nameserver dns1 10.0.0.1:53
  nameserver dns2 10.0.0.2:53
  nameserver dns3 tcp@10.0.0.3:53
  parse-resolv-conf
  resolve_retries       3
  timeout resolve       1s
  timeout retry         1s
  hold other           30s
  hold refused         30s
  hold nx              30s
  hold timeout         30s
  hold valid           10s
  hold obsolete        30s
</code></pre>
</div></div>
<a class="anchor" id="6" name="6"></a>
<div class="page-header"><h1 id="chapter-6" data-target="6"><small><a class="small" href="#6">6.</a></small> Cache</h1>
</div><div><pre class="text">HAProxy provides a cache, which was designed to perform cache on small objects
(favicon, css...). This is a minimalist low-maintenance cache which runs in
RAM.

The cache is based on a memory area shared between all threads, and split in 1kB
blocks.

If an object is not used anymore, it can be deleted to store a new object
independently of its expiration date. The oldest objects are deleted first
when we try to allocate a new one.

The cache uses a hash of the host header and the URI as the key.

It's possible to view the status of a cache using the Unix socket command
&quot;show cache&quot; consult <a href="#9.3">section 9.3</a> &quot;Unix Socket commands&quot; of Management Guide
for more details.

When an object is delivered from the cache, the server name in the log is
replaced by &quot;&lt;CACHE&gt;&quot;.
</pre></div>
<a class="anchor" id="6.1" name="6.1"></a>
<h2 id="chapter-6.1" data-target="6.1"><small><a class="small" href="#6.1">6.1.</a></small> Limitation</h2>
<div><pre class="text">The cache won't store and won't deliver objects in these cases:

- If the response is not a 200
- If the response contains a Vary header and either the process-vary option is
  disabled, or a currently unmanaged header is specified in the Vary value (only
  accept-encoding, referer and origin are managed for now)
- If the Content-Length + the headers size is greater than &quot;<a href="#max-object-size">max-object-size</a>&quot;
- If the response is not cacheable
- If the response does not have an explicit expiration time (s-maxage or max-age
  Cache-Control directives or Expires header) or a validator (ETag or Last-Modified
  headers)
- If the process-vary option is enabled and there are already max-secondary-entries
  entries with the same primary key as the current response
- If the process-vary option is enabled and the response has an unknown encoding (not
  mentioned in https://www.iana.org/assignments/http-parameters/http-parameters.xhtml)
  while varying on the accept-encoding client header

- If the request is not a GET
- If the HTTP version of the request is smaller than 1.1
- If the request contains an Authorization header
</pre></div>
<a class="anchor" id="6.2" name="6.2"></a>
<h2 id="chapter-6.2" data-target="6.2"><small><a class="small" href="#6.2">6.2.</a></small> Setup</h2>
<div><pre class="text">To setup a cache, you must define a cache section and use it in a proxy with
the corresponding http-request and http-response actions.
</pre></div>
<a class="anchor" id="6.2.1" name="6.2.1"></a>
<h3 id="chapter-6.2.1" data-target="6.2.1"><small><a class="small" href="#6.2.1">6.2.1.</a></small> Cache section</h3>
<div><a class="anchor" name="cache"></a><a class="anchor" name="6-cache"></a><a class="anchor" name="6.2.1-cache"></a><a class="anchor" name="cache (Cache)"></a><a class="anchor" name="cache (Cache section)"></a><div class="keyword"><b><a class="anchor" name="cache"></a><a href="#6.2.1-cache">cache</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">Declare a cache section, allocate a shared cache memory named &lt;name&gt;, the
size of cache is mandatory.
</pre><a class="anchor" name="total-max-size"></a><a class="anchor" name="6-total-max-size"></a><a class="anchor" name="6.2.1-total-max-size"></a><a class="anchor" name="total-max-size (Cache)"></a><a class="anchor" name="total-max-size (Cache section)"></a><div class="keyword"><b><a class="anchor" name="total-max-size"></a><a href="#6.2.1-total-max-size">total-max-size</a></b> <span style="color: #080">&lt;megabytes&gt;</span></div><pre class="text">Define the size in RAM of the cache in megabytes. This size is split in
blocks of 1kB which are used by the cache entries. Its maximum value is 4095.
</pre><a class="anchor" name="max-object-size"></a><a class="anchor" name="6-max-object-size"></a><a class="anchor" name="6.2.1-max-object-size"></a><a class="anchor" name="max-object-size (Cache)"></a><a class="anchor" name="max-object-size (Cache section)"></a><div class="keyword"><b><a class="anchor" name="max-object-size"></a><a href="#6.2.1-max-object-size">max-object-size</a></b> <span style="color: #080">&lt;bytes&gt;</span></div><pre class="text">Define the maximum size of the objects to be cached. Must not be greater than
an half of &quot;<a href="#total-max-size">total-max-size</a>&quot;. If not set, it equals to a 256th of the cache size.
All objects with sizes larger than &quot;<a href="#max-object-size">max-object-size</a>&quot; will not be cached.
</pre><a class="anchor" name="max-age"></a><a class="anchor" name="6-max-age"></a><a class="anchor" name="6.2.1-max-age"></a><a class="anchor" name="max-age (Cache)"></a><a class="anchor" name="max-age (Cache section)"></a><div class="keyword"><b><a class="anchor" name="max-age"></a><a href="#6.2.1-max-age">max-age</a></b> <span style="color: #080">&lt;seconds&gt;</span></div><pre class="text">Define the maximum expiration duration. The expiration is set as the lowest
value between the s-maxage or max-age (in this order) directive in the
Cache-Control response header and this value. The default value is 60
seconds, which means that you can't cache an object more than 60 seconds by
default.
</pre><a class="anchor" name="process-vary"></a><a class="anchor" name="6-process-vary"></a><a class="anchor" name="6.2.1-process-vary"></a><a class="anchor" name="process-vary (Cache)"></a><a class="anchor" name="process-vary (Cache section)"></a><div class="keyword"><b><a class="anchor" name="process-vary"></a><a href="#6.2.1-process-vary">process-vary</a></b> <span style="color: #080">&lt;on/off&gt;</span></div><pre class="text">Enable or disable the processing of the Vary header. When disabled, a response
containing such a header will never be cached. When enabled, we need to calculate
a preliminary hash for a subset of request headers on all the incoming requests
(which might come with a cpu cost) which will be used to build a secondary
key for a given request (see RFC 7234#4.1). The secondary key is built out of
the contents of the 'accept-encoding', 'referer' and 'origin' headers for
now. The default value is off (disabled).
</pre><a class="anchor" name="max-secondary-entries"></a><a class="anchor" name="6-max-secondary-entries"></a><a class="anchor" name="6.2.1-max-secondary-entries"></a><a class="anchor" name="max-secondary-entries (Cache)"></a><a class="anchor" name="max-secondary-entries (Cache section)"></a><div class="keyword"><b><a class="anchor" name="max-secondary-entries"></a><a href="#6.2.1-max-secondary-entries">max-secondary-entries</a></b> <span style="color: #080">&lt;number&gt;</span></div><pre class="text">Define the maximum number of simultaneous secondary entries with the same primary
key in the cache. This needs the vary support to be enabled. Its default value is 10
and should be passed a strictly positive integer.
</pre></div>
<a class="anchor" id="6.2.2" name="6.2.2"></a>
<h3 id="chapter-6.2.2" data-target="6.2.2"><small><a class="small" href="#6.2.2">6.2.2.</a></small> Proxy section</h3>
<div><pre class="text">The proxy section making use of the cache will need to involve the &quot;<a href="#cache-use">cache-use</a>&quot;
action in the &quot;<a href="#http-request">http-request</a>&quot; rule set in order to look up the requested object
from the cache, and the &quot;<a href="#cache-store">cache-store</a>&quot; action in the &quot;<a href="#http-response">http-response</a>&quot; rule set in
order to store or update the retrieved object into the cache. Each of these
actions may optionally involve conditions. For example, one could decide to
skip the &quot;<a href="#cache-use">cache-use</a>&quot; action for a certain sub-directory that is known not to
be cacheable, or to skip the &quot;<a href="#cache-store">cache-store</a>&quot; action for certain content-types
that are known to be worthless. Please note that the cache indexing key is
computed during the &quot;<a href="#cache-use">cache-use</a>&quot; action, so if this action is skipped, no
attempt to update the cache will be made on the response path anyway.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>backend bck1
  mode http

  http-request cache-use foobar
  http-response cache-store foobar
  server srv1 127.0.0.1:80

cache foobar
  total-max-size 4
  max-age 240
</code></pre>
</div></div>
<a class="anchor" id="7" name="7"></a>
<div class="page-header"><h1 id="chapter-7" data-target="7"><small><a class="small" href="#7">7.</a></small> Using ACLs and fetching samples</h1>
</div><div><pre class="text">HAProxy is capable of extracting data from request or response streams, from
client or server information, from tables, environmental information etc...
The action of extracting such data is called fetching a sample. Once retrieved,
these samples may be used for various purposes such as a key to a stick-table,
but most common usages consist in matching them against predefined constant
data called patterns.
</pre></div>
<a class="anchor" id="7.1" name="7.1"></a>
<h2 id="chapter-7.1" data-target="7.1"><small><a class="small" href="#7.1">7.1.</a></small> ACL basics</h2>
<div><pre class="text">The use of Access Control Lists (ACL) provides a flexible solution to perform
content switching and generally to take decisions based on content extracted
from the request, the response or any environmental status. The principle is
simple :

  - extract a data sample from a stream, table or the environment
  - optionally apply some format conversion to the extracted sample
  - apply one or multiple pattern matching methods on this sample
  - perform actions only when a pattern matches the sample

The actions generally consist in blocking a request, selecting a backend, or
adding a header.

In order to define a test, the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">acl<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#acl%20%28Fcgi-app%20section%29">Fcgi-app section</a></li><li><a href="#acl%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#acl%20%28Fetching%20samples%20from%20internal%20states%29">Fetching samples from internal states</a></li></ul></span>&quot; keyword is used. The syntax is :

   acl &lt;aclname&gt; &lt;criterion&gt; [flags] [operator] [&lt;value&gt;] ...

This creates a new ACL &lt;aclname&gt; or completes an existing one with new tests.
Those tests apply to the portion of request/response specified in &lt;criterion&gt;
and may be adjusted with optional flags [flags]. Some criteria also support
an operator which may be specified before the set of values. Optionally some
conversion operators may be applied to the sample, and they will be specified
as a comma-delimited list of keywords just after the first keyword. The values
are of the type supported by the criterion, and are separated by spaces.

ACL names must be formed from upper and lower case letters, digits, '-' (dash),
'_' (underscore) , '.' (dot) and ':' (colon). ACL names are case-sensitive,
which means that &quot;my_acl&quot; and &quot;My_Acl&quot; are two different ACLs.

There is no enforced limit to the number of ACLs. The unused ones do not affect
performance, they just consume a small amount of memory.

The criterion generally is the name of a sample fetch method, or one of its ACL
specific declinations. The default test method is implied by the output type of
this sample fetch method. The ACL declinations can describe alternate matching
methods of a same sample fetch method. The sample fetch methods are the only
ones supporting a conversion.

Sample fetch methods return data which can be of the following types :
  - boolean
  - integer (signed or unsigned)
  - IPv4 or IPv6 address
  - string
  - data block

Converters transform any of these data into any of these. For example, some
converters might convert a string to a lower-case string while other ones
would turn a string to an IPv4 address, or apply a netmask to an IP address.
The resulting sample is of the type of the last converter applied to the list,
which defaults to the type of the sample fetch method.

Each sample or converter returns data of a specific type, specified with its
keyword in this documentation. When an ACL is declared using a standard sample
fetch method, certain types automatically involved a default matching method
which are summarized in the table below :

   +---------------------+-----------------+
   | Sample or converter | Default         |
   |    output type      | matching method |
   +---------------------+-----------------+
   | boolean             | bool            |
   +---------------------+-----------------+
   | integer             | int             |
   +---------------------+-----------------+
   | ip                  | ip              |
   +---------------------+-----------------+
   | string              | str             |
   +---------------------+-----------------+
   | binary              | none, use &quot;-m&quot;  |
   +---------------------+-----------------+

Note that in order to match a binary samples, it is mandatory to specify a
matching method, see below.

The ACL engine can match these types against patterns of the following types :
  - boolean
  - integer or integer range
  - IP address / network
  - string (exact, substring, suffix, prefix, subdir, domain)
  - regular expression
  - hex block

The following ACL flags are currently supported :

   -i : ignore case during matching of all subsequent patterns.
   -f : load patterns from a list.
   -m : use a specific pattern matching method
   -n : forbid the DNS resolutions
   -M : load the file pointed by -f like a map.
   -u : force the unique id of the ACL
   -- : force end of flags. Useful when a string looks like one of the flags.

The &quot;-f&quot; flag is followed by the name that must follow the format described in
2.7. about name format for maps and ACLs. It is even possible to pass multiple
&quot;-f&quot; arguments if the patterns are to be loaded from multiple lists. if an
existing file is referenced, all lines will be read as individual values. Empty
lines as well as lines beginning with a sharp ('#') will be ignored. All
leading spaces and tabs will be stripped. If it is absolutely necessary to
insert a valid pattern beginning with a sharp, just prefix it with a space so
that it is not taken for a comment. Depending on the data type and match
method, HAProxy may load the lines into a binary tree, allowing very fast
lookups. This is true for IPv4 and exact string matching. In this case,
duplicates will automatically be removed.

The &quot;-M&quot; flag allows an ACL to use a map. If this flag is set, the list is
parsed as two column entries. The first column contains the patterns used by the
ACL, and the second column contain the samples. The sample can be used later by
a map. This can be useful in some rare cases where an ACL would just be used to
check for the existence of a pattern in a map before a mapping is applied.

The &quot;-u&quot; flag forces the unique id of the ACL. This unique id is used with the
socket interface to identify ACL and dynamically change its values. Note that a
file is always identified by its name even if an id is set.

Also, note that the &quot;-i&quot; flag applies to subsequent entries and not to entries
loaded from files preceding it. For instance :

    acl valid-ua hdr(user-agent) -f exact-ua.lst -i -f generic-ua.lst test

In this example, each line of &quot;exact-ua.lst&quot; will be exactly matched against
the &quot;user-agent&quot; header of the request. Then each line of &quot;generic-ua&quot; will be
case-insensitively matched. Then the word &quot;test&quot; will be insensitively matched
as well.

The &quot;-m&quot; flag is used to select a specific pattern matching method on the input
sample. All ACL-specific criteria imply a pattern matching method and generally
do not need this flag. However, this flag is useful with generic sample fetch
methods to describe how they're going to be matched against the patterns. This
is required for sample fetches which return data type for which there is no
obvious matching method (e.g. string or binary). When &quot;-m&quot; is specified and
followed by a pattern matching method name, this method is used instead of the
default one for the criterion. This makes it possible to match contents in ways
that were not initially planned, or with sample fetch methods which return a
string. The matching method also affects the way the patterns are parsed.

The &quot;-n&quot; flag forbids the dns resolutions. It is used with the load of ip files.
By default, if the parser cannot parse ip address it considers that the parsed
string is maybe a domain name and try dns resolution. The flag &quot;-n&quot; disable this
resolution. It is useful for detecting malformed ip lists. Note that if the DNS
server is not reachable, the HAProxy configuration parsing may last many minutes
waiting for the timeout. During this time no error messages are displayed. The
flag &quot;-n&quot; disable this behavior. Note also that during the runtime, this
function is disabled for the dynamic acl modifications.

There are some restrictions however. Not all methods can be used with all
sample fetch methods. Also, if &quot;-m&quot; is used in conjunction with &quot;-f&quot;, it must
be placed first. The pattern matching method must be one of the following :

  - &quot;found&quot; : only check if the requested sample could be found in the stream,
              but do not compare it against any pattern. It is recommended not
              to pass any pattern to avoid confusion. This matching method is
              particularly useful to detect presence of certain contents such
              as headers, cookies, etc... even if they are empty and without
              comparing them to anything nor counting them.

  - &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bool<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bool%20%28Converters%29">Converters</a></li><li><a href="#bool%20%28Fetching%20samples%20from%20internal%20states%29">Fetching samples from internal states</a></li></ul></span>&quot;  : check the value as a boolean. It can only be applied to fetches
              which return a boolean or integer value, and takes no pattern.
              Value zero or false does not match, all other values do match.

  - &quot;<a href="#int">int</a>&quot;   : match the value as an integer. It can be used with integer and
              boolean samples. Boolean false is integer 0, true is integer 1.

  - &quot;ip&quot;    : match the value as an IPv4 or IPv6 address. It is compatible
              with IP address samples only, so it is implied and never needed.

  - &quot;<a href="#bin">bin</a>&quot;   : match the contents against a hexadecimal string representing a
              binary sequence. This may be used with binary or string samples.

  - &quot;len&quot;   : match the sample's length as an integer. This may be used with
              binary or string samples.

  - &quot;<a href="#str">str</a>&quot;   : exact match : match the contents against a string. This may be
              used with binary or string samples.

  - &quot;<a href="#sub">sub</a>&quot;   : substring match : check that the contents contain at least one of
              the provided string patterns. This may be used with binary or
              string samples.

  - &quot;reg&quot;   : regex match : match the contents against a list of regular
              expressions. This may be used with binary or string samples.

  - &quot;beg&quot;   : prefix match : check that the contents begin like the provided
              string patterns. This may be used with binary or string samples.

  - &quot;end&quot;   : suffix match : check that the contents end like the provided
              string patterns. This may be used with binary or string samples.

  - &quot;dir&quot;   : subdir match : check that a slash-delimited portion of the
              contents exactly matches one of the provided string patterns.
              This may be used with binary or string samples.

  - &quot;dom&quot;   : domain match : check that a dot-delimited portion of the contents
              exactly match one of the provided string patterns. This may be
              used with binary or string samples.

For example, to quickly detect the presence of cookie &quot;JSESSIONID&quot; in an HTTP
request, it is possible to do :

    acl jsess_present req.cook(JSESSIONID) -m found

In order to apply a regular expression on the 500 first bytes of data in the
buffer, one would use the following acl :

    acl script_tag req.payload(0,500) -m reg -i &lt;script&gt;

On systems where the regex library is much slower when using &quot;-i&quot;, it is
possible to convert the sample to lowercase before matching, like this :

    acl script_tag req.payload(0,500),lower -m reg &lt;script&gt;

All ACL-specific criteria imply a default matching method. Most often, these
criteria are composed by concatenating the name of the original sample fetch
method and the matching method. For example, &quot;hdr_beg&quot; applies the &quot;beg&quot; match
to samples retrieved using the &quot;<a href="#hdr">hdr</a>&quot; fetch method. This matching method is only
usable when the keyword is used alone, without any converter. In case any such
converter were to be applied after such an ACL keyword, the default matching
method from the ACL keyword is simply ignored since what will matter for the
matching is the output type of the last converter. Since all ACL-specific
criteria rely on a sample fetch method, it is always possible instead to use
the original sample fetch method and the explicit matching method using &quot;-m&quot;.

If an alternate match is specified using &quot;-m&quot; on an ACL-specific criterion,
the matching method is simply applied to the underlying sample fetch method.
For example, all ACLs below are exact equivalent :

    acl short_form  hdr_beg(host)        www.
    acl alternate1  hdr_beg(host) -m beg www.
    acl alternate2  hdr_dom(host) -m beg www.
    acl alternate3  hdr(host)     -m beg www.


The table below summarizes the compatibility matrix between sample or converter
types and the pattern types to fetch against. It indicates for each compatible
combination the name of the matching method to be used, surrounded with angle
brackets &quot;&gt;&quot; and &quot;&lt;&quot; when the method is the default one and will work by
default without &quot;-m&quot;.

                           +-------------------------------------------------+
                           |                Input sample type                |
    +----------------------+---------+---------+---------+---------+---------+
    |     pattern type     | boolean | integer |   ip    | string  | binary  |
    +----------------------+---------+---------+---------+---------+---------+
    | none (presence only) |  found  |  found  |  found  |  found  |  found  |
    +----------------------+---------+---------+---------+---------+---------+
    | none (boolean value) |&gt;  bool &lt;|   bool  |         |   bool  |         |
    +----------------------+---------+---------+---------+---------+---------+
    | integer (value)      |   int   |&gt;  int  &lt;|   int   |   int   |         |
    +----------------------+---------+---------+---------+---------+---------+
    | integer (length)     |   len   |   len   |   len   |   len   |   len   |
    +----------------------+---------+---------+---------+---------+---------+
    | IP address           |         |         |&gt;   ip  &lt;|    ip   |    ip   |
    +----------------------+---------+---------+---------+---------+---------+
    | exact string         |   str   |   str   |   str   |&gt;  str  &lt;|   str   |
    +----------------------+---------+---------+---------+---------+---------+
    | prefix               |   beg   |   beg   |   beg   |   beg   |   beg   |
    +----------------------+---------+---------+---------+---------+---------+
    | suffix               |   end   |   end   |   end   |   end   |   end   |
    +----------------------+---------+---------+---------+---------+---------+
    | substring            |   sub   |   sub   |   sub   |   sub   |   sub   |
    +----------------------+---------+---------+---------+---------+---------+
    | subdir               |   dir   |   dir   |   dir   |   dir   |   dir   |
    +----------------------+---------+---------+---------+---------+---------+
    | domain               |   dom   |   dom   |   dom   |   dom   |   dom   |
    +----------------------+---------+---------+---------+---------+---------+
    | regex                |   reg   |   reg   |   reg   |   reg   |   reg   |
    +----------------------+---------+---------+---------+---------+---------+
    | hex block            |         |         |         |   bin   |   bin   |
    +----------------------+---------+---------+---------+---------+---------+
</pre></div>
<a class="anchor" id="7.1.1" name="7.1.1"></a>
<h3 id="chapter-7.1.1" data-target="7.1.1"><small><a class="small" href="#7.1.1">7.1.1.</a></small> Matching booleans</h3>
<div><pre class="text">In order to match a boolean, no value is needed and all values are ignored.
Boolean matching is used by default for all fetch methods of type &quot;boolean&quot;.
When boolean matching is used, the fetched value is returned as-is, which means
that a boolean &quot;true&quot; will always match and a boolean &quot;false&quot; will never match.

Boolean matching may also be enforced using &quot;-m bool&quot; on fetch methods which
return an integer value. Then, integer value 0 is converted to the boolean
&quot;false&quot; and all other values are converted to &quot;true&quot;.
</pre></div>
<a class="anchor" id="7.1.2" name="7.1.2"></a>
<h3 id="chapter-7.1.2" data-target="7.1.2"><small><a class="small" href="#7.1.2">7.1.2.</a></small> Matching integers</h3>
<div><pre class="text">Integer matching applies by default to integer fetch methods. It can also be
enforced on boolean fetches using &quot;-m int&quot;. In this case, &quot;false&quot; is converted
to the integer 0, and &quot;true&quot; is converted to the integer 1.

Integer matching also supports integer ranges and operators. Note that integer
matching only applies to positive values. A range is a value expressed with a
lower and an upper bound separated with a colon, both of which may be omitted.

For instance, &quot;1024:65535&quot; is a valid range to represent a range of
unprivileged ports, and &quot;1024:&quot; would also work. &quot;0:1023&quot; is a valid
representation of privileged ports, and &quot;:1023&quot; would also work.

As a special case, some ACL functions support decimal numbers which are in fact
two integers separated by a dot. This is used with some version checks for
instance. All integer properties apply to those decimal numbers, including
ranges and operators.

For an easier usage, comparison operators are also supported. Note that using
operators with ranges does not make much sense and is strongly discouraged.
Similarly, it does not make much sense to perform order comparisons with a set
of values.

Available operators for integer matching are :

  eq : true if the tested value equals at least one value
  ge : true if the tested value is greater than or equal to at least one value
  gt : true if the tested value is greater than at least one value
  le : true if the tested value is less than or equal to at least one value
  lt : true if the tested value is less than at least one value

For instance, the following ACL matches any negative Content-Length header :

  acl negative-length req.hdr_val(content-length) lt 0

This one matches SSL versions between 3.0 and 3.1 (inclusive) :

  acl sslv3 req.ssl_ver 3:3.1
</pre></div>
<a class="anchor" id="7.1.3" name="7.1.3"></a>
<h3 id="chapter-7.1.3" data-target="7.1.3"><small><a class="small" href="#7.1.3">7.1.3.</a></small> Matching strings</h3>
<div><pre class="text">String matching applies to string or binary fetch methods, and exists in 6
different forms :

  - exact match     (-m str) : the extracted string must exactly match the
    patterns;

  - substring match (-m sub) : the patterns are looked up inside the
    extracted string, and the ACL matches if any of them is found inside;

  - prefix match    (-m beg) : the patterns are compared with the beginning of
    the extracted string, and the ACL matches if any of them matches.

  - suffix match    (-m end) : the patterns are compared with the end of the
    extracted string, and the ACL matches if any of them matches.

  - subdir match    (-m dir) : the patterns are looked up anywhere inside the
    extracted string, delimited with slashes (&quot;/&quot;), the beginning or the end
    of the string. The ACL matches if any of them matches. As such, the string
    &quot;/images/png/logo/32x32.png&quot;, would match &quot;/images&quot;, &quot;/images/png&quot;,
    &quot;images/png&quot;, &quot;/png/logo&quot;, &quot;logo/32x32.png&quot; or &quot;32x32.png&quot; but not &quot;png&quot;
    nor &quot;32x32&quot;.

  - domain match    (-m dom) : the patterns are looked up anywhere inside the
    extracted string, delimited with dots (&quot;.&quot;), colons (&quot;:&quot;), slashes (&quot;/&quot;),
    question marks (&quot;?&quot;), the beginning or the end of the string. This is made
    to be used with URLs. Leading and trailing delimiters in the pattern are
    ignored. The ACL matches if any of them matches. As such, in the example
    string &quot;http://www1.dc-eu.example.com:80/blah&quot;, the patterns &quot;http&quot;,
    &quot;www1&quot;, &quot;.www1&quot;, &quot;dc-eu&quot;, &quot;example&quot;, &quot;com&quot;, &quot;80&quot;, &quot;dc-eu.example&quot;,
    &quot;blah&quot;, &quot;:www1:&quot;, &quot;dc-eu.example:80&quot; would match, but not &quot;eu&quot; nor &quot;dc&quot;.
    Using it to match domain suffixes for filtering or routing is generally
    not a good idea, as the routing could easily be fooled by prepending the
    matching prefix in front of another domain for example.

String matching applies to verbatim strings as they are passed, with the
exception of the backslash (&quot;\&quot;) which makes it possible to escape some
characters such as the space. If the &quot;-i&quot; flag is passed before the first
string, then the matching will be performed ignoring the case. In order
to match the string &quot;-i&quot;, either set it second, or pass the &quot;--&quot; flag
before the first string. Same applies of course to match the string &quot;--&quot;.

Do not use string matches for binary fetches which might contain null bytes
(0x00), as the comparison stops at the occurrence of the first null byte.
Instead, convert the binary fetch to a hex string with the hex converter first.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># matches if the string &lt;tag&gt; is present in the binary sample</span>
acl tag_found req.payload(0,0),hex -m sub 3C7461673E
</code></pre>
</div></div>
<a class="anchor" id="7.1.4" name="7.1.4"></a>
<h3 id="chapter-7.1.4" data-target="7.1.4"><small><a class="small" href="#7.1.4">7.1.4.</a></small> Matching regular expressions (regexes)</h3>
<div><pre class="text">Just like with string matching, regex matching applies to verbatim strings as
they are passed, with the exception of the backslash (&quot;\&quot;) which makes it
possible to escape some characters such as the space. If the &quot;-i&quot; flag is
passed before the first regex, then the matching will be performed ignoring
the case. In order to match the string &quot;-i&quot;, either set it second, or pass
the &quot;--&quot; flag before the first string. Same principle applies of course to
match the string &quot;--&quot;.
</pre></div>
<a class="anchor" id="7.1.5" name="7.1.5"></a>
<h3 id="chapter-7.1.5" data-target="7.1.5"><small><a class="small" href="#7.1.5">7.1.5.</a></small> Matching arbitrary data blocks</h3>
<div><pre class="text">It is possible to match some extracted samples against a binary block which may
not safely be represented as a string. For this, the patterns must be passed as
a series of hexadecimal digits in an even number, when the match method is set
to binary. Each sequence of two digits will represent a byte. The hexadecimal
digits may be used upper or lower case.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># match &quot;Hello\n&quot; in the input stream (\x48 \x65 \x6c \x6c \x6f \x0a)</span>
acl hello req.payload(0,6) -m bin 48656c6c6f0a
</code></pre>
</div></div>
<a class="anchor" id="7.1.6" name="7.1.6"></a>
<h3 id="chapter-7.1.6" data-target="7.1.6"><small><a class="small" href="#7.1.6">7.1.6.</a></small> Matching IPv4 and IPv6 addresses</h3>
<div><pre class="text">IPv4 addresses values can be specified either as plain addresses or with a
netmask appended, in which case the IPv4 address matches whenever it is
within the network. Plain addresses may also be replaced with a resolvable
host name, but this practice is generally discouraged as it makes it more
difficult to read and debug configurations. If hostnames are used, you should
at least ensure that they are present in /etc/hosts so that the configuration
does not depend on any random DNS match at the moment the configuration is
parsed.

The dotted IPv4 address notation is supported in both regular as well as the
abbreviated form with all-0-octets omitted:

    +------------------+------------------+------------------+
    |   Example 1      |     Example 2    |     Example 3    |
    +------------------+------------------+------------------+
    |  192.168.0.1     |   10.0.0.12      |   127.0.0.1      |
    |  192.168.1       |   10.12          |   127.1          |
    |  192.168.0.1/22  |   10.0.0.12/8    |   127.0.0.1/8    |
    |  192.168.1/22    |   10.12/8        |   127.1/8        |
    +------------------+------------------+------------------+

Notice that this is different from RFC 4632 CIDR address notation in which
192.168.42/24 would be equivalent to 192.168.42.0/24.

IPv6 may be entered in their usual form, with or without a netmask appended.
Only bit counts are accepted for IPv6 netmasks. In order to avoid any risk of
trouble with randomly resolved IP addresses, host names are never allowed in
IPv6 patterns.

HAProxy is also able to match IPv4 addresses with IPv6 addresses in the
following situations :
  - tested address is IPv4, pattern address is IPv4, the match applies
    in IPv4 using the supplied mask if any.
  - tested address is IPv6, pattern address is IPv6, the match applies
    in IPv6 using the supplied mask if any.
  - tested address is IPv6, pattern address is IPv4, the match applies in IPv4
    using the pattern's mask if the IPv6 address matches with 2002:IPV4::,
    ::IPV4 or ::ffff:IPV4, otherwise it fails.
  - tested address is IPv4, pattern address is IPv6, the IPv4 address is first
    converted to IPv6 by prefixing ::ffff: in front of it, then the match is
    applied in IPv6 using the supplied IPv6 mask.
</pre></div>
<a class="anchor" id="7.2" name="7.2"></a>
<h2 id="chapter-7.2" data-target="7.2"><small><a class="small" href="#7.2">7.2.</a></small> Using ACLs to form conditions</h2>
<div><pre class="text">Some actions are only performed upon a valid condition. A condition is a
combination of ACLs with operators. 3 operators are supported :

  - AND (implicit)
  - OR  (explicit with the &quot;<a href="#or">or</a>&quot; keyword or the &quot;||&quot; operator)
  - Negation with the exclamation mark (&quot;!&quot;)

A condition is formed as a disjunctive form:

   [!]acl1 [!]acl2 ... [!]acln  { or [!]acl1 [!]acl2 ... [!]acln } ...

Such conditions are generally used after an &quot;if&quot; or &quot;unless&quot; statement,
indicating when the condition will trigger the action.

For instance, to block HTTP requests to the &quot;*&quot; URL with methods other than
&quot;OPTIONS&quot;, as well as POST requests without content-length, and GET or HEAD
requests with a content-length greater than 0, and finally every request which
is not either GET/HEAD/POST/OPTIONS !

   acl missing_cl req.hdr_cnt(Content-length) eq 0
   http-request deny if HTTP_URL_STAR !METH_OPTIONS || METH_POST missing_cl
   http-request deny if METH_GET HTTP_CONTENT
   http-request deny unless METH_GET or METH_POST or METH_OPTIONS

To select a different backend for requests to static contents on the &quot;www&quot; site
and to every request on the &quot;img&quot;, &quot;video&quot;, &quot;download&quot; and &quot;ftp&quot; hosts :

   acl url_static  path_beg         /static /images /img /css
   acl url_static  path_end         .gif .png .jpg .css .js
   acl host_www    hdr_beg(host) -i www
   acl host_static hdr_beg(host) -i img. video. download. ftp.

   # now use backend &quot;static&quot; for all static-only hosts, and for static URLs
   # of host &quot;www&quot;. Use backend &quot;www&quot; for the rest.
   use_backend static if host_static or host_www url_static
   use_backend www    if host_www

It is also possible to form rules using &quot;anonymous ACLs&quot;. Those are unnamed ACL
expressions that are built on the fly without needing to be declared. They must
be enclosed between braces, with a space before and after each brace (because
the braces must be seen as independent words). Example :

   The following rule :

       acl missing_cl req.hdr_cnt(Content-length) eq 0
       http-request deny if METH_POST missing_cl

   Can also be written that way :

       http-request deny if METH_POST { req.hdr_cnt(Content-length) eq 0 }

It is generally not recommended to use this construct because it's a lot easier
to leave errors in the configuration when written that way. However, for very
simple rules matching only one source IP address for instance, it can make more
sense to use them than to declare ACLs with random names. Another example of
good use is the following :

   With named ACLs :

        acl site_dead nbsrv(dynamic) lt 2
        acl site_dead nbsrv(static)  lt 2
        monitor fail  if site_dead

   With anonymous ACLs :

        monitor fail if { nbsrv(dynamic) lt 2 } || { nbsrv(static) lt 2 }

See <a href="#4.2">section 4.2</a> for detailed help on the &quot;http-request deny&quot; and &quot;<a href="#use_backend">use_backend</a>&quot;
keywords.
</pre></div>
<a class="anchor" id="7.3" name="7.3"></a>
<h2 id="chapter-7.3" data-target="7.3"><small><a class="small" href="#7.3">7.3.</a></small> Fetching samples</h2>
<div><pre class="text">Historically, sample fetch methods were only used to retrieve data to match
against patterns using ACLs. With the arrival of stick-tables, a new class of
sample fetch methods was created, most often sharing the same syntax as their
ACL counterpart. These sample fetch methods are also known as &quot;fetches&quot;. As
of now, ACLs and fetches have converged. All ACL fetch methods have been made
available as fetch methods, and ACLs may use any sample fetch method as well.

This section details all available sample fetch methods and their output type.
Some sample fetch methods have deprecated aliases that are used to maintain
compatibility with existing configurations. They are then explicitly marked as
deprecated and should not be used in new setups.

The ACL derivatives are also indicated when available, with their respective
matching methods. These ones all have a well defined default pattern matching
method, so it is never necessary (though allowed) to pass the &quot;-m&quot; option to
indicate how the sample will be matched using ACLs.

As indicated in the sample type versus matching compatibility matrix above,
when using a generic sample fetch method in an ACL, the &quot;-m&quot; option is
mandatory unless the sample type is one of boolean, integer, IPv4 or IPv6. When
the same keyword exists as an ACL keyword and as a standard fetch method, the
ACL engine will automatically pick the ACL-only one by default.

Some of these keywords support one or multiple mandatory arguments, and one or
multiple optional arguments. These arguments are strongly typed and are checked
when the configuration is parsed so that there is no risk of running with an
incorrect argument (e.g. an unresolved backend name). Fetch function arguments
are passed between parenthesis and are delimited by commas. When an argument
is optional, it will be indicated below between square brackets ('[ ]'). When
all arguments are optional, the parenthesis may be omitted.

Thus, the syntax of a standard sample fetch method is one of the following :
   - <a href="#name">name</a>
   - name(arg1)
   - name(arg1,arg2)
</pre></div>
<a class="anchor" id="7.3.1" name="7.3.1"></a>
<h3 id="chapter-7.3.1" data-target="7.3.1"><small><a class="small" href="#7.3.1">7.3.1.</a></small> Converters</h3>
<div><pre class="text">Sample fetch methods may be combined with transformations to be applied on top
of the fetched sample (also called &quot;converters&quot;). These combinations form what
is called &quot;sample expressions&quot; and the result is a &quot;sample&quot;. Initially this
was only supported by &quot;<a href="#stick%20on">stick on</a>&quot; and &quot;<a href="#stick%20store-request">stick store-request</a>&quot; directives but this
has now be extended to all places where samples may be used (ACLs, log-format,
unique-id-format, add-header, ...).

These transformations are enumerated as a series of specific keywords after the
sample fetch method. These keywords may equally be appended immediately after
the fetch keyword's argument, delimited by a comma. These keywords can also
support some arguments (e.g. a netmask) which must be passed in parenthesis.

A certain category of converters are bitwise and arithmetic operators which
support performing basic operations on integers. Some bitwise operations are
supported (and, or, xor, cpl) and some arithmetic operations are supported
(add, sub, mul, div, mod, neg). Some comparators are provided (odd, even, not,
bool) which make it possible to report a match without having to write an ACL.

The following keywords are supported:
</pre><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>keyword</th><th>input type</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-51d.single">51d.single(prop[,prop*])</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-add">add(value)</a></td><td >integer</td><td >integer</td></tr>
<tr><td ><a href="#7-add_item">add_item(delim,[var][,suff]])</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-aes_gcm_dec">aes_gcm_dec(bits,nonce,key,aead_tag)</a></td><td >binary</td><td >binary</td></tr>
<tr><td ><a href="#7-aes_gcm_enc">aes_gcm_enc(bits,nonce,key,aead_tag)</a></td><td >binary</td><td >binary</td></tr>
<tr><td ><a href="#7-and">and(value)</a></td><td >integer</td><td >integer</td></tr>
<tr><td ><a href="#7-b64dec">b64dec</a></td><td >string</td><td >binary</td></tr>
<tr><td ><a href="#7-base64">base64</a></td><td >binary</td><td >string</td></tr>
<tr><td ><a href="#7-be2dec">be2dec(separator,chunk_size,[truncate])</a></td><td >binary</td><td >string</td></tr>
<tr><td ><a href="#7-be2hex">be2hex([separator],[chunk_size],[truncate])</a></td><td >binary</td><td >string</td></tr>
<tr><td ><a href="#7-bool">bool</a></td><td >integer</td><td >boolean</td></tr>
<tr><td ><a href="#7-bytes">bytes(offset[,length])</a></td><td >binary</td><td >binary</td></tr>
<tr><td ><a href="#7-capture-req">capture-req(id)</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-capture-res">capture-res(id)</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-concat">concat([start],[var],[end])</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-cpl">cpl</a></td><td >integer</td><td >integer</td></tr>
<tr><td ><a href="#7-crc32">crc32([avalanche])</a></td><td >binary</td><td >integer</td></tr>
<tr><td ><a href="#7-crc32c">crc32c([avalanche])</a></td><td >binary</td><td >integer</td></tr>
<tr><td ><a href="#7-cut_crlf">cut_crlf</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-da-csv-conv">da-csv-conv(prop[,prop*])</a></td><td >string</td><td >string</td></tr>
<thead><tr><th>keyword</th><th>input type</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-date">date</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-debug">debug([prefix][,destination])</a></td><td >any</td><td >same</td></tr>
<tr><td ><a href="#7-digest">digest(algorithm)</a></td><td >binary</td><td >binary</td></tr>
<tr><td ><a href="#7-div">div(value)</a></td><td >integer</td><td >integer</td></tr>
<tr><td ><a href="#7-djb2">djb2([avalanche])</a></td><td >binary</td><td >integer</td></tr>
<tr><td ><a href="#7-even">even</a></td><td >integer</td><td >boolean</td></tr>
<tr><td ><a href="#7-field">field(index,delimiters[,count])</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-fix_is_valid">fix_is_valid</a></td><td >binary</td><td >boolean</td></tr>
<tr><td ><a href="#7-fix_tag_value">fix_tag_value(tag)</a></td><td >binary</td><td >binary</td></tr>
<tr><td ><a href="#7-hex">hex</a></td><td >binary</td><td >string</td></tr>
<tr><td ><a href="#7-hex2i">hex2i</a></td><td >binary</td><td >integer</td></tr>
<tr><td ><a href="#7-hmac">hmac(algorithm,key)</a></td><td >binary</td><td >binary</td></tr>
<tr><td ><a href="#7-host_only">host_only</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-htonl">htonl</a></td><td >integer</td><td >integer</td></tr>
<tr><td ><a href="#7-http_date">http_date([offset],[unit])</a></td><td >integer</td><td >string</td></tr>
<tr><td ><a href="#7-iif">iif(true,false)</a></td><td >boolean</td><td >string</td></tr>
<tr><td ><a href="#7-in_table">in_table(table)</a></td><td >string</td><td >boolean</td></tr>
<tr><td ><a href="#7-ipmask">ipmask(mask4,[mask6])</a></td><td >address</td><td >address</td></tr>
<tr><td ><a href="#7-json">json([input-code])</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-json_query">json_query(json_path,[output_type])</a></td><td >string</td><td >_outtype_</td></tr>
<thead><tr><th>keyword</th><th>input type</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-jwt_header_query">jwt_header_query([json_path],[output_type])</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-jwt_payload_query">jwt_payload_query([json_path],[output_type])</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-jwt_verify">jwt_verify(alg,key)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-language">language(value[,default])</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-length">length</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-lower">lower</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-ltime">ltime(format[,offset])</a></td><td >integer</td><td >string</td></tr>
<tr><td ><a href="#7-ltrim">ltrim(chars)</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-map">map(map_name[,default_value])</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-map_match">map_match(map_name[,default_value])</a></td><td >_match_</td><td >string</td></tr>
<tr><td ><a href="#7-map_match_output">map_match_output(map_name[,default_value])</a></td><td >_match_</td><td >_output_</td></tr>
<tr><td ><a href="#7-mod">mod(value)</a></td><td >integer</td><td >integer</td></tr>
<tr><td ><a href="#7-mqtt_field_value">mqtt_field_value(pkt_type,fieldname_or_prop_ID)</a></td><td >binary</td><td >binary</td></tr>
<tr><td ><a href="#7-mqtt_is_valid">mqtt_is_valid</a></td><td >binary</td><td >boolean</td></tr>
<tr><td ><a href="#7-ms_ltime">ms_ltime(format[,offset])</a></td><td >integer</td><td >string</td></tr>
<tr><td ><a href="#7-ms_utime">ms_utime(format[,offset])</a></td><td >integer</td><td >string</td></tr>
<tr><td ><a href="#7-mul">mul(value)</a></td><td >integer</td><td >integer</td></tr>
<tr><td ><a href="#7-nbsrv">nbsrv</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-neg">neg</a></td><td >integer</td><td >integer</td></tr>
<tr><td ><a href="#7-not">not</a></td><td >integer</td><td >boolean</td></tr>
<thead><tr><th>keyword</th><th>input type</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-odd">odd</a></td><td >integer</td><td >boolean</td></tr>
<tr><td ><a href="#7-or">or(value)</a></td><td >integer</td><td >integer</td></tr>
<tr><td ><a href="#7-param">param(name,[delim])</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-port_only">port_only</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-protobuf">protobuf(field_number,[field_type])</a></td><td >binary</td><td >binary</td></tr>
<tr><td ><a href="#7-regsub">regsub(regex,subst[,flags])</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-rfc7239_field">rfc7239_field(field)</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-rfc7239_is_valid">rfc7239_is_valid</a></td><td >string</td><td >boolean</td></tr>
<tr><td ><a href="#7-rfc7239_n2nn">rfc7239_n2nn</a></td><td >string</td><td >address / str</td></tr>
<tr><td ><a href="#7-rfc7239_n2np">rfc7239_n2np</a></td><td >string</td><td >integer / str</td></tr>
<tr><td ><a href="#7-rfc7239_nn">rfc7239_nn</a></td><td >address/str</td><td >string</td></tr>
<tr><td ><a href="#7-rfc7239_np">rfc7239_np</a></td><td >integer/str</td><td >string</td></tr>
<tr><td ><a href="#7-rtrim">rtrim(chars)</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-sdbm">sdbm([avalanche])</a></td><td >binary</td><td >integer</td></tr>
<tr><td ><a href="#7-secure_memcmp">secure_memcmp(var)</a></td><td >string</td><td >boolean</td></tr>
<tr><td ><a href="#7-set-var">set-var(var[,cond...])</a></td><td >any</td><td >same</td></tr>
<tr><td ><a href="#7-sha1">sha1</a></td><td >binary</td><td >binary</td></tr>
<tr><td ><a href="#7-sha2">sha2([bits])</a></td><td >binary</td><td >binary</td></tr>
<tr><td ><a href="#7-srv_queue">srv_queue</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-strcmp">strcmp(var)</a></td><td >string</td><td >boolean</td></tr>
<thead><tr><th>keyword</th><th>input type</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-sub">sub(value)</a></td><td >integer</td><td >integer</td></tr>
<tr><td ><a href="#7-table_bytes_in_rate">table_bytes_in_rate(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_bytes_out_rate">table_bytes_out_rate(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_conn_cnt">table_conn_cnt(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_conn_cur">table_conn_cur(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_conn_rate">table_conn_rate(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_expire">table_expire(table[,default_value])</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_glitch_cnt">table_glitch_cnt(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_glitch_rate">table_glitch_rate(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_gpc">table_gpc(idx,table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_gpc0">table_gpc0(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_gpc0_rate">table_gpc0_rate(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_gpc1">table_gpc1(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_gpc1_rate">table_gpc1_rate(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_gpc_rate">table_gpc_rate(idx,table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_gpt">table_gpt(idx,table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_gpt0">table_gpt0(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_http_err_cnt">table_http_err_cnt(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_http_err_rate">table_http_err_rate(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_http_fail_cnt">table_http_fail_cnt(table)</a></td><td >string</td><td >integer</td></tr>
<thead><tr><th>keyword</th><th>input type</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-table_http_fail_rate">table_http_fail_rate(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_http_req_cnt">table_http_req_cnt(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_http_req_rate">table_http_req_rate(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_idle">table_idle(table[,default_value])</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_kbytes_in">table_kbytes_in(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_kbytes_out">table_kbytes_out(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_server_id">table_server_id(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_sess_cnt">table_sess_cnt(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_sess_rate">table_sess_rate(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-table_trackers">table_trackers(table)</a></td><td >string</td><td >integer</td></tr>
<tr><td ><a href="#7-ub64dec">ub64dec</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-ub64enc">ub64enc</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-ungrpc">ungrpc(field_number,[field_type])</a></td><td >binary</td><td >binary / int</td></tr>
<tr><td ><a href="#7-unset-var">unset-var(var)</a></td><td >any</td><td >same</td></tr>
<tr><td ><a href="#7-upper">upper</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-url_dec">url_dec([in_form])</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-url_enc">url_enc([enc_type])</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-us_ltime">us_ltime(format[,offset])</a></td><td >integer</td><td >string</td></tr>
<tr><td ><a href="#7-us_utime">us_utime(format[,offset])</a></td><td >integer</td><td >string</td></tr>
<tr><td ><a href="#7-utime">utime(format[,offset])</a></td><td >integer</td><td >string</td></tr>
<thead><tr><th>keyword</th><th>input type</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-when">when(condition)</a></td><td >any</td><td >same</td></tr>
<tr><td ><a href="#7-word">word(index,delimiters[,count])</a></td><td >string</td><td >string</td></tr>
<tr><td ><a href="#7-wt6">wt6([avalanche])</a></td><td >binary</td><td >integer</td></tr>
<tr><td ><a href="#7-x509_v_err_str">x509_v_err_str</a></td><td >integer</td><td >string</td></tr>
<tr><td ><a href="#7-xor">xor(value)</a></td><td >integer</td><td >integer</td></tr>
<tr><td ><a href="#7-xxh3">xxh3([seed])</a></td><td >binary</td><td >integer</td></tr>
<tr><td ><a href="#7-xxh32">xxh32([seed])</a></td><td >binary</td><td >integer</td></tr>
</table><pre class="text">The detailed list of converter keywords follows:
</pre><a class="anchor" name="51d.single"></a><a class="anchor" name="7-51d.single"></a><a class="anchor" name="7.3.1-51d.single"></a><a class="anchor" name="51d.single (Using ACLs and fetching samples)"></a><a class="anchor" name="51d.single (Converters)"></a><div class="keyword"><b><a class="anchor" name="51d.single"></a><a href="#7.3.1-51d.single">51d.single</a></b>(<span style="color: #080">&lt;prop&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;prop&gt;</span>*]</span>)</div><pre class="text">Returns values for the properties requested as a string, where values are
separated by the delimiter specified with &quot;<a href="#51degrees-property-separator">51degrees-property-separator</a>&quot;.
The device is identified using the User-Agent header passed to the
converter. The function can be passed up to five property names, and if a
property name can't be found, the value &quot;NoData&quot; is returned.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># Here the header &quot;X-51D-DeviceTypeMobileTablet&quot; is added to the request,</span>
<span class="comment"># containing values for the three properties requested by using the</span>
<span class="comment"># User-Agent passed to the converter.</span>
frontend http-in
  bind *:8081
  default_backend servers
  http-request set-header X-51D-DeviceTypeMobileTablet \
    %[req.fhdr(User-Agent),51d.single(DeviceType,IsMobile,IsTablet)]
</code></pre>
</div><a class="anchor" name="add"></a><a class="anchor" name="7-add"></a><a class="anchor" name="7.3.1-add"></a><a class="anchor" name="add (Using ACLs and fetching samples)"></a><a class="anchor" name="add (Converters)"></a><div class="keyword"><b><a class="anchor" name="add"></a><a href="#7.3.1-add">add</a></b>(<span style="color: #080">&lt;value&gt;</span>)</div><pre class="text">Adds &lt;value&gt; to the input value of type signed integer, and returns the
result as a signed integer. &lt;value&gt; can be a numeric value or a variable
name. See <a href="#2.8">section 2.8</a> about variables for details.
</pre><a class="anchor" name="add_item"></a><a class="anchor" name="7-add_item"></a><a class="anchor" name="7.3.1-add_item"></a><a class="anchor" name="add_item (Using ACLs and fetching samples)"></a><a class="anchor" name="add_item (Converters)"></a><div class="keyword"><b><a class="anchor" name="add_item"></a><a href="#7.3.1-add_item">add_item</a></b>(<span style="color: #080">&lt;delim&gt;</span>,<span style="color: #008">[<span style="color: #080">&lt;var&gt;</span>]</span><span style="color: #008">[,<span style="color: #080">&lt;suff&gt;</span>]</span>])</div><pre class="text">Concatenates a minimum of 2 and up to 3 fields after the current sample which
is then turned into a string. The first one, &lt;delim&gt;, is a constant string,
that will be appended immediately after the existing sample if an existing
sample is not empty and either the &lt;var&gt; or the &lt;suff&gt; is not empty. The
second one, &lt;var&gt;, is a variable name. The variable will be looked up, its
contents converted to a string, and it will be appended immediately after
the &lt;delim&gt; part. If the variable is not found, nothing is appended. It is
optional and may optionally be followed by a constant string &lt;suff&gt;, however
if &lt;var&gt; is omitted, then &lt;suff&gt; is mandatory. This converter is similar to
the concat converter and can be used to build new variables made of a
succession of other variables but the main difference is that it does the
checks if adding a delimiter makes sense as wouldn't be the case if e.g. the
current sample is empty. That situation would require 2 separate rules using
concat converter where the first rule would have to check if the current
sample string is empty before adding a delimiter. If commas or closing
parenthesis are needed as delimiters, they must be protected by quotes or
backslashes, themselves protected so that they are not stripped by the first
level parser (please see <a href="#2.2">section 2.2</a> for quoting and escaping). See examples
below.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request set-var(req.tagged) 'var(req.tagged),add_item(&quot;,&quot;,req.score1,&quot;(site1)&quot;) if src,in_table(site1)'
http-request set-var(req.tagged) 'var(req.tagged),add_item(&quot;,&quot;,req.score2,&quot;(site2)&quot;) if src,in_table(site2)'
http-request set-var(req.tagged) 'var(req.tagged),add_item(&quot;,&quot;,req.score3,&quot;(site3)&quot;) if src,in_table(site3)'
http-request set-header x-tagged %[var(req.tagged)]

http-request set-var(req.tagged) 'var(req.tagged),add_item(&quot;,&quot;,req.score1),add_item(&quot;,&quot;,req.score2)'
http-request set-var(req.tagged) 'var(req.tagged),add_item(&quot;,&quot;,,(site1))' if src,in_table(site1)
</code></pre>
</div><a class="anchor" name="aes_gcm_dec"></a><a class="anchor" name="7-aes_gcm_dec"></a><a class="anchor" name="7.3.1-aes_gcm_dec"></a><a class="anchor" name="aes_gcm_dec (Using ACLs and fetching samples)"></a><a class="anchor" name="aes_gcm_dec (Converters)"></a><div class="keyword"><b><a class="anchor" name="aes_gcm_dec"></a><a href="#7.3.1-aes_gcm_dec">aes_gcm_dec</a></b>(<span style="color: #080">&lt;bits&gt;</span>,<span style="color: #080">&lt;nonce&gt;</span>,<span style="color: #080">&lt;key&gt;</span>,<span style="color: #080">&lt;aead_tag&gt;</span>)</div><pre class="text">Decrypts the raw byte input using the AES128-GCM, AES192-GCM or
AES256-GCM algorithm, depending on the &lt;bits&gt; parameter. All other parameters
need to be base64 encoded and the returned result is in raw byte format.
If the &lt;aead_tag&gt; validation fails, the converter doesn't return any data.
The &lt;nonce&gt;, &lt;key&gt; and &lt;aead_tag&gt; can either be strings or variables. This
converter requires at least OpenSSL 1.0.1.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-response set-header X-Decrypted-Text %[var(txn.enc),\
  aes_gcm_dec(128,txn.nonce,Zm9vb2Zvb29mb29wZm9vbw==,txn.aead_tag)]
</code></pre>
</div><a class="anchor" name="aes_gcm_enc"></a><a class="anchor" name="7-aes_gcm_enc"></a><a class="anchor" name="7.3.1-aes_gcm_enc"></a><a class="anchor" name="aes_gcm_enc (Using ACLs and fetching samples)"></a><a class="anchor" name="aes_gcm_enc (Converters)"></a><div class="keyword"><b><a class="anchor" name="aes_gcm_enc"></a><a href="#7.3.1-aes_gcm_enc">aes_gcm_enc</a></b>(<span style="color: #080">&lt;bits&gt;</span>,<span style="color: #080">&lt;nonce&gt;</span>,<span style="color: #080">&lt;key&gt;</span>,<span style="color: #080">&lt;aead_tag&gt;</span>)</div><pre class="text">Encrypts the raw byte input using the AES128-GCM, AES192-GCM or
AES256-GCM algorithm, depending on the &lt;bits&gt; parameter. &lt;nonce&gt; and &lt;key&gt;
parameters must be base64 encoded. Last parameter, &lt;aead_tag&gt;, must be a
variable. The AEAD tag will be stored base64 encoded into that variable.
The returned result is in raw byte format. The &lt;nonce&gt; and &lt;key&gt; can either
be strings or variables. This converter requires at least OpenSSL 1.0.1.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-response set-header X-Encrypted-Text %[var(txn.plain),\
  aes_gcm_enc(128,txn.nonce,Zm9vb2Zvb29mb29wZm9vbw==,txn.aead_tag)]
</code></pre>
</div><a class="anchor" name="and"></a><a class="anchor" name="7-and"></a><a class="anchor" name="7.3.1-and"></a><a class="anchor" name="and (Using ACLs and fetching samples)"></a><a class="anchor" name="and (Converters)"></a><div class="keyword"><b><a class="anchor" name="and"></a><a href="#7.3.1-and">and</a></b>(<span style="color: #080">&lt;value&gt;</span>)</div><pre class="text">Performs a bitwise &quot;AND&quot; between &lt;value&gt; and the input value of type signed
integer, and returns the result as an signed integer. &lt;value&gt; can be a
numeric value or a variable name. See <a href="#2.8">section 2.8</a> about variables for details.
</pre><a class="anchor" name="b64dec"></a><a class="anchor" name="7-b64dec"></a><a class="anchor" name="7.3.1-b64dec"></a><a class="anchor" name="b64dec (Using ACLs and fetching samples)"></a><a class="anchor" name="b64dec (Converters)"></a><div class="keyword"><b><a class="anchor" name="b64dec"></a><a href="#7.3.1-b64dec">b64dec</a></b></div><pre class="text">Converts (decodes) a base64 encoded input string to its binary
representation. It performs the inverse operation of base64().
For base64url(&quot;URL and Filename Safe Alphabet&quot; (RFC 4648)) variant
see &quot;<a href="#ub64dec">ub64dec</a>&quot;.
</pre><a class="anchor" name="base64"></a><a class="anchor" name="7-base64"></a><a class="anchor" name="7.3.1-base64"></a><a class="anchor" name="base64 (Using ACLs and fetching samples)"></a><a class="anchor" name="base64 (Converters)"></a><div class="keyword"><b><a class="anchor" name="base64"></a><a href="#7.3.1-base64">base64</a></b></div><pre class="text">Converts a binary input sample to a base64 string. It is used to log or
transfer binary content in a way that can be reliably transferred (e.g.
an SSL ID can be copied in a header). For base64url(&quot;URL and Filename
Safe Alphabet&quot; (RFC 4648)) variant see &quot;<a href="#ub64enc">ub64enc</a>&quot;.
</pre><a class="anchor" name="be2dec"></a><a class="anchor" name="7-be2dec"></a><a class="anchor" name="7.3.1-be2dec"></a><a class="anchor" name="be2dec (Using ACLs and fetching samples)"></a><a class="anchor" name="be2dec (Converters)"></a><div class="keyword"><b><a class="anchor" name="be2dec"></a><a href="#7.3.1-be2dec">be2dec</a></b>(<span style="color: #080">&lt;separator&gt;</span>,<span style="color: #080">&lt;chunk_size&gt;</span>,<span style="color: #008">[<span style="color: #080">&lt;truncate&gt;</span>]</span>)</div><pre class="text">Converts big-endian binary input sample to a string containing an unsigned
integer number per &lt;chunk_size&gt; input bytes. &lt;separator&gt; is put every
&lt;chunk_size&gt; binary input bytes if specified. &lt;truncate&gt; flag indicates
whatever binary input is truncated at &lt;chunk_size&gt; boundaries. &lt;chunk_size&gt;
maximum value is limited by the size of long long int (8 bytes).
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>bin(01020304050607),be2dec(:,2)   <span class="comment"># 258:772:1286:7</span>
bin(01020304050607),be2dec(-,2,1) <span class="comment"># 258-772-1286</span>
bin(01020304050607),be2dec(,2,1)  <span class="comment"># 2587721286</span>
bin(7f000001),be2dec(.,1)         <span class="comment"># 127.0.0.1</span>
</code></pre>
</div><a class="anchor" name="be2hex"></a><a class="anchor" name="7-be2hex"></a><a class="anchor" name="7.3.1-be2hex"></a><a class="anchor" name="be2hex (Using ACLs and fetching samples)"></a><a class="anchor" name="be2hex (Converters)"></a><div class="keyword"><b><a class="anchor" name="be2hex"></a><a href="#7.3.1-be2hex">be2hex</a></b>(<span style="color: #008">[<span style="color: #080">&lt;separator&gt;</span>]</span>,<span style="color: #008">[<span style="color: #080">&lt;chunk_size&gt;</span>]</span>,<span style="color: #008">[<span style="color: #080">&lt;truncate&gt;</span>]</span>)</div><pre class="text">Converts big-endian binary input sample to a hex string containing two hex
digits per input byte. It is used to log or transfer hex dumps of some
binary input data in a way that can be reliably transferred (e.g. an SSL ID
can be copied in a header). &lt;separator&gt; is put every &lt;chunk_size&gt; binary
input bytes if specified. &lt;truncate&gt; flag indicates whatever binary input is
truncated at &lt;chunk_size&gt; boundaries.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>bin(01020304050607),be2hex         <span class="comment"># 01020304050607</span>
bin(01020304050607),be2hex(:,2)    <span class="comment"># 0102:0304:0506:07</span>
bin(01020304050607),be2hex(--,2,1) <span class="comment"># 0102--0304--0506</span>
bin(0102030405060708),be2hex(,3,1) <span class="comment"># 010203040506</span>
</code></pre>
</div><a class="anchor" name="bool"></a><a class="anchor" name="7-bool"></a><a class="anchor" name="7.3.1-bool"></a><a class="anchor" name="bool (Using ACLs and fetching samples)"></a><a class="anchor" name="bool (Converters)"></a><div class="keyword"><b><a class="anchor" name="bool"></a><a href="#7.3.1-bool">bool</a></b></div><pre class="text">Returns a boolean TRUE if the input value of type signed integer is
non-null, otherwise returns FALSE. Used in conjunction with and(), it can be
used to report true/false for bit testing on input values (e.g. verify the
presence of a flag).
</pre><a class="anchor" name="bytes"></a><a class="anchor" name="7-bytes"></a><a class="anchor" name="7.3.1-bytes"></a><a class="anchor" name="bytes (Using ACLs and fetching samples)"></a><a class="anchor" name="bytes (Converters)"></a><div class="keyword"><b><a class="anchor" name="bytes"></a><a href="#7.3.1-bytes">bytes</a></b>(<span style="color: #080">&lt;offset&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;length&gt;</span>]</span>)</div><pre class="text">Extracts some bytes from an input binary sample. The result is a binary
sample starting at an offset (in bytes) of the original sample and
optionally truncated at the given length. &lt;offset&gt; and &lt;length&gt; can be numeric
values or variable names. The converter returns an empty sample if either
&lt;offset&gt; or &lt;length&gt; is invalid. Invalid &lt;offset&gt; means a negative value or a
value &gt;= length of the input sample. Invalid &lt;length&gt; means a negative value
or, in some cases, a value bigger than the length of the input sample.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request set-var(txn.input) req.hdr(input) <span class="comment"># let's say input is &quot;012345&quot;</span>

http-response set-header bytes_0 &quot;%[var(txn.input),bytes(0)]&quot;  <span class="comment"># outputs &quot;012345&quot;</span>
http-response set-header bytes_1_3 &quot;%[var(txn.input),bytes(1,3)]&quot;  <span class="comment"># outputs &quot;123&quot;</span>

http-response set-var(txn.var_start) int(1)
http-response set-var(txn.var_length) int(3)
http-response set-header bytes_var1_var3    &quot;%[var(txn.input),bytes(txn.var_start,txn.var_length)]&quot;  <span class="comment"># outputs &quot;123&quot;</span>
</code></pre>
</div><a class="anchor" name="capture-req"></a><a class="anchor" name="7-capture-req"></a><a class="anchor" name="7.3.1-capture-req"></a><a class="anchor" name="capture-req (Using ACLs and fetching samples)"></a><a class="anchor" name="capture-req (Converters)"></a><div class="keyword"><b><a class="anchor" name="capture-req"></a><a href="#7.3.1-capture-req">capture-req</a></b>(<span style="color: #080">&lt;id&gt;</span>)</div><pre class="text">Capture the string entry in the request slot &lt;id&gt; and returns the entry as
is. If the slot doesn't exist, the capture fails silently.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#declare%20capture">declare capture</a>&quot;, &quot;http-request capture&quot;, &quot;http-response capture&quot;, &quot;<a href="#capture.req.hdr">capture.req.hdr</a>&quot; and &quot;<a href="#capture.res.hdr">capture.res.hdr</a>&quot; (sample fetches).</div>
<a class="anchor" name="capture-res"></a><a class="anchor" name="7-capture-res"></a><a class="anchor" name="7.3.1-capture-res"></a><a class="anchor" name="capture-res (Using ACLs and fetching samples)"></a><a class="anchor" name="capture-res (Converters)"></a><div class="keyword"><b><a class="anchor" name="capture-res"></a><a href="#7.3.1-capture-res">capture-res</a></b>(<span style="color: #080">&lt;id&gt;</span>)</div><pre class="text">Capture the string entry in the response slot &lt;id&gt; and returns the entry as
is. If the slot doesn't exist, the capture fails silently.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#declare%20capture">declare capture</a>&quot;, &quot;http-request capture&quot;, &quot;http-response capture&quot;, &quot;<a href="#capture.req.hdr">capture.req.hdr</a>&quot; and &quot;<a href="#capture.res.hdr">capture.res.hdr</a>&quot; (sample fetches).</div>
<a class="anchor" name="concat"></a><a class="anchor" name="7-concat"></a><a class="anchor" name="7.3.1-concat"></a><a class="anchor" name="concat (Using ACLs and fetching samples)"></a><a class="anchor" name="concat (Converters)"></a><div class="keyword"><b><a class="anchor" name="concat"></a><a href="#7.3.1-concat">concat</a></b>(<span style="color: #008">[<span style="color: #080">&lt;start&gt;</span>]</span>,<span style="color: #008">[<span style="color: #080">&lt;var&gt;</span>]</span>,<span style="color: #008">[<span style="color: #080">&lt;end&gt;</span>]</span>)</div><pre class="text">Concatenates up to 3 fields after the current sample which is then turned to
a string. The first one, &lt;start&gt;, is a constant string, that will be appended
immediately after the existing sample. It may be omitted if not used. The
second one, &lt;var&gt;, is a variable name. The variable will be looked up, its
contents converted to a string, and it will be appended immediately after the
&lt;first&gt; part. If the variable is not found, nothing is appended. It may be
omitted as well. The third field, &lt;end&gt; is a constant string that will be
appended after the variable. It may also be omitted. Together, these elements
allow to concatenate variables with delimiters to an existing set of
variables. This can be used to build new variables made of a succession of
other variables, such as colon-delimited values. If commas or closing
parenthesis are needed as delimiters, they must be protected by quotes or
backslashes, themselves protected so that they are not stripped by the first
level parser. This is often used to build composite variables from other
ones, but sometimes using a format string with multiple fields may be more
convenient. See examples below.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>tcp-request session set-var(sess.src) src
tcp-request session set-var(sess.dn)  ssl_c_s_dn
tcp-request session set-var(txn.sig) str(),concat(&lt;ip=,sess.ip,&gt;),concat(&lt;dn=,sess.dn,&gt;)
tcp-request session set-var(txn.ipport) &quot;str(),concat('addr=(',sess.ip),concat(',',sess.port,')')&quot;
tcp-request session set-var-fmt(txn.ipport) &quot;addr=(%[sess.ip],%[sess.port])&quot;  <span class="comment">## does the same</span>
http-request set-header x-hap-sig %[var(txn.sig)]
</code></pre>
</div><a class="anchor" name="cpl"></a><a class="anchor" name="7-cpl"></a><a class="anchor" name="7.3.1-cpl"></a><a class="anchor" name="cpl (Using ACLs and fetching samples)"></a><a class="anchor" name="cpl (Converters)"></a><div class="keyword"><b><a class="anchor" name="cpl"></a><a href="#7.3.1-cpl">cpl</a></b></div><pre class="text">Takes the input value of type signed integer, applies a ones-complement
(flips all bits) and returns the result as an signed integer.
</pre><a class="anchor" name="crc32"></a><a class="anchor" name="7-crc32"></a><a class="anchor" name="7.3.1-crc32"></a><a class="anchor" name="crc32 (Using ACLs and fetching samples)"></a><a class="anchor" name="crc32 (Converters)"></a><div class="keyword"><b><a class="anchor" name="crc32"></a><a href="#7.3.1-crc32">crc32</a></b>(<span style="color: #008">[<span style="color: #080">&lt;avalanche&gt;</span>]</span>)</div><pre class="text">Hashes a binary input sample into an unsigned 32-bit quantity using the CRC32
hash function. Optionally, it is possible to apply a full avalanche hash
function to the output if the optional &lt;avalanche&gt; argument equals 1. This
converter uses the same functions as used by the various hash-based load
balancing algorithms, so it will provide exactly the same results. It is
provided for compatibility with other software which want a CRC32 to be
computed on some input keys, so it follows the most common implementation as
found in Ethernet, Gzip, PNG, etc... It is slower than the other algorithms
but may provide a better or at least less predictable distribution. It must
not be used for security purposes as a 32-bit hash is trivial to break. See
also &quot;<a href="#djb2">djb2</a>&quot;, &quot;<a href="#sdbm">sdbm</a>&quot;, &quot;<a href="#wt6">wt6</a>&quot;, &quot;<a href="#crc32c">crc32c</a>&quot; and the &quot;<a href="#hash-type">hash-type</a>&quot; directive.
</pre><a class="anchor" name="crc32c"></a><a class="anchor" name="7-crc32c"></a><a class="anchor" name="7.3.1-crc32c"></a><a class="anchor" name="crc32c (Using ACLs and fetching samples)"></a><a class="anchor" name="crc32c (Converters)"></a><div class="keyword"><b><a class="anchor" name="crc32c"></a><a href="#7.3.1-crc32c">crc32c</a></b>(<span style="color: #008">[<span style="color: #080">&lt;avalanche&gt;</span>]</span>)</div><pre class="text">Hashes a binary input sample into an unsigned 32-bit quantity using the CRC32C
hash function. Optionally, it is possible to apply a full avalanche hash
function to the output if the optional &lt;avalanche&gt; argument equals 1. This
converter uses the same functions as described in RFC4960, Appendix B [8].
It is provided for compatibility with other software which want a CRC32C to be
computed on some input keys. It is slower than the other algorithms and it must
not be used for security purposes as a 32-bit hash is trivial to break. See
also &quot;<a href="#djb2">djb2</a>&quot;, &quot;<a href="#sdbm">sdbm</a>&quot;, &quot;<a href="#wt6">wt6</a>&quot;, &quot;<a href="#crc32">crc32</a>&quot; and the &quot;<a href="#hash-type">hash-type</a>&quot; directive.
</pre><a class="anchor" name="cut_crlf"></a><a class="anchor" name="7-cut_crlf"></a><a class="anchor" name="7.3.1-cut_crlf"></a><a class="anchor" name="cut_crlf (Using ACLs and fetching samples)"></a><a class="anchor" name="cut_crlf (Converters)"></a><div class="keyword"><b><a class="anchor" name="cut_crlf"></a><a href="#7.3.1-cut_crlf">cut_crlf</a></b></div><pre class="text">Cuts the string representation of the input sample on the first carriage
return ('\r') or newline ('\n') character found. Only the string length is
updated.
</pre><a class="anchor" name="da-csv-conv"></a><a class="anchor" name="7-da-csv-conv"></a><a class="anchor" name="7.3.1-da-csv-conv"></a><a class="anchor" name="da-csv-conv (Using ACLs and fetching samples)"></a><a class="anchor" name="da-csv-conv (Converters)"></a><div class="keyword"><b><a class="anchor" name="da-csv-conv"></a><a href="#7.3.1-da-csv-conv">da-csv-conv</a></b>(<span style="color: #080">&lt;prop&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;prop&gt;</span>*]</span>)</div><pre class="text">Asks the DeviceAtlas converter to identify the User Agent string passed on
input, and to emit a string made of the concatenation of the properties
enumerated in argument, delimited by the separator defined by the global
keyword &quot;deviceatlas-property-separator&quot;, or by default the pipe character
('|'). There's a limit of 12 different properties imposed by the HAProxy
configuration language.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>frontend www
  bind *:8881
  default_backend servers
  http-request set-header X-DeviceAtlas-Data %[req.fhdr(User-Agent),da-csv(primaryHardwareType,osName,osVersion,browserName,browserVersion,browserRenderingEngine)]
</code></pre>
</div><a class="anchor" name="date"></a><a class="anchor" name="7-date"></a><a class="anchor" name="7.3.1-date"></a><a class="anchor" name="date (Using ACLs and fetching samples)"></a><a class="anchor" name="date (Converters)"></a><div class="keyword"><b><a class="anchor" name="date"></a><a href="#7.3.1-date">date</a></b></div><pre class="text">This converter is used to convert a date from an HTTP header. It can be an IMF
date, an ASCTIME date or a RFC850 date. It will output an UNIX timestamp.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request return lf-string &quot;%[str('Sun, 06 Nov 1994 08:49:37 GMT'),date]\n&quot; content-type text/plain
</code></pre>
</div><a class="anchor" name="debug"></a><a class="anchor" name="7-debug"></a><a class="anchor" name="7.3.1-debug"></a><a class="anchor" name="debug (Using ACLs and fetching samples)"></a><a class="anchor" name="debug (Converters)"></a><div class="keyword"><b><a class="anchor" name="debug"></a><a href="#7.3.1-debug">debug</a></b>(<span style="color: #008">[<span style="color: #080">&lt;prefix</span>]</span><span style="color: #008">[,<span style="color: #080">&lt;destination&gt;</span>]</span>)</div><pre class="text">This converter is used as debug tool. It takes a capture of the input sample
and sends it to event sink &lt;destination&gt;, which may designate a ring buffer
such as &quot;buf0&quot;, as well as &quot;stdout&quot;, or &quot;stderr&quot;. Available sinks may be
checked at run time by issuing &quot;show events&quot; on the CLI. When not specified,
the output will be &quot;buf0&quot;, which may be consulted via the CLI's &quot;show events&quot;
command. An optional prefix &lt;prefix&gt; may be passed to help distinguish
outputs from multiple expressions. It will then appear before the colon in
the output message. The input sample is passed as-is on the output, so that
it is safe to insert the debug converter anywhere in a chain, even with non-
printable sample types.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>tcp-request connection track-sc0 src,debug(track-sc)
</code></pre>
</div><a class="anchor" name="digest"></a><a class="anchor" name="7-digest"></a><a class="anchor" name="7.3.1-digest"></a><a class="anchor" name="digest (Using ACLs and fetching samples)"></a><a class="anchor" name="digest (Converters)"></a><div class="keyword"><b><a class="anchor" name="digest"></a><a href="#7.3.1-digest">digest</a></b>(<span style="color: #080">&lt;algorithm&gt;</span>)</div><pre class="text">Converts a binary input sample to a message digest. The result is a binary
sample. The &lt;algorithm&gt; must be an OpenSSL message digest name (e.g. sha256).

Please note that this converter is only available when HAProxy has been
compiled with USE_OPENSSL.
</pre><a class="anchor" name="div"></a><a class="anchor" name="7-div"></a><a class="anchor" name="7.3.1-div"></a><a class="anchor" name="div (Using ACLs and fetching samples)"></a><a class="anchor" name="div (Converters)"></a><div class="keyword"><b><a class="anchor" name="div"></a><a href="#7.3.1-div">div</a></b>(<span style="color: #080">&lt;value&gt;</span>)</div><pre class="text">Divides the input value of type signed integer by &lt;value&gt;, and returns the
result as an signed integer. If &lt;value&gt; is null, the largest unsigned
integer is returned (typically 2^63-1). &lt;value&gt; can be a numeric value or a
variable name. See <a href="#2.8">section 2.8</a> about variables for details.
</pre><a class="anchor" name="djb2"></a><a class="anchor" name="7-djb2"></a><a class="anchor" name="7.3.1-djb2"></a><a class="anchor" name="djb2 (Using ACLs and fetching samples)"></a><a class="anchor" name="djb2 (Converters)"></a><div class="keyword"><b><a class="anchor" name="djb2"></a><a href="#7.3.1-djb2">djb2</a></b>(<span style="color: #008">[<span style="color: #080">&lt;avalanche&gt;</span>]</span>)</div><pre class="text">Hashes a binary input sample into an unsigned 32-bit quantity using the DJB2
hash function. Optionally, it is possible to apply a full avalanche hash
function to the output if the optional &lt;avalanche&gt; argument equals 1. This
converter uses the same functions as used by the various hash-based load
balancing algorithms, so it will provide exactly the same results. It is
mostly intended for debugging, but can be used as a stick-table entry to
collect rough statistics. It must not be used for security purposes as a
32-bit hash is trivial to break. See also &quot;<a href="#crc32">crc32</a>&quot;, &quot;<a href="#sdbm">sdbm</a>&quot;, &quot;<a href="#wt6">wt6</a>&quot;, &quot;<a href="#crc32c">crc32c</a>&quot;,
and the &quot;<a href="#hash-type">hash-type</a>&quot; directive.
</pre><a class="anchor" name="even"></a><a class="anchor" name="7-even"></a><a class="anchor" name="7.3.1-even"></a><a class="anchor" name="even (Using ACLs and fetching samples)"></a><a class="anchor" name="even (Converters)"></a><div class="keyword"><b><a class="anchor" name="even"></a><a href="#7.3.1-even">even</a></b></div><pre class="text">Returns a boolean TRUE if the input value of type signed integer is even
otherwise returns FALSE. It is functionally equivalent to &quot;not,and(1),bool&quot;.
</pre><a class="anchor" name="field"></a><a class="anchor" name="7-field"></a><a class="anchor" name="7.3.1-field"></a><a class="anchor" name="field (Using ACLs and fetching samples)"></a><a class="anchor" name="field (Converters)"></a><div class="keyword"><b><a class="anchor" name="field"></a><a href="#7.3.1-field">field</a></b>(<span style="color: #080">&lt;index&gt;</span>,<span style="color: #080">&lt;delimiters&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;count&gt;</span>]</span>)</div><pre class="text">Extracts the substring at the given index counting from the beginning
(positive index) or from the end (negative index) considering given delimiters
from an input string. Indexes start at 1 or -1 and delimiters are a string
formatted list of chars. Optionally you can specify &lt;count&gt; of fields to
extract (default: 1). Value of 0 indicates extraction of all remaining
fields.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>str(f1_f2_f3__f5),field(4,_)    <span class="comment"># &lt;empty&gt;</span>
str(f1_f2_f3__f5),field(5,_)    <span class="comment"># f5</span>
str(f1_f2_f3__f5),field(2,_,0)  <span class="comment"># f2_f3__f5</span>
str(f1_f2_f3__f5),field(2,_,2)  <span class="comment"># f2_f3</span>
str(f1_f2_f3__f5),field(-2,_,3) <span class="comment"># f2_f3_</span>
str(f1_f2_f3__f5),field(-3,_,0) <span class="comment"># f1_f2_f3</span>
</code></pre>
</div><a class="anchor" name="fix_is_valid"></a><a class="anchor" name="7-fix_is_valid"></a><a class="anchor" name="7.3.1-fix_is_valid"></a><a class="anchor" name="fix_is_valid (Using ACLs and fetching samples)"></a><a class="anchor" name="fix_is_valid (Converters)"></a><div class="keyword"><b><a class="anchor" name="fix_is_valid"></a><a href="#7.3.1-fix_is_valid">fix_is_valid</a></b></div><pre class="text">Parses a binary payload and performs sanity checks regarding FIX (Financial
Information eXchange):

- checks that all tag IDs and values are not empty and the tags IDs are well
  numeric
- checks the BeginString tag is the first tag with a valid FIX version
- checks the BodyLength tag is the second one with the right body length
- checks the MsgType tag is the third tag.
- checks that last tag in the message is the CheckSum tag with a valid
  checksum

Due to current HAProxy design, only the first message sent by the client and
the server can be parsed.

This converter returns a boolean, true if the payload contains a valid FIX
message, false if not.

See also the fix_tag_value converter.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>tcp-request inspect-delay 10s
tcp-request content reject unless { req.payload(0,0),fix_is_valid }
</code></pre>
</div><a class="anchor" name="fix_tag_value"></a><a class="anchor" name="7-fix_tag_value"></a><a class="anchor" name="7.3.1-fix_tag_value"></a><a class="anchor" name="fix_tag_value (Using ACLs and fetching samples)"></a><a class="anchor" name="fix_tag_value (Converters)"></a><div class="keyword"><b><a class="anchor" name="fix_tag_value"></a><a href="#7.3.1-fix_tag_value">fix_tag_value</a></b>(<span style="color: #080">&lt;tag&gt;</span>)</div><pre class="text">Parses a FIX (Financial Information eXchange) message and extracts the value
from the tag &lt;tag&gt;. &lt;tag&gt; can be a string or an integer pointing to the
desired tag. Any integer value is accepted, but only the following strings
are translated into their integer equivalent: BeginString, BodyLength,
MsgType, SenderCompID, TargetCompID, CheckSum. More tag names can be easily
added.

Due to current HAProxy design, only the first message sent by the client and
the server can be parsed. No message validation is performed by this
converter. It is highly recommended to validate the message first using
fix_is_valid converter.

See also the fix_is_valid converter.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>tcp-request inspect-delay 10s
tcp-request content reject unless { req.payload(0,0),fix_is_valid }
<span class="comment"># MsgType tag ID is 35, so both lines below will return the same content</span>
tcp-request content set-var(txn.foo) req.payload(0,0),fix_tag_value(35)
tcp-request content set-var(txn.bar) req.payload(0,0),fix_tag_value(MsgType)
</code></pre>
</div><a class="anchor" name="hex"></a><a class="anchor" name="7-hex"></a><a class="anchor" name="7.3.1-hex"></a><a class="anchor" name="hex (Using ACLs and fetching samples)"></a><a class="anchor" name="hex (Converters)"></a><div class="keyword"><b><a class="anchor" name="hex"></a><a href="#7.3.1-hex">hex</a></b></div><pre class="text">Converts a binary input sample to a hex string containing two hex digits per
input byte. It is used to log or transfer hex dumps of some binary input data
in a way that can be reliably transferred (e.g. an SSL ID can be copied in a
header).
</pre><a class="anchor" name="hex2i"></a><a class="anchor" name="7-hex2i"></a><a class="anchor" name="7.3.1-hex2i"></a><a class="anchor" name="hex2i (Using ACLs and fetching samples)"></a><a class="anchor" name="hex2i (Converters)"></a><div class="keyword"><b><a class="anchor" name="hex2i"></a><a href="#7.3.1-hex2i">hex2i</a></b></div><pre class="text">Converts a hex string containing two hex digits per input byte to an
integer. If the input value cannot be converted, then zero is returned.
</pre><a class="anchor" name="hmac"></a><a class="anchor" name="7-hmac"></a><a class="anchor" name="7.3.1-hmac"></a><a class="anchor" name="hmac (Using ACLs and fetching samples)"></a><a class="anchor" name="hmac (Converters)"></a><div class="keyword"><b><a class="anchor" name="hmac"></a><a href="#7.3.1-hmac">hmac</a></b>(<span style="color: #080">&lt;algorithm&gt;</span>,<span style="color: #080">&lt;key&gt;</span>)</div><pre class="text">Converts a binary input sample to a message authentication code with the given
key. The result is a binary sample. The &lt;algorithm&gt; must be one of the
registered OpenSSL message digest names (e.g. sha256). The &lt;key&gt; parameter must
be base64 encoded and can either be a string or a variable.

Please note that this converter is only available when HAProxy has been
compiled with USE_OPENSSL.
</pre><a class="anchor" name="host_only"></a><a class="anchor" name="7-host_only"></a><a class="anchor" name="7.3.1-host_only"></a><a class="anchor" name="host_only (Using ACLs and fetching samples)"></a><a class="anchor" name="host_only (Converters)"></a><div class="keyword"><b><a class="anchor" name="host_only"></a><a href="#7.3.1-host_only">host_only</a></b></div><pre class="text">Converts a string which contains a Host header value and removes its port.
The input must respect the format of the host header value
(rfc9110#section-7.2). It will support that kind of input: hostname,
hostname:80, 127.0.0.1, 127.0.0.1:80, [::1], [::1]:80.

This converter also sets the string in lowercase.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#port_only">port_only</a>&quot; converter which will return the port.</div>
<a class="anchor" name="htonl"></a><a class="anchor" name="7-htonl"></a><a class="anchor" name="7.3.1-htonl"></a><a class="anchor" name="htonl (Using ACLs and fetching samples)"></a><a class="anchor" name="htonl (Converters)"></a><div class="keyword"><b><a class="anchor" name="htonl"></a><a href="#7.3.1-htonl">htonl</a></b></div><pre class="text">Converts the input integer value to its 32-bit binary representation in the
network byte order. Because sample fetches own signed 64-bit integer, when
this converter is used, the input integer value is first casted to an
unsigned 32-bit integer.
</pre><a class="anchor" name="http_date"></a><a class="anchor" name="7-http_date"></a><a class="anchor" name="7.3.1-http_date"></a><a class="anchor" name="http_date (Using ACLs and fetching samples)"></a><a class="anchor" name="http_date (Converters)"></a><div class="keyword"><b><a class="anchor" name="http_date"></a><a href="#7.3.1-http_date">http_date</a></b>(<span style="color: #008">[<span style="color: #080">&lt;offset</span>]</span>,<span style="color: #008">[<span style="color: #080">&lt;unit&gt;</span>]</span>)</div><pre class="text">Converts an integer supposed to contain a date since epoch to a string
representing this date in a format suitable for use in HTTP header fields. If
an offset value is specified, then it is added to the date before the
conversion is operated. This is particularly useful to emit Date header fields,
Expires values in responses when combined with a positive offset, or
Last-Modified values when the offset is negative.
If a unit value is specified, then consider the timestamp as either
&quot;s&quot; for seconds (default behavior), &quot;ms&quot; for milliseconds, or &quot;us&quot; for
microseconds since epoch. Offset is assumed to have the same unit as
input timestamp.
</pre><a class="anchor" name="iif"></a><a class="anchor" name="7-iif"></a><a class="anchor" name="7.3.1-iif"></a><a class="anchor" name="iif (Using ACLs and fetching samples)"></a><a class="anchor" name="iif (Converters)"></a><div class="keyword"><b><a class="anchor" name="iif"></a><a href="#7.3.1-iif">iif</a></b>(<span style="color: #080">&lt;true&gt;</span>,<span style="color: #080">&lt;false&gt;</span>)</div><pre class="text">Returns the &lt;true&gt; string if the input value is true. Returns the &lt;false&gt;
string otherwise.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request set-header x-forwarded-proto %[ssl_fc,iif(https,http)]
</code></pre>
</div><a class="anchor" name="in_table"></a><a class="anchor" name="7-in_table"></a><a class="anchor" name="7.3.1-in_table"></a><a class="anchor" name="in_table (Using ACLs and fetching samples)"></a><a class="anchor" name="in_table (Converters)"></a><div class="keyword"><b><a class="anchor" name="in_table"></a><a href="#7.3.1-in_table">in_table</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, a boolean false
is returned. Otherwise a boolean true is returned. This can be used to verify
the presence of a certain key in a table tracking some elements (e.g. whether
or not a source IP address or an Authorization header was already seen).
</pre><a class="anchor" name="ipmask"></a><a class="anchor" name="7-ipmask"></a><a class="anchor" name="7.3.1-ipmask"></a><a class="anchor" name="ipmask (Using ACLs and fetching samples)"></a><a class="anchor" name="ipmask (Converters)"></a><div class="keyword"><b><a class="anchor" name="ipmask"></a><a href="#7.3.1-ipmask">ipmask</a></b>(<span style="color: #080">&lt;mask4&gt;</span>,<span style="color: #008">[<span style="color: #080">&lt;mask6&gt;</span>]</span>)</div><pre class="text">Apply a mask to an IP address, and use the result for lookups and storage.
This can be used to make all hosts within a certain mask to share the same
table entries and as such use the same server. The mask4 can be passed in
dotted form (e.g. 255.255.255.0) or in CIDR form (e.g. 24). The mask6 can
be passed in quadruplet form (e.g. ffff:ffff::) or in CIDR form (e.g. 64).
If no mask6 is given IPv6 addresses will fail to convert for backwards
compatibility reasons.
</pre><a class="anchor" name="json"></a><a class="anchor" name="7-json"></a><a class="anchor" name="7.3.1-json"></a><a class="anchor" name="json (Using ACLs and fetching samples)"></a><a class="anchor" name="json (Converters)"></a><div class="keyword"><b><a class="anchor" name="json"></a><a href="#7.3.1-json">json</a></b>(<span style="color: #008">[<span style="color: #080">&lt;input-code&gt;</span>]</span>)</div><pre class="text">Escapes the input string and produces an ASCII output string ready to use as a
JSON string. The converter tries to decode the input string according to the
&lt;input-code&gt; parameter. It can be &quot;ascii&quot;, &quot;utf8&quot;, &quot;utf8s&quot;, &quot;utf8p&quot; or
&quot;utf8ps&quot;. The &quot;ascii&quot; decoder never fails. The &quot;utf8&quot; decoder detects 3 types
of errors:
 - bad UTF-8 sequence (lone continuation byte, bad number of continuation
   bytes, ...)
 - invalid range (the decoded value is within a UTF-8 prohibited range),
 - code overlong (the value is encoded with more bytes than necessary).

The UTF-8 JSON encoding can produce a &quot;too long value&quot; error when the UTF-8
character is greater than 0xffff because the JSON string escape specification
only authorizes 4 hex digits for the value encoding. The UTF-8 decoder exists
in 4 variants designated by a combination of two suffix letters : &quot;p&quot; for
&quot;permissive&quot; and &quot;s&quot; for &quot;silently ignore&quot;. The behaviors of the decoders
are :
 - &quot;ascii&quot;  : never fails;
 - &quot;utf8&quot;   : fails on any detected errors;
 - &quot;utf8s&quot;  : never fails, but removes characters corresponding to errors;
 - &quot;utf8p&quot;  : accepts and fixes the overlong errors, but fails on any other
              error;
 - &quot;utf8ps&quot; : never fails, accepts and fixes the overlong errors, but removes
              characters corresponding to the other errors.

This converter is particularly useful for building properly escaped JSON for
logging to servers which consume JSON-formatted traffic logs.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>capture request header Host len 15
capture request header user-agent len 150
log-format '{&quot;ip&quot;:&quot;%[src]&quot;,&quot;user-agent&quot;:&quot;%[capture.req.hdr(1),json(utf8s)]&quot;}'
</code></pre>
</div><pre class="text">Input request from client 127.0.0.1:
   GET / HTTP/1.0
   User-Agent: Very &quot;Ugly&quot; UA 1/2

Output log:
   {&quot;ip&quot;:&quot;127.0.0.1&quot;,&quot;user-agent&quot;:&quot;Very \&quot;Ugly\&quot; UA 1\/2&quot;}
</pre><a class="anchor" name="json_query"></a><a class="anchor" name="7-json_query"></a><a class="anchor" name="7.3.1-json_query"></a><a class="anchor" name="json_query (Using ACLs and fetching samples)"></a><a class="anchor" name="json_query (Converters)"></a><div class="keyword"><b><a class="anchor" name="json_query"></a><a href="#7.3.1-json_query">json_query</a></b>(<span style="color: #080">&lt;json_path&gt;</span>,<span style="color: #008">[<span style="color: #080">&lt;output_type&gt;</span>]</span>)</div><pre class="text">The json_query converter supports the JSON types string, boolean, number
and array. Floating point numbers will be returned as a string. By
specifying the output_type 'int' the value will be converted to an
Integer. Arrays will be returned as string, starting and ending with a
square brackets. The content is a CSV. Depending on the data type, the
array values might be quoted. If the array values are complex types,
the string contains the complete json representation of each value
separated by a comma. Example result for a roles query to a JWT:

   [&quot;manage-account&quot;,&quot;manage-account-links&quot;,&quot;view-profile&quot;]

If conversion is not possible the json_query converter fails.

&lt;json_path&gt; must be a valid JSON Path string as defined in
https://datatracker.ietf.org/doc/draft-ietf-jsonpath-base/
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># get a integer value from the request body</span>
<span class="comment"># &quot;{&quot;integer&quot;:4}&quot; =&gt; 5</span>
http-request set-var(txn.pay_int) req.body,json_query('$.integer','int'),add(1)

<span class="comment"># get a key with '.' in the name</span>
<span class="comment"># {&quot;my.key&quot;:&quot;myvalue&quot;} =&gt; myvalue</span>
http-request set-var(txn.pay_mykey) req.body,json_query('$.my\\.key')

<span class="comment"># {&quot;boolean-false&quot;:false} =&gt; 0</span>
http-request set-var(txn.pay_boolean_false) req.body,json_query('$.boolean-false')

<span class="comment"># get the value of the key 'iss' from a JWT Bearer token</span>
http-request set-var(txn.token_payload) req.hdr(Authorization),word(2,.),ub64dec,json_query('$.iss')
</code></pre>
</div><a class="anchor" name="jwt_header_query"></a><a class="anchor" name="7-jwt_header_query"></a><a class="anchor" name="7.3.1-jwt_header_query"></a><a class="anchor" name="jwt_header_query (Using ACLs and fetching samples)"></a><a class="anchor" name="jwt_header_query (Converters)"></a><div class="keyword"><b><a class="anchor" name="jwt_header_query"></a><a href="#7.3.1-jwt_header_query">jwt_header_query</a></b>(<span style="color: #008">[<span style="color: #080">&lt;json_path&gt;</span>]</span>,<span style="color: #008">[<span style="color: #080">&lt;output_type&gt;</span>]</span>)</div><pre class="text">When given a JSON Web Token (JWT) in input, either returns the decoded header
part of the token (the first base64-url encoded part of the JWT) if no
parameter is given, or performs a json_query on the decoded header part of
the token. See &quot;<a href="#json_query">json_query</a>&quot; converter for details about the accepted
json_path and output_type parameters.

Please note that this converter is only available when HAProxy has been
compiled with USE_OPENSSL.
</pre><a class="anchor" name="jwt_payload_query"></a><a class="anchor" name="7-jwt_payload_query"></a><a class="anchor" name="7.3.1-jwt_payload_query"></a><a class="anchor" name="jwt_payload_query (Using ACLs and fetching samples)"></a><a class="anchor" name="jwt_payload_query (Converters)"></a><div class="keyword"><b><a class="anchor" name="jwt_payload_query"></a><a href="#7.3.1-jwt_payload_query">jwt_payload_query</a></b>(<span style="color: #008">[<span style="color: #080">&lt;json_path&gt;</span>]</span>,<span style="color: #008">[<span style="color: #080">&lt;output_type&gt;</span>]</span>)</div><pre class="text">When given a JSON Web Token (JWT) in input, either returns the decoded
payload part of the token (the second base64-url encoded part of the JWT) if
no parameter is given, or performs a json_query on the decoded payload part
of the token. See &quot;<a href="#json_query">json_query</a>&quot; converter for details about the accepted
json_path and output_type parameters.

Please note that this converter is only available when HAProxy has been
compiled with USE_OPENSSL.
</pre><a class="anchor" name="jwt_verify"></a><a class="anchor" name="7-jwt_verify"></a><a class="anchor" name="7.3.1-jwt_verify"></a><a class="anchor" name="jwt_verify (Using ACLs and fetching samples)"></a><a class="anchor" name="jwt_verify (Converters)"></a><div class="keyword"><b><a class="anchor" name="jwt_verify"></a><a href="#7.3.1-jwt_verify">jwt_verify</a></b>(<span style="color: #080">&lt;alg&gt;</span>,<span style="color: #080">&lt;key&gt;</span>)</div><pre class="text">Performs a signature verification for the JSON Web Token (JWT) given in input
by using the &lt;alg&gt; algorithm and the &lt;key&gt; parameter, which should either
hold a secret or a path to a public certificate. Returns 1 in case of
verification success, 0 in case of verification error and a strictly negative
value for any other error. Because of all those non-null error return values,
the result of this converter should never be converted to a boolean. See
below for a full list of the possible return values.

For now, only JWS tokens using the Compact Serialization format can be
processed (three dot-separated base64-url encoded strings). All the
algorithms mentioned in <a href="#3.1">section 3.1</a> of RFC7518 are managed (HS, ES, RS and PS
with the 256, 384 or 512 key sizes, as well as the special &quot;none&quot; case).

If the used algorithm is of the HMAC family, &lt;key&gt; should be the secret used
in the HMAC signature calculation. Otherwise, &lt;key&gt; should be the path to the
public certificate that can be used to validate the token's signature. All
the certificates that might be used to verify JWTs must be known during init
in order to be added into a dedicated certificate cache so that no disk
access is required during runtime. For this reason, any used certificate must
be mentioned explicitly at least once in a jwt_verify call. Passing an
intermediate variable as second parameter is then not advised.

This converter only verifies the signature of the token and does not perform
a full JWT validation as specified in <a href="#7.2">section 7.2</a> of RFC7519. We do not
ensure that the header and payload contents are fully valid JSON's once
decoded for instance, and no checks are performed regarding their respective
contents.

The possible return values are the following :

+----+----------------------------------------------------------------------+
| ID | message                                                              |
+----+----------------------------------------------------------------------+
|  0 | &quot;Verification failure&quot;                                               |
|  1 | &quot;Verification success&quot;                                               |
| -1 | &quot;Unknown algorithm (not mentioned in RFC7518)&quot;                       |
| -2 | &quot;Unmanaged algorithm&quot;                                                |
| -3 | &quot;Invalid token&quot;                                                      |
| -4 | &quot;Out of memory&quot;                                                      |
| -5 | &quot;Unknown certificate&quot;                                                |
+----+----------------------------------------------------------------------+

Please note that this converter is only available when HAProxy has been
compiled with USE_OPENSSL.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># Get a JWT from the authorization header, extract the &quot;alg&quot; field of its</span>
<span class="comment"># JOSE header and use a public certificate to verify a signature</span>
http-request set-var(txn.bearer) http_auth_bearer
http-request set-var(txn.jwt_alg) var(txn.bearer),jwt_header_query('$.alg')
http-request deny unless { var(txn.jwt_alg) -m str &quot;RS256&quot; }
http-request deny unless { var(txn.bearer),jwt_verify(txn.jwt_alg,&quot;/path/to/crt.pem&quot;) 1 }
</code></pre>
</div><a class="anchor" name="language"></a><a class="anchor" name="7-language"></a><a class="anchor" name="7.3.1-language"></a><a class="anchor" name="language (Using ACLs and fetching samples)"></a><a class="anchor" name="language (Converters)"></a><div class="keyword"><b><a class="anchor" name="language"></a><a href="#7.3.1-language">language</a></b>(<span style="color: #080">&lt;value&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;default&gt;</span>]</span>)</div><pre class="text">Returns the value with the highest q-factor from a list as extracted from the
&quot;accept-language&quot; header using &quot;<a href="#req.fhdr">req.fhdr</a>&quot;. Values with no q-factor have a
q-factor of 1. Values with a q-factor of 0 are dropped. Only values which
belong to the list of semi-colon delimited &lt;values&gt; will be considered. The
argument &lt;value&gt; syntax is &quot;lang[;lang[;lang[;...]]]&quot;. If no value matches the
given list and a default value is provided, it is returned. Note that language
names may have a variant after a dash ('-'). If this variant is present in the
list, it will be matched, but if it is not, only the base language is checked.
The match is case-sensitive, and the output string is always one of those
provided in arguments. The ordering of arguments is meaningless, only the
ordering of the values in the request counts, as the first value among
multiple sharing the same q-factor is used.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># this configuration switches to the backend matching a</span>
<span class="comment"># given language based on the request :</span>

acl es req.fhdr(accept-language),language(es;fr;en) -m str es
acl fr req.fhdr(accept-language),language(es;fr;en) -m str fr
acl en req.fhdr(accept-language),language(es;fr;en) -m str en
use_backend spanish if es
use_backend french  if fr
use_backend english if en
default_backend choose_your_language
</code></pre>
</div><a class="anchor" name="length"></a><a class="anchor" name="7-length"></a><a class="anchor" name="7.3.1-length"></a><a class="anchor" name="length (Using ACLs and fetching samples)"></a><a class="anchor" name="length (Converters)"></a><div class="keyword"><b><a class="anchor" name="length"></a><a href="#7.3.1-length">length</a></b></div><pre class="text">Get the length of the string. This can only be placed after a string
sample fetch function or after a transformation keyword returning a string
type. The result is of type integer.
</pre><a class="anchor" name="lower"></a><a class="anchor" name="7-lower"></a><a class="anchor" name="7.3.1-lower"></a><a class="anchor" name="lower (Using ACLs and fetching samples)"></a><a class="anchor" name="lower (Converters)"></a><div class="keyword"><b><a class="anchor" name="lower"></a><a href="#7.3.1-lower">lower</a></b></div><pre class="text">Convert a string sample to lower case. This can only be placed after a string
sample fetch function or after a transformation keyword returning a string
type. The result is of type string.
</pre><a class="anchor" name="ltime"></a><a class="anchor" name="7-ltime"></a><a class="anchor" name="7.3.1-ltime"></a><a class="anchor" name="ltime (Using ACLs and fetching samples)"></a><a class="anchor" name="ltime (Converters)"></a><div class="keyword"><b><a class="anchor" name="ltime"></a><a href="#7.3.1-ltime">ltime</a></b>(<span style="color: #080">&lt;format&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;offset&gt;</span>]</span>)</div><pre class="text">Converts an integer supposed to contain a date since epoch to a string
representing this date in local time using a format defined by the &lt;format&gt;
string using strftime(3). The purpose is to allow any date format to be used
in logs. An optional &lt;offset&gt; in seconds may be applied to the input date
(positive or negative). See the strftime() man page for the format supported
by your operating system. See also the utime converter.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># Emit two colons, one with the local time and another with ip:port</span>
<span class="comment"># e.g.  20140710162350 127.0.0.1:57325</span>
log-format %[date,ltime(%Y%m%d%H%M%S)]\ %ci:%cp
</code></pre>
</div><a class="anchor" name="ltrim"></a><a class="anchor" name="7-ltrim"></a><a class="anchor" name="7.3.1-ltrim"></a><a class="anchor" name="ltrim (Using ACLs and fetching samples)"></a><a class="anchor" name="ltrim (Converters)"></a><div class="keyword"><b><a class="anchor" name="ltrim"></a><a href="#7.3.1-ltrim">ltrim</a></b>(<span style="color: #080">&lt;chars&gt;</span>)</div><pre class="text">Skips any characters from &lt;chars&gt; from the beginning of the string
representation of the input sample.
</pre><a class="anchor" name="map"></a><a class="anchor" name="7-map"></a><a class="anchor" name="7.3.1-map"></a><a class="anchor" name="map (Using ACLs and fetching samples)"></a><a class="anchor" name="map (Converters)"></a><div class="keyword"><b><a class="anchor" name="map"></a><a href="#7.3.1-map">map</a></b>(<span style="color: #080">&lt;map_name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;default_value&gt;</span>]</span>)</div><pre class="text">map_&lt;match_type&gt;(&lt;map_name&gt;[,&lt;default_value&gt;])
map_&lt;match_type&gt;_&lt;output_type&gt;(&lt;map_name&gt;[,&lt;default_value&gt;])
  Search the input value from &lt;map_name&gt; using the &lt;match_type&gt; matching
  method, and return the associated value converted to the type &lt;output_type&gt;.
  If the input value cannot be found in the &lt;map_name&gt;, the converter returns
  the &lt;default_value&gt;. If the &lt;default_value&gt; is not set, the converter fails
  and acts as if no input value could be fetched. If the &lt;match_type&gt; is not
  set, it defaults to &quot;<a href="#str">str</a>&quot;. Likewise, if the &lt;output_type&gt; is not set, it
  defaults to &quot;<a href="#str">str</a>&quot;. For convenience, the &quot;<a href="#map">map</a>&quot; keyword is an alias for
  &quot;map_str&quot; and maps a string to another string. &lt;map_name&gt; must follow the
  format described in 2.7. about name format for maps and ACLs

  It is important to avoid overlapping between the keys : IP addresses and
  strings are stored in trees, so the first of the finest match will be used.
  Other keys are stored in lists, so the first matching occurrence will be used.

  The following array contains the list of all map functions available sorted by
  input type, match type and output type.
</pre><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>input type</th><th>match method</th><th>output type str</th><th>output type int</th><th>output type ip</th><th>output type key</th></tr></thead>
<tr><td >str</td><td >str</td><td >map_str</td><td >map_str_int</td><td >map_str_ip</td><td >map_str_key</td></tr>
<tr><td >str</td><td >beg</td><td >map_beg</td><td >map_beg_int</td><td >map_end_ip</td><td >map_end_key</td></tr>
<tr><td >str</td><td >sub</td><td >map_sub</td><td >map_sub_int</td><td >map_sub_ip</td><td >map_sub_key</td></tr>
<tr><td >str</td><td >dir</td><td >map_dir</td><td >map_dir_int</td><td >map_dir_ip</td><td >map_dir_key</td></tr>
<tr><td >str</td><td >dom</td><td >map_dom</td><td >map_dom_int</td><td >map_dom_ip</td><td >map_dom_key</td></tr>
<tr><td >str</td><td >end</td><td >map_end</td><td >map_end_int</td><td >map_end_ip</td><td >map_end_key</td></tr>
<tr><td >str</td><td >reg</td><td >map_reg</td><td >map_reg_int</td><td >map_reg_ip</td><td >map_reg_key</td></tr>
<tr><td >str</td><td >reg</td><td >map_regm</td><td >map_reg_int</td><td >map_reg_ip</td><td >map_reg_key</td></tr>
<tr><td >int</td><td >int</td><td >map_int</td><td >map_int_int</td><td >map_int_ip</td><td >map_int_key</td></tr>
<tr><td >ip</td><td >ip</td><td >map_ip</td><td >map_ip_int</td><td >map_ip_ip</td><td >map_ip_key</td></tr>
</table><pre class="text">The special map called &quot;map_regm&quot; expect matching zone in the regular
expression and modify the output replacing back reference (like &quot;\1&quot;) by
the corresponding match text.

Output type &quot;<a href="#key">key</a>&quot; means that it is the matched entry's key (as found in the
map file) that will be returned as a string instead of the value. Note that
optional &lt;default_value&gt; argument is not supported when &quot;<a href="#key">key</a>&quot; output type is
used.

Files referenced by &lt;map_name&gt; contains one key + value per line. Lines which
start with '#' are ignored, just like empty lines. Leading tabs and spaces
are stripped. The key is then the first &quot;<a href="#word">word</a>&quot; (series of non-space/tabs
characters), and the value is what follows this series of space/tab till the
end of the line excluding trailing spaces/tabs.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># this is a comment and is ignored</span>
   2.22.246.0/23    United Kingdom      \n
&lt;-&gt;&lt;-----------&gt;&lt;--&gt;&lt;------------&gt;&lt;----&gt;
 |       |       |         |        `- trailing spaces ignored
 |       |       |         `---------- value
 |       |       `-------------------- middle spaces ignored
 |       `---------------------------- <a href="#key">key</a>
 `------------------------------------ leading spaces ignored
</code></pre>
</div><a class="anchor" name="mod"></a><a class="anchor" name="7-mod"></a><a class="anchor" name="7.3.1-mod"></a><a class="anchor" name="mod (Using ACLs and fetching samples)"></a><a class="anchor" name="mod (Converters)"></a><div class="keyword"><b><a class="anchor" name="mod"></a><a href="#7.3.1-mod">mod</a></b>(<span style="color: #080">&lt;value&gt;</span>)</div><pre class="text">Divides the input value of type signed integer by &lt;value&gt;, and returns the
remainder as an signed integer. If &lt;value&gt; is null, then zero is returned.
&lt;value&gt; can be a numeric value or a variable name. See <a href="#2.8">section 2.8</a> about
variables for details.
</pre><a class="anchor" name="mqtt_field_value"></a><a class="anchor" name="7-mqtt_field_value"></a><a class="anchor" name="7.3.1-mqtt_field_value"></a><a class="anchor" name="mqtt_field_value (Using ACLs and fetching samples)"></a><a class="anchor" name="mqtt_field_value (Converters)"></a><div class="keyword"><b><a class="anchor" name="mqtt_field_value"></a><a href="#7.3.1-mqtt_field_value">mqtt_field_value</a></b>(<span style="color: #080">&lt;packettype&gt;</span>,<span style="color: #080">&lt;fieldname_or_property_ID&gt;</span>)</div><pre class="text">Returns value of &lt;fieldname&gt; found in input MQTT payload of type
&lt;packettype&gt;.
&lt;packettype&gt; can be either a string (case insensitive matching) or a numeric
value corresponding to the type of packet we're supposed to extract data
from.
Supported string and integers can be found here:
https://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html#_Toc398718021
https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.html#_Toc3901022

&lt;fieldname&gt; depends on &lt;packettype&gt; and can be any of the following below.
(note that &lt;fieldname&gt; matching is case insensitive).
&lt;property id&gt; can only be found in MQTT v5.0 streams. check this table:
https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.html#_Toc3901029

- CONNECT (or 1): flags, protocol_name, protocol_version, client_identifier,
                  will_topic, will_payload, username, password, keepalive
                  OR any property ID as a numeric value (for MQTT v5.0
                  packets only):
                     17: Session Expiry Interval
                     33: Receive Maximum
                     39: Maximum Packet Size
                     34: Topic Alias Maximum
                     25: Request Response Information
                     23: Request Problem Information
                     21: Authentication Method
                     22: Authentication Data
                     18: Will Delay Interval
                      1: Payload Format Indicator
                      2: Message Expiry Interval
                      3: Content Type
                      8: Response Topic
                      9: Correlation Data
                  Not supported yet:
                     38: User Property

- CONNACK (or 2): flags, protocol_version, reason_code
                  OR any property ID as a numeric value (for MQTT v5.0
                  packets only):
                     17: Session Expiry Interval
                     33: Receive Maximum
                     36: Maximum QoS
                     37: Retain Available
                     39: Maximum Packet Size
                     18: Assigned Client Identifier
                     34: Topic Alias Maximum
                     31: Reason String
                     40; Wildcard Subscription Available
                     41: Subscription Identifiers Available
                     42: Shared Subscription Available
                     19: Server Keep Alive
                     26: Response Information
                     28: Server Reference
                     21: Authentication Method
                     22: Authentication Data
                  Not supported yet:
                     38: User Property

Due to current HAProxy design, only the first message sent by the client and
the server can be parsed. Thus this converter can extract data only from
CONNECT and CONNACK packet types. CONNECT is the first message sent by the
client and CONNACK is the first response sent by the server.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>acl data_in_buffer req.len ge 4
tcp-request content set-var(txn.username) \
        req.payload(0,0),mqtt_field_value(connect,protocol_name) \
        if data_in_buffer
<span class="comment"># do the same as above</span>
tcp-request content set-var(txn.username) \
        req.payload(0,0),mqtt_field_value(1,protocol_name) \
        if data_in_buffer
</code></pre>
</div><a class="anchor" name="mqtt_is_valid"></a><a class="anchor" name="7-mqtt_is_valid"></a><a class="anchor" name="7.3.1-mqtt_is_valid"></a><a class="anchor" name="mqtt_is_valid (Using ACLs and fetching samples)"></a><a class="anchor" name="mqtt_is_valid (Converters)"></a><div class="keyword"><b><a class="anchor" name="mqtt_is_valid"></a><a href="#7.3.1-mqtt_is_valid">mqtt_is_valid</a></b></div><pre class="text">Checks that the binary input is a valid MQTT packet. It returns a boolean.

Due to current HAProxy design, only the first message sent by the client and
the server can be parsed. Thus this converter can extract data only from
CONNECT and CONNACK packet types. CONNECT is the first message sent by the
client and CONNACK is the first response sent by the server.

Only MQTT 3.1, 3.1.1 and 5.0 are supported.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>acl data_in_buffer req.len ge 4
tcp-request content reject unless { req.payload(0,0),mqtt_is_valid }
</code></pre>
</div><a class="anchor" name="ms_ltime"></a><a class="anchor" name="7-ms_ltime"></a><a class="anchor" name="7.3.1-ms_ltime"></a><a class="anchor" name="ms_ltime (Using ACLs and fetching samples)"></a><a class="anchor" name="ms_ltime (Converters)"></a><div class="keyword"><b><a class="anchor" name="ms_ltime"></a><a href="#7.3.1-ms_ltime">ms_ltime</a></b>(<span style="color: #080">&lt;format&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;offset&gt;</span>]</span>)</div><pre class="text">This works like &quot;<a href="#ltime">ltime</a>&quot; but takes an input in milliseconds. It also supports
the %N conversion specifier inspired by date(1).
Converts an integer supposed to contain a date since epoch to a string
representing this date in local time using a format defined by the &lt;format&gt;
string using strftime(3). The purpose is to allow any date format to be used
in logs. An optional &lt;offset&gt; in milliseconds may be applied to the input date
(positive or negative). See the strftime() man page for the format supported
by your operating system.

The %N conversion specifier allows you to output the nanoseconds part of the
date, precision is limited since the input is milliseconds.
(000000000..999000000).  %N can take a width argument between % and N. It is
useful to display milliseconds (%3N) or microseconds (%6N). The default and
maximum width is 9 (%N = %9N).

See also the utime converter for UTC as well as &quot;<a href="#ltime">ltime</a>&quot; and &quot;<a href="#us_ltime">us_ltime</a>&quot;
converters.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># Emit 3 colons, the local time, the timezone and another with ip:port</span>
<span class="comment"># e.g. 2023/07/24/11:53:02.196 +0200 127.0.0.1:41530</span>
log-format %[accept_date(ms),ms_ltime(&quot;%Y/%m/%d/%H:%M:%S.%3N %z&quot;)]\ %ci:%cp
</code></pre>
</div><a class="anchor" name="ms_utime"></a><a class="anchor" name="7-ms_utime"></a><a class="anchor" name="7.3.1-ms_utime"></a><a class="anchor" name="ms_utime (Using ACLs and fetching samples)"></a><a class="anchor" name="ms_utime (Converters)"></a><div class="keyword"><b><a class="anchor" name="ms_utime"></a><a href="#7.3.1-ms_utime">ms_utime</a></b>(<span style="color: #080">&lt;format&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;offset&gt;</span>]</span>)</div><pre class="text">This works like &quot;<a href="#utime">utime</a>&quot; but takes an input in milliseconds. It also supports
the %N conversion specifier inspired by date(1).
Converts an integer supposed to contain a date since epoch to a string
representing this date in UTC time using a format defined by the &lt;format&gt;
string using strftime(3). The purpose is to allow any date format to be used
in logs. An optional &lt;offset&gt; in milliseconds may be applied to the input date
(positive or negative). See the strftime() man page for the format supported
by your operating system.

The %N conversion specifier allows you to output the nanoseconds part of the
date, precision is limited since the input is milliseconds.
(000000000..999000000).  %N can take a width argument between % and N. It is
useful to display milliseconds (%3N) or microseconds (%6N). The default and
maximum width is 9 (%N = %9N).

See also the ltime converter for local as well as &quot;<a href="#utime">utime</a>&quot; and &quot;<a href="#us_utime">us_utime</a>&quot;
converters.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># Emit 3 colons, the UTC time, the timezone and another with ip:port</span>
<span class="comment"># e.g. 2023/07/24/09:53:02.196 +0000 127.0.0.1:41530</span>
log-format %[accept_date(ms),ms_utime(&quot;%Y/%m/%d/%H:%M:%S.%3N %z&quot;)]\ %ci:%cp
</code></pre>
</div><a class="anchor" name="mul"></a><a class="anchor" name="7-mul"></a><a class="anchor" name="7.3.1-mul"></a><a class="anchor" name="mul (Using ACLs and fetching samples)"></a><a class="anchor" name="mul (Converters)"></a><div class="keyword"><b><a class="anchor" name="mul"></a><a href="#7.3.1-mul">mul</a></b>(<span style="color: #080">&lt;value&gt;</span>)</div><pre class="text">Multiplies the input value of type signed integer by &lt;value&gt;, and returns
the product as an signed integer. In case of overflow, the largest possible
value for the sign is returned so that the operation doesn't wrap around.
&lt;value&gt; can be a numeric value or a variable name. See <a href="#2.8">section 2.8</a> about
variables for details.
</pre><a class="anchor" name="nbsrv"></a><a class="anchor" name="7-nbsrv"></a><a class="anchor" name="7.3.1-nbsrv"></a><a class="anchor" name="nbsrv (Using ACLs and fetching samples)"></a><a class="anchor" name="nbsrv (Converters)"></a><div class="keyword"><b><a class="anchor" name="nbsrv"></a><a href="#7.3.1-nbsrv">nbsrv</a></b></div><pre class="text">Takes an input value of type string, interprets it as a backend name and
returns the number of usable servers in that backend. Can be used in places
where we want to look up a backend from a dynamic name, like a result of a
map lookup.
</pre><a class="anchor" name="neg"></a><a class="anchor" name="7-neg"></a><a class="anchor" name="7.3.1-neg"></a><a class="anchor" name="neg (Using ACLs and fetching samples)"></a><a class="anchor" name="neg (Converters)"></a><div class="keyword"><b><a class="anchor" name="neg"></a><a href="#7.3.1-neg">neg</a></b></div><pre class="text">Takes the input value of type signed integer, computes the opposite value,
and returns the remainder as an signed integer. 0 is identity. This operator
is provided for reversed subtracts : in order to subtract the input from a
constant, simply perform a &quot;neg,add(value)&quot;.
</pre><a class="anchor" name="not"></a><a class="anchor" name="7-not"></a><a class="anchor" name="7.3.1-not"></a><a class="anchor" name="not (Using ACLs and fetching samples)"></a><a class="anchor" name="not (Converters)"></a><div class="keyword"><b><a class="anchor" name="not"></a><a href="#7.3.1-not">not</a></b></div><pre class="text">Returns a boolean FALSE if the input value of type signed integer is
non-null, otherwise returns TRUE. Used in conjunction with and(), it can be
used to report true/false for bit testing on input values (e.g. verify the
absence of a flag).
</pre><a class="anchor" name="odd"></a><a class="anchor" name="7-odd"></a><a class="anchor" name="7.3.1-odd"></a><a class="anchor" name="odd (Using ACLs and fetching samples)"></a><a class="anchor" name="odd (Converters)"></a><div class="keyword"><b><a class="anchor" name="odd"></a><a href="#7.3.1-odd">odd</a></b></div><pre class="text">Returns a boolean TRUE if the input value of type signed integer is odd
otherwise returns FALSE. It is functionally equivalent to &quot;and(1),bool&quot;.
</pre><a class="anchor" name="or"></a><a class="anchor" name="7-or"></a><a class="anchor" name="7.3.1-or"></a><a class="anchor" name="or (Using ACLs and fetching samples)"></a><a class="anchor" name="or (Converters)"></a><div class="keyword"><b><a class="anchor" name="or"></a><a href="#7.3.1-or">or</a></b>(<span style="color: #080">&lt;value&gt;</span>)</div><pre class="text">Performs a bitwise &quot;OR&quot; between &lt;value&gt; and the input value of type signed
integer, and returns the result as an signed integer. &lt;value&gt; can be a
numeric value or a variable name. See <a href="#2.8">section 2.8</a> about variables for details.
</pre><a class="anchor" name="param"></a><a class="anchor" name="7-param"></a><a class="anchor" name="7.3.1-param"></a><a class="anchor" name="param (Using ACLs and fetching samples)"></a><a class="anchor" name="param (Converters)"></a><div class="keyword"><b><a class="anchor" name="param"></a><a href="#7.3.1-param">param</a></b>(<span style="color: #080">&lt;name&gt;</span>,<span style="color: #008">[<span style="color: #080">&lt;delim&gt;</span>]</span>)</div><pre class="text">This extracts the first occurrence of the parameter &lt;name&gt; in the input string
where parameters are delimited by &lt;delim&gt;, which defaults to &quot;&amp;&quot;, and the name
and value of the parameter are separated by a &quot;=&quot;. If there is no &quot;=&quot; and
value before the end of the parameter segment, it is treated as equivalent to
a value of an empty string.

This can be useful for extracting parameters from a query string, or possibly
a x-www-form-urlencoded body. In particular, `query,param(&lt;name&gt;)` can be used
as an alternative to `urlp(&lt;name&gt;)` which only uses &quot;&amp;&quot; as a delimiter,
whereas &quot;<a href="#urlp">urlp</a>&quot; also uses &quot;?&quot; and &quot;;&quot;.

Note that this converter doesn't do anything special with url encoded
characters. If you want to decode the value, you can use the url_dec converter
on the output. If the name of the parameter in the input might contain encoded
characters, you'll probably want do normalize the input before calling
&quot;<a href="#param">param</a>&quot;. This can be done using &quot;http-request normalize-uri&quot;, in particular
the percent-decode-unreserved and percent-to-uppercase options.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>str(a=b&amp;c=d&amp;a=r),param(a)   <span class="comment"># b</span>
str(a&amp;b=c),param(a)         <span class="comment"># &quot;&quot;</span>
str(a=&amp;b&amp;c=a),param(b)      <span class="comment"># &quot;&quot;</span>
str(a=1;b=2;c=4),param(b,;) <span class="comment"># 2</span>
query,param(redirect_uri),urldec()
</code></pre>
</div><a class="anchor" name="port_only"></a><a class="anchor" name="7-port_only"></a><a class="anchor" name="7.3.1-port_only"></a><a class="anchor" name="port_only (Using ACLs and fetching samples)"></a><a class="anchor" name="port_only (Converters)"></a><div class="keyword"><b><a class="anchor" name="port_only"></a><a href="#7.3.1-port_only">port_only</a></b></div><pre class="text">Converts a string which contains a Host header value into an integer by
returning its port.
The input must respect the format of the host header value
(rfc9110#section-7.2). It will support that kind of input: hostname,
hostname:80, 127.0.0.1, 127.0.0.1:80, [::1], [::1]:80.

If no port were provided in the input, it will return 0.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#host_only">host_only</a>&quot; converter which will return the host.</div>
<a class="anchor" name="protobuf"></a><a class="anchor" name="7-protobuf"></a><a class="anchor" name="7.3.1-protobuf"></a><a class="anchor" name="protobuf (Using ACLs and fetching samples)"></a><a class="anchor" name="protobuf (Converters)"></a><div class="keyword"><b><a class="anchor" name="protobuf"></a><a href="#7.3.1-protobuf">protobuf</a></b>(<span style="color: #080">&lt;field_number&gt;</span>,<span style="color: #008">[<span style="color: #080">&lt;field_type&gt;</span>]</span>)</div><pre class="text">This extracts the protocol buffers message field in raw mode of an input binary
sample representation of a protocol buffer message with &lt;field_number&gt; as field
number (dotted notation) if &lt;field_type&gt; is not present, or as an integer sample
if this field is present (see also &quot;<a href="#ungrpc">ungrpc</a>&quot; below).
The list of the authorized types is the following one: &quot;int32&quot;, &quot;int64&quot;, &quot;uint32&quot;,
&quot;uint64&quot;, &quot;sint32&quot;, &quot;sint64&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bool<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bool%20%28Converters%29">Converters</a></li><li><a href="#bool%20%28Fetching%20samples%20from%20internal%20states%29">Fetching samples from internal states</a></li></ul></span>&quot;, &quot;enum&quot; for the &quot;varint&quot; wire type 0
&quot;fixed64&quot;, &quot;sfixed64&quot;, &quot;double&quot; for the 64bit wire type 1, &quot;fixed32&quot;, &quot;sfixed32&quot;,
&quot;float&quot; for the wire type 5. Note that &quot;string&quot; is considered as a length-delimited
type, so it does not require any &lt;field_type&gt; argument to be extracted.
More information may be found here about the protocol buffers message field types:
https://developers.google.com/protocol-buffers/docs/encoding
</pre><a class="anchor" name="regsub"></a><a class="anchor" name="7-regsub"></a><a class="anchor" name="7.3.1-regsub"></a><a class="anchor" name="regsub (Using ACLs and fetching samples)"></a><a class="anchor" name="regsub (Converters)"></a><div class="keyword"><b><a class="anchor" name="regsub"></a><a href="#7.3.1-regsub">regsub</a></b>(<span style="color: #080">&lt;regex&gt;</span>,<span style="color: #080">&lt;subst&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;flags&gt;</span>]</span>)</div><pre class="text">Applies a regex-based substitution to the input string. It does the same
operation as the well-known &quot;sed&quot; utility with &quot;s/&lt;regex&gt;/&lt;subst&gt;/&quot;. By
default it will replace in the input string the first occurrence of the
largest part matching the regular expression &lt;regex&gt; with the substitution
string &lt;subst&gt;. It is possible to replace all occurrences instead by adding
the flag &quot;g&quot; in the third argument &lt;flags&gt;. It is also possible to make the
regex case insensitive by adding the flag &quot;i&quot; in &lt;flags&gt;. Since &lt;flags&gt; is a
string, it is made up from the concatenation of all desired flags. Thus if
both &quot;i&quot; and &quot;g&quot; are desired, using &quot;gi&quot; or &quot;ig&quot; will have the same effect.
The first use of this converter is to replace certain characters or sequence
of characters with other ones.

It is highly recommended to enclose the regex part using protected quotes to
improve clarity and never have a closing parenthesis from the regex mixed up
with the parenthesis from the function. Just like in Bourne shell, the first
level of quotes is processed when delimiting word groups on the line, a
second level is usable for argument. It is recommended to use single quotes
outside since these ones do not try to resolve backslashes nor dollar signs.
</pre><div class="separator">
<span class="label label-success">Examples:</span>
<pre class="prettyprint">
<code><span class="comment"># de-duplicate &quot;/&quot; in header &quot;x-path&quot;.</span>
<span class="comment"># input:  x-path: /////a///b/c/xzxyz/</span>
<span class="comment"># output: x-path: /a/b/c/xzxyz/</span>
http-request set-header x-path &quot;%[hdr(x-path),regsub('/+','/','g')]&quot;

<span class="comment"># copy query string to x-query and drop all leading '?', ';' and '&amp;'</span>
http-request set-header x-query &quot;%[query,regsub([?;&amp;]*,'')]&quot;

<span class="comment"># capture groups and backreferences</span>
<span class="comment"># both lines do the same.</span>
http-request redirect location %[url,'regsub(&quot;(foo|bar)([0-9]+)?&quot;,&quot;\2\1&quot;,i)']
http-request redirect location %[url,regsub(\&quot;(foo|bar)([0-9]+)?\&quot;,\&quot;\2\1\&quot;,i)]
</code></pre>
</div><a class="anchor" name="rfc7239_field"></a><a class="anchor" name="7-rfc7239_field"></a><a class="anchor" name="7.3.1-rfc7239_field"></a><a class="anchor" name="rfc7239_field (Using ACLs and fetching samples)"></a><a class="anchor" name="rfc7239_field (Converters)"></a><div class="keyword"><b><a class="anchor" name="rfc7239_field"></a><a href="#7.3.1-rfc7239_field">rfc7239_field</a></b>(<span style="color: #080">&lt;field&gt;</span>)</div><pre class="text">Extracts a single field/parameter from RFC 7239 compliant header value input.

Supported fields are:
  - proto: either 'http' or 'https'
  - host: http compliant host
  - for: RFC7239 node
  - by: RFC7239 node

More info here:
  https://www.rfc-editor.org/rfc/rfc7239.html#section-6
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># extract host field from forwarded header and store it in req.fhost var</span>
http-request set-var(req.fhost) req.hdr(forwarded),rfc7239_field(host)
<span class="comment">#input: &quot;proto=https;host=\&quot;haproxy.org:80\&quot;&quot;</span>
<span class="comment">#  output: &quot;haproxy.org:80&quot;</span>

<span class="comment"># extract for field from forwarded header and store it in req.ffor var</span>
http-request set-var(req.ffor) req.hdr(forwarded),rfc7239_field(for)
<span class="comment">#input: &quot;proto=https;host=\&quot;haproxy.org:80\&quot;;for=\&quot;127.0.0.1:9999\&quot;&quot;</span>
<span class="comment">#  output: &quot;127.0.0.1:9999&quot;</span>
</code></pre>
</div><a class="anchor" name="rfc7239_is_valid"></a><a class="anchor" name="7-rfc7239_is_valid"></a><a class="anchor" name="7.3.1-rfc7239_is_valid"></a><a class="anchor" name="rfc7239_is_valid (Using ACLs and fetching samples)"></a><a class="anchor" name="rfc7239_is_valid (Converters)"></a><div class="keyword"><b><a class="anchor" name="rfc7239_is_valid"></a><a href="#7.3.1-rfc7239_is_valid">rfc7239_is_valid</a></b></div><pre class="text">Returns true if input header is RFC 7239 compliant header value and false
otherwise.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>acl valid req.hdr(forwarded),rfc7239_is_valid
<span class="comment">#input: &quot;for=127.0.0.1;proto=http&quot;</span>
<span class="comment">#  output: TRUE</span>
<span class="comment">#input: &quot;proto=custom&quot;</span>
<span class="comment">#  output: FALSE</span>
</code></pre>
</div><a class="anchor" name="rfc7239_n2nn"></a><a class="anchor" name="7-rfc7239_n2nn"></a><a class="anchor" name="7.3.1-rfc7239_n2nn"></a><a class="anchor" name="rfc7239_n2nn (Using ACLs and fetching samples)"></a><a class="anchor" name="rfc7239_n2nn (Converters)"></a><div class="keyword"><b><a class="anchor" name="rfc7239_n2nn"></a><a href="#7.3.1-rfc7239_n2nn">rfc7239_n2nn</a></b></div><pre class="text">Converts RFC7239 node (provided by 'for' or 'by' 7239 header fields)
into its corresponding nodename final form:
  - ipv4 address
  - ipv6 address
  - 'unknown'
  - '_obfs' identifier
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># extract 'for' field from forwarded header, extract nodename from</span>
<span class="comment"># resulting node identifier and store the result in req.fnn</span>
http-request set-var(req.fnn) req.hdr(forwarded),rfc7239_field(for),rfc7239_n2nn
<span class="comment">#input: &quot;127.0.0.1:9999&quot;</span>
<span class="comment">#  output: 127.0.0.1 (ipv4)</span>
<span class="comment">#input: &quot;[ab:cd:ff:ff:ff:ff:ff:ff]:9998&quot;</span>
<span class="comment">#  output: ab:cd:ff:ff:ff:ff:ff:ff (ipv6)</span>
<span class="comment">#input: &quot;_name:_port&quot;</span>
<span class="comment">#  output: &quot;_name&quot; (string)</span>
</code></pre>
</div><a class="anchor" name="rfc7239_n2np"></a><a class="anchor" name="7-rfc7239_n2np"></a><a class="anchor" name="7.3.1-rfc7239_n2np"></a><a class="anchor" name="rfc7239_n2np (Using ACLs and fetching samples)"></a><a class="anchor" name="rfc7239_n2np (Converters)"></a><div class="keyword"><b><a class="anchor" name="rfc7239_n2np"></a><a href="#7.3.1-rfc7239_n2np">rfc7239_n2np</a></b></div><pre class="text">Converts RFC7239 node (provided by 'for' or 'by' 7239 header fields)
into its corresponding nodeport final form:
  - unsigned integer
  - '_obfs' identifier
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># extract 'by' field from forwarded header, extract node port from</span>
<span class="comment"># resulting node identifier and store the result in req.fnp</span>
http-request set-var(req.fnp) req.hdr(forwarded),rfc7239_field(by),rfc7239_n2np
<span class="comment">#input: &quot;127.0.0.1:9999&quot;</span>
<span class="comment">#  output: 9999 (integer)</span>
<span class="comment">#input: &quot;[ab:cd:ff:ff:ff:ff:ff:ff]:9998&quot;</span>
<span class="comment">#  output: 9998 (integer)</span>
<span class="comment">#input: &quot;_name:_port&quot;</span>
<span class="comment">#  output: &quot;_port&quot; (string)</span>
</code></pre>
</div><a class="anchor" name="rfc7239_nn"></a><a class="anchor" name="7-rfc7239_nn"></a><a class="anchor" name="7.3.1-rfc7239_nn"></a><a class="anchor" name="rfc7239_nn (Using ACLs and fetching samples)"></a><a class="anchor" name="rfc7239_nn (Converters)"></a><div class="keyword"><b><a class="anchor" name="rfc7239_nn"></a><a href="#7.3.1-rfc7239_nn">rfc7239_nn</a></b></div><pre class="text">Converts provided address / string input into RFC7239-compliant node name.
It may be used to manually build 'for' or 'by' 7239 header fields.

When provided input is string, it will be automatically prefixed with '_'
char to represent obfuscated identifier. String must comply with RFC7239
charset. If string is empty, it will be converter to &quot;unknown&quot; identifier.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment">#input: ipv6(ab:cd:ff:ff:ff:ff:ff:ff)</span>
<span class="comment">#  output: &quot;[ab:cd:ff:ff:ff:ff:ff:ff]&quot;</span>
<span class="comment">#input: str(test)</span>
<span class="comment">#  output: &quot;_test&quot;</span>
<span class="comment">#input: str()</span>
<span class="comment">#  output: &quot;unknown&quot;</span>
</code></pre>
</div><div class="page-header"><b>See also:</b> &quot;<a href="#rfc7239_np">rfc7239_np</a>&quot;</div>
<a class="anchor" name="rfc7239_np"></a><a class="anchor" name="7-rfc7239_np"></a><a class="anchor" name="7.3.1-rfc7239_np"></a><a class="anchor" name="rfc7239_np (Using ACLs and fetching samples)"></a><a class="anchor" name="rfc7239_np (Converters)"></a><div class="keyword"><b><a class="anchor" name="rfc7239_np"></a><a href="#7.3.1-rfc7239_np">rfc7239_np</a></b></div><pre class="text">Converts provided unsigned integer / string input into RFC7239-compliant node
port. It may be used to manually build 'for' or 'by' 7239 header fields.

When provided input is string, it will be automatically prefixed with '_'
char to represent obfuscated identifier. String must comply with RFC7239
charset and cannot be empty.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment">#input: int(12)</span>
<span class="comment">#  output: &quot;12&quot;</span>
<span class="comment">#input: str(test)</span>
<span class="comment">#  output: &quot;_test&quot;</span>

<span class="comment"># build 'for' forwarded header field</span>
http-request set-var-fmt(txn.test) &quot;for=\&quot;%[ipv6(::1),rfc7239_nn]:%[int(8080),rfc7239_np]\&quot;;&quot;
<span class="comment">#  output: &quot;for=\&quot;[::1]:8080\&quot;;&quot;</span>

<span class="comment"># build RFC-compliant 7239 header:</span>
http-request set-var-fmt(txn.forwarded) &quot;for=\&quot;%[ipv6(::1),rfc7239_nn]:%[str(8888),rfc7239_np]\&quot;;host=\&quot;haproxy.org\&quot;;proto=http&quot;
<span class="comment"># check RFC-compliancy:</span>
http-request set-var(txn.test) &quot;var(txn.forwarded),debug(test,stderr),rfc7239_is_valid,debug(test,stderr)&quot;
<span class="comment">#  stderr output:</span>
<span class="comment">#    [debug] test: type=str &lt;for=&quot;[::1]:_8888&quot;;host=&quot;haproxy.org&quot;;proto=http&gt;</span>
<span class="comment">#    [debug] test: type=bool &lt;1&gt;</span>
</code></pre>
</div><div class="page-header"><b>See also:</b> &quot;<a href="#rfc7239_nn">rfc7239_nn</a>&quot;</div>
<a class="anchor" name="rtrim"></a><a class="anchor" name="7-rtrim"></a><a class="anchor" name="7.3.1-rtrim"></a><a class="anchor" name="rtrim (Using ACLs and fetching samples)"></a><a class="anchor" name="rtrim (Converters)"></a><div class="keyword"><b><a class="anchor" name="rtrim"></a><a href="#7.3.1-rtrim">rtrim</a></b>(<span style="color: #080">&lt;chars&gt;</span>)</div><pre class="text">Skips any characters from &lt;chars&gt; from the end of the string representation
of the input sample.
</pre><a class="anchor" name="sdbm"></a><a class="anchor" name="7-sdbm"></a><a class="anchor" name="7.3.1-sdbm"></a><a class="anchor" name="sdbm (Using ACLs and fetching samples)"></a><a class="anchor" name="sdbm (Converters)"></a><div class="keyword"><b><a class="anchor" name="sdbm"></a><a href="#7.3.1-sdbm">sdbm</a></b>(<span style="color: #008">[<span style="color: #080">&lt;avalanche&gt;</span>]</span>)</div><pre class="text">Hashes a binary input sample into an unsigned 32-bit quantity using the SDBM
hash function. Optionally, it is possible to apply a full avalanche hash
function to the output if the optional &lt;avalanche&gt; argument equals 1. This
converter uses the same functions as used by the various hash-based load
balancing algorithms, so it will provide exactly the same results. It is
mostly intended for debugging, but can be used as a stick-table entry to
collect rough statistics. It must not be used for security purposes as a
32-bit hash is trivial to break. See also &quot;<a href="#crc32">crc32</a>&quot;, &quot;<a href="#djb2">djb2</a>&quot;, &quot;<a href="#wt6">wt6</a>&quot;, &quot;<a href="#crc32c">crc32c</a>&quot;,
and the &quot;<a href="#hash-type">hash-type</a>&quot; directive.
</pre><a class="anchor" name="secure_memcmp"></a><a class="anchor" name="7-secure_memcmp"></a><a class="anchor" name="7.3.1-secure_memcmp"></a><a class="anchor" name="secure_memcmp (Using ACLs and fetching samples)"></a><a class="anchor" name="secure_memcmp (Converters)"></a><div class="keyword"><b><a class="anchor" name="secure_memcmp"></a><a href="#7.3.1-secure_memcmp">secure_memcmp</a></b>(<span style="color: #080">&lt;var&gt;</span>)</div><pre class="text">Compares the contents of &lt;var&gt; with the input value. Both values are treated
as a binary string. Returns a boolean indicating whether both binary strings
match.

If both binary strings have the same length then the comparison will be
performed in constant time.

Please note that this converter is only available when HAProxy has been
compiled with USE_OPENSSL.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>http-request set-var(txn.token) hdr(token)
<span class="comment"># Check whether the token sent by the client matches the secret token</span>
<span class="comment"># value, without leaking the contents using a timing attack.</span>
acl token_given str(my_secret_token),secure_memcmp(txn.token)
</code></pre>
</div><a class="anchor" name="set-var"></a><a class="anchor" name="7-set-var"></a><a class="anchor" name="7.3.1-set-var"></a><a class="anchor" name="set-var (Using ACLs and fetching samples)"></a><a class="anchor" name="set-var (Converters)"></a><div class="keyword"><b><a class="anchor" name="set-var"></a><a href="#7.3.1-set-var">set-var</a></b>(<span style="color: #080">&lt;var&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;cond&gt;</span>...]</span>)</div><pre class="text">Sets a variable with the input content and returns the content on the output
as-is if all of the specified conditions are true (see below for a list of
possible conditions). The variable keeps the value and the associated input
type. See <a href="#2.8">section 2.8</a> about variables for details.

You can pass at most four conditions to the converter among the following
possible conditions :
 - &quot;ifexists&quot;/&quot;ifnotexists&quot;:
      Checks if the variable already existed before the current set-var call.
      A variable is usually created through a successful set-var call.
      Note that variables of scope &quot;<a href="#proc">proc</a>&quot; are created during configuration
      parsing so the &quot;ifexists&quot; condition will always be true for them.
 - &quot;ifempty&quot;/&quot;ifnotempty&quot;:
      Checks if the input is empty or not.
      Scalar types are never empty so the ifempty condition will be false for
      them regardless of the input's contents (integers, booleans, IPs ...).
 - &quot;ifset&quot;/&quot;ifnotset&quot;:
      Checks if the variable was previously set or not, or if unset-var was
      called on the variable.
      A variable that does not exist yet is considered as not set. A &quot;<a href="#proc">proc</a>&quot;
      variable can exist while not being set since they are created during
      configuration parsing.
 - &quot;ifgt&quot;/&quot;iflt&quot;:
      Checks if the content of the variable is &quot;greater than&quot; or &quot;less than&quot;
      the input. This check can only be performed if both the input and
      the variable are of type integer. Otherwise, the check is considered as
      true by default.
</pre><a class="anchor" name="sha1"></a><a class="anchor" name="7-sha1"></a><a class="anchor" name="7.3.1-sha1"></a><a class="anchor" name="sha1 (Using ACLs and fetching samples)"></a><a class="anchor" name="sha1 (Converters)"></a><div class="keyword"><b><a class="anchor" name="sha1"></a><a href="#7.3.1-sha1">sha1</a></b></div><pre class="text">Converts a binary input sample to a SHA-1 digest. The result is a binary
sample with length of 20 bytes.
</pre><a class="anchor" name="sha2"></a><a class="anchor" name="7-sha2"></a><a class="anchor" name="7.3.1-sha2"></a><a class="anchor" name="sha2 (Using ACLs and fetching samples)"></a><a class="anchor" name="sha2 (Converters)"></a><div class="keyword"><b><a class="anchor" name="sha2"></a><a href="#7.3.1-sha2">sha2</a></b>(<span style="color: #008">[<span style="color: #080">&lt;bits&gt;</span>]</span>)</div><pre class="text">Converts a binary input sample to a digest in the SHA-2 family. The result
is a binary sample with length of &lt;bits&gt;/8 bytes.

Valid values for &lt;bits&gt; are 224, 256, 384, 512, each corresponding to
SHA-&lt;bits&gt;. The default value is 256.

Please note that this converter is only available when HAProxy has been
compiled with USE_OPENSSL.
</pre><a class="anchor" name="srv_queue"></a><a class="anchor" name="7-srv_queue"></a><a class="anchor" name="7.3.1-srv_queue"></a><a class="anchor" name="srv_queue (Using ACLs and fetching samples)"></a><a class="anchor" name="srv_queue (Converters)"></a><div class="keyword"><b><a class="anchor" name="srv_queue"></a><a href="#7.3.1-srv_queue">srv_queue</a></b></div><pre class="text">Takes an input value of type string, either a server name or &lt;backend&gt;/&lt;server&gt;
format and returns the number of queued streams on that server. Can be used
in places where we want to look up queued streams from a dynamic name, like a
cookie value (e.g. req.cook(SRVID),srv_queue) and then make a decision to break
persistence or direct a request elsewhere.
</pre><a class="anchor" name="strcmp"></a><a class="anchor" name="7-strcmp"></a><a class="anchor" name="7.3.1-strcmp"></a><a class="anchor" name="strcmp (Using ACLs and fetching samples)"></a><a class="anchor" name="strcmp (Converters)"></a><div class="keyword"><b><a class="anchor" name="strcmp"></a><a href="#7.3.1-strcmp">strcmp</a></b>(<span style="color: #080">&lt;var&gt;</span>)</div><pre class="text">Compares the contents of &lt;var&gt; with the input value of type string. Returns
the result as a signed integer compatible with strcmp(3): 0 if both strings
are identical. A value less than 0 if the left string is lexicographically
smaller than the right string or if the left string is shorter. A value greater
than 0 otherwise (right string greater than left string or the right string is
shorter).

See also the secure_memcmp converter if you need to compare two binary
strings in constant time.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>http-request set-var(txn.host) hdr(host)
<span class="comment"># Check whether the client is attempting domain fronting.</span>
acl ssl_sni_http_host_match ssl_fc_sni,strcmp(txn.host) eq 0
</code></pre>
</div><a class="anchor" name="sub"></a><a class="anchor" name="7-sub"></a><a class="anchor" name="7.3.1-sub"></a><a class="anchor" name="sub (Using ACLs and fetching samples)"></a><a class="anchor" name="sub (Converters)"></a><div class="keyword"><b><a class="anchor" name="sub"></a><a href="#7.3.1-sub">sub</a></b>(<span style="color: #080">&lt;value&gt;</span>)</div><pre class="text">Subtracts &lt;value&gt; from the input value of type signed integer, and returns
the result as an signed integer. Note: in order to subtract the input from
a constant, simply perform a &quot;neg,add(value)&quot;. &lt;value&gt; can be a numeric value
or a variable name. See <a href="#2.8">section 2.8</a> about variables for details.
</pre><a class="anchor" name="table_bytes_in_rate"></a><a class="anchor" name="7-table_bytes_in_rate"></a><a class="anchor" name="7.3.1-table_bytes_in_rate"></a><a class="anchor" name="table_bytes_in_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="table_bytes_in_rate (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_bytes_in_rate"></a><a href="#7.3.1-table_bytes_in_rate">table_bytes_in_rate</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the average client-to-server
bytes rate associated with the input sample in the designated table, measured
in amount of bytes over the period configured in the table. See also the
sc_bytes_in_rate sample fetch keyword.
</pre><a class="anchor" name="table_bytes_out_rate"></a><a class="anchor" name="7-table_bytes_out_rate"></a><a class="anchor" name="7.3.1-table_bytes_out_rate"></a><a class="anchor" name="table_bytes_out_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="table_bytes_out_rate (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_bytes_out_rate"></a><a href="#7.3.1-table_bytes_out_rate">table_bytes_out_rate</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the average server-to-client
bytes rate associated with the input sample in the designated table, measured
in amount of bytes over the period configured in the table. See also the
sc_bytes_out_rate sample fetch keyword.
</pre><a class="anchor" name="table_conn_cnt"></a><a class="anchor" name="7-table_conn_cnt"></a><a class="anchor" name="7.3.1-table_conn_cnt"></a><a class="anchor" name="table_conn_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="table_conn_cnt (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_conn_cnt"></a><a href="#7.3.1-table_conn_cnt">table_conn_cnt</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the cumulative number of incoming
connections associated with the input sample in the designated table. See
also the sc_conn_cnt sample fetch keyword.
</pre><a class="anchor" name="table_conn_cur"></a><a class="anchor" name="7-table_conn_cur"></a><a class="anchor" name="7.3.1-table_conn_cur"></a><a class="anchor" name="table_conn_cur (Using ACLs and fetching samples)"></a><a class="anchor" name="table_conn_cur (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_conn_cur"></a><a href="#7.3.1-table_conn_cur">table_conn_cur</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the current amount of concurrent
tracked connections associated with the input sample in the designated table.
See also the sc_conn_cur sample fetch keyword.
</pre><a class="anchor" name="table_conn_rate"></a><a class="anchor" name="7-table_conn_rate"></a><a class="anchor" name="7.3.1-table_conn_rate"></a><a class="anchor" name="table_conn_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="table_conn_rate (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_conn_rate"></a><a href="#7.3.1-table_conn_rate">table_conn_rate</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the average incoming connection
rate associated with the input sample in the designated table. See also the
sc_conn_rate sample fetch keyword.
</pre><a class="anchor" name="table_expire"></a><a class="anchor" name="7-table_expire"></a><a class="anchor" name="7.3.1-table_expire"></a><a class="anchor" name="table_expire (Using ACLs and fetching samples)"></a><a class="anchor" name="table_expire (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_expire"></a><a href="#7.3.1-table_expire">table_expire</a></b>(<span style="color: #080">&lt;table&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;default_value&gt;</span>]</span>)</div><pre class="text">Uses the input sample to perform a look up in the specified table. If the key
is not found in the table, the converter fails except if &lt;default_value&gt; is
set: this makes the converter succeed and return &lt;default_value&gt;. If the key
is found the converter returns the key expiration delay associated with the
input sample in the designated table.
See also the table_idle sample fetch keyword.
</pre><a class="anchor" name="table_glitch_cnt"></a><a class="anchor" name="7-table_glitch_cnt"></a><a class="anchor" name="7.3.1-table_glitch_cnt"></a><a class="anchor" name="table_glitch_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="table_glitch_cnt (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_glitch_cnt"></a><a href="#7.3.1-table_glitch_cnt">table_glitch_cnt</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the cumulative number of front
connection glitches associated with the input sample in the designated table.
See also the sc_glitch_cnt sample fetch keyword and fc_glitches for the value
measured on the current front connection.
</pre><a class="anchor" name="table_glitch_rate"></a><a class="anchor" name="7-table_glitch_rate"></a><a class="anchor" name="7.3.1-table_glitch_rate"></a><a class="anchor" name="table_glitch_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="table_glitch_rate (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_glitch_rate"></a><a href="#7.3.1-table_glitch_rate">table_glitch_rate</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the average front connection
glitch rate associated with the input sample in the designated table. See
also the sc_glitch_rate sample fetch keyword.
</pre><a class="anchor" name="table_gpc"></a><a class="anchor" name="7-table_gpc"></a><a class="anchor" name="7.3.1-table_gpc"></a><a class="anchor" name="table_gpc (Using ACLs and fetching samples)"></a><a class="anchor" name="table_gpc (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_gpc"></a><a href="#7.3.1-table_gpc">table_gpc</a></b>(<span style="color: #080">&lt;idx&gt;</span>,<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a lookup in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the current value of the
General Purpose Counter at the index &lt;idx&gt; of the array associated
to the input sample in the designated &lt;table&gt;. &lt;idx&gt; is an integer
between 0 and 99.
If there is no GPC stored at this index, it also returns the boolean value 0.
This applies only to the 'gpc' array data_type (and not to the legacy
'gpc0' nor 'gpc1' data_types).
See also the sc_get_gpc sample fetch keyword.
</pre><a class="anchor" name="table_gpc0"></a><a class="anchor" name="7-table_gpc0"></a><a class="anchor" name="7.3.1-table_gpc0"></a><a class="anchor" name="table_gpc0 (Using ACLs and fetching samples)"></a><a class="anchor" name="table_gpc0 (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_gpc0"></a><a href="#7.3.1-table_gpc0">table_gpc0</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the current value of the first
general purpose counter associated with the input sample in the designated
table. See also the sc_get_gpc0 sample fetch keyword.
</pre><a class="anchor" name="table_gpc0_rate"></a><a class="anchor" name="7-table_gpc0_rate"></a><a class="anchor" name="7.3.1-table_gpc0_rate"></a><a class="anchor" name="table_gpc0_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="table_gpc0_rate (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_gpc0_rate"></a><a href="#7.3.1-table_gpc0_rate">table_gpc0_rate</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the frequency which the gpc0
counter was incremented over the configured period in the table, associated
with the input sample in the designated table. See also the sc_get_gpc0_rate
sample fetch keyword.
</pre><a class="anchor" name="table_gpc1"></a><a class="anchor" name="7-table_gpc1"></a><a class="anchor" name="7.3.1-table_gpc1"></a><a class="anchor" name="table_gpc1 (Using ACLs and fetching samples)"></a><a class="anchor" name="table_gpc1 (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_gpc1"></a><a href="#7.3.1-table_gpc1">table_gpc1</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the current value of the second
general purpose counter associated with the input sample in the designated
table. See also the sc_get_gpc1 sample fetch keyword.
</pre><a class="anchor" name="table_gpc1_rate"></a><a class="anchor" name="7-table_gpc1_rate"></a><a class="anchor" name="7.3.1-table_gpc1_rate"></a><a class="anchor" name="table_gpc1_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="table_gpc1_rate (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_gpc1_rate"></a><a href="#7.3.1-table_gpc1_rate">table_gpc1_rate</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the frequency which the gpc1
counter was incremented over the configured period in the table, associated
with the input sample in the designated table. See also the sc_get_gpc1_rate
sample fetch keyword.
</pre><a class="anchor" name="table_gpc_rate"></a><a class="anchor" name="7-table_gpc_rate"></a><a class="anchor" name="7.3.1-table_gpc_rate"></a><a class="anchor" name="table_gpc_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="table_gpc_rate (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_gpc_rate"></a><a href="#7.3.1-table_gpc_rate">table_gpc_rate</a></b>(<span style="color: #080">&lt;idx&gt;</span>,<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a lookup in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the frequency which the Global
Purpose Counter at index &lt;idx&gt; of the array (associated to the input sample
in the designated stick-table &lt;table&gt;) was incremented over the
configured period. &lt;idx&gt; is an integer between 0 and 99.
If there is no gpc_rate stored at this index, it also returns the boolean
value 0.
This applies only to the 'gpc_rate' array data_type (and not to the
legacy 'gpc0_rate' nor 'gpc1_rate' data_types).
See also the sc_gpc_rate sample fetch keyword.
</pre><a class="anchor" name="table_gpt"></a><a class="anchor" name="7-table_gpt"></a><a class="anchor" name="7.3.1-table_gpt"></a><a class="anchor" name="table_gpt (Using ACLs and fetching samples)"></a><a class="anchor" name="table_gpt (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_gpt"></a><a href="#7.3.1-table_gpt">table_gpt</a></b>(<span style="color: #080">&lt;idx&gt;</span>,<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a lookup in
the specified table. If the key is not found in the table, boolean value zero
is returned. Otherwise the converter returns the current value of the general
purpose tag at the index &lt;idx&gt; of the array associated to the input sample
in the designated &lt;table&gt;. &lt;idx&gt; is an integer between 0 and 99.
If there is no GPT stored at this index, it also returns the boolean value 0.
This applies only to the 'gpt' array data_type (and not on the legacy 'gpt0'
data-type).
See also the sc_get_gpt sample fetch keyword.
</pre><a class="anchor" name="table_gpt0"></a><a class="anchor" name="7-table_gpt0"></a><a class="anchor" name="7.3.1-table_gpt0"></a><a class="anchor" name="table_gpt0 (Using ACLs and fetching samples)"></a><a class="anchor" name="table_gpt0 (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_gpt0"></a><a href="#7.3.1-table_gpt0">table_gpt0</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, boolean value zero
is returned. Otherwise the converter returns the current value of the first
general purpose tag associated with the input sample in the designated table.
See also the sc_get_gpt0 sample fetch keyword.
</pre><a class="anchor" name="table_http_err_cnt"></a><a class="anchor" name="7-table_http_err_cnt"></a><a class="anchor" name="7.3.1-table_http_err_cnt"></a><a class="anchor" name="table_http_err_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="table_http_err_cnt (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_http_err_cnt"></a><a href="#7.3.1-table_http_err_cnt">table_http_err_cnt</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the cumulative number of HTTP
errors associated with the input sample in the designated table. See also the
sc_http_err_cnt sample fetch keyword.
</pre><a class="anchor" name="table_http_err_rate"></a><a class="anchor" name="7-table_http_err_rate"></a><a class="anchor" name="7.3.1-table_http_err_rate"></a><a class="anchor" name="table_http_err_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="table_http_err_rate (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_http_err_rate"></a><a href="#7.3.1-table_http_err_rate">table_http_err_rate</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the average rate of HTTP errors associated with the
input sample in the designated table, measured in amount of errors over the
period configured in the table. See also the sc_http_err_rate sample fetch
keyword.
</pre><a class="anchor" name="table_http_fail_cnt"></a><a class="anchor" name="7-table_http_fail_cnt"></a><a class="anchor" name="7.3.1-table_http_fail_cnt"></a><a class="anchor" name="table_http_fail_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="table_http_fail_cnt (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_http_fail_cnt"></a><a href="#7.3.1-table_http_fail_cnt">table_http_fail_cnt</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the cumulative number of HTTP
failures associated with the input sample in the designated table. See also
the sc_http_fail_cnt sample fetch keyword.
</pre><a class="anchor" name="table_http_fail_rate"></a><a class="anchor" name="7-table_http_fail_rate"></a><a class="anchor" name="7.3.1-table_http_fail_rate"></a><a class="anchor" name="table_http_fail_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="table_http_fail_rate (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_http_fail_rate"></a><a href="#7.3.1-table_http_fail_rate">table_http_fail_rate</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the average rate of HTTP failures associated with the
input sample in the designated table, measured in amount of failures over the
period configured in the table. See also the sc_http_fail_rate sample fetch
keyword.
</pre><a class="anchor" name="table_http_req_cnt"></a><a class="anchor" name="7-table_http_req_cnt"></a><a class="anchor" name="7.3.1-table_http_req_cnt"></a><a class="anchor" name="table_http_req_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="table_http_req_cnt (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_http_req_cnt"></a><a href="#7.3.1-table_http_req_cnt">table_http_req_cnt</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the cumulative number of HTTP
requests associated with the input sample in the designated table. See also
the sc_http_req_cnt sample fetch keyword.
</pre><a class="anchor" name="table_http_req_rate"></a><a class="anchor" name="7-table_http_req_rate"></a><a class="anchor" name="7.3.1-table_http_req_rate"></a><a class="anchor" name="table_http_req_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="table_http_req_rate (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_http_req_rate"></a><a href="#7.3.1-table_http_req_rate">table_http_req_rate</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the average rate of HTTP requests associated with the
input sample in the designated table, measured in amount of requests over the
period configured in the table. See also the sc_http_req_rate sample fetch
keyword.
</pre><a class="anchor" name="table_idle"></a><a class="anchor" name="7-table_idle"></a><a class="anchor" name="7.3.1-table_idle"></a><a class="anchor" name="table_idle (Using ACLs and fetching samples)"></a><a class="anchor" name="table_idle (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_idle"></a><a href="#7.3.1-table_idle">table_idle</a></b>(<span style="color: #080">&lt;table&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;default_value&gt;</span>]</span>)</div><pre class="text">Uses the input sample to perform a look up in the specified table. If the key
is not found in the table, the converter fails except if &lt;default_value&gt; is
set: this makes the converter succeed and return &lt;default_value&gt;. If the key
is found the converter returns the time the key entry associated with the
input sample in the designated table remained idle since the last time it was
updated.
See also the table_expire sample fetch keyword.
</pre><a class="anchor" name="table_kbytes_in"></a><a class="anchor" name="7-table_kbytes_in"></a><a class="anchor" name="7.3.1-table_kbytes_in"></a><a class="anchor" name="table_kbytes_in (Using ACLs and fetching samples)"></a><a class="anchor" name="table_kbytes_in (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_kbytes_in"></a><a href="#7.3.1-table_kbytes_in">table_kbytes_in</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the cumulative number of client-
to-server data associated with the input sample in the designated table,
measured in kilobytes. The test is currently performed on 32-bit integers,
which limits values to 4 terabytes. See also the sc_kbytes_in sample fetch
keyword.
</pre><a class="anchor" name="table_kbytes_out"></a><a class="anchor" name="7-table_kbytes_out"></a><a class="anchor" name="7.3.1-table_kbytes_out"></a><a class="anchor" name="table_kbytes_out (Using ACLs and fetching samples)"></a><a class="anchor" name="table_kbytes_out (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_kbytes_out"></a><a href="#7.3.1-table_kbytes_out">table_kbytes_out</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the cumulative number of server-
to-client data associated with the input sample in the designated table,
measured in kilobytes. The test is currently performed on 32-bit integers,
which limits values to 4 terabytes. See also the sc_kbytes_out sample fetch
keyword.
</pre><a class="anchor" name="table_server_id"></a><a class="anchor" name="7-table_server_id"></a><a class="anchor" name="7.3.1-table_server_id"></a><a class="anchor" name="table_server_id (Using ACLs and fetching samples)"></a><a class="anchor" name="table_server_id (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_server_id"></a><a href="#7.3.1-table_server_id">table_server_id</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the server ID associated with
the input sample in the designated table. A server ID is associated to a
sample by a &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">stick<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#stick%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#stick%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; rule when a connection to a server succeeds. A server ID
zero means that no server is associated with this key.
</pre><a class="anchor" name="table_sess_cnt"></a><a class="anchor" name="7-table_sess_cnt"></a><a class="anchor" name="7.3.1-table_sess_cnt"></a><a class="anchor" name="table_sess_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="table_sess_cnt (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_sess_cnt"></a><a href="#7.3.1-table_sess_cnt">table_sess_cnt</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the cumulative number of incoming
sessions associated with the input sample in the designated table. Note that
a session here refers to an incoming connection being accepted by the
&quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; rulesets. See also the sc_sess_cnt sample fetch
keyword.
</pre><a class="anchor" name="table_sess_rate"></a><a class="anchor" name="7-table_sess_rate"></a><a class="anchor" name="7.3.1-table_sess_rate"></a><a class="anchor" name="table_sess_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="table_sess_rate (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_sess_rate"></a><a href="#7.3.1-table_sess_rate">table_sess_rate</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the average incoming session
rate associated with the input sample in the designated table. Note that a
session here refers to an incoming connection being accepted by the
&quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; rulesets. See also the sc_sess_rate sample fetch
keyword.
</pre><a class="anchor" name="table_trackers"></a><a class="anchor" name="7-table_trackers"></a><a class="anchor" name="7.3.1-table_trackers"></a><a class="anchor" name="table_trackers (Using ACLs and fetching samples)"></a><a class="anchor" name="table_trackers (Converters)"></a><div class="keyword"><b><a class="anchor" name="table_trackers"></a><a href="#7.3.1-table_trackers">table_trackers</a></b>(<span style="color: #080">&lt;table&gt;</span>)</div><pre class="text">Uses the string representation of the input sample to perform a look up in
the specified table. If the key is not found in the table, integer value zero
is returned. Otherwise the converter returns the current amount of concurrent
connections tracking the same key as the input sample in the designated
table. It differs from table_conn_cur in that it does not rely on any stored
information but on the table's reference count (the &quot;use&quot; value which is
returned by &quot;show table&quot; on the CLI). This may sometimes be more suited for
layer7 tracking. It can be used to tell a server how many concurrent
connections there are from a given address for example. See also the
sc_trackers sample fetch keyword.
</pre><a class="anchor" name="ub64dec"></a><a class="anchor" name="7-ub64dec"></a><a class="anchor" name="7.3.1-ub64dec"></a><a class="anchor" name="ub64dec (Using ACLs and fetching samples)"></a><a class="anchor" name="ub64dec (Converters)"></a><div class="keyword"><b><a class="anchor" name="ub64dec"></a><a href="#7.3.1-ub64dec">ub64dec</a></b></div><pre class="text">This converter is the base64url variant of b64dec converter. base64url
encoding is the &quot;URL and Filename Safe Alphabet&quot; variant of base64 encoding.
It is also the encoding used in JWT (JSON Web Token) standard.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># Decoding a JWT payload:</span>
http-request set-var(txn.token_payload) req.hdr(Authorization),word(2,.),ub64dec
</code></pre>
</div><a class="anchor" name="ub64enc"></a><a class="anchor" name="7-ub64enc"></a><a class="anchor" name="7.3.1-ub64enc"></a><a class="anchor" name="ub64enc (Using ACLs and fetching samples)"></a><a class="anchor" name="ub64enc (Converters)"></a><div class="keyword"><b><a class="anchor" name="ub64enc"></a><a href="#7.3.1-ub64enc">ub64enc</a></b></div><pre class="text">This converter is the base64url variant of base64 converter.
</pre><a class="anchor" name="ungrpc"></a><a class="anchor" name="7-ungrpc"></a><a class="anchor" name="7.3.1-ungrpc"></a><a class="anchor" name="ungrpc (Using ACLs and fetching samples)"></a><a class="anchor" name="ungrpc (Converters)"></a><div class="keyword"><b><a class="anchor" name="ungrpc"></a><a href="#7.3.1-ungrpc">ungrpc</a></b>(<span style="color: #080">&lt;field_number&gt;</span>,<span style="color: #008">[<span style="color: #080">&lt;field_type&gt;</span>]</span>)</div><pre class="text">This extracts the protocol buffers message field in raw mode of an input binary
sample representation of a gRPC message with &lt;field_number&gt; as field number
(dotted notation) if &lt;field_type&gt; is not present, or as an integer sample if this
field is present.
The list of the authorized types is the following one: &quot;int32&quot;, &quot;int64&quot;, &quot;uint32&quot;,
&quot;uint64&quot;, &quot;sint32&quot;, &quot;sint64&quot;, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bool<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bool%20%28Converters%29">Converters</a></li><li><a href="#bool%20%28Fetching%20samples%20from%20internal%20states%29">Fetching samples from internal states</a></li></ul></span>&quot;, &quot;enum&quot; for the &quot;varint&quot; wire type 0
&quot;fixed64&quot;, &quot;sfixed64&quot;, &quot;double&quot; for the 64bit wire type 1, &quot;fixed32&quot;, &quot;sfixed32&quot;,
&quot;float&quot; for the wire type 5. Note that &quot;string&quot; is considered as a length-delimited
type, so it does not require any &lt;field_type&gt; argument to be extracted.
More information may be found here about the protocol buffers message field types:
https://developers.google.com/protocol-buffers/docs/encoding
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>// with such a protocol buffer .proto file content adapted from
// https://github.com/grpc/grpc/blob/master/examples/protos/route_guide.proto

message Point {
  int32 latitude = 1;
  int32 longitude = 2;
}

message PPoint {
  Point point = 59;
}

message Rectangle {
  // One corner of the rectangle.
  PPoint lo = 48;
  // The other corner of the rectangle.
  PPoint hi = 49;
}
</code></pre>
</div><pre class="text">let's say a body request is made of a &quot;Rectangle&quot; object value (two PPoint
protocol buffers messages), the four protocol buffers fields could be
extracted with these &quot;<a href="#ungrpc">ungrpc</a>&quot; directives:

  req.body,ungrpc(48.59.1,int32) # &quot;latitude&quot; of &quot;lo&quot; first PPoint
  req.body,ungrpc(48.59.2,int32) # &quot;longitude&quot; of &quot;lo&quot; first PPoint
  req.body,ungrpc(49.59.1,int32) # &quot;latitude&quot; of &quot;hi&quot; second PPoint
  req.body,ungrpc(49.59.2,int32) # &quot;longitude&quot; of &quot;hi&quot; second PPoint

We could also extract the intermediary 48.59 field as a binary sample as follows:

  req.body,ungrpc(48.59)

As a gRPC message is always made of a gRPC header followed by protocol buffers
messages, in the previous example the &quot;latitude&quot; of &quot;lo&quot; first PPoint
could be extracted with these equivalent directives:

  req.body,ungrpc(48.59),protobuf(1,int32)
  req.body,ungrpc(48),protobuf(59.1,int32)
  req.body,ungrpc(48),protobuf(59),protobuf(1,int32)

Note that the first convert must be &quot;<a href="#ungrpc">ungrpc</a>&quot;, the remaining ones must be
&quot;<a href="#protobuf">protobuf</a>&quot; and only the last one may have or not a second argument to
interpret the previous binary sample.
</pre><a class="anchor" name="unset-var"></a><a class="anchor" name="7-unset-var"></a><a class="anchor" name="7.3.1-unset-var"></a><a class="anchor" name="unset-var (Using ACLs and fetching samples)"></a><a class="anchor" name="unset-var (Converters)"></a><div class="keyword"><b><a class="anchor" name="unset-var"></a><a href="#7.3.1-unset-var">unset-var</a></b>(<span style="color: #080">&lt;var&gt;</span>)</div><pre class="text">Unsets a variable if the input content is defined. The name of the variable
starts with an indication about its scope. See <a href="#2.8">section 2.8</a> about variables
for details.
</pre><a class="anchor" name="upper"></a><a class="anchor" name="7-upper"></a><a class="anchor" name="7.3.1-upper"></a><a class="anchor" name="upper (Using ACLs and fetching samples)"></a><a class="anchor" name="upper (Converters)"></a><div class="keyword"><b><a class="anchor" name="upper"></a><a href="#7.3.1-upper">upper</a></b></div><pre class="text">Convert a string sample to upper case. This can only be placed after a string
sample fetch function or after a transformation keyword returning a string
type. The result is of type string.
</pre><a class="anchor" name="url_dec"></a><a class="anchor" name="7-url_dec"></a><a class="anchor" name="7.3.1-url_dec"></a><a class="anchor" name="url_dec (Using ACLs and fetching samples)"></a><a class="anchor" name="url_dec (Converters)"></a><div class="keyword"><b><a class="anchor" name="url_dec"></a><a href="#7.3.1-url_dec">url_dec</a></b>(<span style="color: #008">[<span style="color: #080">&lt;in_form&gt;</span>]</span>)</div><pre class="text">Takes an url-encoded string provided as input and returns the decoded version
as output. The input and the output are of type string. If the &lt;in_form&gt;
argument is set to a non-zero integer value, the input string is assumed to
be part of a form or query string and the '+' character will be turned into a
space (' '). Otherwise this will only happen after a question mark indicating
a query string ('?').
</pre><a class="anchor" name="url_enc"></a><a class="anchor" name="7-url_enc"></a><a class="anchor" name="7.3.1-url_enc"></a><a class="anchor" name="url_enc (Using ACLs and fetching samples)"></a><a class="anchor" name="url_enc (Converters)"></a><div class="keyword"><b><a class="anchor" name="url_enc"></a><a href="#7.3.1-url_enc">url_enc</a></b>(<span style="color: #008">[<span style="color: #080">&lt;enc_type&gt;</span>]</span>)</div><pre class="text">Takes a string provided as input and returns the encoded version as output.
The input and the output are of type string. By default the type of encoding
is meant for `query` type. There is no other type supported for now but the
optional argument is here for future changes.
</pre><a class="anchor" name="us_ltime"></a><a class="anchor" name="7-us_ltime"></a><a class="anchor" name="7.3.1-us_ltime"></a><a class="anchor" name="us_ltime (Using ACLs and fetching samples)"></a><a class="anchor" name="us_ltime (Converters)"></a><div class="keyword"><b><a class="anchor" name="us_ltime"></a><a href="#7.3.1-us_ltime">us_ltime</a></b>(<span style="color: #080">&lt;format&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;offset&gt;</span>]</span>)</div><pre class="text">This works like &quot;<a href="#ltime">ltime</a>&quot; but takes an input in microseconds. It also supports
the %N conversion specifier inspired by date(1).
Converts an integer supposed to contain a date since epoch to a string
representing this date in local time using a format defined by the &lt;format&gt;
string using strftime(3). The purpose is to allow any date format to be used
in logs. An optional &lt;offset&gt; in microseconds may be applied to the input
date (positive or negative). See the strftime() man page for the format
supported by your operating system.

The %N conversion specifier allows you to output the nanoseconds part of the
date, precision is limited since the input is microseconds.
(000000000..999999000). %N can take a width argument between % and N. It is
useful to display milliseconds (%3N) or microseconds (%6N). The default and
maximum width is 9 (%N = %9N).

See also the &quot;<a href="#utime">utime</a>&quot; converter for UTC as well as &quot;<a href="#ltime">ltime</a>&quot; and &quot;<a href="#ms_ltime">ms_ltime</a>&quot;
converters.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># Emit 3 colons, the local time, the timezone and another with ip:port</span>
<span class="comment"># e.g. 2023/07/24/09:53:02.196234 +0000 127.0.0.1:41530</span>
log-format %[accept_date(us),us_ltime(&quot;%Y/%m/%d/%H:%M:%S.%6N %z&quot;)]\ %ci:%cp
</code></pre>
</div><a class="anchor" name="us_utime"></a><a class="anchor" name="7-us_utime"></a><a class="anchor" name="7.3.1-us_utime"></a><a class="anchor" name="us_utime (Using ACLs and fetching samples)"></a><a class="anchor" name="us_utime (Converters)"></a><div class="keyword"><b><a class="anchor" name="us_utime"></a><a href="#7.3.1-us_utime">us_utime</a></b>(<span style="color: #080">&lt;format&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;offset&gt;</span>]</span>)</div><pre class="text">This works like &quot;<a href="#utime">utime</a>&quot; but takes an input in microseconds. It also supports
the %N conversion specifier inspired by date(1).
Converts an integer supposed to contain a date since epoch to a string
representing this date in UTC time using a format defined by the &lt;format&gt;
string using strftime(3). The purpose is to allow any date format to be used
in logs. An optional &lt;offset&gt; in microseconds may be applied to the input
date (positive or negative). See the strftime() man page for the format
supported by your operating system.

The %N conversion specifier allows you to output the nanoseconds part of the
date, precision is limited since the input is microseconds.
(000000000..999999000). %N can take a width argument between % and N. It is
useful to display milliseconds (%3N) or microseconds (%6N). The default and
maximum width is 9 (%N = %9N).

See also the &quot;<a href="#ltime">ltime</a>&quot; converter for local as well as &quot;<a href="#utime">utime</a>&quot; and &quot;<a href="#ms_utime">ms_utime</a>&quot;
converters.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># Emit 3 colons, the UTC time, the timezone and another with ip:port</span>
<span class="comment"># e.g. 2023/07/24/09:53:02.196234 +0000 127.0.0.1:41530</span>
log-format %[accept_date(us),us_utime(&quot;%Y/%m/%d/%H:%M:%S.%6N %z&quot;)]\ %ci:%cp
</code></pre>
</div><a class="anchor" name="utime"></a><a class="anchor" name="7-utime"></a><a class="anchor" name="7.3.1-utime"></a><a class="anchor" name="utime (Using ACLs and fetching samples)"></a><a class="anchor" name="utime (Converters)"></a><div class="keyword"><b><a class="anchor" name="utime"></a><a href="#7.3.1-utime">utime</a></b>(<span style="color: #080">&lt;format&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;offset&gt;</span>]</span>)</div><pre class="text">Converts an integer supposed to contain a date since epoch to a string
representing this date in UTC time using a format defined by the &lt;format&gt;
string using strftime(3). The purpose is to allow any date format to be used
in logs. An optional &lt;offset&gt; in seconds may be applied to the input date
(positive or negative). See the strftime() man page for the format supported
by your operating system. See also the &quot;<a href="#ltime">ltime</a>&quot; converter as well as &quot;<a href="#ms_utime">ms_utime</a>&quot;
and &quot;<a href="#us_utime">us_utime</a>&quot;.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># Emit two colons, one with the UTC time and another with ip:port</span>
<span class="comment"># e.g.  20140710162350 127.0.0.1:57325</span>
log-format %[date,utime(%Y%m%d%H%M%S)]\ %ci:%cp
</code></pre>
</div><a class="anchor" name="when"></a><a class="anchor" name="7-when"></a><a class="anchor" name="7.3.1-when"></a><a class="anchor" name="when (Using ACLs and fetching samples)"></a><a class="anchor" name="when (Converters)"></a><div class="keyword"><b><a class="anchor" name="when"></a><a href="#7.3.1-when">when</a></b>(<span style="color: #080">&lt;condition&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;args&gt;</span>...]</span>)</div><pre class="text">Evaluates the condition and when true, passes the input sample as-is to the
output, otherwise return nothing. This is designed specifically to produce
some rarely needed data that should only be emitted under certain conditions,
such as debugging information when an error is met.

The condition is made of a keyword among the list below, optionally preceeded
by an exclamation mark ('!') to negate it, and optionally suffixed by some
arguments specific to that condition:

  - &quot;error&quot; returns true when an error was encountered during the processing
    of the request or stream. It uses the same rules as &quot;<a href="#option%20dontlog-normal">dontlog-normal</a>&quot;
    (e.g. a successful redispatch counts as an error).

  - &quot;<a href="#option%20forwarded">forwarded</a>&quot; returns true when the request was forwarded to a backend
    server

  - &quot;normal&quot; returns true when no error happened (this is equivalent to
    &quot;!error&quot;).

  - &quot;processed&quot; returns true when the request was either forwarded to a
    backend server, or processed by an applet.

  - &quot;<a href="#stopping">stopping</a>&quot; returns true if the process is currently stopping when the
    rule is evaluated

  - &quot;toapplet&quot; returns true when the request was processed by an applet.

  - &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">acl<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#acl%20%28Fcgi-app%20section%29">Fcgi-app section</a></li><li><a href="#acl%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#acl%20%28Fetching%20samples%20from%20internal%20states%29">Fetching samples from internal states</a></li></ul></span>&quot; returns true when the ACL designated by the next argument evaluates
    to true. Note that the ACL is evaluated inline by the converter, so that
    what it refers to must be valid in that context. A particular use case
    consists in evaluating if the total transfer time is too long or not
    before deciding to log detauls from abnormally long transfers.

Note that the content is evaluated in any case, so doing this does not avoid
the generation of that information. It's only meant to avoid producing that
information.

An example would be to add backend stream debugging information in the logs
only when an error was encountered during processing, or logging extra
information when stopping, etc.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># log &quot;dbg={-}&quot; when fine, or &quot;dbg={... debug info ...}&quot; on error:</span>
log-format &quot;$HAPROXY_HTTP_LOG_FMT dbg={%[bs.debug_str,when(!normal)]}&quot;

Here, the &quot;dbg&quot; field in the log will only contain an dash ('-') to
indicate a missing content when the rule is not validated, and will emit a
whole debugging block when it is.
</code></pre>
</div><pre class="text">Example
  # log &quot;dbg={-}&quot; when fine, or &quot;dbg={... debug info ...}&quot; on slow transfers
  acl slow_xfer res.timer.data ge 10000   # more than 10s is slow
  log-format &quot;$HAPROXY_HTTP_LOG_FMT                                         \
              fsdbg={%[fs.debug_str,when(acl,slow_xfer)]}                   \
              bsdbg={%[bs.debug_str,when(acl,slow_xfer)]}&quot;

Example
  # only emit the backend src/port when a real connection was issued:
  log-format &quot;$HAPROXY_HTTP_LOG_FMT \
             src=[%[bc_src,when(forwarded)]:%[bc_src_port,when(forwarded)]]&quot;

Since it kills the evaluation of the expression when it is not true, it is
also possible to use it to stop a subsequent converter from being called.
This may for example be used to call the debug() converter only upon error,
to log an element only when absolutely necessary.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># emit the whole response headers list to stderr only on error and only</span>
<span class="comment"># when the output is a connection. We abuse a dummy variable here.</span>
http-after-response set-var(res.test) \
              res.hdrs,when(error),when(forwarded),debug(hdrs,stderr)
</code></pre>
</div><div class="page-header"><b>See also:</b> debug converter</div>
<a class="anchor" name="word"></a><a class="anchor" name="7-word"></a><a class="anchor" name="7.3.1-word"></a><a class="anchor" name="word (Using ACLs and fetching samples)"></a><a class="anchor" name="word (Converters)"></a><div class="keyword"><b><a class="anchor" name="word"></a><a href="#7.3.1-word">word</a></b>(<span style="color: #080">&lt;index&gt;</span>,<span style="color: #080">&lt;delimiters&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;count&gt;</span>]</span>)</div><pre class="text">Extracts the nth word counting from the beginning (positive index) or from
the end (negative index) considering given delimiters from an input string.
Indexes start at 1 or -1 and delimiters are a string formatted list of chars.
Empty words are skipped. This means that delimiters at the start or end of
the input string are ignored and consecutive delimiters within the input
string are considered to be a single delimiter.
Optionally you can specify &lt;count&gt; of words to extract (default: 1).
Value of 0 indicates extraction of all remaining words.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>str(f1_f2_f3__f5),word(4,_)    <span class="comment"># f5</span>
str(f1_f2_f3__f5),word(5,_)    <span class="comment"># &lt;not found&gt;</span>
str(f1_f2_f3__f5),word(2,_,0)  <span class="comment"># f2_f3__f5</span>
str(f1_f2_f3__f5),word(3,_,2)  <span class="comment"># f3__f5</span>
str(f1_f2_f3__f5),word(-2,_,3) <span class="comment"># f1_f2_f3</span>
str(f1_f2_f3__f5),word(-3,_,0) <span class="comment"># f1_f2</span>
str(/f1/f2/f3/f4),word(1,/)    <span class="comment"># f1</span>
str(/f1////f2/f3/f4),word(1,/) <span class="comment"># f2</span>
</code></pre>
</div><a class="anchor" name="wt6"></a><a class="anchor" name="7-wt6"></a><a class="anchor" name="7.3.1-wt6"></a><a class="anchor" name="wt6 (Using ACLs and fetching samples)"></a><a class="anchor" name="wt6 (Converters)"></a><div class="keyword"><b><a class="anchor" name="wt6"></a><a href="#7.3.1-wt6">wt6</a></b>(<span style="color: #008">[<span style="color: #080">&lt;avalanche&gt;</span>]</span>)</div><pre class="text">Hashes a binary input sample into an unsigned 32-bit quantity using the WT6
hash function. Optionally, it is possible to apply a full avalanche hash
function to the output if the optional &lt;avalanche&gt; argument equals 1. This
converter uses the same functions as used by the various hash-based load
balancing algorithms, so it will provide exactly the same results. It is
mostly intended for debugging, but can be used as a stick-table entry to
collect rough statistics. It must not be used for security purposes as a
32-bit hash is trivial to break. See also &quot;<a href="#crc32">crc32</a>&quot;, &quot;<a href="#djb2">djb2</a>&quot;, &quot;<a href="#sdbm">sdbm</a>&quot;, &quot;<a href="#crc32c">crc32c</a>&quot;,
and the &quot;<a href="#hash-type">hash-type</a>&quot; directive.
</pre><a class="anchor" name="x509_v_err_str"></a><a class="anchor" name="7-x509_v_err_str"></a><a class="anchor" name="7.3.1-x509_v_err_str"></a><a class="anchor" name="x509_v_err_str (Using ACLs and fetching samples)"></a><a class="anchor" name="x509_v_err_str (Converters)"></a><div class="keyword"><b><a class="anchor" name="x509_v_err_str"></a><a href="#7.3.1-x509_v_err_str">x509_v_err_str</a></b></div><pre class="text">Convert a numerical value to its corresponding X509_V_ERR constant name. It
is useful in ACL in order to have a configuration which works with multiple
version of OpenSSL since some codes might change when changing version.

When the corresponding constant name was not found, outputs the numerical
value as a string.

The list of constant provided by OpenSSL can be found at
https://www.openssl.org/docs/manmaster/man3/X509_STORE_CTX_get_error.html#ERROR-CODES
Be careful to read the page for the right version of OpenSSL.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>bind :443 ssl crt common.pem ca-file ca-auth.crt verify optional crt-ignore-err X509_V_ERR_CERT_REVOKED,X509_V_ERR_CERT_HAS_EXPIRED

acl cert_expired ssl_c_verify,x509_v_err_str -m str X509_V_ERR_CERT_HAS_EXPIRED
acl cert_revoked ssl_c_verify,x509_v_err_str -m str X509_V_ERR_CERT_REVOKED
acl cert_ok      ssl_c_verify,x509_v_err_str -m str X509_V_OK

http-response add-header X-SSL Ok if cert_ok
http-response add-header X-SSL Expired if cert_expired
http-response add-header X-SSL Revoked if cert_revoked

http-response add-header X-SSL-verify %[ssl_c_verify,x509_v_err_str]
</code></pre>
</div><a class="anchor" name="xor"></a><a class="anchor" name="7-xor"></a><a class="anchor" name="7.3.1-xor"></a><a class="anchor" name="xor (Using ACLs and fetching samples)"></a><a class="anchor" name="xor (Converters)"></a><div class="keyword"><b><a class="anchor" name="xor"></a><a href="#7.3.1-xor">xor</a></b>(<span style="color: #080">&lt;value&gt;</span>)</div><pre class="text">Performs a bitwise &quot;XOR&quot; (exclusive OR) between &lt;value&gt; and the input value
of type signed integer, and returns the result as an signed integer.
&lt;value&gt; can be a numeric value or a variable name. See <a href="#2.8">section 2.8</a> about
variables for details.
</pre><a class="anchor" name="xxh3"></a><a class="anchor" name="7-xxh3"></a><a class="anchor" name="7.3.1-xxh3"></a><a class="anchor" name="xxh3 (Using ACLs and fetching samples)"></a><a class="anchor" name="xxh3 (Converters)"></a><div class="keyword"><b><a class="anchor" name="xxh3"></a><a href="#7.3.1-xxh3">xxh3</a></b>(<span style="color: #008">[<span style="color: #080">&lt;seed&gt;</span>]</span>)</div><pre class="text">Hashes a binary input sample into a signed 64-bit quantity using the XXH3
64-bit variant of the XXhash hash function. This hash supports a seed which
defaults to zero but a different value maybe passed as the &lt;seed&gt; argument.
This hash is known to be very good and very fast so it can be used to hash
URLs and/or URL parameters for use as stick-table keys to collect statistics
with a low collision rate, though care must be taken as the algorithm is not
considered as cryptographically secure.
</pre><a class="anchor" name="xxh32"></a><a class="anchor" name="7-xxh32"></a><a class="anchor" name="7.3.1-xxh32"></a><a class="anchor" name="xxh32 (Using ACLs and fetching samples)"></a><a class="anchor" name="xxh32 (Converters)"></a><div class="keyword"><b><a class="anchor" name="xxh32"></a><a href="#7.3.1-xxh32">xxh32</a></b>(<span style="color: #008">[<span style="color: #080">&lt;seed&gt;</span>]</span>)</div><pre class="text">Hashes a binary input sample into an unsigned 32-bit quantity using the 32-bit
variant of the XXHash hash function. This hash supports a seed which defaults
to zero but a different value maybe passed as the &lt;seed&gt; argument. This hash
is known to be very good and very fast so it can be used to hash URLs and/or
URL parameters for use as stick-table keys to collect statistics with a low
collision rate, though care must be taken as the algorithm is not considered
as cryptographically secure.
</pre><a class="anchor" name="xxh64"></a><a class="anchor" name="7-xxh64"></a><a class="anchor" name="7.3.1-xxh64"></a><a class="anchor" name="xxh64 (Using ACLs and fetching samples)"></a><a class="anchor" name="xxh64 (Converters)"></a><div class="keyword"><b><a class="anchor" name="xxh64"></a><a href="#7.3.1-xxh64">xxh64</a></b>(<span style="color: #008">[<span style="color: #080">&lt;seed&gt;</span>]</span>)</div><pre class="text">Hashes a binary input sample into a signed 64-bit quantity using the 64-bit
variant of the XXHash hash function. This hash supports a seed which defaults
to zero but a different value maybe passed as the &lt;seed&gt; argument. This hash
is known to be very good and very fast so it can be used to hash URLs and/or
URL parameters for use as stick-table keys to collect statistics with a low
collision rate, though care must be taken as the algorithm is not considered
as cryptographically secure.
</pre></div>
<a class="anchor" id="7.3.2" name="7.3.2"></a>
<h3 id="chapter-7.3.2" data-target="7.3.2"><small><a class="small" href="#7.3.2">7.3.2.</a></small> Fetching samples from internal states</h3>
<div><pre class="text">A first set of sample fetch methods applies to internal information which does
not even relate to any client information. These ones are sometimes used with
&quot;<a href="#monitor%20fail">monitor fail</a>&quot; directives to report an internal status to external watchers.
The sample fetch methods described in this section are usable anywhere.

Summary of sample fetch methods in this section and their respective types:
</pre><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-act_conn">act_conn</a></td><td >integer</td></tr>
<tr><td ><a href="#7-acl">acl([!]&lt;name&gt;[,...])</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-always_false">always_false</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-always_true">always_true</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-avg_queue">avg_queue([&lt;backend&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-be_conn">be_conn([&lt;backend&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-be_conn_free">be_conn_free([&lt;backend&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-be_sess_rate">be_sess_rate([&lt;backend&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-bin">bin(&lt;hex&gt;)</a></td><td >bin</td></tr>
<tr><td ><a href="#7-bool">bool(&lt;bool&gt;)</a></td><td >bool</td></tr>
<tr><td ><a href="#7-connslots">connslots([&lt;backend&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-cpu_calls">cpu_calls</a></td><td >integer</td></tr>
<tr><td ><a href="#7-cpu_ns_avg">cpu_ns_avg</a></td><td >integer</td></tr>
<tr><td ><a href="#7-cpu_ns_tot">cpu_ns_tot</a></td><td >integer</td></tr>
<tr><td ><a href="#7-date">date([&lt;offset&gt;],[&lt;unit&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-date_us">date_us</a></td><td >integer</td></tr>
<tr><td ><a href="#7-env">env(&lt;name&gt;)</a></td><td >string</td></tr>
<tr><td ><a href="#7-fe_conn">fe_conn([&lt;frontend&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fe_req_rate">fe_req_rate([&lt;frontend&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fe_sess_rate">fe_sess_rate([&lt;frontend&gt;])</a></td><td >integer</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-hostname">hostname</a></td><td >string</td></tr>
<tr><td ><a href="#7-int">int(&lt;integer&gt;)</a></td><td >signed</td></tr>
<tr><td ><a href="#7-ipv4">ipv4(&lt;ipv4&gt;)</a></td><td >ipv4</td></tr>
<tr><td ><a href="#7-ipv6">ipv6(&lt;ipv6&gt;)</a></td><td >ipv6</td></tr>
<tr><td ><a href="#7-last_entity">last_entity</a></td><td >string</td></tr>
<tr><td ><a href="#7-last_rule_file">last_rule_file</a></td><td >string</td></tr>
<tr><td ><a href="#7-last_rule_line">last_rule_line</a></td><td >integer</td></tr>
<tr><td ><a href="#7-lat_ns_avg">lat_ns_avg</a></td><td >integer</td></tr>
<tr><td ><a href="#7-lat_ns_tot">lat_ns_tot</a></td><td >integer</td></tr>
<tr><td ><a href="#7-meth">meth(&lt;method&gt;)</a></td><td >method</td></tr>
<tr><td ><a href="#7-nbsrv">nbsrv([&lt;backend&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-prio_class">prio_class</a></td><td >integer</td></tr>
<tr><td ><a href="#7-prio_offset">prio_offset</a></td><td >integer</td></tr>
<tr><td ><a href="#7-pid">pid</a></td><td >integer</td></tr>
<tr><td ><a href="#7-proc">proc</a></td><td >integer</td></tr>
<tr><td ><a href="#7-queue">queue([&lt;backend&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-quic_enabled">quic_enabled</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-rand">rand([&lt;range&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-srv_conn">srv_conn([&lt;backend&gt;/]&lt;server&gt;)</a></td><td >integer</td></tr>
<tr><td ><a href="#7-srv_conn_free">srv_conn_free([&lt;backend&gt;/]&lt;server&gt;)</a></td><td >integer</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-srv_is_up">srv_is_up([&lt;backend&gt;/]&lt;server&gt;)</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-srv_queue">srv_queue([&lt;backend&gt;/]&lt;server&gt;)</a></td><td >integer</td></tr>
<tr><td ><a href="#7-srv_sess_rate">srv_sess_rate([&lt;backend&gt;/]&lt;server&gt;)</a></td><td >integer</td></tr>
<tr><td ><a href="#7-srv_iweight">srv_iweight([&lt;backend&gt;/]&lt;server&gt;)</a></td><td >integer</td></tr>
<tr><td ><a href="#7-srv_uweight">srv_uweight([&lt;backend&gt;/]&lt;server&gt;)</a></td><td >integer</td></tr>
<tr><td ><a href="#7-srv_weight">srv_weight([&lt;backend&gt;/]&lt;server&gt;)</a></td><td >integer</td></tr>
<tr><td ><a href="#7-stopping">stopping</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-str">str(&lt;string&gt;)</a></td><td >string</td></tr>
<tr><td ><a href="#7-table_avl">table_avl([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-table_cnt">table_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-thread">thread</a></td><td >integer</td></tr>
<tr><td ><a href="#7-txn.id32">txn.id32</a></td><td >integer</td></tr>
<tr><td ><a href="#7-txn.sess_term_state">txn.sess_term_state</a></td><td >string</td></tr>
<tr><td ><a href="#7-uuid">uuid([&lt;version&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-var">var(&lt;var-name&gt;[,&lt;default&gt;])</a></td><td >undefined</td></tr>
<tr><td ><a href="#7-wait_end">wait_end</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-waiting_entity">waiting_entity</a></td><td >string</td></tr>
</table><pre class="text">Detailed list:
</pre><a class="anchor" name="act_conn"></a><a class="anchor" name="7-act_conn"></a><a class="anchor" name="7.3.2-act_conn"></a><a class="anchor" name="act_conn (Using ACLs and fetching samples)"></a><a class="anchor" name="act_conn (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="act_conn"></a><a href="#7.3.2-act_conn">act_conn</a></b> : integer</div><pre class="text">Returns the total number of active concurrent connections on the process.
</pre><a class="anchor" name="acl"></a><a class="anchor" name="7-acl"></a><a class="anchor" name="7.3.2-acl"></a><a class="anchor" name="acl (Using ACLs and fetching samples)"></a><a class="anchor" name="acl (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="acl"></a><a href="#7.3.2-acl">acl</a></b>(<span style="color: #008">[!]</span><span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,...]</span>) : boolean</div><pre class="text">Returns true if the evaluation of all the named ACL(s) is true, otherwise
returns false. Up to 12 ACLs may be provided, each delimited by comma. Each
named ACL may be prefixed with a &quot;!&quot; to invert the result. If any evaluation
produces an error then the sample also returns an error.
Note that HAProxy does not perform any validation checks on the referenced
ACLs, such as whether an ACL which uses a http request sample is used in
response context. This behavior may be changed in the future.
</pre><a class="anchor" name="always_false"></a><a class="anchor" name="7-always_false"></a><a class="anchor" name="7.3.2-always_false"></a><a class="anchor" name="always_false (Using ACLs and fetching samples)"></a><a class="anchor" name="always_false (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="always_false"></a><a href="#7.3.2-always_false">always_false</a></b> : boolean</div><pre class="text">Always returns the boolean &quot;false&quot; value. It may be used with ACLs as a
temporary replacement for another one when adjusting configurations.
</pre><a class="anchor" name="always_true"></a><a class="anchor" name="7-always_true"></a><a class="anchor" name="7.3.2-always_true"></a><a class="anchor" name="always_true (Using ACLs and fetching samples)"></a><a class="anchor" name="always_true (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="always_true"></a><a href="#7.3.2-always_true">always_true</a></b> : boolean</div><pre class="text">Always returns the boolean &quot;true&quot; value. It may be used with ACLs as a
temporary replacement for another one when adjusting configurations.
</pre><a class="anchor" name="avg_queue"></a><a class="anchor" name="7-avg_queue"></a><a class="anchor" name="7.3.2-avg_queue"></a><a class="anchor" name="avg_queue (Using ACLs and fetching samples)"></a><a class="anchor" name="avg_queue (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="avg_queue"></a><a href="#7.3.2-avg_queue">avg_queue</a></b>(<span style="color: #008">[<span style="color: #080">&lt;backend&gt;</span>]</span>) : integer</div><pre class="text">Returns the total number of queued connections of the designated backend
divided by the number of active servers. The current backend is used if no
backend is specified. This is very similar to &quot;<a href="#queue">queue</a>&quot; except that the size of
the farm is considered, in order to give a more accurate measurement of the
time it may take for a new connection to be processed. The main usage is with
ACL to return a sorry page to new users when it becomes certain they will get
a degraded service, or to pass to the backend servers in a header so that
they decide to work in degraded mode or to disable some functions to speed up
the processing a bit. Note that in the event there would not be any active
server anymore, twice the number of queued connections would be considered as
the measured value. This is a fair estimate, as we expect one server to get
back soon anyway, but we still prefer to send new traffic to another backend
if in better shape. See also the &quot;<a href="#queue">queue</a>&quot;, &quot;<a href="#be_conn">be_conn</a>&quot;, and &quot;<a href="#be_sess_rate">be_sess_rate</a>&quot;
sample fetches.
</pre><a class="anchor" name="be_conn"></a><a class="anchor" name="7-be_conn"></a><a class="anchor" name="7.3.2-be_conn"></a><a class="anchor" name="be_conn (Using ACLs and fetching samples)"></a><a class="anchor" name="be_conn (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="be_conn"></a><a href="#7.3.2-be_conn">be_conn</a></b>(<span style="color: #008">[<span style="color: #080">&lt;backend&gt;</span>]</span>) : integer</div><pre class="text">Applies to the number of currently established connections on the backend,
possibly including the connection being evaluated. If no backend name is
specified, the current one is used. But it is also possible to check another
backend. It can be used to use a specific farm when the nominal one is full.
See also the &quot;<a href="#fe_conn">fe_conn</a>&quot;, &quot;<a href="#queue">queue</a>&quot;, &quot;<a href="#be_conn_free">be_conn_free</a>&quot;, and &quot;<a href="#be_sess_rate">be_sess_rate</a>&quot; criteria.
</pre><a class="anchor" name="be_conn_free"></a><a class="anchor" name="7-be_conn_free"></a><a class="anchor" name="7.3.2-be_conn_free"></a><a class="anchor" name="be_conn_free (Using ACLs and fetching samples)"></a><a class="anchor" name="be_conn_free (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="be_conn_free"></a><a href="#7.3.2-be_conn_free">be_conn_free</a></b>(<span style="color: #008">[<span style="color: #080">&lt;backend&gt;</span>]</span>) : integer</div><pre class="text">Returns an integer value corresponding to the number of available connections
across available servers in the backend. Queue slots are not included. Backup
servers are also not included, unless all other servers are down. If no
backend name is specified, the current one is used. But it is also possible
to check another backend. It can be used to use a specific farm when the
nominal one is full. See also the &quot;<a href="#be_conn">be_conn</a>&quot;, &quot;<a href="#connslots">connslots</a>&quot;, and &quot;<a href="#srv_conn_free">srv_conn_free</a>&quot;
criteria.

OTHER CAVEATS AND NOTES: if any of the server maxconn, or maxqueue is 0
(meaning unlimited), then this fetch clearly does not make sense, in which
case the value returned will be -1.
</pre><a class="anchor" name="be_sess_rate"></a><a class="anchor" name="7-be_sess_rate"></a><a class="anchor" name="7.3.2-be_sess_rate"></a><a class="anchor" name="be_sess_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="be_sess_rate (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="be_sess_rate"></a><a href="#7.3.2-be_sess_rate">be_sess_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;backend&gt;</span>]</span>) : integer</div><pre class="text">Returns an integer value corresponding to the sessions creation rate on the
backend, in number of new sessions per second. This is used with ACLs to
switch to an alternate backend when an expensive or fragile one reaches too
high a session rate, or to limit abuse of service (e.g. prevent sucking of an
online dictionary). It can also be useful to add this element to logs using a
log-format directive.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># Redirect to an error page if the dictionary is requested too often</span>
backend dynamic
    mode http
    acl being_scanned be_sess_rate gt 100
    redirect location /denied.html if being_scanned
</code></pre>
</div><a class="anchor" name="bin"></a><a class="anchor" name="7-bin"></a><a class="anchor" name="7.3.2-bin"></a><a class="anchor" name="bin (Using ACLs and fetching samples)"></a><a class="anchor" name="bin (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="bin"></a><a href="#7.3.2-bin">bin</a></b>(<span style="color: #080">&lt;hex&gt;</span>) : bin</div><pre class="text">Returns a binary chain. The input is the hexadecimal representation
of the string.
</pre><a class="anchor" name="bool"></a><a class="anchor" name="7-bool"></a><a class="anchor" name="7.3.2-bool"></a><a class="anchor" name="bool (Using ACLs and fetching samples)"></a><a class="anchor" name="bool (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="bool"></a><a href="#7.3.2-bool">bool</a></b>(<span style="color: #080">&lt;bool&gt;</span>) : bool</div><pre class="text">Returns a boolean value. &lt;bool&gt; can be 'true', 'false', '1' or '0'.
'false' and '0' are the same. 'true' and '1' are the same.
</pre><a class="anchor" name="connslots"></a><a class="anchor" name="7-connslots"></a><a class="anchor" name="7.3.2-connslots"></a><a class="anchor" name="connslots (Using ACLs and fetching samples)"></a><a class="anchor" name="connslots (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="connslots"></a><a href="#7.3.2-connslots">connslots</a></b>(<span style="color: #008">[<span style="color: #080">&lt;backend&gt;</span>]</span>) : integer</div><pre class="text">Returns an integer value corresponding to the number of connection slots
still available in the backend, by totaling the maximum amount of
connections on all servers and the maximum queue size. This is probably only
used with ACLs.

The basic idea here is to be able to measure the number of connection &quot;slots&quot;
still available (connection + queue), so that anything beyond that (intended
usage; see &quot;<a href="#use_backend">use_backend</a>&quot; keyword) can be redirected to a different backend.

'connslots' = number of available server connection slots, + number of
available server queue slots.

Note that while &quot;<a href="#fe_conn">fe_conn</a>&quot; may be used, &quot;<a href="#connslots">connslots</a>&quot; comes in especially
useful when you have a case of traffic going to one single ip, splitting into
multiple backends (perhaps using ACLs to do name-based load balancing) and
you want to be able to differentiate between different backends, and their
available &quot;<a href="#connslots">connslots</a>&quot;. Also, whereas &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">nbsrv<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#nbsrv%20%28Converters%29">Converters</a></li><li><a href="#nbsrv%20%28Fetching%20samples%20from%20internal%20states%29">Fetching samples from internal states</a></li></ul></span>&quot; only measures servers that are
actually *down*, this fetch is more fine-grained and looks into the number of
available connection slots as well. See also &quot;<a href="#queue">queue</a>&quot; and &quot;<a href="#avg_queue">avg_queue</a>&quot;.

OTHER CAVEATS AND NOTES: at this point in time, the code does not take care
of dynamic connections. Also, if any of the server maxconn, or maxqueue is 0,
then this fetch clearly does not make sense, in which case the value returned
will be -1.
</pre><a class="anchor" name="cpu_calls"></a><a class="anchor" name="7-cpu_calls"></a><a class="anchor" name="7.3.2-cpu_calls"></a><a class="anchor" name="cpu_calls (Using ACLs and fetching samples)"></a><a class="anchor" name="cpu_calls (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="cpu_calls"></a><a href="#7.3.2-cpu_calls">cpu_calls</a></b> : integer</div><pre class="text">Returns the number of calls to the task processing the stream or current
request since it was allocated. This number is reset for each new request on
the same connections in case of HTTP keep-alive. This value should usually be
low and stable (around 2 calls for a typically simple request) but may become
high if some processing (compression, caching or analysis) is performed. This
is purely for performance monitoring purposes.
</pre><a class="anchor" name="cpu_ns_avg"></a><a class="anchor" name="7-cpu_ns_avg"></a><a class="anchor" name="7.3.2-cpu_ns_avg"></a><a class="anchor" name="cpu_ns_avg (Using ACLs and fetching samples)"></a><a class="anchor" name="cpu_ns_avg (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="cpu_ns_avg"></a><a href="#7.3.2-cpu_ns_avg">cpu_ns_avg</a></b> : integer</div><pre class="text">Returns the average number of nanoseconds spent in each call to the task
processing the stream or current request. This number is reset for each new
request on the same connections in case of HTTP keep-alive. This value
indicates the overall cost of processing the request or the connection for
each call. There is no good nor bad value but the time spent in a call
automatically causes latency for other processing (see lat_ns_avg below),
and may affect other connection's apparent response time. Certain operations
like compression, complex regex matching or heavy Lua operations may directly
affect this value, and having it in the logs will make it easier to spot the
faulty processing that needs to be fixed to recover decent performance.
Note: this value is exactly cpu_ns_tot divided by cpu_calls.
</pre><a class="anchor" name="cpu_ns_tot"></a><a class="anchor" name="7-cpu_ns_tot"></a><a class="anchor" name="7.3.2-cpu_ns_tot"></a><a class="anchor" name="cpu_ns_tot (Using ACLs and fetching samples)"></a><a class="anchor" name="cpu_ns_tot (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="cpu_ns_tot"></a><a href="#7.3.2-cpu_ns_tot">cpu_ns_tot</a></b> : integer</div><pre class="text">Returns the total number of nanoseconds spent in each call to the task
processing the stream or current request. This number is reset for each new
request on the same connections in case of HTTP keep-alive. This value
indicates the overall cost of processing the request or the connection for
each call. There is no good nor bad value but the time spent in a call
automatically causes latency for other processing (see lat_ns_avg below),
induces CPU costs on the machine, and may affect other connection's apparent
response time. Certain operations like compression, complex regex matching or
heavy Lua operations may directly affect this value, and having it in the
logs will make it easier to spot the faulty processing that needs to be fixed
to recover decent performance. The value may be artificially high due to a
high cpu_calls count, for example when processing many HTTP chunks, and for
this reason it is often preferred to log cpu_ns_avg instead.
</pre><a class="anchor" name="date"></a><a class="anchor" name="7-date"></a><a class="anchor" name="7.3.2-date"></a><a class="anchor" name="date (Using ACLs and fetching samples)"></a><a class="anchor" name="date (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="date"></a><a href="#7.3.2-date">date</a></b>(<span style="color: #008">[<span style="color: #080">&lt;offset&gt;</span>]</span>,<span style="color: #008">[<span style="color: #080">&lt;unit&gt;</span>]</span>) : integer</div><pre class="text">Returns the current date as the epoch (number of seconds since 01/01/1970).

If an offset value is specified, then it is added to the current date before
returning the value. This is particularly useful to compute relative dates,
as both positive and negative offsets are allowed.
It is useful combined with the http_date converter.

&lt;unit&gt; is facultative, and can be set to &quot;s&quot; for seconds (default behavior),
&quot;ms&quot; for  milliseconds or &quot;us&quot; for microseconds.
If unit is set, return value is an integer reflecting either seconds,
milliseconds or microseconds since epoch, plus offset.
It is useful when a time resolution of less than a second is needed.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># set an expires header to now+1 hour in every response</span>
http-response set-header Expires %[date(3600),http_date]

<span class="comment"># set an expires header to now+1 hour in every response, with</span>
<span class="comment"># millisecond granularity</span>
http-response set-header Expires %[date(3600000,ms),http_date(0,ms)]
</code></pre>
</div><a class="anchor" name="date_us"></a><a class="anchor" name="7-date_us"></a><a class="anchor" name="7.3.2-date_us"></a><a class="anchor" name="date_us (Using ACLs and fetching samples)"></a><a class="anchor" name="date_us (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="date_us"></a><a href="#7.3.2-date_us">date_us</a></b> : integer</div><pre class="text">Return the microseconds part of the date (the &quot;second&quot; part is returned by
date sample). This sample is coherent with the date sample as it is comes
from the same timeval structure.
</pre><a class="anchor" name="env"></a><a class="anchor" name="7-env"></a><a class="anchor" name="7.3.2-env"></a><a class="anchor" name="env (Using ACLs and fetching samples)"></a><a class="anchor" name="env (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="env"></a><a href="#7.3.2-env">env</a></b>(<span style="color: #080">&lt;name&gt;</span>) : string</div><pre class="text">Returns a string containing the value of environment variable &lt;name&gt;. As a
reminder, environment variables are per-process and are sampled when the
process starts. This can be useful to pass some information to a next hop
server, or with ACLs to take specific action when the process is started a
certain way.
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code><span class="comment"># Pass the Via header to next hop with the local hostname in it</span>
http-request add-header Via 1.1\ %[env(HOSTNAME)]

<span class="comment"># reject cookie-less requests when the STOP environment variable is set</span>
http-request deny if !{ req.cook(SESSIONID) -m found } { env(STOP) -m found }
</code></pre>
</div><a class="anchor" name="fe_conn"></a><a class="anchor" name="7-fe_conn"></a><a class="anchor" name="7.3.2-fe_conn"></a><a class="anchor" name="fe_conn (Using ACLs and fetching samples)"></a><a class="anchor" name="fe_conn (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="fe_conn"></a><a href="#7.3.2-fe_conn">fe_conn</a></b>(<span style="color: #008">[<span style="color: #080">&lt;frontend&gt;</span>]</span>) : integer</div><pre class="text">Returns the number of currently established connections on the frontend,
possibly including the connection being evaluated. If no frontend name is
specified, the current one is used. But it is also possible to check another
frontend. It can be used to return a sorry page before hard-blocking, or to
use a specific backend to drain new requests when the farm is considered
full. This is mostly used with ACLs but can also be used to pass some
statistics to servers in HTTP headers. See also the &quot;<a href="#dst_conn">dst_conn</a>&quot;, &quot;<a href="#be_conn">be_conn</a>&quot;,
&quot;<a href="#fe_sess_rate">fe_sess_rate</a>&quot; fetches.
</pre><a class="anchor" name="fe_req_rate"></a><a class="anchor" name="7-fe_req_rate"></a><a class="anchor" name="7.3.2-fe_req_rate"></a><a class="anchor" name="fe_req_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="fe_req_rate (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="fe_req_rate"></a><a href="#7.3.2-fe_req_rate">fe_req_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;frontend&gt;</span>]</span>) : integer</div><pre class="text">Returns an integer value corresponding to the number of HTTP requests per
second sent to a frontend. This number can differ from &quot;<a href="#fe_sess_rate">fe_sess_rate</a>&quot; in
situations where client-side keep-alive is enabled.
</pre><a class="anchor" name="fe_sess_rate"></a><a class="anchor" name="7-fe_sess_rate"></a><a class="anchor" name="7.3.2-fe_sess_rate"></a><a class="anchor" name="fe_sess_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="fe_sess_rate (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="fe_sess_rate"></a><a href="#7.3.2-fe_sess_rate">fe_sess_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;frontend&gt;</span>]</span>) : integer</div><pre class="text">Returns an integer value corresponding to the sessions creation rate on the
frontend, in number of new sessions per second. This is used with ACLs to
limit the incoming session rate to an acceptable range in order to prevent
abuse of service at the earliest moment, for example when combined with other
layer 4 ACLs in order to force the clients to wait a bit for the rate to go
down below the limit. It can also be useful to add this element to logs using
a log-format directive. See also the &quot;<a href="#rate-limit%20sessions">rate-limit sessions</a>&quot; directive for use
in frontends.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># This frontend limits incoming mails to 10/s with a max of 100</span>
<span class="comment"># concurrent connections. We accept any connection below 10/s, and</span>
<span class="comment"># force excess clients to wait for 100 ms. Since clients are limited to</span>
<span class="comment"># 100 max, there cannot be more than 10 incoming mails per second.</span>
frontend mail
    bind :25
    mode tcp
    maxconn 100
    acl too_fast fe_sess_rate ge 10
    tcp-request inspect-delay 100ms
    tcp-request content accept if ! too_fast
    tcp-request content accept if WAIT_END
</code></pre>
</div><a class="anchor" name="hostname"></a><a class="anchor" name="7-hostname"></a><a class="anchor" name="7.3.2-hostname"></a><a class="anchor" name="hostname (Using ACLs and fetching samples)"></a><a class="anchor" name="hostname (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="hostname"></a><a href="#7.3.2-hostname">hostname</a></b> : string</div><pre class="text">Returns the system hostname.
</pre><a class="anchor" name="int"></a><a class="anchor" name="7-int"></a><a class="anchor" name="7.3.2-int"></a><a class="anchor" name="int (Using ACLs and fetching samples)"></a><a class="anchor" name="int (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="int"></a><a href="#7.3.2-int">int</a></b>(<span style="color: #080">&lt;integer&gt;</span>) : signed integer</div><pre class="text">Returns a signed integer.
</pre><a class="anchor" name="ipv4"></a><a class="anchor" name="7-ipv4"></a><a class="anchor" name="7.3.2-ipv4"></a><a class="anchor" name="ipv4 (Using ACLs and fetching samples)"></a><a class="anchor" name="ipv4 (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="ipv4"></a><a href="#7.3.2-ipv4">ipv4</a></b>(<span style="color: #080">&lt;ipv4&gt;</span>) : ipv4</div><pre class="text">Returns an ipv4.
</pre><a class="anchor" name="ipv6"></a><a class="anchor" name="7-ipv6"></a><a class="anchor" name="7.3.2-ipv6"></a><a class="anchor" name="ipv6 (Using ACLs and fetching samples)"></a><a class="anchor" name="ipv6 (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="ipv6"></a><a href="#7.3.2-ipv6">ipv6</a></b>(<span style="color: #080">&lt;ipv6&gt;</span>) : ipv6</div><pre class="text">Returns an ipv6.
</pre><a class="anchor" name="last_entity"></a><a class="anchor" name="7-last_entity"></a><a class="anchor" name="7.3.2-last_entity"></a><a class="anchor" name="last_entity (Using ACLs and fetching samples)"></a><a class="anchor" name="last_entity (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="last_entity"></a><a href="#7.3.2-last_entity">last_entity</a></b> : string</div><pre class="text">This returns the identity of the last entity that was evaluated during stream
analysis. It may be the final rule that matched or the filter that
interrupted the processing.

A final rule is one that terminates the evaluation of the rule set (like an
&quot;<a href="#accept">accept</a>&quot;, &quot;<a href="#deny">deny</a>&quot; or &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">redirect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#redirect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#redirect%20%28Alphabetically%20sorted%20actions%20reference%29">Alphabetically sorted actions reference</a></li></ul></span>&quot;). This works for TCP request and response
rules acting on the &quot;content&quot; rulesets, and on HTTP rules from
&quot;<a href="#http-request">http-request</a>&quot;, &quot;<a href="#http-response">http-response</a>&quot; and &quot;<a href="#http-after-response">http-after-response</a>&quot; rule sets. The
legacy &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">redirect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#redirect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#redirect%20%28Alphabetically%20sorted%20actions%20reference%29">Alphabetically sorted actions reference</a></li></ul></span>&quot; rulesets are not supported (such information is not stored
there), and neither &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; nor &quot;<a href="#tcp-request%20session">tcp-request session</a>&quot;
rulesets are supported because the information is stored at the stream level
and streams do not exist during these rules. In that case, the returned value
is equivalent to &quot;last_rule_file:last_rule_line&quot;.
See also &quot;<a href="#last_rule_file">last_rule_file</a>&quot;, &quot;<a href="#last_rule_line">last_rule_line</a>&quot;.

For a filter, its identifier is returned as defined by the developers. If
this identifier is not defined, an hexadecimal value is returned
corresponding to an unique internal identifier.

The main purpose of this function is to be able to report in logs the last
entity that interrupted a processing, in order to help debugging issues. The
information returned on entities may changed in time and must not be used for
something else than debugging.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># Log the last entity, if any, and only if an error is reported</span>
log-format &quot;$HAPROXY_HTTP_LOG_FMT %{Q}[last_entity,when(error)]
</code></pre>
</div><a class="anchor" name="last_rule_file"></a><a class="anchor" name="7-last_rule_file"></a><a class="anchor" name="7.3.2-last_rule_file"></a><a class="anchor" name="last_rule_file (Using ACLs and fetching samples)"></a><a class="anchor" name="last_rule_file (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="last_rule_file"></a><a href="#7.3.2-last_rule_file">last_rule_file</a></b> : string</div><pre class="text">This returns the name of the configuration file containing the last final
rule that was matched during stream analysis. A final rule is one that
terminates the evaluation of the rule set (like an &quot;<a href="#accept">accept</a>&quot;, &quot;<a href="#deny">deny</a>&quot; or
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">redirect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#redirect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#redirect%20%28Alphabetically%20sorted%20actions%20reference%29">Alphabetically sorted actions reference</a></li></ul></span>&quot;). This works for TCP request and response rules acting on the
&quot;content&quot; rulesets, and on HTTP rules from &quot;<a href="#http-request">http-request</a>&quot;, &quot;<a href="#http-response">http-response</a>&quot;
and &quot;<a href="#http-after-response">http-after-response</a>&quot; rule sets. The legacy &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">redirect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#redirect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#redirect%20%28Alphabetically%20sorted%20actions%20reference%29">Alphabetically sorted actions reference</a></li></ul></span>&quot; rulesets are not
supported (such information is not stored there), and neither &quot;tcp-request
connection&quot; nor &quot;<a href="#tcp-request%20session">tcp-request session</a>&quot; rulesets are supported because the
information is stored at the stream level and streams do not exist during
these rules. The main purpose of this function is to be able to report in
logs where was the rule that gave the final verdict, in order to help
figure why a request was denied for example. See also &quot;<a href="#last_rule_line">last_rule_line</a>&quot;.
</pre><a class="anchor" name="last_rule_line"></a><a class="anchor" name="7-last_rule_line"></a><a class="anchor" name="7.3.2-last_rule_line"></a><a class="anchor" name="last_rule_line (Using ACLs and fetching samples)"></a><a class="anchor" name="last_rule_line (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="last_rule_line"></a><a href="#7.3.2-last_rule_line">last_rule_line</a></b> : integer</div><pre class="text">This returns the line number in the configuration file where is located the
last final rule that was matched during stream analysis. A final rule is one
that terminates the evaluation of the rule set (like an &quot;<a href="#accept">accept</a>&quot;, &quot;<a href="#deny">deny</a>&quot; or
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">redirect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#redirect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#redirect%20%28Alphabetically%20sorted%20actions%20reference%29">Alphabetically sorted actions reference</a></li></ul></span>&quot;). This works for TCP request and response rules acting on the
&quot;content&quot; rulesets, and on HTTP rules from &quot;<a href="#http-request">http-request</a>&quot;, &quot;<a href="#http-response">http-response</a>&quot;
and &quot;<a href="#http-after-response">http-after-response</a>&quot; rule sets. The legacy &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">redirect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#redirect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#redirect%20%28Alphabetically%20sorted%20actions%20reference%29">Alphabetically sorted actions reference</a></li></ul></span>&quot; rulesets are not
supported (such information is not stored there), and neither &quot;tcp-request
connection&quot; nor &quot;<a href="#tcp-request%20session">tcp-request session</a>&quot; rulesets are supported because the
information is stored at the stream level and streams do not exist during
these rules. The main purpose of this function is to be able to report in
logs where was the rule that gave the final verdict, in order to help
figure why a request was denied for example. See also &quot;<a href="#last_rule_file">last_rule_file</a>&quot;.
</pre><a class="anchor" name="lat_ns_avg"></a><a class="anchor" name="7-lat_ns_avg"></a><a class="anchor" name="7.3.2-lat_ns_avg"></a><a class="anchor" name="lat_ns_avg (Using ACLs and fetching samples)"></a><a class="anchor" name="lat_ns_avg (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="lat_ns_avg"></a><a href="#7.3.2-lat_ns_avg">lat_ns_avg</a></b> : integer</div><pre class="text">Returns the average number of nanoseconds spent between the moment the task
handling the stream is woken up and the moment it is effectively called. This
number is reset for each new request on the same connections in case of HTTP
keep-alive. This value indicates the overall latency inflicted to the current
request by all other requests being processed in parallel, and is a direct
indicator of perceived performance due to noisy neighbours. In order to keep
the value low, it is possible to reduce the scheduler's run queue depth using
&quot;<a href="#tune.runqueue-depth">tune.runqueue-depth</a>&quot;, to reduce the number of concurrent events processed at
once using &quot;<a href="#tune.maxpollevents">tune.maxpollevents</a>&quot;, to decrease the stream's nice value using
the &quot;<a href="#nice">nice</a>&quot; option on the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines or in the frontend, to enable low
latency scheduling using &quot;<a href="#tune.sched.low-latency">tune.sched.low-latency</a>&quot;, or to look for other heavy
requests in logs (those exhibiting large values of &quot;<a href="#cpu_ns_avg">cpu_ns_avg</a>&quot;), whose
processing needs to be adjusted or fixed. Compression of large buffers could
be a culprit, like heavy regex or long lists of regex. Note: this value is
exactly lat_ns_tot divided by cpu_calls.
</pre><a class="anchor" name="lat_ns_tot"></a><a class="anchor" name="7-lat_ns_tot"></a><a class="anchor" name="7.3.2-lat_ns_tot"></a><a class="anchor" name="lat_ns_tot (Using ACLs and fetching samples)"></a><a class="anchor" name="lat_ns_tot (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="lat_ns_tot"></a><a href="#7.3.2-lat_ns_tot">lat_ns_tot</a></b> : integer</div><pre class="text">Returns the total number of nanoseconds spent between the moment the task
handling the stream is woken up and the moment it is effectively called. This
number is reset for each new request on the same connections in case of HTTP
keep-alive. This value indicates the overall latency inflicted to the current
request by all other requests being processed in parallel, and is a direct
indicator of perceived performance due to noisy neighbours. In order to keep
the value low, it is possible to reduce the scheduler's run queue depth using
&quot;<a href="#tune.runqueue-depth">tune.runqueue-depth</a>&quot;, to reduce the number of concurrent events processed at
once using &quot;<a href="#tune.maxpollevents">tune.maxpollevents</a>&quot;, to decrease the stream's nice value using
the &quot;<a href="#nice">nice</a>&quot; option on the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines or in the frontend, to enable low
latency scheduling using &quot;<a href="#tune.sched.low-latency">tune.sched.low-latency</a>&quot;, or to look for other heavy
requests in logs (those exhibiting large values of &quot;<a href="#cpu_ns_avg">cpu_ns_avg</a>&quot;), whose
processing needs to be adjusted or fixed. Compression of large buffers could
be a culprit, like heavy regex or long lists of regex. Note: while it
may intuitively seem that the total latency adds to a transfer time, it is
almost never true because while a task waits for the CPU, network buffers
continue to fill up and the next call will process more at once. The value
may be artificially high due to a high cpu_calls count, for example when
processing many HTTP chunks, and for this reason it is often preferred to log
lat_ns_avg instead, which is a more relevant performance indicator.
</pre><a class="anchor" name="meth"></a><a class="anchor" name="7-meth"></a><a class="anchor" name="7.3.2-meth"></a><a class="anchor" name="meth (Using ACLs and fetching samples)"></a><a class="anchor" name="meth (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="meth"></a><a href="#7.3.2-meth">meth</a></b>(<span style="color: #080">&lt;method&gt;</span>) : method</div><pre class="text">Returns a method.
</pre><a class="anchor" name="nbsrv"></a><a class="anchor" name="7-nbsrv"></a><a class="anchor" name="7.3.2-nbsrv"></a><a class="anchor" name="nbsrv (Using ACLs and fetching samples)"></a><a class="anchor" name="nbsrv (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="nbsrv"></a><a href="#7.3.2-nbsrv">nbsrv</a></b>(<span style="color: #008">[<span style="color: #080">&lt;backend&gt;</span>]</span>) : integer</div><pre class="text">Returns an integer value corresponding to the number of usable servers of
either the current backend or the named backend. This is mostly used with
ACLs but can also be useful when added to logs. This is normally used to
switch to an alternate backend when the number of servers is too low to
to handle some load. It is useful to report a failure when combined with
&quot;<a href="#monitor%20fail">monitor fail</a>&quot;.
</pre><a class="anchor" name="prio_class"></a><a class="anchor" name="7-prio_class"></a><a class="anchor" name="7.3.2-prio_class"></a><a class="anchor" name="prio_class (Using ACLs and fetching samples)"></a><a class="anchor" name="prio_class (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="prio_class"></a><a href="#7.3.2-prio_class">prio_class</a></b> : integer</div><pre class="text">Returns the priority class of the current stream for http mode or connection
for tcp mode. The value will be that set by the last call to &quot;http-request
set-priority-class&quot; or &quot;tcp-request content set-priority-class&quot;.
</pre><a class="anchor" name="prio_offset"></a><a class="anchor" name="7-prio_offset"></a><a class="anchor" name="7.3.2-prio_offset"></a><a class="anchor" name="prio_offset (Using ACLs and fetching samples)"></a><a class="anchor" name="prio_offset (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="prio_offset"></a><a href="#7.3.2-prio_offset">prio_offset</a></b> : integer</div><pre class="text">Returns the priority offset of the current stream for http mode or
connection for tcp mode. The value will be that set by the last call to
&quot;http-request set-priority-offset&quot; or &quot;tcp-request content
set-priority-offset&quot;.
</pre><a class="anchor" name="pid"></a><a class="anchor" name="7-pid"></a><a class="anchor" name="7.3.2-pid"></a><a class="anchor" name="pid (Using ACLs and fetching samples)"></a><a class="anchor" name="pid (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="pid"></a><a href="#7.3.2-pid">pid</a></b> : integer</div><pre class="text">Return the PID of the current process. In most cases this is the PID of the
worker process.
</pre><a class="anchor" name="proc"></a><a class="anchor" name="7-proc"></a><a class="anchor" name="7.3.2-proc"></a><a class="anchor" name="proc (Using ACLs and fetching samples)"></a><a class="anchor" name="proc (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="proc"></a><a href="#7.3.2-proc">proc</a></b> : integer</div><pre class="text">Always returns value 1 (historically it would return the calling process
number).
</pre><a class="anchor" name="queue"></a><a class="anchor" name="7-queue"></a><a class="anchor" name="7.3.2-queue"></a><a class="anchor" name="queue (Using ACLs and fetching samples)"></a><a class="anchor" name="queue (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="queue"></a><a href="#7.3.2-queue">queue</a></b>(<span style="color: #008">[<span style="color: #080">&lt;backend&gt;</span>]</span>) : integer</div><pre class="text">Returns the total number of queued connections of the designated backend,
including all the connections in server queues. If no backend name is
specified, the current one is used, but it is also possible to check another
one. This is useful with ACLs or to pass statistics to backend servers. This
can be used to take actions when queuing goes above a known level, generally
indicating a surge of traffic or a massive slowdown on the servers. One
possible action could be to reject new users but still accept old ones. See
also the &quot;<a href="#avg_queue">avg_queue</a>&quot;, &quot;<a href="#be_conn">be_conn</a>&quot;, and &quot;<a href="#be_sess_rate">be_sess_rate</a>&quot; fetches.
</pre><a class="anchor" name="quic_enabled"></a><a class="anchor" name="7-quic_enabled"></a><a class="anchor" name="7.3.2-quic_enabled"></a><a class="anchor" name="quic_enabled (Using ACLs and fetching samples)"></a><a class="anchor" name="quic_enabled (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="quic_enabled"></a><a href="#7.3.2-quic_enabled">quic_enabled</a></b> : boolean</div><pre class="text">Return true when the support for QUIC transport protocol was compiled and
if this protocol was not disabled by &quot;<a href="#no-quic">no-quic</a>&quot; global option. See also &quot;<a href="#no-quic">no-quic</a>&quot;
global option.
</pre><a class="anchor" name="rand"></a><a class="anchor" name="7-rand"></a><a class="anchor" name="7.3.2-rand"></a><a class="anchor" name="rand (Using ACLs and fetching samples)"></a><a class="anchor" name="rand (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="rand"></a><a href="#7.3.2-rand">rand</a></b>(<span style="color: #008">[<span style="color: #080">&lt;range&gt;</span>]</span>) : integer</div><pre class="text">Returns a random integer value within a range of &lt;range&gt; possible values,
starting at zero. If the range is not specified, it defaults to 2^32, which
gives numbers between 0 and 4294967295. It can be useful to pass some values
needed to take some routing decisions for example, or just for debugging
purposes. This random must not be used for security purposes.
</pre><a class="anchor" name="srv_conn"></a><a class="anchor" name="7-srv_conn"></a><a class="anchor" name="7.3.2-srv_conn"></a><a class="anchor" name="srv_conn (Using ACLs and fetching samples)"></a><a class="anchor" name="srv_conn (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="srv_conn"></a><a href="#7.3.2-srv_conn">srv_conn</a></b>(<span style="color: #008">[<span style="color: #080">&lt;backend&gt;</span>/]</span><span style="color: #080">&lt;server&gt;</span>) : integer</div><pre class="text">Returns an integer value corresponding to the number of currently established
connections on the designated server, possibly including the connection being
evaluated. If &lt;backend&gt; is omitted, then the server is looked up in the
current backend. It can be used to use a specific farm when one server is
full, or to inform the server about our view of the number of active
connections with it. See also the &quot;<a href="#fe_conn">fe_conn</a>&quot;, &quot;<a href="#be_conn">be_conn</a>&quot;, &quot;<a href="#queue">queue</a>&quot;, and
&quot;<a href="#srv_conn_free">srv_conn_free</a>&quot; fetch methods.
</pre><a class="anchor" name="srv_conn_free"></a><a class="anchor" name="7-srv_conn_free"></a><a class="anchor" name="7.3.2-srv_conn_free"></a><a class="anchor" name="srv_conn_free (Using ACLs and fetching samples)"></a><a class="anchor" name="srv_conn_free (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="srv_conn_free"></a><a href="#7.3.2-srv_conn_free">srv_conn_free</a></b>(<span style="color: #008">[<span style="color: #080">&lt;backend&gt;</span>/]</span><span style="color: #080">&lt;server&gt;</span>) : integer</div><pre class="text">Returns an integer value corresponding to the number of available connections
on the designated server, possibly including the connection being evaluated.
The value does not include queue slots. If &lt;backend&gt; is omitted, then the
server is looked up in the current backend. It can be used to use a specific
farm when one server is full, or to inform the server about our view of the
number of active connections with it. See also the &quot;<a href="#be_conn_free">be_conn_free</a>&quot; and
&quot;<a href="#srv_conn">srv_conn</a>&quot; fetch methods.

OTHER CAVEATS AND NOTES: If the server maxconn is 0, then this fetch clearly
does not make sense, in which case the value returned will be -1.
</pre><a class="anchor" name="srv_is_up"></a><a class="anchor" name="7-srv_is_up"></a><a class="anchor" name="7.3.2-srv_is_up"></a><a class="anchor" name="srv_is_up (Using ACLs and fetching samples)"></a><a class="anchor" name="srv_is_up (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="srv_is_up"></a><a href="#7.3.2-srv_is_up">srv_is_up</a></b>(<span style="color: #008">[<span style="color: #080">&lt;backend&gt;</span>/]</span><span style="color: #080">&lt;server&gt;</span>) : boolean</div><pre class="text">Returns true when the designated server is UP, and false when it is either
DOWN or in maintenance mode. If &lt;backend&gt; is omitted, then the server is
looked up in the current backend. It is mainly used to take action based on
an external status reported via a health check (e.g. a geographical site's
availability). Another possible use which is more of a hack consists in
using dummy servers as boolean variables that can be enabled or disabled from
the CLI, so that rules depending on those ACLs can be tweaked in realtime.
</pre><a class="anchor" name="srv_queue"></a><a class="anchor" name="7-srv_queue"></a><a class="anchor" name="7.3.2-srv_queue"></a><a class="anchor" name="srv_queue (Using ACLs and fetching samples)"></a><a class="anchor" name="srv_queue (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="srv_queue"></a><a href="#7.3.2-srv_queue">srv_queue</a></b>(<span style="color: #008">[<span style="color: #080">&lt;backend&gt;</span>/]</span><span style="color: #080">&lt;server&gt;</span>) : integer</div><pre class="text">Returns an integer value corresponding to the number of connections currently
pending in the designated server's queue. If &lt;backend&gt; is omitted, then the
server is looked up in the current backend. It can sometimes be used together
with the &quot;<a href="#use-server">use-server</a>&quot; directive to force to use a known faster server when it
is not much loaded. See also the &quot;<a href="#srv_conn">srv_conn</a>&quot;, &quot;<a href="#avg_queue">avg_queue</a>&quot; and &quot;<a href="#queue">queue</a>&quot; sample
fetch methods.
</pre><a class="anchor" name="srv_sess_rate"></a><a class="anchor" name="7-srv_sess_rate"></a><a class="anchor" name="7.3.2-srv_sess_rate"></a><a class="anchor" name="srv_sess_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="srv_sess_rate (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="srv_sess_rate"></a><a href="#7.3.2-srv_sess_rate">srv_sess_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;backend&gt;</span>/]</span><span style="color: #080">&lt;server&gt;</span>) : integer</div><pre class="text">Returns an integer corresponding to the sessions creation rate on the
designated server, in number of new sessions per second. If &lt;backend&gt; is
omitted, then the server is looked up in the current backend. This is mostly
used with ACLs but can make sense with logs too. This is used to switch to an
alternate backend when an expensive or fragile one reaches too high a session
rate, or to limit abuse of service (e.g. prevent latent requests from
overloading servers).
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># Redirect to a separate back</span>
acl srv1_full srv_sess_rate(be1/srv1) gt 50
acl srv2_full srv_sess_rate(be1/srv2) gt 50
use_backend be2 if srv1_full or srv2_full
</code></pre>
</div><a class="anchor" name="srv_iweight"></a><a class="anchor" name="7-srv_iweight"></a><a class="anchor" name="7.3.2-srv_iweight"></a><a class="anchor" name="srv_iweight (Using ACLs and fetching samples)"></a><a class="anchor" name="srv_iweight (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="srv_iweight"></a><a href="#7.3.2-srv_iweight">srv_iweight</a></b>(<span style="color: #008">[<span style="color: #080">&lt;backend&gt;</span>/]</span><span style="color: #080">&lt;server&gt;</span>) : integer</div><pre class="text">Returns an integer corresponding to the server's initial weight. If &lt;backend&gt;
is omitted, then the server is looked up in the current backend. See also
&quot;<a href="#srv_weight">srv_weight</a>&quot; and &quot;<a href="#srv_uweight">srv_uweight</a>&quot;.
</pre><a class="anchor" name="srv_uweight"></a><a class="anchor" name="7-srv_uweight"></a><a class="anchor" name="7.3.2-srv_uweight"></a><a class="anchor" name="srv_uweight (Using ACLs and fetching samples)"></a><a class="anchor" name="srv_uweight (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="srv_uweight"></a><a href="#7.3.2-srv_uweight">srv_uweight</a></b>(<span style="color: #008">[<span style="color: #080">&lt;backend&gt;</span>/]</span><span style="color: #080">&lt;server&gt;</span>) : integer</div><pre class="text">Returns an integer corresponding to the user visible server's weight. If
&lt;backend&gt; is omitted, then the server is looked up in the current
backend. See also &quot;<a href="#srv_weight">srv_weight</a>&quot; and &quot;<a href="#srv_iweight">srv_iweight</a>&quot;.
</pre><a class="anchor" name="srv_weight"></a><a class="anchor" name="7-srv_weight"></a><a class="anchor" name="7.3.2-srv_weight"></a><a class="anchor" name="srv_weight (Using ACLs and fetching samples)"></a><a class="anchor" name="srv_weight (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="srv_weight"></a><a href="#7.3.2-srv_weight">srv_weight</a></b>(<span style="color: #008">[<span style="color: #080">&lt;backend&gt;</span>/]</span><span style="color: #080">&lt;server&gt;</span>) : integer</div><pre class="text">Returns an integer corresponding to the current (or effective) server's
weight. If &lt;backend&gt; is omitted, then the server is looked up in the current
backend. See also &quot;<a href="#srv_iweight">srv_iweight</a>&quot; and &quot;<a href="#srv_uweight">srv_uweight</a>&quot;.
</pre><a class="anchor" name="stopping"></a><a class="anchor" name="7-stopping"></a><a class="anchor" name="7.3.2-stopping"></a><a class="anchor" name="stopping (Using ACLs and fetching samples)"></a><a class="anchor" name="stopping (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="stopping"></a><a href="#7.3.2-stopping">stopping</a></b> : boolean</div><pre class="text">Returns TRUE if the process calling the function is currently stopping. This
can be useful for logging, or for relaxing certain checks or helping close
certain connections upon graceful shutdown.
</pre><a class="anchor" name="str"></a><a class="anchor" name="7-str"></a><a class="anchor" name="7.3.2-str"></a><a class="anchor" name="str (Using ACLs and fetching samples)"></a><a class="anchor" name="str (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="str"></a><a href="#7.3.2-str">str</a></b>(<span style="color: #080">&lt;string&gt;</span>) : string</div><pre class="text">Returns a string.
</pre><a class="anchor" name="table_avl"></a><a class="anchor" name="7-table_avl"></a><a class="anchor" name="7.3.2-table_avl"></a><a class="anchor" name="table_avl (Using ACLs and fetching samples)"></a><a class="anchor" name="table_avl (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="table_avl"></a><a href="#7.3.2-table_avl">table_avl</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the total number of available entries in the current proxy's
stick-table or in the designated stick-table. See also table_cnt.
</pre><a class="anchor" name="table_cnt"></a><a class="anchor" name="7-table_cnt"></a><a class="anchor" name="7.3.2-table_cnt"></a><a class="anchor" name="table_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="table_cnt (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="table_cnt"></a><a href="#7.3.2-table_cnt">table_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the total number of entries currently in use in the current proxy's
stick-table or in the designated stick-table. See also src_conn_cnt and
table_avl for other entry counting methods.
</pre><a class="anchor" name="thread"></a><a class="anchor" name="7-thread"></a><a class="anchor" name="7.3.2-thread"></a><a class="anchor" name="thread (Using ACLs and fetching samples)"></a><a class="anchor" name="thread (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="thread"></a><a href="#7.3.2-thread">thread</a></b> : integer</div><pre class="text">Returns an integer value corresponding to the position of the thread calling
the function, between 0 and (global.nbthread-1). This is useful for logging
and debugging purposes.
</pre><a class="anchor" name="txn.id32"></a><a class="anchor" name="7-txn.id32"></a><a class="anchor" name="7.3.2-txn.id32"></a><a class="anchor" name="txn.id32 (Using ACLs and fetching samples)"></a><a class="anchor" name="txn.id32 (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="txn.id32"></a><a href="#7.3.2-txn.id32">txn.id32</a></b> : integer</div><pre class="text">Returns the internal transaction ID. It is a 32bits integer. So, in absolute,
its value is not unique, transaction IDs may wrap. The wrapping period
depends on the request rate. In practice, it should not be an issue. For a
true unique ID, see &quot;<a href="#unique-id-format">unique-id-format</a>&quot; directive.
</pre><a class="anchor" name="txn.sess_term_state"></a><a class="anchor" name="7-txn.sess_term_state"></a><a class="anchor" name="7.3.2-txn.sess_term_state"></a><a class="anchor" name="txn.sess_term_state (Using ACLs and fetching samples)"></a><a class="anchor" name="txn.sess_term_state (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="txn.sess_term_state"></a><a href="#7.3.2-txn.sess_term_state">txn.sess_term_state</a></b> : string</div><pre class="text">Returns the TCP or HTTP stream termination state, as reported in the log. It
is a 2-characters string, The final stream state followed by the event which
caused its to terminate. See <a href="#8.5">section 8.5</a> about stream state at disconnection
for the list of possible events. The current value at time the sample fetch
is evaluated is returned. It is subject to change. Except used with ACLs in
&quot;<a href="#http-after-response">http-after-response</a>&quot; rule sets or in log messages, it will always be &quot;--&quot;.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># Return a 429-Too-Many-Requests if stream timed out in queue</span>
http-after-response set-status 429 if { txn.sess_term_state  &quot;sQ&quot; }
</code></pre>
</div><a class="anchor" name="uptime"></a><a class="anchor" name="7-uptime"></a><a class="anchor" name="7.3.2-uptime"></a><a class="anchor" name="uptime (Using ACLs and fetching samples)"></a><a class="anchor" name="uptime (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="uptime"></a><a href="#7.3.2-uptime">uptime</a></b> : integer</div><pre class="text">Returns the uptime of the current HAProxy worker in seconds.
</pre><a class="anchor" name="uuid"></a><a class="anchor" name="7-uuid"></a><a class="anchor" name="7.3.2-uuid"></a><a class="anchor" name="uuid (Using ACLs and fetching samples)"></a><a class="anchor" name="uuid (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="uuid"></a><a href="#7.3.2-uuid">uuid</a></b>(<span style="color: #008">[<span style="color: #080">&lt;version&gt;</span>]</span>) : string</div><pre class="text">Returns a UUID following the RFC 9562 standard. If the version is not
specified, a UUID version 4 (fully random) is returned.

Versions 4 and 7 are supported.
</pre><a class="anchor" name="var"></a><a class="anchor" name="7-var"></a><a class="anchor" name="7.3.2-var"></a><a class="anchor" name="var (Using ACLs and fetching samples)"></a><a class="anchor" name="var (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="var"></a><a href="#7.3.2-var">var</a></b>(<span style="color: #080">&lt;var-name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;default&gt;</span>]</span>) : undefined</div><pre class="text">Returns a variable with the stored type. If the variable is not set, the
sample fetch fails, unless a default value is provided, in which case it will
return it as a string. Empty strings are permitted. See <a href="#2.8">section 2.8</a> about
variables for details.
</pre><a class="anchor" name="wait_end"></a><a class="anchor" name="7-wait_end"></a><a class="anchor" name="7.3.2-wait_end"></a><a class="anchor" name="wait_end (Using ACLs and fetching samples)"></a><a class="anchor" name="wait_end (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="wait_end"></a><a href="#7.3.2-wait_end">wait_end</a></b> : boolean</div><pre class="text">This fetch either returns true when the inspection period is over, or does
not fetch. It is only used in ACLs, in conjunction with content analysis to
avoid returning a wrong verdict early. It may also be used to delay some
actions, such as a delayed reject for some special addresses. Since it either
stops the rules evaluation or immediately returns true, it is recommended to
use this acl as the last one in a rule. Please note that the default ACL
&quot;WAIT_END&quot; is always usable without prior declaration. This test was designed
to be used with TCP request content inspection.
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code><span class="comment"># delay every incoming request by 2 seconds</span>
tcp-request inspect-delay 2s
tcp-request content accept if WAIT_END

<span class="comment"># don't immediately tell bad guys they are rejected</span>
tcp-request inspect-delay 10s
acl goodguys src 10.0.0.0/24
acl badguys  src 10.0.1.0/24
tcp-request content accept if goodguys
tcp-request content reject if badguys WAIT_END
tcp-request content reject
</code></pre>
</div><a class="anchor" name="waiting_entity"></a><a class="anchor" name="7-waiting_entity"></a><a class="anchor" name="7.3.2-waiting_entity"></a><a class="anchor" name="waiting_entity (Using ACLs and fetching samples)"></a><a class="anchor" name="waiting_entity (Fetching samples from internal states)"></a><div class="keyword"><b><a class="anchor" name="waiting_entity"></a><a href="#7.3.2-waiting_entity">waiting_entity</a></b> : string</div><pre class="text">This returns the identity of the entity that was waiting to continue its
processing when an error or a timeout was encountered. It may be the a rule
or a filter for instance. However, this list is not exhaustive and the format
of all possible entities is not forcefully documented.

When the entity is a rule, its location is returned. It is the configuration
file containing the rule followed by the line where the rule is defined in
this file, separated by a colon.

For a filter, its identifier is returned as defined by the developers. If
this identifier is not defined, an hexadecimal value is returned
corresponding to an unique internal identifier.

The main purpose of this function is to be able to report in logs the entity
blocking the stream analysis when an error or a timeout was encountered,
interrupting this processing, in order to help debugging issues. The
information returned on entities may changed in time and must not be used for
something else than debugging.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># Log the waiting entity, if any, and only if an error is reported</span>
log-format &quot;$HAPROXY_HTTP_LOG_FMT %{Q}[waiting_entity,when(error)]
</code></pre>
</div></div>
<a class="anchor" id="7.3.3" name="7.3.3"></a>
<h3 id="chapter-7.3.3" data-target="7.3.3"><small><a class="small" href="#7.3.3">7.3.3.</a></small> Fetching samples at Layer 4</h3>
<div><pre class="text">The layer 4 usually describes just the transport layer which in HAProxy is
closest to the connection, where no content is yet made available. The fetch
methods described here are usable as low as the &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; rule
sets unless they require some future information. Those generally include
TCP/IP addresses and ports, as well as elements from stick-tables related to
the incoming connection. For retrieving a value from a sticky counters, the
counter number can be explicitly set as 0, 1, or 2 using the pre-defined
&quot;sc0_&quot;, &quot;sc1_&quot;, or &quot;sc2_&quot; prefix. These three pre-defined prefixes can only be
used if the global &quot;<a href="#tune.stick-counters">tune.stick-counters</a>&quot; value does not exceed 3, otherwise the
counter number can be specified as the first integer argument when using the
&quot;sc_&quot; prefix starting from &quot;sc_0&quot; to &quot;sc_N&quot; where N is (tune.stick-counters-1).
An optional table may be specified with the &quot;sc*&quot; form, in which case the
currently tracked key will be looked up into this alternate table instead of
the table currently being tracked.

Summary of sample fetch methods in this section and their respective types:
</pre><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-accept_date">accept_date([&lt;unit&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-bc.timer.connect">bc.timer.connect</a></td><td >integer</td></tr>
<tr><td ><a href="#7-bc_be_queue">bc_be_queue</a></td><td >integer</td></tr>
<tr><td ><a href="#7-bc_dst">bc_dst</a></td><td >ip</td></tr>
<tr><td ><a href="#7-bc_dst_port">bc_dst_port</a></td><td >integer</td></tr>
<tr><td ><a href="#7-bc_err">bc_err</a></td><td >integer</td></tr>
<tr><td ><a href="#7-bc_err_name">bc_err_name</a></td><td >string</td></tr>
<tr><td ><a href="#7-bc_err_str">bc_err_str</a></td><td >string</td></tr>
<tr><td ><a href="#7-bc_glitches">bc_glitches</a></td><td >integer</td></tr>
<tr><td ><a href="#7-bc_http_major">bc_http_major</a></td><td >integer</td></tr>
<tr><td ><a href="#7-bc_nb_streams">bc_nb_streams</a></td><td >integer</td></tr>
<tr><td ><a href="#7-bc_src">bc_src</a></td><td >ip</td></tr>
<tr><td ><a href="#7-bc_src_port">bc_src_port</a></td><td >integer</td></tr>
<tr><td ><a href="#7-bc_srv_queue">bc_srv_queue</a></td><td >integer</td></tr>
<tr><td ><a href="#7-bc_settings_streams_limit">bc_settings_streams_limit</a></td><td >integer</td></tr>
<tr><td ><a href="#7-be_id">be_id</a></td><td >integer</td></tr>
<tr><td ><a href="#7-be_name">be_name</a></td><td >string</td></tr>
<tr><td ><a href="#7-bc_rtt">bc_rtt(&lt;unit&gt;)</a></td><td >integer</td></tr>
<tr><td ><a href="#7-bc_rttvar">bc_rttvar(&lt;unit&gt;)</a></td><td >integer</td></tr>
<tr><td ><a href="#7-be_server_timeout">be_server_timeout</a></td><td >integer</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-be_tunnel_timeout">be_tunnel_timeout</a></td><td >integer</td></tr>
<tr><td ><a href="#7-bytes_in">bytes_in</a></td><td >integer</td></tr>
<tr><td ><a href="#7-bytes_out">bytes_out</a></td><td >integer</td></tr>
<tr><td ><a href="#7-cur_server_timeout">cur_server_timeout</a></td><td >integer</td></tr>
<tr><td ><a href="#7-cur_tunnel_timeout">cur_tunnel_timeout</a></td><td >integer</td></tr>
<tr><td ><a href="#7-cur_client_timeout">cur_client_timeout</a></td><td >integer</td></tr>
<tr><td ><a href="#7-dst">dst</a></td><td >ip</td></tr>
<tr><td ><a href="#7-dst_conn">dst_conn</a></td><td >integer</td></tr>
<tr><td ><a href="#7-dst_is_local">dst_is_local</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-dst_port">dst_port</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fc.timer.handshake">fc.timer.handshake</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fc.timer.total">fc.timer.total</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fc_dst">fc_dst</a></td><td >ip</td></tr>
<tr><td ><a href="#7-fc_dst_is_local">fc_dst_is_local</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-fc_dst_port">fc_dst_port</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fc_err">fc_err</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fc_err_name">fc_err_name</a></td><td >string</td></tr>
<tr><td ><a href="#7-fc_err_str">fc_err_str</a></td><td >string</td></tr>
<tr><td ><a href="#7-fc_fackets">fc_fackets</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fc_glitches">fc_glitches</a></td><td >integer</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-fc_http_major">fc_http_major</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fc_lost">fc_lost</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fc_nb_streams">fc_nb_streams</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fc_pp_authority">fc_pp_authority</a></td><td >string</td></tr>
<tr><td ><a href="#7-fc_pp_unique_id">fc_pp_unique_id</a></td><td >string</td></tr>
<tr><td ><a href="#7-fc_pp_tlv">fc_pp_tlv(&lt;id&gt;)</a></td><td >string</td></tr>
<tr><td ><a href="#7-fc_rcvd_proxy">fc_rcvd_proxy</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-fc_reordering">fc_reordering</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fc_retrans">fc_retrans</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fc_rtt">fc_rtt(&lt;unit&gt;)</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fc_rttvar">fc_rttvar(&lt;unit&gt;)</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fc_sacked">fc_sacked</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fc_src">fc_src</a></td><td >ip</td></tr>
<tr><td ><a href="#7-fc_src_is_local">fc_src_is_local</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-fc_src_port">fc_src_port</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fc_settings_streams_limit">fc_settings_streams_limit</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fc_unacked">fc_unacked</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fe_defbe">fe_defbe</a></td><td >string</td></tr>
<tr><td ><a href="#7-fe_id">fe_id</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fe_name">fe_name</a></td><td >string</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-fe_client_timeout">fe_client_timeout</a></td><td >integer</td></tr>
<tr><td ><a href="#7-res.timer.data">res.timer.data</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_bytes_in_rate">sc_bytes_in_rate(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_bytes_in_rate">sc0_bytes_in_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_bytes_in_rate">sc1_bytes_in_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_bytes_in_rate">sc2_bytes_in_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_bytes_out_rate">sc_bytes_out_rate(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_bytes_out_rate">sc0_bytes_out_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_bytes_out_rate">sc1_bytes_out_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_bytes_out_rate">sc2_bytes_out_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_clr_gpc">sc_clr_gpc(&lt;idx&gt;,&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_clr_gpc0">sc_clr_gpc0(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_clr_gpc0">sc0_clr_gpc0([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_clr_gpc0">sc1_clr_gpc0([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_clr_gpc0">sc2_clr_gpc0([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_clr_gpc1">sc_clr_gpc1(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_clr_gpc1">sc0_clr_gpc1([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_clr_gpc1">sc1_clr_gpc1([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_clr_gpc1">sc2_clr_gpc1([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_conn_cnt">sc_conn_cnt(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-sc0_conn_cnt">sc0_conn_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_conn_cnt">sc1_conn_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_conn_cnt">sc2_conn_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_conn_cur">sc_conn_cur(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_conn_cur">sc0_conn_cur([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_conn_cur">sc1_conn_cur([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_conn_cur">sc2_conn_cur([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_conn_rate">sc_conn_rate(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_conn_rate">sc0_conn_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_conn_rate">sc1_conn_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_conn_rate">sc2_conn_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_get_gpc">sc_get_gpc(&lt;idx&gt;,&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_get_gpc0">sc_get_gpc0(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_get_gpc0">sc0_get_gpc0([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_get_gpc0">sc1_get_gpc0([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_get_gpc0">sc2_get_gpc0([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_get_gpc1">sc_get_gpc1(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_get_gpc1">sc0_get_gpc1([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_get_gpc1">sc1_get_gpc1([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_get_gpc1">sc2_get_gpc1([&lt;table&gt;])</a></td><td >integer</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-sc_get_gpt">sc_get_gpt(&lt;idx&gt;,&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_get_gpt0">sc_get_gpt0(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_get_gpt0">sc0_get_gpt0([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_get_gpt0">sc1_get_gpt0([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_get_gpt0">sc2_get_gpt0([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_glitch_cnt">sc_glitch_cnt(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_glitch_cnt">sc0_glitch_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_glitch_cnt">sc1_glitch_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_glitch_cnt">sc2_glitch_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_glitch_rate">sc_glitch_rate(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_glitch_rate">sc0_glitch_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_glitch_rate">sc1_glitch_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_glitch_rate">sc2_glitch_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_gpc_rate">sc_gpc_rate(&lt;idx&gt;,&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_gpc0_rate">sc_gpc0_rate(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_gpc0_rate">sc0_gpc0_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_gpc0_rate">sc1_gpc0_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_gpc0_rate">sc2_gpc0_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_gpc1_rate">sc_gpc1_rate(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_gpc1_rate">sc0_gpc1_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-sc1_gpc1_rate">sc1_gpc1_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_gpc1_rate">sc2_gpc1_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_http_err_cnt">sc_http_err_cnt(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_http_err_cnt">sc0_http_err_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_http_err_cnt">sc1_http_err_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_http_err_cnt">sc2_http_err_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_http_err_rate">sc_http_err_rate(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_http_err_rate">sc0_http_err_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_http_err_rate">sc1_http_err_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_http_err_rate">sc2_http_err_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_http_fail_cnt">sc_http_fail_cnt(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_http_fail_cnt">sc0_http_fail_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_http_fail_cnt">sc1_http_fail_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_http_fail_cnt">sc2_http_fail_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_http_fail_rate">sc_http_fail_rate(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_http_fail_rate">sc0_http_fail_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_http_fail_rate">sc1_http_fail_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_http_fail_rate">sc2_http_fail_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_http_req_cnt">sc_http_req_cnt(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_http_req_cnt">sc0_http_req_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-sc1_http_req_cnt">sc1_http_req_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_http_req_cnt">sc2_http_req_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_http_req_rate">sc_http_req_rate(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_http_req_rate">sc0_http_req_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_http_req_rate">sc1_http_req_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_http_req_rate">sc2_http_req_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_inc_gpc">sc_inc_gpc(&lt;idx&gt;,&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_inc_gpc0">sc_inc_gpc0(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_inc_gpc0">sc0_inc_gpc0([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_inc_gpc0">sc1_inc_gpc0([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_inc_gpc0">sc2_inc_gpc0([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_inc_gpc1">sc_inc_gpc1(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_inc_gpc1">sc0_inc_gpc1([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_inc_gpc1">sc1_inc_gpc1([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_inc_gpc1">sc2_inc_gpc1([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_kbytes_in">sc_kbytes_in(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_kbytes_in">sc0_kbytes_in([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_kbytes_in">sc1_kbytes_in([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_kbytes_in">sc2_kbytes_in([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_kbytes_out">sc_kbytes_out(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-sc0_kbytes_out">sc0_kbytes_out([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_kbytes_out">sc1_kbytes_out([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_kbytes_out">sc2_kbytes_out([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_sess_cnt">sc_sess_cnt(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_sess_cnt">sc0_sess_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_sess_cnt">sc1_sess_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_sess_cnt">sc2_sess_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_sess_rate">sc_sess_rate(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_sess_rate">sc0_sess_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_sess_rate">sc1_sess_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_sess_rate">sc2_sess_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc_tracked">sc_tracked(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-sc0_tracked">sc0_tracked([&lt;table&gt;])</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-sc1_tracked">sc1_tracked([&lt;table&gt;])</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-sc2_tracked">sc2_tracked([&lt;table&gt;])</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-sc_trackers">sc_trackers(&lt;ctr&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc0_trackers">sc0_trackers([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc1_trackers">sc1_trackers([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-sc2_trackers">sc2_trackers([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-so_id">so_id</a></td><td >integer</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-so_name">so_name</a></td><td >string</td></tr>
<tr><td ><a href="#7-src">src</a></td><td >ip</td></tr>
<tr><td ><a href="#7-src_bytes_in_rate">src_bytes_in_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_bytes_out_rate">src_bytes_out_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_clr_gpc">src_clr_gpc(&lt;idx&gt;,[&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_clr_gpc0">src_clr_gpc0([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_clr_gpc1">src_clr_gpc1([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_conn_cnt">src_conn_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_conn_cur">src_conn_cur([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_conn_rate">src_conn_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_get_gpc">src_get_gpc(&lt;idx&gt;,[&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_get_gpc0">src_get_gpc0([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_get_gpc1">src_get_gpc1([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_get_gpt">src_get_gpt(&lt;idx&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_get_gpt0">src_get_gpt0([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_glitch_cnt">src_glitch_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_glitch_rate">src_glitch_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_gpc_rate">src_gpc_rate(&lt;idx&gt;[,&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_gpc0_rate">src_gpc0_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_gpc1_rate">src_gpc1_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-src_http_err_cnt">src_http_err_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_http_err_rate">src_http_err_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_http_fail_cnt">src_http_fail_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_http_fail_rate">src_http_fail_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_http_req_cnt">src_http_req_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_http_req_rate">src_http_req_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_inc_gpc">src_inc_gpc(&lt;idx&gt;,[&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_inc_gpc0">src_inc_gpc0([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_inc_gpc1">src_inc_gpc1([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_is_local">src_is_local</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-src_kbytes_in">src_kbytes_in([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_kbytes_out">src_kbytes_out([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_port">src_port</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_sess_cnt">src_sess_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_sess_rate">src_sess_rate([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-src_updt_conn_cnt">src_updt_conn_cnt([&lt;table&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-srv_id">srv_id</a></td><td >integer</td></tr>
<tr><td ><a href="#7-srv_name">srv_name</a></td><td >string</td></tr>
<tr><td ><a href="#7-txn.conn_retries">txn.conn_retries</a></td><td >integer</td></tr>
<tr><td ><a href="#7-txn.redispatched">txn.redispatched</a></td><td >boolean</td></tr>
</table><pre class="text">Detailed list:
</pre><a class="anchor" name="accept_date"></a><a class="anchor" name="7-accept_date"></a><a class="anchor" name="7.3.3-accept_date"></a><a class="anchor" name="accept_date (Using ACLs and fetching samples)"></a><a class="anchor" name="accept_date (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="accept_date"></a><a href="#7.3.3-accept_date">accept_date</a></b>(<span style="color: #008">[<span style="color: #080">&lt;unit&gt;</span>]</span>) : integer</div><pre class="text">This is the exact date when the connection was received by HAProxy
(which might be very slightly different from the date observed on the
network if there was some queuing in the system's backlog). This is usually
the same date which may appear in any upstream firewall's log. When used in
HTTP mode, the accept_date field will be reset to the first moment the
connection is ready to receive a new request (end of previous response for
HTTP/1, immediately after previous request for HTTP/2).

Returns a value in number of seconds since epoch.

&lt;unit&gt; is facultative, and can be set to &quot;s&quot; for seconds (default behavior),
&quot;ms&quot; for  milliseconds or &quot;us&quot; for microseconds.
If unit is set, return value is an integer reflecting either seconds,
milliseconds or microseconds since epoch.
It is useful when a time resolution of less than a second is needed.
</pre><a class="anchor" name="bc.timer.connect"></a><a class="anchor" name="7-bc.timer.connect"></a><a class="anchor" name="7.3.3-bc.timer.connect"></a><a class="anchor" name="bc.timer.connect (Using ACLs and fetching samples)"></a><a class="anchor" name="bc.timer.connect (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bc.timer.connect"></a><a href="#7.3.3-bc.timer.connect">bc.timer.connect</a></b> : integer</div><pre class="text">Total time to establish the TCP connection to the server.  This is the
equivalent of %Tc in the log-format. This is reported in milliseconds (ms).
For more information see Section 8.4 &quot;Timing events&quot;
</pre><a class="anchor" name="bc_be_queue"></a><a class="anchor" name="7-bc_be_queue"></a><a class="anchor" name="7.3.3-bc_be_queue"></a><a class="anchor" name="bc_be_queue (Using ACLs and fetching samples)"></a><a class="anchor" name="bc_be_queue (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bc_be_queue"></a><a href="#7.3.3-bc_be_queue">bc_be_queue</a></b> : integer</div><pre class="text">Number of streams de-queued while waiting for a connection slot on the
target backend. This is the equivalent of %bq in the log-format.
</pre><a class="anchor" name="bc_dst"></a><a class="anchor" name="7-bc_dst"></a><a class="anchor" name="7.3.3-bc_dst"></a><a class="anchor" name="bc_dst (Using ACLs and fetching samples)"></a><a class="anchor" name="bc_dst (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bc_dst"></a><a href="#7.3.3-bc_dst">bc_dst</a></b> : ip</div><pre class="text">This is the destination ip address of the connection on the server side,
which is the server address HAProxy connected to. It is of type IP and works
on both IPv4 and IPv6 tables.  On IPv6 tables, IPv4 address is mapped to its
IPv6 equivalent, according to RFC 4291.
</pre><a class="anchor" name="bc_dst_port"></a><a class="anchor" name="7-bc_dst_port"></a><a class="anchor" name="7.3.3-bc_dst_port"></a><a class="anchor" name="bc_dst_port (Using ACLs and fetching samples)"></a><a class="anchor" name="bc_dst_port (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bc_dst_port"></a><a href="#7.3.3-bc_dst_port">bc_dst_port</a></b> : integer</div><pre class="text">Returns an integer value corresponding to the destination TCP port of the
connection on the server side, which is the port HAProxy connected to.
</pre><a class="anchor" name="bc_err"></a><a class="anchor" name="7-bc_err"></a><a class="anchor" name="7.3.3-bc_err"></a><a class="anchor" name="bc_err (Using ACLs and fetching samples)"></a><a class="anchor" name="bc_err (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bc_err"></a><a href="#7.3.3-bc_err">bc_err</a></b> : integer</div><pre class="text">Returns the ID of the error that might have occurred on the current backend
connection. See the &quot;<a href="#fc_err_str">fc_err_str</a>&quot; fetch for a full list of error codes
and their corresponding error message.
</pre><a class="anchor" name="bc_err_name"></a><a class="anchor" name="7-bc_err_name"></a><a class="anchor" name="7.3.3-bc_err_name"></a><a class="anchor" name="bc_err_name (Using ACLs and fetching samples)"></a><a class="anchor" name="bc_err_name (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bc_err_name"></a><a href="#7.3.3-bc_err_name">bc_err_name</a></b> : string</div><pre class="text">Returns the internal error name describing what problem happened on the
backend connection, resulting in a connection failure. This string is made of
a single word and is empty when no error is present. It corresponds to the
&quot;<a href="#name">name</a>&quot; column in the table presented in the &quot;<a href="#fc_err_str">fc_err_str</a>&quot; keyword.
</pre><a class="anchor" name="bc_err_str"></a><a class="anchor" name="7-bc_err_str"></a><a class="anchor" name="7.3.3-bc_err_str"></a><a class="anchor" name="bc_err_str (Using ACLs and fetching samples)"></a><a class="anchor" name="bc_err_str (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bc_err_str"></a><a href="#7.3.3-bc_err_str">bc_err_str</a></b> : string</div><pre class="text">Returns an error message describing what problem happened on the current
backend connection, resulting in a connection failure. See the
&quot;<a href="#fc_err_str">fc_err_str</a>&quot; fetch for a full list of error codes and their
corresponding error message.
</pre><a class="anchor" name="bc_glitches"></a><a class="anchor" name="7-bc_glitches"></a><a class="anchor" name="7.3.3-bc_glitches"></a><a class="anchor" name="bc_glitches (Using ACLs and fetching samples)"></a><a class="anchor" name="bc_glitches (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bc_glitches"></a><a href="#7.3.3-bc_glitches">bc_glitches</a></b> : integer</div><pre class="text">Returns the number of protocol glitches counted on the backend connection.
These generally cover protocol violations as well as small anomalies that
generally indicate a bogus or misbehaving server that may cause trouble in
the infrastructure (e.g. cause connections to be aborted early, inducing
frequent TLS renegotiations). These may also be caused by too large responses
that cannot fit into a single buffer, explaining HTTP 502 errors. Ideally
this number should remain zero, though it's generally fine if it remains very
low compared to the total number of requests. These values should normally
not be considered as alarming (especially small ones), though a sudden jump
may indicate an anomaly somewhere. Not all protocol multiplexers measure this
metric and the only way to get more details about the events is to enable
traces to capture all exchanges.
</pre><a class="anchor" name="bc_http_major"></a><a class="anchor" name="7-bc_http_major"></a><a class="anchor" name="7.3.3-bc_http_major"></a><a class="anchor" name="bc_http_major (Using ACLs and fetching samples)"></a><a class="anchor" name="bc_http_major (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bc_http_major"></a><a href="#7.3.3-bc_http_major">bc_http_major</a></b> : integer</div><pre class="text">Returns the backend connection's HTTP major version encoding, which may be 1
for HTTP/0.9 to HTTP/1.1 or 2 for HTTP/2. Note, this is based on the on-wire
encoding and not the version present in the request header.
</pre><a class="anchor" name="bc_nb_streams"></a><a class="anchor" name="7-bc_nb_streams"></a><a class="anchor" name="7.3.3-bc_nb_streams"></a><a class="anchor" name="bc_nb_streams (Using ACLs and fetching samples)"></a><a class="anchor" name="bc_nb_streams (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bc_nb_streams"></a><a href="#7.3.3-bc_nb_streams">bc_nb_streams</a></b> : integer</div><pre class="text">Returns the number of streams opened on the backend connection.
</pre><a class="anchor" name="bc_src"></a><a class="anchor" name="7-bc_src"></a><a class="anchor" name="7.3.3-bc_src"></a><a class="anchor" name="bc_src (Using ACLs and fetching samples)"></a><a class="anchor" name="bc_src (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bc_src"></a><a href="#7.3.3-bc_src">bc_src</a></b> : ip</div><pre class="text">This is the source ip address of the connection on the server side, which is
the server address HAProxy connected from. It is of type IP and works on both
IPv4 and IPv6 tables. On IPv6 tables, IPv4 addresses are mapped to their IPv6
equivalent, according to RFC 4291.
</pre><a class="anchor" name="bc_src_port"></a><a class="anchor" name="7-bc_src_port"></a><a class="anchor" name="7.3.3-bc_src_port"></a><a class="anchor" name="bc_src_port (Using ACLs and fetching samples)"></a><a class="anchor" name="bc_src_port (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bc_src_port"></a><a href="#7.3.3-bc_src_port">bc_src_port</a></b> : integer</div><pre class="text">Returns an integer value corresponding to the TCP source port of the
connection on the server side, which is the port HAProxy connected from.
</pre><a class="anchor" name="bc_srv_queue"></a><a class="anchor" name="7-bc_srv_queue"></a><a class="anchor" name="7.3.3-bc_srv_queue"></a><a class="anchor" name="bc_srv_queue (Using ACLs and fetching samples)"></a><a class="anchor" name="bc_srv_queue (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bc_srv_queue"></a><a href="#7.3.3-bc_srv_queue">bc_srv_queue</a></b> : integer</div><pre class="text">Number of streams de-queued while waiting for a connection slot on the
target server. This is the equivalent of %sq in the log-format.
</pre><a class="anchor" name="bc_settings_streams_limit"></a><a class="anchor" name="7-bc_settings_streams_limit"></a><a class="anchor" name="7.3.3-bc_settings_streams_limit"></a><a class="anchor" name="bc_settings_streams_limit (Using ACLs and fetching samples)"></a><a class="anchor" name="bc_settings_streams_limit (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bc_settings_streams_limit"></a><a href="#7.3.3-bc_settings_streams_limit">bc_settings_streams_limit</a></b> : integer</div><pre class="text">Returns the maximum number of streams allowed on the backend connection. For
TCP and HTTP/1.1 connections, it is always 1. For other protocols, it depends
on the settings negotiated with the server.
</pre><a class="anchor" name="be_id"></a><a class="anchor" name="7-be_id"></a><a class="anchor" name="7.3.3-be_id"></a><a class="anchor" name="be_id (Using ACLs and fetching samples)"></a><a class="anchor" name="be_id (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="be_id"></a><a href="#7.3.3-be_id">be_id</a></b> : integer</div><pre class="text">Returns an integer containing the current backend's id. It can be used in
frontends with responses to check which backend processed the request. If
used in a frontend and no backend was used, it returns the current
frontend's id. It can also be used in a tcp-check or an http-check ruleset.
</pre><a class="anchor" name="be_name"></a><a class="anchor" name="7-be_name"></a><a class="anchor" name="7.3.3-be_name"></a><a class="anchor" name="be_name (Using ACLs and fetching samples)"></a><a class="anchor" name="be_name (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="be_name"></a><a href="#7.3.3-be_name">be_name</a></b> : string</div><pre class="text">Returns a string containing the current backend's name. It can be used in
frontends with responses to check which backend processed the request. If
used in a frontend and no backend was used, it returns the current
frontend's name. It can also be used in a tcp-check or an http-check
ruleset.
</pre><a class="anchor" name="bc_rtt"></a><a class="anchor" name="7-bc_rtt"></a><a class="anchor" name="7.3.3-bc_rtt"></a><a class="anchor" name="bc_rtt (Using ACLs and fetching samples)"></a><a class="anchor" name="bc_rtt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bc_rtt"></a><a href="#7.3.3-bc_rtt">bc_rtt</a></b>(<span style="color: #080">&lt;unit&gt;</span>) : integer</div><pre class="text">Returns the Round Trip Time (RTT) measured by the kernel for the backend
connection. &lt;unit&gt; is facultative, by default the unit is milliseconds. &lt;unit&gt;
can be set to &quot;ms&quot; for milliseconds or &quot;us&quot; for microseconds. If the server
connection is not established, if the connection is not TCP or if the
operating system does not support TCP_INFO, for example Linux kernels before
2.4, the sample fetch fails.
</pre><a class="anchor" name="bc_rttvar"></a><a class="anchor" name="7-bc_rttvar"></a><a class="anchor" name="7.3.3-bc_rttvar"></a><a class="anchor" name="bc_rttvar (Using ACLs and fetching samples)"></a><a class="anchor" name="bc_rttvar (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bc_rttvar"></a><a href="#7.3.3-bc_rttvar">bc_rttvar</a></b>(<span style="color: #080">&lt;unit&gt;</span>) : integer</div><pre class="text">Returns the Round Trip Time (RTT) variance measured by the kernel for the
backend connection. &lt;unit&gt; is facultative, by default the unit is milliseconds.
&lt;unit&gt; can be set to &quot;ms&quot; for milliseconds or &quot;us&quot; for microseconds. If the
server connection is not established, if the connection is not TCP or if the
operating system does not support TCP_INFO, for example Linux kernels before
2.4, the sample fetch fails.
</pre><a class="anchor" name="be_server_timeout"></a><a class="anchor" name="7-be_server_timeout"></a><a class="anchor" name="7.3.3-be_server_timeout"></a><a class="anchor" name="be_server_timeout (Using ACLs and fetching samples)"></a><a class="anchor" name="be_server_timeout (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="be_server_timeout"></a><a href="#7.3.3-be_server_timeout">be_server_timeout</a></b> : integer</div><pre class="text">Returns the configuration value in millisecond for the server timeout of the
current backend. This timeout can be overwritten by a &quot;<a href="#set-timeout">set-timeout</a>&quot; rule. See
also the &quot;<a href="#cur_server_timeout">cur_server_timeout</a>&quot;.
</pre><a class="anchor" name="be_tunnel_timeout"></a><a class="anchor" name="7-be_tunnel_timeout"></a><a class="anchor" name="7.3.3-be_tunnel_timeout"></a><a class="anchor" name="be_tunnel_timeout (Using ACLs and fetching samples)"></a><a class="anchor" name="be_tunnel_timeout (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="be_tunnel_timeout"></a><a href="#7.3.3-be_tunnel_timeout">be_tunnel_timeout</a></b> : integer</div><pre class="text">Returns the configuration value in millisecond for the tunnel timeout of the
current backend. This timeout can be overwritten by a &quot;<a href="#set-timeout">set-timeout</a>&quot; rule. See
also the &quot;<a href="#cur_tunnel_timeout">cur_tunnel_timeout</a>&quot;.
</pre><a class="anchor" name="bytes_in"></a><a class="anchor" name="7-bytes_in"></a><a class="anchor" name="7.3.3-bytes_in"></a><a class="anchor" name="bytes_in (Using ACLs and fetching samples)"></a><a class="anchor" name="bytes_in (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bytes_in"></a><a href="#7.3.3-bytes_in">bytes_in</a></b> : integer</div><pre class="text">This returns the number of bytes uploaded from the client to the server.
</pre><a class="anchor" name="bytes_out"></a><a class="anchor" name="7-bytes_out"></a><a class="anchor" name="7.3.3-bytes_out"></a><a class="anchor" name="bytes_out (Using ACLs and fetching samples)"></a><a class="anchor" name="bytes_out (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="bytes_out"></a><a href="#7.3.3-bytes_out">bytes_out</a></b> : integer</div><pre class="text">This is the number of bytes transmitted from the server to the client.
</pre><a class="anchor" name="cur_server_timeout"></a><a class="anchor" name="7-cur_server_timeout"></a><a class="anchor" name="7.3.3-cur_server_timeout"></a><a class="anchor" name="cur_server_timeout (Using ACLs and fetching samples)"></a><a class="anchor" name="cur_server_timeout (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="cur_server_timeout"></a><a href="#7.3.3-cur_server_timeout">cur_server_timeout</a></b> : integer</div><pre class="text">Returns the currently applied server timeout in millisecond for the stream.
In the default case, this will be equal to be_server_timeout unless a
&quot;<a href="#set-timeout">set-timeout</a>&quot; rule has been applied. See also &quot;<a href="#be_server_timeout">be_server_timeout</a>&quot;.
</pre><a class="anchor" name="cur_tunnel_timeout"></a><a class="anchor" name="7-cur_tunnel_timeout"></a><a class="anchor" name="7.3.3-cur_tunnel_timeout"></a><a class="anchor" name="cur_tunnel_timeout (Using ACLs and fetching samples)"></a><a class="anchor" name="cur_tunnel_timeout (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="cur_tunnel_timeout"></a><a href="#7.3.3-cur_tunnel_timeout">cur_tunnel_timeout</a></b> : integer</div><pre class="text">Returns the currently applied tunnel timeout in millisecond for the stream.
In the default case, this will be equal to be_tunnel_timeout unless a
&quot;<a href="#set-timeout">set-timeout</a>&quot; rule has been applied. See also &quot;<a href="#be_tunnel_timeout">be_tunnel_timeout</a>&quot;.
</pre><a class="anchor" name="cur_client_timeout"></a><a class="anchor" name="7-cur_client_timeout"></a><a class="anchor" name="7.3.3-cur_client_timeout"></a><a class="anchor" name="cur_client_timeout (Using ACLs and fetching samples)"></a><a class="anchor" name="cur_client_timeout (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="cur_client_timeout"></a><a href="#7.3.3-cur_client_timeout">cur_client_timeout</a></b> : integer</div><pre class="text">Returns the currently applied client timeout in millisecond for the stream.
In the default case, this will be equal to fe_client_timeout unless a
&quot;<a href="#set-timeout">set-timeout</a>&quot; rule has been applied. See also &quot;<a href="#fe_client_timeout">fe_client_timeout</a>&quot;.
</pre><a class="anchor" name="dst"></a><a class="anchor" name="7-dst"></a><a class="anchor" name="7.3.3-dst"></a><a class="anchor" name="dst (Using ACLs and fetching samples)"></a><a class="anchor" name="dst (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="dst"></a><a href="#7.3.3-dst">dst</a></b> : ip</div><pre class="text">This is the destination IP address of the connection on the client side,
which is the address the client connected to. Any tcp/http rules may alter
this address. It can be useful when running in transparent mode. It is of
type IP and works on both IPv4 and IPv6 tables.  On IPv6 tables, IPv4 address
is mapped to its IPv6 equivalent, according to RFC 4291. When the incoming
connection passed through address translation or redirection involving
connection tracking, the original destination address before the redirection
will be reported. On Linux systems, the source and destination may seldom
appear reversed if the nf_conntrack_tcp_loose sysctl is set, because a late
response may reopen a timed out connection and switch what is believed to be
the source and the destination.
</pre><a class="anchor" name="dst_conn"></a><a class="anchor" name="7-dst_conn"></a><a class="anchor" name="7.3.3-dst_conn"></a><a class="anchor" name="dst_conn (Using ACLs and fetching samples)"></a><a class="anchor" name="dst_conn (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="dst_conn"></a><a href="#7.3.3-dst_conn">dst_conn</a></b> : integer</div><pre class="text">Returns an integer value corresponding to the number of currently established
connections on the same socket including the one being evaluated. It is
normally used with ACLs but can as well be used to pass the information to
servers in an HTTP header or in logs. It can be used to either return a sorry
page before hard-blocking, or to use a specific backend to drain new requests
when the socket is considered saturated. This offers the ability to assign
different limits to different listening ports or addresses. See also the
&quot;<a href="#fe_conn">fe_conn</a>&quot; and &quot;<a href="#be_conn">be_conn</a>&quot; fetches.
</pre><a class="anchor" name="dst_is_local"></a><a class="anchor" name="7-dst_is_local"></a><a class="anchor" name="7.3.3-dst_is_local"></a><a class="anchor" name="dst_is_local (Using ACLs and fetching samples)"></a><a class="anchor" name="dst_is_local (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="dst_is_local"></a><a href="#7.3.3-dst_is_local">dst_is_local</a></b> : boolean</div><pre class="text">Returns true if the destination address of the incoming connection is local
to the system, or false if the address doesn't exist on the system, meaning
that it was intercepted in transparent mode. It can be useful to apply
certain rules by default to forwarded traffic and other rules to the traffic
targeting the real address of the machine. For example the stats page could
be delivered only on this address, or SSH access could be locally redirected.
Please note that the check involves a few system calls, so it's better to do
it only once per connection.
</pre><a class="anchor" name="dst_port"></a><a class="anchor" name="7-dst_port"></a><a class="anchor" name="7.3.3-dst_port"></a><a class="anchor" name="dst_port (Using ACLs and fetching samples)"></a><a class="anchor" name="dst_port (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="dst_port"></a><a href="#7.3.3-dst_port">dst_port</a></b> : integer</div><pre class="text">Returns an integer value corresponding to the destination TCP port of the
connection on the client side, which is the port the client connected to.
Any tcp/http rules may alter this address. This might be used when running in
transparent mode, when assigning dynamic ports to some clients for a whole
application session, to stick all users to a same server, or to pass the
destination port information to a server using an HTTP header.
</pre><a class="anchor" name="fc.timer.handshake"></a><a class="anchor" name="7-fc.timer.handshake"></a><a class="anchor" name="7.3.3-fc.timer.handshake"></a><a class="anchor" name="fc.timer.handshake (Using ACLs and fetching samples)"></a><a class="anchor" name="fc.timer.handshake (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc.timer.handshake"></a><a href="#7.3.3-fc.timer.handshake">fc.timer.handshake</a></b> : integer</div><pre class="text">Total time to accept tcp connection and execute handshakes for low level
protocols. Currently, these protocols are proxy-protocol and SSL. This is the
equivalent of %Th in the log-format.  This is reported in milliseconds (ms).
For more information see Section 8.4 &quot;Timing events&quot;
</pre><a class="anchor" name="fc.timer.total"></a><a class="anchor" name="7-fc.timer.total"></a><a class="anchor" name="7.3.3-fc.timer.total"></a><a class="anchor" name="fc.timer.total (Using ACLs and fetching samples)"></a><a class="anchor" name="fc.timer.total (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc.timer.total"></a><a href="#7.3.3-fc.timer.total">fc.timer.total</a></b> : integer</div><pre class="text">Total stream duration time, between the moment the proxy accepted it and the
moment both ends were closed. This is the equivalent of %Tt in the log-format.
This is reported in milliseconds (ms). For more information see Section 8.4
&quot;Timing events&quot;
</pre><a class="anchor" name="fc_dst"></a><a class="anchor" name="7-fc_dst"></a><a class="anchor" name="7.3.3-fc_dst"></a><a class="anchor" name="fc_dst (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_dst (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_dst"></a><a href="#7.3.3-fc_dst">fc_dst</a></b> : ip</div><pre class="text">This is the original destination IP address of the connection on the client
side. Only &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; rules may alter this address. See &quot;<a href="#dst">dst</a>&quot;
for details.
</pre><a class="anchor" name="fc_dst_is_local"></a><a class="anchor" name="7-fc_dst_is_local"></a><a class="anchor" name="7.3.3-fc_dst_is_local"></a><a class="anchor" name="fc_dst_is_local (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_dst_is_local (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_dst_is_local"></a><a href="#7.3.3-fc_dst_is_local">fc_dst_is_local</a></b> : boolean</div><pre class="text">Returns true if the original destination address of the incoming connection
is local to the system, or false if the address doesn't exist on the
system. See &quot;<a href="#dst_is_local">dst_is_local</a>&quot; for details.
</pre><a class="anchor" name="fc_dst_port"></a><a class="anchor" name="7-fc_dst_port"></a><a class="anchor" name="7.3.3-fc_dst_port"></a><a class="anchor" name="fc_dst_port (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_dst_port (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_dst_port"></a><a href="#7.3.3-fc_dst_port">fc_dst_port</a></b> : integer</div><pre class="text">Returns an integer value corresponding to the original destination TCP port
of the connection on the client side. Only &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; rules may
alter this address. See &quot;dst-port&quot; for details.
</pre><a class="anchor" name="fc_err"></a><a class="anchor" name="7-fc_err"></a><a class="anchor" name="7.3.3-fc_err"></a><a class="anchor" name="fc_err (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_err (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_err"></a><a href="#7.3.3-fc_err">fc_err</a></b> : integer</div><pre class="text">Returns the ID of the error that might have occurred on the current
connection. Any strictly positive value of this fetch indicates that the
connection did not succeed and would result in an error log being output (as
described in <a href="#8.2.5">section 8.2.5</a>). See the &quot;<a href="#fc_err_str">fc_err_str</a>&quot; fetch for a full list of
error codes and their corresponding error message.
</pre><a class="anchor" name="fc_err_name"></a><a class="anchor" name="7-fc_err_name"></a><a class="anchor" name="7.3.3-fc_err_name"></a><a class="anchor" name="fc_err_name (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_err_name (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_err_name"></a><a href="#7.3.3-fc_err_name">fc_err_name</a></b> : string</div><pre class="text">Returns the internal error name describing what problem happened on the
frontend connection, resulting in a connection failure. This string is made
of a single word and is empty when no error is present. It corresponds to the
&quot;<a href="#name">name</a>&quot; column in the table presented in the &quot;<a href="#fc_err_str">fc_err_str</a>&quot; keyword.
</pre><a class="anchor" name="fc_err_str"></a><a class="anchor" name="7-fc_err_str"></a><a class="anchor" name="7.3.3-fc_err_str"></a><a class="anchor" name="fc_err_str (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_err_str (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_err_str"></a><a href="#7.3.3-fc_err_str">fc_err_str</a></b> : string</div><pre class="text">Returns an error message describing what problem happened on the current
connection, resulting in a connection failure. This string corresponds to the
&quot;message&quot; part of the error log format (see <a href="#8.2.5">section 8.2.5</a>). See below for a
full list of error codes and their corresponding error messages :

+----+------------------+-------------------------------------------------------------------------+
| ID | name             | message                                                                 |
+----+------------------+-------------------------------------------------------------------------+
| 0  | -                | &quot;Success&quot;                                                               |
| 1  | CONF_FDLIM       | &quot;Reached configured maxconn value&quot;                                      |
| 2  | PROC_FDLIM       | &quot;Too many sockets on the process&quot;                                       |
| 3  | SYS_FDLIM        | &quot;Too many sockets on the system&quot;                                        |
| 4  | SYS_MEMLIM       | &quot;Out of system buffers&quot;                                                 |
| 5  | NOPROTO          | &quot;Protocol or address family not supported&quot;                              |
| 6  | SOCK_ERR         | &quot;General socket error&quot;                                                  |
| 7  | PORT_RANGE       | &quot;Source port range exhausted&quot;                                           |
| 8  | CANT_BIND        | &quot;Can't bind to source address&quot;                                          |
| 9  | FREE_PORTS       | &quot;Out of local source ports on the system&quot;                               |
| 10 | ADDR_INUSE       | &quot;Local source address already in use&quot;                                   |
| 11 | PRX_EMPTY        | &quot;Connection closed while waiting for PROXY protocol header&quot;             |
| 12 | PRX_ABORT        | &quot;Connection error while waiting for PROXY protocol header&quot;              |
| 13 | PRX_TIMEOUT      | &quot;Timeout while waiting for PROXY protocol header&quot;                       |
| 14 | PRX_TRUNCATED    | &quot;Truncated PROXY protocol header received&quot;                              |
| 15 | PRX_NOT_HDR      | &quot;Received something which does not look like a PROXY protocol header&quot;   |
| 16 | PRX_BAD_HDR      | &quot;Received an invalid PROXY protocol header&quot;                             |
| 17 | PRX_BAD_PROTO    | &quot;Received an unhandled protocol in the PROXY protocol header&quot;           |
| 18 | CIP_EMPTY        | &quot;Connection closed while waiting for NetScaler Client IP header&quot;        |
| 19 | CIP_ABORT        | &quot;Connection error while waiting for NetScaler Client IP header&quot;         |
| 20 | CIP_TIMEOUT      | &quot;Timeout while waiting for a NetScaler Client IP header&quot;                |
| 21 | CIP_TRUNCATED    | &quot;Truncated NetScaler Client IP header received&quot;                         |
| 22 | CIP_BAD_MAGIC    | &quot;Received an invalid NetScaler Client IP magic number&quot;                  |
| 23 | CIP_BAD_PROTO    | &quot;Received an unhandled protocol in the NetScaler Client IP header&quot;      |
| 24 | SSL_EMPTY        | &quot;Connection closed during SSL handshake&quot;                                |
| 25 | SSL_ABORT        | &quot;Connection error during SSL handshake&quot;                                 |
| 26 | SSL_TIMEOUT      | &quot;Timeout during SSL handshake&quot;                                          |
| 27 | SSL_TOO_MANY     | &quot;Too many SSL connections&quot;                                              |
| 28 | SSL_NO_MEM       | &quot;Out of memory when initializing an SSL connection&quot;                     |
| 29 | SSL_RENEG        | &quot;Rejected a client-initiated SSL renegotiation attempt&quot;                 |
| 30 | SSL_CA_FAIL      | &quot;SSL client CA chain cannot be verified&quot;                                |
| 31 | SSL_CRT_FAIL     | &quot;SSL client certificate not trusted&quot;                                    |
| 32 | SSL_MISMATCH     | &quot;Server presented an SSL certificate different from the configured one&quot; |
| 33 | SSL_MISMATCH_SNI | &quot;Server presented an SSL certificate different from the expected one&quot;   |
| 34 | SSL_HANDSHAKE    | &quot;SSL handshake failure&quot;                                                 |
| 35 | SSL_HANDSHAKE_HB | &quot;SSL handshake failure after heartbeat&quot;                                 |
| 36 | SSL_KILLED_HB    | &quot;Stopped a TLSv1 heartbeat attack (CVE-2014-0160)&quot;                      |
| 37 | SSL_NO_TARGET    | &quot;Attempt to use SSL on an unknown target (internal error)&quot;              |
| 38 | SSL_EARLY_FAILED | &quot;Server refused early data&quot;                                             |
| 39 | SOCKS4_SEND      | &quot;SOCKS4 Proxy write error during handshake&quot;                             |
| 40 | SOCKS4_RECV      | &quot;SOCKS4 Proxy read error during handshake&quot;                              |
| 41 | SOCKS4_DENY      | &quot;SOCKS4 Proxy deny the request&quot;                                         |
| 42 | SOCKS4_ABORT     | &quot;SOCKS4 Proxy handshake aborted by server&quot;                              |
| 43 | SSL_FATAL        | &quot;SSL fatal error&quot;                                                       |
| 44 | REVERSE          | &quot;Reverse connect failure&quot;                                               |
| 45 | POLLERR          | &quot;Poller reported POLLERR&quot;                                               |
| 46 | EREFUSED         | &quot;ECONNREFUSED returned by OS&quot;                                           |
| 47 | ERESET           | &quot;ECONNRESET returned by OS&quot;                                             |
| 48 | EUNREACH         | &quot;ENETUNREACH returned by OS&quot;                                            |
| 49 | ENOMEM           | &quot;ENOMEM returned by OS&quot;                                                 |
| 50 | EBADF            | &quot;EBADF returned by OS&quot;                                                  |
| 51 | EFAULT           | &quot;EFAULT returned by OS&quot;                                                 |
| 52 | EINVAL           | &quot;EINVAL returned by OS&quot;                                                 |
| 53 | ENCONN           | &quot;ENCONN returned by OS&quot;                                                 |
| 54 | ENSOCK           | &quot;ENSOCK returned by OS&quot;                                                 |
| 55 | ENOBUFS          | &quot;ENOBUFS returned by OS&quot;                                                |
| 56 | EPIPE            | &quot;EPIPE returned by OS&quot;                                                  |
+----+------------------+-------------------------------------------------------------------------+
</pre><a class="anchor" name="fc_fackets"></a><a class="anchor" name="7-fc_fackets"></a><a class="anchor" name="7.3.3-fc_fackets"></a><a class="anchor" name="fc_fackets (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_fackets (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_fackets"></a><a href="#7.3.3-fc_fackets">fc_fackets</a></b> : integer</div><pre class="text">Returns the fack counter measured by the kernel for the client
connection. If the server connection is not established, if the connection is
not TCP or if the operating system does not support TCP_INFO, for example
Linux kernels before 2.4, the sample fetch fails.
</pre><a class="anchor" name="fc_glitches"></a><a class="anchor" name="7-fc_glitches"></a><a class="anchor" name="7.3.3-fc_glitches"></a><a class="anchor" name="fc_glitches (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_glitches (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_glitches"></a><a href="#7.3.3-fc_glitches">fc_glitches</a></b> : integer</div><pre class="text">Returns the number of protocol glitches counted on the frontend connection.
These generally cover protocol violations as well as small anomalies that
generally indicate a bogus or misbehaving client that may cause trouble in
the infrastructure, such as excess of errors in the logs, or many connections
being aborted early, inducing frequent TLS renegotiations. These may also be
caused by too large requests that cannot fit into a single buffer, explaining
HTTP 400 errors. Ideally this number should remain zero, though it may be
possible that some browsers playing with the protocol boundaries trigger it
once in a while. These values should normally not be considered as alarming
(especially small ones), though a sudden jump may indicate an anomaly
somewhere. Large values (i.e. hundreds to thousands per connection, or as
many as the requests) may indicate a purposely built client that is trying to
fingerprint or attack the protocol stack. Not all protocol multiplexers
measure this metric, and the only way to get more details about the events is
to enable traces to capture all exchanges.
</pre><a class="anchor" name="fc_http_major"></a><a class="anchor" name="7-fc_http_major"></a><a class="anchor" name="7.3.3-fc_http_major"></a><a class="anchor" name="fc_http_major (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_http_major (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_http_major"></a><a href="#7.3.3-fc_http_major">fc_http_major</a></b> : integer</div><pre class="text">Reports the front connection's HTTP major version encoding, which may be 1
for HTTP/0.9 to HTTP/1.1 or 2 for HTTP/2. Note, this is based on the on-wire
encoding and not on the version present in the request header.
</pre><a class="anchor" name="fc_lost"></a><a class="anchor" name="7-fc_lost"></a><a class="anchor" name="7.3.3-fc_lost"></a><a class="anchor" name="fc_lost (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_lost (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_lost"></a><a href="#7.3.3-fc_lost">fc_lost</a></b> : integer</div><pre class="text">If the connection is not TCP, nor QUIC, the sample fetch fails.
For QUIC, returns the number of lost QUIC packets by the client connection.
For TCP, returns the lost counter measured by the kernel for the client
connection. If the server connection is not established, or if the operating
system does not support TCP_INFO, for example Linux kernels before 2.4, the
sample fetch fails.
</pre><a class="anchor" name="fc_nb_streams"></a><a class="anchor" name="7-fc_nb_streams"></a><a class="anchor" name="7.3.3-fc_nb_streams"></a><a class="anchor" name="fc_nb_streams (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_nb_streams (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_nb_streams"></a><a href="#7.3.3-fc_nb_streams">fc_nb_streams</a></b> : integer</div><pre class="text">Returns the number of streams opened on the frontend connection.
</pre><a class="anchor" name="fc_pp_authority"></a><a class="anchor" name="7-fc_pp_authority"></a><a class="anchor" name="7.3.3-fc_pp_authority"></a><a class="anchor" name="fc_pp_authority (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_pp_authority (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_pp_authority"></a><a href="#7.3.3-fc_pp_authority">fc_pp_authority</a></b> : string</div><pre class="text">Returns the first authority TLV sent by the client in the PROXY protocol
header, if any.
</pre><a class="anchor" name="fc_pp_unique_id"></a><a class="anchor" name="7-fc_pp_unique_id"></a><a class="anchor" name="7.3.3-fc_pp_unique_id"></a><a class="anchor" name="fc_pp_unique_id (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_pp_unique_id (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_pp_unique_id"></a><a href="#7.3.3-fc_pp_unique_id">fc_pp_unique_id</a></b> : string</div><pre class="text">Returns the first unique ID TLV sent by the client in the PROXY protocol
header, if any.
</pre><a class="anchor" name="fc_pp_tlv"></a><a class="anchor" name="7-fc_pp_tlv"></a><a class="anchor" name="7.3.3-fc_pp_tlv"></a><a class="anchor" name="fc_pp_tlv (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_pp_tlv (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_pp_tlv"></a><a href="#7.3.3-fc_pp_tlv">fc_pp_tlv</a></b>(<span style="color: #080">&lt;id&gt;</span>) : string</div><pre class="text">Returns the TLV value for the given TLV ID. The ID must either be a numeric
value between 0 and 255 or one of the following supported symbolic names
that correspond to the TLV constant suffixes in the PPv2 spec:
&quot;ALPN&quot;: PP2_TYPE_ALPN, &quot;AUTHORITY&quot;: PP2_TYPE_AUTHORITY,
&quot;CRC32&quot;: PP2_TYPE_CRC32C, &quot;NETNS&quot;: PP2_TYPE_NETNS, &quot;NOOP: PP2_TYPE_NOOP&quot;,
&quot;SSL&quot;: PP2_TYPE_SSL, &quot;SSL_CIPHER&quot;: PP2_SUBTYPE_SSL_CIPHER,
&quot;SSL_CN&quot;: PP2_SUBTYPE_SSL_CN, &quot;SSL_KEY_ALG&quot;: PP2_SUBTYPE_SSL_KEY_ALG,
&quot;SSL_SIG_ALG&quot;: PP2_SUBTYPE_SSL_SIG_ALG,
&quot;SSL_VERSION&quot;: PP2_SUBTYPE_SSL_VERSION, &quot;UNIQUE_ID&quot;: PP2_TYPE_UNIQUE_ID.

The received value must be smaller or equal to 1024 bytes. This is done to
prevent potential DoS attacks. Values smaller or equal to 256 bytes will be
able to be memory pooled. Therefore, try to restrict the length of sent
values to 256 bytes for optimal performance.

Note that unlike fc_pp_authority and fc_pp_unique_id, fc_pp_tlv is able to
iterate over all occurrences of a requested TLV in case there are duplicate
TLV IDs. The order of iteration matches the position in the PROXY protocol
header. However, relying on duplicates should mostly be avoided as TLVs are
typically assumed to be unique. Generally, finding duplicated TLV IDs
indicates an error on the sender side of the PROXY protocol header.
</pre><a class="anchor" name="fc_rcvd_proxy"></a><a class="anchor" name="7-fc_rcvd_proxy"></a><a class="anchor" name="7.3.3-fc_rcvd_proxy"></a><a class="anchor" name="fc_rcvd_proxy (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_rcvd_proxy (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_rcvd_proxy"></a><a href="#7.3.3-fc_rcvd_proxy">fc_rcvd_proxy</a></b> : boolean</div><pre class="text">Returns true if the client initiated the connection with a PROXY protocol
header.
</pre><a class="anchor" name="fc_reordering"></a><a class="anchor" name="7-fc_reordering"></a><a class="anchor" name="7.3.3-fc_reordering"></a><a class="anchor" name="fc_reordering (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_reordering (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_reordering"></a><a href="#7.3.3-fc_reordering">fc_reordering</a></b> : integer</div><pre class="text">If the connection is not TCP, nor QUIC, the sample fetch fails.
For QUIC, return the number of QUIC reordered packets for the client connection.
For TCP, returns the reordering counter measured by the kernel for the client
connection. If the server connection is not established, or if the operating
system does not support TCP_INFO, for example Linux kernels before 2.4, the
sample fetch fails.
</pre><a class="anchor" name="fc_retrans"></a><a class="anchor" name="7-fc_retrans"></a><a class="anchor" name="7.3.3-fc_retrans"></a><a class="anchor" name="fc_retrans (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_retrans (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_retrans"></a><a href="#7.3.3-fc_retrans">fc_retrans</a></b> : integer</div><pre class="text">Returns the retransmits counter measured by the kernel for the client
connection. If the server connection is not established, if the connection is
not TCP or if the operating system does not support TCP_INFO, for example
Linux kernels before 2.4, the sample fetch fails.
</pre><a class="anchor" name="fc_rtt"></a><a class="anchor" name="7-fc_rtt"></a><a class="anchor" name="7.3.3-fc_rtt"></a><a class="anchor" name="fc_rtt (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_rtt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_rtt"></a><a href="#7.3.3-fc_rtt">fc_rtt</a></b>(<span style="color: #080">&lt;unit&gt;</span>) : integer</div><pre class="text">If the connection is not TCP, nor QUIC, the sample fetch fails.
For QUIC, returns Smoothed Round Trip Time for the client connection.
For TCP, returns the Round Trip Time (RTT) measured by the kernel for the client
connection. &lt;unit&gt; is facultative, by default the unit is milliseconds. &lt;unit&gt;
can be set to &quot;ms&quot; for milliseconds or &quot;us&quot; for microseconds. If the server
connection is not established, or if the operating system does not support
TCP_INFO, for example Linux kernels before 2.4, the sample fetch fails.
</pre><a class="anchor" name="fc_rttvar"></a><a class="anchor" name="7-fc_rttvar"></a><a class="anchor" name="7.3.3-fc_rttvar"></a><a class="anchor" name="fc_rttvar (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_rttvar (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_rttvar"></a><a href="#7.3.3-fc_rttvar">fc_rttvar</a></b>(<span style="color: #080">&lt;unit&gt;</span>) : integer</div><pre class="text">If the connection is not TCP, nor QUIC, the sample fetch fails.
For QUIC, returns Smoothed Round Trip Time variance for the client connection.
For TCP, returns the Round Trip Time (RTT) variance measured by the kernel for
the client connection. &lt;unit&gt; is facultative, by default the unit is milliseconds.
&lt;unit&gt; can be set to &quot;ms&quot; for milliseconds or &quot;us&quot; for microseconds. If the
server connection is not established, or if the operating system does not
support TCP_INFO, for example Linux kernels before 2.4, the sample fetch fails.
</pre><a class="anchor" name="fc_sacked"></a><a class="anchor" name="7-fc_sacked"></a><a class="anchor" name="7.3.3-fc_sacked"></a><a class="anchor" name="fc_sacked (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_sacked (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_sacked"></a><a href="#7.3.3-fc_sacked">fc_sacked</a></b> : integer</div><pre class="text">Returns the sacked counter measured by the kernel for the client connection.
If the server connection is not established, if the connection is not TCP or
if the operating system does not support TCP_INFO, for example Linux kernels
before 2.4, the sample fetch fails.
</pre><a class="anchor" name="fc_src"></a><a class="anchor" name="7-fc_src"></a><a class="anchor" name="7.3.3-fc_src"></a><a class="anchor" name="fc_src (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_src (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_src"></a><a href="#7.3.3-fc_src">fc_src</a></b> : ip</div><pre class="text">This is the original source IP address of the connection on the client side
Only &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; rules may alter this address. See &quot;<a href="#src">src</a>&quot; for
details.
</pre><a class="anchor" name="fc_src_is_local"></a><a class="anchor" name="7-fc_src_is_local"></a><a class="anchor" name="7.3.3-fc_src_is_local"></a><a class="anchor" name="fc_src_is_local (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_src_is_local (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_src_is_local"></a><a href="#7.3.3-fc_src_is_local">fc_src_is_local</a></b> : boolean</div><pre class="text">Returns true if the source address of incoming connection is local to the
system, or false if the address doesn't exist on the system. See
&quot;<a href="#src_is_local">src_is_local</a>&quot; for details.
</pre><a class="anchor" name="fc_src_port"></a><a class="anchor" name="7-fc_src_port"></a><a class="anchor" name="7.3.3-fc_src_port"></a><a class="anchor" name="fc_src_port (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_src_port (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_src_port"></a><a href="#7.3.3-fc_src_port">fc_src_port</a></b> : integer</div><pre class="text">Returns an integer value corresponding to the TCP source port of the
connection on the client side. Only &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; rules may alter
this address. See &quot;src-port&quot; for details.
</pre><a class="anchor" name="fc_settings_streams_limit"></a><a class="anchor" name="7-fc_settings_streams_limit"></a><a class="anchor" name="7.3.3-fc_settings_streams_limit"></a><a class="anchor" name="fc_settings_streams_limit (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_settings_streams_limit (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_settings_streams_limit"></a><a href="#7.3.3-fc_settings_streams_limit">fc_settings_streams_limit</a></b> : integer</div><pre class="text">Returns the maximum number of streams allowed on the frontend connection. For
TCP and HTTP/1.1 connections, it is always 1. For other protocols, it depends
on the settings negotiated with the client.
</pre><a class="anchor" name="fc_unacked"></a><a class="anchor" name="7-fc_unacked"></a><a class="anchor" name="7.3.3-fc_unacked"></a><a class="anchor" name="fc_unacked (Using ACLs and fetching samples)"></a><a class="anchor" name="fc_unacked (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fc_unacked"></a><a href="#7.3.3-fc_unacked">fc_unacked</a></b> : integer</div><pre class="text">Returns the unacked counter measured by the kernel for the client connection.
If the server connection is not established, if the connection is not TCP or
if the operating system does not support TCP_INFO, for example Linux kernels
before 2.4, the sample fetch fails.
</pre><a class="anchor" name="fe_defbe"></a><a class="anchor" name="7-fe_defbe"></a><a class="anchor" name="7.3.3-fe_defbe"></a><a class="anchor" name="fe_defbe (Using ACLs and fetching samples)"></a><a class="anchor" name="fe_defbe (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fe_defbe"></a><a href="#7.3.3-fe_defbe">fe_defbe</a></b> : string</div><pre class="text">Returns a string containing the frontend's default backend name. It can be
used in frontends to check which backend will handle requests by default.
</pre><a class="anchor" name="fe_id"></a><a class="anchor" name="7-fe_id"></a><a class="anchor" name="7.3.3-fe_id"></a><a class="anchor" name="fe_id (Using ACLs and fetching samples)"></a><a class="anchor" name="fe_id (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fe_id"></a><a href="#7.3.3-fe_id">fe_id</a></b> : integer</div><pre class="text">Returns an integer containing the current frontend's id. It can be used in
backends to check from which frontend it was called, or to stick all users
coming via a same frontend to the same server.
</pre><a class="anchor" name="fe_name"></a><a class="anchor" name="7-fe_name"></a><a class="anchor" name="7.3.3-fe_name"></a><a class="anchor" name="fe_name (Using ACLs and fetching samples)"></a><a class="anchor" name="fe_name (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fe_name"></a><a href="#7.3.3-fe_name">fe_name</a></b> : string</div><pre class="text">Returns a string containing the current frontend's name. It can be used in
backends to check from which frontend it was called, or to stick all users
coming via a same frontend to the same server.
</pre><a class="anchor" name="fe_client_timeout"></a><a class="anchor" name="7-fe_client_timeout"></a><a class="anchor" name="7.3.3-fe_client_timeout"></a><a class="anchor" name="fe_client_timeout (Using ACLs and fetching samples)"></a><a class="anchor" name="fe_client_timeout (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="fe_client_timeout"></a><a href="#7.3.3-fe_client_timeout">fe_client_timeout</a></b> : integer</div><pre class="text">Returns the configuration value in millisecond for the client timeout of the
current frontend. This timeout can be overwritten by a &quot;<a href="#set-timeout">set-timeout</a>&quot; rule.
</pre><a class="anchor" name="res.timer.data"></a><a class="anchor" name="7-res.timer.data"></a><a class="anchor" name="7.3.3-res.timer.data"></a><a class="anchor" name="res.timer.data (Using ACLs and fetching samples)"></a><a class="anchor" name="res.timer.data (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="res.timer.data"></a><a href="#7.3.3-res.timer.data">res.timer.data</a></b> : integer</div><pre class="text">this is the total transfer time of the response payload till the last byte
sent to the client. In HTTP it starts after the last response header (after
Tr). This is the equivalent of %Td in the log-format and is reported in
milliseconds (ms).  For more information see Section 8.4 &quot;Timing events&quot;
</pre><a class="anchor" name="sc_bytes_in_rate"></a><a class="anchor" name="7-sc_bytes_in_rate"></a><a class="anchor" name="7.3.3-sc_bytes_in_rate"></a><a class="anchor" name="sc_bytes_in_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_bytes_in_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_bytes_in_rate"></a><a href="#7.3.3-sc_bytes_in_rate">sc_bytes_in_rate</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_bytes_in_rate"></a><a class="anchor" name="7-sc0_bytes_in_rate"></a><a class="anchor" name="7.3.3-sc0_bytes_in_rate"></a><a class="anchor" name="sc0_bytes_in_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_bytes_in_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_bytes_in_rate"></a><a href="#7.3.3-sc0_bytes_in_rate">sc0_bytes_in_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_bytes_in_rate"></a><a class="anchor" name="7-sc1_bytes_in_rate"></a><a class="anchor" name="7.3.3-sc1_bytes_in_rate"></a><a class="anchor" name="sc1_bytes_in_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_bytes_in_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_bytes_in_rate"></a><a href="#7.3.3-sc1_bytes_in_rate">sc1_bytes_in_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_bytes_in_rate"></a><a class="anchor" name="7-sc2_bytes_in_rate"></a><a class="anchor" name="7.3.3-sc2_bytes_in_rate"></a><a class="anchor" name="sc2_bytes_in_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_bytes_in_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_bytes_in_rate"></a><a href="#7.3.3-sc2_bytes_in_rate">sc2_bytes_in_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average client-to-server bytes rate from the currently tracked
counters, measured in amount of bytes over the period configured in the
table. See also src_bytes_in_rate.
</pre><a class="anchor" name="sc_bytes_out_rate"></a><a class="anchor" name="7-sc_bytes_out_rate"></a><a class="anchor" name="7.3.3-sc_bytes_out_rate"></a><a class="anchor" name="sc_bytes_out_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_bytes_out_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_bytes_out_rate"></a><a href="#7.3.3-sc_bytes_out_rate">sc_bytes_out_rate</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_bytes_out_rate"></a><a class="anchor" name="7-sc0_bytes_out_rate"></a><a class="anchor" name="7.3.3-sc0_bytes_out_rate"></a><a class="anchor" name="sc0_bytes_out_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_bytes_out_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_bytes_out_rate"></a><a href="#7.3.3-sc0_bytes_out_rate">sc0_bytes_out_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_bytes_out_rate"></a><a class="anchor" name="7-sc1_bytes_out_rate"></a><a class="anchor" name="7.3.3-sc1_bytes_out_rate"></a><a class="anchor" name="sc1_bytes_out_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_bytes_out_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_bytes_out_rate"></a><a href="#7.3.3-sc1_bytes_out_rate">sc1_bytes_out_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_bytes_out_rate"></a><a class="anchor" name="7-sc2_bytes_out_rate"></a><a class="anchor" name="7.3.3-sc2_bytes_out_rate"></a><a class="anchor" name="sc2_bytes_out_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_bytes_out_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_bytes_out_rate"></a><a href="#7.3.3-sc2_bytes_out_rate">sc2_bytes_out_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average server-to-client bytes rate from the currently tracked
counters, measured in amount of bytes over the period configured in the
table. See also src_bytes_out_rate.
</pre><a class="anchor" name="sc_clr_gpc"></a><a class="anchor" name="7-sc_clr_gpc"></a><a class="anchor" name="7.3.3-sc_clr_gpc"></a><a class="anchor" name="sc_clr_gpc (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_clr_gpc (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_clr_gpc"></a><a href="#7.3.3-sc_clr_gpc">sc_clr_gpc</a></b>(<span style="color: #080">&lt;idx&gt;</span>,<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Clears the General Purpose Counter at the index &lt;idx&gt; of the array
associated to the designated tracked counter of ID &lt;ctr&gt; from current
proxy's stick table or from the designated stick-table &lt;table&gt;, and
returns its previous value. &lt;idx&gt; is an integer between 0 and 99 and
&lt;ctr&gt; an integer between 0 and 2.
Before the first invocation, the stored value is zero, so first invocation
will always return zero.
This fetch applies only to the 'gpc' array data_type (and not to the legacy
'gpc0' nor 'gpc1' data_types).
</pre><a class="anchor" name="sc_clr_gpc0"></a><a class="anchor" name="7-sc_clr_gpc0"></a><a class="anchor" name="7.3.3-sc_clr_gpc0"></a><a class="anchor" name="sc_clr_gpc0 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_clr_gpc0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_clr_gpc0"></a><a href="#7.3.3-sc_clr_gpc0">sc_clr_gpc0</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_clr_gpc0"></a><a class="anchor" name="7-sc0_clr_gpc0"></a><a class="anchor" name="7.3.3-sc0_clr_gpc0"></a><a class="anchor" name="sc0_clr_gpc0 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_clr_gpc0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_clr_gpc0"></a><a href="#7.3.3-sc0_clr_gpc0">sc0_clr_gpc0</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_clr_gpc0"></a><a class="anchor" name="7-sc1_clr_gpc0"></a><a class="anchor" name="7.3.3-sc1_clr_gpc0"></a><a class="anchor" name="sc1_clr_gpc0 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_clr_gpc0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_clr_gpc0"></a><a href="#7.3.3-sc1_clr_gpc0">sc1_clr_gpc0</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_clr_gpc0"></a><a class="anchor" name="7-sc2_clr_gpc0"></a><a class="anchor" name="7.3.3-sc2_clr_gpc0"></a><a class="anchor" name="sc2_clr_gpc0 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_clr_gpc0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_clr_gpc0"></a><a href="#7.3.3-sc2_clr_gpc0">sc2_clr_gpc0</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Clears the first General Purpose Counter associated to the currently tracked
counters, and returns its previous value. Before the first invocation, the
stored value is zero, so first invocation will always return zero. This is
typically used as a second ACL in an expression in order to mark a connection
when a first ACL was verified :
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># block if 5 consecutive requests continue to come faster than 10 sess</span>
<span class="comment"># per second, and reset the counter as soon as the traffic slows down.</span>
acl abuse sc0_http_req_rate gt 10
acl kill  sc0_inc_gpc0 gt 5
acl save  sc0_clr_gpc0 ge 0
tcp-request connection accept if !abuse save
tcp-request connection reject if abuse kill
</code></pre>
</div><a class="anchor" name="sc_clr_gpc1"></a><a class="anchor" name="7-sc_clr_gpc1"></a><a class="anchor" name="7.3.3-sc_clr_gpc1"></a><a class="anchor" name="sc_clr_gpc1 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_clr_gpc1 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_clr_gpc1"></a><a href="#7.3.3-sc_clr_gpc1">sc_clr_gpc1</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_clr_gpc1"></a><a class="anchor" name="7-sc0_clr_gpc1"></a><a class="anchor" name="7.3.3-sc0_clr_gpc1"></a><a class="anchor" name="sc0_clr_gpc1 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_clr_gpc1 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_clr_gpc1"></a><a href="#7.3.3-sc0_clr_gpc1">sc0_clr_gpc1</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_clr_gpc1"></a><a class="anchor" name="7-sc1_clr_gpc1"></a><a class="anchor" name="7.3.3-sc1_clr_gpc1"></a><a class="anchor" name="sc1_clr_gpc1 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_clr_gpc1 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_clr_gpc1"></a><a href="#7.3.3-sc1_clr_gpc1">sc1_clr_gpc1</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_clr_gpc1"></a><a class="anchor" name="7-sc2_clr_gpc1"></a><a class="anchor" name="7.3.3-sc2_clr_gpc1"></a><a class="anchor" name="sc2_clr_gpc1 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_clr_gpc1 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_clr_gpc1"></a><a href="#7.3.3-sc2_clr_gpc1">sc2_clr_gpc1</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Clears the second General Purpose Counter associated to the currently tracked
counters, and returns its previous value. Before the first invocation, the
stored value is zero, so first invocation will always return zero. This is
typically used as a second ACL in an expression in order to mark a connection
when a first ACL was verified.
</pre><a class="anchor" name="sc_conn_cnt"></a><a class="anchor" name="7-sc_conn_cnt"></a><a class="anchor" name="7.3.3-sc_conn_cnt"></a><a class="anchor" name="sc_conn_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_conn_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_conn_cnt"></a><a href="#7.3.3-sc_conn_cnt">sc_conn_cnt</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_conn_cnt"></a><a class="anchor" name="7-sc0_conn_cnt"></a><a class="anchor" name="7.3.3-sc0_conn_cnt"></a><a class="anchor" name="sc0_conn_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_conn_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_conn_cnt"></a><a href="#7.3.3-sc0_conn_cnt">sc0_conn_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_conn_cnt"></a><a class="anchor" name="7-sc1_conn_cnt"></a><a class="anchor" name="7.3.3-sc1_conn_cnt"></a><a class="anchor" name="sc1_conn_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_conn_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_conn_cnt"></a><a href="#7.3.3-sc1_conn_cnt">sc1_conn_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_conn_cnt"></a><a class="anchor" name="7-sc2_conn_cnt"></a><a class="anchor" name="7.3.3-sc2_conn_cnt"></a><a class="anchor" name="sc2_conn_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_conn_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_conn_cnt"></a><a href="#7.3.3-sc2_conn_cnt">sc2_conn_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the cumulative number of incoming connections from currently tracked
counters. See also src_conn_cnt.
</pre><a class="anchor" name="sc_conn_cur"></a><a class="anchor" name="7-sc_conn_cur"></a><a class="anchor" name="7.3.3-sc_conn_cur"></a><a class="anchor" name="sc_conn_cur (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_conn_cur (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_conn_cur"></a><a href="#7.3.3-sc_conn_cur">sc_conn_cur</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_conn_cur"></a><a class="anchor" name="7-sc0_conn_cur"></a><a class="anchor" name="7.3.3-sc0_conn_cur"></a><a class="anchor" name="sc0_conn_cur (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_conn_cur (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_conn_cur"></a><a href="#7.3.3-sc0_conn_cur">sc0_conn_cur</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_conn_cur"></a><a class="anchor" name="7-sc1_conn_cur"></a><a class="anchor" name="7.3.3-sc1_conn_cur"></a><a class="anchor" name="sc1_conn_cur (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_conn_cur (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_conn_cur"></a><a href="#7.3.3-sc1_conn_cur">sc1_conn_cur</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_conn_cur"></a><a class="anchor" name="7-sc2_conn_cur"></a><a class="anchor" name="7.3.3-sc2_conn_cur"></a><a class="anchor" name="sc2_conn_cur (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_conn_cur (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_conn_cur"></a><a href="#7.3.3-sc2_conn_cur">sc2_conn_cur</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the current amount of concurrent connections tracking the same
tracked counters. This number is automatically incremented when tracking
begins and decremented when tracking stops. See also src_conn_cur.
</pre><a class="anchor" name="sc_conn_rate"></a><a class="anchor" name="7-sc_conn_rate"></a><a class="anchor" name="7.3.3-sc_conn_rate"></a><a class="anchor" name="sc_conn_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_conn_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_conn_rate"></a><a href="#7.3.3-sc_conn_rate">sc_conn_rate</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_conn_rate"></a><a class="anchor" name="7-sc0_conn_rate"></a><a class="anchor" name="7.3.3-sc0_conn_rate"></a><a class="anchor" name="sc0_conn_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_conn_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_conn_rate"></a><a href="#7.3.3-sc0_conn_rate">sc0_conn_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_conn_rate"></a><a class="anchor" name="7-sc1_conn_rate"></a><a class="anchor" name="7.3.3-sc1_conn_rate"></a><a class="anchor" name="sc1_conn_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_conn_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_conn_rate"></a><a href="#7.3.3-sc1_conn_rate">sc1_conn_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_conn_rate"></a><a class="anchor" name="7-sc2_conn_rate"></a><a class="anchor" name="7.3.3-sc2_conn_rate"></a><a class="anchor" name="sc2_conn_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_conn_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_conn_rate"></a><a href="#7.3.3-sc2_conn_rate">sc2_conn_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average connection rate from the currently tracked counters,
measured in amount of connections over the period configured in the table.
See also src_conn_rate.
</pre><a class="anchor" name="sc_get_gpc"></a><a class="anchor" name="7-sc_get_gpc"></a><a class="anchor" name="7.3.3-sc_get_gpc"></a><a class="anchor" name="sc_get_gpc (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_get_gpc (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_get_gpc"></a><a href="#7.3.3-sc_get_gpc">sc_get_gpc</a></b>(<span style="color: #080">&lt;idx&gt;</span>,<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the value of the General Purpose Counter at the index &lt;idx&gt;
in the GPC array and associated to the currently tracked counter of
ID &lt;ctr&gt; from the current proxy's stick-table or from the designated
stick-table &lt;table&gt;. &lt;idx&gt; is an integer between 0 and 99 and
&lt;ctr&gt; an integer between 0 and 2. If there is not gpc stored at this
index, zero is returned.
This fetch applies only to the 'gpc' array data_type (and not to the legacy
'gpc0' nor 'gpc1' data_types). See also src_get_gpc and sc_inc_gpc.
</pre><a class="anchor" name="sc_get_gpc0"></a><a class="anchor" name="7-sc_get_gpc0"></a><a class="anchor" name="7.3.3-sc_get_gpc0"></a><a class="anchor" name="sc_get_gpc0 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_get_gpc0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_get_gpc0"></a><a href="#7.3.3-sc_get_gpc0">sc_get_gpc0</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_get_gpc0"></a><a class="anchor" name="7-sc0_get_gpc0"></a><a class="anchor" name="7.3.3-sc0_get_gpc0"></a><a class="anchor" name="sc0_get_gpc0 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_get_gpc0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_get_gpc0"></a><a href="#7.3.3-sc0_get_gpc0">sc0_get_gpc0</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_get_gpc0"></a><a class="anchor" name="7-sc1_get_gpc0"></a><a class="anchor" name="7.3.3-sc1_get_gpc0"></a><a class="anchor" name="sc1_get_gpc0 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_get_gpc0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_get_gpc0"></a><a href="#7.3.3-sc1_get_gpc0">sc1_get_gpc0</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_get_gpc0"></a><a class="anchor" name="7-sc2_get_gpc0"></a><a class="anchor" name="7.3.3-sc2_get_gpc0"></a><a class="anchor" name="sc2_get_gpc0 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_get_gpc0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_get_gpc0"></a><a href="#7.3.3-sc2_get_gpc0">sc2_get_gpc0</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the value of the first General Purpose Counter associated to the
currently tracked counters. See also src_get_gpc0 and sc/sc0/sc1/sc2_inc_gpc0.
</pre><a class="anchor" name="sc_get_gpc1"></a><a class="anchor" name="7-sc_get_gpc1"></a><a class="anchor" name="7.3.3-sc_get_gpc1"></a><a class="anchor" name="sc_get_gpc1 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_get_gpc1 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_get_gpc1"></a><a href="#7.3.3-sc_get_gpc1">sc_get_gpc1</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_get_gpc1"></a><a class="anchor" name="7-sc0_get_gpc1"></a><a class="anchor" name="7.3.3-sc0_get_gpc1"></a><a class="anchor" name="sc0_get_gpc1 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_get_gpc1 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_get_gpc1"></a><a href="#7.3.3-sc0_get_gpc1">sc0_get_gpc1</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_get_gpc1"></a><a class="anchor" name="7-sc1_get_gpc1"></a><a class="anchor" name="7.3.3-sc1_get_gpc1"></a><a class="anchor" name="sc1_get_gpc1 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_get_gpc1 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_get_gpc1"></a><a href="#7.3.3-sc1_get_gpc1">sc1_get_gpc1</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_get_gpc1"></a><a class="anchor" name="7-sc2_get_gpc1"></a><a class="anchor" name="7.3.3-sc2_get_gpc1"></a><a class="anchor" name="sc2_get_gpc1 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_get_gpc1 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_get_gpc1"></a><a href="#7.3.3-sc2_get_gpc1">sc2_get_gpc1</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the value of the second General Purpose Counter associated to the
currently tracked counters. See also src_get_gpc1 and sc/sc0/sc1/sc2_inc_gpc1.
</pre><a class="anchor" name="sc_get_gpt"></a><a class="anchor" name="7-sc_get_gpt"></a><a class="anchor" name="7.3.3-sc_get_gpt"></a><a class="anchor" name="sc_get_gpt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_get_gpt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_get_gpt"></a><a href="#7.3.3-sc_get_gpt">sc_get_gpt</a></b>(<span style="color: #080">&lt;idx&gt;</span>,<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the value of the first General Purpose Tag at the index &lt;idx&gt; of
the array associated to the tracked counter of ID &lt;ctr&gt; and from the
current proxy's sitck-table or the designated stick-table &lt;table&gt;. &lt;idx&gt;
is an integer between 0 and 99 and &lt;ctr&gt; an integer between 0 and 2.
If there is no GPT stored at this index, zero is returned.
This fetch applies only to the 'gpt' array data_type (and not on
the legacy 'gpt0' data-type). See also src_get_gpt.
</pre><a class="anchor" name="sc_get_gpt0"></a><a class="anchor" name="7-sc_get_gpt0"></a><a class="anchor" name="7.3.3-sc_get_gpt0"></a><a class="anchor" name="sc_get_gpt0 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_get_gpt0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_get_gpt0"></a><a href="#7.3.3-sc_get_gpt0">sc_get_gpt0</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_get_gpt0"></a><a class="anchor" name="7-sc0_get_gpt0"></a><a class="anchor" name="7.3.3-sc0_get_gpt0"></a><a class="anchor" name="sc0_get_gpt0 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_get_gpt0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_get_gpt0"></a><a href="#7.3.3-sc0_get_gpt0">sc0_get_gpt0</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_get_gpt0"></a><a class="anchor" name="7-sc1_get_gpt0"></a><a class="anchor" name="7.3.3-sc1_get_gpt0"></a><a class="anchor" name="sc1_get_gpt0 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_get_gpt0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_get_gpt0"></a><a href="#7.3.3-sc1_get_gpt0">sc1_get_gpt0</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_get_gpt0"></a><a class="anchor" name="7-sc2_get_gpt0"></a><a class="anchor" name="7.3.3-sc2_get_gpt0"></a><a class="anchor" name="sc2_get_gpt0 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_get_gpt0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_get_gpt0"></a><a href="#7.3.3-sc2_get_gpt0">sc2_get_gpt0</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the value of the first General Purpose Tag associated to the
currently tracked counters. See also src_get_gpt0.
</pre><a class="anchor" name="sc_glitch_cnt"></a><a class="anchor" name="7-sc_glitch_cnt"></a><a class="anchor" name="7.3.3-sc_glitch_cnt"></a><a class="anchor" name="sc_glitch_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_glitch_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_glitch_cnt"></a><a href="#7.3.3-sc_glitch_cnt">sc_glitch_cnt</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_glitch_cnt"></a><a class="anchor" name="7-sc0_glitch_cnt"></a><a class="anchor" name="7.3.3-sc0_glitch_cnt"></a><a class="anchor" name="sc0_glitch_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_glitch_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_glitch_cnt"></a><a href="#7.3.3-sc0_glitch_cnt">sc0_glitch_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_glitch_cnt"></a><a class="anchor" name="7-sc1_glitch_cnt"></a><a class="anchor" name="7.3.3-sc1_glitch_cnt"></a><a class="anchor" name="sc1_glitch_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_glitch_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_glitch_cnt"></a><a href="#7.3.3-sc1_glitch_cnt">sc1_glitch_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_glitch_cnt"></a><a class="anchor" name="7-sc2_glitch_cnt"></a><a class="anchor" name="7.3.3-sc2_glitch_cnt"></a><a class="anchor" name="sc2_glitch_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_glitch_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_glitch_cnt"></a><a href="#7.3.3-sc2_glitch_cnt">sc2_glitch_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the cumulative number of front connection glitches that were observed
on connections associated with the currently tracked counters. Usually these
result in requests or connections to be aborted so the returned value will
often correspond to past connections. There is no good nor bad value, but a
poor quality client may occasionally cause a few glitches per connection,
while a very bogus or malevolent client may quickly cause thousands of events
to be added on a connection. See also fc_glitches for the number affecting
the current connection, src_glitch_cnt to look them up per source, and
sc_glitch_rate for the event rate measurements.
</pre><a class="anchor" name="sc_glitch_rate"></a><a class="anchor" name="7-sc_glitch_rate"></a><a class="anchor" name="7.3.3-sc_glitch_rate"></a><a class="anchor" name="sc_glitch_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_glitch_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_glitch_rate"></a><a href="#7.3.3-sc_glitch_rate">sc_glitch_rate</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_glitch_rate"></a><a class="anchor" name="7-sc0_glitch_rate"></a><a class="anchor" name="7.3.3-sc0_glitch_rate"></a><a class="anchor" name="sc0_glitch_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_glitch_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_glitch_rate"></a><a href="#7.3.3-sc0_glitch_rate">sc0_glitch_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_glitch_rate"></a><a class="anchor" name="7-sc1_glitch_rate"></a><a class="anchor" name="7.3.3-sc1_glitch_rate"></a><a class="anchor" name="sc1_glitch_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_glitch_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_glitch_rate"></a><a href="#7.3.3-sc1_glitch_rate">sc1_glitch_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_glitch_rate"></a><a class="anchor" name="7-sc2_glitch_rate"></a><a class="anchor" name="7.3.3-sc2_glitch_rate"></a><a class="anchor" name="sc2_glitch_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_glitch_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_glitch_rate"></a><a href="#7.3.3-sc2_glitch_rate">sc2_glitch_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average rate at which front connection glitches were observed for
the currently tracked counters, measured in amount of events over the period
configured in the table. Usually these glitches result in requests or
connections to be aborted so the returned value will often be related to past
connections. There is no good nor bad value, but a poor quality client may
occasionally cause a few glitches per connection, hence a low rate is
generally expected. However, a very bogus or malevolent client may quickly
cause thousands of events to be added per connection, and maintain a high
rate here. See also src_glitch_rate and sc_glitch_cnt.
</pre><a class="anchor" name="sc_gpc_rate"></a><a class="anchor" name="7-sc_gpc_rate"></a><a class="anchor" name="7.3.3-sc_gpc_rate"></a><a class="anchor" name="sc_gpc_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_gpc_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_gpc_rate"></a><a href="#7.3.3-sc_gpc_rate">sc_gpc_rate</a></b>(<span style="color: #080">&lt;idx&gt;</span>,<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average increment rate of the General Purpose Counter at the
index &lt;idx&gt; of the array associated to the tracked counter of ID &lt;ctr&gt; from
the current proxy's table or from the designated stick-table &lt;table&gt;.
It reports the frequency which the gpc counter was incremented over the
configured period. &lt;idx&gt; is an integer between 0 and 99 and &lt;ctr&gt; an integer
between 0 and 2.
Note that the 'gpc_rate' counter array  must be stored in the stick-table
for a value to be returned, as 'gpc' only holds the event count.
This fetch applies only to the 'gpc_rate' array data_type (and not to
the legacy 'gpc0_rate' nor 'gpc1_rate' data_types).
See also src_gpc_rate, sc_get_gpc, and sc_inc_gpc.
</pre><a class="anchor" name="sc_gpc0_rate"></a><a class="anchor" name="7-sc_gpc0_rate"></a><a class="anchor" name="7.3.3-sc_gpc0_rate"></a><a class="anchor" name="sc_gpc0_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_gpc0_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_gpc0_rate"></a><a href="#7.3.3-sc_gpc0_rate">sc_gpc0_rate</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_gpc0_rate"></a><a class="anchor" name="7-sc0_gpc0_rate"></a><a class="anchor" name="7.3.3-sc0_gpc0_rate"></a><a class="anchor" name="sc0_gpc0_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_gpc0_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_gpc0_rate"></a><a href="#7.3.3-sc0_gpc0_rate">sc0_gpc0_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_gpc0_rate"></a><a class="anchor" name="7-sc1_gpc0_rate"></a><a class="anchor" name="7.3.3-sc1_gpc0_rate"></a><a class="anchor" name="sc1_gpc0_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_gpc0_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_gpc0_rate"></a><a href="#7.3.3-sc1_gpc0_rate">sc1_gpc0_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_gpc0_rate"></a><a class="anchor" name="7-sc2_gpc0_rate"></a><a class="anchor" name="7.3.3-sc2_gpc0_rate"></a><a class="anchor" name="sc2_gpc0_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_gpc0_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_gpc0_rate"></a><a href="#7.3.3-sc2_gpc0_rate">sc2_gpc0_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average increment rate of the first General Purpose Counter
associated to the currently tracked counters. It reports the frequency
which the gpc0 counter was incremented over the configured period. See also
src_gpc0_rate, sc/sc0/sc1/sc2_get_gpc0, and sc/sc0/sc1/sc2_inc_gpc0. Note
that the &quot;gpc0_rate&quot; counter must be stored in the stick-table for a value to
be returned, as &quot;gpc0&quot; only holds the event count.
</pre><a class="anchor" name="sc_gpc1_rate"></a><a class="anchor" name="7-sc_gpc1_rate"></a><a class="anchor" name="7.3.3-sc_gpc1_rate"></a><a class="anchor" name="sc_gpc1_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_gpc1_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_gpc1_rate"></a><a href="#7.3.3-sc_gpc1_rate">sc_gpc1_rate</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_gpc1_rate"></a><a class="anchor" name="7-sc0_gpc1_rate"></a><a class="anchor" name="7.3.3-sc0_gpc1_rate"></a><a class="anchor" name="sc0_gpc1_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_gpc1_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_gpc1_rate"></a><a href="#7.3.3-sc0_gpc1_rate">sc0_gpc1_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_gpc1_rate"></a><a class="anchor" name="7-sc1_gpc1_rate"></a><a class="anchor" name="7.3.3-sc1_gpc1_rate"></a><a class="anchor" name="sc1_gpc1_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_gpc1_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_gpc1_rate"></a><a href="#7.3.3-sc1_gpc1_rate">sc1_gpc1_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_gpc1_rate"></a><a class="anchor" name="7-sc2_gpc1_rate"></a><a class="anchor" name="7.3.3-sc2_gpc1_rate"></a><a class="anchor" name="sc2_gpc1_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_gpc1_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_gpc1_rate"></a><a href="#7.3.3-sc2_gpc1_rate">sc2_gpc1_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average increment rate of the second General Purpose Counter
associated to the currently tracked counters. It reports the frequency
which the gpc1 counter was incremented over the configured period. See also
src_gpcA_rate, sc/sc0/sc1/sc2_get_gpc1, and sc/sc0/sc1/sc2_inc_gpc1. Note
that the &quot;gpc1_rate&quot; counter must be stored in the stick-table for a value to
be returned, as &quot;gpc1&quot; only holds the event count.
</pre><a class="anchor" name="sc_http_err_cnt"></a><a class="anchor" name="7-sc_http_err_cnt"></a><a class="anchor" name="7.3.3-sc_http_err_cnt"></a><a class="anchor" name="sc_http_err_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_http_err_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_http_err_cnt"></a><a href="#7.3.3-sc_http_err_cnt">sc_http_err_cnt</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_http_err_cnt"></a><a class="anchor" name="7-sc0_http_err_cnt"></a><a class="anchor" name="7.3.3-sc0_http_err_cnt"></a><a class="anchor" name="sc0_http_err_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_http_err_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_http_err_cnt"></a><a href="#7.3.3-sc0_http_err_cnt">sc0_http_err_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_http_err_cnt"></a><a class="anchor" name="7-sc1_http_err_cnt"></a><a class="anchor" name="7.3.3-sc1_http_err_cnt"></a><a class="anchor" name="sc1_http_err_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_http_err_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_http_err_cnt"></a><a href="#7.3.3-sc1_http_err_cnt">sc1_http_err_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_http_err_cnt"></a><a class="anchor" name="7-sc2_http_err_cnt"></a><a class="anchor" name="7.3.3-sc2_http_err_cnt"></a><a class="anchor" name="sc2_http_err_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_http_err_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_http_err_cnt"></a><a href="#7.3.3-sc2_http_err_cnt">sc2_http_err_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the cumulative number of HTTP errors from the currently tracked
counters. This includes the both request errors and 4xx error responses.
See also src_http_err_cnt.
</pre><a class="anchor" name="sc_http_err_rate"></a><a class="anchor" name="7-sc_http_err_rate"></a><a class="anchor" name="7.3.3-sc_http_err_rate"></a><a class="anchor" name="sc_http_err_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_http_err_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_http_err_rate"></a><a href="#7.3.3-sc_http_err_rate">sc_http_err_rate</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_http_err_rate"></a><a class="anchor" name="7-sc0_http_err_rate"></a><a class="anchor" name="7.3.3-sc0_http_err_rate"></a><a class="anchor" name="sc0_http_err_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_http_err_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_http_err_rate"></a><a href="#7.3.3-sc0_http_err_rate">sc0_http_err_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_http_err_rate"></a><a class="anchor" name="7-sc1_http_err_rate"></a><a class="anchor" name="7.3.3-sc1_http_err_rate"></a><a class="anchor" name="sc1_http_err_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_http_err_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_http_err_rate"></a><a href="#7.3.3-sc1_http_err_rate">sc1_http_err_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_http_err_rate"></a><a class="anchor" name="7-sc2_http_err_rate"></a><a class="anchor" name="7.3.3-sc2_http_err_rate"></a><a class="anchor" name="sc2_http_err_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_http_err_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_http_err_rate"></a><a href="#7.3.3-sc2_http_err_rate">sc2_http_err_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average rate of HTTP errors from the currently tracked counters,
measured in amount of errors over the period configured in the table. This
includes the both request errors and 4xx error responses. See also
src_http_err_rate.
</pre><a class="anchor" name="sc_http_fail_cnt"></a><a class="anchor" name="7-sc_http_fail_cnt"></a><a class="anchor" name="7.3.3-sc_http_fail_cnt"></a><a class="anchor" name="sc_http_fail_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_http_fail_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_http_fail_cnt"></a><a href="#7.3.3-sc_http_fail_cnt">sc_http_fail_cnt</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_http_fail_cnt"></a><a class="anchor" name="7-sc0_http_fail_cnt"></a><a class="anchor" name="7.3.3-sc0_http_fail_cnt"></a><a class="anchor" name="sc0_http_fail_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_http_fail_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_http_fail_cnt"></a><a href="#7.3.3-sc0_http_fail_cnt">sc0_http_fail_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_http_fail_cnt"></a><a class="anchor" name="7-sc1_http_fail_cnt"></a><a class="anchor" name="7.3.3-sc1_http_fail_cnt"></a><a class="anchor" name="sc1_http_fail_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_http_fail_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_http_fail_cnt"></a><a href="#7.3.3-sc1_http_fail_cnt">sc1_http_fail_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_http_fail_cnt"></a><a class="anchor" name="7-sc2_http_fail_cnt"></a><a class="anchor" name="7.3.3-sc2_http_fail_cnt"></a><a class="anchor" name="sc2_http_fail_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_http_fail_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_http_fail_cnt"></a><a href="#7.3.3-sc2_http_fail_cnt">sc2_http_fail_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the cumulative number of HTTP response failures from the currently
tracked counters. This includes the both response errors and 5xx status codes
other than 501 and 505. See also src_http_fail_cnt.
</pre><a class="anchor" name="sc_http_fail_rate"></a><a class="anchor" name="7-sc_http_fail_rate"></a><a class="anchor" name="7.3.3-sc_http_fail_rate"></a><a class="anchor" name="sc_http_fail_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_http_fail_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_http_fail_rate"></a><a href="#7.3.3-sc_http_fail_rate">sc_http_fail_rate</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_http_fail_rate"></a><a class="anchor" name="7-sc0_http_fail_rate"></a><a class="anchor" name="7.3.3-sc0_http_fail_rate"></a><a class="anchor" name="sc0_http_fail_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_http_fail_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_http_fail_rate"></a><a href="#7.3.3-sc0_http_fail_rate">sc0_http_fail_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_http_fail_rate"></a><a class="anchor" name="7-sc1_http_fail_rate"></a><a class="anchor" name="7.3.3-sc1_http_fail_rate"></a><a class="anchor" name="sc1_http_fail_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_http_fail_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_http_fail_rate"></a><a href="#7.3.3-sc1_http_fail_rate">sc1_http_fail_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_http_fail_rate"></a><a class="anchor" name="7-sc2_http_fail_rate"></a><a class="anchor" name="7.3.3-sc2_http_fail_rate"></a><a class="anchor" name="sc2_http_fail_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_http_fail_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_http_fail_rate"></a><a href="#7.3.3-sc2_http_fail_rate">sc2_http_fail_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average rate of HTTP response failures from the currently tracked
counters, measured in amount of failures over the period configured in the
table. This includes the both response errors and 5xx status codes other than
501 and 505. See also src_http_fail_rate.
</pre><a class="anchor" name="sc_http_req_cnt"></a><a class="anchor" name="7-sc_http_req_cnt"></a><a class="anchor" name="7.3.3-sc_http_req_cnt"></a><a class="anchor" name="sc_http_req_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_http_req_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_http_req_cnt"></a><a href="#7.3.3-sc_http_req_cnt">sc_http_req_cnt</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_http_req_cnt"></a><a class="anchor" name="7-sc0_http_req_cnt"></a><a class="anchor" name="7.3.3-sc0_http_req_cnt"></a><a class="anchor" name="sc0_http_req_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_http_req_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_http_req_cnt"></a><a href="#7.3.3-sc0_http_req_cnt">sc0_http_req_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_http_req_cnt"></a><a class="anchor" name="7-sc1_http_req_cnt"></a><a class="anchor" name="7.3.3-sc1_http_req_cnt"></a><a class="anchor" name="sc1_http_req_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_http_req_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_http_req_cnt"></a><a href="#7.3.3-sc1_http_req_cnt">sc1_http_req_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_http_req_cnt"></a><a class="anchor" name="7-sc2_http_req_cnt"></a><a class="anchor" name="7.3.3-sc2_http_req_cnt"></a><a class="anchor" name="sc2_http_req_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_http_req_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_http_req_cnt"></a><a href="#7.3.3-sc2_http_req_cnt">sc2_http_req_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the cumulative number of HTTP requests from the currently tracked
counters. This includes every started request, valid or not. See also
src_http_req_cnt.
</pre><a class="anchor" name="sc_http_req_rate"></a><a class="anchor" name="7-sc_http_req_rate"></a><a class="anchor" name="7.3.3-sc_http_req_rate"></a><a class="anchor" name="sc_http_req_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_http_req_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_http_req_rate"></a><a href="#7.3.3-sc_http_req_rate">sc_http_req_rate</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_http_req_rate"></a><a class="anchor" name="7-sc0_http_req_rate"></a><a class="anchor" name="7.3.3-sc0_http_req_rate"></a><a class="anchor" name="sc0_http_req_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_http_req_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_http_req_rate"></a><a href="#7.3.3-sc0_http_req_rate">sc0_http_req_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_http_req_rate"></a><a class="anchor" name="7-sc1_http_req_rate"></a><a class="anchor" name="7.3.3-sc1_http_req_rate"></a><a class="anchor" name="sc1_http_req_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_http_req_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_http_req_rate"></a><a href="#7.3.3-sc1_http_req_rate">sc1_http_req_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_http_req_rate"></a><a class="anchor" name="7-sc2_http_req_rate"></a><a class="anchor" name="7.3.3-sc2_http_req_rate"></a><a class="anchor" name="sc2_http_req_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_http_req_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_http_req_rate"></a><a href="#7.3.3-sc2_http_req_rate">sc2_http_req_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average rate of HTTP requests from the currently tracked
counters, measured in amount of requests over the period configured in
the table. This includes every started request, valid or not. See also
src_http_req_rate.
</pre><a class="anchor" name="sc_inc_gpc"></a><a class="anchor" name="7-sc_inc_gpc"></a><a class="anchor" name="7.3.3-sc_inc_gpc"></a><a class="anchor" name="sc_inc_gpc (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_inc_gpc (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_inc_gpc"></a><a href="#7.3.3-sc_inc_gpc">sc_inc_gpc</a></b>(<span style="color: #080">&lt;idx&gt;</span>,<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Increments the General Purpose Counter at the index &lt;idx&gt; of the array
associated to the designated tracked counter of ID &lt;ctr&gt; from current
proxy's stick table or from the designated stick-table &lt;table&gt;, and
returns its new value. &lt;idx&gt; is an integer between 0 and 99 and
&lt;ctr&gt; an integer between 0 and 2.
Before the first invocation, the stored value is zero, so first invocation
will increase it to 1 and will return 1.
This fetch applies only to the 'gpc' array data_type (and not to the legacy
'gpc0' nor 'gpc1' data_types).
</pre><a class="anchor" name="sc_inc_gpc0"></a><a class="anchor" name="7-sc_inc_gpc0"></a><a class="anchor" name="7.3.3-sc_inc_gpc0"></a><a class="anchor" name="sc_inc_gpc0 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_inc_gpc0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_inc_gpc0"></a><a href="#7.3.3-sc_inc_gpc0">sc_inc_gpc0</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_inc_gpc0"></a><a class="anchor" name="7-sc0_inc_gpc0"></a><a class="anchor" name="7.3.3-sc0_inc_gpc0"></a><a class="anchor" name="sc0_inc_gpc0 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_inc_gpc0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_inc_gpc0"></a><a href="#7.3.3-sc0_inc_gpc0">sc0_inc_gpc0</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_inc_gpc0"></a><a class="anchor" name="7-sc1_inc_gpc0"></a><a class="anchor" name="7.3.3-sc1_inc_gpc0"></a><a class="anchor" name="sc1_inc_gpc0 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_inc_gpc0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_inc_gpc0"></a><a href="#7.3.3-sc1_inc_gpc0">sc1_inc_gpc0</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_inc_gpc0"></a><a class="anchor" name="7-sc2_inc_gpc0"></a><a class="anchor" name="7.3.3-sc2_inc_gpc0"></a><a class="anchor" name="sc2_inc_gpc0 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_inc_gpc0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_inc_gpc0"></a><a href="#7.3.3-sc2_inc_gpc0">sc2_inc_gpc0</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Increments the first General Purpose Counter associated to the currently
tracked counters, and returns its new value. Before the first invocation,
the stored value is zero, so first invocation will increase it to 1 and will
return 1. This is typically used as a second ACL in an expression in order
to mark a connection when a first ACL was verified :
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>acl abuse sc0_http_req_rate gt 10
acl kill  sc0_inc_gpc0 gt 0
tcp-request connection reject if abuse kill
</code></pre>
</div><a class="anchor" name="sc_inc_gpc1"></a><a class="anchor" name="7-sc_inc_gpc1"></a><a class="anchor" name="7.3.3-sc_inc_gpc1"></a><a class="anchor" name="sc_inc_gpc1 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_inc_gpc1 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_inc_gpc1"></a><a href="#7.3.3-sc_inc_gpc1">sc_inc_gpc1</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_inc_gpc1"></a><a class="anchor" name="7-sc0_inc_gpc1"></a><a class="anchor" name="7.3.3-sc0_inc_gpc1"></a><a class="anchor" name="sc0_inc_gpc1 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_inc_gpc1 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_inc_gpc1"></a><a href="#7.3.3-sc0_inc_gpc1">sc0_inc_gpc1</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_inc_gpc1"></a><a class="anchor" name="7-sc1_inc_gpc1"></a><a class="anchor" name="7.3.3-sc1_inc_gpc1"></a><a class="anchor" name="sc1_inc_gpc1 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_inc_gpc1 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_inc_gpc1"></a><a href="#7.3.3-sc1_inc_gpc1">sc1_inc_gpc1</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_inc_gpc1"></a><a class="anchor" name="7-sc2_inc_gpc1"></a><a class="anchor" name="7.3.3-sc2_inc_gpc1"></a><a class="anchor" name="sc2_inc_gpc1 (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_inc_gpc1 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_inc_gpc1"></a><a href="#7.3.3-sc2_inc_gpc1">sc2_inc_gpc1</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Increments the second General Purpose Counter associated to the currently
tracked counters, and returns its new value. Before the first invocation,
the stored value is zero, so first invocation will increase it to 1 and will
return 1. This is typically used as a second ACL in an expression in order
to mark a connection when a first ACL was verified.
</pre><a class="anchor" name="sc_kbytes_in"></a><a class="anchor" name="7-sc_kbytes_in"></a><a class="anchor" name="7.3.3-sc_kbytes_in"></a><a class="anchor" name="sc_kbytes_in (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_kbytes_in (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_kbytes_in"></a><a href="#7.3.3-sc_kbytes_in">sc_kbytes_in</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_kbytes_in"></a><a class="anchor" name="7-sc0_kbytes_in"></a><a class="anchor" name="7.3.3-sc0_kbytes_in"></a><a class="anchor" name="sc0_kbytes_in (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_kbytes_in (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_kbytes_in"></a><a href="#7.3.3-sc0_kbytes_in">sc0_kbytes_in</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_kbytes_in"></a><a class="anchor" name="7-sc1_kbytes_in"></a><a class="anchor" name="7.3.3-sc1_kbytes_in"></a><a class="anchor" name="sc1_kbytes_in (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_kbytes_in (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_kbytes_in"></a><a href="#7.3.3-sc1_kbytes_in">sc1_kbytes_in</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_kbytes_in"></a><a class="anchor" name="7-sc2_kbytes_in"></a><a class="anchor" name="7.3.3-sc2_kbytes_in"></a><a class="anchor" name="sc2_kbytes_in (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_kbytes_in (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_kbytes_in"></a><a href="#7.3.3-sc2_kbytes_in">sc2_kbytes_in</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the total amount of client-to-server data from the currently tracked
counters, measured in kilobytes. The test is currently performed on 32-bit
integers, which limits values to 4 terabytes. See also src_kbytes_in.
</pre><a class="anchor" name="sc_kbytes_out"></a><a class="anchor" name="7-sc_kbytes_out"></a><a class="anchor" name="7.3.3-sc_kbytes_out"></a><a class="anchor" name="sc_kbytes_out (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_kbytes_out (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_kbytes_out"></a><a href="#7.3.3-sc_kbytes_out">sc_kbytes_out</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_kbytes_out"></a><a class="anchor" name="7-sc0_kbytes_out"></a><a class="anchor" name="7.3.3-sc0_kbytes_out"></a><a class="anchor" name="sc0_kbytes_out (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_kbytes_out (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_kbytes_out"></a><a href="#7.3.3-sc0_kbytes_out">sc0_kbytes_out</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_kbytes_out"></a><a class="anchor" name="7-sc1_kbytes_out"></a><a class="anchor" name="7.3.3-sc1_kbytes_out"></a><a class="anchor" name="sc1_kbytes_out (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_kbytes_out (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_kbytes_out"></a><a href="#7.3.3-sc1_kbytes_out">sc1_kbytes_out</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_kbytes_out"></a><a class="anchor" name="7-sc2_kbytes_out"></a><a class="anchor" name="7.3.3-sc2_kbytes_out"></a><a class="anchor" name="sc2_kbytes_out (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_kbytes_out (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_kbytes_out"></a><a href="#7.3.3-sc2_kbytes_out">sc2_kbytes_out</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the total amount of server-to-client data from the currently tracked
counters, measured in kilobytes. The test is currently performed on 32-bit
integers, which limits values to 4 terabytes. See also src_kbytes_out.
</pre><a class="anchor" name="sc_sess_cnt"></a><a class="anchor" name="7-sc_sess_cnt"></a><a class="anchor" name="7.3.3-sc_sess_cnt"></a><a class="anchor" name="sc_sess_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_sess_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_sess_cnt"></a><a href="#7.3.3-sc_sess_cnt">sc_sess_cnt</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_sess_cnt"></a><a class="anchor" name="7-sc0_sess_cnt"></a><a class="anchor" name="7.3.3-sc0_sess_cnt"></a><a class="anchor" name="sc0_sess_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_sess_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_sess_cnt"></a><a href="#7.3.3-sc0_sess_cnt">sc0_sess_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_sess_cnt"></a><a class="anchor" name="7-sc1_sess_cnt"></a><a class="anchor" name="7.3.3-sc1_sess_cnt"></a><a class="anchor" name="sc1_sess_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_sess_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_sess_cnt"></a><a href="#7.3.3-sc1_sess_cnt">sc1_sess_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_sess_cnt"></a><a class="anchor" name="7-sc2_sess_cnt"></a><a class="anchor" name="7.3.3-sc2_sess_cnt"></a><a class="anchor" name="sc2_sess_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_sess_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_sess_cnt"></a><a href="#7.3.3-sc2_sess_cnt">sc2_sess_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the cumulative number of incoming connections that were transformed
into sessions, which means that they were accepted by a &quot;tcp-request
connection&quot; rule, from the currently tracked counters. A backend may count
more sessions than connections because each connection could result in many
backend sessions if some HTTP keep-alive is performed over the connection
with the client. See also src_sess_cnt.
</pre><a class="anchor" name="sc_sess_rate"></a><a class="anchor" name="7-sc_sess_rate"></a><a class="anchor" name="7.3.3-sc_sess_rate"></a><a class="anchor" name="sc_sess_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_sess_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_sess_rate"></a><a href="#7.3.3-sc_sess_rate">sc_sess_rate</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_sess_rate"></a><a class="anchor" name="7-sc0_sess_rate"></a><a class="anchor" name="7.3.3-sc0_sess_rate"></a><a class="anchor" name="sc0_sess_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_sess_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_sess_rate"></a><a href="#7.3.3-sc0_sess_rate">sc0_sess_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_sess_rate"></a><a class="anchor" name="7-sc1_sess_rate"></a><a class="anchor" name="7.3.3-sc1_sess_rate"></a><a class="anchor" name="sc1_sess_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_sess_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_sess_rate"></a><a href="#7.3.3-sc1_sess_rate">sc1_sess_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_sess_rate"></a><a class="anchor" name="7-sc2_sess_rate"></a><a class="anchor" name="7.3.3-sc2_sess_rate"></a><a class="anchor" name="sc2_sess_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_sess_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_sess_rate"></a><a href="#7.3.3-sc2_sess_rate">sc2_sess_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average session rate from the currently tracked counters,
measured in amount of sessions over the period configured in the table. A
session is a connection that got past the early &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot;
rules. A backend may count more sessions than connections because each
connection could result in many backend sessions if some HTTP keep-alive is
performed over the connection with the client. See also src_sess_rate.
</pre><a class="anchor" name="sc_tracked"></a><a class="anchor" name="7-sc_tracked"></a><a class="anchor" name="7.3.3-sc_tracked"></a><a class="anchor" name="sc_tracked (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_tracked (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_tracked"></a><a href="#7.3.3-sc_tracked">sc_tracked</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : boolean</div><a class="anchor" name="sc0_tracked"></a><a class="anchor" name="7-sc0_tracked"></a><a class="anchor" name="7.3.3-sc0_tracked"></a><a class="anchor" name="sc0_tracked (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_tracked (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_tracked"></a><a href="#7.3.3-sc0_tracked">sc0_tracked</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : boolean</div><a class="anchor" name="sc1_tracked"></a><a class="anchor" name="7-sc1_tracked"></a><a class="anchor" name="7.3.3-sc1_tracked"></a><a class="anchor" name="sc1_tracked (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_tracked (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_tracked"></a><a href="#7.3.3-sc1_tracked">sc1_tracked</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : boolean</div><a class="anchor" name="sc2_tracked"></a><a class="anchor" name="7-sc2_tracked"></a><a class="anchor" name="7.3.3-sc2_tracked"></a><a class="anchor" name="sc2_tracked (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_tracked (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_tracked"></a><a href="#7.3.3-sc2_tracked">sc2_tracked</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : boolean</div><pre class="text">Returns true if the designated session counter is currently being tracked by
the current session. This can be useful when deciding whether or not we want
to set some values in a header passed to the server.
</pre><a class="anchor" name="sc_trackers"></a><a class="anchor" name="7-sc_trackers"></a><a class="anchor" name="7.3.3-sc_trackers"></a><a class="anchor" name="sc_trackers (Using ACLs and fetching samples)"></a><a class="anchor" name="sc_trackers (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc_trackers"></a><a href="#7.3.3-sc_trackers">sc_trackers</a></b>(<span style="color: #080">&lt;ctr&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc0_trackers"></a><a class="anchor" name="7-sc0_trackers"></a><a class="anchor" name="7.3.3-sc0_trackers"></a><a class="anchor" name="sc0_trackers (Using ACLs and fetching samples)"></a><a class="anchor" name="sc0_trackers (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc0_trackers"></a><a href="#7.3.3-sc0_trackers">sc0_trackers</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc1_trackers"></a><a class="anchor" name="7-sc1_trackers"></a><a class="anchor" name="7.3.3-sc1_trackers"></a><a class="anchor" name="sc1_trackers (Using ACLs and fetching samples)"></a><a class="anchor" name="sc1_trackers (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc1_trackers"></a><a href="#7.3.3-sc1_trackers">sc1_trackers</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><a class="anchor" name="sc2_trackers"></a><a class="anchor" name="7-sc2_trackers"></a><a class="anchor" name="7.3.3-sc2_trackers"></a><a class="anchor" name="sc2_trackers (Using ACLs and fetching samples)"></a><a class="anchor" name="sc2_trackers (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="sc2_trackers"></a><a href="#7.3.3-sc2_trackers">sc2_trackers</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the current amount of concurrent connections tracking the same
tracked counters. This number is automatically incremented when tracking
begins and decremented when tracking stops. It differs from sc0_conn_cur in
that it does not rely on any stored information but on the table's reference
count (the &quot;use&quot; value which is returned by &quot;show table&quot; on the CLI). This
may sometimes be more suited for layer7 tracking. It can be used to tell a
server how many concurrent connections there are from a given address for
example.
</pre><a class="anchor" name="so_id"></a><a class="anchor" name="7-so_id"></a><a class="anchor" name="7.3.3-so_id"></a><a class="anchor" name="so_id (Using ACLs and fetching samples)"></a><a class="anchor" name="so_id (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="so_id"></a><a href="#7.3.3-so_id">so_id</a></b> : integer</div><pre class="text">Returns an integer containing the current listening socket's id. It is useful
in frontends involving many &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines, or to stick all users coming via a
same socket to the same server.
</pre><a class="anchor" name="so_name"></a><a class="anchor" name="7-so_name"></a><a class="anchor" name="7.3.3-so_name"></a><a class="anchor" name="so_name (Using ACLs and fetching samples)"></a><a class="anchor" name="so_name (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="so_name"></a><a href="#7.3.3-so_name">so_name</a></b> : string</div><pre class="text">Returns a string containing the current listening socket's name, as defined
with name on a &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line. It can serve the same purposes as so_id but with
strings instead of integers.
</pre><a class="anchor" name="src"></a><a class="anchor" name="7-src"></a><a class="anchor" name="7.3.3-src"></a><a class="anchor" name="src (Using ACLs and fetching samples)"></a><a class="anchor" name="src (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src"></a><a href="#7.3.3-src">src</a></b> : ip</div><pre class="text">This is the source IP address of the client of the session. Any tcp/http
rules may alter this address. It is of type IP and works on both IPv4 and
IPv6 tables. On IPv6 tables, IPv4 addresses are mapped to their IPv6
equivalent, according to RFC 4291. Note that it is the TCP-level source
address which is used, and not the address of a client behind a
proxy. However if the &quot;<a href="#accept-proxy">accept-proxy</a>&quot; or &quot;<a href="#accept-netscaler-cip">accept-netscaler-cip</a>&quot; bind directive
is used, it can be the address of a client behind another PROXY-protocol
compatible component for all rule sets except &quot;<a href="#tcp-request%20connection">tcp-request connection</a>&quot; which
sees the real address. When the incoming connection passed through address
translation or redirection involving connection tracking, the original
destination address before the redirection will be reported. On Linux
systems, the source and destination may seldom appear reversed if the
nf_conntrack_tcp_loose sysctl is set, because a late response may reopen a
timed out connection and switch what is believed to be the source and the
destination.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># add an HTTP header in requests with the originating address' country</span>
http-request set-header X-Country %[src,map_ip(geoip.lst)]
</code></pre>
</div><a class="anchor" name="src_bytes_in_rate"></a><a class="anchor" name="7-src_bytes_in_rate"></a><a class="anchor" name="7.3.3-src_bytes_in_rate"></a><a class="anchor" name="src_bytes_in_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="src_bytes_in_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_bytes_in_rate"></a><a href="#7.3.3-src_bytes_in_rate">src_bytes_in_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average bytes rate from the incoming connection's source address
in the current proxy's stick-table or in the designated stick-table, measured
in amount of bytes over the period configured in the table. If the address is
not found, zero is returned. See also sc/sc0/sc1/sc2_bytes_in_rate.
</pre><a class="anchor" name="src_bytes_out_rate"></a><a class="anchor" name="7-src_bytes_out_rate"></a><a class="anchor" name="7.3.3-src_bytes_out_rate"></a><a class="anchor" name="src_bytes_out_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="src_bytes_out_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_bytes_out_rate"></a><a href="#7.3.3-src_bytes_out_rate">src_bytes_out_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average bytes rate to the incoming connection's source address in
the current proxy's stick-table or in the designated stick-table, measured in
amount of bytes over the period configured in the table. If the address is
not found, zero is returned. See also sc/sc0/sc1/sc2_bytes_out_rate.
</pre><a class="anchor" name="src_clr_gpc"></a><a class="anchor" name="7-src_clr_gpc"></a><a class="anchor" name="7.3.3-src_clr_gpc"></a><a class="anchor" name="src_clr_gpc (Using ACLs and fetching samples)"></a><a class="anchor" name="src_clr_gpc (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_clr_gpc"></a><a href="#7.3.3-src_clr_gpc">src_clr_gpc</a></b>(<span style="color: #080">&lt;idx&gt;</span>,<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Clears the General Purpose Counter at the index &lt;idx&gt; of the array
associated to the incoming connection's source address in the current proxy's
stick-table or in the designated stick-table &lt;table&gt;, and returns its
previous value. &lt;idx&gt; is an integer between 0 and 99.
If the address is not found, an entry is created and 0 is returned.
This fetch applies only to the 'gpc' array data_type (and not to the legacy
'gpc0' nor 'gpc1' data_types).
See also sc_clr_gpc.
</pre><a class="anchor" name="src_clr_gpc0"></a><a class="anchor" name="7-src_clr_gpc0"></a><a class="anchor" name="7.3.3-src_clr_gpc0"></a><a class="anchor" name="src_clr_gpc0 (Using ACLs and fetching samples)"></a><a class="anchor" name="src_clr_gpc0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_clr_gpc0"></a><a href="#7.3.3-src_clr_gpc0">src_clr_gpc0</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Clears the first General Purpose Counter associated to the incoming
connection's source address in the current proxy's stick-table or in the
designated stick-table, and returns its previous value. If the address is not
found, an entry is created and 0 is returned. This is typically used as a
second ACL in an expression in order to mark a connection when a first ACL
was verified :
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># block if 5 consecutive requests continue to come faster than 10 sess</span>
<span class="comment"># per second, and reset the counter as soon as the traffic slows down.</span>
acl abuse src_http_req_rate gt 10
acl kill  src_inc_gpc0 gt 5
acl save  src_clr_gpc0 ge 0
tcp-request connection accept if !abuse save
tcp-request connection reject if abuse kill
</code></pre>
</div><a class="anchor" name="src_clr_gpc1"></a><a class="anchor" name="7-src_clr_gpc1"></a><a class="anchor" name="7.3.3-src_clr_gpc1"></a><a class="anchor" name="src_clr_gpc1 (Using ACLs and fetching samples)"></a><a class="anchor" name="src_clr_gpc1 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_clr_gpc1"></a><a href="#7.3.3-src_clr_gpc1">src_clr_gpc1</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Clears the second General Purpose Counter associated to the incoming
connection's source address in the current proxy's stick-table or in the
designated stick-table, and returns its previous value. If the address is not
found, an entry is created and 0 is returned. This is typically used as a
second ACL in an expression in order to mark a connection when a first ACL
was verified.
</pre><a class="anchor" name="src_conn_cnt"></a><a class="anchor" name="7-src_conn_cnt"></a><a class="anchor" name="7.3.3-src_conn_cnt"></a><a class="anchor" name="src_conn_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="src_conn_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_conn_cnt"></a><a href="#7.3.3-src_conn_cnt">src_conn_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the cumulative number of connections initiated from the current
incoming connection's source address in the current proxy's stick-table or in
the designated stick-table. If the address is not found, zero is returned.
See also sc/sc0/sc1/sc2_conn_cnt.
</pre><a class="anchor" name="src_conn_cur"></a><a class="anchor" name="7-src_conn_cur"></a><a class="anchor" name="7.3.3-src_conn_cur"></a><a class="anchor" name="src_conn_cur (Using ACLs and fetching samples)"></a><a class="anchor" name="src_conn_cur (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_conn_cur"></a><a href="#7.3.3-src_conn_cur">src_conn_cur</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the current amount of concurrent connections initiated from the
current incoming connection's source address in the current proxy's
stick-table or in the designated stick-table. If the address is not found,
zero is returned. See also sc/sc0/sc1/sc2_conn_cur.
</pre><a class="anchor" name="src_conn_rate"></a><a class="anchor" name="7-src_conn_rate"></a><a class="anchor" name="7.3.3-src_conn_rate"></a><a class="anchor" name="src_conn_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="src_conn_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_conn_rate"></a><a href="#7.3.3-src_conn_rate">src_conn_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average connection rate from the incoming connection's source
address in the current proxy's stick-table or in the designated stick-table,
measured in amount of connections over the period configured in the table. If
the address is not found, zero is returned. See also sc/sc0/sc1/sc2_conn_rate.
</pre><a class="anchor" name="src_get_gpc"></a><a class="anchor" name="7-src_get_gpc"></a><a class="anchor" name="7.3.3-src_get_gpc"></a><a class="anchor" name="src_get_gpc (Using ACLs and fetching samples)"></a><a class="anchor" name="src_get_gpc (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_get_gpc"></a><a href="#7.3.3-src_get_gpc">src_get_gpc</a></b>(<span style="color: #080">&lt;idx&gt;</span>,<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the value of the General Purpose Counter at the index &lt;idx&gt; of the
array associated to the incoming connection's source address in the
current proxy's stick-table or in the designated stick-table &lt;table&gt;. &lt;idx&gt;
is an integer between 0 and 99.
If the address is not found or there is no gpc stored at this index, zero
is returned.
This fetch applies only to the 'gpc' array data_type (and not on the legacy
'gpc0' nor 'gpc1' data_types).
See also sc_get_gpc and src_inc_gpc.
</pre><a class="anchor" name="src_get_gpc0"></a><a class="anchor" name="7-src_get_gpc0"></a><a class="anchor" name="7.3.3-src_get_gpc0"></a><a class="anchor" name="src_get_gpc0 (Using ACLs and fetching samples)"></a><a class="anchor" name="src_get_gpc0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_get_gpc0"></a><a href="#7.3.3-src_get_gpc0">src_get_gpc0</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the value of the first General Purpose Counter associated to the
incoming connection's source address in the current proxy's stick-table or in
the designated stick-table. If the address is not found, zero is returned.
See also sc/sc0/sc1/sc2_get_gpc0 and src_inc_gpc0.
</pre><a class="anchor" name="src_get_gpc1"></a><a class="anchor" name="7-src_get_gpc1"></a><a class="anchor" name="7.3.3-src_get_gpc1"></a><a class="anchor" name="src_get_gpc1 (Using ACLs and fetching samples)"></a><a class="anchor" name="src_get_gpc1 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_get_gpc1"></a><a href="#7.3.3-src_get_gpc1">src_get_gpc1</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the value of the second General Purpose Counter associated to the
incoming connection's source address in the current proxy's stick-table or in
the designated stick-table. If the address is not found, zero is returned.
See also sc/sc0/sc1/sc2_get_gpc1 and src_inc_gpc1.
</pre><a class="anchor" name="src_get_gpt"></a><a class="anchor" name="7-src_get_gpt"></a><a class="anchor" name="7.3.3-src_get_gpt"></a><a class="anchor" name="src_get_gpt (Using ACLs and fetching samples)"></a><a class="anchor" name="src_get_gpt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_get_gpt"></a><a href="#7.3.3-src_get_gpt">src_get_gpt</a></b>(<span style="color: #080">&lt;idx&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the value of the first General Purpose Tag at the index &lt;idx&gt; of
the array associated to the incoming connection's source address in the
current proxy's stick-table or in the designated stick-table &lt;table&gt;.
&lt;idx&gt; is an integer between 0 and 99.
If the address is not found or the GPT is not stored, zero is returned.
See also the sc_get_gpt sample fetch keyword.
</pre><a class="anchor" name="src_get_gpt0"></a><a class="anchor" name="7-src_get_gpt0"></a><a class="anchor" name="7.3.3-src_get_gpt0"></a><a class="anchor" name="src_get_gpt0 (Using ACLs and fetching samples)"></a><a class="anchor" name="src_get_gpt0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_get_gpt0"></a><a href="#7.3.3-src_get_gpt0">src_get_gpt0</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the value of the first General Purpose Tag associated to the
incoming connection's source address in the current proxy's stick-table or in
the designated stick-table. If the address is not found, zero is returned.
See also sc/sc0/sc1/sc2_get_gpt0.
</pre><a class="anchor" name="src_glitch_cnt"></a><a class="anchor" name="7-src_glitch_cnt"></a><a class="anchor" name="7.3.3-src_glitch_cnt"></a><a class="anchor" name="src_glitch_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="src_glitch_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_glitch_cnt"></a><a href="#7.3.3-src_glitch_cnt">src_glitch_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the cumulative number of front connection glitches that were observed
on connections from the current connection's source address. Usually these
result in requests or connections to be aborted so the returned value will
often correspond to past connections. There is no good nor bad value, but a
poor quality client may occasionally cause a few glitches per connection,
while a very bogus or malevolent client may quickly cause thousands of events
to be added on a connection. See also fc_glitches for the number affecting
the current connection, sc_glitch_cnt to look them up in currently tracked
counters, and src_glitch_rate for the event rate measurements.
</pre><a class="anchor" name="src_glitch_rate"></a><a class="anchor" name="7-src_glitch_rate"></a><a class="anchor" name="7.3.3-src_glitch_rate"></a><a class="anchor" name="src_glitch_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="src_glitch_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_glitch_rate"></a><a href="#7.3.3-src_glitch_rate">src_glitch_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average rate at which front connection glitches were observed for
on connections from the current connection's source address, measured in
amount of events over the period configured in the table. Usually these
glitches result in requests or connections to be aborted so the returned
value will often be related to past connections. There is no good nor bad
value, but a poor quality client may occasionally cause a few glitches per
connection, hence a low rate is generally expected. However, a very bogus or
malevolent client may quickly cause thousands of events to be added per
connection, and maintain a high rate here. See also sc_glitch_rate and
src_glitch_cnt.
</pre><a class="anchor" name="src_gpc_rate"></a><a class="anchor" name="7-src_gpc_rate"></a><a class="anchor" name="7.3.3-src_gpc_rate"></a><a class="anchor" name="src_gpc_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="src_gpc_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_gpc_rate"></a><a href="#7.3.3-src_gpc_rate">src_gpc_rate</a></b>(<span style="color: #080">&lt;idx&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average increment rate of the General Purpose Counter at the
index &lt;idx&gt; of the array associated to the incoming connection's
source address in the current proxy's stick-table or in the designated
stick-table &lt;table&gt;. It reports the frequency which the gpc counter was
incremented over the configured period. &lt;idx&gt; is an integer between 0 and 99.
Note that the 'gpc_rate' counter must be stored in the stick-table for a
value to be returned, as 'gpc' only holds the event count.
This fetch applies only to the 'gpc_rate' array data_type (and not to
the legacy 'gpc0_rate' nor 'gpc1_rate' data_types).
See also sc_gpc_rate, src_get_gpc, and sc_inc_gpc.
</pre><a class="anchor" name="src_gpc0_rate"></a><a class="anchor" name="7-src_gpc0_rate"></a><a class="anchor" name="7.3.3-src_gpc0_rate"></a><a class="anchor" name="src_gpc0_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="src_gpc0_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_gpc0_rate"></a><a href="#7.3.3-src_gpc0_rate">src_gpc0_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average increment rate of the first General Purpose Counter
associated to the incoming connection's source address in the current proxy's
stick-table or in the designated stick-table. It reports the frequency
which the gpc0 counter was incremented over the configured period. See also
sc/sc0/sc1/sc2_gpc0_rate, src_get_gpc0, and sc/sc0/sc1/sc2_inc_gpc0. Note
that the &quot;gpc0_rate&quot; counter must be stored in the stick-table for a value to
be returned, as &quot;gpc0&quot; only holds the event count.
</pre><a class="anchor" name="src_gpc1_rate"></a><a class="anchor" name="7-src_gpc1_rate"></a><a class="anchor" name="7.3.3-src_gpc1_rate"></a><a class="anchor" name="src_gpc1_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="src_gpc1_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_gpc1_rate"></a><a href="#7.3.3-src_gpc1_rate">src_gpc1_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average increment rate of the second General Purpose Counter
associated to the incoming connection's source address in the current proxy's
stick-table or in the designated stick-table. It reports the frequency
which the gpc1 counter was incremented over the configured period. See also
sc/sc0/sc1/sc2_gpc1_rate, src_get_gpc1, and sc/sc0/sc1/sc2_inc_gpc1. Note
that the &quot;gpc1_rate&quot; counter must be stored in the stick-table for a value to
be returned, as &quot;gpc1&quot; only holds the event count.
</pre><a class="anchor" name="src_http_err_cnt"></a><a class="anchor" name="7-src_http_err_cnt"></a><a class="anchor" name="7.3.3-src_http_err_cnt"></a><a class="anchor" name="src_http_err_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="src_http_err_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_http_err_cnt"></a><a href="#7.3.3-src_http_err_cnt">src_http_err_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the cumulative number of HTTP errors from the incoming connection's
source address in the current proxy's stick-table or in the designated
stick-table. This includes the both request errors and 4xx error responses.
See also sc/sc0/sc1/sc2_http_err_cnt. If the address is not found, zero is
returned.
</pre><a class="anchor" name="src_http_err_rate"></a><a class="anchor" name="7-src_http_err_rate"></a><a class="anchor" name="7.3.3-src_http_err_rate"></a><a class="anchor" name="src_http_err_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="src_http_err_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_http_err_rate"></a><a href="#7.3.3-src_http_err_rate">src_http_err_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average rate of HTTP errors from the incoming connection's source
address in the current proxy's stick-table or in the designated stick-table,
measured in amount of errors over the period configured in the table. This
includes the both request errors and 4xx error responses. If the address is
not found, zero is returned. See also sc/sc0/sc1/sc2_http_err_rate.
</pre><a class="anchor" name="src_http_fail_cnt"></a><a class="anchor" name="7-src_http_fail_cnt"></a><a class="anchor" name="7.3.3-src_http_fail_cnt"></a><a class="anchor" name="src_http_fail_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="src_http_fail_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_http_fail_cnt"></a><a href="#7.3.3-src_http_fail_cnt">src_http_fail_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the cumulative number of HTTP response failures triggered by the
incoming connection's source address in the current proxy's stick-table or in
the designated stick-table. This includes the both response errors and 5xx
status codes other than 501 and 505. See also sc/sc0/sc1/sc2_http_fail_cnt.
If the address is not found, zero is returned.
</pre><a class="anchor" name="src_http_fail_rate"></a><a class="anchor" name="7-src_http_fail_rate"></a><a class="anchor" name="7.3.3-src_http_fail_rate"></a><a class="anchor" name="src_http_fail_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="src_http_fail_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_http_fail_rate"></a><a href="#7.3.3-src_http_fail_rate">src_http_fail_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average rate of HTTP response failures triggered by the incoming
connection's source address in the current proxy's stick-table or in the
designated stick-table, measured in amount of failures over the period
configured in the table. This includes the both response errors and 5xx
status codes other than 501 and 505. If the address is not found, zero is
returned. See also sc/sc0/sc1/sc2_http_fail_rate.
</pre><a class="anchor" name="src_http_req_cnt"></a><a class="anchor" name="7-src_http_req_cnt"></a><a class="anchor" name="7.3.3-src_http_req_cnt"></a><a class="anchor" name="src_http_req_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="src_http_req_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_http_req_cnt"></a><a href="#7.3.3-src_http_req_cnt">src_http_req_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the cumulative number of HTTP requests from the incoming connection's
source address in the current proxy's stick-table or in the designated stick-
table. This includes every started request, valid or not. If the address is
not found, zero is returned. See also sc/sc0/sc1/sc2_http_req_cnt.
</pre><a class="anchor" name="src_http_req_rate"></a><a class="anchor" name="7-src_http_req_rate"></a><a class="anchor" name="7.3.3-src_http_req_rate"></a><a class="anchor" name="src_http_req_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="src_http_req_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_http_req_rate"></a><a href="#7.3.3-src_http_req_rate">src_http_req_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average rate of HTTP requests from the incoming connection's
source address in the current proxy's stick-table or in the designated stick-
table, measured in amount of requests over the period configured in the
table. This includes every started request, valid or not. If the address is
not found, zero is returned. See also sc/sc0/sc1/sc2_http_req_rate.
</pre><a class="anchor" name="src_inc_gpc"></a><a class="anchor" name="7-src_inc_gpc"></a><a class="anchor" name="7.3.3-src_inc_gpc"></a><a class="anchor" name="src_inc_gpc (Using ACLs and fetching samples)"></a><a class="anchor" name="src_inc_gpc (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_inc_gpc"></a><a href="#7.3.3-src_inc_gpc">src_inc_gpc</a></b>(<span style="color: #080">&lt;idx&gt;</span>,<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Increments the General Purpose Counter at index &lt;idx&gt; of the array
associated to the incoming connection's source address in the current proxy's
stick-table or in the designated stick-table &lt;table&gt;, and returns its new
value. &lt;idx&gt; is an integer between 0 and 99.
If the address is not found, an entry is created and 1 is returned.
This fetch applies only to the 'gpc' array data_type (and not to the legacy
'gpc0' nor 'gpc1' data_types).
See also sc_inc_gpc.
</pre><a class="anchor" name="src_inc_gpc0"></a><a class="anchor" name="7-src_inc_gpc0"></a><a class="anchor" name="7.3.3-src_inc_gpc0"></a><a class="anchor" name="src_inc_gpc0 (Using ACLs and fetching samples)"></a><a class="anchor" name="src_inc_gpc0 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_inc_gpc0"></a><a href="#7.3.3-src_inc_gpc0">src_inc_gpc0</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Increments the first General Purpose Counter associated to the incoming
connection's source address in the current proxy's stick-table or in the
designated stick-table, and returns its new value. If the address is not
found, an entry is created and 1 is returned. See also sc0/sc2/sc2_inc_gpc0.
This is typically used as a second ACL in an expression in order to mark a
connection when a first ACL was verified :
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>acl abuse src_http_req_rate gt 10
acl kill  src_inc_gpc0 gt 0
tcp-request connection reject if abuse kill
</code></pre>
</div><a class="anchor" name="src_inc_gpc1"></a><a class="anchor" name="7-src_inc_gpc1"></a><a class="anchor" name="7.3.3-src_inc_gpc1"></a><a class="anchor" name="src_inc_gpc1 (Using ACLs and fetching samples)"></a><a class="anchor" name="src_inc_gpc1 (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_inc_gpc1"></a><a href="#7.3.3-src_inc_gpc1">src_inc_gpc1</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Increments the second General Purpose Counter associated to the incoming
connection's source address in the current proxy's stick-table or in the
designated stick-table, and returns its new value. If the address is not
found, an entry is created and 1 is returned. See also sc0/sc2/sc2_inc_gpc1.
This is typically used as a second ACL in an expression in order to mark a
connection when a first ACL was verified.
</pre><a class="anchor" name="src_is_local"></a><a class="anchor" name="7-src_is_local"></a><a class="anchor" name="7.3.3-src_is_local"></a><a class="anchor" name="src_is_local (Using ACLs and fetching samples)"></a><a class="anchor" name="src_is_local (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_is_local"></a><a href="#7.3.3-src_is_local">src_is_local</a></b> : boolean</div><pre class="text">Returns true if the source address of the incoming connection is local to the
system, or false if the address doesn't exist on the system, meaning that it
comes from a remote machine. Note that UNIX addresses are considered local.
It can be useful to apply certain access restrictions based on where the
client comes from (e.g. require auth or https for remote machines). Please
note that the check involves a few system calls, so it's better to do it only
once per connection.
</pre><a class="anchor" name="src_kbytes_in"></a><a class="anchor" name="7-src_kbytes_in"></a><a class="anchor" name="7.3.3-src_kbytes_in"></a><a class="anchor" name="src_kbytes_in (Using ACLs and fetching samples)"></a><a class="anchor" name="src_kbytes_in (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_kbytes_in"></a><a href="#7.3.3-src_kbytes_in">src_kbytes_in</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the total amount of data received from the incoming connection's
source address in the current proxy's stick-table or in the designated
stick-table, measured in kilobytes. If the address is not found, zero is
returned. The test is currently performed on 32-bit integers, which limits
values to 4 terabytes. See also sc/sc0/sc1/sc2_kbytes_in.
</pre><a class="anchor" name="src_kbytes_out"></a><a class="anchor" name="7-src_kbytes_out"></a><a class="anchor" name="7.3.3-src_kbytes_out"></a><a class="anchor" name="src_kbytes_out (Using ACLs and fetching samples)"></a><a class="anchor" name="src_kbytes_out (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_kbytes_out"></a><a href="#7.3.3-src_kbytes_out">src_kbytes_out</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the total amount of data sent to the incoming connection's source
address in the current proxy's stick-table or in the designated stick-table,
measured in kilobytes. If the address is not found, zero is returned. The
test is currently performed on 32-bit integers, which limits values to 4
terabytes. See also sc/sc0/sc1/sc2_kbytes_out.
</pre><a class="anchor" name="src_port"></a><a class="anchor" name="7-src_port"></a><a class="anchor" name="7.3.3-src_port"></a><a class="anchor" name="src_port (Using ACLs and fetching samples)"></a><a class="anchor" name="src_port (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_port"></a><a href="#7.3.3-src_port">src_port</a></b> : integer</div><pre class="text">Returns an integer value corresponding to the TCP source port of the
connection on the client side, which is the port the client connected
from. Any tcp/http rules may alter this address. Usage of this function is
very limited as modern protocols do not care much about source ports
nowadays.
</pre><a class="anchor" name="src_sess_cnt"></a><a class="anchor" name="7-src_sess_cnt"></a><a class="anchor" name="7.3.3-src_sess_cnt"></a><a class="anchor" name="src_sess_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="src_sess_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_sess_cnt"></a><a href="#7.3.3-src_sess_cnt">src_sess_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the cumulative number of connections initiated from the incoming
connection's source IPv4 address in the current proxy's stick-table or in the
designated stick-table, that were transformed into sessions, which means that
they were accepted by &quot;<a href="#tcp-request">tcp-request</a>&quot; rules. If the address is not found, zero
is returned. See also sc/sc0/sc1/sc2_sess_cnt.
</pre><a class="anchor" name="src_sess_rate"></a><a class="anchor" name="7-src_sess_rate"></a><a class="anchor" name="7.3.3-src_sess_rate"></a><a class="anchor" name="src_sess_rate (Using ACLs and fetching samples)"></a><a class="anchor" name="src_sess_rate (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_sess_rate"></a><a href="#7.3.3-src_sess_rate">src_sess_rate</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Returns the average session rate from the incoming connection's source
address in the current proxy's stick-table or in the designated stick-table,
measured in amount of sessions over the period configured in the table. A
session is a connection that went past the early &quot;<a href="#tcp-request">tcp-request</a>&quot; rules. If the
address is not found, zero is returned. See also sc/sc0/sc1/sc2_sess_rate.
</pre><a class="anchor" name="src_updt_conn_cnt"></a><a class="anchor" name="7-src_updt_conn_cnt"></a><a class="anchor" name="7.3.3-src_updt_conn_cnt"></a><a class="anchor" name="src_updt_conn_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="src_updt_conn_cnt (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="src_updt_conn_cnt"></a><a href="#7.3.3-src_updt_conn_cnt">src_updt_conn_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;table&gt;</span>]</span>) : integer</div><pre class="text">Creates or updates the entry associated to the incoming connection's source
address in the current proxy's stick-table or in the designated stick-table.
This table must be configured to store the &quot;conn_cnt&quot; data type, otherwise
the match will be ignored. The current count is incremented by one, and the
expiration timer refreshed. The updated count is returned, so this match
can't return zero. This was used to reject service abusers based on their
source address. Note: it is recommended to use the more complete &quot;track-sc*&quot;
actions in &quot;<a href="#tcp-request">tcp-request</a>&quot; rules instead.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># This frontend limits incoming SSH connections to 3 per 10 second for</span>
<span class="comment"># each source address, and rejects excess connections until a 10 second</span>
<span class="comment"># silence is observed. At most 20 addresses are tracked.</span>
listen ssh
    bind :22
    mode tcp
    maxconn 100
    stick-table type ip size 20 expire 10s store conn_cnt
    tcp-request content reject if { src_updt_conn_cnt gt 3 }
    server local 127.0.0.1:22
</code></pre>
</div><a class="anchor" name="srv_id"></a><a class="anchor" name="7-srv_id"></a><a class="anchor" name="7.3.3-srv_id"></a><a class="anchor" name="srv_id (Using ACLs and fetching samples)"></a><a class="anchor" name="srv_id (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="srv_id"></a><a href="#7.3.3-srv_id">srv_id</a></b> : integer</div><pre class="text">Returns an integer containing the server's id when processing the response.
While it's almost only used with ACLs, it may be used for logging or
debugging. It can also be used in a tcp-check or an http-check ruleset.
</pre><a class="anchor" name="srv_name"></a><a class="anchor" name="7-srv_name"></a><a class="anchor" name="7.3.3-srv_name"></a><a class="anchor" name="srv_name (Using ACLs and fetching samples)"></a><a class="anchor" name="srv_name (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="srv_name"></a><a href="#7.3.3-srv_name">srv_name</a></b> : string</div><pre class="text">Returns a string containing the server's name when processing the response.
While it's almost only used with ACLs, it may be used for logging or
debugging. It can also be used in a tcp-check or an http-check ruleset.
</pre><a class="anchor" name="txn.conn_retries"></a><a class="anchor" name="7-txn.conn_retries"></a><a class="anchor" name="7.3.3-txn.conn_retries"></a><a class="anchor" name="txn.conn_retries (Using ACLs and fetching samples)"></a><a class="anchor" name="txn.conn_retries (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="txn.conn_retries"></a><a href="#7.3.3-txn.conn_retries">txn.conn_retries</a></b> : integer</div><pre class="text">Returns the the number of connection retries experienced by this stream when
trying to connect to the server. This value is subject to change while the
connection is not fully established. For HTTP connections, the value may be
affected by L7 retries.
</pre><a class="anchor" name="txn.redispatched"></a><a class="anchor" name="7-txn.redispatched"></a><a class="anchor" name="7.3.3-txn.redispatched"></a><a class="anchor" name="txn.redispatched (Using ACLs and fetching samples)"></a><a class="anchor" name="txn.redispatched (Fetching samples at Layer 4)"></a><div class="keyword"><b><a class="anchor" name="txn.redispatched"></a><a href="#7.3.3-txn.redispatched">txn.redispatched</a></b> : boolean</div><pre class="text">Returns true if the connection has experienced redispatch upon retry according
to &quot;<a href="#option%20redispatch">option redispatch</a>&quot; configuration. This value is subject to change while
the connection is not fully established. For HTTP connections, the value may
be affected by L7 retries.
</pre></div>
<a class="anchor" id="7.3.4" name="7.3.4"></a>
<h3 id="chapter-7.3.4" data-target="7.3.4"><small><a class="small" href="#7.3.4">7.3.4.</a></small> Fetching samples at Layer 5</h3>
<div><pre class="text">The layer 5 usually describes just the session layer which in HAProxy is
closest to the session once all the connection handshakes are finished, but
when no content is yet made available. The fetch methods described here are
usable as low as the &quot;<a href="#tcp-request%20content">tcp-request content</a>&quot; rule sets unless they require some
future information. Those generally include the results of SSL negotiations.

Summary of sample fetch methods in this section and their respective types:
</pre><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-51d.all">51d.all(&lt;prop&gt;[,&lt;prop&gt;*])</a></td><td >string</td></tr>
<tr><td ><a href="#7-bs.aborted">bs.aborted</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-bs.debug_str">bs.debug_str([&lt;bitmap&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-bs.id">bs.id</a></td><td >integer</td></tr>
<tr><td ><a href="#7-bs.rst_code">bs.rst_code</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fs.aborted">fs.aborted</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-fs.debug_str">fs.debug_str([&lt;bitmap&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-fs.id">fs.id</a></td><td >integer</td></tr>
<tr><td ><a href="#7-fs.rst_code">fs.rst_code</a></td><td >integer</td></tr>
<tr><td ><a href="#7-ssl_bc">ssl_bc</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-ssl_bc_alg_keysize">ssl_bc_alg_keysize</a></td><td >integer</td></tr>
<tr><td ><a href="#7-ssl_bc_alpn">ssl_bc_alpn</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_bc_cipher">ssl_bc_cipher</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_bc_client_random">ssl_bc_client_random</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_bc_client_early_traffic_secret">ssl_bc_client_early_traffic_secret</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_bc_client_handshake_traffic_secret">ssl_bc_client_handshake_traffic_secret</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_bc_client_traffic_secret_0">ssl_bc_client_traffic_secret_0</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_bc_exporter_secret">ssl_bc_exporter_secret</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_bc_early_exporter_secret">ssl_bc_early_exporter_secret</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_bc_curve">ssl_bc_curve</a></td><td >string</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-ssl_bc_err">ssl_bc_err</a></td><td >integer</td></tr>
<tr><td ><a href="#7-ssl_bc_err_str">ssl_bc_err_str</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_bc_is_resumed">ssl_bc_is_resumed</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-ssl_bc_npn">ssl_bc_npn</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_bc_protocol">ssl_bc_protocol</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_bc_unique_id">ssl_bc_unique_id</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_bc_server_handshake_traffic_secret">ssl_bc_server_handshake_traffic_secret</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_bc_server_traffic_secret_0">ssl_bc_server_traffic_secret_0</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_bc_server_random">ssl_bc_server_random</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_bc_session_id">ssl_bc_session_id</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_bc_session_key">ssl_bc_session_key</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_bc_use_keysize">ssl_bc_use_keysize</a></td><td >integer</td></tr>
<tr><td ><a href="#7-ssl_c_ca_err">ssl_c_ca_err</a></td><td >integer</td></tr>
<tr><td ><a href="#7-ssl_c_ca_err_depth">ssl_c_ca_err_depth</a></td><td >integer</td></tr>
<tr><td ><a href="#7-ssl_c_chain_der">ssl_c_chain_der</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_c_der">ssl_c_der</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_c_err">ssl_c_err</a></td><td >integer</td></tr>
<tr><td ><a href="#7-ssl_c_i_dn">ssl_c_i_dn([&lt;entry&gt;[,&lt;occ&gt;[,&lt;format&gt;]]])</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_c_key_alg">ssl_c_key_alg</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_c_notafter">ssl_c_notafter</a></td><td >string</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-ssl_c_notbefore">ssl_c_notbefore</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_c_r_dn">ssl_c_r_dn([&lt;entry&gt;[,&lt;occ&gt;[,&lt;format&gt;]]])</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_c_s_dn">ssl_c_s_dn([&lt;entry&gt;[,&lt;occ&gt;[,&lt;format&gt;]]])</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_c_san">ssl_c_san</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_c_serial">ssl_c_serial</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_c_sha1">ssl_c_sha1</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_c_sig_alg">ssl_c_sig_alg</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_c_used">ssl_c_used</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-ssl_c_verify">ssl_c_verify</a></td><td >integer</td></tr>
<tr><td ><a href="#7-ssl_c_version">ssl_c_version</a></td><td >integer</td></tr>
<tr><td ><a href="#7-ssl_f_der">ssl_f_der</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_f_i_dn">ssl_f_i_dn([&lt;entry&gt;[,&lt;occ&gt;[,&lt;format&gt;]]])</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_f_key_alg">ssl_f_key_alg</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_f_notafter">ssl_f_notafter</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_f_notbefore">ssl_f_notbefore</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_f_s_dn">ssl_f_s_dn([&lt;entry&gt;[,&lt;occ&gt;[,&lt;format&gt;]]])</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_f_serial">ssl_f_serial</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_f_sha1">ssl_f_sha1</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_f_sig_alg">ssl_f_sig_alg</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_f_version">ssl_f_version</a></td><td >integer</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-ssl_fc">ssl_fc</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-ssl_fc_alg_keysize">ssl_fc_alg_keysize</a></td><td >integer</td></tr>
<tr><td ><a href="#7-ssl_fc_alpn">ssl_fc_alpn</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_fc_cipher">ssl_fc_cipher</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_fc_cipherlist_bin">ssl_fc_cipherlist_bin([&lt;filter_option&gt;])</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_fc_cipherlist_hex">ssl_fc_cipherlist_hex([&lt;filter_option&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_fc_cipherlist_str">ssl_fc_cipherlist_str([&lt;filter_option&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_fc_cipherlist_xxh">ssl_fc_cipherlist_xxh</a></td><td >integer</td></tr>
<tr><td ><a href="#7-ssl_fc_curve">ssl_fc_curve</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_fc_ecformats_bin">ssl_fc_ecformats_bin</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_fc_eclist_bin">ssl_fc_eclist_bin([&lt;filter_option&gt;])</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_fc_extlist_bin">ssl_fc_extlist_bin([&lt;filter_option&gt;])</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_fc_client_random">ssl_fc_client_random</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_fc_client_early_traffic_secret">ssl_fc_client_early_traffic_secret</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_fc_client_handshake_traffic_secret">ssl_fc_client_handshake_traffic_secret</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_fc_client_traffic_secret_0">ssl_fc_client_traffic_secret_0</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_fc_exporter_secret">ssl_fc_exporter_secret</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_fc_early_exporter_secret">ssl_fc_early_exporter_secret</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_fc_err">ssl_fc_err</a></td><td >integer</td></tr>
<tr><td ><a href="#7-ssl_fc_err_str">ssl_fc_err_str</a></td><td >string</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-ssl_fc_has_crt">ssl_fc_has_crt</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-ssl_fc_has_early">ssl_fc_has_early</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-ssl_fc_has_sni">ssl_fc_has_sni</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-ssl_fc_is_resumed">ssl_fc_is_resumed</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-ssl_fc_npn">ssl_fc_npn</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_fc_protocol">ssl_fc_protocol</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_fc_protocol_hello_id">ssl_fc_protocol_hello_id</a></td><td >integer</td></tr>
<tr><td ><a href="#7-ssl_fc_unique_id">ssl_fc_unique_id</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_fc_server_handshake_traffic_secret">ssl_fc_server_handshake_traffic_secret</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_fc_server_traffic_secret_0">ssl_fc_server_traffic_secret_0</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_fc_server_random">ssl_fc_server_random</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_fc_session_id">ssl_fc_session_id</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_fc_session_key">ssl_fc_session_key</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_fc_sigalgs_bin">ssl_fc_sigalgs_bin([&lt;filter_option&gt;])</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_fc_sni">ssl_fc_sni</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_fc_supported_versions_bin">ssl_fc_supported_versions_bin([&lt;filter_option&gt;])</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_fc_use_keysize">ssl_fc_use_keysize</a></td><td >integer</td></tr>
<tr><td ><a href="#7-ssl_s_der">ssl_s_der</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_s_chain_der">ssl_s_chain_der</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_s_key_alg">ssl_s_key_alg</a></td><td >string</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-ssl_s_notafter">ssl_s_notafter</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_s_notbefore">ssl_s_notbefore</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_s_i_dn">ssl_s_i_dn([&lt;entry&gt;[,&lt;occ&gt;[,&lt;format&gt;]]])</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_s_s_dn">ssl_s_s_dn([&lt;entry&gt;[,&lt;occ&gt;[,&lt;format&gt;]]])</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_s_serial">ssl_s_serial</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_s_sha1">ssl_s_sha1</a></td><td >binary</td></tr>
<tr><td ><a href="#7-ssl_s_sig_alg">ssl_s_sig_alg</a></td><td >string</td></tr>
<tr><td ><a href="#7-ssl_s_version">ssl_s_version</a></td><td >integer</td></tr>
<tr><td ><a href="#7-txn.timer.user">txn.timer.user</a></td><td >integer</td></tr>
</table><pre class="text">Detailed list:
</pre><a class="anchor" name="51d.all"></a><a class="anchor" name="7-51d.all"></a><a class="anchor" name="7.3.4-51d.all"></a><a class="anchor" name="51d.all (Using ACLs and fetching samples)"></a><a class="anchor" name="51d.all (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="51d.all"></a><a href="#7.3.4-51d.all">51d.all</a></b>(<span style="color: #080">&lt;prop&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;prop&gt;</span>*]</span>) : string</div><pre class="text">Returns values for the properties requested as a string, where values are
separated by the delimiter specified with &quot;<a href="#51degrees-property-separator">51degrees-property-separator</a>&quot;.
The device is identified using all the important HTTP headers from the
request. The function can be passed up to five property names, and if a
property name can't be found, the value &quot;NoData&quot; is returned.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># Here the header &quot;X-51D-DeviceTypeMobileTablet&quot; is added to the request</span>
<span class="comment"># containing the three properties requested using all relevant headers from</span>
<span class="comment"># the request.</span>
frontend http-in
  bind *:8081
  default_backend servers
  http-request set-header X-51D-DeviceTypeMobileTablet \
    %[51d.all(DeviceType,IsMobile,IsTablet)]
</code></pre>
</div><a class="anchor" name="bs.aborted"></a><a class="anchor" name="7-bs.aborted"></a><a class="anchor" name="7.3.4-bs.aborted"></a><a class="anchor" name="bs.aborted (Using ACLs and fetching samples)"></a><a class="anchor" name="bs.aborted (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="bs.aborted"></a><a href="#7.3.4-bs.aborted">bs.aborted</a></b> : boolean</div><pre class="text">Returns true is an abort was received from the server for the current
stream. Otherwise false is returned.
</pre><a class="anchor" name="bs.debug_str"></a><a class="anchor" name="7-bs.debug_str"></a><a class="anchor" name="7.3.4-bs.debug_str"></a><a class="anchor" name="bs.debug_str (Using ACLs and fetching samples)"></a><a class="anchor" name="bs.debug_str (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="bs.debug_str"></a><a href="#7.3.4-bs.debug_str">bs.debug_str</a></b>(<span style="color: #008">[<span style="color: #080">&lt;bitmap&gt;</span>]</span>) : string</div><pre class="text">This function is meant to be used by developers during certain complex
troubleshooting sessions. It extracts some internal states from the lower
layers of the backend stream and connection, and arranges them as a string,
generally in the form of a series of &quot;name=value&quot; delimited with spaces. The
&lt;bitmap&gt; optional argument indicates what layer(s) to extract information
from, and is an arithmetic OR (or a sum) of the following values:
   - socket layer: 16
   - connection layer: 8
   - transport layer (e.g. SSL): 4
   - mux connection: 2
   - mux stream: 1

These values might change across versions. The default value of zero is
special and enables all layers. Please do not rely on the output of this
function for long-term production monitoring. It is meant to evolve even
within a stable branch, as the needs for increased details arise. One use
typical use case is to concatenate these information at the very end of a
log-format, along with fs.debug_str(). Example:

   log-format &quot;$HAPROXY_HTTP_LOG_FMT fs=&lt;%[fs.debug_str]&gt; bs=&lt;%[bs.debug_str]&gt;&quot;
</pre><a class="anchor" name="bs.id"></a><a class="anchor" name="7-bs.id"></a><a class="anchor" name="7.3.4-bs.id"></a><a class="anchor" name="bs.id (Using ACLs and fetching samples)"></a><a class="anchor" name="bs.id (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="bs.id"></a><a href="#7.3.4-bs.id">bs.id</a></b> : integer</div><pre class="text">Returns the multiplexer's stream ID on the server side. It is the
multiplexer's responsibility to return the appropriate information.
</pre><a class="anchor" name="bs.rst_code"></a><a class="anchor" name="7-bs.rst_code"></a><a class="anchor" name="7.3.4-bs.rst_code"></a><a class="anchor" name="bs.rst_code (Using ACLs and fetching samples)"></a><a class="anchor" name="bs.rst_code (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="bs.rst_code"></a><a href="#7.3.4-bs.rst_code">bs.rst_code</a></b> : integer</div><pre class="text">Returns the reset code received from the server for the current stream. The
code of the H2 RST_STREAM frame or the QUIC STOP_SENDING frame received from
the server is returned. The sample fetch fails if no abort was received or if
the server stream is not an H2/QUIC stream.
</pre><a class="anchor" name="ssl_bc"></a><a class="anchor" name="7-ssl_bc"></a><a class="anchor" name="7.3.4-ssl_bc"></a><a class="anchor" name="ssl_bc (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc"></a><a href="#7.3.4-ssl_bc">ssl_bc</a></b> : boolean</div><pre class="text">Returns true when the back connection was made via an SSL/TLS transport
layer and is locally deciphered. This means the outgoing connection was made
to a server with the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; option. It can be used in a tcp-check or an
http-check ruleset.
</pre><a class="anchor" name="fs.aborted"></a><a class="anchor" name="7-fs.aborted"></a><a class="anchor" name="7.3.4-fs.aborted"></a><a class="anchor" name="fs.aborted (Using ACLs and fetching samples)"></a><a class="anchor" name="fs.aborted (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="fs.aborted"></a><a href="#7.3.4-fs.aborted">fs.aborted</a></b> : boolean</div><pre class="text">Returns true is an abort was received from the client for the current
stream. Otherwise false is returned.
</pre><a class="anchor" name="fs.debug_str"></a><a class="anchor" name="7-fs.debug_str"></a><a class="anchor" name="7.3.4-fs.debug_str"></a><a class="anchor" name="fs.debug_str (Using ACLs and fetching samples)"></a><a class="anchor" name="fs.debug_str (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="fs.debug_str"></a><a href="#7.3.4-fs.debug_str">fs.debug_str</a></b>(<span style="color: #008">[<span style="color: #080">&lt;bitmap&gt;</span>]</span>) : string</div><pre class="text">This function is meant to be used by developers during certain complex
troubleshooting sessions. It extracts some internal states from the lower
layers of the frontend stream and connection, and arranges them as a string,
generally in the form of a series of &quot;name=value&quot; delimited with spaces. The
&lt;bitmap&gt; optional argument indicates what layer(s) to extract information
from, and is an arithmetic OR (or a sum) of the following values:
   - socket layer: 16
   - connection layer: 8
   - transport layer (e.g. SSL): 4
   - mux connection: 2
   - mux stream: 1

These values might change across versions. The default value of zero is
special and enables all layers. Please do not rely on the output of this
function for long-term production monitoring. It is meant to evolve even
within a stable branch, as the needs for increased details arise. One use
typical use case is to concatenate these information at the very end of a
log-format, along with bs.debug_str(). Example:

   log-format &quot;$HAPROXY_HTTP_LOG_FMT fs=&lt;%[fs.debug_str]&gt; bs=&lt;%[bs.debug_str]&gt;&quot;
</pre><a class="anchor" name="fs.id"></a><a class="anchor" name="7-fs.id"></a><a class="anchor" name="7.3.4-fs.id"></a><a class="anchor" name="fs.id (Using ACLs and fetching samples)"></a><a class="anchor" name="fs.id (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="fs.id"></a><a href="#7.3.4-fs.id">fs.id</a></b> : integer</div><pre class="text">Returns the multiplexer's stream ID on the client side. It is the
multiplexer's responsibility to return the appropriate information. For
instance, on a raw TCP, 0 is always returned because there is no stream.
</pre><a class="anchor" name="fs.rst_code"></a><a class="anchor" name="7-fs.rst_code"></a><a class="anchor" name="7.3.4-fs.rst_code"></a><a class="anchor" name="fs.rst_code (Using ACLs and fetching samples)"></a><a class="anchor" name="fs.rst_code (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="fs.rst_code"></a><a href="#7.3.4-fs.rst_code">fs.rst_code</a></b> : integer</div><pre class="text">Returns the reset code received from the client for the current stream. The
code of the H2 RST_STREAM frame or the QUIC STOP_SENDING frame received from
the client is returned. The sample fetch fails if no abort was received or
if the client stream is not an H2/QUIC stream.
</pre><a class="anchor" name="ssl_bc_alg_keysize"></a><a class="anchor" name="7-ssl_bc_alg_keysize"></a><a class="anchor" name="7.3.4-ssl_bc_alg_keysize"></a><a class="anchor" name="ssl_bc_alg_keysize (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_alg_keysize (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_alg_keysize"></a><a href="#7.3.4-ssl_bc_alg_keysize">ssl_bc_alg_keysize</a></b> : integer</div><pre class="text">Returns the symmetric cipher key size supported in bits when the outgoing
connection was made over an SSL/TLS transport layer. It can be used in a
tcp-check or an http-check ruleset.
</pre><a class="anchor" name="ssl_bc_alpn"></a><a class="anchor" name="7-ssl_bc_alpn"></a><a class="anchor" name="7.3.4-ssl_bc_alpn"></a><a class="anchor" name="ssl_bc_alpn (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_alpn (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_alpn"></a><a href="#7.3.4-ssl_bc_alpn">ssl_bc_alpn</a></b> : string</div><pre class="text">This extracts the Application Layer Protocol Negotiation field from an
outgoing connection made via a TLS transport layer.
The result is a string containing the protocol name negotiated with the
server. The SSL library must have been built with support for TLS
extensions enabled (check haproxy -vv). Note that the TLS ALPN extension is
not advertised unless the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">alpn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#alpn%20%28Bind%20options%29">Bind options</a></li><li><a href="#alpn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword on the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line specifies a
protocol list. Also, nothing forces the server to pick a protocol from this
list, any other one may be requested. The TLS ALPN extension is meant to
replace the TLS NPN extension. See also &quot;<a href="#ssl_bc_npn">ssl_bc_npn</a>&quot;. It can be used in a
tcp-check or an http-check ruleset.
</pre><a class="anchor" name="ssl_bc_cipher"></a><a class="anchor" name="7-ssl_bc_cipher"></a><a class="anchor" name="7.3.4-ssl_bc_cipher"></a><a class="anchor" name="ssl_bc_cipher (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_cipher (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_cipher"></a><a href="#7.3.4-ssl_bc_cipher">ssl_bc_cipher</a></b> : string</div><pre class="text">Returns the name of the used cipher when the outgoing connection was made
over an SSL/TLS transport layer. It can be used in a tcp-check or an
http-check ruleset.
</pre><a class="anchor" name="ssl_bc_client_random"></a><a class="anchor" name="7-ssl_bc_client_random"></a><a class="anchor" name="7.3.4-ssl_bc_client_random"></a><a class="anchor" name="ssl_bc_client_random (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_client_random (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_client_random"></a><a href="#7.3.4-ssl_bc_client_random">ssl_bc_client_random</a></b> : binary</div><pre class="text">Returns the client random of the back connection when the incoming connection
was made over an SSL/TLS transport layer. It is useful to to decrypt traffic
sent using ephemeral ciphers. This requires OpenSSL &gt;= 1.1.0, or BoringSSL.
It can be used in a tcp-check or an http-check ruleset.
</pre><a class="anchor" name="ssl_bc_client_early_traffic_secret"></a><a class="anchor" name="7-ssl_bc_client_early_traffic_secret"></a><a class="anchor" name="7.3.4-ssl_bc_client_early_traffic_secret"></a><a class="anchor" name="ssl_bc_client_early_traffic_secret (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_client_early_traffic_secret (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_client_early_traffic_secret"></a><a href="#7.3.4-ssl_bc_client_early_traffic_secret">ssl_bc_client_early_traffic_secret</a></b> : string</div><pre class="text">Return the CLIENT_EARLY_TRAFFIC_SECRET as an hexadecimal string for the
back connection when the outgoing connection was made over a TLS 1.3
transport layer.
Require OpenSSL &gt;= 1.1.1. This is one of the keys dumped by the OpenSSL
keylog callback to generate the SSLKEYLOGFILE. The SSL Key logging must be
activated with &quot;tune.ssl.keylog on&quot; in the global section. See also
&quot;<a href="#tune.ssl.keylog">tune.ssl.keylog</a>&quot;
</pre><a class="anchor" name="ssl_bc_client_handshake_traffic_secret"></a><a class="anchor" name="7-ssl_bc_client_handshake_traffic_secret"></a><a class="anchor" name="7.3.4-ssl_bc_client_handshake_traffic_secret"></a><a class="anchor" name="ssl_bc_client_handshake_traffic_secret (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_client_handshake_traffic_secret (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_client_handshake_traffic_secret"></a><a href="#7.3.4-ssl_bc_client_handshake_traffic_secret">ssl_bc_client_handshake_traffic_secret</a></b> : string</div><pre class="text">Return the CLIENT_HANDSHAKE_TRAFFIC_SECRET as an hexadecimal string for the
bacl connection when the outgoing connection was made over a TLS 1.3
transport layer.
Require OpenSSL &gt;= 1.1.1. This is one of the keys dumped by the OpenSSL
keylog callback to generate the SSLKEYLOGFILE. The SSL Key logging must be
activated with &quot;tune.ssl.keylog on&quot; in the global section. See also
&quot;<a href="#tune.ssl.keylog">tune.ssl.keylog</a>&quot;
</pre><a class="anchor" name="ssl_bc_client_traffic_secret_0"></a><a class="anchor" name="7-ssl_bc_client_traffic_secret_0"></a><a class="anchor" name="7.3.4-ssl_bc_client_traffic_secret_0"></a><a class="anchor" name="ssl_bc_client_traffic_secret_0 (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_client_traffic_secret_0 (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_client_traffic_secret_0"></a><a href="#7.3.4-ssl_bc_client_traffic_secret_0">ssl_bc_client_traffic_secret_0</a></b> : string</div><pre class="text">Return the CLIENT_TRAFFIC_SECRET_0 as an hexadecimal string for the
back connection when the outgoing connection was made over a TLS 1.3
transport layer.
Require OpenSSL &gt;= 1.1.1. This is one of the keys dumped by the OpenSSL
keylog callback to generate the SSLKEYLOGFILE. The SSL Key logging must be
activated with &quot;tune.ssl.keylog on&quot; in the global section. See also
&quot;<a href="#tune.ssl.keylog">tune.ssl.keylog</a>&quot;
</pre><a class="anchor" name="ssl_bc_exporter_secret"></a><a class="anchor" name="7-ssl_bc_exporter_secret"></a><a class="anchor" name="7.3.4-ssl_bc_exporter_secret"></a><a class="anchor" name="ssl_bc_exporter_secret (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_exporter_secret (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_exporter_secret"></a><a href="#7.3.4-ssl_bc_exporter_secret">ssl_bc_exporter_secret</a></b> : string</div><pre class="text">Return the EXPORTER_SECRET as an hexadecimal string for the
back connection when the outgoing connection was made over a TLS 1.3
transport layer.
Require OpenSSL &gt;= 1.1.1. This is one of the keys dumped by the OpenSSL
keylog callback to generate the SSLKEYLOGFILE. The SSL Key logging must be
activated with &quot;tune.ssl.keylog on&quot; in the global section. See also
&quot;<a href="#tune.ssl.keylog">tune.ssl.keylog</a>&quot;
</pre><a class="anchor" name="ssl_bc_early_exporter_secret"></a><a class="anchor" name="7-ssl_bc_early_exporter_secret"></a><a class="anchor" name="7.3.4-ssl_bc_early_exporter_secret"></a><a class="anchor" name="ssl_bc_early_exporter_secret (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_early_exporter_secret (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_early_exporter_secret"></a><a href="#7.3.4-ssl_bc_early_exporter_secret">ssl_bc_early_exporter_secret</a></b> : string</div><pre class="text">Return the EARLY_EXPORTER_SECRET as an hexadecimal string for the
back connection when the outgoing connection was made over an TLS 1.3
transport layer.
Require OpenSSL &gt;= 1.1.1. This is one of the keys dumped by the OpenSSL
keylog callback to generate the SSLKEYLOGFILE. The SSL Key logging must be
activated with &quot;tune.ssl.keylog on&quot; in the global section. See also
&quot;<a href="#tune.ssl.keylog">tune.ssl.keylog</a>&quot;
</pre><a class="anchor" name="ssl_bc_curve"></a><a class="anchor" name="7-ssl_bc_curve"></a><a class="anchor" name="7.3.4-ssl_bc_curve"></a><a class="anchor" name="ssl_bc_curve (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_curve (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_curve"></a><a href="#7.3.4-ssl_bc_curve">ssl_bc_curve</a></b> : string</div><pre class="text">Returns the name of the curve used in the key agreement when the outgoing
connection was made over an SSL/TLS transport layer. This requires
OpenSSL &gt;= 3.0.0.
</pre><a class="anchor" name="ssl_bc_err"></a><a class="anchor" name="7-ssl_bc_err"></a><a class="anchor" name="7.3.4-ssl_bc_err"></a><a class="anchor" name="ssl_bc_err (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_err (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_err"></a><a href="#7.3.4-ssl_bc_err">ssl_bc_err</a></b> : integer</div><pre class="text">When the outgoing connection was made over an SSL/TLS transport layer,
returns the ID of the last error of the first error stack raised on the
backend side. It can raise handshake errors as well as other read or write
errors occurring during the connection's lifetime. In order to get a text
description of this error code, you can either use the &quot;<a href="#ssl_bc_err_str">ssl_bc_err_str</a>&quot;
sample fetch or use the &quot;openssl errstr&quot; command (which takes an error code
in hexadecimal representation as parameter). Please refer to your SSL
library's documentation to find the exhaustive list of error codes.
</pre><a class="anchor" name="ssl_bc_err_str"></a><a class="anchor" name="7-ssl_bc_err_str"></a><a class="anchor" name="7.3.4-ssl_bc_err_str"></a><a class="anchor" name="ssl_bc_err_str (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_err_str (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_err_str"></a><a href="#7.3.4-ssl_bc_err_str">ssl_bc_err_str</a></b> : string</div><pre class="text">When the outgoing connection was made over an SSL/TLS transport layer,
returns a string representation of the last error of the first error stack
that was raised on the connection from the backend's perspective. See also
&quot;<a href="#ssl_fc_err">ssl_fc_err</a>&quot;.
</pre><a class="anchor" name="ssl_bc_is_resumed"></a><a class="anchor" name="7-ssl_bc_is_resumed"></a><a class="anchor" name="7.3.4-ssl_bc_is_resumed"></a><a class="anchor" name="ssl_bc_is_resumed (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_is_resumed (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_is_resumed"></a><a href="#7.3.4-ssl_bc_is_resumed">ssl_bc_is_resumed</a></b> : boolean</div><pre class="text">Returns true when the back connection was made over an SSL/TLS transport
layer and the newly created SSL session was resumed using a cached
session or a TLS ticket. It can be used in a tcp-check or an http-check
ruleset.
</pre><a class="anchor" name="ssl_bc_npn"></a><a class="anchor" name="7-ssl_bc_npn"></a><a class="anchor" name="7.3.4-ssl_bc_npn"></a><a class="anchor" name="ssl_bc_npn (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_npn (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_npn"></a><a href="#7.3.4-ssl_bc_npn">ssl_bc_npn</a></b> : string</div><pre class="text">This extracts the Next Protocol Negotiation field from an outgoing connection
made via a TLS transport layer. The result is a string containing the
protocol name negotiated with the server . The SSL library must have been
built with support for TLS extensions enabled (check haproxy -vv). Note that
the TLS NPN extension is not advertised unless the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">npn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#npn%20%28Bind%20options%29">Bind options</a></li><li><a href="#npn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword on the
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line specifies a protocol list. Also, nothing forces the server to
pick a protocol from this list, any other one may be used. Please note that
the TLS NPN extension was replaced with ALPN. It can be used in a tcp-check
or an http-check ruleset.
</pre><a class="anchor" name="ssl_bc_protocol"></a><a class="anchor" name="7-ssl_bc_protocol"></a><a class="anchor" name="7.3.4-ssl_bc_protocol"></a><a class="anchor" name="ssl_bc_protocol (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_protocol (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_protocol"></a><a href="#7.3.4-ssl_bc_protocol">ssl_bc_protocol</a></b> : string</div><pre class="text">Returns the name of the used protocol when the outgoing connection was made
over an SSL/TLS transport layer. It can be used in a tcp-check or an
http-check ruleset.
</pre><a class="anchor" name="ssl_bc_unique_id"></a><a class="anchor" name="7-ssl_bc_unique_id"></a><a class="anchor" name="7.3.4-ssl_bc_unique_id"></a><a class="anchor" name="ssl_bc_unique_id (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_unique_id (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_unique_id"></a><a href="#7.3.4-ssl_bc_unique_id">ssl_bc_unique_id</a></b> : binary</div><pre class="text">When the outgoing connection was made over an SSL/TLS transport layer,
returns the TLS unique ID as defined in RFC5929 <a href="#3">section 3</a>. The unique id
can be encoded to base64 using the converter: &quot;ssl_bc_unique_id,base64&quot;. It
can be used in a tcp-check or an http-check ruleset.
</pre><a class="anchor" name="ssl_bc_server_handshake_traffic_secret"></a><a class="anchor" name="7-ssl_bc_server_handshake_traffic_secret"></a><a class="anchor" name="7.3.4-ssl_bc_server_handshake_traffic_secret"></a><a class="anchor" name="ssl_bc_server_handshake_traffic_secret (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_server_handshake_traffic_secret (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_server_handshake_traffic_secret"></a><a href="#7.3.4-ssl_bc_server_handshake_traffic_secret">ssl_bc_server_handshake_traffic_secret</a></b> : string</div><pre class="text">Return the SERVER_HANDSHAKE_TRAFFIC_SECRET as an hexadecimal string for the
back connection when the outgoing connection was made over a TLS 1.3
transport layer.
Require OpenSSL &gt;= 1.1.1. This is one of the keys dumped by the OpenSSL
keylog callback to generate the SSLKEYLOGFILE. The SSL Key logging must be
activated with &quot;tune.ssl.keylog on&quot; in the global section. See also
&quot;<a href="#tune.ssl.keylog">tune.ssl.keylog</a>&quot;
</pre><a class="anchor" name="ssl_bc_server_traffic_secret_0"></a><a class="anchor" name="7-ssl_bc_server_traffic_secret_0"></a><a class="anchor" name="7.3.4-ssl_bc_server_traffic_secret_0"></a><a class="anchor" name="ssl_bc_server_traffic_secret_0 (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_server_traffic_secret_0 (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_server_traffic_secret_0"></a><a href="#7.3.4-ssl_bc_server_traffic_secret_0">ssl_bc_server_traffic_secret_0</a></b> : string</div><pre class="text">Return the SERVER_TRAFFIC_SECRET_0 as an hexadecimal string for the
back connection when the outgoing connection was made over an TLS 1.3
transport layer.
Require OpenSSL &gt;= 1.1.1. This is one of the keys dumped by the OpenSSL
keylog callback to generate the SSLKEYLOGFILE. The SSL Key logging must be
activated with &quot;tune.ssl.keylog on&quot; in the global section. See also
&quot;<a href="#tune.ssl.keylog">tune.ssl.keylog</a>&quot;
</pre><a class="anchor" name="ssl_bc_server_random"></a><a class="anchor" name="7-ssl_bc_server_random"></a><a class="anchor" name="7.3.4-ssl_bc_server_random"></a><a class="anchor" name="ssl_bc_server_random (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_server_random (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_server_random"></a><a href="#7.3.4-ssl_bc_server_random">ssl_bc_server_random</a></b> : binary</div><pre class="text">Returns the server random of the back connection when the incoming connection
was made over an SSL/TLS transport layer. It is useful to to decrypt traffic
sent using ephemeral ciphers. This requires OpenSSL &gt;= 1.1.0, or BoringSSL.
It can be used in a tcp-check or an http-check ruleset.
</pre><a class="anchor" name="ssl_bc_session_id"></a><a class="anchor" name="7-ssl_bc_session_id"></a><a class="anchor" name="7.3.4-ssl_bc_session_id"></a><a class="anchor" name="ssl_bc_session_id (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_session_id (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_session_id"></a><a href="#7.3.4-ssl_bc_session_id">ssl_bc_session_id</a></b> : binary</div><pre class="text">Returns the SSL ID of the back connection when the outgoing connection was
made over an SSL/TLS transport layer. It is useful to log if we want to know
if session was reused or not. It can be used in a tcp-check or an http-check
ruleset.
</pre><a class="anchor" name="ssl_bc_session_key"></a><a class="anchor" name="7-ssl_bc_session_key"></a><a class="anchor" name="7.3.4-ssl_bc_session_key"></a><a class="anchor" name="ssl_bc_session_key (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_session_key (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_session_key"></a><a href="#7.3.4-ssl_bc_session_key">ssl_bc_session_key</a></b> : binary</div><pre class="text">Returns the SSL session master key of the back connection when the outgoing
connection was made over an SSL/TLS transport layer. It is useful to decrypt
traffic sent using ephemeral ciphers. This requires OpenSSL &gt;= 1.1.0, or
BoringSSL. It can be used in a tcp-check or an http-check ruleset.
</pre><a class="anchor" name="ssl_bc_use_keysize"></a><a class="anchor" name="7-ssl_bc_use_keysize"></a><a class="anchor" name="7.3.4-ssl_bc_use_keysize"></a><a class="anchor" name="ssl_bc_use_keysize (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_bc_use_keysize (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_bc_use_keysize"></a><a href="#7.3.4-ssl_bc_use_keysize">ssl_bc_use_keysize</a></b> : integer</div><pre class="text">Returns the symmetric cipher key size used in bits when the outgoing
connection was made over an SSL/TLS transport layer. It can be used in a
tcp-check or an http-check ruleset.
</pre><a class="anchor" name="ssl_c_ca_err"></a><a class="anchor" name="7-ssl_c_ca_err"></a><a class="anchor" name="7.3.4-ssl_c_ca_err"></a><a class="anchor" name="ssl_c_ca_err (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_ca_err (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_ca_err"></a><a href="#7.3.4-ssl_c_ca_err">ssl_c_ca_err</a></b> : integer</div><pre class="text">When the incoming connection was made over an SSL/TLS transport layer,
returns the ID of the first error detected during verification of the client
certificate at depth &gt; 0, or 0 if no error was encountered during this
verification process. Please refer to your SSL library's documentation to
find the exhaustive list of error codes.
</pre><a class="anchor" name="ssl_c_ca_err_depth"></a><a class="anchor" name="7-ssl_c_ca_err_depth"></a><a class="anchor" name="7.3.4-ssl_c_ca_err_depth"></a><a class="anchor" name="ssl_c_ca_err_depth (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_ca_err_depth (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_ca_err_depth"></a><a href="#7.3.4-ssl_c_ca_err_depth">ssl_c_ca_err_depth</a></b> : integer</div><pre class="text">When the incoming connection was made over an SSL/TLS transport layer,
returns the depth in the CA chain of the first error detected during the
verification of the client certificate. If no error is encountered, 0 is
returned.
</pre><a class="anchor" name="ssl_c_chain_der"></a><a class="anchor" name="7-ssl_c_chain_der"></a><a class="anchor" name="7.3.4-ssl_c_chain_der"></a><a class="anchor" name="ssl_c_chain_der (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_chain_der (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_chain_der"></a><a href="#7.3.4-ssl_c_chain_der">ssl_c_chain_der</a></b> : binary</div><pre class="text">Returns the DER formatted chain certificate presented by the client when the
incoming connection was made over an SSL/TLS transport layer. When used for
an ACL, the value(s) to match against can be passed in hexadecimal form. One
can parse the result with any lib accepting ASN.1 DER data. It currently
does not support resumed sessions.
</pre><a class="anchor" name="ssl_c_der"></a><a class="anchor" name="7-ssl_c_der"></a><a class="anchor" name="7.3.4-ssl_c_der"></a><a class="anchor" name="ssl_c_der (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_der (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_der"></a><a href="#7.3.4-ssl_c_der">ssl_c_der</a></b> : binary</div><pre class="text">Returns the DER formatted certificate presented by the client when the
incoming connection was made over an SSL/TLS transport layer. When used for
an ACL, the value(s) to match against can be passed in hexadecimal form.
</pre><a class="anchor" name="ssl_c_err"></a><a class="anchor" name="7-ssl_c_err"></a><a class="anchor" name="7.3.4-ssl_c_err"></a><a class="anchor" name="ssl_c_err (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_err (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_err"></a><a href="#7.3.4-ssl_c_err">ssl_c_err</a></b> : integer</div><pre class="text">When the incoming connection was made over an SSL/TLS transport layer,
returns the ID of the first error detected during verification at depth 0, or
0 if no error was encountered during this verification process. Please refer
to your SSL library's documentation to find the exhaustive list of error
codes.
</pre><a class="anchor" name="ssl_c_i_dn"></a><a class="anchor" name="7-ssl_c_i_dn"></a><a class="anchor" name="7.3.4-ssl_c_i_dn"></a><a class="anchor" name="ssl_c_i_dn (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_i_dn (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_i_dn"></a><a href="#7.3.4-ssl_c_i_dn">ssl_c_i_dn</a></b>(<span style="color: #008">[<span style="color: #080">&lt;entry&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;format&gt;</span>]</span>]</span>]</span>) : string</div><pre class="text">When the incoming connection was made over an SSL/TLS transport layer,
returns the full distinguished name of the issuer of the certificate
presented by the client when no &lt;entry&gt; is specified, or the value of the
first given entry found from the beginning of the DN. If a positive/negative
occurrence number is specified as the optional second argument, it returns
the value of the nth given entry value from the beginning/end of the DN.
For instance, &quot;ssl_c_i_dn(OU,2)&quot; the second organization unit, and
&quot;ssl_c_i_dn(CN)&quot; retrieves the common name.
The &lt;format&gt; parameter allows you to receive the DN suitable for
consumption by different protocols. Currently supported is rfc2253 for
LDAP v3.
If you'd like to modify the format only you can specify an empty string
and zero for the first two parameters. Example: ssl_c_i_dn(,0,rfc2253)
</pre><a class="anchor" name="ssl_c_key_alg"></a><a class="anchor" name="7-ssl_c_key_alg"></a><a class="anchor" name="7.3.4-ssl_c_key_alg"></a><a class="anchor" name="ssl_c_key_alg (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_key_alg (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_key_alg"></a><a href="#7.3.4-ssl_c_key_alg">ssl_c_key_alg</a></b> : string</div><pre class="text">Returns the name of the algorithm used to generate the key of the certificate
presented by the client when the incoming connection was made over an SSL/TLS
transport layer.
</pre><a class="anchor" name="ssl_c_notafter"></a><a class="anchor" name="7-ssl_c_notafter"></a><a class="anchor" name="7.3.4-ssl_c_notafter"></a><a class="anchor" name="ssl_c_notafter (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_notafter (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_notafter"></a><a href="#7.3.4-ssl_c_notafter">ssl_c_notafter</a></b> : string</div><pre class="text">Returns the end date presented by the client as a formatted string
YYMMDDhhmmss[Z] when the incoming connection was made over an SSL/TLS
transport layer.
</pre><a class="anchor" name="ssl_c_notbefore"></a><a class="anchor" name="7-ssl_c_notbefore"></a><a class="anchor" name="7.3.4-ssl_c_notbefore"></a><a class="anchor" name="ssl_c_notbefore (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_notbefore (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_notbefore"></a><a href="#7.3.4-ssl_c_notbefore">ssl_c_notbefore</a></b> : string</div><pre class="text">Returns the start date presented by the client as a formatted string
YYMMDDhhmmss[Z] when the incoming connection was made over an SSL/TLS
transport layer.
</pre><a class="anchor" name="ssl_c_r_dn"></a><a class="anchor" name="7-ssl_c_r_dn"></a><a class="anchor" name="7.3.4-ssl_c_r_dn"></a><a class="anchor" name="ssl_c_r_dn (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_r_dn (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_r_dn"></a><a href="#7.3.4-ssl_c_r_dn">ssl_c_r_dn</a></b>(<span style="color: #008">[<span style="color: #080">&lt;entry&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;format&gt;</span>]</span>]</span>]</span>) : string</div><pre class="text">When the incoming connection was made over an SSL/TLS transport layer, and is
successfully validated with the configured ca-file, returns the full
distinguished name of the root CA of the certificate presented by the client
when no &lt;entry&gt; is specified, or the value of the first given entry found from
the beginning of the DN. If a positive/negative occurrence number is specified
as the optional second argument, it returns the value of the nth given entry
value from the beginning/end of the DN. For instance, &quot;ssl_c_r_dn(OU,2)&quot; the
second organization unit, and &quot;ssl_c_r_dn(CN)&quot; retrieves the common name. The
&lt;format&gt; parameter allows you to receive the DN suitable for consumption by
different protocols. Currently supported is rfc2253 for LDAP v3. If you'd like
to modify the format only you can specify an empty string and zero for the
first two parameters. Example: ssl_c_r_dn(,0,rfc2253)
</pre><a class="anchor" name="ssl_c_s_dn"></a><a class="anchor" name="7-ssl_c_s_dn"></a><a class="anchor" name="7.3.4-ssl_c_s_dn"></a><a class="anchor" name="ssl_c_s_dn (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_s_dn (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_s_dn"></a><a href="#7.3.4-ssl_c_s_dn">ssl_c_s_dn</a></b>(<span style="color: #008">[<span style="color: #080">&lt;entry&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;format&gt;</span>]</span>]</span>]</span>) : string</div><pre class="text">When the incoming connection was made over an SSL/TLS transport layer,
returns the full distinguished name of the subject of the certificate
presented by the client when no &lt;entry&gt; is specified, or the value of the
first given entry found from the beginning of the DN. If a positive/negative
occurrence number is specified as the optional second argument, it returns
the value of the nth given entry value from the beginning/end of the DN.
For instance, &quot;ssl_c_s_dn(OU,2)&quot; the second organization unit, and
&quot;ssl_c_s_dn(CN)&quot; retrieves the common name.
The &lt;format&gt; parameter allows you to receive the DN suitable for
consumption by different protocols. Currently supported is rfc2253 for
LDAP v3.
If you'd like to modify the format only you can specify an empty string
and zero for the first two parameters. Example: ssl_c_s_dn(,0,rfc2253)
</pre><a class="anchor" name="ssl_c_san"></a><a class="anchor" name="7-ssl_c_san"></a><a class="anchor" name="7.3.4-ssl_c_san"></a><a class="anchor" name="ssl_c_san (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_san (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_san"></a><a href="#7.3.4-ssl_c_san">ssl_c_san</a></b> : string</div><pre class="text">When the incoming connection was made over an SSL/TLS transport layer, and was
provided with a client certificate. Returns a string of comma separated
Subject Alt Name fields contained into the provided certificate.

This can be used to inspect the client certificate.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>acl is_valid_client_cert ssl_c_used &amp;&amp; ! ssl_c_verify
http-request set-header X-SSL-Client-SAN %[ssl_c_san] if is_valid_client_cert
</code></pre>
</div><pre class="text">will results in:

  X-SSL-Client-SAN: IP Address:127.0.0.1, IP Address:127.0.0.2, IP Address:127.0.0.3, URI:http://docs.haproxy.org/2.7/, DNS:ca.tests.haproxy.com
</pre><a class="anchor" name="ssl_c_serial"></a><a class="anchor" name="7-ssl_c_serial"></a><a class="anchor" name="7.3.4-ssl_c_serial"></a><a class="anchor" name="ssl_c_serial (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_serial (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_serial"></a><a href="#7.3.4-ssl_c_serial">ssl_c_serial</a></b> : binary</div><pre class="text">Returns the serial of the certificate presented by the client when the
incoming connection was made over an SSL/TLS transport layer. When used for
an ACL, the value(s) to match against can be passed in hexadecimal form.
</pre><a class="anchor" name="ssl_c_sha1"></a><a class="anchor" name="7-ssl_c_sha1"></a><a class="anchor" name="7.3.4-ssl_c_sha1"></a><a class="anchor" name="ssl_c_sha1 (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_sha1 (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_sha1"></a><a href="#7.3.4-ssl_c_sha1">ssl_c_sha1</a></b> : binary</div><pre class="text">Returns the SHA-1 fingerprint of the certificate presented by the client when
the incoming connection was made over an SSL/TLS transport layer. This can be
used to stick a client to a server, or to pass this information to a server.
Note that the output is binary, so if you want to pass that signature to the
server, you need to encode it in hex or base64, such as in the example below:
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request set-header X-SSL-Client-SHA1 %[ssl_c_sha1,hex]
</code></pre>
</div><a class="anchor" name="ssl_c_sig_alg"></a><a class="anchor" name="7-ssl_c_sig_alg"></a><a class="anchor" name="7.3.4-ssl_c_sig_alg"></a><a class="anchor" name="ssl_c_sig_alg (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_sig_alg (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_sig_alg"></a><a href="#7.3.4-ssl_c_sig_alg">ssl_c_sig_alg</a></b> : string</div><pre class="text">Returns the name of the algorithm used to sign the certificate presented by
the client when the incoming connection was made over an SSL/TLS transport
layer.
</pre><a class="anchor" name="ssl_c_used"></a><a class="anchor" name="7-ssl_c_used"></a><a class="anchor" name="7.3.4-ssl_c_used"></a><a class="anchor" name="ssl_c_used (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_used (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_used"></a><a href="#7.3.4-ssl_c_used">ssl_c_used</a></b> : boolean</div><pre class="text">Returns true if current SSL session uses a client certificate even if current
connection uses SSL session resumption. See also &quot;<a href="#ssl_fc_has_crt">ssl_fc_has_crt</a>&quot;.
</pre><a class="anchor" name="ssl_c_verify"></a><a class="anchor" name="7-ssl_c_verify"></a><a class="anchor" name="7.3.4-ssl_c_verify"></a><a class="anchor" name="ssl_c_verify (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_verify (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_verify"></a><a href="#7.3.4-ssl_c_verify">ssl_c_verify</a></b> : integer</div><pre class="text">Returns the verify result error ID when the incoming connection was made over
an SSL/TLS transport layer, otherwise zero if no error is encountered. Please
refer to your SSL library's documentation for an exhaustive list of error
codes.
</pre><a class="anchor" name="ssl_c_version"></a><a class="anchor" name="7-ssl_c_version"></a><a class="anchor" name="7.3.4-ssl_c_version"></a><a class="anchor" name="ssl_c_version (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_c_version (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_c_version"></a><a href="#7.3.4-ssl_c_version">ssl_c_version</a></b> : integer</div><pre class="text">Returns the version of the certificate presented by the client when the
incoming connection was made over an SSL/TLS transport layer.
</pre><a class="anchor" name="ssl_f_der"></a><a class="anchor" name="7-ssl_f_der"></a><a class="anchor" name="7.3.4-ssl_f_der"></a><a class="anchor" name="ssl_f_der (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_f_der (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_f_der"></a><a href="#7.3.4-ssl_f_der">ssl_f_der</a></b> : binary</div><pre class="text">Returns the DER formatted certificate presented by the frontend when the
incoming connection was made over an SSL/TLS transport layer. When used for
an ACL, the value(s) to match against can be passed in hexadecimal form.
</pre><a class="anchor" name="ssl_f_i_dn"></a><a class="anchor" name="7-ssl_f_i_dn"></a><a class="anchor" name="7.3.4-ssl_f_i_dn"></a><a class="anchor" name="ssl_f_i_dn (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_f_i_dn (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_f_i_dn"></a><a href="#7.3.4-ssl_f_i_dn">ssl_f_i_dn</a></b>(<span style="color: #008">[<span style="color: #080">&lt;entry&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;format&gt;</span>]</span>]</span>]</span>) : string</div><pre class="text">When the incoming connection was made over an SSL/TLS transport layer,
returns the full distinguished name of the issuer of the certificate
presented by the frontend when no &lt;entry&gt; is specified, or the value of the
first given entry found from the beginning of the DN. If a positive/negative
occurrence number is specified as the optional second argument, it returns
the value of the nth given entry value from the beginning/end of the DN.
For instance, &quot;ssl_f_i_dn(OU,2)&quot; the second organization unit, and
&quot;ssl_f_i_dn(CN)&quot; retrieves the common name.
The &lt;format&gt; parameter allows you to receive the DN suitable for
consumption by different protocols. Currently supported is rfc2253 for
LDAP v3.
If you'd like to modify the format only you can specify an empty string
and zero for the first two parameters. Example: ssl_f_i_dn(,0,rfc2253)
</pre><a class="anchor" name="ssl_f_key_alg"></a><a class="anchor" name="7-ssl_f_key_alg"></a><a class="anchor" name="7.3.4-ssl_f_key_alg"></a><a class="anchor" name="ssl_f_key_alg (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_f_key_alg (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_f_key_alg"></a><a href="#7.3.4-ssl_f_key_alg">ssl_f_key_alg</a></b> : string</div><pre class="text">Returns the name of the algorithm used to generate the key of the certificate
presented by the frontend when the incoming connection was made over an
SSL/TLS transport layer.
</pre><a class="anchor" name="ssl_f_notafter"></a><a class="anchor" name="7-ssl_f_notafter"></a><a class="anchor" name="7.3.4-ssl_f_notafter"></a><a class="anchor" name="ssl_f_notafter (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_f_notafter (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_f_notafter"></a><a href="#7.3.4-ssl_f_notafter">ssl_f_notafter</a></b> : string</div><pre class="text">Returns the end date presented by the frontend as a formatted string
YYMMDDhhmmss[Z] when the incoming connection was made over an SSL/TLS
transport layer.
</pre><a class="anchor" name="ssl_f_notbefore"></a><a class="anchor" name="7-ssl_f_notbefore"></a><a class="anchor" name="7.3.4-ssl_f_notbefore"></a><a class="anchor" name="ssl_f_notbefore (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_f_notbefore (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_f_notbefore"></a><a href="#7.3.4-ssl_f_notbefore">ssl_f_notbefore</a></b> : string</div><pre class="text">Returns the start date presented by the frontend as a formatted string
YYMMDDhhmmss[Z] when the incoming connection was made over an SSL/TLS
transport layer.
</pre><a class="anchor" name="ssl_f_s_dn"></a><a class="anchor" name="7-ssl_f_s_dn"></a><a class="anchor" name="7.3.4-ssl_f_s_dn"></a><a class="anchor" name="ssl_f_s_dn (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_f_s_dn (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_f_s_dn"></a><a href="#7.3.4-ssl_f_s_dn">ssl_f_s_dn</a></b>(<span style="color: #008">[<span style="color: #080">&lt;entry&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;format&gt;</span>]</span>]</span>]</span>) : string</div><pre class="text">When the incoming connection was made over an SSL/TLS transport layer,
returns the full distinguished name of the subject of the certificate
presented by the frontend when no &lt;entry&gt; is specified, or the value of the
first given entry found from the beginning of the DN. If a positive/negative
occurrence number is specified as the optional second argument, it returns
the value of the nth given entry value from the beginning/end of the DN.
For instance, &quot;ssl_f_s_dn(OU,2)&quot; the second organization unit, and
&quot;ssl_f_s_dn(CN)&quot; retrieves the common name.
The &lt;format&gt; parameter allows you to receive the DN suitable for
consumption by different protocols. Currently supported is rfc2253 for
LDAP v3.
If you'd like to modify the format only you can specify an empty string
and zero for the first two parameters. Example: ssl_f_s_dn(,0,rfc2253)
</pre><a class="anchor" name="ssl_f_serial"></a><a class="anchor" name="7-ssl_f_serial"></a><a class="anchor" name="7.3.4-ssl_f_serial"></a><a class="anchor" name="ssl_f_serial (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_f_serial (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_f_serial"></a><a href="#7.3.4-ssl_f_serial">ssl_f_serial</a></b> : binary</div><pre class="text">Returns the serial of the certificate presented by the frontend when the
incoming connection was made over an SSL/TLS transport layer. When used for
an ACL, the value(s) to match against can be passed in hexadecimal form.
</pre><a class="anchor" name="ssl_f_sha1"></a><a class="anchor" name="7-ssl_f_sha1"></a><a class="anchor" name="7.3.4-ssl_f_sha1"></a><a class="anchor" name="ssl_f_sha1 (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_f_sha1 (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_f_sha1"></a><a href="#7.3.4-ssl_f_sha1">ssl_f_sha1</a></b> : binary</div><pre class="text">Returns the SHA-1 fingerprint of the certificate presented by the frontend
when the incoming connection was made over an SSL/TLS transport layer. This
can be used to know which certificate was chosen using SNI.
</pre><a class="anchor" name="ssl_f_sig_alg"></a><a class="anchor" name="7-ssl_f_sig_alg"></a><a class="anchor" name="7.3.4-ssl_f_sig_alg"></a><a class="anchor" name="ssl_f_sig_alg (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_f_sig_alg (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_f_sig_alg"></a><a href="#7.3.4-ssl_f_sig_alg">ssl_f_sig_alg</a></b> : string</div><pre class="text">Returns the name of the algorithm used to sign the certificate presented by
the frontend when the incoming connection was made over an SSL/TLS transport
layer.
</pre><a class="anchor" name="ssl_f_version"></a><a class="anchor" name="7-ssl_f_version"></a><a class="anchor" name="7.3.4-ssl_f_version"></a><a class="anchor" name="ssl_f_version (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_f_version (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_f_version"></a><a href="#7.3.4-ssl_f_version">ssl_f_version</a></b> : integer</div><pre class="text">Returns the version of the certificate presented by the frontend when the
incoming connection was made over an SSL/TLS transport layer.
</pre><a class="anchor" name="ssl_fc"></a><a class="anchor" name="7-ssl_fc"></a><a class="anchor" name="7.3.4-ssl_fc"></a><a class="anchor" name="ssl_fc (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc"></a><a href="#7.3.4-ssl_fc">ssl_fc</a></b> : boolean</div><pre class="text">Returns true when the front connection was made via an SSL/TLS transport
layer and is locally deciphered. This means it has matched a socket declared
with a &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line having the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; option.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># This passes &quot;X-Proto: https&quot; to servers when client connects over SSL</span>
listen http-https
    bind :80
    bind :443 ssl crt /etc/haproxy.pem
    http-request add-header X-Proto https if { ssl_fc }
</code></pre>
</div><a class="anchor" name="ssl_fc_alg_keysize"></a><a class="anchor" name="7-ssl_fc_alg_keysize"></a><a class="anchor" name="7.3.4-ssl_fc_alg_keysize"></a><a class="anchor" name="ssl_fc_alg_keysize (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_alg_keysize (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_alg_keysize"></a><a href="#7.3.4-ssl_fc_alg_keysize">ssl_fc_alg_keysize</a></b> : integer</div><pre class="text">Returns the symmetric cipher key size supported in bits when the incoming
connection was made over an SSL/TLS transport layer.
</pre><a class="anchor" name="ssl_fc_alpn"></a><a class="anchor" name="7-ssl_fc_alpn"></a><a class="anchor" name="7.3.4-ssl_fc_alpn"></a><a class="anchor" name="ssl_fc_alpn (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_alpn (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_alpn"></a><a href="#7.3.4-ssl_fc_alpn">ssl_fc_alpn</a></b> : string</div><pre class="text">This extracts the Application Layer Protocol Negotiation field from an
incoming connection made via a TLS transport layer and locally deciphered by
HAProxy. The result is a string containing the protocol name advertised by
the client. The SSL library must have been built with support for TLS
extensions enabled (check haproxy -vv). Note that the TLS ALPN extension is
not advertised unless the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">alpn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#alpn%20%28Bind%20options%29">Bind options</a></li><li><a href="#alpn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword on the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line specifies a
protocol list. Also, nothing forces the client to pick a protocol from this
list, any other one may be requested. The TLS ALPN extension is meant to
replace the TLS NPN extension. See also &quot;<a href="#ssl_fc_npn">ssl_fc_npn</a>&quot;.
</pre><a class="anchor" name="ssl_fc_cipher"></a><a class="anchor" name="7-ssl_fc_cipher"></a><a class="anchor" name="7.3.4-ssl_fc_cipher"></a><a class="anchor" name="ssl_fc_cipher (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_cipher (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_cipher"></a><a href="#7.3.4-ssl_fc_cipher">ssl_fc_cipher</a></b> : string</div><pre class="text">Returns the name of the used cipher when the incoming connection was made
over an SSL/TLS transport layer.
</pre><a class="anchor" name="ssl_fc_cipherlist_bin"></a><a class="anchor" name="7-ssl_fc_cipherlist_bin"></a><a class="anchor" name="7.3.4-ssl_fc_cipherlist_bin"></a><a class="anchor" name="ssl_fc_cipherlist_bin (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_cipherlist_bin (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_cipherlist_bin"></a><a href="#7.3.4-ssl_fc_cipherlist_bin">ssl_fc_cipherlist_bin</a></b>(<span style="color: #008">[<span style="color: #080">&lt;filter_option&gt;</span>]</span>) : binary</div><pre class="text">Returns the binary form of the client hello cipher list. The maximum
returned value length is limited by the shared capture buffer size
controlled by &quot;<a href="#tune.ssl.capture-buffer-size">tune.ssl.capture-buffer-size</a>&quot; setting. Setting
&lt;filter_option&gt; allows to filter returned data. Accepted values:
  0 : return the full list of ciphers (default)
  1 : exclude GREASE (RFC8701) values from the output
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request set-header X-SSL-JA3 %[ssl_fc_protocol_hello_id],\
    %[ssl_fc_cipherlist_bin(1),be2dec(-,2)],\
    %[ssl_fc_extlist_bin(1),be2dec(-,2)],\
    %[ssl_fc_eclist_bin(1),be2dec(-,2)],\
    %[ssl_fc_ecformats_bin,be2dec(-,1)]
acl is_malware req.fhdr(x-ssl-ja3),digest(md5),hex \
    -f /path/to/file/with/malware-ja3.lst
http-request set-header X-Malware True if is_malware
http-request set-header X-Malware False if !is_malware
</code></pre>
</div><a class="anchor" name="ssl_fc_cipherlist_hex"></a><a class="anchor" name="7-ssl_fc_cipherlist_hex"></a><a class="anchor" name="7.3.4-ssl_fc_cipherlist_hex"></a><a class="anchor" name="ssl_fc_cipherlist_hex (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_cipherlist_hex (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_cipherlist_hex"></a><a href="#7.3.4-ssl_fc_cipherlist_hex">ssl_fc_cipherlist_hex</a></b>(<span style="color: #008">[<span style="color: #080">&lt;filter_option&gt;</span>]</span>) : string</div><pre class="text">Returns the binary form of the client hello cipher list encoded as
hexadecimal. The maximum returned value length is limited by the shared
capture buffer size controlled by &quot;<a href="#tune.ssl.capture-buffer-size">tune.ssl.capture-buffer-size</a>&quot; setting.
Setting &lt;filter_option&gt; allows to filter returned data. Accepted values:
  0 : return the full list of ciphers (default)
  1 : exclude GREASE (RFC8701) values from the output
</pre><a class="anchor" name="ssl_fc_cipherlist_str"></a><a class="anchor" name="7-ssl_fc_cipherlist_str"></a><a class="anchor" name="7.3.4-ssl_fc_cipherlist_str"></a><a class="anchor" name="ssl_fc_cipherlist_str (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_cipherlist_str (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_cipherlist_str"></a><a href="#7.3.4-ssl_fc_cipherlist_str">ssl_fc_cipherlist_str</a></b>(<span style="color: #008">[<span style="color: #080">&lt;filter_option&gt;</span>]</span>) : string</div><pre class="text">Returns the decoded text form of the client hello cipher list. The maximum
returned value length is limited by the shared capture buffer size
controlled by &quot;<a href="#tune.ssl.capture-buffer-size">tune.ssl.capture-buffer-size</a>&quot; setting. Setting
&lt;filter_option&gt; allows to filter returned data. Accepted values:
  0 : return the full list of ciphers (default)
  1 : exclude GREASE (RFC8701) values from the output
Note that this sample-fetch is only available with OpenSSL &gt;= 1.0.2. If the
function is not enabled, this sample-fetch returns the hash like
&quot;<a href="#ssl_fc_cipherlist_xxh">ssl_fc_cipherlist_xxh</a>&quot;.
</pre><a class="anchor" name="ssl_fc_cipherlist_xxh"></a><a class="anchor" name="7-ssl_fc_cipherlist_xxh"></a><a class="anchor" name="7.3.4-ssl_fc_cipherlist_xxh"></a><a class="anchor" name="ssl_fc_cipherlist_xxh (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_cipherlist_xxh (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_cipherlist_xxh"></a><a href="#7.3.4-ssl_fc_cipherlist_xxh">ssl_fc_cipherlist_xxh</a></b> : integer</div><pre class="text">Returns a xxh64 of the cipher list. This hash can return only if the value
&quot;<a href="#tune.ssl.capture-buffer-size">tune.ssl.capture-buffer-size</a>&quot; is set greater than 0, however the hash take
into account all the data of the cipher list.
</pre><a class="anchor" name="ssl_fc_curve"></a><a class="anchor" name="7-ssl_fc_curve"></a><a class="anchor" name="7.3.4-ssl_fc_curve"></a><a class="anchor" name="ssl_fc_curve (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_curve (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_curve"></a><a href="#7.3.4-ssl_fc_curve">ssl_fc_curve</a></b> : string</div><pre class="text">Returns the name of the curve used in the key agreement when the incoming
connection was made over an SSL/TLS transport layer. This requires
OpenSSL &gt;= 3.0.0.
</pre><a class="anchor" name="ssl_fc_ecformats_bin"></a><a class="anchor" name="7-ssl_fc_ecformats_bin"></a><a class="anchor" name="7.3.4-ssl_fc_ecformats_bin"></a><a class="anchor" name="ssl_fc_ecformats_bin (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_ecformats_bin (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_ecformats_bin"></a><a href="#7.3.4-ssl_fc_ecformats_bin">ssl_fc_ecformats_bin</a></b> : binary</div><pre class="text">Return the binary form of the client hello supported elliptic curve point
formats. The maximum returned value length is limited by the shared capture
buffer size controlled by &quot;<a href="#tune.ssl.capture-buffer-size">tune.ssl.capture-buffer-size</a>&quot; setting.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request set-header X-SSL-JA3 %[ssl_fc_protocol_hello_id],\
    %[ssl_fc_cipherlist_bin(1),be2dec(-,2)],\
    %[ssl_fc_extlist_bin(1),be2dec(-,2)],\
    %[ssl_fc_eclist_bin(1),be2dec(-,2)],\
    %[ssl_fc_ecformats_bin,be2dec(-,1)]
acl is_malware req.fhdr(x-ssl-ja3),digest(md5),hex \
    -f /path/to/file/with/malware-ja3.lst
http-request set-header X-Malware True if is_malware
http-request set-header X-Malware False if !is_malware
</code></pre>
</div><a class="anchor" name="ssl_fc_eclist_bin"></a><a class="anchor" name="7-ssl_fc_eclist_bin"></a><a class="anchor" name="7.3.4-ssl_fc_eclist_bin"></a><a class="anchor" name="ssl_fc_eclist_bin (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_eclist_bin (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_eclist_bin"></a><a href="#7.3.4-ssl_fc_eclist_bin">ssl_fc_eclist_bin</a></b>(<span style="color: #008">[<span style="color: #080">&lt;filter_option&gt;</span>]</span>) : binary</div><pre class="text">Returns the binary form of the client hello supported elliptic curves. The
maximum returned value length is limited by the shared capture buffer size
controlled by &quot;<a href="#tune.ssl.capture-buffer-size">tune.ssl.capture-buffer-size</a>&quot; setting. Setting
&lt;filter_option&gt; allows to filter returned data. Accepted values:
  0 : return the full list of supported elliptic curves (default)
  1 : exclude GREASE (RFC8701) values from the output
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request set-header X-SSL-JA3 %[ssl_fc_protocol_hello_id],\
    %[ssl_fc_cipherlist_bin(1),be2dec(-,2)],\
    %[ssl_fc_extlist_bin(1),be2dec(-,2)],\
    %[ssl_fc_eclist_bin(1),be2dec(-,2)],\
    %[ssl_fc_ecformats_bin,be2dec(-,1)]
acl is_malware req.fhdr(x-ssl-ja3),digest(md5),hex \
    -f /path/to/file/with/malware-ja3.lst
http-request set-header X-Malware True if is_malware
http-request set-header X-Malware False if !is_malware
</code></pre>
</div><a class="anchor" name="ssl_fc_extlist_bin"></a><a class="anchor" name="7-ssl_fc_extlist_bin"></a><a class="anchor" name="7.3.4-ssl_fc_extlist_bin"></a><a class="anchor" name="ssl_fc_extlist_bin (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_extlist_bin (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_extlist_bin"></a><a href="#7.3.4-ssl_fc_extlist_bin">ssl_fc_extlist_bin</a></b>(<span style="color: #008">[<span style="color: #080">&lt;filter_option&gt;</span>]</span>) : binary</div><pre class="text">Returns the binary form of the client hello extension list. The maximum
returned value length is limited by the shared capture buffer size
controlled by &quot;<a href="#tune.ssl.capture-buffer-size">tune.ssl.capture-buffer-size</a>&quot; setting. Setting
&lt;filter_option&gt; allows to filter returned data. Accepted values:
  0 : return the full list of extensions (default)
  1 : exclude GREASE (RFC8701) values from the output
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request set-header X-SSL-JA3 %[ssl_fc_protocol_hello_id],\
    %[ssl_fc_cipherlist_bin(1),be2dec(-,2)],\
    %[ssl_fc_extlist_bin(1),be2dec(-,2)],\
    %[ssl_fc_eclist_bin(1),be2dec(-,2)],\
    %[ssl_fc_ecformats_bin,be2dec(-,1)]
acl is_malware req.fhdr(x-ssl-ja3),digest(md5),hex \
    -f /path/to/file/with/malware-ja3.lst
http-request set-header X-Malware True if is_malware
http-request set-header X-Malware False if !is_malware
</code></pre>
</div><a class="anchor" name="ssl_fc_client_random"></a><a class="anchor" name="7-ssl_fc_client_random"></a><a class="anchor" name="7.3.4-ssl_fc_client_random"></a><a class="anchor" name="ssl_fc_client_random (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_client_random (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_client_random"></a><a href="#7.3.4-ssl_fc_client_random">ssl_fc_client_random</a></b> : binary</div><pre class="text">Returns the client random of the front connection when the incoming connection
was made over an SSL/TLS transport layer. It is useful to to decrypt traffic
sent using ephemeral ciphers. This requires OpenSSL &gt;= 1.1.0, or BoringSSL.
</pre><a class="anchor" name="ssl_fc_client_early_traffic_secret"></a><a class="anchor" name="7-ssl_fc_client_early_traffic_secret"></a><a class="anchor" name="7.3.4-ssl_fc_client_early_traffic_secret"></a><a class="anchor" name="ssl_fc_client_early_traffic_secret (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_client_early_traffic_secret (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_client_early_traffic_secret"></a><a href="#7.3.4-ssl_fc_client_early_traffic_secret">ssl_fc_client_early_traffic_secret</a></b> : string</div><pre class="text">Return the CLIENT_EARLY_TRAFFIC_SECRET as an hexadecimal string for the
front connection when the incoming connection was made over a TLS 1.3
transport layer.
Require OpenSSL &gt;= 1.1.1. This is one of the keys dumped by the OpenSSL
keylog callback to generate the SSLKEYLOGFILE. The SSL Key logging must be
activated with &quot;tune.ssl.keylog on&quot; in the global section. See also
&quot;<a href="#tune.ssl.keylog">tune.ssl.keylog</a>&quot;
</pre><a class="anchor" name="ssl_fc_client_handshake_traffic_secret"></a><a class="anchor" name="7-ssl_fc_client_handshake_traffic_secret"></a><a class="anchor" name="7.3.4-ssl_fc_client_handshake_traffic_secret"></a><a class="anchor" name="ssl_fc_client_handshake_traffic_secret (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_client_handshake_traffic_secret (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_client_handshake_traffic_secret"></a><a href="#7.3.4-ssl_fc_client_handshake_traffic_secret">ssl_fc_client_handshake_traffic_secret</a></b> : string</div><pre class="text">Return the CLIENT_HANDSHAKE_TRAFFIC_SECRET as an hexadecimal string for the
front connection when the incoming connection was made over a TLS 1.3
transport layer.
Require OpenSSL &gt;= 1.1.1. This is one of the keys dumped by the OpenSSL
keylog callback to generate the SSLKEYLOGFILE. The SSL Key logging must be
activated with &quot;tune.ssl.keylog on&quot; in the global section. See also
&quot;<a href="#tune.ssl.keylog">tune.ssl.keylog</a>&quot;
</pre><a class="anchor" name="ssl_fc_client_traffic_secret_0"></a><a class="anchor" name="7-ssl_fc_client_traffic_secret_0"></a><a class="anchor" name="7.3.4-ssl_fc_client_traffic_secret_0"></a><a class="anchor" name="ssl_fc_client_traffic_secret_0 (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_client_traffic_secret_0 (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_client_traffic_secret_0"></a><a href="#7.3.4-ssl_fc_client_traffic_secret_0">ssl_fc_client_traffic_secret_0</a></b> : string</div><pre class="text">Return the CLIENT_TRAFFIC_SECRET_0 as an hexadecimal string for the
front connection when the incoming connection was made over a TLS 1.3
transport layer.
Require OpenSSL &gt;= 1.1.1. This is one of the keys dumped by the OpenSSL
keylog callback to generate the SSLKEYLOGFILE. The SSL Key logging must be
activated with &quot;tune.ssl.keylog on&quot; in the global section. See also
&quot;<a href="#tune.ssl.keylog">tune.ssl.keylog</a>&quot;
</pre><a class="anchor" name="ssl_fc_exporter_secret"></a><a class="anchor" name="7-ssl_fc_exporter_secret"></a><a class="anchor" name="7.3.4-ssl_fc_exporter_secret"></a><a class="anchor" name="ssl_fc_exporter_secret (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_exporter_secret (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_exporter_secret"></a><a href="#7.3.4-ssl_fc_exporter_secret">ssl_fc_exporter_secret</a></b> : string</div><pre class="text">Return the EXPORTER_SECRET as an hexadecimal string for the
front connection when the incoming connection was made over a TLS 1.3
transport layer.
Require OpenSSL &gt;= 1.1.1. This is one of the keys dumped by the OpenSSL
keylog callback to generate the SSLKEYLOGFILE. The SSL Key logging must be
activated with &quot;tune.ssl.keylog on&quot; in the global section. See also
&quot;<a href="#tune.ssl.keylog">tune.ssl.keylog</a>&quot;
</pre><a class="anchor" name="ssl_fc_early_exporter_secret"></a><a class="anchor" name="7-ssl_fc_early_exporter_secret"></a><a class="anchor" name="7.3.4-ssl_fc_early_exporter_secret"></a><a class="anchor" name="ssl_fc_early_exporter_secret (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_early_exporter_secret (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_early_exporter_secret"></a><a href="#7.3.4-ssl_fc_early_exporter_secret">ssl_fc_early_exporter_secret</a></b> : string</div><pre class="text">Return the EARLY_EXPORTER_SECRET as an hexadecimal string for the
front connection when the incoming connection was made over an TLS 1.3
transport layer.
Require OpenSSL &gt;= 1.1.1. This is one of the keys dumped by the OpenSSL
keylog callback to generate the SSLKEYLOGFILE. The SSL Key logging must be
activated with &quot;tune.ssl.keylog on&quot; in the global section. See also
&quot;<a href="#tune.ssl.keylog">tune.ssl.keylog</a>&quot;
</pre><a class="anchor" name="ssl_fc_err"></a><a class="anchor" name="7-ssl_fc_err"></a><a class="anchor" name="7.3.4-ssl_fc_err"></a><a class="anchor" name="ssl_fc_err (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_err (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_err"></a><a href="#7.3.4-ssl_fc_err">ssl_fc_err</a></b> : integer</div><pre class="text">When the incoming connection was made over an SSL/TLS transport layer,
returns the ID of the last error of the first error stack raised on the
frontend side, or 0 if no error was encountered. It can be used to identify
handshake related errors other than verify ones (such as cipher mismatch), as
well as other read or write errors occurring during the connection's
lifetime.  Any error happening during the client's certificate verification
process will not be raised through this fetch but via the existing
&quot;<a href="#ssl_c_err">ssl_c_err</a>&quot;, &quot;<a href="#ssl_c_ca_err">ssl_c_ca_err</a>&quot; and &quot;<a href="#ssl_c_ca_err_depth">ssl_c_ca_err_depth</a>&quot; fetches. In order to get
a text description of this error code, you can either use the
&quot;<a href="#ssl_fc_err_str">ssl_fc_err_str</a>&quot; sample fetch or use the &quot;openssl errstr&quot; command (which
takes an error code in hexadecimal representation as parameter). Please refer
to your SSL library's documentation to find the exhaustive list of error
codes.
</pre><a class="anchor" name="ssl_fc_err_str"></a><a class="anchor" name="7-ssl_fc_err_str"></a><a class="anchor" name="7.3.4-ssl_fc_err_str"></a><a class="anchor" name="ssl_fc_err_str (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_err_str (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_err_str"></a><a href="#7.3.4-ssl_fc_err_str">ssl_fc_err_str</a></b> : string</div><pre class="text">When the incoming connection was made over an SSL/TLS transport layer,
returns a string representation of the last error of the first error stack
that was raised on the frontend side. Any error happening during the client's
certificate verification process will not be raised through this fetch. See
also &quot;<a href="#ssl_fc_err">ssl_fc_err</a>&quot;.
</pre><a class="anchor" name="ssl_fc_has_crt"></a><a class="anchor" name="7-ssl_fc_has_crt"></a><a class="anchor" name="7.3.4-ssl_fc_has_crt"></a><a class="anchor" name="ssl_fc_has_crt (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_has_crt (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_has_crt"></a><a href="#7.3.4-ssl_fc_has_crt">ssl_fc_has_crt</a></b> : boolean</div><pre class="text">Returns true if a client certificate is present in an incoming connection over
SSL/TLS transport layer. Useful if 'verify' statement is set to 'optional'.
Note: on SSL session resumption with Session ID or TLS ticket, client
certificate is not present in the current connection but may be retrieved
from the cache or the ticket. So prefer &quot;<a href="#ssl_c_used">ssl_c_used</a>&quot; if you want to check if
current SSL session uses a client certificate.
</pre><a class="anchor" name="ssl_fc_has_early"></a><a class="anchor" name="7-ssl_fc_has_early"></a><a class="anchor" name="7.3.4-ssl_fc_has_early"></a><a class="anchor" name="ssl_fc_has_early (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_has_early (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_has_early"></a><a href="#7.3.4-ssl_fc_has_early">ssl_fc_has_early</a></b> : boolean</div><pre class="text">Returns true if early data were sent, and the handshake didn't happen yet. As
it has security implications, it is useful to be able to refuse those, or
wait until the handshake happened.
</pre><a class="anchor" name="ssl_fc_has_sni"></a><a class="anchor" name="7-ssl_fc_has_sni"></a><a class="anchor" name="7.3.4-ssl_fc_has_sni"></a><a class="anchor" name="ssl_fc_has_sni (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_has_sni (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_has_sni"></a><a href="#7.3.4-ssl_fc_has_sni">ssl_fc_has_sni</a></b> : boolean</div><pre class="text">This checks for the presence of a Server Name Indication TLS extension (SNI)
in an incoming connection was made over an SSL/TLS transport layer. Returns
true when the incoming connection presents a TLS SNI field. This requires
that the SSL library is built with support for TLS extensions enabled (check
haproxy -vv).
</pre><a class="anchor" name="ssl_fc_is_resumed"></a><a class="anchor" name="7-ssl_fc_is_resumed"></a><a class="anchor" name="7.3.4-ssl_fc_is_resumed"></a><a class="anchor" name="ssl_fc_is_resumed (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_is_resumed (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_is_resumed"></a><a href="#7.3.4-ssl_fc_is_resumed">ssl_fc_is_resumed</a></b> : boolean</div><pre class="text">Returns true if the SSL/TLS session has been resumed through the use of
SSL session cache or TLS tickets on an incoming connection over an SSL/TLS
transport layer.
</pre><a class="anchor" name="ssl_fc_npn"></a><a class="anchor" name="7-ssl_fc_npn"></a><a class="anchor" name="7.3.4-ssl_fc_npn"></a><a class="anchor" name="ssl_fc_npn (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_npn (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_npn"></a><a href="#7.3.4-ssl_fc_npn">ssl_fc_npn</a></b> : string</div><pre class="text">This extracts the Next Protocol Negotiation field from an incoming connection
made via a TLS transport layer and locally deciphered by HAProxy. The result
is a string containing the protocol name advertised by the client. The SSL
library must have been built with support for TLS extensions enabled (check
haproxy -vv). Note that the TLS NPN extension is not advertised unless the
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">npn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#npn%20%28Bind%20options%29">Bind options</a></li><li><a href="#npn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; keyword on the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; line specifies a protocol list. Also, nothing
forces the client to pick a protocol from this list, any other one may be
requested. Please note that the TLS NPN extension was replaced with ALPN.
</pre><a class="anchor" name="ssl_fc_protocol"></a><a class="anchor" name="7-ssl_fc_protocol"></a><a class="anchor" name="7.3.4-ssl_fc_protocol"></a><a class="anchor" name="ssl_fc_protocol (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_protocol (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_protocol"></a><a href="#7.3.4-ssl_fc_protocol">ssl_fc_protocol</a></b> : string</div><pre class="text">Returns the name of the used protocol when the incoming connection was made
over an SSL/TLS transport layer.
</pre><a class="anchor" name="ssl_fc_protocol_hello_id"></a><a class="anchor" name="7-ssl_fc_protocol_hello_id"></a><a class="anchor" name="7.3.4-ssl_fc_protocol_hello_id"></a><a class="anchor" name="ssl_fc_protocol_hello_id (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_protocol_hello_id (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_protocol_hello_id"></a><a href="#7.3.4-ssl_fc_protocol_hello_id">ssl_fc_protocol_hello_id</a></b> : integer</div><pre class="text">The version of the TLS protocol by which the client wishes to communicate
during the session as indicated in client hello message. This value can
return only if the value &quot;<a href="#tune.ssl.capture-buffer-size">tune.ssl.capture-buffer-size</a>&quot; is set greater than
0.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>http-request set-header X-SSL-JA3 %[ssl_fc_protocol_hello_id],\
    %[ssl_fc_cipherlist_bin(1),be2dec(-,2)],\
    %[ssl_fc_extlist_bin(1),be2dec(-,2)],\
    %[ssl_fc_eclist_bin(1),be2dec(-,2)],\
    %[ssl_fc_ecformats_bin,be2dec(-,1)]
acl is_malware req.fhdr(x-ssl-ja3),digest(md5),hex \
    -f /path/to/file/with/malware-ja3.lst
http-request set-header X-Malware True if is_malware
http-request set-header X-Malware False if !is_malware
</code></pre>
</div><a class="anchor" name="ssl_fc_unique_id"></a><a class="anchor" name="7-ssl_fc_unique_id"></a><a class="anchor" name="7.3.4-ssl_fc_unique_id"></a><a class="anchor" name="ssl_fc_unique_id (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_unique_id (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_unique_id"></a><a href="#7.3.4-ssl_fc_unique_id">ssl_fc_unique_id</a></b> : binary</div><pre class="text">When the incoming connection was made over an SSL/TLS transport layer,
returns the TLS unique ID as defined in RFC5929 <a href="#3">section 3</a>. The unique id
can be encoded to base64 using the converter: &quot;ssl_fc_unique_id,base64&quot;.
</pre><a class="anchor" name="ssl_fc_server_handshake_traffic_secret"></a><a class="anchor" name="7-ssl_fc_server_handshake_traffic_secret"></a><a class="anchor" name="7.3.4-ssl_fc_server_handshake_traffic_secret"></a><a class="anchor" name="ssl_fc_server_handshake_traffic_secret (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_server_handshake_traffic_secret (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_server_handshake_traffic_secret"></a><a href="#7.3.4-ssl_fc_server_handshake_traffic_secret">ssl_fc_server_handshake_traffic_secret</a></b> : string</div><pre class="text">Return the SERVER_HANDSHAKE_TRAFFIC_SECRET as an hexadecimal string for the
front connection when the incoming connection was made over a TLS 1.3
transport layer.
Require OpenSSL &gt;= 1.1.1. This is one of the keys dumped by the OpenSSL
keylog callback to generate the SSLKEYLOGFILE. The SSL Key logging must be
activated with &quot;tune.ssl.keylog on&quot; in the global section. See also
&quot;<a href="#tune.ssl.keylog">tune.ssl.keylog</a>&quot;
</pre><a class="anchor" name="ssl_fc_server_traffic_secret_0"></a><a class="anchor" name="7-ssl_fc_server_traffic_secret_0"></a><a class="anchor" name="7.3.4-ssl_fc_server_traffic_secret_0"></a><a class="anchor" name="ssl_fc_server_traffic_secret_0 (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_server_traffic_secret_0 (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_server_traffic_secret_0"></a><a href="#7.3.4-ssl_fc_server_traffic_secret_0">ssl_fc_server_traffic_secret_0</a></b> : string</div><pre class="text">Return the SERVER_TRAFFIC_SECRET_0 as an hexadecimal string for the
front connection when the incoming connection was made over an TLS 1.3
transport layer.
Require OpenSSL &gt;= 1.1.1. This is one of the keys dumped by the OpenSSL
keylog callback to generate the SSLKEYLOGFILE. The SSL Key logging must be
activated with &quot;tune.ssl.keylog on&quot; in the global section. See also
&quot;<a href="#tune.ssl.keylog">tune.ssl.keylog</a>&quot;
</pre><a class="anchor" name="ssl_fc_server_random"></a><a class="anchor" name="7-ssl_fc_server_random"></a><a class="anchor" name="7.3.4-ssl_fc_server_random"></a><a class="anchor" name="ssl_fc_server_random (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_server_random (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_server_random"></a><a href="#7.3.4-ssl_fc_server_random">ssl_fc_server_random</a></b> : binary</div><pre class="text">Returns the server random of the front connection when the incoming connection
was made over an SSL/TLS transport layer. It is useful to to decrypt traffic
sent using ephemeral ciphers. This requires OpenSSL &gt;= 1.1.0, or BoringSSL.
</pre><a class="anchor" name="ssl_fc_session_id"></a><a class="anchor" name="7-ssl_fc_session_id"></a><a class="anchor" name="7.3.4-ssl_fc_session_id"></a><a class="anchor" name="ssl_fc_session_id (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_session_id (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_session_id"></a><a href="#7.3.4-ssl_fc_session_id">ssl_fc_session_id</a></b> : binary</div><pre class="text">Returns the SSL ID of the front connection when the incoming connection was
made over an SSL/TLS transport layer. It is useful to stick a given client to
a server. It is important to note that some browsers refresh their session ID
every few minutes.
</pre><a class="anchor" name="ssl_fc_session_key"></a><a class="anchor" name="7-ssl_fc_session_key"></a><a class="anchor" name="7.3.4-ssl_fc_session_key"></a><a class="anchor" name="ssl_fc_session_key (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_session_key (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_session_key"></a><a href="#7.3.4-ssl_fc_session_key">ssl_fc_session_key</a></b> : binary</div><pre class="text">Returns the SSL session master key of the front connection when the incoming
connection was made over an SSL/TLS transport layer. It is useful to decrypt
traffic sent using ephemeral ciphers. This requires OpenSSL &gt;= 1.1.0, or
BoringSSL.
</pre><a class="anchor" name="ssl_fc_sigalgs_bin"></a><a class="anchor" name="7-ssl_fc_sigalgs_bin"></a><a class="anchor" name="7.3.4-ssl_fc_sigalgs_bin"></a><a class="anchor" name="ssl_fc_sigalgs_bin (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_sigalgs_bin (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_sigalgs_bin"></a><a href="#7.3.4-ssl_fc_sigalgs_bin">ssl_fc_sigalgs_bin</a></b>(<span style="color: #008">[<span style="color: #080">&lt;filter_option&gt;</span>]</span>) : binary</div><pre class="text">Returns the content of the signatures_algorithms (13) TLS extension presented
during the Client Hello. It provides a binary list of 2-bytes algorithms
defined in the TLS RFC: https://datatracker.ietf.org/doc/html/rfc8446#section-4.2.3.

This value can return only if the value &quot;<a href="#tune.ssl.capture-buffer-size">tune.ssl.capture-buffer-size</a>&quot; is set
greater than 0. Setting &lt;filter_option&gt; allows to filter returned data.
Accepted values:
0 : return the full list of ciphers (default)
1 : exclude GREASE (RFC8701) values from the output
</pre><a class="anchor" name="ssl_fc_sni"></a><a class="anchor" name="7-ssl_fc_sni"></a><a class="anchor" name="7.3.4-ssl_fc_sni"></a><a class="anchor" name="ssl_fc_sni (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_sni (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_sni"></a><a href="#7.3.4-ssl_fc_sni">ssl_fc_sni</a></b> : string</div><pre class="text">This extracts the Server Name Indication TLS extension (SNI) field from an
incoming connection made via an SSL/TLS transport layer and locally
deciphered by HAProxy. The result (when present) typically is a string
matching the HTTPS host name (253 chars or less). The SSL library must have
been built with support for TLS extensions enabled (check haproxy -vv).

This fetch is different from &quot;<a href="#req.ssl_sni">req.ssl_sni</a>&quot; above in that it applies to the
connection being deciphered by HAProxy and not to SSL contents being blindly
forwarded. See also &quot;ssl_fc_sni_end&quot; and &quot;ssl_fc_sni_reg&quot; below. This
requires that the SSL library is built with support for TLS extensions
enabled (check haproxy -vv).

CAUTION! Except under very specific conditions, it is normally not correct to
use this field as a substitute for the HTTP &quot;Host&quot; header field. For example,
when forwarding an HTTPS connection to a server, the SNI field must be set
from the HTTP Host header field using &quot;req.hdr(host)&quot; and not from the front
SNI value. The reason is that SNI is solely used to select the certificate
the server side will present, and that clients are then allowed to send
requests with different Host values as long as they match the names in the
certificate. As such, &quot;<a href="#ssl_fc_sni">ssl_fc_sni</a>&quot; should normally not be used as an argument
to the &quot;<a href="#sni">sni</a>&quot; server keyword, unless the backend works in TCP mode.

ACL derivatives :
  ssl_fc_sni_end : suffix match
  ssl_fc_sni_reg : regex match
</pre><a class="anchor" name="ssl_fc_supported_versions_bin"></a><a class="anchor" name="7-ssl_fc_supported_versions_bin"></a><a class="anchor" name="7.3.4-ssl_fc_supported_versions_bin"></a><a class="anchor" name="ssl_fc_supported_versions_bin (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_supported_versions_bin (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_supported_versions_bin"></a><a href="#7.3.4-ssl_fc_supported_versions_bin">ssl_fc_supported_versions_bin</a></b>(<span style="color: #008">[<span style="color: #080">&lt;filter_option&gt;</span>]</span>) : binary</div><pre class="text">Returns the content of the supported_versions (43) TLS extension presented
during the Client Hello. It provides a binary list of 2-bytes versions.
TLSv1.3 (0x0304), TLSv1.2 (0x0303).

This value can return only if the value &quot;<a href="#tune.ssl.capture-buffer-size">tune.ssl.capture-buffer-size</a>&quot; is set
greater than 0. Setting &lt;filter_option&gt; allows to filter returned data.
Accepted values:
0 : return the full list of ciphers (default)
1 : exclude GREASE (RFC8701) values from the output
</pre><a class="anchor" name="ssl_fc_use_keysize"></a><a class="anchor" name="7-ssl_fc_use_keysize"></a><a class="anchor" name="7.3.4-ssl_fc_use_keysize"></a><a class="anchor" name="ssl_fc_use_keysize (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_fc_use_keysize (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_fc_use_keysize"></a><a href="#7.3.4-ssl_fc_use_keysize">ssl_fc_use_keysize</a></b> : integer</div><pre class="text">Returns the symmetric cipher key size used in bits when the incoming
connection was made over an SSL/TLS transport layer.
</pre><a class="anchor" name="ssl_s_der"></a><a class="anchor" name="7-ssl_s_der"></a><a class="anchor" name="7.3.4-ssl_s_der"></a><a class="anchor" name="ssl_s_der (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_s_der (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_s_der"></a><a href="#7.3.4-ssl_s_der">ssl_s_der</a></b> : binary</div><pre class="text">Returns the DER formatted certificate presented by the server when the
outgoing connection was made over an SSL/TLS transport layer. When used for
an ACL, the value(s) to match against can be passed in hexadecimal form.
</pre><a class="anchor" name="ssl_s_chain_der"></a><a class="anchor" name="7-ssl_s_chain_der"></a><a class="anchor" name="7.3.4-ssl_s_chain_der"></a><a class="anchor" name="ssl_s_chain_der (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_s_chain_der (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_s_chain_der"></a><a href="#7.3.4-ssl_s_chain_der">ssl_s_chain_der</a></b> : binary</div><pre class="text">Returns the DER formatted chain certificate presented by the server when the
outgoing connection was made over an SSL/TLS transport layer. When used for
an ACL, the value(s) to match against can be passed in hexadecimal form. One
can parse the result with any lib accepting ASN.1 DER data. It currently
does not support resumed sessions.
</pre><a class="anchor" name="ssl_s_key_alg"></a><a class="anchor" name="7-ssl_s_key_alg"></a><a class="anchor" name="7.3.4-ssl_s_key_alg"></a><a class="anchor" name="ssl_s_key_alg (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_s_key_alg (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_s_key_alg"></a><a href="#7.3.4-ssl_s_key_alg">ssl_s_key_alg</a></b> : string</div><pre class="text">Returns the name of the algorithm used to generate the key of the certificate
presented by the server when the outgoing connection was made over an
SSL/TLS transport layer.
</pre><a class="anchor" name="ssl_s_notafter"></a><a class="anchor" name="7-ssl_s_notafter"></a><a class="anchor" name="7.3.4-ssl_s_notafter"></a><a class="anchor" name="ssl_s_notafter (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_s_notafter (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_s_notafter"></a><a href="#7.3.4-ssl_s_notafter">ssl_s_notafter</a></b> : string</div><pre class="text">Returns the end date presented by the server as a formatted string
YYMMDDhhmmss[Z] when the outgoing connection was made over an SSL/TLS
transport layer.
</pre><a class="anchor" name="ssl_s_notbefore"></a><a class="anchor" name="7-ssl_s_notbefore"></a><a class="anchor" name="7.3.4-ssl_s_notbefore"></a><a class="anchor" name="ssl_s_notbefore (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_s_notbefore (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_s_notbefore"></a><a href="#7.3.4-ssl_s_notbefore">ssl_s_notbefore</a></b> : string</div><pre class="text">Returns the start date presented by the server as a formatted string
YYMMDDhhmmss[Z] when the outgoing connection was made over an SSL/TLS
transport layer.
</pre><a class="anchor" name="ssl_s_i_dn"></a><a class="anchor" name="7-ssl_s_i_dn"></a><a class="anchor" name="7.3.4-ssl_s_i_dn"></a><a class="anchor" name="ssl_s_i_dn (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_s_i_dn (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_s_i_dn"></a><a href="#7.3.4-ssl_s_i_dn">ssl_s_i_dn</a></b>(<span style="color: #008">[<span style="color: #080">&lt;entry&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;format&gt;</span>]</span>]</span>]</span>) : string</div><pre class="text">When the outgoing connection was made over an SSL/TLS transport layer,
returns the full distinguished name of the issuer of the certificate
presented by the server when no &lt;entry&gt; is specified, or the value of the
first given entry found from the beginning of the DN. If a positive/negative
occurrence number is specified as the optional second argument, it returns
the value of the nth given entry value from the beginning/end of the DN.
For instance, &quot;ssl_s_i_dn(OU,2)&quot; the second organization unit, and
&quot;ssl_s_i_dn(CN)&quot; retrieves the common name.
The &lt;format&gt; parameter allows you to receive the DN suitable for
consumption by different protocols. Currently supported is rfc2253 for
LDAP v3.
If you'd like to modify the format only you can specify an empty string
and zero for the first two parameters. Example: ssl_s_i_dn(,0,rfc2253)
</pre><a class="anchor" name="ssl_s_s_dn"></a><a class="anchor" name="7-ssl_s_s_dn"></a><a class="anchor" name="7.3.4-ssl_s_s_dn"></a><a class="anchor" name="ssl_s_s_dn (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_s_s_dn (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_s_s_dn"></a><a href="#7.3.4-ssl_s_s_dn">ssl_s_s_dn</a></b>(<span style="color: #008">[<span style="color: #080">&lt;entry&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;format&gt;</span>]</span>]</span>]</span>) : string</div><pre class="text">When the outgoing connection was made over an SSL/TLS transport layer,
returns the full distinguished name of the subject of the certificate
presented by the server when no &lt;entry&gt; is specified, or the value of the
first given entry found from the beginning of the DN. If a positive/negative
occurrence number is specified as the optional second argument, it returns
the value of the nth given entry value from the beginning/end of the DN.
For instance, &quot;ssl_s_s_dn(OU,2)&quot; the second organization unit, and
&quot;ssl_s_s_dn(CN)&quot; retrieves the common name.
The &lt;format&gt; parameter allows you to receive the DN suitable for
consumption by different protocols. Currently supported is rfc2253 for
LDAP v3.
If you'd like to modify the format only you can specify an empty string
and zero for the first two parameters. Example: ssl_s_s_dn(,0,rfc2253)
</pre><a class="anchor" name="ssl_s_serial"></a><a class="anchor" name="7-ssl_s_serial"></a><a class="anchor" name="7.3.4-ssl_s_serial"></a><a class="anchor" name="ssl_s_serial (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_s_serial (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_s_serial"></a><a href="#7.3.4-ssl_s_serial">ssl_s_serial</a></b> : binary</div><pre class="text">Returns the serial of the certificate presented by the server when the
outgoing connection was made over an SSL/TLS transport layer. When used for
an ACL, the value(s) to match against can be passed in hexadecimal form.
</pre><a class="anchor" name="ssl_s_sha1"></a><a class="anchor" name="7-ssl_s_sha1"></a><a class="anchor" name="7.3.4-ssl_s_sha1"></a><a class="anchor" name="ssl_s_sha1 (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_s_sha1 (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_s_sha1"></a><a href="#7.3.4-ssl_s_sha1">ssl_s_sha1</a></b> : binary</div><pre class="text">Returns the SHA-1 fingerprint of the certificate presented by the server
when the outgoing connection was made over an SSL/TLS transport layer. This
can be used to know which certificate was chosen using SNI.
</pre><a class="anchor" name="ssl_s_sig_alg"></a><a class="anchor" name="7-ssl_s_sig_alg"></a><a class="anchor" name="7.3.4-ssl_s_sig_alg"></a><a class="anchor" name="ssl_s_sig_alg (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_s_sig_alg (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_s_sig_alg"></a><a href="#7.3.4-ssl_s_sig_alg">ssl_s_sig_alg</a></b> : string</div><pre class="text">Returns the name of the algorithm used to sign the certificate presented by
the server when the outgoing connection was made over an SSL/TLS transport
layer.
</pre><a class="anchor" name="ssl_s_version"></a><a class="anchor" name="7-ssl_s_version"></a><a class="anchor" name="7.3.4-ssl_s_version"></a><a class="anchor" name="ssl_s_version (Using ACLs and fetching samples)"></a><a class="anchor" name="ssl_s_version (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="ssl_s_version"></a><a href="#7.3.4-ssl_s_version">ssl_s_version</a></b> : integer</div><pre class="text">Returns the version of the certificate presented by the server when the
outgoing connection was made over an SSL/TLS transport layer.
</pre><a class="anchor" name="txn.timer.user"></a><a class="anchor" name="7-txn.timer.user"></a><a class="anchor" name="7.3.4-txn.timer.user"></a><a class="anchor" name="txn.timer.user (Using ACLs and fetching samples)"></a><a class="anchor" name="txn.timer.user (Fetching samples at Layer 5)"></a><div class="keyword"><b><a class="anchor" name="txn.timer.user"></a><a href="#7.3.4-txn.timer.user">txn.timer.user</a></b> : integer</div><pre class="text">Total estimated time as seen from client, between the moment the proxy
accepted it and the moment both ends were closed, without idle time.
This is the equivalent of %Tu in the log-format and is reported in
milliseconds (ms). For more details see Section 8.4 &quot;Timing events&quot;
</pre></div>
<a class="anchor" id="7.3.5" name="7.3.5"></a>
<h3 id="chapter-7.3.5" data-target="7.3.5"><small><a class="small" href="#7.3.5">7.3.5.</a></small> Fetching samples from buffer contents (Layer 6)</h3>
<div><pre class="text">Fetching samples from buffer contents is a bit different from the previous
sample fetches above because the sampled data are ephemeral. These data can
only be used when they're available and will be lost when they're forwarded.
For this reason, samples fetched from buffer contents during a request cannot
be used in a response for example. Even while the data are being fetched, they
can change. Sometimes it is necessary to set some delays or combine multiple
sample fetch methods to ensure that the expected data are complete and usable,
for example through TCP request content inspection. Please see the &quot;tcp-request
content&quot; keyword for more detailed information on the subject.

Warning : Following sample fetches are ignored if used from HTTP proxies. They
          only deal with raw contents found in the buffers. On their side,
          HTTP proxies use structured content. Thus raw representation of
          these data are meaningless. A warning is emitted if an ACL relies on
          one of the following sample fetches. But it is not possible to detect
          all invalid usage (for instance inside a Custom log format or a
          sample expression). So be careful.

Summary of sample fetch methods in this section and their respective types:
</pre><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-distcc_body">distcc_body(&lt;token&gt;[,&lt;occ&gt;])</a></td><td >binary</td></tr>
<tr><td ><a href="#7-distcc_param">distcc_param(&lt;token&gt;[,&lt;occ&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-payload">payload(&lt;offset&gt;,&lt;length&gt;)</a></td><td >binary</td></tr>
<tr><td ><a href="#7-payload_lv">payload_lv(&lt;offset1&gt;,&lt;length&gt;[,&lt;offset2&gt;])</a></td><td >binary</td></tr>
<tr><td ><a href="#7-req.len">req.len</a></td><td >integer</td></tr>
<tr><td ><a href="#7-req_len">req_len</a></td><td >integer</td></tr>
<tr><td ><a href="#7-req.payload">req.payload(&lt;offset&gt;,&lt;length&gt;)</a></td><td >binary</td></tr>
<tr><td ><a href="#7-req.payload_lv">req.payload_lv(&lt;offset1&gt;,&lt;length&gt;[,&lt;offset2&gt;])</a></td><td >binary</td></tr>
<tr><td ><a href="#7-req.proto_http">req.proto_http</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-req_proto_http">req_proto_http</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-req.rdp_cookie">req.rdp_cookie([&lt;name&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-rdp_cookie">rdp_cookie([&lt;name&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-req.rdp_cookie_cnt">req.rdp_cookie_cnt([name])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-rdp_cookie_cnt">rdp_cookie_cnt([name])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-req.ssl_alpn">req.ssl_alpn</a></td><td >string</td></tr>
<tr><td ><a href="#7-req.ssl_ec_ext">req.ssl_ec_ext</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-req.ssl_hello_type">req.ssl_hello_type</a></td><td >integer</td></tr>
<tr><td ><a href="#7-req_ssl_hello_type">req_ssl_hello_type</a></td><td >integer</td></tr>
<tr><td ><a href="#7-req.ssl_sni">req.ssl_sni</a></td><td >string</td></tr>
<tr><td ><a href="#7-req_ssl_sni">req_ssl_sni</a></td><td >string</td></tr>
<tr><td ><a href="#7-req.ssl_st_ext">req.ssl_st_ext</a></td><td >integer</td></tr>
<tr><td ><a href="#7-req.ssl_ver">req.ssl_ver</a></td><td >integer</td></tr>
<tr><td ><a href="#7-req_ssl_ver">req_ssl_ver</a></td><td >integer</td></tr>
<tr><td ><a href="#7-res.len">res.len</a></td><td >integer</td></tr>
<tr><td ><a href="#7-res.payload">res.payload(&lt;offset&gt;,&lt;length&gt;)</a></td><td >binary</td></tr>
<tr><td ><a href="#7-res.payload_lv">res.payload_lv(&lt;offset1&gt;,&lt;length&gt;[,&lt;offset2&gt;])</a></td><td >binary</td></tr>
<tr><td ><a href="#7-res.ssl_hello_type">res.ssl_hello_type</a></td><td >integer</td></tr>
<tr><td ><a href="#7-rep_ssl_hello_type">rep_ssl_hello_type</a></td><td >integer</td></tr>
</table><pre class="text">Detailed list:
</pre><a class="anchor" name="distcc_body"></a><a class="anchor" name="7-distcc_body"></a><a class="anchor" name="7.3.5-distcc_body"></a><a class="anchor" name="distcc_body (Using ACLs and fetching samples)"></a><a class="anchor" name="distcc_body (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="distcc_body"></a><a href="#7.3.5-distcc_body">distcc_body</a></b>(<span style="color: #080">&lt;token&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>) : binary</div><pre class="text">Parses a distcc message and returns the body associated to occurrence #&lt;occ&gt;
of the token &lt;token&gt;. Occurrences start at 1, and when unspecified, any may
match though in practice only the first one is checked for now. This can be
used to extract file names or arguments in files built using distcc through
HAProxy. Please refer to distcc's protocol documentation for the complete
list of supported tokens.
</pre><a class="anchor" name="distcc_param"></a><a class="anchor" name="7-distcc_param"></a><a class="anchor" name="7.3.5-distcc_param"></a><a class="anchor" name="distcc_param (Using ACLs and fetching samples)"></a><a class="anchor" name="distcc_param (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="distcc_param"></a><a href="#7.3.5-distcc_param">distcc_param</a></b>(<span style="color: #080">&lt;token&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>) : integer</div><pre class="text">Parses a distcc message and returns the parameter associated to occurrence
#&lt;occ&gt; of the token &lt;token&gt;. Occurrences start at 1, and when unspecified,
any may match though in practice only the first one is checked for now. This
can be used to extract certain information such as the protocol version, the
file size or the argument in files built using distcc through HAProxy.
Another use case consists in waiting for the start of the preprocessed file
contents before connecting to the server to avoid keeping idle connections.
Please refer to distcc's protocol documentation for the complete list of
supported tokens.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># wait up to 20s for the pre-processed file to be uploaded</span>
tcp-request inspect-delay 20s
tcp-request content accept if { distcc_param(DOTI) -m found }
<span class="comment"># send large files to the big farm</span>
use_backend big_farm if { distcc_param(DOTI) gt 1000000 }
</code></pre>
</div><a class="anchor" name="payload"></a><a class="anchor" name="7-payload"></a><a class="anchor" name="7.3.5-payload"></a><a class="anchor" name="payload (Using ACLs and fetching samples)"></a><a class="anchor" name="payload (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="payload"></a><a href="#7.3.5-payload">payload</a></b>(<span style="color: #080">&lt;offset&gt;</span>,<span style="color: #080">&lt;length&gt;</span>) : binary <span class="label label-warning">(deprecated)</span></div><pre class="text">This is an alias for &quot;<a href="#req.payload">req.payload</a>&quot; when used in the context of a request (e.g.
&quot;<a href="#stick%20on">stick on</a>&quot;, &quot;<a href="#stick%20match">stick match</a>&quot;), and for &quot;<a href="#res.payload">res.payload</a>&quot; when used in the context of
a response such as in &quot;stick store response&quot;.
</pre><a class="anchor" name="payload_lv"></a><a class="anchor" name="7-payload_lv"></a><a class="anchor" name="7.3.5-payload_lv"></a><a class="anchor" name="payload_lv (Using ACLs and fetching samples)"></a><a class="anchor" name="payload_lv (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="payload_lv"></a><a href="#7.3.5-payload_lv">payload_lv</a></b>(<span style="color: #080">&lt;offset1&gt;</span>,<span style="color: #080">&lt;length&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;offset2&gt;</span>]</span>) : binary <span class="label label-warning">(deprecated)</span></div><pre class="text">This is an alias for &quot;<a href="#req.payload_lv">req.payload_lv</a>&quot; when used in the context of a request
(e.g. &quot;<a href="#stick%20on">stick on</a>&quot;, &quot;<a href="#stick%20match">stick match</a>&quot;), and for &quot;<a href="#res.payload_lv">res.payload_lv</a>&quot; when used in the
context of a response such as in &quot;stick store response&quot;.
</pre><a class="anchor" name="req.len"></a><a class="anchor" name="7-req.len"></a><a class="anchor" name="7.3.5-req.len"></a><a class="anchor" name="req.len (Using ACLs and fetching samples)"></a><a class="anchor" name="req.len (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="req.len"></a><a href="#7.3.5-req.len">req.len</a></b> : integer</div><a class="anchor" name="req_len"></a><a class="anchor" name="7-req_len"></a><a class="anchor" name="7.3.5-req_len"></a><a class="anchor" name="req_len (Using ACLs and fetching samples)"></a><a class="anchor" name="req_len (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="req_len"></a><a href="#7.3.5-req_len">req_len</a></b> : integer <span class="label label-warning">(deprecated)</span></div><pre class="text">Returns an integer value corresponding to the number of bytes present in the
request buffer. This is mostly used in ACL. It is important to understand
that this test does not return false as long as the buffer is changing. This
means that a check with equality to zero will almost always immediately match
at the beginning of the session, while a test for more data will wait for
that data to come in and return false only when HAProxy is certain that no
more data will come in. This test was designed to be used with TCP request
content inspection.
</pre><a class="anchor" name="req.payload"></a><a class="anchor" name="7-req.payload"></a><a class="anchor" name="7.3.5-req.payload"></a><a class="anchor" name="req.payload (Using ACLs and fetching samples)"></a><a class="anchor" name="req.payload (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="req.payload"></a><a href="#7.3.5-req.payload">req.payload</a></b>(<span style="color: #080">&lt;offset&gt;</span>,<span style="color: #080">&lt;length&gt;</span>) : binary</div><pre class="text">This extracts a binary block of &lt;length&gt; bytes and starting at byte &lt;offset&gt;
in the request buffer. As a special case, if the &lt;length&gt; argument is zero,
the the whole buffer from &lt;offset&gt; to the end is extracted. This can be used
with ACLs in order to check for the presence of some content in a buffer at
any location.

ACL derivatives :
  req.payload(&lt;offset&gt;,&lt;length&gt;) : hex binary match
</pre><a class="anchor" name="req.payload_lv"></a><a class="anchor" name="7-req.payload_lv"></a><a class="anchor" name="7.3.5-req.payload_lv"></a><a class="anchor" name="req.payload_lv (Using ACLs and fetching samples)"></a><a class="anchor" name="req.payload_lv (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="req.payload_lv"></a><a href="#7.3.5-req.payload_lv">req.payload_lv</a></b>(<span style="color: #080">&lt;offset1&gt;</span>,<span style="color: #080">&lt;length&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;offset2&gt;</span>]</span>) : binary</div><pre class="text">This extracts a binary block whose size is specified at &lt;offset1&gt; for &lt;length&gt;
bytes, and which starts at &lt;offset2&gt; if specified or just after the length in
the request buffer. The &lt;offset2&gt; parameter also supports relative offsets if
prepended with a '+' or '-' sign.

ACL derivatives :
  req.payload_lv(&lt;offset1&gt;,&lt;length&gt;[,&lt;offset2&gt;]) : hex binary match
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<div class="example-desc">please consult the example from the &quot;<a href="#stick%20store-response">stick store-response</a>&quot; keyword.</div><code></code></pre>
</div><a class="anchor" name="req.proto_http"></a><a class="anchor" name="7-req.proto_http"></a><a class="anchor" name="7.3.5-req.proto_http"></a><a class="anchor" name="req.proto_http (Using ACLs and fetching samples)"></a><a class="anchor" name="req.proto_http (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="req.proto_http"></a><a href="#7.3.5-req.proto_http">req.proto_http</a></b> : boolean</div><a class="anchor" name="req_proto_http"></a><a class="anchor" name="7-req_proto_http"></a><a class="anchor" name="7.3.5-req_proto_http"></a><a class="anchor" name="req_proto_http (Using ACLs and fetching samples)"></a><a class="anchor" name="req_proto_http (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="req_proto_http"></a><a href="#7.3.5-req_proto_http">req_proto_http</a></b> : boolean <span class="label label-warning">(deprecated)</span></div><pre class="text">Returns true when data in the request buffer look like HTTP and correctly
parses as such. It is the same parser as the common HTTP request parser which
is used so there should be no surprises. The test does not match until the
request is complete, failed or timed out. This test may be used to report the
protocol in TCP logs, but the biggest use is to block TCP request analysis
until a complete HTTP request is present in the buffer, for example to track
a header.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code><span class="comment"># track request counts per &quot;<a href="#base">base</a>&quot; (concatenation of Host+URL)</span>
tcp-request inspect-delay 10s
tcp-request content reject if !HTTP
tcp-request content track-sc0 base table req-rate
</code></pre>
</div><a class="anchor" name="req.rdp_cookie"></a><a class="anchor" name="7-req.rdp_cookie"></a><a class="anchor" name="7.3.5-req.rdp_cookie"></a><a class="anchor" name="req.rdp_cookie (Using ACLs and fetching samples)"></a><a class="anchor" name="req.rdp_cookie (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="req.rdp_cookie"></a><a href="#7.3.5-req.rdp_cookie">req.rdp_cookie</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : string</div><a class="anchor" name="rdp_cookie"></a><a class="anchor" name="7-rdp_cookie"></a><a class="anchor" name="7.3.5-rdp_cookie"></a><a class="anchor" name="rdp_cookie (Using ACLs and fetching samples)"></a><a class="anchor" name="rdp_cookie (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="rdp_cookie"></a><a href="#7.3.5-rdp_cookie">rdp_cookie</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : string <span class="label label-warning">(deprecated)</span></div><pre class="text">When the request buffer looks like the RDP protocol, extracts the RDP cookie
&lt;name&gt;, or any cookie if unspecified. The parser only checks for the first
cookie, as illustrated in the RDP protocol specification. The cookie name is
case insensitive. Generally the &quot;MSTS&quot; cookie name will be used, as it can
contain the user name of the client connecting to the server if properly
configured on the client. The &quot;MSTSHASH&quot; cookie is often used as well for
session stickiness to servers.

This differs from &quot;balance rdp-cookie&quot; in that any balancing algorithm may be
used and thus the distribution of clients to backend servers is not linked to
a hash of the RDP cookie. It is envisaged that using a balancing algorithm
such as &quot;balance roundrobin&quot; or &quot;balance leastconn&quot; will lead to a more even
distribution of clients to backend servers than the hash used by &quot;balance
rdp-cookie&quot;.

ACL derivatives :
  req.rdp_cookie([&lt;name&gt;]) : exact string match
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>listen tse-farm
    bind 0.0.0.0:3389
    <span class="comment"># wait up to 5s for an RDP cookie in the request</span>
    tcp-request inspect-delay 5s
    tcp-request content accept if RDP_COOKIE
    <span class="comment"># apply RDP cookie persistence</span>
    persist rdp-cookie
    <span class="comment"># Persist based on the mstshash cookie</span>
    <span class="comment"># This is only useful makes sense if</span>
    <span class="comment"># balance rdp-cookie is not used</span>
    stick-table type string size 204800
    stick on req.rdp_cookie(mstshash)
    server srv1 1.1.1.1:3389
    server srv1 1.1.1.2:3389
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;balance rdp-cookie&quot;, &quot;<a href="#persist%20rdp-cookie">persist rdp-cookie</a>&quot;, &quot;<a href="#tcp-request">tcp-request</a>&quot; and the &quot;<a href="#req.rdp_cookie">req.rdp_cookie</a>&quot; ACL.</div>
<a class="anchor" name="req.rdp_cookie_cnt"></a><a class="anchor" name="7-req.rdp_cookie_cnt"></a><a class="anchor" name="7.3.5-req.rdp_cookie_cnt"></a><a class="anchor" name="req.rdp_cookie_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="req.rdp_cookie_cnt (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="req.rdp_cookie_cnt"></a><a href="#7.3.5-req.rdp_cookie_cnt">req.rdp_cookie_cnt</a></b>(<span style="color: #008">[name]</span>) : integer</div><a class="anchor" name="rdp_cookie_cnt"></a><a class="anchor" name="7-rdp_cookie_cnt"></a><a class="anchor" name="7.3.5-rdp_cookie_cnt"></a><a class="anchor" name="rdp_cookie_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="rdp_cookie_cnt (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="rdp_cookie_cnt"></a><a href="#7.3.5-rdp_cookie_cnt">rdp_cookie_cnt</a></b>(<span style="color: #008">[name]</span>) : integer <span class="label label-warning">(deprecated)</span></div><pre class="text">Tries to parse the request buffer as RDP protocol, then returns an integer
corresponding to the number of RDP cookies found. If an optional cookie name
is passed, only cookies matching this name are considered. This is mostly
used in ACL.

ACL derivatives :
  req.rdp_cookie_cnt([&lt;name&gt;]) : integer match
</pre><a class="anchor" name="req.ssl_alpn"></a><a class="anchor" name="7-req.ssl_alpn"></a><a class="anchor" name="7.3.5-req.ssl_alpn"></a><a class="anchor" name="req.ssl_alpn (Using ACLs and fetching samples)"></a><a class="anchor" name="req.ssl_alpn (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="req.ssl_alpn"></a><a href="#7.3.5-req.ssl_alpn">req.ssl_alpn</a></b> : string</div><pre class="text">Returns a string containing the values of the Application-Layer Protocol
Negotiation (ALPN) TLS extension (RFC7301), sent by the client within the SSL
ClientHello message. Note that this only applies to raw contents found in the
request buffer and not to the contents deciphered via an SSL data layer, so
this will not work with &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines having the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; option. This is useful
in ACL to make a routing decision based upon the ALPN preferences of a TLS
client, like in the example below. See also &quot;<a href="#ssl_fc_alpn">ssl_fc_alpn</a>&quot;.
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code><span class="comment"># Wait for a client hello for at most 5 seconds</span>
tcp-request inspect-delay 5s
tcp-request content accept if { req.ssl_hello_type 1 }
use_backend bk_acme if { req.ssl_alpn acme-tls/1 }
default_backend bk_default
</code></pre>
</div><a class="anchor" name="req.ssl_ec_ext"></a><a class="anchor" name="7-req.ssl_ec_ext"></a><a class="anchor" name="7.3.5-req.ssl_ec_ext"></a><a class="anchor" name="req.ssl_ec_ext (Using ACLs and fetching samples)"></a><a class="anchor" name="req.ssl_ec_ext (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="req.ssl_ec_ext"></a><a href="#7.3.5-req.ssl_ec_ext">req.ssl_ec_ext</a></b> : boolean</div><pre class="text">Returns a boolean identifying if client sent the Supported Elliptic Curves
Extension as defined in RFC4492, <a href="#5.1">section 5.1</a>. within the SSL ClientHello
message. This can be used to present ECC compatible clients with EC
certificate and to use RSA for all others, on the same IP address. Note that
this only applies to raw contents found in the request buffer and not to
contents deciphered via an SSL data layer, so this will not work with &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;
lines having the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; option.
</pre><a class="anchor" name="req.ssl_hello_type"></a><a class="anchor" name="7-req.ssl_hello_type"></a><a class="anchor" name="7.3.5-req.ssl_hello_type"></a><a class="anchor" name="req.ssl_hello_type (Using ACLs and fetching samples)"></a><a class="anchor" name="req.ssl_hello_type (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="req.ssl_hello_type"></a><a href="#7.3.5-req.ssl_hello_type">req.ssl_hello_type</a></b> : integer</div><a class="anchor" name="req_ssl_hello_type"></a><a class="anchor" name="7-req_ssl_hello_type"></a><a class="anchor" name="7.3.5-req_ssl_hello_type"></a><a class="anchor" name="req_ssl_hello_type (Using ACLs and fetching samples)"></a><a class="anchor" name="req_ssl_hello_type (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="req_ssl_hello_type"></a><a href="#7.3.5-req_ssl_hello_type">req_ssl_hello_type</a></b> : integer <span class="label label-warning">(deprecated)</span></div><pre class="text">Returns an integer value containing the type of the SSL hello message found
in the request buffer if the buffer contains data that parse as a complete
SSL (v3 or superior) client hello message. Note that this only applies to raw
contents found in the request buffer and not to contents deciphered via an
SSL data layer, so this will not work with &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines having the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
option. This is mostly used in ACL to detect presence of an SSL hello message
that is supposed to contain an SSL session ID usable for stickiness.
</pre><a class="anchor" name="req.ssl_sni"></a><a class="anchor" name="7-req.ssl_sni"></a><a class="anchor" name="7.3.5-req.ssl_sni"></a><a class="anchor" name="req.ssl_sni (Using ACLs and fetching samples)"></a><a class="anchor" name="req.ssl_sni (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="req.ssl_sni"></a><a href="#7.3.5-req.ssl_sni">req.ssl_sni</a></b> : string</div><a class="anchor" name="req_ssl_sni"></a><a class="anchor" name="7-req_ssl_sni"></a><a class="anchor" name="7.3.5-req_ssl_sni"></a><a class="anchor" name="req_ssl_sni (Using ACLs and fetching samples)"></a><a class="anchor" name="req_ssl_sni (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="req_ssl_sni"></a><a href="#7.3.5-req_ssl_sni">req_ssl_sni</a></b> : string <span class="label label-warning">(deprecated)</span></div><pre class="text">Returns a string containing the value of the Server Name TLS extension sent
by a client in a TLS stream passing through the request buffer if the buffer
contains data that parse as a complete SSL (v3 or superior) client hello
message. Note that this only applies to raw contents found in the request
buffer and not to contents deciphered via an SSL data layer, so this will not
work with &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines having the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; option. This will only work for actual
implicit TLS based protocols like HTTPS (443), IMAPS (993), SMTPS (465),
however it will not work for explicit TLS based protocols, like SMTP (25/587)
or IMAP (143). SNI normally contains the name of the host the client tries to
connect to (for recent browsers). SNI is useful for allowing or denying access
to certain hosts when SSL/TLS is used by the client. This test was designed to
be used with TCP request content inspection. If content switching is needed,
it is recommended to first wait for a complete client hello (type 1), like in
the example below. See also &quot;<a href="#ssl_fc_sni">ssl_fc_sni</a>&quot;.

ACL derivatives :
  req.ssl_sni : exact string match
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code><span class="comment"># Wait for a client hello for at most 5 seconds</span>
tcp-request inspect-delay 5s
tcp-request content accept if { req.ssl_hello_type 1 }
use_backend bk_allow if { req.ssl_sni -f allowed_sites }
default_backend bk_sorry_page
</code></pre>
</div><a class="anchor" name="req.ssl_st_ext"></a><a class="anchor" name="7-req.ssl_st_ext"></a><a class="anchor" name="7.3.5-req.ssl_st_ext"></a><a class="anchor" name="req.ssl_st_ext (Using ACLs and fetching samples)"></a><a class="anchor" name="req.ssl_st_ext (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="req.ssl_st_ext"></a><a href="#7.3.5-req.ssl_st_ext">req.ssl_st_ext</a></b> : integer</div><pre class="text">Returns 0 if the client didn't send a SessionTicket TLS Extension (RFC5077)
Returns 1 if the client sent SessionTicket TLS Extension
Returns 2 if the client also sent non-zero length TLS SessionTicket
Note that this only applies to raw contents found in the request buffer and
not to contents deciphered via an SSL data layer, so this will not work with
&quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines having the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; option. This can for example be used to detect
whether the client sent a SessionTicket or not and stick it accordingly, if
no SessionTicket then stick on SessionID or don't stick as there's no server
side state is there when SessionTickets are in use.
</pre><a class="anchor" name="req.ssl_ver"></a><a class="anchor" name="7-req.ssl_ver"></a><a class="anchor" name="7.3.5-req.ssl_ver"></a><a class="anchor" name="req.ssl_ver (Using ACLs and fetching samples)"></a><a class="anchor" name="req.ssl_ver (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="req.ssl_ver"></a><a href="#7.3.5-req.ssl_ver">req.ssl_ver</a></b> : integer</div><a class="anchor" name="req_ssl_ver"></a><a class="anchor" name="7-req_ssl_ver"></a><a class="anchor" name="7.3.5-req_ssl_ver"></a><a class="anchor" name="req_ssl_ver (Using ACLs and fetching samples)"></a><a class="anchor" name="req_ssl_ver (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="req_ssl_ver"></a><a href="#7.3.5-req_ssl_ver">req_ssl_ver</a></b> : integer <span class="label label-warning">(deprecated)</span></div><pre class="text">Returns an integer value containing the version of the SSL/TLS protocol of a
stream present in the request buffer. Both SSLv2 hello messages and SSLv3
messages are supported. TLSv1 is announced as SSL version 3.1. The value is
composed of the major version multiplied by 65536, added to the minor
version. Note that this only applies to raw contents found in the request
buffer and not to contents deciphered via an SSL data layer, so this will not
work with &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines having the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; option. The ACL version of the test
matches against a decimal notation in the form MAJOR.MINOR (e.g. 3.1). This
fetch is mostly used in ACL.

ACL derivatives :
  req.ssl_ver : decimal match
</pre><a class="anchor" name="res.len"></a><a class="anchor" name="7-res.len"></a><a class="anchor" name="7.3.5-res.len"></a><a class="anchor" name="res.len (Using ACLs and fetching samples)"></a><a class="anchor" name="res.len (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="res.len"></a><a href="#7.3.5-res.len">res.len</a></b> : integer</div><pre class="text">Returns an integer value corresponding to the number of bytes present in the
response buffer. This is mostly used in ACL. It is important to understand
that this test does not return false as long as the buffer is changing. This
means that a check with equality to zero will almost always immediately match
at the beginning of the stream, while a test for more data will wait for
that data to come in and return false only when HAProxy is certain that no
more data will come in. This test was designed to be used with TCP response
content inspection. But it may also be used in tcp-check based expect rules.
</pre><a class="anchor" name="res.payload"></a><a class="anchor" name="7-res.payload"></a><a class="anchor" name="7.3.5-res.payload"></a><a class="anchor" name="res.payload (Using ACLs and fetching samples)"></a><a class="anchor" name="res.payload (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="res.payload"></a><a href="#7.3.5-res.payload">res.payload</a></b>(<span style="color: #080">&lt;offset&gt;</span>,<span style="color: #080">&lt;length&gt;</span>) : binary</div><pre class="text">This extracts a binary block of &lt;length&gt; bytes and starting at byte &lt;offset&gt;
in the response buffer. As a special case, if the &lt;length&gt; argument is zero,
the whole buffer from &lt;offset&gt; to the end is extracted. This can be used
with ACLs in order to check for the presence of some content in a buffer at
any location. It may also be used in tcp-check based expect rules.
</pre><a class="anchor" name="res.payload_lv"></a><a class="anchor" name="7-res.payload_lv"></a><a class="anchor" name="7.3.5-res.payload_lv"></a><a class="anchor" name="res.payload_lv (Using ACLs and fetching samples)"></a><a class="anchor" name="res.payload_lv (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="res.payload_lv"></a><a href="#7.3.5-res.payload_lv">res.payload_lv</a></b>(<span style="color: #080">&lt;offset1&gt;</span>,<span style="color: #080">&lt;length&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;offset2&gt;</span>]</span>) : binary</div><pre class="text">This extracts a binary block whose size is specified at &lt;offset1&gt; for &lt;length&gt;
bytes, and which starts at &lt;offset2&gt; if specified or just after the length in
the response buffer. The &lt;offset2&gt; parameter also supports relative offsets
if prepended with a '+' or '-' sign. It may also be used in tcp-check based
expect rules.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<div class="example-desc">please consult the example from the &quot;<a href="#stick%20store-response">stick store-response</a>&quot; keyword.</div><code></code></pre>
</div><a class="anchor" name="res.ssl_hello_type"></a><a class="anchor" name="7-res.ssl_hello_type"></a><a class="anchor" name="7.3.5-res.ssl_hello_type"></a><a class="anchor" name="res.ssl_hello_type (Using ACLs and fetching samples)"></a><a class="anchor" name="res.ssl_hello_type (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="res.ssl_hello_type"></a><a href="#7.3.5-res.ssl_hello_type">res.ssl_hello_type</a></b> : integer</div><a class="anchor" name="rep_ssl_hello_type"></a><a class="anchor" name="7-rep_ssl_hello_type"></a><a class="anchor" name="7.3.5-rep_ssl_hello_type"></a><a class="anchor" name="rep_ssl_hello_type (Using ACLs and fetching samples)"></a><a class="anchor" name="rep_ssl_hello_type (Fetching samples from buffer contents (Layer 6))"></a><div class="keyword"><b><a class="anchor" name="rep_ssl_hello_type"></a><a href="#7.3.5-rep_ssl_hello_type">rep_ssl_hello_type</a></b> : integer <span class="label label-warning">(deprecated)</span></div><pre class="text">Returns an integer value containing the type of the SSL hello message found
in the response buffer if the buffer contains data that parses as a complete
SSL (v3 or superior) hello message. Note that this only applies to raw
contents found in the response buffer and not to contents deciphered via an
SSL data layer, so this will not work with &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; lines having the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">ssl<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#ssl%20%28Bind%20options%29">Bind options</a></li><li><a href="#ssl%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
option. This is mostly used in ACL to detect presence of an SSL hello message
that is supposed to contain an SSL session ID usable for stickiness.
</pre></div>
<a class="anchor" id="7.3.6" name="7.3.6"></a>
<h3 id="chapter-7.3.6" data-target="7.3.6"><small><a class="small" href="#7.3.6">7.3.6.</a></small> Fetching HTTP samples (Layer 7)</h3>
<div><pre class="text">It is possible to fetch samples from HTTP contents, requests and responses.
This application layer is also called layer 7. It is only possible to fetch the
data in this section when a full HTTP request or response has been parsed from
its respective request or response buffer. This is always the case with all
HTTP specific rules and for sections running with &quot;mode http&quot;. When using TCP
content inspection, it may be necessary to support an inspection delay in order
to let the request or response come in first. These fetches may require a bit
more CPU resources than the layer 4 ones, but not much since the request and
response are indexed.

Note : Regarding HTTP processing from the tcp-request content rules, everything
       will work as expected from an HTTP proxy. However, from a TCP proxy,
       without an HTTP upgrade, it will only work for HTTP/1 content. For
       HTTP/2 content, only the preface is visible. Thus, it is only possible
       to rely to &quot;<a href="#req.proto_http">req.proto_http</a>&quot;, &quot;<a href="#req.ver">req.ver</a>&quot; and eventually &quot;<a href="#method">method</a>&quot; sample
       fetches. All other L7 sample fetches will fail. After an HTTP upgrade,
       they will work in the same manner than from an HTTP proxy.

Summary of sample fetch methods in this section and their respective types:
</pre><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-base">base</a></td><td >string</td></tr>
<tr><td ><a href="#7-base32">base32</a></td><td >integer</td></tr>
<tr><td ><a href="#7-base32%2Bsrc">base32+src</a></td><td >binary</td></tr>
<tr><td ><a href="#7-baseq">baseq</a></td><td >string</td></tr>
<tr><td ><a href="#7-capture.req.hdr">capture.req.hdr(&lt;idx&gt;)</a></td><td >string</td></tr>
<tr><td ><a href="#7-capture.req.method">capture.req.method</a></td><td >string</td></tr>
<tr><td ><a href="#7-capture.req.uri">capture.req.uri</a></td><td >string</td></tr>
<tr><td ><a href="#7-capture.req.ver">capture.req.ver</a></td><td >string</td></tr>
<tr><td ><a href="#7-capture.res.hdr">capture.res.hdr(&lt;idx&gt;)</a></td><td >string</td></tr>
<tr><td ><a href="#7-capture.res.ver">capture.res.ver</a></td><td >string</td></tr>
<tr><td ><a href="#7-req.body">req.body</a></td><td >binary</td></tr>
<tr><td ><a href="#7-req.body_param">req.body_param([&lt;name&gt;[,i]])</a></td><td >string</td></tr>
<tr><td ><a href="#7-req.body_len">req.body_len</a></td><td >integer</td></tr>
<tr><td ><a href="#7-req.body_size">req.body_size</a></td><td >integer</td></tr>
<tr><td ><a href="#7-req.cook">req.cook([&lt;name&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-cook">cook([&lt;name&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-req.cook_cnt">req.cook_cnt([&lt;name&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-cook_cnt">cook_cnt([&lt;name&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-req.cook_val">req.cook_val([&lt;name&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-cook_val">cook_val([&lt;name&gt;])</a></td><td >integer</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-req.cook_names">req.cook_names([&lt;delim&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-cookie">cookie([&lt;name&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-hdr">hdr([&lt;name&gt;[,&lt;occ&gt;]])</a></td><td >string</td></tr>
<tr><td ><a href="#7-request_date">request_date([&lt;unit&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-req.fhdr">req.fhdr(&lt;name&gt;[,&lt;occ&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-req.fhdr_cnt">req.fhdr_cnt([&lt;name&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-req.hdr">req.hdr([&lt;name&gt;[,&lt;occ&gt;]])</a></td><td >string</td></tr>
<tr><td ><a href="#7-req.hdr_cnt">req.hdr_cnt([&lt;name&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-hdr_cnt">hdr_cnt([&lt;header&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-req.hdr_ip">req.hdr_ip([&lt;name&gt;[,&lt;occ&gt;]])</a></td><td >ip</td></tr>
<tr><td ><a href="#7-hdr_ip">hdr_ip([&lt;name&gt;[,&lt;occ&gt;]])</a></td><td >ip</td></tr>
<tr><td ><a href="#7-req.hdr_val">req.hdr_val([&lt;name&gt;[,&lt;occ&gt;]])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-hdr_val">hdr_val([&lt;name&gt;[,&lt;occ&gt;]])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-req.hdrs">req.hdrs</a></td><td >string</td></tr>
<tr><td ><a href="#7-req.hdrs_bin">req.hdrs_bin</a></td><td >binary</td></tr>
<tr><td ><a href="#7-req.timer.hdr">req.timer.hdr</a></td><td >integer</td></tr>
<tr><td ><a href="#7-req.timer.idle">req.timer.idle</a></td><td >integer</td></tr>
<tr><td ><a href="#7-req.timer.queue">req.timer.queue</a></td><td >integer</td></tr>
<tr><td ><a href="#7-req.timer.tq">req.timer.tq</a></td><td >integer</td></tr>
<tr><td ><a href="#7-res.timer.hdr">res.timer.hdr</a></td><td >integer</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-http_auth">http_auth(&lt;userlist&gt;)</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-http_auth_bearer">http_auth_bearer([&lt;header&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-http_auth_group">http_auth_group(&lt;userlist&gt;)</a></td><td >string</td></tr>
<tr><td ><a href="#7-http_auth_pass">http_auth_pass</a></td><td >string</td></tr>
<tr><td ><a href="#7-http_auth_type">http_auth_type</a></td><td >string</td></tr>
<tr><td ><a href="#7-http_auth_user">http_auth_user</a></td><td >string</td></tr>
<tr><td ><a href="#7-http_first_req">http_first_req</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-method">method</a></td><td >integer</td></tr>
<tr><td ><a href="#7-path">path</a></td><td >string</td></tr>
<tr><td ><a href="#7-pathq">pathq</a></td><td >string</td></tr>
<tr><td ><a href="#7-query">query([&lt;options&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-req.hdr_names">req.hdr_names([&lt;delim&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-req.ver">req.ver</a></td><td >string</td></tr>
<tr><td ><a href="#7-req_ver">req_ver</a></td><td >string</td></tr>
<tr><td ><a href="#7-res.body">res.body</a></td><td >binary</td></tr>
<tr><td ><a href="#7-res.body_len">res.body_len</a></td><td >integer</td></tr>
<tr><td ><a href="#7-res.body_size">res.body_size</a></td><td >integer</td></tr>
<tr><td ><a href="#7-res.cache_hit">res.cache_hit</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-res.cache_name">res.cache_name</a></td><td >string</td></tr>
<tr><td ><a href="#7-res.comp">res.comp</a></td><td >boolean</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-res.comp_algo">res.comp_algo</a></td><td >string</td></tr>
<tr><td ><a href="#7-res.cook">res.cook([&lt;name&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-scook">scook([&lt;name&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-res.cook_cnt">res.cook_cnt([&lt;name&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-scook_cnt">scook_cnt([&lt;name&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-res.cook_val">res.cook_val([&lt;name&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-scook_val">scook_val([&lt;name&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-res.cook_names">res.cook_names([&lt;delim&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-res.fhdr">res.fhdr([&lt;name&gt;[,&lt;occ&gt;]])</a></td><td >string</td></tr>
<tr><td ><a href="#7-res.fhdr_cnt">res.fhdr_cnt([&lt;name&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-res.hdr">res.hdr([&lt;name&gt;[,&lt;occ&gt;]])</a></td><td >string</td></tr>
<tr><td ><a href="#7-shdr">shdr([&lt;name&gt;[,&lt;occ&gt;]])</a></td><td >string</td></tr>
<tr><td ><a href="#7-res.hdr_cnt">res.hdr_cnt([&lt;name&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-shdr_cnt">shdr_cnt([&lt;name&gt;])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-res.hdr_ip">res.hdr_ip([&lt;name&gt;[,&lt;occ&gt;]])</a></td><td >ip</td></tr>
<tr><td ><a href="#7-shdr_ip">shdr_ip([&lt;name&gt;[,&lt;occ&gt;]])</a></td><td >ip</td></tr>
<tr><td ><a href="#7-res.hdr_names">res.hdr_names([&lt;delim&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-res.hdr_val">res.hdr_val([&lt;name&gt;[,&lt;occ&gt;]])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-shdr_val">shdr_val([&lt;name&gt;[,&lt;occ&gt;]])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-res.hdrs">res.hdrs</a></td><td >string</td></tr>
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-res.hdrs_bin">res.hdrs_bin</a></td><td >binary</td></tr>
<tr><td ><a href="#7-res.ver">res.ver</a></td><td >string</td></tr>
<tr><td ><a href="#7-resp_ver">resp_ver</a></td><td >string</td></tr>
<tr><td ><a href="#7-server_status">server_status</a></td><td >integer</td></tr>
<tr><td ><a href="#7-set-cookie">set-cookie([&lt;name&gt;])</a></td><td >string</td></tr>
<tr><td ><a href="#7-status">status</a></td><td >integer</td></tr>
<tr><td ><a href="#7-txn.status">txn.status</a></td><td >integer</td></tr>
<tr><td ><a href="#7-txn.timer.total">txn.timer.total</a></td><td >integer</td></tr>
<tr><td ><a href="#7-unique-id">unique-id</a></td><td >string</td></tr>
<tr><td ><a href="#7-url">url</a></td><td >string</td></tr>
<tr><td ><a href="#7-url_ip">url_ip</a></td><td >ip</td></tr>
<tr><td ><a href="#7-url_port">url_port</a></td><td >integer</td></tr>
<tr><td ><a href="#7-urlp">urlp([&lt;name&gt;[,&lt;delim&gt;[,i]]])</a></td><td >string</td></tr>
<tr><td ><a href="#7-url_param">url_param([&lt;name&gt;[,&lt;delim&gt;[,i]]])</a></td><td >string</td></tr>
<tr><td ><a href="#7-urlp_val">urlp_val([&lt;name&gt;[,&lt;delim&gt;[,i]]])</a></td><td >integer</td></tr>
<tr><td ><a href="#7-url32">url32</a></td><td >integer</td></tr>
<tr><td ><a href="#7-url32%2Bsrc">url32+src</a></td><td >binary</td></tr>
</table><pre class="text">Detailed list:
</pre><a class="anchor" name="base"></a><a class="anchor" name="7-base"></a><a class="anchor" name="7.3.6-base"></a><a class="anchor" name="base (Using ACLs and fetching samples)"></a><a class="anchor" name="base (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="base"></a><a href="#7.3.6-base">base</a></b> : string</div><pre class="text">This returns the concatenation of the first Host header and the path part of
the request, which starts at the first slash and ends before the question
mark. It can be useful in virtual hosted environments to detect URL abuses as
well as to improve shared caches efficiency. Using this with a limited size
stick table also allows one to collect statistics about most commonly
requested objects by host/path. With ACLs it can allow simple content
switching rules involving the host and the path at the same time, such as
&quot;www.example.com/favicon.ico&quot;. See also &quot;<a href="#path">path</a>&quot; and &quot;uri&quot;.

ACL derivatives :
  base     : exact string match
  base_beg : prefix match
  base_dir : subdir match
  base_dom : domain match
  base_end : suffix match
  base_len : length match
  base_reg : regex match
  base_sub : substring match
</pre><a class="anchor" name="base32"></a><a class="anchor" name="7-base32"></a><a class="anchor" name="7.3.6-base32"></a><a class="anchor" name="base32 (Using ACLs and fetching samples)"></a><a class="anchor" name="base32 (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="base32"></a><a href="#7.3.6-base32">base32</a></b> : integer</div><pre class="text">This returns a 32-bit hash of the value returned by the &quot;<a href="#base">base</a>&quot; fetch method
above. This is useful to track per-URL activity on high traffic sites without
having to store all URLs. Instead a shorter hash is stored, saving a lot of
memory. The output type is an unsigned integer. The hash function used is
SDBM with full avalanche on the output. Technically, base32 is exactly equal
to &quot;base,sdbm(1)&quot;.
</pre><a class="anchor" name="base32+src"></a><a class="anchor" name="7-base32+src"></a><a class="anchor" name="7.3.6-base32+src"></a><a class="anchor" name="base32+src (Using ACLs and fetching samples)"></a><a class="anchor" name="base32+src (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="base32+src"></a><a href="#7.3.6-base32%2Bsrc">base32+src</a></b> : binary</div><pre class="text">This returns the concatenation of the base32 fetch above and the src fetch
below. The resulting type is of type binary, with a size of 8 or 20 bytes
depending on the source address family. This can be used to track per-IP,
per-URL counters.
</pre><a class="anchor" name="baseq"></a><a class="anchor" name="7-baseq"></a><a class="anchor" name="7.3.6-baseq"></a><a class="anchor" name="baseq (Using ACLs and fetching samples)"></a><a class="anchor" name="baseq (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="baseq"></a><a href="#7.3.6-baseq">baseq</a></b> : string</div><pre class="text">This returns the concatenation of the first Host header and the path part of
the request with the query-string, which starts at the first slash. Using this
instead of &quot;<a href="#base">base</a>&quot; allows one to properly identify the target resource, for
statistics or caching use cases. See also &quot;<a href="#path">path</a>&quot;, &quot;<a href="#pathq">pathq</a>&quot; and &quot;<a href="#base">base</a>&quot;.
</pre><a class="anchor" name="capture.req.hdr"></a><a class="anchor" name="7-capture.req.hdr"></a><a class="anchor" name="7.3.6-capture.req.hdr"></a><a class="anchor" name="capture.req.hdr (Using ACLs and fetching samples)"></a><a class="anchor" name="capture.req.hdr (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="capture.req.hdr"></a><a href="#7.3.6-capture.req.hdr">capture.req.hdr</a></b>(<span style="color: #080">&lt;idx&gt;</span>) : string</div><pre class="text">This extracts the content of the header captured by the &quot;capture request
header&quot;, idx is the position of the capture keyword in the configuration.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#capture%20request%20header">capture request header</a>&quot;.</div>
<a class="anchor" name="capture.req.method"></a><a class="anchor" name="7-capture.req.method"></a><a class="anchor" name="7.3.6-capture.req.method"></a><a class="anchor" name="capture.req.method (Using ACLs and fetching samples)"></a><a class="anchor" name="capture.req.method (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="capture.req.method"></a><a href="#7.3.6-capture.req.method">capture.req.method</a></b> : string</div><pre class="text">This extracts the METHOD of an HTTP request. It can be used in both request
and response. Unlike &quot;<a href="#method">method</a>&quot;, it can be used in both request and response
because it's allocated.
</pre><a class="anchor" name="capture.req.uri"></a><a class="anchor" name="7-capture.req.uri"></a><a class="anchor" name="7.3.6-capture.req.uri"></a><a class="anchor" name="capture.req.uri (Using ACLs and fetching samples)"></a><a class="anchor" name="capture.req.uri (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="capture.req.uri"></a><a href="#7.3.6-capture.req.uri">capture.req.uri</a></b> : string</div><pre class="text">This extracts the request's URI, which starts at the first slash and ends
before the first space in the request (without the host part). Unlike &quot;<a href="#path">path</a>&quot;
and &quot;<a href="#url">url</a>&quot;, it can be used in both request and response because it's
allocated.
</pre><a class="anchor" name="capture.req.ver"></a><a class="anchor" name="7-capture.req.ver"></a><a class="anchor" name="7.3.6-capture.req.ver"></a><a class="anchor" name="capture.req.ver (Using ACLs and fetching samples)"></a><a class="anchor" name="capture.req.ver (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="capture.req.ver"></a><a href="#7.3.6-capture.req.ver">capture.req.ver</a></b> : string</div><pre class="text">This extracts the request's HTTP version and returns either &quot;HTTP/1.0&quot; or
&quot;HTTP/1.1&quot;. Unlike &quot;<a href="#req.ver">req.ver</a>&quot;, it can be used in both request, response, and
logs because it relies on a persistent flag.
</pre><a class="anchor" name="capture.res.hdr"></a><a class="anchor" name="7-capture.res.hdr"></a><a class="anchor" name="7.3.6-capture.res.hdr"></a><a class="anchor" name="capture.res.hdr (Using ACLs and fetching samples)"></a><a class="anchor" name="capture.res.hdr (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="capture.res.hdr"></a><a href="#7.3.6-capture.res.hdr">capture.res.hdr</a></b>(<span style="color: #080">&lt;idx&gt;</span>) : string</div><pre class="text">This extracts the content of the header captured by the &quot;capture response
header&quot;, idx is the position of the capture keyword in the configuration.
The first entry is an index of 0.
</pre><div class="page-header"><b>See also:</b> &quot;<a href="#capture%20response%20header">capture response header</a>&quot;</div>
<a class="anchor" name="capture.res.ver"></a><a class="anchor" name="7-capture.res.ver"></a><a class="anchor" name="7.3.6-capture.res.ver"></a><a class="anchor" name="capture.res.ver (Using ACLs and fetching samples)"></a><a class="anchor" name="capture.res.ver (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="capture.res.ver"></a><a href="#7.3.6-capture.res.ver">capture.res.ver</a></b> : string</div><pre class="text">This extracts the response's HTTP version and returns either &quot;HTTP/1.0&quot; or
&quot;HTTP/1.1&quot;. Unlike &quot;<a href="#res.ver">res.ver</a>&quot;, it can be used in logs because it relies on a
persistent flag.
</pre><a class="anchor" name="req.body"></a><a class="anchor" name="7-req.body"></a><a class="anchor" name="7.3.6-req.body"></a><a class="anchor" name="req.body (Using ACLs and fetching samples)"></a><a class="anchor" name="req.body (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.body"></a><a href="#7.3.6-req.body">req.body</a></b> : binary</div><pre class="text">This returns the HTTP request's available body as a block of data. It is
recommended to use &quot;<a href="#option%20http-buffer-request">option http-buffer-request</a>&quot; to be sure to wait, as much
as possible, for the request's body.
</pre><a class="anchor" name="req.body_param"></a><a class="anchor" name="7-req.body_param"></a><a class="anchor" name="7.3.6-req.body_param"></a><a class="anchor" name="req.body_param (Using ACLs and fetching samples)"></a><a class="anchor" name="req.body_param (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.body_param"></a><a href="#7.3.6-req.body_param">req.body_param</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,i]</span>]</span>) : string</div><pre class="text">This fetch assumes that the body of the POST request is url-encoded. The user
can check if the &quot;content-type&quot; contains the value
&quot;application/x-www-form-urlencoded&quot;. This extracts the first occurrence of the
parameter &lt;name&gt; in the body, which ends before '&amp;'. The parameter name is
case-sensitive, unless &quot;i&quot; is added as a second argument. If no name is
given, any parameter will match, and the first one will be returned. The
result is a string corresponding to the value of the parameter &lt;name&gt; as
presented in the request body (no URL decoding is performed). Note that the
ACL version of this fetch iterates over multiple parameters and will
iteratively report all parameters values if no name is given.
</pre><a class="anchor" name="req.body_len"></a><a class="anchor" name="7-req.body_len"></a><a class="anchor" name="7.3.6-req.body_len"></a><a class="anchor" name="req.body_len (Using ACLs and fetching samples)"></a><a class="anchor" name="req.body_len (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.body_len"></a><a href="#7.3.6-req.body_len">req.body_len</a></b> : integer</div><pre class="text">This returns the length of the HTTP request's available body in bytes. It may
be lower than the advertised length if the body is larger than the buffer. It
is recommended to use &quot;<a href="#option%20http-buffer-request">option http-buffer-request</a>&quot; to be sure to wait, as
much as possible, for the request's body.
</pre><a class="anchor" name="req.body_size"></a><a class="anchor" name="7-req.body_size"></a><a class="anchor" name="7.3.6-req.body_size"></a><a class="anchor" name="req.body_size (Using ACLs and fetching samples)"></a><a class="anchor" name="req.body_size (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.body_size"></a><a href="#7.3.6-req.body_size">req.body_size</a></b> : integer</div><pre class="text">This returns the advertised length of the HTTP request's body in bytes. It
will represent the advertised Content-Length header, or the size of the
available data in case of chunked encoding.
</pre><a class="anchor" name="req.cook"></a><a class="anchor" name="7-req.cook"></a><a class="anchor" name="7.3.6-req.cook"></a><a class="anchor" name="req.cook (Using ACLs and fetching samples)"></a><a class="anchor" name="req.cook (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.cook"></a><a href="#7.3.6-req.cook">req.cook</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : string</div><a class="anchor" name="cook"></a><a class="anchor" name="7-cook"></a><a class="anchor" name="7.3.6-cook"></a><a class="anchor" name="cook (Using ACLs and fetching samples)"></a><a class="anchor" name="cook (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="cook"></a><a href="#7.3.6-cook">cook</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : string <span class="label label-warning">(deprecated)</span></div><pre class="text">This extracts the last occurrence of the cookie name &lt;name&gt; on a &quot;Cookie&quot;
header line from the request, and returns its value as string. If no name is
specified, the first cookie value is returned. When used with ACLs, all
matching cookies are evaluated. Spaces around the name and the value are
ignored as requested by the Cookie header specification (RFC6265). The cookie
name is case-sensitive. Empty cookies are valid, so an empty cookie may very
well return an empty value if it is present. Use the &quot;found&quot; match to detect
presence. Use the res.cook() variant for response cookies sent by the server.

ACL derivatives :
  req.cook([&lt;name&gt;])     : exact string match
  req.cook_beg([&lt;name&gt;]) : prefix match
  req.cook_dir([&lt;name&gt;]) : subdir match
  req.cook_dom([&lt;name&gt;]) : domain match
  req.cook_end([&lt;name&gt;]) : suffix match
  req.cook_len([&lt;name&gt;]) : length match
  req.cook_reg([&lt;name&gt;]) : regex match
  req.cook_sub([&lt;name&gt;]) : substring match
</pre><a class="anchor" name="req.cook_cnt"></a><a class="anchor" name="7-req.cook_cnt"></a><a class="anchor" name="7.3.6-req.cook_cnt"></a><a class="anchor" name="req.cook_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="req.cook_cnt (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.cook_cnt"></a><a href="#7.3.6-req.cook_cnt">req.cook_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : integer</div><a class="anchor" name="cook_cnt"></a><a class="anchor" name="7-cook_cnt"></a><a class="anchor" name="7.3.6-cook_cnt"></a><a class="anchor" name="cook_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="cook_cnt (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="cook_cnt"></a><a href="#7.3.6-cook_cnt">cook_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : integer <span class="label label-warning">(deprecated)</span></div><pre class="text">Returns an integer value representing the number of occurrences of the cookie
&lt;name&gt; in the request, or all cookies if &lt;name&gt; is not specified.
</pre><a class="anchor" name="req.cook_val"></a><a class="anchor" name="7-req.cook_val"></a><a class="anchor" name="7.3.6-req.cook_val"></a><a class="anchor" name="req.cook_val (Using ACLs and fetching samples)"></a><a class="anchor" name="req.cook_val (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.cook_val"></a><a href="#7.3.6-req.cook_val">req.cook_val</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : integer</div><a class="anchor" name="cook_val"></a><a class="anchor" name="7-cook_val"></a><a class="anchor" name="7.3.6-cook_val"></a><a class="anchor" name="cook_val (Using ACLs and fetching samples)"></a><a class="anchor" name="cook_val (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="cook_val"></a><a href="#7.3.6-cook_val">cook_val</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : integer <span class="label label-warning">(deprecated)</span></div><pre class="text">This extracts the last occurrence of the cookie name &lt;name&gt; on a &quot;Cookie&quot;
header line from the request, and converts its value to an integer which is
returned. If no name is specified, the first cookie value is returned. When
used in ACLs, all matching names are iterated over until a value matches.
</pre><a class="anchor" name="req.cook_names"></a><a class="anchor" name="7-req.cook_names"></a><a class="anchor" name="7.3.6-req.cook_names"></a><a class="anchor" name="req.cook_names (Using ACLs and fetching samples)"></a><a class="anchor" name="req.cook_names (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.cook_names"></a><a href="#7.3.6-req.cook_names">req.cook_names</a></b>(<span style="color: #008">[<span style="color: #080">&lt;delim&gt;</span>]</span>) : string</div><pre class="text">This builds a string made from the concatenation of all cookie names as they
appear in the request (Cookie header) when the rule is evaluated. The default
delimiter is the comma (',') but it may be overridden as an optional argument
&lt;delim&gt;. In this case, only the first character of &lt;delim&gt; is considered.
</pre><a class="anchor" name="cookie"></a><a class="anchor" name="7-cookie"></a><a class="anchor" name="7.3.6-cookie"></a><a class="anchor" name="cookie (Using ACLs and fetching samples)"></a><a class="anchor" name="cookie (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="cookie"></a><a href="#7.3.6-cookie">cookie</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : string <span class="label label-warning">(deprecated)</span></div><pre class="text">This extracts the last occurrence of the cookie name &lt;name&gt; on a &quot;Cookie&quot;
header line from the request, or a &quot;Set-Cookie&quot; header from the response, and
returns its value as a string. A typical use is to get multiple clients
sharing a same profile use the same server. This can be similar to what
&quot;appsession&quot; did with the &quot;request-learn&quot; statement, but with support for
multi-peer synchronization and state keeping across restarts. If no name is
specified, the first cookie value is returned. This fetch should not be used
anymore and should be replaced by req.cook() or res.cook() instead as it
ambiguously uses the direction based on the context where it is used.
</pre><a class="anchor" name="hdr"></a><a class="anchor" name="7-hdr"></a><a class="anchor" name="7.3.6-hdr"></a><a class="anchor" name="hdr (Using ACLs and fetching samples)"></a><a class="anchor" name="hdr (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="hdr"></a><a href="#7.3.6-hdr">hdr</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>]</span>) : string</div><pre class="text">This is equivalent to req.hdr() when used on requests, and to res.hdr() when
used on responses. Please refer to these respective fetches for more details.
In case of doubt about the fetch direction, please use the explicit ones.
Note that contrary to the hdr() sample fetch method, the hdr_* ACL keywords
unambiguously apply to the request headers.
</pre><a class="anchor" name="request_date"></a><a class="anchor" name="7-request_date"></a><a class="anchor" name="7.3.6-request_date"></a><a class="anchor" name="request_date (Using ACLs and fetching samples)"></a><a class="anchor" name="request_date (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="request_date"></a><a href="#7.3.6-request_date">request_date</a></b>(<span style="color: #008">[<span style="color: #080">&lt;unit&gt;</span>]</span>) : integer</div><pre class="text">This is the exact date when the first byte of the HTTP request was received
by HAProxy (log-format alias %tr). This is computed from accept_date +
handshake time (%Th) + idle time (%Ti).

Returns a value in number of seconds since epoch.

&lt;unit&gt; is facultative, and can be set to &quot;s&quot; for seconds (default behavior),
&quot;ms&quot; for  milliseconds or &quot;us&quot; for microseconds.
If unit is set, return value is an integer reflecting either seconds,
milliseconds or microseconds since epoch.
It is useful when a time resolution of less than a second is needed.
</pre><a class="anchor" name="req.fhdr"></a><a class="anchor" name="7-req.fhdr"></a><a class="anchor" name="7.3.6-req.fhdr"></a><a class="anchor" name="req.fhdr (Using ACLs and fetching samples)"></a><a class="anchor" name="req.fhdr (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.fhdr"></a><a href="#7.3.6-req.fhdr">req.fhdr</a></b>(<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>) : string</div><pre class="text">This returns the full value of the last occurrence of header &lt;name&gt; in an
HTTP request. It differs from req.hdr() in that any commas present in the
value are returned and are not used as delimiters. This is sometimes useful
with headers such as User-Agent.

When used from an ACL, all occurrences are iterated over until a match is
found.

Optionally, a specific occurrence might be specified as a position number.
Positive values indicate a position from the first occurrence, with 1 being
the first one. Negative values indicate positions relative to the last one,
with -1 being the last one.
</pre><a class="anchor" name="req.fhdr_cnt"></a><a class="anchor" name="7-req.fhdr_cnt"></a><a class="anchor" name="7.3.6-req.fhdr_cnt"></a><a class="anchor" name="req.fhdr_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="req.fhdr_cnt (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.fhdr_cnt"></a><a href="#7.3.6-req.fhdr_cnt">req.fhdr_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : integer</div><pre class="text">Returns an integer value representing the number of occurrences of request
header field name &lt;name&gt;, or the total number of header fields if &lt;name&gt; is
not specified. Like req.fhdr() it differs from res.hdr_cnt() by not splitting
headers at commas.
</pre><a class="anchor" name="req.hdr"></a><a class="anchor" name="7-req.hdr"></a><a class="anchor" name="7.3.6-req.hdr"></a><a class="anchor" name="req.hdr (Using ACLs and fetching samples)"></a><a class="anchor" name="req.hdr (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.hdr"></a><a href="#7.3.6-req.hdr">req.hdr</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>]</span>) : string</div><pre class="text">This returns the last comma-separated value of the header &lt;name&gt; in an HTTP
request. The fetch considers any comma as a delimiter for distinct values.
This is useful if you need to process headers that are defined to be a list
of values, such as Accept, or X-Forwarded-For. If full-line headers are
desired instead, use req.fhdr(). Please carefully check RFC 7231 to know how
certain headers are supposed to be parsed. Also, some of them are case
insensitive (e.g. Connection).

When used from an ACL, all occurrences are iterated over until a match is
found.

Optionally, a specific occurrence might be specified as a position number.
Positive values indicate a position from the first occurrence, with 1 being
the first one. Negative values indicate positions relative to the last one,
with -1 being the last one.

A typical use is with the X-Forwarded-For header once converted to IP,
associated with an IP stick-table.

ACL derivatives :
  hdr([&lt;name&gt;[,&lt;occ&gt;]])     : exact string match
  hdr_beg([&lt;name&gt;[,&lt;occ&gt;]]) : prefix match
  hdr_dir([&lt;name&gt;[,&lt;occ&gt;]]) : subdir match
  hdr_dom([&lt;name&gt;[,&lt;occ&gt;]]) : domain match
  hdr_end([&lt;name&gt;[,&lt;occ&gt;]]) : suffix match
  hdr_len([&lt;name&gt;[,&lt;occ&gt;]]) : length match
  hdr_reg([&lt;name&gt;[,&lt;occ&gt;]]) : regex match
  hdr_sub([&lt;name&gt;[,&lt;occ&gt;]]) : substring match
</pre><a class="anchor" name="req.hdr_cnt"></a><a class="anchor" name="7-req.hdr_cnt"></a><a class="anchor" name="7.3.6-req.hdr_cnt"></a><a class="anchor" name="req.hdr_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="req.hdr_cnt (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.hdr_cnt"></a><a href="#7.3.6-req.hdr_cnt">req.hdr_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : integer</div><a class="anchor" name="hdr_cnt"></a><a class="anchor" name="7-hdr_cnt"></a><a class="anchor" name="7.3.6-hdr_cnt"></a><a class="anchor" name="hdr_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="hdr_cnt (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="hdr_cnt"></a><a href="#7.3.6-hdr_cnt">hdr_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;header&gt;</span>]</span>) : integer <span class="label label-warning">(deprecated)</span></div><pre class="text">Returns an integer value representing the number of occurrences of request
header field name &lt;name&gt;, or the total number of header field values if
&lt;name&gt; is not specified. Like req.hdr() it counts each comma separated
part of the header's value. If counting of full-line headers is desired,
then req.fhdr_cnt() should be used instead.

With ACLs, it can be used to detect presence, absence or abuse of a specific
header, as well as to block request smuggling attacks by rejecting requests
which contain more than one of certain headers.

Refer to req.hdr() for more information on header matching.
</pre><a class="anchor" name="req.hdr_ip"></a><a class="anchor" name="7-req.hdr_ip"></a><a class="anchor" name="7.3.6-req.hdr_ip"></a><a class="anchor" name="req.hdr_ip (Using ACLs and fetching samples)"></a><a class="anchor" name="req.hdr_ip (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.hdr_ip"></a><a href="#7.3.6-req.hdr_ip">req.hdr_ip</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>]</span>) : ip</div><a class="anchor" name="hdr_ip"></a><a class="anchor" name="7-hdr_ip"></a><a class="anchor" name="7.3.6-hdr_ip"></a><a class="anchor" name="hdr_ip (Using ACLs and fetching samples)"></a><a class="anchor" name="hdr_ip (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="hdr_ip"></a><a href="#7.3.6-hdr_ip">hdr_ip</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>]</span>) : ip <span class="label label-warning">(deprecated)</span></div><pre class="text">This extracts the last occurrence of header &lt;name&gt; in an HTTP request,
converts it to an IPv4 or IPv6 address and returns this address. When used
with ACLs, all occurrences are checked, and if &lt;name&gt; is omitted, every value
of every header is checked. The parser strictly adheres to the format
described in RFC7239, with the extension that IPv4 addresses may optionally
be followed by a colon (':') and a valid decimal port number (0 to 65535),
which will be silently dropped. All other forms will not match and will
cause the address to be ignored.

The &lt;occ&gt; parameter is processed as with req.hdr().

A typical use is with the X-Forwarded-For and X-Client-IP headers.
</pre><a class="anchor" name="req.hdr_val"></a><a class="anchor" name="7-req.hdr_val"></a><a class="anchor" name="7.3.6-req.hdr_val"></a><a class="anchor" name="req.hdr_val (Using ACLs and fetching samples)"></a><a class="anchor" name="req.hdr_val (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.hdr_val"></a><a href="#7.3.6-req.hdr_val">req.hdr_val</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>]</span>) : integer</div><a class="anchor" name="hdr_val"></a><a class="anchor" name="7-hdr_val"></a><a class="anchor" name="7.3.6-hdr_val"></a><a class="anchor" name="hdr_val (Using ACLs and fetching samples)"></a><a class="anchor" name="hdr_val (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="hdr_val"></a><a href="#7.3.6-hdr_val">hdr_val</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>]</span>) : integer <span class="label label-warning">(deprecated)</span></div><pre class="text">This extracts the last occurrence of header &lt;name&gt; in an HTTP request, and
converts it to an integer value. When used with ACLs, all occurrences are
checked, and if &lt;name&gt; is omitted, every value of every header is checked.

The &lt;occ&gt; parameter is processed as with req.hdr().

A typical use is with the X-Forwarded-For header.
</pre><a class="anchor" name="req.hdrs"></a><a class="anchor" name="7-req.hdrs"></a><a class="anchor" name="7.3.6-req.hdrs"></a><a class="anchor" name="req.hdrs (Using ACLs and fetching samples)"></a><a class="anchor" name="req.hdrs (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.hdrs"></a><a href="#7.3.6-req.hdrs">req.hdrs</a></b> : string</div><pre class="text">Returns the current request headers as string including the last empty line
separating headers from the request body. The last empty line can be used to
detect a truncated header block. This sample fetch is useful for some SPOE
headers analyzers and for advanced logging.
</pre><a class="anchor" name="req.hdrs_bin"></a><a class="anchor" name="7-req.hdrs_bin"></a><a class="anchor" name="7.3.6-req.hdrs_bin"></a><a class="anchor" name="req.hdrs_bin (Using ACLs and fetching samples)"></a><a class="anchor" name="req.hdrs_bin (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.hdrs_bin"></a><a href="#7.3.6-req.hdrs_bin">req.hdrs_bin</a></b> : binary</div><pre class="text">Returns the current request headers contained in preparsed binary form. This
is useful for offloading some processing with SPOE. Each string is described
by a length followed by the number of bytes indicated in the length. The
length is represented using the variable integer encoding detailed in the
SPOE documentation. The end of the list is marked by a couple of empty header
names and values (length of 0 for both).

*(&lt;str:header-name&gt;&lt;str:header-value&gt;)&lt;empty string&gt;&lt;empty string&gt;

int:  refer to the SPOE documentation for the encoding
str:  &lt;int:length&gt;&lt;bytes&gt;
</pre><a class="anchor" name="req.timer.hdr"></a><a class="anchor" name="7-req.timer.hdr"></a><a class="anchor" name="7.3.6-req.timer.hdr"></a><a class="anchor" name="req.timer.hdr (Using ACLs and fetching samples)"></a><a class="anchor" name="req.timer.hdr (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.timer.hdr"></a><a href="#7.3.6-req.timer.hdr">req.timer.hdr</a></b> : integer</div><pre class="text">Total time to get the client request (HTTP mode only). It's the time elapsed
between the first bytes received and the moment the proxy received the empty
line marking the end of the HTTP headers. This is reported in milliseconds
(ms) and is equivalent to %TR in log-format. See <a href="#8.4">section 8.4</a> &quot;Timing events&quot;
for more details.
</pre><a class="anchor" name="req.timer.idle"></a><a class="anchor" name="7-req.timer.idle"></a><a class="anchor" name="7.3.6-req.timer.idle"></a><a class="anchor" name="req.timer.idle (Using ACLs and fetching samples)"></a><a class="anchor" name="req.timer.idle (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.timer.idle"></a><a href="#7.3.6-req.timer.idle">req.timer.idle</a></b> : integer</div><pre class="text">This is the idle time before the HTTP request (HTTP mode only). This timer
counts between the end of the handshakes and the first byte of the HTTP
request. This is reported in milliseconds and is equivalent to %Ti in
log-format. See <a href="#8.4">section 8.4</a> &quot;Timing events&quot; for more details.
</pre><a class="anchor" name="req.timer.queue"></a><a class="anchor" name="7-req.timer.queue"></a><a class="anchor" name="7.3.6-req.timer.queue"></a><a class="anchor" name="req.timer.queue (Using ACLs and fetching samples)"></a><a class="anchor" name="req.timer.queue (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.timer.queue"></a><a href="#7.3.6-req.timer.queue">req.timer.queue</a></b> : integer</div><pre class="text">Total time spent in the queues waiting for a connection slot.
This is reported in milliseconds and is equivalent to %Tw in
log-format. See <a href="#8.4">section 8.4</a> &quot;Timing events&quot; for more details.
</pre><a class="anchor" name="req.timer.tq"></a><a class="anchor" name="7-req.timer.tq"></a><a class="anchor" name="7.3.6-req.timer.tq"></a><a class="anchor" name="req.timer.tq (Using ACLs and fetching samples)"></a><a class="anchor" name="req.timer.tq (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.timer.tq"></a><a href="#7.3.6-req.timer.tq">req.timer.tq</a></b> : integer</div><pre class="text">total time to get the client request from the accept date or since the
emission of the last byte of the previous response.
This is reported in milliseconds and is equivalent to %Tq in
log-format. See <a href="#8.4">section 8.4</a> &quot;Timing events&quot; for more details.
</pre><a class="anchor" name="res.timer.hdr"></a><a class="anchor" name="7-res.timer.hdr"></a><a class="anchor" name="7.3.6-res.timer.hdr"></a><a class="anchor" name="res.timer.hdr (Using ACLs and fetching samples)"></a><a class="anchor" name="res.timer.hdr (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.timer.hdr"></a><a href="#7.3.6-res.timer.hdr">res.timer.hdr</a></b> : integer</div><pre class="text">It's the time elapsed between the moment the TCP connection was established
to the server and the moment the server sent its complete response headers.
This is reported in milliseconds and is equivalent to %Tr in log-format. See
<a href="#8.4">section 8.4</a> &quot;Timing events&quot; for more details.
</pre><a class="anchor" name="http_auth"></a><a class="anchor" name="7-http_auth"></a><a class="anchor" name="7.3.6-http_auth"></a><a class="anchor" name="http_auth (Using ACLs and fetching samples)"></a><a class="anchor" name="http_auth (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="http_auth"></a><a href="#7.3.6-http_auth">http_auth</a></b>(<span style="color: #080">&lt;userlist&gt;</span>) : boolean</div><pre class="text">Returns a boolean indicating whether the authentication data received from
the client match a username &amp; password stored in the specified userlist. This
fetch function is not really useful outside of ACLs. Currently only http
basic auth is supported.
</pre><a class="anchor" name="http_auth_bearer"></a><a class="anchor" name="7-http_auth_bearer"></a><a class="anchor" name="7.3.6-http_auth_bearer"></a><a class="anchor" name="http_auth_bearer (Using ACLs and fetching samples)"></a><a class="anchor" name="http_auth_bearer (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="http_auth_bearer"></a><a href="#7.3.6-http_auth_bearer">http_auth_bearer</a></b>(<span style="color: #008">[<span style="color: #080">&lt;header&gt;</span>]</span>) : string</div><pre class="text">Returns the client-provided token found in the authorization data when the
Bearer scheme is used (to send JSON Web Tokens for instance). No check is
performed on the data sent by the client.
If a specific &lt;header&gt; is supplied, it will parse this header instead of the
Authorization one.
</pre><a class="anchor" name="http_auth_group"></a><a class="anchor" name="7-http_auth_group"></a><a class="anchor" name="7.3.6-http_auth_group"></a><a class="anchor" name="http_auth_group (Using ACLs and fetching samples)"></a><a class="anchor" name="http_auth_group (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="http_auth_group"></a><a href="#7.3.6-http_auth_group">http_auth_group</a></b>(<span style="color: #080">&lt;userlist&gt;</span>) : string</div><pre class="text">Returns a string corresponding to the user name found in the authentication
data received from the client if both the user name and password are valid
according to the specified userlist. The main purpose is to use it in ACLs
where it is then checked whether the user belongs to any group within a list.
This fetch function is not really useful outside of ACLs. Currently only http
basic auth is supported.

ACL derivatives :
  http_auth_group(&lt;userlist&gt;) : group ...
  Returns true when the user extracted from the request and whose password is
  valid according to the specified userlist belongs to at least one of the
  groups.
</pre><a class="anchor" name="http_auth_pass"></a><a class="anchor" name="7-http_auth_pass"></a><a class="anchor" name="7.3.6-http_auth_pass"></a><a class="anchor" name="http_auth_pass (Using ACLs and fetching samples)"></a><a class="anchor" name="http_auth_pass (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="http_auth_pass"></a><a href="#7.3.6-http_auth_pass">http_auth_pass</a></b> : string</div><pre class="text">Returns the user's password found in the authentication data received from
the client, as supplied in the Authorization header. Not checks are
performed by this sample fetch. Only Basic authentication is supported.
</pre><a class="anchor" name="http_auth_type"></a><a class="anchor" name="7-http_auth_type"></a><a class="anchor" name="7.3.6-http_auth_type"></a><a class="anchor" name="http_auth_type (Using ACLs and fetching samples)"></a><a class="anchor" name="http_auth_type (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="http_auth_type"></a><a href="#7.3.6-http_auth_type">http_auth_type</a></b> : string</div><pre class="text">Returns the authentication method found in the authentication data received from
the client, as supplied in the Authorization header. Not checks are
performed by this sample fetch. Only Basic authentication is supported.
</pre><a class="anchor" name="http_auth_user"></a><a class="anchor" name="7-http_auth_user"></a><a class="anchor" name="7.3.6-http_auth_user"></a><a class="anchor" name="http_auth_user (Using ACLs and fetching samples)"></a><a class="anchor" name="http_auth_user (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="http_auth_user"></a><a href="#7.3.6-http_auth_user">http_auth_user</a></b> : string</div><pre class="text">Returns the user name found in the authentication data received from the
client, as supplied in the Authorization header. Not checks are performed by
this sample fetch. Only Basic authentication is supported.
</pre><a class="anchor" name="http_first_req"></a><a class="anchor" name="7-http_first_req"></a><a class="anchor" name="7.3.6-http_first_req"></a><a class="anchor" name="http_first_req (Using ACLs and fetching samples)"></a><a class="anchor" name="http_first_req (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="http_first_req"></a><a href="#7.3.6-http_first_req">http_first_req</a></b> : boolean</div><pre class="text">Returns true when the request being processed is the first one of the
connection. This can be used to add or remove headers that may be missing
from some requests when a request is not the first one, or to help grouping
requests in the logs.
</pre><a class="anchor" name="method"></a><a class="anchor" name="7-method"></a><a class="anchor" name="7.3.6-method"></a><a class="anchor" name="method (Using ACLs and fetching samples)"></a><a class="anchor" name="method (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="method"></a><a href="#7.3.6-method">method</a></b> : integer + string</div><pre class="text">Returns an integer value corresponding to the method in the HTTP request. For
example, &quot;GET&quot; equals 1 (check sources to establish the matching). Value 9
means &quot;other method&quot; and may be converted to a string extracted from the
stream. This should not be used directly as a sample, this is only meant to
be used from ACLs, which transparently convert methods from patterns to these
integer + string values. Some predefined ACL already check for most common
methods.

ACL derivatives :
  method : case insensitive method match
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># only accept GET and HEAD requests</span>
acl valid_method method GET HEAD
http-request deny if ! valid_method
</code></pre>
</div><a class="anchor" name="path"></a><a class="anchor" name="7-path"></a><a class="anchor" name="7.3.6-path"></a><a class="anchor" name="path (Using ACLs and fetching samples)"></a><a class="anchor" name="path (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="path"></a><a href="#7.3.6-path">path</a></b> : string</div><pre class="text">This extracts the request's URL path, which starts at the first slash and
ends before the question mark (without the host part). A typical use is with
prefetch-capable caches, and with portals which need to aggregate multiple
information from databases and keep them in caches. Note that with outgoing
caches, it would be wiser to use &quot;<a href="#url">url</a>&quot; instead. With ACLs, it's typically
used to match exact file names (e.g. &quot;/login.php&quot;), or directory parts using
the derivative forms. See also the &quot;<a href="#url">url</a>&quot; and &quot;<a href="#base">base</a>&quot; fetch methods. Please
note that any fragment reference in the URI ('#' after the path) is strictly
forbidden by the HTTP standard and will be rejected. However, if the frontend
receiving the request has &quot;<a href="#option%20accept-unsafe-violations-in-http-request">option accept-unsafe-violations-in-http-request</a>&quot;,
then this fragment part will be accepted and will also appear in the path.

ACL derivatives :
  path     : exact string match
  path_beg : prefix match
  path_dir : subdir match
  path_dom : domain match
  path_end : suffix match
  path_len : length match
  path_reg : regex match
  path_sub : substring match
</pre><a class="anchor" name="pathq"></a><a class="anchor" name="7-pathq"></a><a class="anchor" name="7.3.6-pathq"></a><a class="anchor" name="pathq (Using ACLs and fetching samples)"></a><a class="anchor" name="pathq (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="pathq"></a><a href="#7.3.6-pathq">pathq</a></b> : string</div><pre class="text">This extracts the request's URL path with the query-string, which starts at
the first slash. This sample fetch is pretty handy to always retrieve a
relative URI, excluding the scheme and the authority part, if any. Indeed,
while it is the common representation for an HTTP/1.1 request target, in
HTTP/2, an absolute URI is often used. This sample fetch will return the same
result in both cases. Please note that any fragment reference in the URI ('#'
after the path) is strictly forbidden by the HTTP standard and will be
rejected. However, if the frontend receiving the request has &quot;option
accept-unsafe-violations-in-http-request&quot;, then this fragment part will be
accepted and will also appear in the path.
</pre><a class="anchor" name="query"></a><a class="anchor" name="7-query"></a><a class="anchor" name="7.3.6-query"></a><a class="anchor" name="query (Using ACLs and fetching samples)"></a><a class="anchor" name="query (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="query"></a><a href="#7.3.6-query">query</a></b>(<span style="color: #008">[<span style="color: #080">&lt;options&gt;</span>]</span>) : string</div><pre class="text">This extracts the request's query string, which starts after the first
question mark. If no question mark is present, this fetch returns nothing. If
a question mark is present but nothing follows, it returns an empty string.
This means it's possible to easily know whether a query string is present
using the &quot;found&quot; matching method. This fetch is the complement of &quot;<a href="#path">path</a>&quot;
which stops before the question mark and of &quot;query_string&quot;, which include the
question mark.

An optional parameter may be used to customize the return value. Following
options are supported:

  - with_qm : Include the question mark at the beginning ot the query string,
              if not empty.
</pre><a class="anchor" name="req.hdr_names"></a><a class="anchor" name="7-req.hdr_names"></a><a class="anchor" name="7.3.6-req.hdr_names"></a><a class="anchor" name="req.hdr_names (Using ACLs and fetching samples)"></a><a class="anchor" name="req.hdr_names (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.hdr_names"></a><a href="#7.3.6-req.hdr_names">req.hdr_names</a></b>(<span style="color: #008">[<span style="color: #080">&lt;delim&gt;</span>]</span>) : string</div><pre class="text">This builds a string made from the concatenation of all header names as they
appear in the request when the rule is evaluated. The default delimiter is
the comma (',') but it may be overridden as an optional argument &lt;delim&gt;. In
this case, only the first character of &lt;delim&gt; is considered.
</pre><a class="anchor" name="req.ver"></a><a class="anchor" name="7-req.ver"></a><a class="anchor" name="7.3.6-req.ver"></a><a class="anchor" name="req.ver (Using ACLs and fetching samples)"></a><a class="anchor" name="req.ver (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req.ver"></a><a href="#7.3.6-req.ver">req.ver</a></b> : string</div><a class="anchor" name="req_ver"></a><a class="anchor" name="7-req_ver"></a><a class="anchor" name="7.3.6-req_ver"></a><a class="anchor" name="req_ver (Using ACLs and fetching samples)"></a><a class="anchor" name="req_ver (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="req_ver"></a><a href="#7.3.6-req_ver">req_ver</a></b> : string <span class="label label-warning">(deprecated)</span></div><pre class="text">Returns the version string from the HTTP request, for example &quot;1.1&quot;. This can
be useful for ACL. For logs use the &quot;%HV&quot; logformat alias. Some predefined
ACL already check for versions 1.0 and 1.1.

Common values are &quot;1.0&quot;, &quot;1.1&quot;, &quot;2.0&quot; or &quot;3.0&quot;.

In the case of http/2 and http/3, the value is not extracted from the HTTP
version in the request line but is determined by the negotiated protocol
version.

ACL derivatives :
  req.ver : exact string match
</pre><a class="anchor" name="res.body"></a><a class="anchor" name="7-res.body"></a><a class="anchor" name="7.3.6-res.body"></a><a class="anchor" name="res.body (Using ACLs and fetching samples)"></a><a class="anchor" name="res.body (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.body"></a><a href="#7.3.6-res.body">res.body</a></b> : binary</div><pre class="text">This returns the HTTP response's available body as a block of data. Unlike
the request side, there is no directive to wait for the response's body. This
sample fetch is really useful (and usable) in the health-check context.

It may be used in tcp-check based expect rules.
</pre><a class="anchor" name="res.body_len"></a><a class="anchor" name="7-res.body_len"></a><a class="anchor" name="7.3.6-res.body_len"></a><a class="anchor" name="res.body_len (Using ACLs and fetching samples)"></a><a class="anchor" name="res.body_len (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.body_len"></a><a href="#7.3.6-res.body_len">res.body_len</a></b> : integer</div><pre class="text">This returns the length of the HTTP response available body in bytes. Unlike
the request side, there is no directive to wait for the response's body. This
sample fetch is really useful (and usable) in the health-check context.

It may be used in tcp-check based expect rules.
</pre><a class="anchor" name="res.body_size"></a><a class="anchor" name="7-res.body_size"></a><a class="anchor" name="7.3.6-res.body_size"></a><a class="anchor" name="res.body_size (Using ACLs and fetching samples)"></a><a class="anchor" name="res.body_size (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.body_size"></a><a href="#7.3.6-res.body_size">res.body_size</a></b> : integer</div><pre class="text">This returns the advertised length of the HTTP response body in bytes. It
will represent the advertised Content-Length header, or the size of the
available data in case of chunked encoding. Unlike the request side, there is
no directive to wait for the response body. This sample fetch is really
useful (and usable) in the health-check context.

It may be used in tcp-check based expect rules.
</pre><a class="anchor" name="res.cache_hit"></a><a class="anchor" name="7-res.cache_hit"></a><a class="anchor" name="7.3.6-res.cache_hit"></a><a class="anchor" name="res.cache_hit (Using ACLs and fetching samples)"></a><a class="anchor" name="res.cache_hit (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.cache_hit"></a><a href="#7.3.6-res.cache_hit">res.cache_hit</a></b> : boolean</div><pre class="text">Returns the boolean &quot;true&quot; value if the response has been built out of an
HTTP cache entry, otherwise returns boolean &quot;false&quot;.
</pre><a class="anchor" name="res.cache_name"></a><a class="anchor" name="7-res.cache_name"></a><a class="anchor" name="7.3.6-res.cache_name"></a><a class="anchor" name="res.cache_name (Using ACLs and fetching samples)"></a><a class="anchor" name="res.cache_name (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.cache_name"></a><a href="#7.3.6-res.cache_name">res.cache_name</a></b> : string</div><pre class="text">Returns a string containing the name of the HTTP cache that was used to
build the HTTP response if res.cache_hit is true, otherwise returns an
empty string.
</pre><a class="anchor" name="res.comp"></a><a class="anchor" name="7-res.comp"></a><a class="anchor" name="7.3.6-res.comp"></a><a class="anchor" name="res.comp (Using ACLs and fetching samples)"></a><a class="anchor" name="res.comp (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.comp"></a><a href="#7.3.6-res.comp">res.comp</a></b> : boolean</div><pre class="text">Returns the boolean &quot;true&quot; value if the response has been compressed by
HAProxy, otherwise returns boolean &quot;false&quot;. This may be used to add
information in the logs.
</pre><a class="anchor" name="res.comp_algo"></a><a class="anchor" name="7-res.comp_algo"></a><a class="anchor" name="7.3.6-res.comp_algo"></a><a class="anchor" name="res.comp_algo (Using ACLs and fetching samples)"></a><a class="anchor" name="res.comp_algo (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.comp_algo"></a><a href="#7.3.6-res.comp_algo">res.comp_algo</a></b> : string</div><pre class="text">Returns a string containing the name of the algorithm used if the response
was compressed by HAProxy, for example : &quot;deflate&quot;. This may be used to add
some information in the logs.
</pre><a class="anchor" name="res.cook"></a><a class="anchor" name="7-res.cook"></a><a class="anchor" name="7.3.6-res.cook"></a><a class="anchor" name="res.cook (Using ACLs and fetching samples)"></a><a class="anchor" name="res.cook (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.cook"></a><a href="#7.3.6-res.cook">res.cook</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : string</div><a class="anchor" name="scook"></a><a class="anchor" name="7-scook"></a><a class="anchor" name="7.3.6-scook"></a><a class="anchor" name="scook (Using ACLs and fetching samples)"></a><a class="anchor" name="scook (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="scook"></a><a href="#7.3.6-scook">scook</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : string <span class="label label-warning">(deprecated)</span></div><pre class="text">This extracts the last occurrence of the cookie name &lt;name&gt; on a &quot;Set-Cookie&quot;
header line from the response, and returns its value as string. If no name is
specified, the first cookie value is returned.

It may be used in tcp-check based expect rules.

ACL derivatives :
  res.scook([&lt;name&gt;] : exact string match
</pre><a class="anchor" name="res.cook_cnt"></a><a class="anchor" name="7-res.cook_cnt"></a><a class="anchor" name="7.3.6-res.cook_cnt"></a><a class="anchor" name="res.cook_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="res.cook_cnt (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.cook_cnt"></a><a href="#7.3.6-res.cook_cnt">res.cook_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : integer</div><a class="anchor" name="scook_cnt"></a><a class="anchor" name="7-scook_cnt"></a><a class="anchor" name="7.3.6-scook_cnt"></a><a class="anchor" name="scook_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="scook_cnt (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="scook_cnt"></a><a href="#7.3.6-scook_cnt">scook_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : integer <span class="label label-warning">(deprecated)</span></div><pre class="text">Returns an integer value representing the number of occurrences of the cookie
&lt;name&gt; in the response, or all cookies if &lt;name&gt; is not specified. This is
mostly useful when combined with ACLs to detect suspicious responses.

It may be used in tcp-check based expect rules.
</pre><a class="anchor" name="res.cook_val"></a><a class="anchor" name="7-res.cook_val"></a><a class="anchor" name="7.3.6-res.cook_val"></a><a class="anchor" name="res.cook_val (Using ACLs and fetching samples)"></a><a class="anchor" name="res.cook_val (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.cook_val"></a><a href="#7.3.6-res.cook_val">res.cook_val</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : integer</div><a class="anchor" name="scook_val"></a><a class="anchor" name="7-scook_val"></a><a class="anchor" name="7.3.6-scook_val"></a><a class="anchor" name="scook_val (Using ACLs and fetching samples)"></a><a class="anchor" name="scook_val (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="scook_val"></a><a href="#7.3.6-scook_val">scook_val</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : integer <span class="label label-warning">(deprecated)</span></div><pre class="text">This extracts the last occurrence of the cookie name &lt;name&gt; on a &quot;Set-Cookie&quot;
header line from the response, and converts its value to an integer which is
returned. If no name is specified, the first cookie value is returned.

It may be used in tcp-check based expect rules.
</pre><a class="anchor" name="res.cook_names"></a><a class="anchor" name="7-res.cook_names"></a><a class="anchor" name="7.3.6-res.cook_names"></a><a class="anchor" name="res.cook_names (Using ACLs and fetching samples)"></a><a class="anchor" name="res.cook_names (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.cook_names"></a><a href="#7.3.6-res.cook_names">res.cook_names</a></b>(<span style="color: #008">[<span style="color: #080">&lt;delim&gt;</span>]</span>) : string</div><pre class="text">This builds a string made from the concatenation of all cookie names as they
appear in the response (Set-Cookie headers) when the rule is evaluated. The
default delimiter is the comma (',') but it may be overridden as an optional
argument &lt;delim&gt;. In this case, only the first character of &lt;delim&gt; is
considered.

It may be used in tcp-check based expect rules.
</pre><a class="anchor" name="res.fhdr"></a><a class="anchor" name="7-res.fhdr"></a><a class="anchor" name="7.3.6-res.fhdr"></a><a class="anchor" name="res.fhdr (Using ACLs and fetching samples)"></a><a class="anchor" name="res.fhdr (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.fhdr"></a><a href="#7.3.6-res.fhdr">res.fhdr</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>]</span>) : string</div><pre class="text">This fetch works like the req.fhdr() fetch with the difference that it acts
on the headers within an HTTP response.

Like req.fhdr() the res.fhdr() fetch returns full values. If the header is
defined to be a list you should use res.hdr().

This fetch is sometimes useful with headers such as Date or Expires.

It may be used in tcp-check based expect rules.
</pre><a class="anchor" name="res.fhdr_cnt"></a><a class="anchor" name="7-res.fhdr_cnt"></a><a class="anchor" name="7.3.6-res.fhdr_cnt"></a><a class="anchor" name="res.fhdr_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="res.fhdr_cnt (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.fhdr_cnt"></a><a href="#7.3.6-res.fhdr_cnt">res.fhdr_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : integer</div><pre class="text">This fetch works like the req.fhdr_cnt() fetch with the difference that it
acts on the headers within an HTTP response.

Like req.fhdr_cnt() the res.fhdr_cnt() fetch acts on full values. If the
header is defined to be a list you should use res.hdr_cnt().

It may be used in tcp-check based expect rules.
</pre><a class="anchor" name="res.hdr"></a><a class="anchor" name="7-res.hdr"></a><a class="anchor" name="7.3.6-res.hdr"></a><a class="anchor" name="res.hdr (Using ACLs and fetching samples)"></a><a class="anchor" name="res.hdr (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.hdr"></a><a href="#7.3.6-res.hdr">res.hdr</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>]</span>) : string</div><a class="anchor" name="shdr"></a><a class="anchor" name="7-shdr"></a><a class="anchor" name="7.3.6-shdr"></a><a class="anchor" name="shdr (Using ACLs and fetching samples)"></a><a class="anchor" name="shdr (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="shdr"></a><a href="#7.3.6-shdr">shdr</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>]</span>) : string <span class="label label-warning">(deprecated)</span></div><pre class="text">This fetch works like the req.hdr() fetch with the difference that it acts
on the headers within an HTTP response.

Like req.hdr() the res.hdr() fetch considers the comma to be a delimiter. If
this is not desired res.fhdr() should be used.

It may be used in tcp-check based expect rules.

ACL derivatives :
  res.hdr([&lt;name&gt;[,&lt;occ&gt;]])     : exact string match
  res.hdr_beg([&lt;name&gt;[,&lt;occ&gt;]]) : prefix match
  res.hdr_dir([&lt;name&gt;[,&lt;occ&gt;]]) : subdir match
  res.hdr_dom([&lt;name&gt;[,&lt;occ&gt;]]) : domain match
  res.hdr_end([&lt;name&gt;[,&lt;occ&gt;]]) : suffix match
  res.hdr_len([&lt;name&gt;[,&lt;occ&gt;]]) : length match
  res.hdr_reg([&lt;name&gt;[,&lt;occ&gt;]]) : regex match
  res.hdr_sub([&lt;name&gt;[,&lt;occ&gt;]]) : substring match
</pre><a class="anchor" name="res.hdr_cnt"></a><a class="anchor" name="7-res.hdr_cnt"></a><a class="anchor" name="7.3.6-res.hdr_cnt"></a><a class="anchor" name="res.hdr_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="res.hdr_cnt (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.hdr_cnt"></a><a href="#7.3.6-res.hdr_cnt">res.hdr_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : integer</div><a class="anchor" name="shdr_cnt"></a><a class="anchor" name="7-shdr_cnt"></a><a class="anchor" name="7.3.6-shdr_cnt"></a><a class="anchor" name="shdr_cnt (Using ACLs and fetching samples)"></a><a class="anchor" name="shdr_cnt (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="shdr_cnt"></a><a href="#7.3.6-shdr_cnt">shdr_cnt</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : integer <span class="label label-warning">(deprecated)</span></div><pre class="text">This fetch works like the req.hdr_cnt() fetch with the difference that it
acts on the headers within an HTTP response.

Like req.hdr_cnt() the res.hdr_cnt() fetch considers the comma to be a
delimiter. If this is not desired res.fhdr_cnt() should be used.

It may be used in tcp-check based expect rules.
</pre><a class="anchor" name="res.hdr_ip"></a><a class="anchor" name="7-res.hdr_ip"></a><a class="anchor" name="7.3.6-res.hdr_ip"></a><a class="anchor" name="res.hdr_ip (Using ACLs and fetching samples)"></a><a class="anchor" name="res.hdr_ip (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.hdr_ip"></a><a href="#7.3.6-res.hdr_ip">res.hdr_ip</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>]</span>) : ip</div><a class="anchor" name="shdr_ip"></a><a class="anchor" name="7-shdr_ip"></a><a class="anchor" name="7.3.6-shdr_ip"></a><a class="anchor" name="shdr_ip (Using ACLs and fetching samples)"></a><a class="anchor" name="shdr_ip (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="shdr_ip"></a><a href="#7.3.6-shdr_ip">shdr_ip</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>]</span>) : ip <span class="label label-warning">(deprecated)</span></div><pre class="text">This fetch works like the req.hdr_ip() fetch with the difference that it
acts on the headers within an HTTP response.

This can be useful to learn some data into a stick table.

It may be used in tcp-check based expect rules.
</pre><a class="anchor" name="res.hdr_names"></a><a class="anchor" name="7-res.hdr_names"></a><a class="anchor" name="7.3.6-res.hdr_names"></a><a class="anchor" name="res.hdr_names (Using ACLs and fetching samples)"></a><a class="anchor" name="res.hdr_names (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.hdr_names"></a><a href="#7.3.6-res.hdr_names">res.hdr_names</a></b>(<span style="color: #008">[<span style="color: #080">&lt;delim&gt;</span>]</span>) : string</div><pre class="text">This builds a string made from the concatenation of all header names as they
appear in the response when the rule is evaluated. The default delimiter is
the comma (',') but it may be overridden as an optional argument &lt;delim&gt;. In
this case, only the first character of &lt;delim&gt; is considered.

It may be used in tcp-check based expect rules.
</pre><a class="anchor" name="res.hdr_val"></a><a class="anchor" name="7-res.hdr_val"></a><a class="anchor" name="7.3.6-res.hdr_val"></a><a class="anchor" name="res.hdr_val (Using ACLs and fetching samples)"></a><a class="anchor" name="res.hdr_val (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.hdr_val"></a><a href="#7.3.6-res.hdr_val">res.hdr_val</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>]</span>) : integer</div><a class="anchor" name="shdr_val"></a><a class="anchor" name="7-shdr_val"></a><a class="anchor" name="7.3.6-shdr_val"></a><a class="anchor" name="shdr_val (Using ACLs and fetching samples)"></a><a class="anchor" name="shdr_val (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="shdr_val"></a><a href="#7.3.6-shdr_val">shdr_val</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;occ&gt;</span>]</span>]</span>) : integer <span class="label label-warning">(deprecated)</span></div><pre class="text">This fetch works like the req.hdr_val() fetch with the difference that it
acts on the headers within an HTTP response.

This can be useful to learn some data into a stick table.

It may be used in tcp-check based expect rules.
</pre><a class="anchor" name="res.hdrs"></a><a class="anchor" name="7-res.hdrs"></a><a class="anchor" name="7.3.6-res.hdrs"></a><a class="anchor" name="res.hdrs (Using ACLs and fetching samples)"></a><a class="anchor" name="res.hdrs (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.hdrs"></a><a href="#7.3.6-res.hdrs">res.hdrs</a></b> : string</div><pre class="text">Returns the current response headers as string including the last empty line
separating headers from the request body. The last empty line can be used to
detect a truncated header block. This sample fetch is useful for some SPOE
headers analyzers and for advanced logging.

It may also be used in tcp-check based expect rules.
</pre><a class="anchor" name="res.hdrs_bin"></a><a class="anchor" name="7-res.hdrs_bin"></a><a class="anchor" name="7.3.6-res.hdrs_bin"></a><a class="anchor" name="res.hdrs_bin (Using ACLs and fetching samples)"></a><a class="anchor" name="res.hdrs_bin (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.hdrs_bin"></a><a href="#7.3.6-res.hdrs_bin">res.hdrs_bin</a></b> : binary</div><pre class="text">Returns the current response headers contained in preparsed binary form. This
is useful for offloading some processing with SPOE. It may be used in
tcp-check based expect rules. Each string is described by a length followed
by the number of bytes indicated in the length. The length is represented
using the variable integer encoding detailed in the SPOE documentation. The
end of the list is marked by a couple of empty header names and values
(length of 0 for both).

*(&lt;str:header-name&gt;&lt;str:header-value&gt;)&lt;empty string&gt;&lt;empty string&gt;

int:  refer to the SPOE documentation for the encoding
str:  &lt;int:length&gt;&lt;bytes&gt;
</pre><a class="anchor" name="res.ver"></a><a class="anchor" name="7-res.ver"></a><a class="anchor" name="7.3.6-res.ver"></a><a class="anchor" name="res.ver (Using ACLs and fetching samples)"></a><a class="anchor" name="res.ver (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="res.ver"></a><a href="#7.3.6-res.ver">res.ver</a></b> : string</div><a class="anchor" name="resp_ver"></a><a class="anchor" name="7-resp_ver"></a><a class="anchor" name="7.3.6-resp_ver"></a><a class="anchor" name="resp_ver (Using ACLs and fetching samples)"></a><a class="anchor" name="resp_ver (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="resp_ver"></a><a href="#7.3.6-resp_ver">resp_ver</a></b> : string <span class="label label-warning">(deprecated)</span></div><pre class="text">Returns the version string from the HTTP response, for example &quot;1.1&quot;. This
can be useful for logs, but is mostly there for ACL.

It may be used in tcp-check based expect rules.

ACL derivatives :
  resp.ver : exact string match
</pre><a class="anchor" name="server_status"></a><a class="anchor" name="7-server_status"></a><a class="anchor" name="7.3.6-server_status"></a><a class="anchor" name="server_status (Using ACLs and fetching samples)"></a><a class="anchor" name="server_status (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="server_status"></a><a href="#7.3.6-server_status">server_status</a></b> : integer</div><pre class="text">Return an integer containing the HTTP status code as received from the
server. If no response was received from the server, the sample fetch fails.
</pre><a class="anchor" name="set-cookie"></a><a class="anchor" name="7-set-cookie"></a><a class="anchor" name="7.3.6-set-cookie"></a><a class="anchor" name="set-cookie (Using ACLs and fetching samples)"></a><a class="anchor" name="set-cookie (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="set-cookie"></a><a href="#7.3.6-set-cookie">set-cookie</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span>]</span>) : string <span class="label label-warning">(deprecated)</span></div><pre class="text">This extracts the last occurrence of the cookie name &lt;name&gt; on a &quot;Set-Cookie&quot;
header line from the response and uses the corresponding value to match. This
can be comparable to what &quot;appsession&quot; did with default options, but with
support for multi-peer synchronization and state keeping across restarts.

This fetch function is deprecated and has been superseded by the &quot;<a href="#res.cook">res.cook</a>&quot;
fetch. This keyword will disappear soon.
</pre><a class="anchor" name="status"></a><a class="anchor" name="7-status"></a><a class="anchor" name="7.3.6-status"></a><a class="anchor" name="status (Using ACLs and fetching samples)"></a><a class="anchor" name="status (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="status"></a><a href="#7.3.6-status">status</a></b> : integer</div><pre class="text">Returns an integer containing the HTTP status code in the HTTP response, for
example, 302. It is mostly used within ACLs and integer ranges, for example,
to remove any Location header if the response is not a 3xx. It will be the
status code received by the client if it is not changed, via a 'set-status'
action for instance.

It may be used in tcp-check based expect rules.
</pre><a class="anchor" name="txn.status"></a><a class="anchor" name="7-txn.status"></a><a class="anchor" name="7.3.6-txn.status"></a><a class="anchor" name="txn.status (Using ACLs and fetching samples)"></a><a class="anchor" name="txn.status (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="txn.status"></a><a href="#7.3.6-txn.status">txn.status</a></b> : integer</div><pre class="text">Return an integer containing the HTTP status code of the transaction, as
reported in the log.
</pre><a class="anchor" name="txn.timer.total"></a><a class="anchor" name="7-txn.timer.total"></a><a class="anchor" name="7.3.6-txn.timer.total"></a><a class="anchor" name="txn.timer.total (Using ACLs and fetching samples)"></a><a class="anchor" name="txn.timer.total (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="txn.timer.total"></a><a href="#7.3.6-txn.timer.total">txn.timer.total</a></b> : integer</div><pre class="text">Total active time for the HTTP request, between the moment the proxy received
the first byte of the request header and the emission of the last byte of the
response body. This is the equivalent of %Ta in the log-format and is
reported in milliseconds (ms).  For more information see Section 8.4 &quot;Timing
events&quot;
</pre><a class="anchor" name="unique-id"></a><a class="anchor" name="7-unique-id"></a><a class="anchor" name="7.3.6-unique-id"></a><a class="anchor" name="unique-id (Using ACLs and fetching samples)"></a><a class="anchor" name="unique-id (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="unique-id"></a><a href="#7.3.6-unique-id">unique-id</a></b> : string</div><pre class="text">Returns the unique-id attached to the request. The directive
&quot;<a href="#unique-id-format">unique-id-format</a>&quot; must be set. If it is not set, the unique-id sample fetch
fails. Note that the unique-id is usually used with HTTP requests, however this
sample fetch can be used with other protocols. Obviously, if it is used with
other protocols than HTTP, the unique-id-format directive must not contain
HTTP parts. See: unique-id-format and unique-id-header
</pre><a class="anchor" name="url"></a><a class="anchor" name="7-url"></a><a class="anchor" name="7.3.6-url"></a><a class="anchor" name="url (Using ACLs and fetching samples)"></a><a class="anchor" name="url (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="url"></a><a href="#7.3.6-url">url</a></b> : string</div><pre class="text">This extracts the request's URL as presented in the request. A typical use is
with prefetch-capable caches, and with portals which need to aggregate
multiple information from databases and keep them in caches. With ACLs, using
&quot;<a href="#path">path</a>&quot; is preferred over using &quot;<a href="#url">url</a>&quot;, because clients may send a full URL as
is normally done with proxies. The only real use is to match &quot;*&quot; which does
not match in &quot;<a href="#path">path</a>&quot;, and for which there is already a predefined ACL. See
also &quot;<a href="#path">path</a>&quot; and &quot;<a href="#base">base</a>&quot;. Please note that any fragment reference in the URI
('#' after the path) is strictly forbidden by the HTTP standard and will be
rejected. However, if the frontend receiving the request has &quot;option
accept-unsafe-violations-in-http-request&quot;, then this fragment part will be
accepted and will also appear in the url.

ACL derivatives :
  url     : exact string match
  url_beg : prefix match
  url_dir : subdir match
  url_dom : domain match
  url_end : suffix match
  url_len : length match
  url_reg : regex match
  url_sub : substring match
</pre><a class="anchor" name="url_ip"></a><a class="anchor" name="7-url_ip"></a><a class="anchor" name="7.3.6-url_ip"></a><a class="anchor" name="url_ip (Using ACLs and fetching samples)"></a><a class="anchor" name="url_ip (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="url_ip"></a><a href="#7.3.6-url_ip">url_ip</a></b> : ip</div><pre class="text">This extracts the IP address from the request's URL when the host part is
presented as an IP address. Its use is very limited. For instance, a
monitoring system might use this field as an alternative for the source IP in
order to test what path a given source address would follow, or to force an
entry in a table for a given source address. It may be used in combination
with 'http-request set-dst' to emulate the older 'option http_proxy'.
</pre><a class="anchor" name="url_port"></a><a class="anchor" name="7-url_port"></a><a class="anchor" name="7.3.6-url_port"></a><a class="anchor" name="url_port (Using ACLs and fetching samples)"></a><a class="anchor" name="url_port (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="url_port"></a><a href="#7.3.6-url_port">url_port</a></b> : integer</div><pre class="text">This extracts the port part from the request's URL. Note that if the port is
not specified in the request, port 80 is assumed..
</pre><a class="anchor" name="urlp"></a><a class="anchor" name="7-urlp"></a><a class="anchor" name="7.3.6-urlp"></a><a class="anchor" name="urlp (Using ACLs and fetching samples)"></a><a class="anchor" name="urlp (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="urlp"></a><a href="#7.3.6-urlp">urlp</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;delim&gt;</span><span style="color: #008">[,i]</span>]</span>]</span>) : string</div><a class="anchor" name="url_param"></a><a class="anchor" name="7-url_param"></a><a class="anchor" name="7.3.6-url_param"></a><a class="anchor" name="url_param (Using ACLs and fetching samples)"></a><a class="anchor" name="url_param (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="url_param"></a><a href="#7.3.6-url_param">url_param</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;delim&gt;</span><span style="color: #008">[,i]</span>]</span>]</span>) : string</div><pre class="text">This extracts the first occurrence of the parameter &lt;name&gt; in the query
string, which begins after either '?' or &lt;delim&gt;, and which ends before '&amp;',
';' or &lt;delim&gt;. The parameter name is case-sensitive, unless&quot;i&quot; is added as a
third argument. If no name is given, any parameter will match, and the first
one will be returned. The result is a string corresponding to the value of the
parameter &lt;name&gt; as presented in the request (no URL decoding is performed).
This can be used for session stickiness based on a client ID, to extract an
application cookie passed as a URL parameter, or in ACLs to apply some checks.
Note that the ACL version of this fetch iterates over multiple parameters and
will iteratively report all parameters values if no name is given

ACL derivatives :
  urlp(&lt;name&gt;[,&lt;delim&gt;])     : exact string match
  urlp_beg(&lt;name&gt;[,&lt;delim&gt;]) : prefix match
  urlp_dir(&lt;name&gt;[,&lt;delim&gt;]) : subdir match
  urlp_dom(&lt;name&gt;[,&lt;delim&gt;]) : domain match
  urlp_end(&lt;name&gt;[,&lt;delim&gt;]) : suffix match
  urlp_len(&lt;name&gt;[,&lt;delim&gt;]) : length match
  urlp_reg(&lt;name&gt;[,&lt;delim&gt;]) : regex match
  urlp_sub(&lt;name&gt;[,&lt;delim&gt;]) : substring match
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># match http://example.com/foo?PHPSESSIONID=some_id</span>
stick on urlp(PHPSESSIONID)
<span class="comment"># match http://example.com/foo;JSESSIONID=some_id</span>
stick on urlp(JSESSIONID,;)
</code></pre>
</div><a class="anchor" name="urlp_val"></a><a class="anchor" name="7-urlp_val"></a><a class="anchor" name="7.3.6-urlp_val"></a><a class="anchor" name="urlp_val (Using ACLs and fetching samples)"></a><a class="anchor" name="urlp_val (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="urlp_val"></a><a href="#7.3.6-urlp_val">urlp_val</a></b>(<span style="color: #008">[<span style="color: #080">&lt;name&gt;</span><span style="color: #008">[,<span style="color: #080">&lt;delim&gt;</span><span style="color: #008">[,i]</span>]</span>]</span>) : integer</div><pre class="text">See &quot;<a href="#urlp">urlp</a>&quot; above. This one extracts the URL parameter &lt;name&gt; in the request
and converts it to an integer value. This can be used for session stickiness
based on a user ID for example, or with ACLs to match a page number or price.
</pre><a class="anchor" name="url32"></a><a class="anchor" name="7-url32"></a><a class="anchor" name="7.3.6-url32"></a><a class="anchor" name="url32 (Using ACLs and fetching samples)"></a><a class="anchor" name="url32 (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="url32"></a><a href="#7.3.6-url32">url32</a></b> : integer</div><pre class="text">This returns a 32-bit hash of the value obtained by concatenating the first
Host header and the whole URL including parameters (not only the path part of
the request, as in the &quot;<a href="#base32">base32</a>&quot; fetch above). This is useful to track per-URL
activity. A shorter hash is stored, saving a lot of memory. The output type
is an unsigned integer.
</pre><a class="anchor" name="url32+src"></a><a class="anchor" name="7-url32+src"></a><a class="anchor" name="7.3.6-url32+src"></a><a class="anchor" name="url32+src (Using ACLs and fetching samples)"></a><a class="anchor" name="url32+src (Fetching HTTP samples (Layer 7))"></a><div class="keyword"><b><a class="anchor" name="url32+src"></a><a href="#7.3.6-url32%2Bsrc">url32+src</a></b> : binary</div><pre class="text">This returns the concatenation of the &quot;<a href="#url32">url32</a>&quot; fetch and the &quot;<a href="#src">src</a>&quot; fetch. The
resulting type is of type binary, with a size of 8 or 20 bytes depending on
the source address family. This can be used to track per-IP, per-URL counters.
</pre></div>
<a class="anchor" id="7.3.7" name="7.3.7"></a>
<h3 id="chapter-7.3.7" data-target="7.3.7"><small><a class="small" href="#7.3.7">7.3.7.</a></small> Fetching samples for developers</h3>
<div><pre class="text">This set of sample fetch methods is reserved to developers and must never be
used on a production environment, except on developer demand, for debugging
purposes. Moreover, no special care will be taken on backwards compatibility.
There is no warranty the following sample fetches will never change, be renamed
or simply removed. So be really careful if you should use one of them. To avoid
any ambiguity, these sample fetches are placed in the dedicated scope &quot;internal&quot;,
for instance &quot;<a href="#internal.strm.is_htx">internal.strm.is_htx</a>&quot;.

Summary of sample fetch methods in this section and their respective types:
</pre><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>keyword</th><th>output type</th></tr></thead>
<tr><td ><a href="#7-internal.htx.data">internal.htx.data</a></td><td >integer</td></tr>
<tr><td ><a href="#7-internal.htx.free">internal.htx.free</a></td><td >integer</td></tr>
<tr><td ><a href="#7-internal.htx.free_data">internal.htx.free_data</a></td><td >integer</td></tr>
<tr><td ><a href="#7-internal.htx.has_eom">internal.htx.has_eom</a></td><td >boolean</td></tr>
<tr><td ><a href="#7-internal.htx.nbblks">internal.htx.nbblks</a></td><td >integer</td></tr>
<tr><td ><a href="#7-internal.htx.size">internal.htx.size</a></td><td >integer</td></tr>
<tr><td ><a href="#7-internal.htx.used">internal.htx.used</a></td><td >integer</td></tr>
<tr><td ><a href="#7-internal.htx_blk.size">internal.htx_blk.size(&lt;idx&gt;)</a></td><td >integer</td></tr>
<tr><td ><a href="#7-internal.htx_blk.type">internal.htx_blk.type(&lt;idx&gt;)</a></td><td >string</td></tr>
<tr><td ><a href="#7-internal.htx_blk.data">internal.htx_blk.data(&lt;idx&gt;)</a></td><td >binary</td></tr>
<tr><td ><a href="#7-internal.htx_blk.hdrname">internal.htx_blk.hdrname(&lt;idx&gt;)</a></td><td >string</td></tr>
<tr><td ><a href="#7-internal.htx_blk.hdrval">internal.htx_blk.hdrval(&lt;idx&gt;)</a></td><td >string</td></tr>
<tr><td ><a href="#7-internal.htx_blk.start_line">internal.htx_blk.start_line(&lt;idx&gt;)</a></td><td >string</td></tr>
<tr><td ><a href="#7-internal.strm.is_htx">internal.strm.is_htx</a></td><td >boolean</td></tr>
</table><pre class="text">Detailed list:
</pre><a class="anchor" name="internal.htx.data"></a><a class="anchor" name="7-internal.htx.data"></a><a class="anchor" name="7.3.7-internal.htx.data"></a><a class="anchor" name="internal.htx.data (Using ACLs and fetching samples)"></a><a class="anchor" name="internal.htx.data (Fetching samples for developers)"></a><div class="keyword"><b><a class="anchor" name="internal.htx.data"></a><a href="#7.3.7-internal.htx.data">internal.htx.data</a></b> : integer</div><pre class="text">Returns the size in bytes used by data in the HTX message associated to a
channel. The channel is chosen depending on the sample direction.
</pre><a class="anchor" name="internal.htx.free"></a><a class="anchor" name="7-internal.htx.free"></a><a class="anchor" name="7.3.7-internal.htx.free"></a><a class="anchor" name="internal.htx.free (Using ACLs and fetching samples)"></a><a class="anchor" name="internal.htx.free (Fetching samples for developers)"></a><div class="keyword"><b><a class="anchor" name="internal.htx.free"></a><a href="#7.3.7-internal.htx.free">internal.htx.free</a></b> : integer</div><pre class="text">Returns the free space (size - used) in bytes in the HTX message associated
to a channel. The channel is chosen depending on the sample direction.
</pre><a class="anchor" name="internal.htx.free_data"></a><a class="anchor" name="7-internal.htx.free_data"></a><a class="anchor" name="7.3.7-internal.htx.free_data"></a><a class="anchor" name="internal.htx.free_data (Using ACLs and fetching samples)"></a><a class="anchor" name="internal.htx.free_data (Fetching samples for developers)"></a><div class="keyword"><b><a class="anchor" name="internal.htx.free_data"></a><a href="#7.3.7-internal.htx.free_data">internal.htx.free_data</a></b> : integer</div><pre class="text">Returns the free space for the data in bytes in the HTX message associated to
a channel. The channel is chosen depending on the sample direction.
</pre><a class="anchor" name="internal.htx.has_eom"></a><a class="anchor" name="7-internal.htx.has_eom"></a><a class="anchor" name="7.3.7-internal.htx.has_eom"></a><a class="anchor" name="internal.htx.has_eom (Using ACLs and fetching samples)"></a><a class="anchor" name="internal.htx.has_eom (Fetching samples for developers)"></a><div class="keyword"><b><a class="anchor" name="internal.htx.has_eom"></a><a href="#7.3.7-internal.htx.has_eom">internal.htx.has_eom</a></b> : boolean</div><pre class="text">Returns true if the HTX message associated to a channel contains the
end-of-message flag (EOM). Otherwise, it returns false. The channel is chosen
depending on the sample direction.
</pre><a class="anchor" name="internal.htx.nbblks"></a><a class="anchor" name="7-internal.htx.nbblks"></a><a class="anchor" name="7.3.7-internal.htx.nbblks"></a><a class="anchor" name="internal.htx.nbblks (Using ACLs and fetching samples)"></a><a class="anchor" name="internal.htx.nbblks (Fetching samples for developers)"></a><div class="keyword"><b><a class="anchor" name="internal.htx.nbblks"></a><a href="#7.3.7-internal.htx.nbblks">internal.htx.nbblks</a></b> : integer</div><pre class="text">Returns the number of blocks present in the HTX message associated to a
channel. The channel is chosen depending on the sample direction.
</pre><a class="anchor" name="internal.htx.size"></a><a class="anchor" name="7-internal.htx.size"></a><a class="anchor" name="7.3.7-internal.htx.size"></a><a class="anchor" name="internal.htx.size (Using ACLs and fetching samples)"></a><a class="anchor" name="internal.htx.size (Fetching samples for developers)"></a><div class="keyword"><b><a class="anchor" name="internal.htx.size"></a><a href="#7.3.7-internal.htx.size">internal.htx.size</a></b> : integer</div><pre class="text">Returns the total size in bytes of the HTX message associated to a
channel. The channel is chosen depending on the sample direction.
</pre><a class="anchor" name="internal.htx.used"></a><a class="anchor" name="7-internal.htx.used"></a><a class="anchor" name="7.3.7-internal.htx.used"></a><a class="anchor" name="internal.htx.used (Using ACLs and fetching samples)"></a><a class="anchor" name="internal.htx.used (Fetching samples for developers)"></a><div class="keyword"><b><a class="anchor" name="internal.htx.used"></a><a href="#7.3.7-internal.htx.used">internal.htx.used</a></b> : integer</div><pre class="text">Returns the total size used in bytes (data + metadata) in the HTX message
associated to a channel. The channel is chosen depending on the sample
direction.
</pre><a class="anchor" name="internal.htx_blk.size"></a><a class="anchor" name="7-internal.htx_blk.size"></a><a class="anchor" name="7.3.7-internal.htx_blk.size"></a><a class="anchor" name="internal.htx_blk.size (Using ACLs and fetching samples)"></a><a class="anchor" name="internal.htx_blk.size (Fetching samples for developers)"></a><div class="keyword"><b><a class="anchor" name="internal.htx_blk.size"></a><a href="#7.3.7-internal.htx_blk.size">internal.htx_blk.size</a></b>(<span style="color: #080">&lt;idx&gt;</span>) : integer</div><pre class="text">Returns the size of the block at the position &lt;idx&gt; in the HTX message
associated to a channel or 0 if it does not exist. The channel is chosen
depending on the sample direction. &lt;idx&gt; may be any positive integer or one
of the special value :
  * head  : The oldest inserted block
  * tail  : The newest inserted block
  * first : The first block where to (re)start the analysis
</pre><a class="anchor" name="internal.htx_blk.type"></a><a class="anchor" name="7-internal.htx_blk.type"></a><a class="anchor" name="7.3.7-internal.htx_blk.type"></a><a class="anchor" name="internal.htx_blk.type (Using ACLs and fetching samples)"></a><a class="anchor" name="internal.htx_blk.type (Fetching samples for developers)"></a><div class="keyword"><b><a class="anchor" name="internal.htx_blk.type"></a><a href="#7.3.7-internal.htx_blk.type">internal.htx_blk.type</a></b>(<span style="color: #080">&lt;idx&gt;</span>) : string</div><pre class="text">Returns the type of the block at the position &lt;idx&gt; in the HTX message
associated to a channel or &quot;HTX_BLK_UNUSED&quot; if it does not exist. The channel
is chosen depending on the sample direction. &lt;idx&gt; may be any positive
integer or one of the special value :
  * head  : The oldest inserted block
  * tail  : The newest inserted block
  * first : The first block where to (re)start the analysis
</pre><a class="anchor" name="internal.htx_blk.data"></a><a class="anchor" name="7-internal.htx_blk.data"></a><a class="anchor" name="7.3.7-internal.htx_blk.data"></a><a class="anchor" name="internal.htx_blk.data (Using ACLs and fetching samples)"></a><a class="anchor" name="internal.htx_blk.data (Fetching samples for developers)"></a><div class="keyword"><b><a class="anchor" name="internal.htx_blk.data"></a><a href="#7.3.7-internal.htx_blk.data">internal.htx_blk.data</a></b>(<span style="color: #080">&lt;idx&gt;</span>) : binary</div><pre class="text">Returns the value of the DATA block at the position &lt;idx&gt; in the HTX message
associated to a channel or an empty string if it does not exist or if it is
not a DATA block. The channel is chosen depending on the sample direction.
&lt;idx&gt; may be any positive integer or one of the special value :

  * head  : The oldest inserted block
  * tail  : The newest inserted block
  * first : The first block where to (re)start the analysis
</pre><a class="anchor" name="internal.htx_blk.hdrname"></a><a class="anchor" name="7-internal.htx_blk.hdrname"></a><a class="anchor" name="7.3.7-internal.htx_blk.hdrname"></a><a class="anchor" name="internal.htx_blk.hdrname (Using ACLs and fetching samples)"></a><a class="anchor" name="internal.htx_blk.hdrname (Fetching samples for developers)"></a><div class="keyword"><b><a class="anchor" name="internal.htx_blk.hdrname"></a><a href="#7.3.7-internal.htx_blk.hdrname">internal.htx_blk.hdrname</a></b>(<span style="color: #080">&lt;idx&gt;</span>) : string</div><pre class="text">Returns the header name of the HEADER block at the position &lt;idx&gt; in the HTX
message associated to a channel or an empty string if it does not exist or if
it is not an HEADER block. The channel is chosen depending on the sample
direction.  &lt;idx&gt; may be any positive integer or one of the special value :

  * head  : The oldest inserted block
  * tail  : The newest inserted block
  * first : The first block where to (re)start the analysis
</pre><a class="anchor" name="internal.htx_blk.hdrval"></a><a class="anchor" name="7-internal.htx_blk.hdrval"></a><a class="anchor" name="7.3.7-internal.htx_blk.hdrval"></a><a class="anchor" name="internal.htx_blk.hdrval (Using ACLs and fetching samples)"></a><a class="anchor" name="internal.htx_blk.hdrval (Fetching samples for developers)"></a><div class="keyword"><b><a class="anchor" name="internal.htx_blk.hdrval"></a><a href="#7.3.7-internal.htx_blk.hdrval">internal.htx_blk.hdrval</a></b>(<span style="color: #080">&lt;idx&gt;</span>) : string</div><pre class="text">Returns the header value of the HEADER block at the position &lt;idx&gt; in the HTX
message associated to a channel or an empty string if it does not exist or if
it is not an HEADER block. The channel is chosen depending on the sample
direction.  &lt;idx&gt; may be any positive integer or one of the special value :

  * head  : The oldest inserted block
  * tail  : The newest inserted block
  * first : The first block where to (re)start the analysis
</pre><a class="anchor" name="internal.htx_blk.start_line"></a><a class="anchor" name="7-internal.htx_blk.start_line"></a><a class="anchor" name="7.3.7-internal.htx_blk.start_line"></a><a class="anchor" name="internal.htx_blk.start_line (Using ACLs and fetching samples)"></a><a class="anchor" name="internal.htx_blk.start_line (Fetching samples for developers)"></a><div class="keyword"><b><a class="anchor" name="internal.htx_blk.start_line"></a><a href="#7.3.7-internal.htx_blk.start_line">internal.htx_blk.start_line</a></b>(<span style="color: #080">&lt;idx&gt;</span>) : string</div><pre class="text">Returns the value of the REQ_SL or RES_SL block at the position &lt;idx&gt; in the
HTX message associated to a channel or an empty string if it does not exist
or if it is not a SL block. The channel is chosen depending on the sample
direction.  &lt;idx&gt; may be any positive integer or one of the special value :

  * head  : The oldest inserted block
  * tail  : The newest inserted block
  * first : The first block where to (re)start the analysis
</pre><a class="anchor" name="internal.strm.is_htx"></a><a class="anchor" name="7-internal.strm.is_htx"></a><a class="anchor" name="7.3.7-internal.strm.is_htx"></a><a class="anchor" name="internal.strm.is_htx (Using ACLs and fetching samples)"></a><a class="anchor" name="internal.strm.is_htx (Fetching samples for developers)"></a><div class="keyword"><b><a class="anchor" name="internal.strm.is_htx"></a><a href="#7.3.7-internal.strm.is_htx">internal.strm.is_htx</a></b> : boolean</div><pre class="text">Returns true if the current stream is an HTX stream. It means the data in the
channels buffers are stored using the internal HTX representation. Otherwise,
it returns false.
</pre></div>
<a class="anchor" id="7.4" name="7.4"></a>
<h2 id="chapter-7.4" data-target="7.4"><small><a class="small" href="#7.4">7.4.</a></small> Pre-defined ACLs</h2>
<div><pre class="text">Some predefined ACLs are hard-coded so that they do not have to be declared in
every frontend which needs them. They all have their names in upper case in
order to avoid confusion. Their equivalence is provided below.
</pre><table class="table table-bordered" border="0" cellspacing="0" cellpadding="0">
<thead><tr><th>ACL name</th><th>Equivalent to                Usage</th><th></th></tr></thead>
<tr><td >FALSE</td><td >always_false</td><td >never match</td></tr>
<tr><td >HTTP</td><td >req.proto_http</td><td >match if request protocol is valid HTTP</td></tr>
<tr><td >HTTP_1.0</td><td >req.ver 1.0</td><td >match if HTTP request version is 1.0</td></tr>
<tr><td >HTTP_1.1</td><td >req.ver 1.1</td><td >match if HTTP request version is 1.1</td></tr>
<tr><td >HTTP_2.0</td><td >req.ver 2.0</td><td >match if HTTP request version is 2.0</td></tr>
<tr><td >HTTP_3.0</td><td >req.ver 3.0</td><td >match if HTTP request version is 3.0</td></tr>
<tr><td >HTTP_CONTENT</td><td >req.hdr_val(content-length) gt 0</td><td >match an existing content-length in the HTTP request</td></tr>
<tr><td >HTTP_URL_ABS</td><td >url_reg ^[^/:]*://</td><td >match absolute URL with scheme</td></tr>
<tr><td >HTTP_URL_SLASH</td><td >url_beg /</td><td >match URL beginning with &quot;/&quot;</td></tr>
<tr><td >HTTP_URL_STAR</td><td >url     *</td><td >match URL equal to &quot;*&quot;</td></tr>
<tr><td >LOCALHOST</td><td >src 127.0.0.1/8 ::1</td><td >match connection from local host</td></tr>
<tr><td >METH_CONNECT</td><td >method  CONNECT</td><td >match HTTP CONNECT method</td></tr>
<tr><td >METH_DELETE</td><td >method  DELETE</td><td >match HTTP DELETE method</td></tr>
<tr><td >METH_GET</td><td >method  GET HEAD</td><td >match HTTP GET or HEAD method</td></tr>
<tr><td >METH_HEAD</td><td >method  HEAD</td><td >match HTTP HEAD method</td></tr>
<tr><td >METH_OPTIONS</td><td >method  OPTIONS</td><td >match HTTP OPTIONS method</td></tr>
<tr><td >METH_POST</td><td >method  POST</td><td >match HTTP POST method</td></tr>
<tr><td >METH_PUT</td><td >method  PUT</td><td >match HTTP PUT method</td></tr>
<tr><td >METH_TRACE</td><td >method  TRACE</td><td >match HTTP TRACE method</td></tr>
<tr><td >RDP_COOKIE</td><td >req.rdp_cookie_cnt gt 0</td><td >match presence of an RDP cookie in the request buffer</td></tr>
<tr><td >REQ_CONTENT</td><td >req.len gt 0</td><td >match data in the request buffer</td></tr>
<tr><td >TRUE</td><td >always_true</td><td >always match</td></tr>
<tr><td >WAIT_END</td><td >wait_end</td><td >wait for end of content analysis</td></tr>
</table></div>
<a class="anchor" id="8" name="8"></a>
<div class="page-header"><h1 id="chapter-8" data-target="8"><small><a class="small" href="#8">8.</a></small> Logging</h1>
</div><div><pre class="text">One of HAProxy's strong points certainly lies is its precise logs. It probably
provides the finest level of information available for such a product, which is
very important for troubleshooting complex environments. Standard information
provided in logs include client ports, TCP/HTTP state timers, precise stream
state at termination and precise termination cause, information about decisions
to direct traffic to a server, and of course the ability to capture arbitrary
headers.

In order to improve administrators reactivity, it offers a great transparency
about encountered problems, both internal and external, and it is possible to
send logs to different sources at the same time with different level filters :

  - global process-level logs (system errors, start/stop, etc..)
  - per-instance system and internal errors (lack of resource, bugs, ...)
  - per-instance external troubles (servers up/down, max connections)
  - per-instance activity (client connections), either at the establishment or
    at the termination.
  - per-request control of log-level, e.g.
        http-request set-log-level silent if sensitive_request

The ability to distribute different levels of logs to different log servers
allow several production teams to interact and to fix their problems as soon
as possible. For example, the system team might monitor system-wide errors,
while the application team might be monitoring the up/down for their servers in
real time, and the security team might analyze the activity logs with one hour
delay.
</pre></div>
<a class="anchor" id="8.1" name="8.1"></a>
<h2 id="chapter-8.1" data-target="8.1"><small><a class="small" href="#8.1">8.1.</a></small> Log levels</h2>
<div><pre class="text">TCP and HTTP connections can be logged with information such as the date, time,
source IP address, destination address, connection duration, response times,
HTTP request, HTTP return code, number of bytes transmitted, conditions
in which the stream ended, and even exchanged cookies values. For example
track a particular user's problems. All messages may be sent to up to two
syslog servers. Check the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword in <a href="#4.2">section 4.2</a> for more information
about log facilities.
</pre></div>
<a class="anchor" id="8.2" name="8.2"></a>
<h2 id="chapter-8.2" data-target="8.2"><small><a class="small" href="#8.2">8.2.</a></small> Log formats</h2>
<div><pre class="text">HAProxy supports 5 log formats. Several fields are common between these formats
and will be detailed in the following sections. A few of them may vary
slightly with the configuration, due to indicators specific to certain
options. The supported formats are as follows :

  - the default format, which is very basic and very rarely used. It only
    provides very basic information about the incoming connection at the moment
    it is accepted : source IP:port, destination IP:port, and frontend-name.
    This mode will eventually disappear so it will not be described to great
    extents.

  - the TCP format, which is more advanced. This format is enabled when &quot;option
    tcplog&quot; is set on the frontend. HAProxy will then usually wait for the
    connection to terminate before logging. This format provides much richer
    information, such as timers, connection counts, queue size, etc... This
    format is recommended for pure TCP proxies.

  - the HTTP format, which is the most advanced for HTTP proxying. This format
    is enabled when &quot;<a href="#option%20httplog">option httplog</a>&quot; is set on the frontend. It provides the
    same information as the TCP format with some HTTP-specific fields such as
    the request, the status code, and captures of headers and cookies. This
    format is recommended for HTTP proxies.

  - the CLF HTTP format, which is equivalent to the HTTP format, but with the
    fields arranged in the same order as the CLF format. In this mode, all
    timers, captures, flags, etc... appear one per field after the end of the
    common fields, in the same order they appear in the standard HTTP format.

  - the custom log format, allows you to make your own log line.

Next sections will go deeper into details for each of these formats. Format
specification will be performed on a &quot;<a href="#field">field</a>&quot; basis. Unless stated otherwise, a
field is a portion of text delimited by any number of spaces. Since syslog
servers are susceptible of inserting fields at the beginning of a line, it is
always assumed that the first field is the one containing the process name and
identifier.

Note : Since log lines may be quite long, the log examples in sections below
       might be broken into multiple lines. The example log lines will be
       prefixed with 3 closing angle brackets ('&gt;&gt;&gt;') and each time a log is
       broken into multiple lines, each non-final line will end with a
       backslash ('\') and the next line will start indented by two characters.
</pre></div>
<a class="anchor" id="8.2.1" name="8.2.1"></a>
<h3 id="chapter-8.2.1" data-target="8.2.1"><small><a class="small" href="#8.2.1">8.2.1.</a></small> Default log format</h3>
<div><pre class="text">This format is used when no specific option is set. The log is emitted as soon
as the connection is accepted. One should note that this currently is the only
format which logs the request's destination IP and ports.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>    listen www
        mode http
        log global
        server srv1 127.0.0.1:8000

&gt;&gt;&gt; Feb  6 12:12:09 localhost \
      haproxy[14385]: Connect from 10.0.1.2:33312 to 10.0.3.31:8012 \
      (www/HTTP)
</code></pre>
</div><pre class="text">  Field   Format                                Extract from the example above
      1   process_name '[' pid ']:'                            haproxy[14385]:
      2   'Connect from'                                          Connect from
      3   source_ip ':' source_port                             10.0.1.2:33312
      4   'to'                                                              to
      5   destination_ip ':' destination_port                   10.0.3.31:8012
      6   '(' frontend_name '/' mode ')'                            (www/HTTP)

Detailed fields description :
  - &quot;source_ip&quot; is the IP address of the client which initiated the connection.
  - &quot;source_port&quot; is the TCP port of the client which initiated the connection.
  - &quot;destination_ip&quot; is the IP address the client connected to.
  - &quot;destination_port&quot; is the TCP port the client connected to.
  - &quot;frontend_name&quot; is the name of the frontend (or listener) which received
    and processed the connection.
  - &quot;mode is the mode the frontend is operating (TCP or HTTP).

In case of a UNIX socket, the source and destination addresses are marked as
&quot;unix:&quot; and the ports reflect the internal ID of the socket which accepted the
connection (the same ID as reported in the stats).

It is advised not to use this deprecated format for newer installations as it
will eventually disappear.
</pre></div>
<a class="anchor" id="8.2.2" name="8.2.2"></a>
<h3 id="chapter-8.2.2" data-target="8.2.2"><small><a class="small" href="#8.2.2">8.2.2.</a></small> TCP log format</h3>
<div><pre class="text">The TCP format is used when &quot;<a href="#option%20tcplog">option tcplog</a>&quot; is specified in the frontend, and
is the recommended format for pure TCP proxies. It provides a lot of precious
information for troubleshooting. Since this format includes timers and byte
counts, the log is normally emitted at the end of the session. It can be
emitted earlier if &quot;<a href="#option%20logasap">option logasap</a>&quot; is specified, which makes sense in most
environments with long sessions such as remote terminals. Sessions which match
the &quot;<a href="#monitor">monitor</a>&quot; rules are never logged. It is also possible not to emit logs for
sessions for which no data were exchanged between the client and the server, by
specifying &quot;<a href="#option%20dontlognull">option dontlognull</a>&quot; in the frontend. Successful connections will
not be logged if &quot;<a href="#option%20dontlog-normal">option dontlog-normal</a>&quot; is specified in the frontend.

The TCP log format is internally declared as a custom log format based on the
exact following string, which may also be used as a basis to extend the format
if required. Additionally the HAPROXY_TCP_LOG_FMT variable can be used instead.
Refer to <a href="#8.2.6">section 8.2.6</a> &quot;Custom log format&quot; to see how to use this:

    # strict equivalent of &quot;<a href="#option%20tcplog">option tcplog</a>&quot;
    log-format &quot;%ci:%cp [%t] %ft %b/%s %Tw/%Tc/%Tt %B %ts \
                %ac/%fc/%bc/%sc/%rc %sq/%bq&quot;
    # or using the HAPROXY_TCP_LOG_FMT variable
    log-format &quot;${HAPROXY_TCP_LOG_FMT}&quot;

And the CLF log format is internally declared as a custom log format based on
this exact string:

    # strict equivalent of &quot;option tcplog clf&quot;
    log-format &quot;%{Q}o %{-Q}ci - - [%T] \&quot;TCP \&quot; 000 %B \&quot;\&quot; \&quot;\&quot; %cp \
                %ms %ft %b %s %Th %Tw %Tc %Tt %U %ts-- %ac %fc %bc \
                %sc %rc %sq %bq \&quot;\&quot; \&quot;\&quot; &quot;

A few fields may slightly vary depending on some configuration options, those
are marked with a star ('*') after the field name below.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>    frontend fnt
        mode tcp
        option tcplog
        log global
        default_backend bck

    backend bck
        server srv1 127.0.0.1:8000

&gt;&gt;&gt; Feb  6 12:12:56 localhost \
      haproxy[14387]: 10.0.1.2:33313 [06/Feb/2009:12:12:51.443] fnt \
      bck/srv1 0/0/5007 212 -- 0/0/0/0/3 0/0
</code></pre>
</div><pre class="text">  Field   Format                                Extract from the example above
      1   process_name '[' pid ']:'                            haproxy[14387]:
      2   client_ip ':' client_port                             10.0.1.2:33313
      3   '[' accept_date ']'                       [06/Feb/2009:12:12:51.443]
      4   frontend_name                                                    fnt
      5   backend_name '/' server_name                                bck/srv1
      6   Tw '/' Tc '/' Tt*                                           0/0/5007
      7   bytes_read*                                                      212
      8   termination_state                                                 --
      9   actconn '/' feconn '/' beconn '/' srv_conn '/' retries*    0/0/0/0/3
     10   srv_queue '/' backend_queue                                      0/0

Detailed fields description :
  - &quot;client_ip&quot; is the IP address of the client which initiated the TCP
    connection to HAProxy. If the connection was accepted on a UNIX socket
    instead, the IP address would be replaced with the word &quot;unix&quot;. Note that
    when the connection is accepted on a socket configured with &quot;<a href="#accept-proxy">accept-proxy</a>&quot;
    and the PROXY protocol is correctly used, or with a &quot;<a href="#accept-netscaler-cip">accept-netscaler-cip</a>&quot;
    and the NetScaler Client IP insertion protocol is correctly used, then the
    logs will reflect the forwarded connection's information.

  - &quot;client_port&quot; is the TCP port of the client which initiated the connection.
    If the connection was accepted on a UNIX socket instead, the port would be
    replaced with the ID of the accepting socket, which is also reported in the
    stats interface.

  - &quot;<a href="#accept_date">accept_date</a>&quot; is the exact date when the connection was received by HAProxy
    (which might be very slightly different from the date observed on the
    network if there was some queuing in the system's backlog). This is usually
    the same date which may appear in any upstream firewall's log. When used in
    HTTP mode, the accept_date field will be reset to the first moment the
    connection is ready to receive a new request (end of previous response for
    HTTP/1, immediately after previous request for HTTP/2).

  - &quot;frontend_name&quot; is the name of the frontend (or listener) which received
    and processed the connection.

  - &quot;backend_name&quot; is the name of the backend (or listener) which was selected
    to manage the connection to the server. This will be the same as the
    frontend if no switching rule has been applied, which is common for TCP
    applications.

  - &quot;server_name&quot; is the name of the last server to which the connection was
    sent, which might differ from the first one if there were connection errors
    and a redispatch occurred. Note that this server belongs to the backend
    which processed the request. If the connection was aborted before reaching
    a server, &quot;&lt;NOSRV&gt;&quot; is indicated instead of a server name.

  - &quot;Tw&quot; is the total time in milliseconds spent waiting in the various queues.
    It can be &quot;-1&quot; if the connection was aborted before reaching the queue.
    See &quot;Timers&quot; below for more details.

  - &quot;Tc&quot; is the total time in milliseconds spent waiting for the connection to
    establish to the final server, including retries. It can be &quot;-1&quot; if the
    connection was aborted before a connection could be established. See
    &quot;Timers&quot; below for more details.

  - &quot;Tt&quot; is the total time in milliseconds elapsed between the accept and the
    last close. It covers all possible processing. There is one exception, if
    &quot;<a href="#option%20logasap">option logasap</a>&quot; was specified, then the time counting stops at the moment
    the log is emitted. In this case, a '+' sign is prepended before the value,
    indicating that the final one will be larger. See &quot;Timers&quot; below for more
    details.

  - &quot;bytes_read&quot; is the total number of bytes transmitted from the server to
    the client when the log is emitted. If &quot;<a href="#option%20logasap">option logasap</a>&quot; is specified, the
    this value will be prefixed with a '+' sign indicating that the final one
    may be larger. Please note that this value is a 64-bit counter, so log
    analysis tools must be able to handle it without overflowing.

  - &quot;termination_state&quot; is the condition the session was in when the session
    ended. This indicates the session state, which side caused the end of
    session to happen, and for what reason (timeout, error, ...). The normal
    flags should be &quot;--&quot;, indicating the session was closed by either end with
    no data remaining in buffers. See below &quot;Stream state at disconnection&quot;
    for more details.

  - &quot;actconn&quot; is the total number of concurrent connections on the process when
    the session was logged. It is useful to detect when some per-process system
    limits have been reached. For instance, if actconn is close to 512 when
    multiple connection errors occur, chances are high that the system limits
    the process to use a maximum of 1024 file descriptors and that all of them
    are used. See <a href="#3">section 3</a> &quot;Global parameters&quot; to find how to tune the system.

  - &quot;feconn&quot; is the total number of concurrent connections on the frontend when
    the session was logged. It is useful to estimate the amount of resource
    required to sustain high loads, and to detect when the frontend's &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
    has been reached. Most often when this value increases by huge jumps, it is
    because there is congestion on the backend servers, but sometimes it can be
    caused by a denial of service attack.

  - &quot;beconn&quot; is the total number of concurrent connections handled by the
    backend when the session was logged. It includes the total number of
    concurrent connections active on servers as well as the number of
    connections pending in queues. It is useful to estimate the amount of
    additional servers needed to support high loads for a given application.
    Most often when this value increases by huge jumps, it is because there is
    congestion on the backend servers, but sometimes it can be caused by a
    denial of service attack.

  - &quot;<a href="#srv_conn">srv_conn</a>&quot; is the total number of concurrent connections still active on
    the server when the session was logged. It can never exceed the server's
    configured &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; parameter. If this value is very often close or equal
    to the server's &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;, it means that traffic regulation is involved a
    lot, meaning that either the server's maxconn value is too low, or that
    there aren't enough servers to process the load with an optimal response
    time. When only one of the server's &quot;<a href="#srv_conn">srv_conn</a>&quot; is high, it usually means
    that this server has some trouble causing the connections to take longer to
    be processed than on other servers.

  - &quot;<a href="#retries">retries</a>&quot; is the number of connection retries experienced by this session
    when trying to connect to the server. It must normally be zero, unless a
    server is being stopped at the same moment the connection was attempted.
    Frequent retries generally indicate either a network problem between
    HAProxy and the server, or a misconfigured system backlog on the server
    preventing new connections from being queued. This field may optionally be
    prefixed with a '+' sign, indicating that the session has experienced a
    redispatch after the maximal retry count has been reached on the initial
    server. In this case, the server name appearing in the log is the one the
    connection was redispatched to, and not the first one, though both may
    sometimes be the same in case of hashing for instance. So as a general rule
    of thumb, when a '+' is present in front of the retry count, this count
    should not be attributed to the logged server.

  - &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">srv_queue<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#srv_queue%20%28Converters%29">Converters</a></li><li><a href="#srv_queue%20%28Fetching%20samples%20from%20internal%20states%29">Fetching samples from internal states</a></li></ul></span>&quot; is the total number of requests which were processed before
    this one in the server queue. It is zero when the request has not gone
    through the server queue. It makes it possible to estimate the approximate
    server's response time by dividing the time spent in queue by the number of
    requests in the queue. It is worth noting that if a session experiences a
    redispatch and passes through two server queues, their positions will be
    cumulative. A request should not pass through both the server queue and the
    backend queue unless a redispatch occurs.

  - &quot;backend_queue&quot; is the total number of requests which were processed before
    this one in the backend's global queue. It is zero when the request has not
    gone through the global queue. It makes it possible to estimate the average
    queue length, which easily translates into a number of missing servers when
    divided by a server's &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; parameter. It is worth noting that if a
    session experiences a redispatch, it may pass twice in the backend's queue,
    and then both positions will be cumulative. A request should not pass
    through both the server queue and the backend queue unless a redispatch
    occurs.
</pre></div>
<a class="anchor" id="8.2.3" name="8.2.3"></a>
<h3 id="chapter-8.2.3" data-target="8.2.3"><small><a class="small" href="#8.2.3">8.2.3.</a></small> HTTP log format</h3>
<div><pre class="text">The HTTP format is the most complete and the best suited for HTTP proxies. It
is enabled by when &quot;<a href="#option%20httplog">option httplog</a>&quot; is specified in the frontend. It provides
the same level of information as the TCP format with additional features which
are specific to the HTTP protocol. Just like the TCP format, the log is usually
emitted at the end of the stream, unless &quot;<a href="#option%20logasap">option logasap</a>&quot; is specified, which
generally only makes sense for download sites. A stream which matches the
&quot;<a href="#monitor">monitor</a>&quot; rules will never logged. It is also possible not to log streams for
which no data were sent by the client by specifying &quot;<a href="#option%20dontlognull">option dontlognull</a>&quot; in the
frontend. Successful connections will not be logged if &quot;<a href="#option%20dontlog-normal">option dontlog-normal</a>&quot;
is specified in the frontend.

The HTTP log format is internally declared as a custom log format based on the
exact following string, which may also be used as a basis to extend the format
if required. Additionally the HAPROXY_HTTP_LOG_FMT variable can be used
instead. Refer to <a href="#8.2.6">section 8.2.6</a> &quot;Custom log format&quot; to see how to use this:

    # strict equivalent of &quot;<a href="#option%20httplog">option httplog</a>&quot;
    log-format &quot;%ci:%cp [%tr] %ft %b/%s %TR/%Tw/%Tc/%Tr/%Ta %ST %B %CC \
                %CS %tsc %ac/%fc/%bc/%sc/%rc %sq/%bq %hr %hs %{+Q}r&quot;
    # or using the HAPROXY_HTTP_LOG_FMT variable
    log-format &quot;${HAPROXY_HTTP_LOG_FMT}&quot;

And the CLF log format is internally declared as a custom log format based on
this exact string:

    # strict equivalent of &quot;option httplog clf&quot;
    log-format &quot;%{+Q}o %{-Q}ci - - [%trg] %r %ST %B \&quot;\&quot; \&quot;\&quot; %cp \
                %ms %ft %b %s %TR %Tw %Tc %Tr %Ta %tsc %ac %fc \
                %bc %sc %rc %sq %bq %CC %CS %hrl %hsl&quot;

Most fields are shared with the TCP log, some being different. A few fields may
slightly vary depending on some configuration options. Those ones are marked
with a star ('*') after the field name below.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>    frontend http-in
        mode http
        option httplog
        log global
        default_backend bck

    backend static
        server srv1 127.0.0.1:8000

&gt;&gt;&gt; Feb  6 12:14:14 localhost \
      haproxy[14389]: 10.0.1.2:33317 [06/Feb/2009:12:14:14.655] http-in \
      static/srv1 10/0/30/69/109 200 2750 - - ---- 1/1/1/1/0 0/0 {1wt.eu} \
      {} &quot;GET /index.html HTTP/1.1&quot;
</code></pre>
</div><pre class="text">  Field   Format                                Extract from the example above
      1   process_name '[' pid ']:'                            haproxy[14389]:
      2   client_ip ':' client_port                             10.0.1.2:33317
      3   '[' request_date ']'                      [06/Feb/2009:12:14:14.655]
      4   frontend_name                                                http-in
      5   backend_name '/' server_name                             static/srv1
      6   TR '/' Tw '/' Tc '/' Tr '/' Ta*                       10/0/30/69/109
      7   status_code                                                      200
      8   bytes_read*                                                     2750
      9   captured_request_cookie                                            -
     10   captured_response_cookie                                           -
     11   termination_state                                               ----
     12   actconn '/' feconn '/' beconn '/' srv_conn '/' retries*    1/1/1/1/0
     13   srv_queue '/' backend_queue                                      0/0
     14   '{' captured_request_headers* '}'                   {haproxy.1wt.eu}
     15   '{' captured_response_headers* '}'                                {}
     16   '&quot;' http_request '&quot;'                      &quot;GET /index.html HTTP/1.1&quot;

Detailed fields description :
  - &quot;client_ip&quot; is the IP address of the client which initiated the TCP
    connection to HAProxy. If the connection was accepted on a UNIX socket
    instead, the IP address would be replaced with the word &quot;unix&quot;. Note that
    when the connection is accepted on a socket configured with &quot;<a href="#accept-proxy">accept-proxy</a>&quot;
    and the PROXY protocol is correctly used, or with a &quot;<a href="#accept-netscaler-cip">accept-netscaler-cip</a>&quot;
    and the NetScaler Client IP insertion protocol is correctly used, then the
    logs will reflect the forwarded connection's information.

  - &quot;client_port&quot; is the TCP port of the client which initiated the connection.
    If the connection was accepted on a UNIX socket instead, the port would be
    replaced with the ID of the accepting socket, which is also reported in the
    stats interface.

  - &quot;<a href="#request_date">request_date</a>&quot; is the exact date when the first byte of the HTTP request
    was received by HAProxy (log field %tr).

  - &quot;frontend_name&quot; is the name of the frontend (or listener) which received
    and processed the connection.

  - &quot;backend_name&quot; is the name of the backend (or listener) which was selected
    to manage the connection to the server. This will be the same as the
    frontend if no switching rule has been applied.

  - &quot;server_name&quot; is the name of the last server to which the connection was
    sent, which might differ from the first one if there were connection errors
    and a redispatch occurred. Note that this server belongs to the backend
    which processed the request. If the request was aborted before reaching a
    server, &quot;&lt;NOSRV&gt;&quot; is indicated instead of a server name. If the request was
    intercepted by the stats subsystem, &quot;&lt;STATS&gt;&quot; is indicated instead.

  - &quot;TR&quot; is the total time in milliseconds spent waiting for a full HTTP
    request from the client (not counting body) after the first byte was
    received. It can be &quot;-1&quot; if the connection was aborted before a complete
    request could be received or a bad request was received. It should
    always be very small because a request generally fits in one single packet.
    Large times here generally indicate network issues between the client and
    HAProxy or requests being typed by hand. See <a href="#8.4">section 8.4</a> &quot;Timing Events&quot;
    for more details.

  - &quot;Tw&quot; is the total time in milliseconds spent waiting in the various queues.
    It can be &quot;-1&quot; if the connection was aborted before reaching the queue.
    See <a href="#8.4">section 8.4</a> &quot;Timing Events&quot; for more details.

  - &quot;Tc&quot; is the total time in milliseconds spent waiting for the connection to
    establish to the final server, including retries. It can be &quot;-1&quot; if the
    request was aborted before a connection could be established. See section
    8.4 &quot;Timing Events&quot; for more details.

  - &quot;Tr&quot; is the total time in milliseconds spent waiting for the server to send
    a full HTTP response, not counting data. It can be &quot;-1&quot; if the request was
    aborted before a complete response could be received. It generally matches
    the server's processing time for the request, though it may be altered by
    the amount of data sent by the client to the server. Large times here on
    &quot;GET&quot; requests generally indicate an overloaded server. See <a href="#8.4">section 8.4</a>
    &quot;Timing Events&quot; for more details.

  - &quot;Ta&quot; is the time the request remained active in HAProxy, which is the total
    time in milliseconds elapsed between the first byte of the request was
    received and the last byte of response was sent. It covers all possible
    processing except the handshake (see Th) and idle time (see Ti). There is
    one exception, if &quot;<a href="#option%20logasap">option logasap</a>&quot; was specified, then the time counting
    stops at the moment the log is emitted. In this case, a '+' sign is
    prepended before the value, indicating that the final one will be larger.
    See <a href="#8.4">section 8.4</a> &quot;Timing Events&quot; for more details.

  - &quot;status_code&quot; is the HTTP status code returned to the client. This status
    is generally set by the server, but it might also be set by HAProxy when
    the server cannot be reached or when its response is blocked by HAProxy.

  - &quot;bytes_read&quot; is the total number of bytes transmitted to the client when
    the log is emitted. This does include HTTP headers. If &quot;<a href="#option%20logasap">option logasap</a>&quot; is
    specified, this value will be prefixed with a '+' sign indicating that
    the final one may be larger. Please note that this value is a 64-bit
    counter, so log analysis tools must be able to handle it without
    overflowing.

  - &quot;captured_request_cookie&quot; is an optional &quot;name=value&quot; entry indicating that
    the client had this cookie in the request. The cookie name and its maximum
    length are defined by the &quot;<a href="#capture%20cookie">capture cookie</a>&quot; statement in the frontend
    configuration. The field is a single dash ('-') when the option is not
    set. Only one cookie may be captured, it is generally used to track session
    ID exchanges between a client and a server to detect session crossing
    between clients due to application bugs. For more details, please consult
    the section &quot;Capturing HTTP headers and cookies&quot; below.

  - &quot;captured_response_cookie&quot; is an optional &quot;name=value&quot; entry indicating
    that the server has returned a cookie with its response. The cookie name
    and its maximum length are defined by the &quot;<a href="#capture%20cookie">capture cookie</a>&quot; statement in the
    frontend configuration. The field is a single dash ('-') when the option is
    not set. Only one cookie may be captured, it is generally used to track
    session ID exchanges between a client and a server to detect session
    crossing between clients due to application bugs. For more details, please
    consult the section &quot;Capturing HTTP headers and cookies&quot; below.

  - &quot;termination_state&quot; is the condition the stream was in when the stream
    ended. This indicates the stream state, which side caused the end of
    stream to happen, for what reason (timeout, error, ...), just like in TCP
    logs, and information about persistence operations on cookies in the last
    two characters. The normal flags should begin with &quot;--&quot;, indicating the
    stream was closed by either end with no data remaining in buffers. See
    below &quot;Stream state at disconnection&quot; for more details.

  - &quot;actconn&quot; is the total number of concurrent connections on the process when
    the stream was logged. It is useful to detect when some per-process system
    limits have been reached. For instance, if actconn is close to 512 or 1024
    when multiple connection errors occur, chances are high that the system
    limits the process to use a maximum of 1024 file descriptors and that all
    of them are used. See <a href="#3">section 3</a> &quot;Global parameters&quot; to find how to tune the
    system.

  - &quot;feconn&quot; is the total number of concurrent connections on the frontend when
    the stream was logged. It is useful to estimate the amount of resource
    required to sustain high loads, and to detect when the frontend's &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;
    has been reached. Most often when this value increases by huge jumps, it is
    because there is congestion on the backend servers, but sometimes it can be
    caused by a denial of service attack.

  - &quot;beconn&quot; is the total number of concurrent connections handled by the
    backend when the stream was logged. It includes the total number of
    concurrent connections active on servers as well as the number of
    connections pending in queues. It is useful to estimate the amount of
    additional servers needed to support high loads for a given application.
    Most often when this value increases by huge jumps, it is because there is
    congestion on the backend servers, but sometimes it can be caused by a
    denial of service attack.

  - &quot;<a href="#srv_conn">srv_conn</a>&quot; is the total number of concurrent connections still active on
    the server when the stream was logged. It can never exceed the server's
    configured &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; parameter. If this value is very often close or equal
    to the server's &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot;, it means that traffic regulation is involved a
    lot, meaning that either the server's maxconn value is too low, or that
    there aren't enough servers to process the load with an optimal response
    time. When only one of the server's &quot;<a href="#srv_conn">srv_conn</a>&quot; is high, it usually means
    that this server has some trouble causing the requests to take longer to be
    processed than on other servers.

  - &quot;<a href="#retries">retries</a>&quot; is the number of connection retries experienced by this stream
    when trying to connect to the server. It must normally be zero, unless a
    server is being stopped at the same moment the connection was attempted.
    Frequent retries generally indicate either a network problem between
    HAProxy and the server, or a misconfigured system backlog on the server
    preventing new connections from being queued. This field may optionally be
    prefixed with a '+' sign, indicating that the stream has experienced a
    redispatch after the maximal retry count has been reached on the initial
    server. In this case, the server name appearing in the log is the one the
    connection was redispatched to, and not the first one, though both may
    sometimes be the same in case of hashing for instance. So as a general rule
    of thumb, when a '+' is present in front of the retry count, this count
    should not be attributed to the logged server.

  - &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">srv_queue<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#srv_queue%20%28Converters%29">Converters</a></li><li><a href="#srv_queue%20%28Fetching%20samples%20from%20internal%20states%29">Fetching samples from internal states</a></li></ul></span>&quot; is the total number of requests which were processed before
    this one in the server queue. It is zero when the request has not gone
    through the server queue. It makes it possible to estimate the approximate
    server's response time by dividing the time spent in queue by the number of
    requests in the queue. It is worth noting that if a stream experiences a
    redispatch and passes through two server queues, their positions will be
    cumulative. A request should not pass through both the server queue and the
    backend queue unless a redispatch occurs.

  - &quot;backend_queue&quot; is the total number of requests which were processed before
    this one in the backend's global queue. It is zero when the request has not
    gone through the global queue. It makes it possible to estimate the average
    queue length, which easily translates into a number of missing servers when
    divided by a server's &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; parameter. It is worth noting that if a
    stream experiences a redispatch, it may pass twice in the backend's queue,
    and then both positions will be cumulative. A request should not pass
    through both the server queue and the backend queue unless a redispatch
    occurs.

  - &quot;captured_request_headers&quot; is a list of headers captured in the request due
    to the presence of the &quot;<a href="#capture%20request%20header">capture request header</a>&quot; statement in the frontend.
    Multiple headers can be captured, they will be delimited by a vertical bar
    ('|'). When no capture is enabled, the braces do not appear, causing a
    shift of remaining fields. It is important to note that this field may
    contain spaces, and that using it requires a smarter log parser than when
    it's not used. Please consult the section &quot;Capturing HTTP headers and
    cookies&quot; below for more details.

  - &quot;captured_response_headers&quot; is a list of headers captured in the response
    due to the presence of the &quot;<a href="#capture%20response%20header">capture response header</a>&quot; statement in the
    frontend. Multiple headers can be captured, they will be delimited by a
    vertical bar ('|'). When no capture is enabled, the braces do not appear,
    causing a shift of remaining fields. It is important to note that this
    field may contain spaces, and that using it requires a smarter log parser
    than when it's not used. Please consult the section &quot;Capturing HTTP headers
    and cookies&quot; below for more details.

  - &quot;http_request&quot; is the complete HTTP request line, including the method,
    request and HTTP version string. Non-printable characters are encoded (see
    below the section &quot;Non-printable characters&quot;). This is always the last
    field, and it is always delimited by quotes and is the only one which can
    contain quotes. If new fields are added to the log format, they will be
    added before this field. This field might be truncated if the request is
    huge and does not fit in the standard syslog buffer (1024 characters). This
    is the reason why this field must always remain the last one.
</pre></div>
<a class="anchor" id="8.2.4" name="8.2.4"></a>
<h3 id="chapter-8.2.4" data-target="8.2.4"><small><a class="small" href="#8.2.4">8.2.4.</a></small> HTTPS log format</h3>
<div><pre class="text">The HTTPS format is the best suited for HTTP over SSL connections. It is an
extension of the HTTP format (see <a href="#8.2.3">section 8.2.3</a>) to which SSL related
information are added. It is enabled when &quot;<a href="#option%20httpslog">option httpslog</a>&quot; is specified in the
frontend. Just like the TCP and HTTP formats, the log is usually emitted at the
end of the stream, unless &quot;<a href="#option%20logasap">option logasap</a>&quot; is specified. A stream which
matches the &quot;<a href="#monitor">monitor</a>&quot; rules will never logged. It is also possible not to log
streams for which no data were sent by the client by specifying &quot;option
dontlognull&quot; in the frontend. Successful connections will not be logged if
&quot;<a href="#option%20dontlog-normal">option dontlog-normal</a>&quot; is specified in the frontend.

The HTTPS log format is internally declared as a custom log format based on the
exact following string, which may also be used as a basis to extend the format
if required. Additionally the HAPROXY_HTTPS_LOG_FMT variable can be used
instead. Refer to <a href="#8.2.6">section 8.2.6</a> &quot;Custom log format&quot; to see how to use this:

    # strict equivalent of &quot;<a href="#option%20httpslog">option httpslog</a>&quot;
    log-format &quot;%ci:%cp [%tr] %ft %b/%s %TR/%Tw/%Tc/%Tr/%Ta %ST %B %CC \
               %CS %tsc %ac/%fc/%bc/%sc/%rc %sq/%bq %hr %hs %{+Q}r \
               %[fc_err]/%[ssl_fc_err,hex]/%[ssl_c_err]/\
               %[ssl_c_ca_err]/%[ssl_fc_is_resumed] %[ssl_fc_sni]/%sslv/%sslc&quot;
    # or using the HAPROXY_HTTPS_LOG_FMT variable
    log-format &quot;${HAPROXY_HTTPS_LOG_FMT}&quot;

This format is basically the HTTP one (see <a href="#8.2.3">section 8.2.3</a>) with new fields
appended to it. The new fields (lines 17 and 18) will be detailed here. For the
HTTP ones, refer to the HTTP section.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>    frontend https-in
        mode http
        option httpslog
        log global
        bind *:443 ssl crt mycerts/srv.pem ...
        default_backend bck

    backend static
        server srv1 127.0.0.1:8000 ssl crt mycerts/clt.pem ...

&gt;&gt;&gt; Feb  6 12:14:14 localhost \
      haproxy[14389]: 10.0.1.2:33317 [06/Feb/2009:12:14:14.655] https-in \
      static/srv1 10/0/30/69/109 200 2750 - - ---- 1/1/1/1/0 0/0 {1wt.eu} \
      {} &quot;GET /index.html HTTP/1.1&quot; 0/0/0/0/0 \
      1wt.eu/TLSv1.3/TLS_AES_256_GCM_SHA384
</code></pre>
</div><pre class="text">  Field   Format                                  Extract from the example above
      1   process_name '[' pid ']:'                              haproxy[14389]:
      2   client_ip ':' client_port                               10.0.1.2:33317
      3   '[' request_date ']'                        [06/Feb/2009:12:14:14.655]
      4   frontend_name                                                 https-in
      5   backend_name '/' server_name                               static/srv1
      6   TR '/' Tw '/' Tc '/' Tr '/' Ta*                         10/0/30/69/109
      7   status_code                                                        200
      8   bytes_read*                                                       2750
      9   captured_request_cookie                                              -
     10   captured_response_cookie                                             -
     11   termination_state                                                 ----
     12   actconn '/' feconn '/' beconn '/' srv_conn '/' retries*      1/1/1/1/0
     13   srv_queue '/' backend_queue                                        0/0
     14   '{' captured_request_headers* '}'                     {haproxy.1wt.eu}
     15   '{' captured_response_headers* '}'                                  {}
     16   '&quot;' http_request '&quot;'                        &quot;GET /index.html HTTP/1.1&quot;
     17   fc_err '/' ssl_fc_err '/' ssl_c_err
          '/' ssl_c_ca_err '/' ssl_fc_is_resumed                       0/0/0/0/0
     18   ssl_fc_sni '/' ssl_version
          '/' ssl_ciphers                  1wt.eu/TLSv1.3/TLS_AES_256_GCM_SHA384

Detailed fields description :
  - &quot;<a href="#fc_err">fc_err</a>&quot; is the status of the connection on the frontend's side. It
    corresponds to the &quot;<a href="#fc_err">fc_err</a>&quot; sample fetch. See the &quot;<a href="#fc_err">fc_err</a>&quot; and &quot;<a href="#fc_err_str">fc_err_str</a>&quot;
    sample fetch functions for more information.

  - &quot;<a href="#ssl_fc_err">ssl_fc_err</a>&quot; is the last error of the first SSL error stack that was
    raised on the connection from the frontend's perspective. It might be used
    to detect SSL handshake errors for instance. It will be 0 if everything
    went well. See the &quot;<a href="#ssl_fc_err">ssl_fc_err</a>&quot; sample fetch's description for more
    information.

  - &quot;<a href="#ssl_c_err">ssl_c_err</a>&quot; is the status of the client's certificate verification process.
    The handshake might be successful while having a non-null verification
    error code if it is an ignored one. See the &quot;<a href="#ssl_c_err">ssl_c_err</a>&quot; sample fetch and
    the &quot;<a href="#crt-ignore-err">crt-ignore-err</a>&quot; option.

  - &quot;<a href="#ssl_c_ca_err">ssl_c_ca_err</a>&quot; is the status of the client's certificate chain verification
    process.  The handshake might be successful while having a non-null
    verification error code if it is an ignored one. See the &quot;<a href="#ssl_c_ca_err">ssl_c_ca_err</a>&quot;
    sample fetch and the &quot;<a href="#ca-ignore-err">ca-ignore-err</a>&quot; option.

  - &quot;<a href="#ssl_fc_is_resumed">ssl_fc_is_resumed</a>&quot; is true if the incoming TLS session was resumed with
    the stateful cache or a stateless ticket. Don't forgot that a TLS session
    can be shared by multiple requests.

  - &quot;<a href="#ssl_fc_sni">ssl_fc_sni</a>&quot; is the SNI (Server Name Indication) presented by the client
    to select the certificate to be used. It usually matches the host name for
    the first request of a connection. An absence of this field may indicate
    that the SNI was not sent by the client, and will lead haproxy to use the
    default certificate, or to reject the connection in case of strict-sni.

  - &quot;ssl_version&quot; is the SSL version of the frontend.

  - &quot;ssl_ciphers&quot; is the SSL cipher used for the connection.
</pre></div>
<a class="anchor" id="8.2.5" name="8.2.5"></a>
<h3 id="chapter-8.2.5" data-target="8.2.5"><small><a class="small" href="#8.2.5">8.2.5.</a></small> Error log format</h3>
<div><pre class="text">When an incoming connection fails due to an SSL handshake or an invalid PROXY
protocol header, HAProxy will log the event using a shorter, fixed line format,
unless a dedicated error log format is defined through an &quot;<a href="#error-log-format">error-log-format</a>&quot;
line. By default, logs are emitted at the LOG_INFO level, unless the option
&quot;<a href="#option%20log-separate-errors">log-separate-errors</a>&quot; is set in the backend, in which case the LOG_ERR level
will be used. Connections on which no data are exchanged (e.g. probes) are not
logged if the &quot;<a href="#option%20dontlognull">dontlognull</a>&quot; option is set.

The default format looks like this :

    &gt;&gt;&gt; Dec  3 18:27:14 localhost \
          haproxy[6103]: 127.0.0.1:56059 [03/Dec/2012:17:35:10.380] frt/f1: \
          Connection error during SSL handshake

  Field   Format                                Extract from the example above
      1   process_name '[' pid ']:'                             haproxy[6103]:
      2   client_ip ':' client_port                            127.0.0.1:56059
      3   '[' accept_date ']'                       [03/Dec/2012:17:35:10.380]
      4   frontend_name &quot;/&quot; bind_name &quot;:&quot;                              frt/f1:
      5   message                        Connection error during SSL handshake

These fields just provide minimal information to help debugging connection
failures.

By using the &quot;<a href="#error-log-format">error-log-format</a>&quot; directive, the legacy log format described
above will not be used anymore, and all error log lines will follow the
defined format.

An example of reasonably complete error-log-format follows, it will report the
source address and port, the connection accept() date, the frontend name, the
number of active connections on the process and on thit frontend, haproxy's
internal error identifier on the front connection, the hexadecimal OpenSSL
error number (that can be copy-pasted to &quot;openssl errstr&quot; for full decoding),
the client certificate extraction status (0 indicates no error), the client
certificate validation status using the CA (0 indicates no error), a boolean
indicating if the connection is new or was resumed, the optional server name
indication (SNI) provided by the client, the SSL version name and the SSL
ciphers used on the connection, if any. Note that backend connection errors
are never reported here since in order for a backend connection to fail, it
would have passed through a successful stream, hence will be available as
regular traffic log (see option httplog or option httpslog).

   # detailed frontend connection error log
   error-log-format &quot;%ci:%cp [%tr] %ft %ac/%fc %[fc_err]/\
         %[ssl_fc_err,hex]/%[ssl_c_err]/%[ssl_c_ca_err]/%[ssl_fc_is_resumed] \
         %[ssl_fc_sni]/%sslv/%sslc&quot;
</pre></div>
<a class="anchor" id="8.2.6" name="8.2.6"></a>
<h3 id="chapter-8.2.6" data-target="8.2.6"><small><a class="small" href="#8.2.6">8.2.6.</a></small> Custom log format</h3>
<div><pre class="text">Historically, custom log formats were only used to produce logs. But their
convenience when used to produce a string by assembling multiple complex
expressions has got them adopted by many directives which used to take only
a string in argument and which may now also take an such a Custom log format
definition. Such arguments, which are commonly designated by &quot;&lt;fmt&gt;&quot; in this
document, are defined exactly the same way as the argument to the &quot;<a href="#log-format">log-format</a>&quot;
directive, described here.

When it comes to logs and when the default log formats are not sufficient, it
is possible to define new ones in very fine details. As creating a log-format
from scratch is not always a trivial task, it is strongly recommended to first
have a look at the existing formats (&quot;<a href="#option%20tcplog">option tcplog</a>&quot;, &quot;<a href="#option%20httplog">option httplog</a>&quot;, &quot;option
httpslog&quot;), pick the one looking the closest to the expectation, copy its
&quot;<a href="#log-format">log-format</a>&quot; equivalent string and adjust it.

A Custom log format definition is a single argument from a configuration
perspective. This means that it may not contain blanks (spaces or tabs), unless
these blanks are escaped using the backslash character ('\'), or the whole
definition is enclosed between quotes (which is the recommended way to use
them). The use of unquoted format strings is not recommended anymore as history
has shown that it was very error prone since a single missing backslash
character could result in silent truncation of the format. Such configurations
are still commonly encountered due to the massive adoption of log formats after
version 1.5-dev9, 3 years before quotes were usable, but it is recommended to
convert them to quoted strings and to drop the backslashes now.

A log format definition is made of any number of log format items separated
by text and spaces. A log format item starts with character '%'. In order to
emit a verbatim '%', it must be preceded by another '%' resulting in '%%'.

Logformat items may either be aliases or sample expressions:

If an item is named between square brackets ('[' .. ']') then it is used
as a sample expression rule (see <a href="#7.3">section 7.3</a>). This it useful to add some
less common information such as the client's SSL certificate's DN, or to log
the key that would be used to store an entry into a stick table. It is also
commonly used with non-log actions (header manipulation, variables etc).

Else if the item is named using an alpha-numerical name, it is an alias.
(Refer to the table below for the list of available aliases)

Items can take arguments using braces ('{}'), and multiple arguments are
separated by commas within the braces. Flags may be added or removed by
prefixing them with a '+' or '-' sign (see below for the list of available
flags).

Special alias &quot;%o&quot; may be used to propagate its flags to all other
logformat items on the same format string. This is particularly handy with
quoted (&quot;Q&quot;) and escaped (&quot;E&quot;) string formats.

Special alias &quot;%OG&quot; may be used to retrieve the log origin (when / where
the log was generated) in a human readable format. It is particularly useful
with &quot;<a href="#option%20logasap">option logasap</a>&quot; because some log variables or sample fetches could report
incomplete values or behave differently depending on when / where the logformat
expression was evaluated. Possible values are:
  - &quot;sess_error&quot;: log was generated during session error handling
  - &quot;sess_killed&quot;: log was generated during session abortion (killed
    embryonic session)
  - &quot;txn_accept&quot;: log was generated right after frontend conn was accepted
  - &quot;txn_request&quot;: log was generated after client request was received
  - &quot;txn_connect&quot;: log was generated after backend connection establishment
  - &quot;txn_response&quot;: log was generated during server response handling
  - &quot;txn_close&quot;: log was generated at the final txn step, before closing
  - &quot;unspec&quot;: unknown or not specified
&quot;%OG&quot; is only relevant in logging context.

Items can optionally be named using ('()'). The name must be provided right
after '%' (before arguments). It will automatically be used as key name when
encoding flag such as &quot;<a href="#json">json</a>&quot; or &quot;cbor&quot; is set. When no encoding flag is
specified (default), item name will be ignored. It is also possible to force
the item's output to a given type by appending ':type' after the name, like
this: %(itemname:itemtype)aliasname or %(itemname:itemtype)[expr] where
itemtype may be 'str', 'sint' or 'bool'. Specifying the type is only relevant
when an encoding method is used. Also, it is supported to provide an empty name
to force the output type on an anonymous item: %(:itemtype), ie: when encoding
is not set globally, see flags definitions below for more information.

Due to the original goal of custom log formats to be used for logging only,
there is a special case made of non-printable and unsafe characters (those
outside ASCII codes 32 to 126 plus a few other ones) depending where they are
used. Section 8.6 describes what's done exactly for logs in order to make sure
one will not send unsafe codes that alter the readability of the output in a
terminal. When used to form header fields, health checks or payload responses,
the rules are less strict and only characters forbidden in HTTP header fields
are replaced by their hexadecimal encoding preceded by character '%'. This is
normally not a problem, but it might affect the output when the character was
expected to be reproduced verbatim (e.g. when building an error page or a full
response payload, where line feeds could appear as &quot;%0A&quot;).

Note: in configuration directives &quot;<a href="#log-format">log-format</a>&quot;, &quot;<a href="#log-format-sd">log-format-sd</a>&quot; and
&quot;<a href="#unique-id-format">unique-id-format</a>&quot;, spaces are considered as delimiters and are merged.

Note: when using the RFC5424 syslog message format, the characters '&quot;',
'\' and ']' inside PARAM-VALUE should be escaped with '\' as prefix (see
https://tools.ietf.org/html/rfc5424#section-6.3.3 for more details). In
such cases, the use of the flag &quot;E&quot; should be considered.

Supported item flags are (may be enabled/disabled from item's arguments):
  * Q: quote a string
  * X: hexadecimal representation (IPs, Ports, %Ts, %rt, %pid)
  * E: escape characters '&quot;', '\' and ']' in a string with '\' as prefix
       (intended purpose is for the RFC5424 structured-data log formats)
  * bin: try to preserve binary data, this can be useful with sample
         expressions that output binary data in order to preserve the original
         data. Be careful however, because it can obviously generate non-
         printable chars, including NULL-byte, which most syslog endpoints
         don't expect. Thus it is mainly intended for use with set-var-fmt,
         rings and binary-capable log endpoints.
         This option can only be set globally (with %o), it will be ignored
         if set on an individual item's options.
  * json: automatically encode value in JSON format
          (when set globally, only named logformat items are considered)
          Incomplete numerical values (e.g.: '%B' when logasap is used),
          which are normally prefixed with '+' without encoding, will be
          encoded as-is. Also, '+E' option will be ignored.
  * cbor: automatically encode value in CBOR format
          (when set globally, only named logformat items are considered)
          By default, cbor encoded data is represented in HEX form so
          that it remains printable on stdout an can be used with usual
          syslog endpoints.
          As with json encoding, incomplete numerical values will be encoded
          as-is and '+E' option will be ignored.
          When combined with '+bin' option, it will directly generate raw
          binary CBOR payload. Be careful, because it will obviously generate
          non-printable chars, thus it is mainly intended for use with
          set-var-fmt, rings and binary-capable log endpoints.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>log-format %T\ %t\ Some\ Text
log-format %{+Q}o\ %t\ %s\ %{-Q}r

log-format-sd %{+Q,+E}o\ [exampleSDID@1234\ header=%[capture.req.hdr(0)]]

log-format &quot;%{+json}o %(request)r %(custom_expr)[str(custom)]&quot;
log-format &quot;%{+cbor}o %(request)r %(custom_expr)[str(custom)]&quot;
</code></pre>
</div><pre class="text">Please refer to the table below for currently defined aliases :

  +---+------+------------------------------------------------------+---------+
  | R | alias| field name (8.2.2 and 8.2.3 for description)         | type    |
  |   |      | sample fetch alternative                             |         |
  +===+======+======================================================+=========+
  |   | %o   | special, apply flags on all following items          |         |
  +---+------+------------------------------------------------------+---------+
  |                          date formats                                     |
  +---+------+------------------------------------------------------+---------+
  |   | %T   | Accept date UTC + timezone                           |         |
  |   |      | %[accept_date,utime(&quot;%d/%b/%Y:%H:%M:%S %z&quot;)]         | date    |
  +---+------+------------------------------------------------------+---------+
  |   | %Tl  | Accept date local + timezone                         |         |
  |   |      | %[accept_date,ltime(&quot;%d/%b/%Y:%H:%M:%S %z&quot;)]         | date    |
  +---+------+------------------------------------------------------+---------+
  |   | %Ts  | Accept date as a UNIX timestamp                      | numeric |
  |   |      | %[accept_date]                                       |         |
  +---+------+------------------------------------------------------+---------+
  |   | %t   | Accept date local (with millisecond resolution)      |         |
  |   |      | %[accept_date(ms),ms_ltime(&quot;%d/%b/%Y:%H:%M:%S.%3N&quot;)] | date    |
  +---+------+------------------------------------------------------+---------+
  |   | %ms  | Accept date milliseconds                             |         |
  |   |      | %[accept_date(ms),ms_utime(&quot;%3N&quot;)]                   | numeric |
  +---+------+------------------------------------------------------+---------+
  | H | %tr  | Request date local (with millisecond resolution)     |         |
  |   |      | %[request_date(ms),ms_ltime(&quot;%d/%b/%Y:%H:%M:%S.%3N&quot;)]| date    |
  +---+------+------------------------------------------------------+---------+
  | H | %trg | Request date UTC + timezone                          |         |
  |   |      | %[request_date,utime(&quot;%d/%b/%Y:%H:%M:%S %z&quot;)]        | date    |
  +---+------+------------------------------------------------------+---------+
  | H | %trl | Request date local + timezone                        |         |
  |   |      | %[request_date,ltime(&quot;%d/%b/%Y:%H:%M:%S %z&quot;)]        | date    |
  +---+------+------------------------------------------------------+---------+
  |                          Timing events                                    |
  +---+------+------------------------------------------------------+---------+
  | H | %Ta  | Active time of the request (from TR to end)          |         |
  |   |      | %[txn.timer.total]                                   | numeric |
  +---+------+------------------------------------------------------+---------+
  |   | %Tc  | Tc                                                   |         |
  |   |      | %[bc.timer.connect]                                  | numeric |
  +---+------+------------------------------------------------------+---------+
  |   | %Td  | Td = Tt - (Tq + Tw + Tc + Tr)                        |         |
  |   |      | %[res.timer.data]                                    | numeric |
  +---+------+------------------------------------------------------+---------+
  |   | %Th  | connection handshake time (SSL, PROXY proto)         |         |
  |   |      | %[fc.timer.handshake]                                | numeric |
  +---+------+------------------------------------------------------+---------+
  | H | %Ti  | idle time before the HTTP request                    |         |
  |   |      | %[req.timer.idle]                                    | numeric |
  +---+------+------------------------------------------------------+---------+
  | H | %Tq  | Th + Ti + TR                                         |         |
  |   |      | %[req.timer.tq]                                      | numeric |
  +---+------+------------------------------------------------------+---------+
  | H | %TR  | time to receive the full request from 1st byte       |         |
  |   |      | %[req.timer.hdr]                                     | numeric |
  +---+------+------------------------------------------------------+---------+
  | H | %Tr  | Tr (response time)                                   |         |
  |   |      | %[res.timer.hdr]                                     | numeric |
  +---+------+------------------------------------------------------+---------+
  |   | %Tt  | Tt                                                   |         |
  |   |      | %[fc.timer.total]                                    | numeric |
  +---+------+------------------------------------------------------+---------+
  |   | %Tu  | Tu                                                   |         |
  |   |      | %[txn.timer.user]                                    | numeric |
  +---+------+------------------------------------------------------+---------+
  |   | %Tw  | Tw                                                   |         |
  |   |      | %[req.timer.queue]                                   | numeric |
  +---+------+------------------------------------------------------+---------+
  |                          Others                                           |
  +---+------+------------------------------------------------------+---------+
  |   | %B   | bytes_read           (from server to client)         | numeric |
  |   |      | %[bytes_out]                                         |         |
  +---+------+------------------------------------------------------+---------+
  | H | %CC  | captured_request_cookie                              | string  |
  +---+------+------------------------------------------------------+---------+
  | H | %CS  | captured_response_cookie                             | string  |
  +---+------+------------------------------------------------------+---------+
  |   | %H   | hostname                                             | string  |
  |   |      | %[hostname]                                          |         |
  +---+------+------------------------------------------------------+---------+
  | H | %HM  | HTTP method (ex: POST)                               | string  |
  |   |      | %[method]
  +---+------+------------------------------------------------------+---------+
  | H | %HP  | HTTP request URI without query string                | string  |
  +---+------+------------------------------------------------------+---------+
  | H | %HPO | HTTP path only (without host nor query string)       | string  |
  +---+------+------------------------------------------------------+---------+
  | H | %HQ  | HTTP request URI query string (ex: ?bar=baz)         | string  |
  |   |      | ?%[query]                                            |         |
  +---+------+------------------------------------------------------+---------+
  | H | %HU  | HTTP request URI (ex: /foo?bar=baz)                  | string  |
  +---+------+------------------------------------------------------+---------+
  | H | %HV  | HTTP version (ex: HTTP/1.0)                          | string  |
  |   |      | HTTP/%[req.ver]                                      |         |
  +---+------+------------------------------------------------------+---------+
  |   | %ID  | unique-id                                            | string  |
  |   |      | %[unique-id]                                         |         |
  +---+------+------------------------------------------------------+---------+
  |   | %ST  | status_code                                          | numeric |
  |   |      | %[txn.status]                                        |         |
  +---+------+------------------------------------------------------+---------+
  |   | %U   | bytes_uploaded       (from client to server)         | numeric |
  |   |      | %[bytes_in]                                          |         |
  +---+------+------------------------------------------------------+---------+
  |   | %ac  | actconn                                              |         |
  |   |      | %[act_conn]                                          | numeric |
  +---+------+------------------------------------------------------+---------+
  |   | %b   | backend_name                                         |         |
  |   |      | %[be_name]                                           | string  |
  +---+------+------------------------------------------------------+---------+
  |   | %bc  | beconn      (backend concurrent connections)         | numeric |
  |   |      | %[be_conn]                                           |         |
  +---+------+------------------------------------------------------+---------+
  |   | %bi  | backend_source_ip       (connecting address)         |         |
  |   |      | %[bc_src]                                            | IP      |
  +---+------+------------------------------------------------------+---------+
  |   | %bp  | backend_source_port     (connecting address)         |         |
  |   |      | %[bc_src_port]                                       | numeric |
  +---+------+------------------------------------------------------+---------+
  |   | %bq  | backend_queue                                        | numeric |
  |   |      | %[bc_be_queue]                                       |         |
  +---+------+------------------------------------------------------+---------+
  |   | %ci  | client_ip                 (accepted address)         |         |
  |   |      | %[src]                                               | IP      |
  +---+------+------------------------------------------------------+---------+
  |   | %cp  | client_port               (accepted address)         |         |
  |   |      | %[src_port]                                          | numeric |
  +---+------+------------------------------------------------------+---------+
  |   | %f   | frontend_name                                        | string  |
  |   |      | %[fe_name]                                           |         |
  +---+------+------------------------------------------------------+---------+
  |   | %fc  | feconn     (frontend concurrent connections)         | numeric |
  |   |      | %[fe_conn]                                           |         |
  +---+------+------------------------------------------------------+---------+
  |   | %fi  | frontend_ip              (accepting address)         |         |
  |   |      | %[dst]                                               | IP      |
  +---+------+------------------------------------------------------+---------+
  |   | %fp  | frontend_port            (accepting address)         |         |
  |   |      | %[dst_port]                                          | numeric |
  +---+------+------------------------------------------------------+---------+
  |   | %ft  | frontend_name_transport ('~' suffix for SSL)         | string  |
  +---+------+------------------------------------------------------+---------+
  |   | %lc  | frontend_log_counter                                 | numeric |
  +---+------+------------------------------------------------------+---------+
  |   | %hr  | captured_request_headers default style               | string  |
  +---+------+------------------------------------------------------+---------+
  |   | %hrl | captured_request_headers CLF style                   | string  |
  |   |      |                                                      | list    |
  +---+------+------------------------------------------------------+---------+
  |   | %hs  | captured_response_headers default style              | string  |
  +---+------+------------------------------------------------------+---------+
  |   | %hsl | captured_response_headers CLF style                  | string  |
  |   |      |                                                      | list    |
  +---+------+------------------------------------------------------+---------+
  | L | %OG  | human readable log origin                            | string  |
  +---+------+------------------------------------------------------+---------+
  |   | %pid | PID                                                  |         |
  |   |      | %[pid]                                               | numeric |
  +---+------+------------------------------------------------------+---------+
  | H | %r   | http_request                                         | string  |
  +---+------+------------------------------------------------------+---------+
  |   | %rc  | retries                                              | numeric |
  |   |      | %[txn.redispatched,iif(+,)]%[txn.conn_retries]       |         |
  +---+------+------------------------------------------------------+---------+
  |   | %rt  | request_counter (HTTP req or TCP session)            | numeric |
  |   |      | %[txn.id32]                                          |         |
  +---+------+------------------------------------------------------+---------+
  |   | %s   | server_name                                          | string  |
  |   |      | %[srv_name]                                          |         |
  +---+------+------------------------------------------------------+---------+
  |   | %sc  | srv_conn     (server concurrent connections)         | numeric |
  +---+------+------------------------------------------------------+---------+
  |   | %si  | server_IP                   (target address)         |         |
  |   |      | %[bc_dst]                                            | IP      |
  +---+------+------------------------------------------------------+---------+
  |   | %sp  | server_port                 (target address)         |         |
  |   |      | %[bc_dst_port]                                       | numeric |
  +---+------+------------------------------------------------------+---------+
  |   | %sq  | srv_queue                                            | numeric |
  |   |      | %[bc_srv_queue]                                      |         |
  +---+------+------------------------------------------------------+---------+
  | S | %sslc| ssl_ciphers (ex: AES-SHA)                            |         |
  |   |      | %[ssl_fc_cipher]                                     | string  |
  +---+------+------------------------------------------------------+---------+
  | S | %sslv| ssl_version (ex: TLSv1)                              |         |
  |   |      | %[ssl_fc_protocol]                                   | string  |
  +---+------+------------------------------------------------------+---------+
  |   | %ts  | termination_state                                    | string  |
  |   |      | %[txn.sess_term_state]                               |         |
  +---+------+------------------------------------------------------+---------+
  | H | %tsc | termination_state with cookie status                 | string  |
  +---+------+------------------------------------------------------+---------+

    R = Restrictions : H = mode http only ; S = SSL only ; L = log only
</pre></div>
<a class="anchor" id="8.3" name="8.3"></a>
<h2 id="chapter-8.3" data-target="8.3"><small><a class="small" href="#8.3">8.3.</a></small> Advanced logging options</h2>
<div><pre class="text">Some advanced logging options are often looked for but are not easy to find out
just by looking at the various options. Here is an entry point for the few
options which can enable better logging. Please refer to the keywords reference
for more information about their usage.
</pre></div>
<a class="anchor" id="8.3.1" name="8.3.1"></a>
<h3 id="chapter-8.3.1" data-target="8.3.1"><small><a class="small" href="#8.3.1">8.3.1.</a></small> Disabling logging of external tests</h3>
<div><pre class="text">It is quite common to have some monitoring tools perform health checks on
HAProxy. Sometimes it will be a layer 3 load-balancer such as LVS or any
commercial load-balancer, and sometimes it will simply be a more complete
monitoring system such as Nagios. When the tests are very frequent, users often
ask how to disable logging for those checks. There are three possibilities :

  - if connections come from everywhere and are just TCP probes, it is often
    desired to simply disable logging of connections without data exchange, by
    setting &quot;<a href="#option%20dontlognull">option dontlognull</a>&quot; in the frontend. It also disables logging of
    port scans, which may or may not be desired.

  - it is possible to use the &quot;http-request set-log-level silent&quot; action using
    a variety of conditions (source networks, paths, user-agents, etc).

  - if the tests are performed on a known URI, use &quot;<a href="#monitor-uri">monitor-uri</a>&quot; to declare
    this URI as dedicated to monitoring. Any host sending this request will
    only get the result of a health-check, and the request will not be logged.
</pre></div>
<a class="anchor" id="8.3.2" name="8.3.2"></a>
<h3 id="chapter-8.3.2" data-target="8.3.2"><small><a class="small" href="#8.3.2">8.3.2.</a></small> Logging before waiting for the stream to terminate</h3>
<div><pre class="text">The problem with logging at end of connection is that you have no clue about
what is happening during very long streams, such as remote terminal sessions
or large file downloads. This problem can be worked around by specifying
&quot;<a href="#option%20logasap">option logasap</a>&quot; in the frontend. HAProxy will then log as soon as possible,
just before data transfer begins. This means that in case of TCP, it will still
log the connection status to the server, and in case of HTTP, it will log just
after processing the server headers. In this case, the number of bytes reported
is the number of header bytes sent to the client. In order to avoid confusion
with normal logs, the total time field and the number of bytes are prefixed
with a '+' sign which means that real numbers are certainly larger.
</pre></div>
<a class="anchor" id="8.3.3" name="8.3.3"></a>
<h3 id="chapter-8.3.3" data-target="8.3.3"><small><a class="small" href="#8.3.3">8.3.3.</a></small> Raising log level upon errors</h3>
<div><pre class="text">Sometimes it is more convenient to separate normal traffic from errors logs,
for instance in order to ease error monitoring from log files. When the option
&quot;<a href="#option%20log-separate-errors">log-separate-errors</a>&quot; is used, connections which experience errors, timeouts,
retries, redispatches or HTTP status codes 5xx will see their syslog level
raised from &quot;info&quot; to &quot;err&quot;. This will help a syslog daemon store the log in
a separate file. It is very important to keep the errors in the normal traffic
file too, so that log ordering is not altered. You should also be careful if
you already have configured your syslog daemon to store all logs higher than
&quot;notice&quot; in an &quot;admin&quot; file, because the &quot;err&quot; level is higher than &quot;notice&quot;.
</pre></div>
<a class="anchor" id="8.3.4" name="8.3.4"></a>
<h3 id="chapter-8.3.4" data-target="8.3.4"><small><a class="small" href="#8.3.4">8.3.4.</a></small> Disabling logging of successful connections</h3>
<div><pre class="text">Although this may sound strange at first, some large sites have to deal with
multiple thousands of logs per second and are experiencing difficulties keeping
them intact for a long time or detecting errors within them. If the option
&quot;<a href="#option%20dontlog-normal">dontlog-normal</a>&quot; is set on the frontend, all normal connections will not be
logged. In this regard, a normal connection is defined as one without any
error, timeout, retry nor redispatch. In HTTP, the status code is checked too,
and a response with a status 5xx is not considered normal and will be logged
too. Of course, doing is is really discouraged as it will remove most of the
useful information from the logs. Do this only if you have no other
alternative.
</pre></div>
<a class="anchor" id="8.3.5" name="8.3.5"></a>
<h3 id="chapter-8.3.5" data-target="8.3.5"><small><a class="small" href="#8.3.5">8.3.5.</a></small> Log profiles</h3>
<div><pre class="text">While some directives such as &quot;<a href="#log-format">log-format</a>&quot;, &quot;<a href="#log-format-sd">log-format-sd</a>&quot;, &quot;<a href="#error-log-format">error-log-format</a>&quot;
or &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log-tag<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log-tag%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log-tag%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#log-tag%20%28Log%20profiles%29">Log profiles</a></li></ul></span>&quot; make it possible to configure log formatting globally or at the
proxy level, it may be relevant to configure such settings as close as possible
to the log endpoints, that is, per &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive.

This is where &quot;<a href="#log-profile">log-profile</a>&quot; section comes into play: &quot;<a href="#log-profile">log-profile</a>&quot; may be
defined anywhere in the configuration. This section accepts a set of different
keywords that are used to describe how the logs emitted for a given `log`
directive should be built.

From a &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directive, one can choose to use a specific log-profile by its
name. The same profile may be used from multiple &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directives.
</pre><a class="anchor" name="log-profile"></a><a class="anchor" name="8-log-profile"></a><a class="anchor" name="8.3.5-log-profile"></a><a class="anchor" name="log-profile (Logging)"></a><a class="anchor" name="log-profile (Log profiles)"></a><div class="keyword"><b><a class="anchor" name="log-profile"></a><a href="#8.3.5-log-profile">log-profile</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">Creates a new log profile identified as &lt;name&gt;
</pre><a class="anchor" name="log-tag"></a><a class="anchor" name="8-log-tag"></a><a class="anchor" name="8.3.5-log-tag"></a><a class="anchor" name="log-tag (Logging)"></a><a class="anchor" name="log-tag (Log profiles)"></a><div class="keyword"><b><a class="anchor" name="log-tag"></a><a href="#8.3.5-log-tag">log-tag</a></b> <span style="color: #080">&lt;string&gt;</span></div><pre class="text">Override syslog log tag set globally or per-proxy using &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log-tag<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log-tag%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log-tag%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#log-tag%20%28Log%20profiles%29">Log profiles</a></li></ul></span>&quot; directive.
</pre><a class="anchor" name="on"></a><a class="anchor" name="8-on"></a><a class="anchor" name="8.3.5-on"></a><a class="anchor" name="on (Logging)"></a><a class="anchor" name="on (Log profiles)"></a><div class="keyword"><b><a class="anchor" name="on"></a><a href="#8.3.5-on">on</a></b> <span style="color: #080">&lt;step&gt;</span> <span style="color: #008">[drop]</span> <span style="color: #008">[format <span style="color: #080">&lt;fmt&gt;</span>]</span> <span style="color: #008">[sd <span style="color: #080">&lt;sd_fmt&gt;</span>]</span></div><pre class="text">Override the log-format string normally used to build the log line at
&lt;step&gt; logging step. &lt;fmt&gt; is used to override &quot;<a href="#log-format">log-format</a>&quot; or
&quot;<a href="#error-log-format">error-log-format</a>&quot; strings (depending on the &lt;step&gt;) whereas &lt;sd_fmt&gt; is
used to override &quot;<a href="#log-format-sd">log-format-sd</a>&quot; string (both can be combined).

&quot;drop&quot; special keyword may be used to specify that no log should be
emitted for the given &lt;step&gt;. It takes precedence over &quot;<a href="#format">format</a>&quot; and
&quot;sd&quot; if previously defined.

Possible values for &lt;step&gt; are:

- &quot;<a href="#accept">accept</a>&quot;   : override log-format if the log is generated right after
               frontend conn was accepted
- &quot;request&quot;  : override log-format if the log is generated after client
               request was received
- &quot;connect&quot;  : override log-format if the log is generated after backend
               connection establishment
- &quot;response&quot; : override log-format if the log is generated during server
               response handling
- &quot;<a href="#close">close</a>&quot;    : override log-format if the log is generated at the final
               transaction (txn) step
- &quot;error&quot;    : override error-log-format for if the log is generated due
               to a transaction error
- &quot;any&quot;      : override both log-format and error-log-format for all logging
               steps, unless a more precise step override is declared.

See &quot;<a href="#do-log">do-log</a>&quot; action for relevant additional &lt;step&gt; values.

This setting is only relevant for &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; directives used from contexts where
using &quot;<a href="#log-format">log-format</a>&quot; directive makes sense (e.g.: http and tcp proxies).
Else it will simply be ignored.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>log-profile myprof

  log-tag &quot;custom-tag&quot;

  on error format &quot;%ci: error&quot;
  on connect drop
  on any sd &quot;custom-sd&quot;

listen myproxy
  mode http
  option httplog
  log-tag &quot;normal&quot;

  log stdout format rfc5424 local0
  <span class="comment"># success:</span>
  <span class="comment"># &lt;134&gt;1 2024-06-12T10:09:11.823400+02:00 - normal 224482 - - 127.0.0.1:53594 [12/Jun/2024:10:09:11.814] myproxy myproxy/&lt;NOSRV&gt; 0/-1/-1/-1/0 200 49 - - LR-- 1/1/0/0/0 0/0 &quot;GET / HTTP/1.1&quot;</span>
  <span class="comment">#</span>
  <span class="comment"># error:</span>
  <span class="comment"># &lt;134&gt;1 2024-06-12T10:09:44.810929+02:00 - normal 224482 - - 127.0.0.1:59258 [12/Jun/2024:10:09:44.426] myproxy myproxy/&lt;NOSRV&gt; -1/-1/-1/-1/384 400 0 - - CR-- 1/1/0/0/0 0/0 &quot;&lt;BADREQ&gt;&quot;</span>

  log 127.0.0.1:514 format rfc5424 profile myprof local0
  <span class="comment"># success:</span>
  <span class="comment"># &lt;134&gt;1 2024-06-12T10:09:11.823428+02:00 - custom-tag 224482 - custom-sd 127.0.0.1:53594 [12/Jun/2024:10:09:11.814] myproxy myproxy/&lt;NOSRV&gt; 0/-1/-1/-1/0 200 49 - - LR-- 1/1/0/0/0 0/0 &quot;GET / HTTP/1.1&quot;</span>
  <span class="comment">#</span>
  <span class="comment"># error:</span>
  <span class="comment"># &lt;134&gt;1 2024-06-12T10:09:51.566524+02:00 - custom-tag 224482 - - 127.0.0.1: error</span>
</code></pre>
</div></div>
<a class="anchor" id="8.4" name="8.4"></a>
<h2 id="chapter-8.4" data-target="8.4"><small><a class="small" href="#8.4">8.4.</a></small> Timing events</h2>
<div><pre class="text">Timers provide a great help in troubleshooting network problems. All values are
reported in milliseconds (ms). These timers should be used in conjunction with
the stream termination flags. In TCP mode with &quot;<a href="#option%20tcplog">option tcplog</a>&quot; set on the
frontend, 3 control points are reported under the form &quot;Tw/Tc/Tt&quot;, and in HTTP
mode, 5 control points are reported under the form &quot;TR/Tw/Tc/Tr/Ta&quot;. In
addition, three other measures are provided, &quot;Th&quot;, &quot;Ti&quot;, and &quot;Tq&quot;.

Timings events in HTTP mode:

                 first request               2nd request
      |&lt;--------------------------------&gt;|&lt;-------------- ...
      t         tr                       t    tr ...
   ---|----|----|----|----|----|----|----|----|--
      : Th   Ti   TR   Tw   Tc   Tr   Td : Ti   ...
      :&lt;---- Tq ----&gt;:                   :
      :&lt;-------------- Tt --------------&gt;:
      :&lt;--        -----Tu---------------&gt;:
                :&lt;--------- Ta ---------&gt;:

Timings events in TCP mode:

           TCP session
      |&lt;-----------------&gt;|
      t                   t
   ---|----|----|----|----|---
      | Th   Tw   Tc   Td |
      |&lt;------ Tt -------&gt;|

  - Th: total time to accept tcp connection and execute handshakes for low level
    protocols. Currently, these protocols are proxy-protocol and SSL. This may
    only happen once during the whole connection's lifetime. A large time here
    may indicate that the client only pre-established the connection without
    speaking, that it is experiencing network issues preventing it from
    completing a handshake in a reasonable time (e.g. MTU issues), or that an
    SSL handshake was very expensive to compute. Please note that this time is
    reported only before the first request, so it is safe to average it over
    all request to calculate the amortized value. The second and subsequent
    request will always report zero here.

    This timer is named %Th as a log-format alias, and fc.timer.handshake as a
    sample fetch.

  - Ti: is the idle time before the HTTP request (HTTP mode only). This timer
    counts between the end of the handshakes and the first byte of the HTTP
    request. When dealing with a second request in keep-alive mode, it starts
    to count after the end of the transmission the previous response. When a
    multiplexed protocol such as HTTP/2 is used, it starts to count immediately
    after the previous request. Some browsers pre-establish connections to a
    server in order to reduce the latency of a future request, and keep them
    pending until they need it. This delay will be reported as the idle time. A
    value of -1 indicates that nothing was received on the connection.

    This timer is named %Ti as a log-format alias, and req.timer.idle as a
    sample fetch.

  - TR: total time to get the client request (HTTP mode only). It's the time
    elapsed between the first bytes received and the moment the proxy received
    the empty line marking the end of the HTTP headers. The value &quot;-1&quot;
    indicates that the end of headers has never been seen. This happens when
    the client closes prematurely or times out. This time is usually very short
    since most requests fit in a single packet. A large time may indicate a
    request typed by hand during a test.

    This timer is named %TR as a log-format alias, and req.timer.hdr as a
    sample fetch.

  - Tq: total time to get the client request from the accept date or since the
    emission of the last byte of the previous response (HTTP mode only). It's
    exactly equal to Th + Ti + TR unless any of them is -1, in which case it
    returns -1 as well. This timer used to be very useful before the arrival of
    HTTP keep-alive and browsers' pre-connect feature. It's recommended to drop
    it in favor of TR nowadays, as the idle time adds a lot of noise to the
    reports.

    This timer is named %Tq as a log-format alias, and req.timer.tq as a
    sample fetch.

  - Tw: total time spent in the queues waiting for a connection slot. It
    accounts for backend queue as well as the server queues, and depends on the
    queue size, and the time needed for the server to complete previous
    requests. The value &quot;-1&quot; means that the request was killed before reaching
    the queue, which is generally what happens with invalid or denied requests.

    This timer is named %Tw as a log-format alias, and req.timer.queue as a
    sample fetch.

  - Tc: total time to establish the TCP connection to the server. It's the time
    elapsed between the moment the proxy sent the connection request, and the
    moment it was acknowledged by the server, or between the TCP SYN packet and
    the matching SYN/ACK packet in return. The value &quot;-1&quot; means that the
    connection never established.

    This timer is named %Tc as a log-format alias, and bc.timer.connect as a
    sample fetch.

  - Tr: server response time (HTTP mode only). It's the time elapsed between
    the moment the TCP connection was established to the server and the moment
    the server sent its complete response headers. It purely shows its request
    processing time, without the network overhead due to the data transmission.
    It is worth noting that when the client has data to send to the server, for
    instance during a POST request, the time already runs, and this can distort
    apparent response time. For this reason, it's generally wise not to trust
    too much this field for POST requests initiated from clients behind an
    untrusted network. A value of &quot;-1&quot; here means that the last response header
    (empty line) was never seen, most likely because the server timeout stroke
    before the server managed to process the request or because the server
    returned an invalid response.

    This timer is named %Tr as a log-format alias, and res.timer.hdr as a
    sample fetch.

  - Td: this is the total transfer time of the response payload till the last
    byte sent to the client. In HTTP it starts after the last response header
    (after Tr).

    The data sent are not guaranteed to be received by the client, they can be
    stuck in either the kernel or the network.

    This timer is named %Td as a log-format alias, and res.timer.data as a
    sample fetch.

  - Ta: total active time for the HTTP request, between the moment the proxy
    received the first byte of the request header and the emission of the last
    byte of the response body. The exception is when the &quot;<a href="#option%20logasap">logasap</a>&quot; option is
    specified. In this case, it only equals (TR+Tw+Tc+Tr), and is prefixed with
    a '+' sign. From this field, we can deduce &quot;Td&quot;, the data transmission time,
    by subtracting other timers when valid :

        Td = Ta - (TR + Tw + Tc + Tr)

    Timers with &quot;-1&quot; values have to be excluded from this equation. Note that
    &quot;Ta&quot; can never be negative.

    This timer is named %Ta as a log-format alias, and txn.timer.total as a
    sample fetch.

  - Tt: total stream duration time, between the moment the proxy accepted it
    and the moment both ends were closed. The exception is when the &quot;<a href="#option%20logasap">logasap</a>&quot;
    option is specified. In this case, it only equals (Th+Ti+TR+Tw+Tc+Tr), and
    is prefixed with a '+' sign. From this field, we can deduce &quot;Td&quot;, the data
    transmission time, by subtracting other timers when valid :

        Td = Tt - (Th + Ti + TR + Tw + Tc + Tr)

    Timers with &quot;-1&quot; values have to be excluded from this equation. In TCP
    mode, &quot;Ti&quot;, &quot;Tq&quot; and &quot;Tr&quot; have to be excluded too. Note that &quot;Tt&quot; can never
    be negative and that for HTTP, Tt is simply equal to (Th+Ti+Ta).

    This timer is named %Tt as a log-format alias, and fc.timer.total as a
    sample fetch.

  - Tu: total estimated time as seen from client, between the moment the proxy
    accepted it and the moment both ends were closed, without idle time.
    This is useful to roughly measure end-to-end time as a user would see it,
    without idle time pollution from keep-alive time between requests. This
    timer in only an estimation of time seen by user as it assumes network
    latency is the same in both directions. The exception is when the &quot;<a href="#option%20logasap">logasap</a>&quot;
    option is specified. In this case, it only equals (Th+TR+Tw+Tc+Tr), and is
    prefixed with a '+' sign.

    This timer is named %Tu as a log-format alias, and txn.timer.user as a
    sample fetch.

These timers provide precious indications on trouble causes. Since the TCP
protocol defines retransmit delays of 3, 6, 12... seconds, we know for sure
that timers close to multiples of 3s are nearly always related to lost packets
due to network problems (wires, negotiation, congestion). Moreover, if &quot;Ta&quot; or
&quot;Tt&quot; is close to a timeout value specified in the configuration, it often means
that a stream has been aborted on timeout.

Most common cases :

  - If &quot;Th&quot; or &quot;Ti&quot; are close to 3000, a packet has probably been lost between
    the client and the proxy. This is very rare on local networks but might
    happen when clients are on far remote networks and send large requests. It
    may happen that values larger than usual appear here without any network
    cause. Sometimes, during an attack or just after a resource starvation has
    ended, HAProxy may accept thousands of connections in a few milliseconds.
    The time spent accepting these connections will inevitably slightly delay
    processing of other connections, and it can happen that request times in the
    order of a few tens of milliseconds are measured after a few thousands of
    new connections have been accepted at once. Using one of the keep-alive
    modes may display larger idle times since &quot;Ti&quot; measures the time spent
    waiting for additional requests.

  - If &quot;Tc&quot; is close to 3000, a packet has probably been lost between the
    server and the proxy during the server connection phase. This value should
    always be very low, such as 1 ms on local networks and less than a few tens
    of ms on remote networks.

  - If &quot;Tr&quot; is nearly always lower than 3000 except some rare values which seem
    to be the average majored by 3000, there are probably some packets lost
    between the proxy and the server.

  - If &quot;Ta&quot; is large even for small byte counts, it generally is because
    neither the client nor the server decides to close the connection while
    HAProxy is running in tunnel mode and both have agreed on a keep-alive
    connection mode. In order to solve this issue, it will be needed to specify
    one of the HTTP options to manipulate keep-alive or close options on either
    the frontend or the backend. Having the smallest possible 'Ta' or 'Tt' is
    important when connection regulation is used with the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; option on
    the servers, since no new connection will be sent to the server until
    another one is released.

Other noticeable HTTP log cases ('xx' means any value to be ignored) :

  TR/Tw/Tc/Tr/+Ta  The &quot;<a href="#option%20logasap">option logasap</a>&quot; is present on the frontend and the log
                   was emitted before the data phase. All the timers are valid
                   except &quot;Ta&quot; which is shorter than reality.

  -1/xx/xx/xx/Ta   The client was not able to send a complete request in time
                   or it aborted too early. Check the stream termination flags
                   then &quot;<a href="#timeout%20http-request">timeout http-request</a>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout client<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20client%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#timeout%20client%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; settings.

  TR/-1/xx/xx/Ta   It was not possible to process the request, maybe because
                   servers were out of order, because the request was invalid
                   or forbidden by ACL rules. Check the stream termination
                   flags.

  TR/Tw/-1/xx/Ta   The connection could not establish on the server. Either it
                   actively refused it or it timed out after Ta-(TR+Tw) ms.
                   Check the stream termination flags, then check the
                   &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout connect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20connect%20%28Rings%29">Rings</a></li><li><a href="#timeout%20connect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting. Note that the tarpit action might
                   return similar-looking patterns, with &quot;Tw&quot; equal to the time
                   the client connection was maintained open.

  TR/Tw/Tc/-1/Ta   The server has accepted the connection but did not return
                   a complete response in time, or it closed its connection
                   unexpectedly after Ta-(TR+Tw+Tc) ms. Check the stream
                   termination flags, then check the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20server%20%28Rings%29">Rings</a></li><li><a href="#timeout%20server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting.
</pre></div>
<a class="anchor" id="8.5" name="8.5"></a>
<h2 id="chapter-8.5" data-target="8.5"><small><a class="small" href="#8.5">8.5.</a></small> Stream state at disconnection</h2>
<div><pre class="text">TCP and HTTP logs provide a stream termination indicator in the
&quot;termination_state&quot; field, just before the number of active connections. It is
2-characters long in TCP mode, and is extended to 4 characters in HTTP mode,
each of which has a special meaning :

  - On the first character, a code reporting the first event which caused the
    stream to terminate :

        C : the TCP session was unexpectedly aborted by the client.

        S : the TCP session was unexpectedly aborted by the server, or the
            server explicitly refused it.

        P : the stream or session was prematurely aborted by the proxy, because
            of a connection limit enforcement, because a DENY filter was
            matched, because of a security check which detected and blocked a
            dangerous error in server response which might have caused
            information leak (e.g. cacheable cookie).

        L : the stream was locally processed by HAProxy.

        R : a resource on the proxy has been exhausted (memory, sockets, source
            ports, ...). Usually, this appears during the connection phase, and
            system logs should contain a copy of the precise error. If this
            happens, it must be considered as a very serious anomaly which
            should be fixed as soon as possible by any means.

        I : an internal error was identified by the proxy during a self-check.
            This should NEVER happen, and you are encouraged to report any log
            containing this, because this would almost certainly be a bug. It
            would be wise to preventively restart the process after such an
            event too, in case it would be caused by memory corruption.

        D : the stream was killed by HAProxy because the server was detected
            as down and was configured to kill all connections when going down.

        U : the stream was killed by HAProxy on this backup server because an
            active server was detected as up and was configured to kill all
            backup connections when going up.

        K : the stream was actively killed by an admin operating on HAProxy.

        c : the client-side timeout expired while waiting for the client to
            send or receive data.

        s : the server-side timeout expired while waiting for the server to
            send or receive data.

        - : normal stream completion, both the client and the server closed
            with nothing left in the buffers.

  - on the second character, the TCP or HTTP stream state when it was closed :

        R : the proxy was waiting for a complete, valid REQUEST from the client
            (HTTP mode only). Nothing was sent to any server.

        Q : the proxy was waiting in the QUEUE for a connection slot. This can
            only happen when servers have a 'maxconn' parameter set. It can
            also happen in the global queue after a redispatch consecutive to
            a failed attempt to connect to a dying server. If no redispatch is
            reported, then no connection attempt was made to any server.

        C : the proxy was waiting for the CONNECTION to establish on the
            server. The server might at most have noticed a connection attempt.

        H : the proxy was waiting for complete, valid response HEADERS from the
            server (HTTP only).

        D : the stream was in the DATA phase.

        L : the proxy was still transmitting LAST data to the client while the
            server had already finished. This one is very rare as it can only
            happen when the client dies while receiving the last packets.

        T : the request was tarpitted. It has been held open with the client
            during the whole &quot;<a href="#timeout%20tarpit">timeout tarpit</a>&quot; duration or until the client
            closed, both of which will be reported in the &quot;Tw&quot; timer.

        - : normal stream completion after end of data transfer.

  - the third character tells whether the persistence cookie was provided by
    the client (only in HTTP mode) :

        N : the client provided NO cookie. This is usually the case for new
            visitors, so counting the number of occurrences of this flag in the
            logs generally indicate a valid trend for the site frequentation.

        I : the client provided an INVALID cookie matching no known server.
            This might be caused by a recent configuration change, mixed
            cookies between HTTP/HTTPS sites, persistence conditionally
            ignored, or an attack.

        D : the client provided a cookie designating a server which was DOWN,
            so either &quot;<a href="#option%20persist">option persist</a>&quot; was used and the client was sent to
            this server, or it was not set and the client was redispatched to
            another server.

        V : the client provided a VALID cookie, and was sent to the associated
            server.

        E : the client provided a valid cookie, but with a last date which was
            older than what is allowed by the &quot;maxidle&quot; cookie parameter, so
            the cookie is consider EXPIRED and is ignored. The request will be
            redispatched just as if there was no cookie.

        O : the client provided a valid cookie, but with a first date which was
            older than what is allowed by the &quot;maxlife&quot; cookie parameter, so
            the cookie is consider too OLD and is ignored. The request will be
            redispatched just as if there was no cookie.

        U : a cookie was present but was not used to select the server because
            some other server selection mechanism was used instead (typically a
            &quot;<a href="#use-server">use-server</a>&quot; rule).

        - : does not apply (no cookie set in configuration).

  - the last character reports what operations were performed on the persistence
    cookie returned by the server (only in HTTP mode) :

        N : NO cookie was provided by the server, and none was inserted either.

        I : no cookie was provided by the server, and the proxy INSERTED one.
            Note that in &quot;cookie insert&quot; mode, if the server provides a cookie,
            it will still be overwritten and reported as &quot;I&quot; here.

        U : the proxy UPDATED the last date in the cookie that was presented by
            the client. This can only happen in insert mode with &quot;maxidle&quot;. It
            happens every time there is activity at a different date than the
            date indicated in the cookie. If any other change happens, such as
            a redispatch, then the cookie will be marked as inserted instead.

        P : a cookie was PROVIDED by the server and transmitted as-is.

        R : the cookie provided by the server was REWRITTEN by the proxy, which
            happens in &quot;cookie rewrite&quot; or &quot;cookie prefix&quot; modes.

        D : the cookie provided by the server was DELETED by the proxy.

        - : does not apply (no cookie set in configuration).

The combination of the two first flags gives a lot of information about what
was happening when the stream or session terminated, and why it did terminate.
It can be helpful to detect server saturation, network troubles, local system
resource starvation, attacks, etc...

The most common termination flags combinations are indicated below. They are
alphabetically sorted, with the lowercase set just after the upper case for
easier finding and understanding.

  Flags   Reason

     --   Normal termination.

     CC   The client aborted before the connection could be established to the
          server. This can happen when HAProxy tries to connect to a recently
          dead (or unchecked) server, and the client aborts while HAProxy is
          waiting for the server to respond or for &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout connect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20connect%20%28Rings%29">Rings</a></li><li><a href="#timeout%20connect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; to expire.

     CD   The client unexpectedly aborted during data transfer. This can be
          caused by a browser crash, by an intermediate equipment between the
          client and HAProxy which decided to actively break the connection,
          by network routing issues between the client and HAProxy, or by a
          keep-alive stream between the server and the client terminated first
          by the client.

     cD   The client did not send nor acknowledge any data for as long as the
          &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout client<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20client%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#timeout%20client%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; delay. This is often caused by network failures on
          the client side, or the client simply leaving the net uncleanly.

     CH   The client aborted while waiting for the server to start responding.
          It might be the server taking too long to respond or the client
          clicking the 'Stop' button too fast.

     cH   The &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout client<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20client%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#timeout%20client%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; stroke while waiting for client data during a
          POST request. This is sometimes caused by too large TCP MSS values
          for PPPoE networks which cannot transport full-sized packets. It can
          also happen when client timeout is smaller than server timeout and
          the server takes too long to respond.

     CQ   The client aborted while its stream was queued, waiting for a server
          with enough empty slots to accept it. It might be that either all the
          servers were saturated or that the assigned server was taking too
          long a time to respond.

     CR   The client aborted before sending a full HTTP request. Most likely
          the request was typed by hand using a telnet client, and aborted
          too early. The HTTP status code is likely a 400 here. Sometimes this
          might also be caused by an IDS killing the connection between HAProxy
          and the client. &quot;<a href="#option%20http-ignore-probes">option http-ignore-probes</a>&quot; can be used to ignore
          connections without any data transfer.

     cR   The &quot;<a href="#timeout%20http-request">timeout http-request</a>&quot; stroke before the client sent a full HTTP
          request. This is sometimes caused by too large TCP MSS values on the
          client side for PPPoE networks which cannot transport full-sized
          packets, or by clients sending requests by hand and not typing fast
          enough, or forgetting to enter the empty line at the end of the
          request. The HTTP status code is likely a 408 here. Note: recently,
          some browsers started to implement a &quot;pre-connect&quot; feature consisting
          in speculatively connecting to some recently visited web sites just
          in case the user would like to visit them. This results in many
          connections being established to web sites, which end up in 408
          Request Timeout if the timeout strikes first, or 400 Bad Request when
          the browser decides to close them first. These ones pollute the log
          and feed the error counters. Some versions of some browsers have even
          been reported to display the error code. It is possible to work
          around the undesirable effects of this behavior by adding &quot;option
          http-ignore-probes&quot; in the frontend, resulting in connections with
          zero data transfer to be totally ignored. This will definitely hide
          the errors of people experiencing connectivity issues though.

     CT   The client aborted while its stream was tarpitted. It is important to
          check if this happens on valid requests, in order to be sure that no
          wrong tarpit rules have been written. If a lot of them happen, it
          might make sense to lower the &quot;<a href="#timeout%20tarpit">timeout tarpit</a>&quot; value to something
          closer to the average reported &quot;Tw&quot; timer, in order not to consume
          resources for just a few attackers.

     LC   The request was intercepted and locally handled by HAProxy. The
          request was not sent to the server. It only happens with a redirect
          because of a &quot;<a href="#redir">redir</a>&quot; parameter on the server line.

     LR   The request was intercepted and locally handled by HAProxy. The
          request was not sent to the server. Generally it means a redirect was
          returned, an HTTP return statement was processed or the request was
          handled by an applet (stats, cache, Prometheus exported, lua applet...).

     LH   The response was intercepted and locally handled by HAProxy. Generally
          it means a redirect was returned or an HTTP return statement was
          processed.

     SC   The server or an equipment between it and HAProxy explicitly refused
          the TCP connection (the proxy received a TCP RST or an ICMP message
          in return). Under some circumstances, it can also be the network
          stack telling the proxy that the server is unreachable (e.g. no route,
          or no ARP response on local network). When this happens in HTTP mode,
          the status code is likely a 502 or 503 here.

     sC   The &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout connect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20connect%20%28Rings%29">Rings</a></li><li><a href="#timeout%20connect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; stroke before a connection to the server could
          complete. When this happens in HTTP mode, the status code is likely a
          503 or 504 here.

     SD   The connection to the server died with an error during the data
          transfer. This usually means that HAProxy has received an RST from
          the server or an ICMP message from an intermediate equipment while
          exchanging data with the server. This can be caused by a server crash
          or by a network issue on an intermediate equipment.

     sD   The server did not send nor acknowledge any data for as long as the
          &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20server%20%28Rings%29">Rings</a></li><li><a href="#timeout%20server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; setting during the data phase. This is often caused
          by too short timeouts on L4 equipment before the server (firewalls,
          load-balancers, ...), as well as keep-alive sessions maintained
          between the client and the server expiring first on HAProxy.

     SH   The server aborted before sending its full HTTP response headers, or
          it crashed while processing the request. Since a server aborting at
          this moment is very rare, it would be wise to inspect its logs to
          control whether it crashed and why. The logged request may indicate a
          small set of faulty requests, demonstrating bugs in the application.
          Sometimes this might also be caused by an IDS killing the connection
          between HAProxy and the server.

     sH   The &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20server%20%28Rings%29">Rings</a></li><li><a href="#timeout%20server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; stroke before the server could return its
          response headers. This is the most common anomaly, indicating too
          long transactions, probably caused by server or database saturation.
          The immediate workaround consists in increasing the &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20server%20%28Rings%29">Rings</a></li><li><a href="#timeout%20server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;
          setting, but it is important to keep in mind that the user experience
          will suffer from these long response times. The only long term
          solution is to fix the application.

     sQ   The stream spent too much time in queue and has been expired. See
          the &quot;<a href="#timeout%20queue">timeout queue</a>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">timeout connect<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#timeout%20connect%20%28Rings%29">Rings</a></li><li><a href="#timeout%20connect%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; settings to find out how to
          fix this if it happens too often. If it often happens massively in
          short periods, it may indicate general problems on the affected
          servers due to I/O or database congestion, or saturation caused by
          external attacks.

     PC   The proxy refused to establish a connection to the server because the
          process's socket limit has been reached while attempting to connect.
          The global &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; parameter may be increased in the configuration
          so that it does not happen anymore. This status is very rare and
          might happen when the global &quot;<a href="#ulimit-n">ulimit-n</a>&quot; parameter is forced by hand.

     PD   The proxy blocked an incorrectly formatted chunked encoded message in
          a request or a response, after the server has emitted its headers. In
          most cases, this will indicate an invalid message from the server to
          the client. HAProxy supports chunk sizes of up to 2GB - 1 (2147483647
          bytes). Any larger size will be considered as an error.

     PH   The proxy blocked the server's response, because it was invalid,
          incomplete, dangerous (cache control), or matched a security filter.
          In any case, an HTTP 502 error is sent to the client. One possible
          cause for this error is an invalid syntax in an HTTP header name
          containing unauthorized characters. It is also possible but quite
          rare, that the proxy blocked a chunked-encoding request from the
          client due to an invalid syntax, before the server responded. In this
          case, an HTTP 400 error is sent to the client and reported in the
          logs. Finally, it may be due to an HTTP header rewrite failure on the
          response. In this case, an HTTP 500 error is sent (see
          &quot;<a href="#tune.maxrewrite">tune.maxrewrite</a>&quot; and &quot;http-response strict-mode&quot; for more
          inforomation).

     PR   The proxy blocked the client's HTTP request, either because of an
          invalid HTTP syntax, in which case it returned an HTTP 400 error to
          the client, or because a deny filter matched, in which case it
          returned an HTTP 403 error.  It may also be due to an HTTP header
          rewrite failure on the request. In this case, an HTTP 500 error is
          sent (see &quot;<a href="#tune.maxrewrite">tune.maxrewrite</a>&quot; and &quot;http-request strict-mode&quot; for more
          inforomation).

     PT   The proxy blocked the client's request and has tarpitted its
          connection before returning it a 500 server error. Nothing was sent
          to the server. The connection was maintained open for as long as
          reported by the &quot;Tw&quot; timer field.

     RC   A local resource has been exhausted (memory, sockets, source ports)
          preventing the connection to the server from establishing. The error
          logs will tell precisely what was missing. This is very rare and can
          only be solved by proper system tuning.

The combination of the two last flags gives a lot of information about how
persistence was handled by the client, the server and by HAProxy. This is very
important to troubleshoot disconnections, when users complain they have to
re-authenticate. The commonly encountered flags are :

     --   Persistence cookie is not enabled.

     NN   No cookie was provided by the client, none was inserted in the
          response. For instance, this can be in insert mode with &quot;postonly&quot;
          set on a GET request.

     II   A cookie designating an invalid server was provided by the client,
          a valid one was inserted in the response. This typically happens when
          a &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; entry is removed from the configuration, since its cookie
          value can be presented by a client when no other server knows it.

     NI   No cookie was provided by the client, one was inserted in the
          response. This typically happens for first requests from every user
          in &quot;insert&quot; mode, which makes it an easy way to count real users.

     VN   A cookie was provided by the client, none was inserted in the
          response. This happens for most responses for which the client has
          already got a cookie.

     VU   A cookie was provided by the client, with a last visit date which is
          not completely up-to-date, so an updated cookie was provided in
          response. This can also happen if there was no date at all, or if
          there was a date but the &quot;maxidle&quot; parameter was not set, so that the
          cookie can be switched to unlimited time.

     EI   A cookie was provided by the client, with a last visit date which is
          too old for the &quot;maxidle&quot; parameter, so the cookie was ignored and a
          new cookie was inserted in the response.

     OI   A cookie was provided by the client, with a first visit date which is
          too old for the &quot;maxlife&quot; parameter, so the cookie was ignored and a
          new cookie was inserted in the response.

     DI   The server designated by the cookie was down, a new server was
          selected and a new cookie was emitted in the response.

     VI   The server designated by the cookie was not marked dead but could not
          be reached. A redispatch happened and selected another one, which was
          then advertised in the response.
</pre></div>
<a class="anchor" id="8.6" name="8.6"></a>
<h2 id="chapter-8.6" data-target="8.6"><small><a class="small" href="#8.6">8.6.</a></small> Non-printable characters</h2>
<div><pre class="text">In order not to cause trouble to log analysis tools or terminals during log
consulting, non-printable characters are not sent as-is into log files, but are
converted to the two-digits hexadecimal representation of their ASCII code,
prefixed by the character '#'. The only characters that can be logged without
being escaped are comprised between 32 and 126 (inclusive). Obviously, the
escape character '#' itself is also encoded to avoid any ambiguity (&quot;#23&quot;). It
is the same for the character '&quot;' which becomes &quot;#22&quot;, as well as '{', '|' and
'}' when logging headers.

Note that the space character (' ') is not encoded in headers, which can cause
issues for tools relying on space count to locate fields. A typical header
containing spaces is &quot;User-Agent&quot;.

Last, it has been observed that some syslog daemons such as syslog-ng escape
the quote ('&quot;') with a backslash ('\'). The reverse operation can safely be
performed since no quote may appear anywhere else in the logs.
</pre></div>
<a class="anchor" id="8.7" name="8.7"></a>
<h2 id="chapter-8.7" data-target="8.7"><small><a class="small" href="#8.7">8.7.</a></small> Capturing HTTP cookies</h2>
<div><pre class="text">Cookie capture simplifies the tracking a complete user session. This can be
achieved using the &quot;<a href="#capture%20cookie">capture cookie</a>&quot; statement in the frontend. Please refer to
<a href="#4.2">section 4.2</a> for more details. Only one cookie can be captured, and the same
cookie will simultaneously be checked in the request (&quot;Cookie:&quot; header) and in
the response (&quot;Set-Cookie:&quot; header). The respective values will be reported in
the HTTP logs at the &quot;captured_request_cookie&quot; and &quot;captured_response_cookie&quot;
locations (see <a href="#8.2.3">section 8.2.3</a> about HTTP log format). When either cookie is
not seen, a dash ('-') replaces the value. This way, it's easy to detect when a
user switches to a new session for example, because the server will reassign it
a new cookie. It is also possible to detect if a server unexpectedly sets a
wrong cookie to a client, leading to session crossing.
</pre><div class="separator">
<span class="label label-success">Examples :</span>
<pre class="prettyprint">
<code><span class="comment"># capture the first cookie whose name starts with &quot;ASPSESSION&quot;</span>
capture cookie ASPSESSION len 32

<span class="comment"># capture the first cookie whose name is exactly &quot;vgnvisitor&quot;</span>
capture cookie vgnvisitor= len 32
</code></pre>
</div></div>
<a class="anchor" id="8.8" name="8.8"></a>
<h2 id="chapter-8.8" data-target="8.8"><small><a class="small" href="#8.8">8.8.</a></small> Capturing HTTP headers</h2>
<div><pre class="text">Header captures are useful to track unique request identifiers set by an upper
proxy, virtual host names, user-agents, POST content-length, referrers, etc. In
the response, one can search for information about the response length, how the
server asked the cache to behave, or an object location during a redirection.

Header captures are performed using the &quot;<a href="#capture%20request%20header">capture request header</a>&quot; and &quot;capture
response header&quot; statements in the frontend. Please consult their definition in
<a href="#4.2">section 4.2</a> for more details.

It is possible to include both request headers and response headers at the same
time. Non-existent headers are logged as empty strings, and if one header
appears more than once, only its last occurrence will be logged. Request headers
are grouped within braces '{' and '}' in the same order as they were declared,
and delimited with a vertical bar '|' without any space. Response headers
follow the same representation, but are displayed after a space following the
request headers block. These blocks are displayed just before the HTTP request
in the logs.

As a special case, it is possible to specify an HTTP header capture in a TCP
frontend. The purpose is to enable logging of headers which will be parsed in
an HTTP backend if the request is then switched to this HTTP backend.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>    <span class="comment"># This instance chains to the outgoing proxy</span>
    listen proxy-out
        mode http
        option httplog
        option logasap
        log global
        server cache1 192.168.1.1:3128

        <span class="comment"># log the name of the virtual server</span>
        capture request  header Host len 20

        <span class="comment"># log the amount of data uploaded during a POST</span>
        capture request  header Content-Length len 10

        <span class="comment"># log the beginning of the referrer</span>
        capture request  header Referer len 20

        <span class="comment"># server name (useful for outgoing proxies only)</span>
        capture response header Server len 20

        <span class="comment"># logging the content-length is useful with &quot;<a href="#option%20logasap">option logasap</a>&quot;</span>
        capture response header Content-Length len 10

        <span class="comment"># log the expected cache behavior on the response</span>
        capture response header Cache-Control len 8

        <span class="comment"># the Via header will report the next proxy's name</span>
        capture response header Via len 20

        <span class="comment"># log the URL location during a redirection</span>
        capture response header Location len 20

&gt;&gt;&gt; Aug  9 20:26:09 localhost \
      haproxy[2022]: 127.0.0.1:34014 [09/Aug/2004:20:26:09] proxy-out \
      proxy-out/cache1 0/0/0/162/+162 200 +350 - - ---- 0/0/0/0/0 0/0 \
      {fr.adserver.yahoo.co||http://fr.f416.mail.} {|864|private||} \
      &quot;GET http://fr.adserver.yahoo.com/&quot;

&gt;&gt;&gt; Aug  9 20:30:46 localhost \
      haproxy[2022]: 127.0.0.1:34020 [09/Aug/2004:20:30:46] proxy-out \
      proxy-out/cache1 0/0/0/182/+182 200 +279 - - ---- 0/0/0/0/0 0/0 \
      {w.ods.org||} {Formilux/0.1.8|3495|||} \
      &quot;GET http://trafic.1wt.eu/ HTTP/1.1&quot;

&gt;&gt;&gt; Aug  9 20:30:46 localhost \
      haproxy[2022]: 127.0.0.1:34028 [09/Aug/2004:20:30:46] proxy-out \
      proxy-out/cache1 0/0/2/126/+128 301 +223 - - ---- 0/0/0/0/0 0/0 \
      {www.sytadin.equipement.gouv.fr||http://trafic.1wt.eu/} \
      {Apache|230|||http://www.sytadin.} \
      &quot;GET http://www.sytadin.equipement.gouv.fr/ HTTP/1.1&quot;
</code></pre>
</div></div>
<a class="anchor" id="8.9" name="8.9"></a>
<h2 id="chapter-8.9" data-target="8.9"><small><a class="small" href="#8.9">8.9.</a></small> Examples of logs</h2>
<div><pre class="text">These are real-world examples of logs accompanied with an explanation. Some of
them have been made up by hand. The syslog part has been removed for better
reading. Their sole purpose is to explain how to decipher them.

    &gt;&gt;&gt; haproxy[674]: 127.0.0.1:33318 [15/Oct/2003:08:31:57.130] px-http \
          px-http/srv1 6559/0/7/147/6723 200 243 - - ---- 5/3/3/1/0 0/0 \
          &quot;HEAD / HTTP/1.0&quot;

    =&gt; long request (6.5s) entered by hand through 'telnet'. The server replied
       in 147 ms, and the session ended normally ('----')

    &gt;&gt;&gt; haproxy[674]: 127.0.0.1:33319 [15/Oct/2003:08:31:57.149] px-http \
          px-http/srv1 6559/1230/7/147/6870 200 243 - - ---- 324/239/239/99/0 \
          0/9 &quot;HEAD / HTTP/1.0&quot;

    =&gt; Idem, but the request was queued in the global queue behind 9 other
       requests, and waited there for 1230 ms.

    &gt;&gt;&gt; haproxy[674]: 127.0.0.1:33320 [15/Oct/2003:08:32:17.654] px-http \
          px-http/srv1 9/0/7/14/+30 200 +243 - - ---- 3/3/3/1/0 0/0 \
          &quot;GET /image.iso HTTP/1.0&quot;

    =&gt; request for a long data transfer. The &quot;<a href="#option%20logasap">logasap</a>&quot; option was specified, so
       the log was produced just before transferring data. The server replied in
       14 ms, 243 bytes of headers were sent to the client, and total time from
       accept to first data byte is 30 ms.

    &gt;&gt;&gt; haproxy[674]: 127.0.0.1:33320 [15/Oct/2003:08:32:17.925] px-http \
          px-http/srv1 9/0/7/14/30 502 243 - - PH-- 3/2/2/0/0 0/0 \
          &quot;GET /cgi-bin/bug.cgi? HTTP/1.0&quot;

    =&gt; the proxy blocked a server response either because of an &quot;http-response
       deny&quot; rule, or because the response was improperly formatted and not
       HTTP-compliant, or because it blocked sensitive information which risked
       being cached. In this case, the response is replaced with a &quot;502 bad
       gateway&quot;. The flags (&quot;PH--&quot;) tell us that it was HAProxy who decided to
       return the 502 and not the server.

    &gt;&gt;&gt; haproxy[18113]: 127.0.0.1:34548 [15/Oct/2003:15:18:55.798] px-http \
          px-http/&lt;NOSRV&gt; -1/-1/-1/-1/8490 -1 0 - - CR-- 2/2/2/0/0 0/0 &quot;&quot;

    =&gt; the client never completed its request and aborted itself (&quot;C---&quot;) after
       8.5s, while the proxy was waiting for the request headers (&quot;-R--&quot;).
       Nothing was sent to any server.

    &gt;&gt;&gt; haproxy[18113]: 127.0.0.1:34549 [15/Oct/2003:15:19:06.103] px-http \
         px-http/&lt;NOSRV&gt; -1/-1/-1/-1/50001 408 0 - - cR-- 2/2/2/0/0 0/0 &quot;&quot;

    =&gt; The client never completed its request, which was aborted by the
       time-out (&quot;c---&quot;) after 50s, while the proxy was waiting for the request
       headers (&quot;-R--&quot;). Nothing was sent to any server, but the proxy could
       send a 408 return code to the client.

    &gt;&gt;&gt; haproxy[18989]: 127.0.0.1:34550 [15/Oct/2003:15:24:28.312] px-tcp \
          px-tcp/srv1 0/0/5007 0 cD 0/0/0/0/0 0/0

    =&gt; This log was produced with &quot;<a href="#option%20tcplog">option tcplog</a>&quot;. The client timed out after
       5 seconds (&quot;c----&quot;).

    &gt;&gt;&gt; haproxy[18989]: 10.0.0.1:34552 [15/Oct/2003:15:26:31.462] px-http \
          px-http/srv1 3183/-1/-1/-1/11215 503 0 - - SC-- 205/202/202/115/3 \
          0/0 &quot;HEAD / HTTP/1.0&quot;

    =&gt; The request took 3s to complete (probably a network problem), and the
       connection to the server failed ('SC--') after 4 attempts of 2 seconds
       (config says 'retries 3'), and no redispatch (otherwise we would have
       seen &quot;/+3&quot;). Status code 503 was returned to the client. There were 115
       connections on this server, 202 connections on this proxy, and 205 on
       the global process. It is possible that the server refused the
       connection because of too many already established.
</pre></div>
<a class="anchor" id="9" name="9"></a>
<div class="page-header"><h1 id="chapter-9" data-target="9"><small><a class="small" href="#9">9.</a></small> Supported filters</h1>
</div><div><pre class="text">Here are listed officially supported filters with the list of parameters they
accept. Depending on compile options, some of these filters might be
unavailable. The list of available filters is reported in haproxy -vv.
</pre><div class="page-header"><b>See also :</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">filter<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#filter%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#filter%20%28Trace%29">Trace</a></li><li><a href="#filter%20%28HTTP%20compression%29">HTTP compression</a></li><li><a href="#filter%20%28Stream%20Processing%20Offload%20Engine%20%28SPOE%29%29">Stream Processing Offload Engine (SPOE)</a></li><li><a href="#filter%20%28Cache%29">Cache</a></li><li><a href="#filter%20%28fcgi-app%29">fcgi-app</a></li><li><a href="#filter%20%28OpenTracing%29">OpenTracing</a></li><li><a href="#filter%20%28Bandwidth%20limitation%29">Bandwidth limitation</a></li></ul></span>&quot;</div>
</div>
<a class="anchor" id="9.1" name="9.1"></a>
<h2 id="chapter-9.1" data-target="9.1"><small><a class="small" href="#9.1">9.1.</a></small> Trace</h2>
<div><a class="anchor" name="filter"></a><a class="anchor" name="9-filter"></a><a class="anchor" name="9.1-filter"></a><a class="anchor" name="filter (Supported filters)"></a><a class="anchor" name="filter (Trace)"></a><a class="anchor" name="filter trace"></a><a class="anchor" name="9-filter trace"></a><a class="anchor" name="9.1-filter trace"></a><a class="anchor" name="filter trace (Supported filters)"></a><a class="anchor" name="filter trace (Trace)"></a><div class="keyword"><b><a class="anchor" name="filter trace"></a><a href="#9.1-filter%20trace">filter trace</a></b> <span style="color: #008">[name <span style="color: #080">&lt;name&gt;</span>]</span> <span style="color: #008">[random-forwarding]</span> <span style="color: #008">[hexdump]</span></div><div class="separator">
<span class="label label-info">Arguments:</span><pre class="prettyprint arguments">&lt;name&gt;               is an arbitrary name that will be reported in
                     messages. If no name is provided, &quot;TRACE&quot; is used.

&lt;quiet&gt;              inhibits trace messages.

&lt;random-forwarding&gt;  enables the random forwarding of parsed data. By
                     default, this filter forwards all previously parsed
                     data. With this parameter, it only forwards a random
                     amount of the parsed data.

&lt;hexdump&gt;             dumps all forwarded data to the server and the client.</pre>
</div>
<pre class="text">This filter can be used as a base to develop new filters. It defines all
callbacks and print a message on the standard error stream (stderr) with useful
information for all of them. It may be useful to debug the activity of other
filters or, quite simply, HAProxy's activity.

Using &lt;random-parsing&gt; and/or &lt;random-forwarding&gt; parameters is a good way to
tests the behavior of a filter that parses data exchanged between a client and
a server by adding some latencies in the processing.
</pre></div>
<a class="anchor" id="9.2" name="9.2"></a>
<h2 id="chapter-9.2" data-target="9.2"><small><a class="small" href="#9.2">9.2.</a></small> HTTP compression</h2>
<div><a class="anchor" name="filter"></a><a class="anchor" name="9-filter"></a><a class="anchor" name="9.2-filter"></a><a class="anchor" name="filter (Supported filters)"></a><a class="anchor" name="filter (HTTP compression)"></a><a class="anchor" name="filter compression"></a><a class="anchor" name="9-filter compression"></a><a class="anchor" name="9.2-filter compression"></a><a class="anchor" name="filter compression (Supported filters)"></a><a class="anchor" name="filter compression (HTTP compression)"></a><div class="keyword"><b><a class="anchor" name="filter compression"></a><a href="#9.2-filter%20compression">filter compression</a></b></div><pre class="text">The HTTP compression has been moved in a filter in HAProxy 1.7. &quot;<a href="#compression">compression</a>&quot;
keyword must still be used to enable and configure the HTTP compression. And
when no other filter is used, it is enough. When used with the cache or the
fcgi-app enabled, it is also enough. In this case, the compression is always
done after the response is stored in the cache. But it is mandatory to
explicitly use a filter line to enable the HTTP compression when at least one
filter other than the cache or the fcgi-app is used for the same
listener/frontend/backend. This is important to know the filters evaluation
order.
</pre><div class="page-header"><b>See also :</b> &quot;<a href="#compression">compression</a>&quot;, <a href="#9.4">section 9.4</a> about the cache filter and <a href="#9.5">section 9.5</a> about the fcgi-app filter.</div>
</div>
<a class="anchor" id="9.3" name="9.3"></a>
<h2 id="chapter-9.3" data-target="9.3"><small><a class="small" href="#9.3">9.3.</a></small> Stream Processing Offload Engine (SPOE)</h2>
<div><a class="anchor" name="filter"></a><a class="anchor" name="9-filter"></a><a class="anchor" name="9.3-filter"></a><a class="anchor" name="filter (Supported filters)"></a><a class="anchor" name="filter (Stream Processing Offload Engine (SPOE))"></a><a class="anchor" name="filter spoe"></a><a class="anchor" name="9-filter spoe"></a><a class="anchor" name="9.3-filter spoe"></a><a class="anchor" name="filter spoe (Supported filters)"></a><a class="anchor" name="filter spoe (Stream Processing Offload Engine (SPOE))"></a><div class="keyword"><b><a class="anchor" name="filter spoe"></a><a href="#9.3-filter%20spoe">filter spoe</a></b> <span style="color: #008">[engine <span style="color: #080">&lt;name&gt;</span>]</span> config <span style="color: #080">&lt;file&gt;</span></div><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;name&gt;      is the engine name that will be used to find the right scope in
            the configuration file. If not provided, all the file will be
            parsed.

&lt;file&gt;      is the path of the engine configuration file. This file can
            contain configuration of several engines. In this case, each
            part must be placed in its own scope.</pre>
</div>
<pre class="text">The Stream Processing Offload Engine (SPOE) is a filter communicating with
external components. It allows the offload of some specifics processing on the
streams in tiered applications. These external components and information
exchanged with them are configured in dedicated files, for the main part. It
also requires dedicated backends, defined in HAProxy configuration.

SPOE communicates with external components using an in-house binary protocol,
the Stream Processing Offload Protocol (SPOP).

When the SPOE is used on a stream, a dedicated stream is spawned to handle the
communication with the external component. The main stream is the parent stream
of this &quot;SPOE&quot; stream. It means it is possible to retrieve variables of the
main stream from the &quot;SPOE&quot; stream. See <a href="#2.8">section 2.8</a> about variables for
details.

For all information about the SPOE configuration and the SPOP specification, see
&quot;doc/SPOE.txt&quot;.
</pre></div>
<a class="anchor" id="9.4" name="9.4"></a>
<h2 id="chapter-9.4" data-target="9.4"><small><a class="small" href="#9.4">9.4.</a></small> Cache</h2>
<div><a class="anchor" name="filter"></a><a class="anchor" name="9-filter"></a><a class="anchor" name="9.4-filter"></a><a class="anchor" name="filter (Supported filters)"></a><a class="anchor" name="filter (Cache)"></a><a class="anchor" name="filter cache"></a><a class="anchor" name="9-filter cache"></a><a class="anchor" name="9.4-filter cache"></a><a class="anchor" name="filter cache (Supported filters)"></a><a class="anchor" name="filter cache (Cache)"></a><div class="keyword"><b><a class="anchor" name="filter cache"></a><a href="#9.4-filter%20cache">filter cache</a></b> <span style="color: #080">&lt;name&gt;</span></div><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;name&gt;      is name of the cache section this filter will use.</pre>
</div>
<pre class="text">The cache uses a filter to store cacheable responses. The HTTP rules
&quot;<a href="#cache-store">cache-store</a>&quot; and &quot;<a href="#cache-use">cache-use</a>&quot; must be used to define how and when to use a
cache. By default the corresponding filter is implicitly defined. And when no
other filters than fcgi-app or compression are used, it is enough. In such
case, the compression filter is always evaluated after the cache filter. But it
is mandatory to explicitly use a filter line to use a cache when at least one
filter other than the compression or the fcgi-app is used for the same
listener/frontend/backend. This is important to know the filters evaluation
order.
</pre><div class="page-header"><b>See also :</b> <a href="#9.2">section 9.2</a> about the compression filter, <a href="#9.5">section 9.5</a> about the fcgi-app filter and <a href="#6">section 6</a> about cache.</div>
</div>
<a class="anchor" id="9.5" name="9.5"></a>
<h2 id="chapter-9.5" data-target="9.5"><small><a class="small" href="#9.5">9.5.</a></small> Fcgi-app</h2>
<div><a class="anchor" name="filter"></a><a class="anchor" name="9-filter"></a><a class="anchor" name="9.5-filter"></a><a class="anchor" name="filter (Supported filters)"></a><a class="anchor" name="filter (fcgi-app)"></a><a class="anchor" name="filter fcgi-app"></a><a class="anchor" name="9-filter fcgi-app"></a><a class="anchor" name="9.5-filter fcgi-app"></a><a class="anchor" name="filter fcgi-app (Supported filters)"></a><a class="anchor" name="filter fcgi-app (fcgi-app)"></a><div class="keyword"><b><a class="anchor" name="filter fcgi-app"></a><a href="#9.5-filter%20fcgi-app">filter fcgi-app</a></b> <span style="color: #080">&lt;name&gt;</span></div><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;name&gt;      is name of the fcgi-app section this filter will use.</pre>
</div>
<pre class="text">The FastCGI application uses a filter to evaluate all custom parameters on the
request path, and to process the headers on the response path. the &lt;name&gt; must
reference an existing fcgi-app section. The directive &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">use-fcgi-app<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#use-fcgi-app%20%28Proxy%20section%29">Proxy section</a></li><li><a href="#use-fcgi-app%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; should be
used to define the application to use. By default the corresponding filter is
implicitly defined. And when no other filters than cache or compression are
used, it is enough. But it is mandatory to explicitly use a filter line to a
fcgi-app when at least one filter other than the compression or the cache is
used for the same backend. This is important to know the filters evaluation
order.
</pre><div class="page-header"><b>See also:</b> &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">use-fcgi-app<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#use-fcgi-app%20%28Proxy%20section%29">Proxy section</a></li><li><a href="#use-fcgi-app%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, <a href="#9.2">section 9.2</a> about the compression filter, <a href="#9.4">section 9.4</a> about the cache filter and <a href="#10">section 10</a> about FastCGI application.</div>
</div>
<a class="anchor" id="9.6" name="9.6"></a>
<h2 id="chapter-9.6" data-target="9.6"><small><a class="small" href="#9.6">9.6.</a></small> OpenTracing</h2>
<div><pre class="text">The OpenTracing filter adds native support for using distributed tracing in
HAProxy. This is enabled by sending an OpenTracing compliant request to one
of the supported tracers such as Datadog, Jaeger, Lightstep and Zipkin tracers.
Please note: tracers are not listed by any preference, but alphabetically.

This feature is only enabled when HAProxy was built with USE_OT=1.

The OpenTracing filter activation is done explicitly by specifying it in the
HAProxy configuration. If this is not done, the OpenTracing filter in no way
participates in the work of HAProxy.
</pre><a class="anchor" name="filter"></a><a class="anchor" name="9-filter"></a><a class="anchor" name="9.6-filter"></a><a class="anchor" name="filter (Supported filters)"></a><a class="anchor" name="filter (OpenTracing)"></a><a class="anchor" name="filter opentracing"></a><a class="anchor" name="9-filter opentracing"></a><a class="anchor" name="9.6-filter opentracing"></a><a class="anchor" name="filter opentracing (Supported filters)"></a><a class="anchor" name="filter opentracing (OpenTracing)"></a><div class="keyword"><b><a class="anchor" name="filter opentracing"></a><a href="#9.6-filter%20opentracing">filter opentracing</a></b> <span style="color: #008">[id <span style="color: #080">&lt;id&gt;</span>]</span> config <span style="color: #080">&lt;file&gt;</span></div><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;id&gt;        is the OpenTracing filter id that will be used to find the
            right scope in the configuration file. If no filter id is
            specified, 'ot-filter' is used as default.  If scope is not
            specified in the configuration file, it applies to all defined
            OpenTracing filters.

&lt;file&gt;      is the path of the OpenTracing configuration file. The same
            file can contain configurations for multiple OpenTracing
            filters simultaneously. In that case we do not need to define
            scope so the same configuration applies to all filters or each
            filter must have its own scope defined.</pre>
</div>
<pre class="text">More detailed documentation related to the operation, configuration and use
of the filter can be found in the addons/ot directory.

Note: The OpenTracing filter shouldn't be used for new designs as OpenTracing
      itself is no longer maintained nor supported by its authors. A
      replacement filter base on OpenTelemetry is currently under development
      and is expected to be ready around HAProxy 3.2. As such OpenTracing will
      be deprecated in 3.3 and removed in 3.5.
</pre></div>
<a class="anchor" id="9.7" name="9.7"></a>
<h2 id="chapter-9.7" data-target="9.7"><small><a class="small" href="#9.7">9.7.</a></small> Bandwidth limitation</h2>
<div><a class="anchor" name="filter"></a><a class="anchor" name="9-filter"></a><a class="anchor" name="9.7-filter"></a><a class="anchor" name="filter (Supported filters)"></a><a class="anchor" name="filter (Bandwidth limitation)"></a><a class="anchor" name="filter bwlim-in"></a><a class="anchor" name="9-filter bwlim-in"></a><a class="anchor" name="9.7-filter bwlim-in"></a><a class="anchor" name="filter bwlim-in (Supported filters)"></a><a class="anchor" name="filter bwlim-in (Bandwidth limitation)"></a><div class="keyword"><b><a class="anchor" name="filter bwlim-in"></a><a href="#9.7-filter%20bwlim-in">filter bwlim-in</a></b>  <span style="color: #080">&lt;name&gt;</span> default-limit <span style="color: #080">&lt;size&gt;</span> default-period <span style="color: #080">&lt;time&gt;</span> <span style="color: #008">[min-size <span style="color: #080">&lt;sz&gt;</span>]</span></div><a class="anchor" name="filter"></a><a class="anchor" name="9-filter"></a><a class="anchor" name="9.7-filter"></a><a class="anchor" name="filter (Supported filters)"></a><a class="anchor" name="filter (Bandwidth limitation)"></a><a class="anchor" name="filter bwlim-out"></a><a class="anchor" name="9-filter bwlim-out"></a><a class="anchor" name="9.7-filter bwlim-out"></a><a class="anchor" name="filter bwlim-out (Supported filters)"></a><a class="anchor" name="filter bwlim-out (Bandwidth limitation)"></a><div class="keyword"><b><a class="anchor" name="filter bwlim-out"></a><a href="#9.7-filter%20bwlim-out">filter bwlim-out</a></b> <span style="color: #080">&lt;name&gt;</span> default-limit <span style="color: #080">&lt;size&gt;</span> default-period <span style="color: #080">&lt;time&gt;</span> <span style="color: #008">[min-size <span style="color: #080">&lt;sz&gt;</span>]</span></div><a class="anchor" name="filter"></a><a class="anchor" name="9-filter"></a><a class="anchor" name="9.7-filter"></a><a class="anchor" name="filter (Supported filters)"></a><a class="anchor" name="filter (Bandwidth limitation)"></a><a class="anchor" name="filter bwlim-in"></a><a class="anchor" name="9-filter bwlim-in"></a><a class="anchor" name="9.7-filter bwlim-in"></a><a class="anchor" name="filter bwlim-in (Supported filters)"></a><a class="anchor" name="filter bwlim-in (Bandwidth limitation)"></a><div class="keyword"><b><a class="anchor" name="filter bwlim-in"></a><a href="#9.7-filter%20bwlim-in">filter bwlim-in</a></b>  <span style="color: #080">&lt;name&gt;</span> limit <span style="color: #080">&lt;size&gt;</span> key <span style="color: #080">&lt;pattern&gt;</span> <span style="color: #008">[table <span style="color: #080">&lt;table&gt;</span>]</span> <span style="color: #008">[min-size <span style="color: #080">&lt;sz&gt;</span>]</span></div><a class="anchor" name="filter"></a><a class="anchor" name="9-filter"></a><a class="anchor" name="9.7-filter"></a><a class="anchor" name="filter (Supported filters)"></a><a class="anchor" name="filter (Bandwidth limitation)"></a><a class="anchor" name="filter bwlim-out"></a><a class="anchor" name="9-filter bwlim-out"></a><a class="anchor" name="9.7-filter bwlim-out"></a><a class="anchor" name="filter bwlim-out (Supported filters)"></a><a class="anchor" name="filter bwlim-out (Bandwidth limitation)"></a><div class="keyword"><b><a class="anchor" name="filter bwlim-out"></a><a href="#9.7-filter%20bwlim-out">filter bwlim-out</a></b> <span style="color: #080">&lt;name&gt;</span> limit <span style="color: #080">&lt;size&gt;</span> key <span style="color: #080">&lt;pattern&gt;</span> <span style="color: #008">[table <span style="color: #080">&lt;table&gt;</span>]</span> <span style="color: #008">[min-size <span style="color: #080">&lt;sz&gt;</span>]</span></div><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;name&gt;      is the filter name that will be used by 'set-bandwidth-limit'
            actions to reference a specific bandwidth limitation filter.

&lt;size&gt;      is max number of bytes that can be forwarded over the period.
            The value must be specified for per-stream and shared bandwidth
            limitation filters. It follows the HAProxy size format and is
            expressed in bytes.

&lt;pattern&gt;   is a sample expression rule as described in <a href="#7.3">section 7.3</a>. It
            describes what elements will be analyzed, extracted, combined,
            and used to select which table entry to update the counters. It
            must be specified for shared bandwidth limitation filters only.

&lt;table&gt;     is an optional table to be used instead of the default one,
            which is the stick-table declared in the current proxy. It can
            be specified for shared bandwidth limitation filters only.

&lt;time&gt;      is the default time period used to evaluate the bandwidth
            limitation rate. It can be specified for per-stream bandwidth
            limitation filters only. It follows the HAProxy time format and
            is expressed in milliseconds.

&lt;min-size&gt;  is the optional minimum number of bytes forwarded at a time by
            a stream excluding the last packet that may be smaller. This
            value can be specified for per-stream and shared bandwidth
            limitation filters. It follows the HAProxy size format and is
            expressed in bytes.</pre>
</div>
<pre class="text">Bandwidth limitation filters should be used to restrict the data forwarding
speed at the stream level. By extension, such filters limit the network
bandwidth consumed by a resource. Several bandwidth limitation filters can be
used. For instance, it is possible to define a limit per source address to be
sure a client will never consume all the network bandwidth, thereby penalizing
other clients, and another one per stream to be able to fairly handle several
connections for a given client.

The definition order of these filters is important. If several bandwidth
filters are enabled on a stream, the filtering will be applied in their
definition order. It is also important to understand the definition order of
the other filters have an influence. For instance, depending on the HTTP
compression filter is defined before or after a bandwidth limitation filter,
the limit will be applied on the compressed payload or not. The same is true
for the cache filter.

There are two kinds of bandwidth limitation filters. The first one enforces a
default limit and is applied per stream. The second one uses a stickiness table
to enforce a limit equally divided between all streams sharing the same entry in
the table.

In addition, for a given filter, depending on the filter keyword used, the
limitation can be applied on incoming data, received from the client and
forwarded to a server, or on outgoing data, received from a server and sent to
the client. To apply a limit on incoming data, &quot;bwlim-in&quot; keyword must be
used. To apply it on outgoing data, &quot;bwlim-out&quot; keyword must be used. In both
cases, the bandwidth limitation is applied on forwarded data, at the stream
level.

The bandwidth limitation is applied at the stream level and not at the
connection level. For multiplexed protocols (H2, H3 and FastCGI), the streams
of the same connection may have different limits.

For a per-stream bandwidth limitation filter, default period and limit must be
defined. As their names suggest, they are the default values used to setup the
bandwidth limitation rate for a stream. However, for this kind of filter and
only this one, it is possible to redefine these values using sample expressions
when the filter is enabled with a TCP/HTTP &quot;<a href="#set-bandwidth-limit">set-bandwidth-limit</a>&quot; action.

For a shared bandwidth limitation filter, depending on whether it is applied on
incoming or outgoing data, the stickiness table used must store the
corresponding bytes rate information. &quot;bytes_in_rate(&lt;period&gt;)&quot; counter must be
stored to limit incoming data and &quot;bytes_out_rate(&lt;period&gt;)&quot; counter must be
used to limit outgoing data.

Finally, it is possible to set the minimum number of bytes that a bandwidth
limitation filter can forward at a time for a given stream. It should be used
to not forward too small amount of data, to reduce the CPU usage. It must
carefully be defined. Too small, a value can increase the CPU usage. Too high,
it can increase the latency. It is also highly linked to the defined bandwidth
limit. If it is too close to the bandwidth limit, some pauses may be
experienced to not exceed the limit because too many bytes will be consumed at
a time. It is highly dependent on the filter configuration. A good idea is to
start with something around 2 TCP MSS, typically 2896 bytes, and tune it after
some experimentations.
</pre><div class="separator">
<span class="label label-success">Example:</span>
<pre class="prettyprint">
<code>frontend http
    bind *:80
    mode http

    <span class="comment"># If this filter is enabled, the stream will share the download limit</span>
    <span class="comment"># of 10m/s with all other streams with the same source address.</span>
    filter bwlim-out limit-by-src key src table limit-by-src limit 10m

    <span class="comment"># If this filter is enabled, the stream will be limited to download at 1m/s,</span>
    <span class="comment"># independently of all other streams.</span>
    filter bwlim-out limit-by-strm default-limit 1m default-period 1s

    <span class="comment"># Limit all streams to 1m/s (the default limit) and those accessing the</span>
    <span class="comment"># internal API to 100k/s. Limit each source address to 10m/s. The shared</span>
    <span class="comment"># limit is applied first. Both are limiting the download rate.</span>
    http-request set-bandwidth-limit limit-by-strm
    http-request set-bandwidth-limit limit-by-strm limit 100k if { path_beg /internal }
    http-request set-bandwidth-limit limit-by-src
    ...

backend limit-by-src
    <span class="comment"># The stickiness table used by &lt;limit-by-src&gt; filter</span>
    stick-table type ip size 1m expire 3600s store bytes_out_rate(1s)
</code></pre>
</div><div class="page-header"><b>See also :</b> &quot;tcp-request content set-bandwidth-limit&quot;, &quot;tcp-response content set-bandwidth-limit&quot;, &quot;http-request set-bandwidth-limit&quot; and &quot;http-response set-bandwidth-limit&quot;.</div>
</div>
<a class="anchor" id="10" name="10"></a>
<div class="page-header"><h1 id="chapter-10" data-target="10"><small><a class="small" href="#10">10.</a></small> FastCGI applications</h1>
</div><div><pre class="text">HAProxy is able to send HTTP requests to Responder FastCGI applications. This
feature was added in HAProxy 2.1. To do so, servers must be configured to use
the FastCGI protocol (using the keyword &quot;proto fcgi&quot; on the server line) and a
FastCGI application must be configured and used by the backend managing these
servers (using the keyword &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">use-fcgi-app<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#use-fcgi-app%20%28Proxy%20section%29">Proxy section</a></li><li><a href="#use-fcgi-app%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; into the proxy section). Several
FastCGI applications may be defined, but only one can be used at a time by a
backend.

HAProxy implements all features of the FastCGI specification for Responder
application. Especially it is able to multiplex several requests on a simple
connection.
</pre></div>
<a class="anchor" id="10.1" name="10.1"></a>
<h2 id="chapter-10.1" data-target="10.1"><small><a class="small" href="#10.1">10.1.</a></small> Setup</h2>
<a class="anchor" id="10.1.1" name="10.1.1"></a>
<h3 id="chapter-10.1.1" data-target="10.1.1"><small><a class="small" href="#10.1.1">10.1.1.</a></small> Fcgi-app section</h3>
<div><a class="anchor" name="fcgi-app"></a><a class="anchor" name="10-fcgi-app"></a><a class="anchor" name="10.1.1-fcgi-app"></a><a class="anchor" name="fcgi-app (FastCGI applications)"></a><a class="anchor" name="fcgi-app (Fcgi-app section)"></a><div class="keyword"><b><a class="anchor" name="fcgi-app"></a><a href="#10.1.1-fcgi-app">fcgi-app</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">Declare a FastCGI application named &lt;name&gt;. To be valid, at least the
document root must be defined.
</pre><a class="anchor" name="acl"></a><a class="anchor" name="10-acl"></a><a class="anchor" name="10.1.1-acl"></a><a class="anchor" name="acl (FastCGI applications)"></a><a class="anchor" name="acl (Fcgi-app section)"></a><div class="keyword"><b><a class="anchor" name="acl"></a><a href="#10.1.1-acl">acl</a></b> <span style="color: #080">&lt;aclname&gt;</span> <span style="color: #080">&lt;criterion&gt;</span> <span style="color: #008">[flags]</span> <span style="color: #008">[operator]</span> <span style="color: #080">&lt;value&gt;</span> ...</div><pre class="text">Declare or complete an access list.

See &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">acl<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#acl%20%28Fcgi-app%20section%29">Fcgi-app section</a></li><li><a href="#acl%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#acl%20%28Fetching%20samples%20from%20internal%20states%29">Fetching samples from internal states</a></li></ul></span>&quot; keyword in <a href="#4.2">section 4.2</a> and <a href="#7">section 7</a> about ACL usage for
details. ACLs defined for a FastCGI application are private. They cannot be
used by any other application or by any proxy. In the same way, ACLs defined
in any other section are not usable by a FastCGI application. However,
Pre-defined ACLs are available.
</pre><a class="anchor" name="docroot"></a><a class="anchor" name="10-docroot"></a><a class="anchor" name="10.1.1-docroot"></a><a class="anchor" name="docroot (FastCGI applications)"></a><a class="anchor" name="docroot (Fcgi-app section)"></a><div class="keyword"><b><a class="anchor" name="docroot"></a><a href="#10.1.1-docroot">docroot</a></b> <span style="color: #080">&lt;path&gt;</span>
   Define the document root on the remote host. <span style="color: #080">&lt;path&gt;</span> will be used to build
   the default value of FastCGI parameters SCRIPT_FILENAME and
   PATH_TRANSLATED. It is a mandatory setting.</div><a class="anchor" name="index"></a><a class="anchor" name="10-index"></a><a class="anchor" name="10.1.1-index"></a><a class="anchor" name="index (FastCGI applications)"></a><a class="anchor" name="index (Fcgi-app section)"></a><div class="keyword"><b><a class="anchor" name="index"></a><a href="#10.1.1-index">index</a></b> <span style="color: #080">&lt;script-name&gt;</span></div><pre class="text">Define the script name that will be appended after an URI that ends with a
slash (&quot;/&quot;) to set the default value of the FastCGI parameter SCRIPT_NAME. It
is an optional setting.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>index index.php
</code></pre>
</div><a class="anchor" name="log-stderr"></a><a class="anchor" name="10-log-stderr"></a><a class="anchor" name="10.1.1-log-stderr"></a><a class="anchor" name="log-stderr (FastCGI applications)"></a><a class="anchor" name="log-stderr (Fcgi-app section)"></a><a class="anchor" name="log-stderr global"></a><a class="anchor" name="10-log-stderr global"></a><a class="anchor" name="10.1.1-log-stderr global"></a><a class="anchor" name="log-stderr global (FastCGI applications)"></a><a class="anchor" name="log-stderr global (Fcgi-app section)"></a><div class="keyword"><b><a class="anchor" name="log-stderr global"></a><a href="#10.1.1-log-stderr%20global">log-stderr global</a></b></div><a class="anchor" name="log-stderr"></a><a class="anchor" name="10-log-stderr"></a><a class="anchor" name="10.1.1-log-stderr"></a><a class="anchor" name="log-stderr (FastCGI applications)"></a><a class="anchor" name="log-stderr (Fcgi-app section)"></a><div class="keyword"><b><a class="anchor" name="log-stderr"></a><a href="#10.1.1-log-stderr">log-stderr</a></b> <span style="color: #080">&lt;target&gt;</span> <span style="color: #008">[len <span style="color: #080">&lt;length&gt;</span>]</span> <span style="color: #008">[format <span style="color: #080">&lt;format&gt;</span>]</span>
    <span style="color: #008">[sample <span style="color: #080">&lt;ranges&gt;</span>:<span style="color: #080">&lt;sample_size&gt;</span>]</span> <span style="color: #080">&lt;facility&gt;</span> <span style="color: #008">[<span style="color: #080">&lt;level&gt;</span> <span style="color: #008">[<span style="color: #080">&lt;minlevel&gt;</span>]</span>]</span></div><pre class="text">Enable logging of STDERR messages reported by the FastCGI application.

See &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; keyword in <a href="#4.2">section 4.2</a> for details. It is an optional setting. By
default STDERR messages are ignored.
</pre><a class="anchor" name="pass-header"></a><a class="anchor" name="10-pass-header"></a><a class="anchor" name="10.1.1-pass-header"></a><a class="anchor" name="pass-header (FastCGI applications)"></a><a class="anchor" name="pass-header (Fcgi-app section)"></a><div class="keyword"><b><a class="anchor" name="pass-header"></a><a href="#10.1.1-pass-header">pass-header</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #008">[ <span style="color: #800">{ if | unless }</span> <span style="color: #080">&lt;condition&gt;</span> ]</span></div><pre class="text">Specify the name of a request header which will be passed to the FastCGI
application. It may optionally be followed by an ACL-based condition, in
which case it will only be evaluated if the condition is true.

Most request headers are already available to the FastCGI application,
prefixed with &quot;HTTP_&quot;. Thus, this directive is only required to pass headers
that are purposefully omitted. Currently, the headers &quot;Authorization&quot;,
&quot;Proxy-Authorization&quot; and hop-by-hop headers are omitted.

Note that the headers &quot;Content-type&quot; and &quot;Content-length&quot; are never passed to
the FastCGI application because they are already converted into parameters.
</pre><a class="anchor" name="path-info"></a><a class="anchor" name="10-path-info"></a><a class="anchor" name="10.1.1-path-info"></a><a class="anchor" name="path-info (FastCGI applications)"></a><a class="anchor" name="path-info (Fcgi-app section)"></a><div class="keyword"><b><a class="anchor" name="path-info"></a><a href="#10.1.1-path-info">path-info</a></b> <span style="color: #080">&lt;regex&gt;</span></div><pre class="text">Define a regular expression to extract the script-name and the path-info from
the URL-decoded path. Thus, &lt;regex&gt; may have two captures: the first one to
capture the script name and the second one to capture the path-info. The
first one is mandatory, the second one is optional. This way, it is possible
to extract the script-name from the path ignoring the path-info. It is an
optional setting. If it is not defined, no matching is performed on the
path. and the FastCGI parameters PATH_INFO and PATH_TRANSLATED are not
filled.

For security reason, when this regular expression is defined, the newline and
the null characters are forbidden from the path, once URL-decoded. The reason
to such limitation is because otherwise the matching always fails (due to a
limitation one the way regular expression are executed in HAProxy). So if one
of these two characters is found in the URL-decoded path, an error is
returned to the client. The principle of least astonishment is applied here.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code>path-info ^(/.+\.php)(/.*)?$ <span class="comment"># both script-name and path-info may be set</span>
path-info ^(/.+\.php)        <span class="comment"># the path-info is ignored</span>
</code></pre>
</div><a class="anchor" name="option"></a><a class="anchor" name="10-option"></a><a class="anchor" name="10.1.1-option"></a><a class="anchor" name="option (FastCGI applications)"></a><a class="anchor" name="option (Fcgi-app section)"></a><a class="anchor" name="option get-values"></a><a class="anchor" name="10-option get-values"></a><a class="anchor" name="10.1.1-option get-values"></a><a class="anchor" name="option get-values (FastCGI applications)"></a><a class="anchor" name="option get-values (Fcgi-app section)"></a><div class="keyword"><b><a class="anchor" name="option get-values"></a><a href="#10.1.1-option%20get-values">option get-values</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="10-no"></a><a class="anchor" name="10.1.1-no"></a><a class="anchor" name="no (FastCGI applications)"></a><a class="anchor" name="no (Fcgi-app section)"></a><a class="anchor" name="no option"></a><a class="anchor" name="10-no option"></a><a class="anchor" name="10.1.1-no option"></a><a class="anchor" name="no option (FastCGI applications)"></a><a class="anchor" name="no option (Fcgi-app section)"></a><a class="anchor" name="no option get-values"></a><a class="anchor" name="10-no option get-values"></a><a class="anchor" name="10.1.1-no option get-values"></a><a class="anchor" name="no option get-values (FastCGI applications)"></a><a class="anchor" name="no option get-values (Fcgi-app section)"></a><div class="keyword"><b><a class="anchor" name="no option get-values"></a><a href="#10.1.1-no%20option%20get-values">no option get-values</a></b></div><pre class="text">Enable or disable the retrieve of variables about connection management.

HAProxy is able to send the record FCGI_GET_VALUES on connection
establishment to retrieve the value for following variables:

  * FCGI_MAX_REQS     The maximum number of concurrent requests this
                      application will accept.

  * FCGI_MPXS_CONNS   &quot;0&quot; if this application does not multiplex connections,
                      &quot;1&quot; otherwise.

Some FastCGI applications does not support this feature. Some others close
the connection immediately after sending their response. So, by default, this
option is disabled.

Note that the maximum number of concurrent requests accepted by a FastCGI
application is a connection variable. It only limits the number of streams
per connection. If the global load must be limited on the application, the
server parameters &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">maxconn<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#maxconn%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#maxconn%20%28Performance%20tuning%29">Performance tuning</a></li><li><a href="#maxconn%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li><li><a href="#maxconn%20%28Bind%20options%29">Bind options</a></li><li><a href="#maxconn%20%28Server%20and%20default-server%20options%29">Server and default-server options</a></li></ul></span>&quot; and &quot;<a href="#pool-max-conn">pool-max-conn</a>&quot; must be set. In addition, if
an application does not support connection multiplexing, the maximum number
of concurrent requests is automatically set to 1.
</pre><a class="anchor" name="option"></a><a class="anchor" name="10-option"></a><a class="anchor" name="10.1.1-option"></a><a class="anchor" name="option (FastCGI applications)"></a><a class="anchor" name="option (Fcgi-app section)"></a><a class="anchor" name="option keep-conn"></a><a class="anchor" name="10-option keep-conn"></a><a class="anchor" name="10.1.1-option keep-conn"></a><a class="anchor" name="option keep-conn (FastCGI applications)"></a><a class="anchor" name="option keep-conn (Fcgi-app section)"></a><div class="keyword"><b><a class="anchor" name="option keep-conn"></a><a href="#10.1.1-option%20keep-conn">option keep-conn</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="10-no"></a><a class="anchor" name="10.1.1-no"></a><a class="anchor" name="no (FastCGI applications)"></a><a class="anchor" name="no (Fcgi-app section)"></a><a class="anchor" name="no option"></a><a class="anchor" name="10-no option"></a><a class="anchor" name="10.1.1-no option"></a><a class="anchor" name="no option (FastCGI applications)"></a><a class="anchor" name="no option (Fcgi-app section)"></a><a class="anchor" name="no option keep-conn"></a><a class="anchor" name="10-no option keep-conn"></a><a class="anchor" name="10.1.1-no option keep-conn"></a><a class="anchor" name="no option keep-conn (FastCGI applications)"></a><a class="anchor" name="no option keep-conn (Fcgi-app section)"></a><div class="keyword"><b><a class="anchor" name="no option keep-conn"></a><a href="#10.1.1-no%20option%20keep-conn">no option keep-conn</a></b></div><pre class="text">Instruct the FastCGI application to keep the connection open or not after
sending a response.

 If disabled, the FastCGI application closes the connection after responding
 to this request. By default, this option is enabled.
</pre><a class="anchor" name="option"></a><a class="anchor" name="10-option"></a><a class="anchor" name="10.1.1-option"></a><a class="anchor" name="option (FastCGI applications)"></a><a class="anchor" name="option (Fcgi-app section)"></a><a class="anchor" name="option max-reqs"></a><a class="anchor" name="10-option max-reqs"></a><a class="anchor" name="10.1.1-option max-reqs"></a><a class="anchor" name="option max-reqs (FastCGI applications)"></a><a class="anchor" name="option max-reqs (Fcgi-app section)"></a><div class="keyword"><b><a class="anchor" name="option max-reqs"></a><a href="#10.1.1-option%20max-reqs">option max-reqs</a></b> <span style="color: #080">&lt;reqs&gt;</span></div><pre class="text">Define the maximum number of concurrent requests this application will
accept.

This option may be overwritten if the variable FCGI_MAX_REQS is retrieved
during connection establishment. Furthermore, if the application does not
support connection multiplexing, this option will be ignored. By default set
to 1.
</pre><a class="anchor" name="option"></a><a class="anchor" name="10-option"></a><a class="anchor" name="10.1.1-option"></a><a class="anchor" name="option (FastCGI applications)"></a><a class="anchor" name="option (Fcgi-app section)"></a><a class="anchor" name="option mpxs-conns"></a><a class="anchor" name="10-option mpxs-conns"></a><a class="anchor" name="10.1.1-option mpxs-conns"></a><a class="anchor" name="option mpxs-conns (FastCGI applications)"></a><a class="anchor" name="option mpxs-conns (Fcgi-app section)"></a><div class="keyword"><b><a class="anchor" name="option mpxs-conns"></a><a href="#10.1.1-option%20mpxs-conns">option mpxs-conns</a></b></div><a class="anchor" name="no"></a><a class="anchor" name="10-no"></a><a class="anchor" name="10.1.1-no"></a><a class="anchor" name="no (FastCGI applications)"></a><a class="anchor" name="no (Fcgi-app section)"></a><a class="anchor" name="no option"></a><a class="anchor" name="10-no option"></a><a class="anchor" name="10.1.1-no option"></a><a class="anchor" name="no option (FastCGI applications)"></a><a class="anchor" name="no option (Fcgi-app section)"></a><a class="anchor" name="no option mpxs-conns"></a><a class="anchor" name="10-no option mpxs-conns"></a><a class="anchor" name="10.1.1-no option mpxs-conns"></a><a class="anchor" name="no option mpxs-conns (FastCGI applications)"></a><a class="anchor" name="no option mpxs-conns (Fcgi-app section)"></a><div class="keyword"><b><a class="anchor" name="no option mpxs-conns"></a><a href="#10.1.1-no%20option%20mpxs-conns">no option mpxs-conns</a></b></div><pre class="text">Enable or disable the support of connection multiplexing.

This option may be overwritten if the variable FCGI_MPXS_CONNS is retrieved
during connection establishment. It is disabled by default.
</pre><a class="anchor" name="set-param"></a><a class="anchor" name="10-set-param"></a><a class="anchor" name="10.1.1-set-param"></a><a class="anchor" name="set-param (FastCGI applications)"></a><a class="anchor" name="set-param (Fcgi-app section)"></a><div class="keyword"><b><a class="anchor" name="set-param"></a><a href="#10.1.1-set-param">set-param</a></b> <span style="color: #080">&lt;name&gt;</span> <span style="color: #080">&lt;fmt&gt;</span> <span style="color: #008">[ <span style="color: #800">{ if | unless }</span> <span style="color: #080">&lt;condition&gt;</span> ]</span></div><pre class="text">Set a FastCGI parameter that should be passed to this application. Its
value, defined by &lt;fmt&gt; must follows the Custom log format rules (see section
8.2.6 &quot;Custom Log format&quot;). It may optionally be followed by an ACL-based
condition, in which case it will only be evaluated if the condition is true.

With this directive, it is possible to overwrite the value of default FastCGI
parameters. If the value is evaluated to an empty string, the rule is
ignored. These directives are evaluated in their declaration order.
</pre><div class="separator">
<span class="label label-success">Example :</span>
<pre class="prettyprint">
<code><span class="comment"># PHP only, required if PHP was built with --enable-force-cgi-redirect</span>
set-param REDIRECT_STATUS 200

set-param PHP_AUTH_DIGEST %[req.hdr(Authorization)]
</code></pre>
</div></div>
<a class="anchor" id="10.1.2" name="10.1.2"></a>
<h3 id="chapter-10.1.2" data-target="10.1.2"><small><a class="small" href="#10.1.2">10.1.2.</a></small> Proxy section</h3>
<div><a class="anchor" name="use-fcgi-app"></a><a class="anchor" name="10-use-fcgi-app"></a><a class="anchor" name="10.1.2-use-fcgi-app"></a><a class="anchor" name="use-fcgi-app (FastCGI applications)"></a><a class="anchor" name="use-fcgi-app (Proxy section)"></a><div class="keyword"><b><a class="anchor" name="use-fcgi-app"></a><a href="#10.1.2-use-fcgi-app">use-fcgi-app</a></b> <span style="color: #080">&lt;name&gt;</span></div><pre class="text">Define the FastCGI application to use for the backend.
</pre><div class="separator">
<span class="label label-info">Arguments :</span><pre class="prettyprint arguments">&lt;name&gt;    is the name of the FastCGI application to use.</pre>
</div>
<pre class="text">This keyword is only available for HTTP proxies with the backend capability
and with at least one FastCGI server. However, FastCGI servers can be mixed
with HTTP servers. But except there is a good reason to do so, it is not
recommended (see <a href="#10.3">section 10.3</a> about the limitations for details). Only one
application may be defined at a time per backend.

Note that, once a FastCGI application is referenced for a backend, depending
on the configuration some processing may be done even if the request is not
sent to a FastCGI server. Rules to set parameters or pass headers to an
application are evaluated.
</pre></div>
<a class="anchor" id="10.1.3" name="10.1.3"></a>
<h3 id="chapter-10.1.3" data-target="10.1.3"><small><a class="small" href="#10.1.3">10.1.3.</a></small> Example</h3>
<div><pre class="text">frontend front-http
    mode http
    bind *:80
    bind *:

    use_backend back-dynamic if { path_reg ^/.+\.php(/.*)?$ }
    default_backend back-static

backend back-static
    mode http
    server www A.B.C.D:80

backend back-dynamic
    mode http
    use-fcgi-app php-fpm
    server php-fpm A.B.C.D:9000 proto fcgi

fcgi-app php-fpm
    log-stderr global
    option keep-conn

    docroot /var/www/my-app
    index index.php
    path-info ^(/.+\.php)(/.*)?$
</pre></div>
<a class="anchor" id="10.2" name="10.2"></a>
<h2 id="chapter-10.2" data-target="10.2"><small><a class="small" href="#10.2">10.2.</a></small> Default parameters</h2>
<div><pre class="text">A Responder FastCGI application has the same purpose as a CGI/1.1 program. In
the CGI/1.1 specification (RFC3875), several variables must be passed to the
script. So HAProxy set them and some others commonly used by FastCGI
applications. All these variables may be overwritten, with caution though.

  +-------------------+-----------------------------------------------------+
  | AUTH_TYPE         | Identifies the mechanism, if any, used by HAProxy   |
  |                   | to authenticate the user. Concretely, only the      |
  |                   | BASIC authentication mechanism is supported.        |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | CONTENT_LENGTH    | Contains the size of the message-body attached to   |
  |                   | the request. It means only requests with a known    |
  |                   | size are considered as valid and sent to the        |
  |                   | application.                                        |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | CONTENT_TYPE      | Contains the type of the message-body attached to   |
  |                   | the request. It may not be set.                     |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | DOCUMENT_ROOT     | Contains the document root on the remote host under |
  |                   | which the script should be executed, as defined in  |
  |                   | the application's configuration.                    |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | GATEWAY_INTERFACE | Contains the dialect of CGI being used by HAProxy   |
  |                   | to communicate with the FastCGI application.        |
  |                   | Concretely, it is set to &quot;CGI/1.1&quot;.                 |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | PATH_INFO         | Contains the portion of the URI path hierarchy      |
  |                   | following the part that identifies the script       |
  |                   | itself. To be set, the directive &quot;<a href="#path-info">path-info</a>&quot; must   |
  |                   | be defined.                                         |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | PATH_TRANSLATED   | If PATH_INFO is set, it is its translated version.  |
  |                   | It is the concatenation of DOCUMENT_ROOT and        |
  |                   | PATH_INFO. If PATH_INFO is not set, this parameters |
  |                   | is not set too.                                     |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | QUERY_STRING      | Contains the request's query string. It may not be  |
  |                   | set.                                                |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | REMOTE_ADDR       | Contains the network address of the client sending  |
  |                   | the request.                                        |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | REMOTE_USER       | Contains the user identification string supplied by |
  |                   | client as part of user authentication.              |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | REQUEST_METHOD    | Contains the method which should be used by the     |
  |                   | script to process the request.                      |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | REQUEST_URI       | Contains the request's URI.                         |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | SCRIPT_FILENAME   | Contains the absolute pathname of the script. it is |
  |                   | the concatenation of DOCUMENT_ROOT and SCRIPT_NAME. |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | SCRIPT_NAME       | Contains the name of the script. If the directive   |
  |                   | &quot;<a href="#path-info">path-info</a>&quot; is defined, it is the first part of the |
  |                   | URI path hierarchy, ending with the script name.    |
  |                   | Otherwise, it is the entire URI path.               |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | SERVER_NAME       | Contains the name of the server host to which the   |
  |                   | client request is directed. It is the value of the  |
  |                   | header &quot;Host&quot;, if defined. Otherwise, the           |
  |                   | destination address of the connection on the client |
  |                   | side.                                               |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | SERVER_PORT       | Contains the destination TCP port of the connection |
  |                   | on the client side, which is the port the client    |
  |                   | connected to.                                       |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | SERVER_PROTOCOL   | Contains the request's protocol.                    |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | SERVER_SOFTWARE   | Contains the string &quot;HAProxy&quot; followed by the       |
  |                   | current HAProxy version.                            |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
  | HTTPS             | Set to a non-empty value (&quot;<a href="#on">on</a>&quot;) if the script was   |
  |                   | queried through the HTTPS protocol.                 |
  |                   |                                                     |
  +-------------------+-----------------------------------------------------+
</pre></div>
<a class="anchor" id="10.3" name="10.3"></a>
<h2 id="chapter-10.3" data-target="10.3"><small><a class="small" href="#10.3">10.3.</a></small> Limitations</h2>
<div><pre class="text">The current implementation have some limitations. The first one is about the
way some request headers are hidden to the FastCGI applications. This happens
during the headers analysis, on the backend side, before the connection
establishment. At this stage, HAProxy know the backend is using a FastCGI
application but it don't know if the request will be routed to a FastCGI server
or not. But to hide request headers, it simply removes them from the HTX
message. So, if the request is finally routed to an HTTP server, it never see
these headers. For this reason, it is not recommended to mix FastCGI servers
and HTTP servers under the same backend.

Similarly, the rules &quot;<a href="#set-param">set-param</a>&quot; and &quot;<a href="#pass-header">pass-header</a>&quot; are evaluated during the
request headers analysis. So the evaluation is always performed, even if the
requests is finally forwarded to an HTTP server.

About the rules &quot;<a href="#set-param">set-param</a>&quot;, when a rule is applied, a pseudo header is added
into the HTX message. So, the same way than for HTTP header rewrites, it may
fail if the buffer is full. The rules &quot;<a href="#set-param">set-param</a>&quot; will compete with
&quot;<a href="#http-request">http-request</a>&quot; ones.

Finally, all FastCGI params and HTTP headers are sent into a unique record
FCGI_PARAM. Encoding of this record must be done in one pass, otherwise a
processing error is returned. It means the record FCGI_PARAM, once encoded,
must not exceeds the size of a buffer. However, there is no reserve to respect
here.
</pre></div>
<a class="anchor" id="11" name="11"></a>
<div class="page-header"><h1 id="chapter-11" data-target="11"><small><a class="small" href="#11">11.</a></small> Address formats</h1>
</div><div><pre class="text">Several statements as &quot;bind, &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">server<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#server%20%28Peers%29">Peers</a></li><li><a href="#server%20%28Rings%29">Rings</a></li><li><a href="#server%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot;, &quot;<a href="#nameserver">nameserver</a>&quot; and &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; requires an
address.

This address can be a host name, an IPv4 address, an IPv6 address, or '*'.
The '*' is equal to the special address &quot;0.0.0.0&quot; and can be used, in the case
of &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">bind<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#bind%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#bind%20%28Peers%29">Peers</a></li><li><a href="#bind%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; or &quot;<a href="#dgram-bind">dgram-bind</a>&quot; to listen on all IPv4 of the system.The IPv6
equivalent is '::'.

Depending of the statement, a port or port range follows the IP address. This
is mandatory on 'bind' statement, optional on 'server'.

This address can also begin with a slash '/'. It is considered as the &quot;unix&quot;
family, and '/' and following characters must be present the path.

Default socket type or transport method &quot;datagram&quot; or &quot;stream&quot; depends on the
configuration statement showing the address. Indeed, 'bind' and 'server' will
use a &quot;stream&quot; socket type by default whereas 'log', 'nameserver' or
'dgram-bind' will use a &quot;datagram&quot;.

Optionally, a prefix could be used to force the address family and/or the
socket type and the transport method.
</pre></div>
<a class="anchor" id="11.1" name="11.1"></a>
<h2 id="chapter-11.1" data-target="11.1"><small><a class="small" href="#11.1">11.1.</a></small> Address family prefixes</h2>
<div><pre class="text">'abns@&lt;name&gt;' following &lt;name&gt; is an abstract namespace (Linux only).

'abnsz@&lt;name&gt;' following &lt;name&gt; is a zero-terminated abstract namespace
               (Linux only).

'fd@&lt;n&gt;'      following address is a file descriptor &lt;n&gt; inherited from the
              parent. The fd must be bound and may or may not already be
              listening.

'ip@&lt;address&gt;[:port1[-port2]]' following &lt;address&gt; is considered as an IPv4 or
                               IPv6 address depending on the syntax. Depending
                               on the statement using this address, a port or
                               a port range may or must be specified.

'ipv4@&lt;address&gt;[:port1[-port2]]' following &lt;address&gt; is always considered as
                                 an IPv4 address. Depending on the statement
                                 using this address, a port or a port range
                                 may or must be specified.

'ipv6@&lt;address&gt;[:port1[-port2]]' following &lt;address&gt; is always considered as
                                 an IPv6 address. Depending on the statement
                                 using this address, a port or a port range
                                 may or must be specified.

'sockpair@&lt;n&gt;' following address is the file descriptor of a connected unix
               socket or of a socketpair. During a connection, the initiator
               creates a pair of connected sockets, and passes one of them
               over the FD to the other end. The listener waits to receive
               the FD from the unix socket and uses it as if it were the FD
               of an accept(). Should be used carefully.

'unix@&lt;path&gt;'  following string is considered as a UNIX socket &lt;path&gt;. this
               prefix is useful to declare an UNIX socket path which don't
               start by slash '/'.
</pre></div>
<a class="anchor" id="11.2" name="11.2"></a>
<h2 id="chapter-11.2" data-target="11.2"><small><a class="small" href="#11.2">11.2.</a></small> Socket type prefixes</h2>
<div><pre class="text">Previous &quot;Address family prefixes&quot; can also be prefixed to force the socket
type and the transport method. The default depends of the statement using
this address but in some cases the user may force it to a different one.
This is the case for &quot;<span class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">log<span class="caret"></span></a><ul class="dropdown-menu"><li class="dropdown-header">This keyword is available in sections :</li><li><a href="#log%20%28Process%20management%20and%20security%29">Process management and security</a></li><li><a href="#log%20%28Log%20forwarding%29">Log forwarding</a></li><li><a href="#log%20%28Peers%29">Peers</a></li><li><a href="#log%20%28Alphabetically%20sorted%20keywords%20reference%29">Alphabetically sorted keywords reference</a></li></ul></span>&quot; statement where the default is syslog over UDP
but we could force to use syslog over TCP.

Those prefixes were designed for internal purpose and users should instead use
use aliases of the next section &quot;11.3 Protocol prefixes&quot;. However these can
sometimes be convenient, for example in combination with inherited sockets
known by their file descriptor number, in which case the address family is &quot;fd&quot;
and the socket type must be declared.

If users need one those prefixes to perform what they expect because
they can not configure the same using the protocol prefixes, they should
report this to the maintainers.

'stream+&lt;family&gt;@&lt;address&gt;' forces socket type and transport method
                            to &quot;stream&quot;

'dgram+&lt;family&gt;@&lt;address&gt;'  forces socket type and transport method
                            to &quot;datagram&quot;.

'quic+&lt;family&gt;@&lt;address&gt;'   forces socket type to &quot;datagram&quot; and transport
                            method to &quot;stream&quot;.
</pre></div>
<a class="anchor" id="11.3" name="11.3"></a>
<h2 id="chapter-11.3" data-target="11.3"><small><a class="small" href="#11.3">11.3.</a></small> Protocol prefixes</h2>
<div><pre class="text">'quic4@&lt;address&gt;[:port1[-port2]]' following &lt;address&gt; is always considered as
                                  an IPv4 address but socket type is forced to
                                  &quot;datagram&quot; and the transport method is forced
                                  to &quot;stream&quot;. Depending on the statement using
                                  this address, a UDP port or port range can or
                                  must be specified. It is equivalent to
                                  &quot;quic+ipv4@&quot;.

'quic6@&lt;address&gt;[:port1[-port2]]' following &lt;address&gt; is always considered as
                                  an IPv6 address but socket type is forced to
                                  &quot;datagram&quot; and the transport method is forced
                                  to &quot;stream&quot;. Depending on the statement using
                                  this address, a UDP port or port range can or
                                  must be specified. It is equivalent to
                                  &quot;quic+ipv6@&quot;.

'tcp@&lt;address&gt;[:port1[-port2]]' following &lt;address&gt; is considered as an IPv4
                                or IPv6 address depending of the syntax but
                                socket type and transport method is forced to
                                &quot;stream&quot;. Depending on the statement using
                                this address, a port or a port range can or
                                must be specified. It is considered as an alias
                                of 'stream+ip@'.

'tcp4@&lt;address&gt;[:port1[-port2]]' following &lt;address&gt; is always considered as
                                 an IPv4 address but socket type and transport
                                 method is forced to &quot;stream&quot;. Depending on the
                                 statement using this address, a port or port
                                 range can or must be specified.
                                 It is considered as an alias of 'stream+ipv4@'.

'tcp6@&lt;address&gt;[:port1[-port2]]' following &lt;address&gt; is always considered as
                                 an IPv6 address but socket type and transport
                                 method is forced to &quot;stream&quot;. Depending on the
                                 statement using this address, a port or port
                                 range can or must be specified.
                                 It is considered as an alias of 'stream+ipv4@'.

'mptcp@&lt;address&gt;[:port1[-port2]]' following &lt;address&gt; is considered as an IPv4
                                  or IPv6 address depending of the syntax but
                                  socket type and transport method is forced to
                                  &quot;stream&quot;, with the MPTCP protocol. Depending
                                  on the statement using this address, a port or
                                  a port range can or must be specified.

'mptcp4@&lt;address&gt;[:port1[-port2]]' following &lt;address&gt; is always considered as
                                   an IPv4 address but socket type and transport
                                   method is forced to &quot;stream&quot;, with the MPTCP
                                   protocol. Depending on the statement using
                                   this address, a port or port range can or
                                   must be specified.

'mptcp6@&lt;address&gt;[:port1[-port2]]' following &lt;address&gt; is always considered as
                                   an IPv6 address but socket type and transport
                                   method is forced to &quot;stream&quot;, with the MPTCP
                                   protocol. Depending on the statement using
                                   this address, a port or port range can or
                                   must be specified.

'udp@&lt;address&gt;[:port1[-port2]]' following &lt;address&gt; is considered as an IPv4
                                or IPv6 address depending of the syntax but
                                socket type and transport method is forced to
                                &quot;datagram&quot;. Depending on the statement using
                                this address, a port or a port range can or
                                must be specified. It is considered as an alias
                                of 'dgram+ip@'.

'udp4@&lt;address&gt;[:port1[-port2]]' following &lt;address&gt; is always considered as
                                 an IPv4 address but socket type and transport
                                 method is forced to &quot;datagram&quot;. Depending on
                                 the statement using this address, a port or
                                 port range can or must be specified.
                                 It is considered as an alias of 'dgram+ipv4@'.

'udp6@&lt;address&gt;[:port1[-port2]]' following &lt;address&gt; is always considered as
                                 an IPv6 address but socket type and transport
                                 method is forced to &quot;datagram&quot;. Depending on
                                 the statement using this address, a port or
                                 port range can or must be specified.
                                 It is considered as an alias of 'dgram+ipv4@'.

'uxdg@&lt;path&gt;'    following string is considered as a unix socket &lt;path&gt; but
                 transport method is forced to &quot;datagram&quot;. It is considered as
                 an alias of 'dgram+unix@'.

'uxst@&lt;path&gt;'    following string is considered as a unix socket &lt;path&gt; but
                 transport method is forced to &quot;stream&quot;. It is considered as
                 an alias of 'stream+unix@'.

In future versions, other prefixes could be used to specify protocols like
QUIC which proposes stream transport based on socket of type &quot;datagram&quot;.
</pre>
</div>

						<br>
						<hr>
						<div class="text-right">
							HAProxy 3.1.1 &ndash; Configuration Manual<br>
							<small>, 2024/12/11</small>
						</div>
					</div>
					<!-- /.col-lg-12 -->
				</div>
				<!-- /.row -->
			</div>
			<!-- /#page-wrapper -->

		</div>
		<!-- /#wrapper -->

		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>
		<script>
			function filterKeywords(text) {
				$('.letter').each(function(idx1, letter) {
					$letter = $(letter)
					found = false
					$letter.find('.list-group-item').each(function(idx2, keyword) {
						$keyword = $(keyword)
						if ($keyword.text().indexOf(text) != -1) {
							$keyword.show();
							found = true
						}
						else {
							$keyword.hide();
						}
					})
					if (found) {
						$letter.show()
					}
					else {
						$letter.hide()
					}
				})
			}
		</script>
		<script>
			/* EXPERIMENTAL - Previous/Next navigation */
			var headings = $(":header")
			var previousTarget = false
			var nextTarget = false
			var $previous = $('#previous')
			var $next = $('#next')
			function refreshNavigation() {
				var previous = false
				var next = false
				$.each(headings, function(item, value) {
					var el = $(value)

					// TODO : avoid target recalculation on each refresh
					var target = el.attr('data-target')
					if (! target) return true

					var target_el = $('#' + target.replace(/\./, "\\."))
					if (! target_el.attr('id')) return true

					if (target_el.offset().top < $(window).scrollTop()) {
						previous = el
					}
					if (target_el.offset().top - 1 > $(window).scrollTop()) {
						next = el
					}
					if (next) return false
				})

				previousTarget = previous ? previous.attr('data-target') : 'top'
				nextTarget = next ? next.attr('data-target') : 'bottom'
			}

			$(window).scroll(function () {
				refreshNavigation()
			});
			$(document).ready(function() {
				refreshNavigation()
			});

			/* EXPERIMENTAL - Enable keyboard navigation */
			$(document).keydown(function(e){
				if (!(e.altKey || e.ctrlKey || e.shiftKey || e.metaKey)) {
					switch(e.which) {
						case 37: // left
						window.location.hash = previousTarget ? previousTarget : 'top'
						break

						case 39: // right
						window.location.hash = nextTarget ? nextTarget : 'bottom'
						break

						default: return // exit this handler for other keys
					}
					e.preventDefault()
				}
			})
		</script>
		
		<a class="anchor" name="bottom"></a>
	</body>
</html>

